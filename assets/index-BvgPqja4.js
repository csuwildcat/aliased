var Ss=Object.defineProperty;var ts=kt=>{throw TypeError(kt)};var Es=(kt,At,xt)=>At in kt?Ss(kt,At,{enumerable:!0,configurable:!0,writable:!0,value:xt}):kt[At]=xt;var ti=(kt,At,xt)=>Es(kt,typeof At!="symbol"?At+"":At,xt),Fo=(kt,At,xt)=>At.has(kt)||ts("Cannot "+xt);var rn=(kt,At,xt)=>(Fo(kt,At,"read from private field"),xt?xt.call(kt):At.get(kt)),Fn=(kt,At,xt)=>At.has(kt)?ts("Cannot add the same private member more than once"):At instanceof WeakSet?At.add(kt):At.set(kt,xt),Pn=(kt,At,xt,Bt)=>(Fo(kt,At,"write to private field"),Bt?Bt.call(kt,xt):At.set(kt,xt),xt),An=(kt,At,xt)=>(Fo(kt,At,"access private method"),xt);var Mo=(kt,At,xt,Bt)=>({set _(Nt){Pn(kt,At,Nt,xt)},get _(){return rn(kt,At,Bt)}});(function(){const At=document.createElement("link").relList;if(At&&At.supports&&At.supports("modulepreload"))return;for(const Nt of document.querySelectorAll('link[rel="modulepreload"]'))Bt(Nt);new MutationObserver(Nt=>{for(const jt of Nt)if(jt.type==="childList")for(const Ut of jt.addedNodes)Ut.tagName==="LINK"&&Ut.rel==="modulepreload"&&Bt(Ut)}).observe(document,{childList:!0,subtree:!0});function xt(Nt){const jt={};return Nt.integrity&&(jt.integrity=Nt.integrity),Nt.referrerPolicy&&(jt.referrerPolicy=Nt.referrerPolicy),Nt.crossOrigin==="use-credentials"?jt.credentials="include":Nt.crossOrigin==="anonymous"?jt.credentials="omit":jt.credentials="same-origin",jt}function Bt(Nt){if(Nt.ep)return;Nt.ep=!0;const jt=xt(Nt);fetch(Nt.href,jt)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$5=globalThis,e$6=t$5.ShadowRoot&&(t$5.ShadyCSS===void 0||t$5.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$4=Symbol(),o$6=new WeakMap;let n$4=class{constructor(At,xt,Bt){if(this._$cssResult$=!0,Bt!==s$4)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=At,this.t=xt}get styleSheet(){let At=this.o;const xt=this.t;if(e$6&&At===void 0){const Bt=xt!==void 0&&xt.length===1;Bt&&(At=o$6.get(xt)),At===void 0&&((this.o=At=new CSSStyleSheet).replaceSync(this.cssText),Bt&&o$6.set(xt,At))}return At}toString(){return this.cssText}};const r$6=kt=>new n$4(typeof kt=="string"?kt:kt+"",void 0,s$4),i$7=(kt,...At)=>{const xt=kt.length===1?kt[0]:At.reduce((Bt,Nt,jt)=>Bt+(Ut=>{if(Ut._$cssResult$===!0)return Ut.cssText;if(typeof Ut=="number")return Ut;throw Error("Value passed to 'css' function must be a 'css' function result: "+Ut+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(Nt)+kt[jt+1],kt[0]);return new n$4(xt,kt,s$4)},S$2=(kt,At)=>{if(e$6)kt.adoptedStyleSheets=At.map(xt=>xt instanceof CSSStyleSheet?xt:xt.styleSheet);else for(const xt of At){const Bt=document.createElement("style"),Nt=t$5.litNonce;Nt!==void 0&&Bt.setAttribute("nonce",Nt),Bt.textContent=xt.cssText,kt.appendChild(Bt)}},c$3=e$6?kt=>kt:kt=>kt instanceof CSSStyleSheet?(At=>{let xt="";for(const Bt of At.cssRules)xt+=Bt.cssText;return r$6(xt)})(kt):kt;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:i$6,defineProperty:e$5,getOwnPropertyDescriptor:r$5,getOwnPropertyNames:h$4,getOwnPropertySymbols:o$5,getPrototypeOf:n$3}=Object,a$1=globalThis,c$2=a$1.trustedTypes,l$1=c$2?c$2.emptyScript:"",p$1=a$1.reactiveElementPolyfillSupport,d$2=(kt,At)=>kt,u$1={toAttribute(kt,At){switch(At){case Boolean:kt=kt?l$1:null;break;case Object:case Array:kt=kt==null?kt:JSON.stringify(kt)}return kt},fromAttribute(kt,At){let xt=kt;switch(At){case Boolean:xt=kt!==null;break;case Number:xt=kt===null?null:Number(kt);break;case Object:case Array:try{xt=JSON.parse(kt)}catch{xt=null}}return xt}},f$5=(kt,At)=>!i$6(kt,At),y$2={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$5};Symbol.metadata??=Symbol("metadata"),a$1.litPropertyMetadata??=new WeakMap;let b$1=class extends HTMLElement{static addInitializer(At){this._$Ei(),(this.l??=[]).push(At)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(At,xt=y$2){if(xt.state&&(xt.attribute=!1),this._$Ei(),this.elementProperties.set(At,xt),!xt.noAccessor){const Bt=Symbol(),Nt=this.getPropertyDescriptor(At,Bt,xt);Nt!==void 0&&e$5(this.prototype,At,Nt)}}static getPropertyDescriptor(At,xt,Bt){const{get:Nt,set:jt}=r$5(this.prototype,At)??{get(){return this[xt]},set(Ut){this[xt]=Ut}};return{get(){return Nt==null?void 0:Nt.call(this)},set(Ut){const Lt=Nt==null?void 0:Nt.call(this);jt.call(this,Ut),this.requestUpdate(At,Lt,Bt)},configurable:!0,enumerable:!0}}static getPropertyOptions(At){return this.elementProperties.get(At)??y$2}static _$Ei(){if(this.hasOwnProperty(d$2("elementProperties")))return;const At=n$3(this);At.finalize(),At.l!==void 0&&(this.l=[...At.l]),this.elementProperties=new Map(At.elementProperties)}static finalize(){if(this.hasOwnProperty(d$2("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d$2("properties"))){const xt=this.properties,Bt=[...h$4(xt),...o$5(xt)];for(const Nt of Bt)this.createProperty(Nt,xt[Nt])}const At=this[Symbol.metadata];if(At!==null){const xt=litPropertyMetadata.get(At);if(xt!==void 0)for(const[Bt,Nt]of xt)this.elementProperties.set(Bt,Nt)}this._$Eh=new Map;for(const[xt,Bt]of this.elementProperties){const Nt=this._$Eu(xt,Bt);Nt!==void 0&&this._$Eh.set(Nt,xt)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(At){const xt=[];if(Array.isArray(At)){const Bt=new Set(At.flat(1/0).reverse());for(const Nt of Bt)xt.unshift(c$3(Nt))}else At!==void 0&&xt.push(c$3(At));return xt}static _$Eu(At,xt){const Bt=xt.attribute;return Bt===!1?void 0:typeof Bt=="string"?Bt:typeof At=="string"?At.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var At;this._$ES=new Promise(xt=>this.enableUpdating=xt),this._$AL=new Map,this._$E_(),this.requestUpdate(),(At=this.constructor.l)==null||At.forEach(xt=>xt(this))}addController(At){var xt;(this._$EO??=new Set).add(At),this.renderRoot!==void 0&&this.isConnected&&((xt=At.hostConnected)==null||xt.call(At))}removeController(At){var xt;(xt=this._$EO)==null||xt.delete(At)}_$E_(){const At=new Map,xt=this.constructor.elementProperties;for(const Bt of xt.keys())this.hasOwnProperty(Bt)&&(At.set(Bt,this[Bt]),delete this[Bt]);At.size>0&&(this._$Ep=At)}createRenderRoot(){const At=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$2(At,this.constructor.elementStyles),At}connectedCallback(){var At;this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),(At=this._$EO)==null||At.forEach(xt=>{var Bt;return(Bt=xt.hostConnected)==null?void 0:Bt.call(xt)})}enableUpdating(At){}disconnectedCallback(){var At;(At=this._$EO)==null||At.forEach(xt=>{var Bt;return(Bt=xt.hostDisconnected)==null?void 0:Bt.call(xt)})}attributeChangedCallback(At,xt,Bt){this._$AK(At,Bt)}_$EC(At,xt){var jt;const Bt=this.constructor.elementProperties.get(At),Nt=this.constructor._$Eu(At,Bt);if(Nt!==void 0&&Bt.reflect===!0){const Ut=(((jt=Bt.converter)==null?void 0:jt.toAttribute)!==void 0?Bt.converter:u$1).toAttribute(xt,Bt.type);this._$Em=At,Ut==null?this.removeAttribute(Nt):this.setAttribute(Nt,Ut),this._$Em=null}}_$AK(At,xt){var jt;const Bt=this.constructor,Nt=Bt._$Eh.get(At);if(Nt!==void 0&&this._$Em!==Nt){const Ut=Bt.getPropertyOptions(Nt),Lt=typeof Ut.converter=="function"?{fromAttribute:Ut.converter}:((jt=Ut.converter)==null?void 0:jt.fromAttribute)!==void 0?Ut.converter:u$1;this._$Em=Nt,this[Nt]=Lt.fromAttribute(xt,Ut.type),this._$Em=null}}requestUpdate(At,xt,Bt){if(At!==void 0){if(Bt??=this.constructor.getPropertyOptions(At),!(Bt.hasChanged??f$5)(this[At],xt))return;this.P(At,xt,Bt)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(At,xt,Bt){this._$AL.has(At)||this._$AL.set(At,xt),Bt.reflect===!0&&this._$Em!==At&&(this._$Ej??=new Set).add(At)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(xt){Promise.reject(xt)}const At=this.scheduleUpdate();return At!=null&&await At,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var Bt;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[jt,Ut]of this._$Ep)this[jt]=Ut;this._$Ep=void 0}const Nt=this.constructor.elementProperties;if(Nt.size>0)for(const[jt,Ut]of Nt)Ut.wrapped!==!0||this._$AL.has(jt)||this[jt]===void 0||this.P(jt,this[jt],Ut)}let At=!1;const xt=this._$AL;try{At=this.shouldUpdate(xt),At?(this.willUpdate(xt),(Bt=this._$EO)==null||Bt.forEach(Nt=>{var jt;return(jt=Nt.hostUpdate)==null?void 0:jt.call(Nt)}),this.update(xt)):this._$EU()}catch(Nt){throw At=!1,this._$EU(),Nt}At&&this._$AE(xt)}willUpdate(At){}_$AE(At){var xt;(xt=this._$EO)==null||xt.forEach(Bt=>{var Nt;return(Nt=Bt.hostUpdated)==null?void 0:Nt.call(Bt)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(At)),this.updated(At)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(At){return!0}update(At){this._$Ej&&=this._$Ej.forEach(xt=>this._$EC(xt,this[xt])),this._$EU()}updated(At){}firstUpdated(At){}};b$1.elementStyles=[],b$1.shadowRootOptions={mode:"open"},b$1[d$2("elementProperties")]=new Map,b$1[d$2("finalized")]=new Map,p$1==null||p$1({ReactiveElement:b$1}),(a$1.reactiveElementVersions??=[]).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const n$2=globalThis,c$1=n$2.trustedTypes,h$3=c$1?c$1.createPolicy("lit-html",{createHTML:kt=>kt}):void 0,f$4="$lit$",v$1=`lit$${Math.random().toFixed(9).slice(2)}$`,m$2="?"+v$1,_$1=`<${m$2}>`,w$2=document,lt$1=()=>w$2.createComment(""),st$1=kt=>kt===null||typeof kt!="object"&&typeof kt!="function",g$3=Array.isArray,$$1=kt=>g$3(kt)||typeof(kt==null?void 0:kt[Symbol.iterator])=="function",x$1=`[ 	
\f\r]`,T$1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,E$3=/-->/g,k$1=/>/g,O$1=RegExp(`>|${x$1}(?:([^\\s"'>=/]+)(${x$1}*=${x$1}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),S$1=/'/g,j$1=/"/g,M$1=/^(?:script|style|textarea|title)$/i,P$3=kt=>(At,...xt)=>({_$litType$:kt,strings:At,values:xt}),ke$2=P$3(1),R$2=Symbol.for("lit-noChange"),D$1=Symbol.for("lit-nothing"),V$1=new WeakMap,I$3=w$2.createTreeWalker(w$2,129);function N$3(kt,At){if(!g$3(kt)||!kt.hasOwnProperty("raw"))throw Error("invalid template strings array");return h$3!==void 0?h$3.createHTML(At):At}const U$1=(kt,At)=>{const xt=kt.length-1,Bt=[];let Nt,jt=At===2?"<svg>":At===3?"<math>":"",Ut=T$1;for(let Lt=0;Lt<xt;Lt++){const Ht=kt[Lt];let Vt,zt,Wt=-1,Jt=0;for(;Jt<Ht.length&&(Ut.lastIndex=Jt,zt=Ut.exec(Ht),zt!==null);)Jt=Ut.lastIndex,Ut===T$1?zt[1]==="!--"?Ut=E$3:zt[1]!==void 0?Ut=k$1:zt[2]!==void 0?(M$1.test(zt[2])&&(Nt=RegExp("</"+zt[2],"g")),Ut=O$1):zt[3]!==void 0&&(Ut=O$1):Ut===O$1?zt[0]===">"?(Ut=Nt??T$1,Wt=-1):zt[1]===void 0?Wt=-2:(Wt=Ut.lastIndex-zt[2].length,Vt=zt[1],Ut=zt[3]===void 0?O$1:zt[3]==='"'?j$1:S$1):Ut===j$1||Ut===S$1?Ut=O$1:Ut===E$3||Ut===k$1?Ut=T$1:(Ut=O$1,Nt=void 0);const Qt=Ut===O$1&&kt[Lt+1].startsWith("/>")?" ":"";jt+=Ut===T$1?Ht+_$1:Wt>=0?(Bt.push(Vt),Ht.slice(0,Wt)+f$4+Ht.slice(Wt)+v$1+Qt):Ht+v$1+(Wt===-2?Lt:Qt)}return[N$3(kt,jt+(kt[xt]||"<?>")+(At===2?"</svg>":At===3?"</math>":"")),Bt]};let B$1=class os{constructor({strings:At,_$litType$:xt},Bt){let Nt;this.parts=[];let jt=0,Ut=0;const Lt=At.length-1,Ht=this.parts,[Vt,zt]=U$1(At,xt);if(this.el=os.createElement(Vt,Bt),I$3.currentNode=this.el.content,xt===2||xt===3){const Wt=this.el.content.firstChild;Wt.replaceWith(...Wt.childNodes)}for(;(Nt=I$3.nextNode())!==null&&Ht.length<Lt;){if(Nt.nodeType===1){if(Nt.hasAttributes())for(const Wt of Nt.getAttributeNames())if(Wt.endsWith(f$4)){const Jt=zt[Ut++],Qt=Nt.getAttribute(Wt).split(v$1),Xt=/([.?@])?(.*)/.exec(Jt);Ht.push({type:1,index:jt,name:Xt[2],strings:Qt,ctor:Xt[1]==="."?Y$1:Xt[1]==="?"?Z$1:Xt[1]==="@"?q$1:G$5}),Nt.removeAttribute(Wt)}else Wt.startsWith(v$1)&&(Ht.push({type:6,index:jt}),Nt.removeAttribute(Wt));if(M$1.test(Nt.tagName)){const Wt=Nt.textContent.split(v$1),Jt=Wt.length-1;if(Jt>0){Nt.textContent=c$1?c$1.emptyScript:"";for(let Qt=0;Qt<Jt;Qt++)Nt.append(Wt[Qt],lt$1()),I$3.nextNode(),Ht.push({type:2,index:++jt});Nt.append(Wt[Jt],lt$1())}}}else if(Nt.nodeType===8)if(Nt.data===m$2)Ht.push({type:2,index:jt});else{let Wt=-1;for(;(Wt=Nt.data.indexOf(v$1,Wt+1))!==-1;)Ht.push({type:7,index:jt}),Wt+=v$1.length-1}jt++}}static createElement(At,xt){const Bt=w$2.createElement("template");return Bt.innerHTML=At,Bt}};function z$1(kt,At,xt=kt,Bt){var Ut,Lt;if(At===R$2)return At;let Nt=Bt!==void 0?(Ut=xt.o)==null?void 0:Ut[Bt]:xt.l;const jt=st$1(At)?void 0:At._$litDirective$;return(Nt==null?void 0:Nt.constructor)!==jt&&((Lt=Nt==null?void 0:Nt._$AO)==null||Lt.call(Nt,!1),jt===void 0?Nt=void 0:(Nt=new jt(kt),Nt._$AT(kt,xt,Bt)),Bt!==void 0?(xt.o??=[])[Bt]=Nt:xt.l=Nt),Nt!==void 0&&(At=z$1(kt,Nt._$AS(kt,At.values),Nt,Bt)),At}let F$1=class{constructor(At,xt){this._$AV=[],this._$AN=void 0,this._$AD=At,this._$AM=xt}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(At){const{el:{content:xt},parts:Bt}=this._$AD,Nt=((At==null?void 0:At.creationScope)??w$2).importNode(xt,!0);I$3.currentNode=Nt;let jt=I$3.nextNode(),Ut=0,Lt=0,Ht=Bt[0];for(;Ht!==void 0;){if(Ut===Ht.index){let Vt;Ht.type===2?Vt=new et$1(jt,jt.nextSibling,this,At):Ht.type===1?Vt=new Ht.ctor(jt,Ht.name,Ht.strings,this,At):Ht.type===6&&(Vt=new K$6(jt,this,At)),this._$AV.push(Vt),Ht=Bt[++Lt]}Ut!==(Ht==null?void 0:Ht.index)&&(jt=I$3.nextNode(),Ut++)}return I$3.currentNode=w$2,Nt}p(At){let xt=0;for(const Bt of this._$AV)Bt!==void 0&&(Bt.strings!==void 0?(Bt._$AI(At,Bt,xt),xt+=Bt.strings.length-2):Bt._$AI(At[xt])),xt++}},et$1=class ss{get _$AU(){var At;return((At=this._$AM)==null?void 0:At._$AU)??this.v}constructor(At,xt,Bt,Nt){this.type=2,this._$AH=D$1,this._$AN=void 0,this._$AA=At,this._$AB=xt,this._$AM=Bt,this.options=Nt,this.v=(Nt==null?void 0:Nt.isConnected)??!0}get parentNode(){let At=this._$AA.parentNode;const xt=this._$AM;return xt!==void 0&&(At==null?void 0:At.nodeType)===11&&(At=xt.parentNode),At}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(At,xt=this){At=z$1(this,At,xt),st$1(At)?At===D$1||At==null||At===""?(this._$AH!==D$1&&this._$AR(),this._$AH=D$1):At!==this._$AH&&At!==R$2&&this._(At):At._$litType$!==void 0?this.$(At):At.nodeType!==void 0?this.T(At):$$1(At)?this.k(At):this._(At)}O(At){return this._$AA.parentNode.insertBefore(At,this._$AB)}T(At){this._$AH!==At&&(this._$AR(),this._$AH=this.O(At))}_(At){this._$AH!==D$1&&st$1(this._$AH)?this._$AA.nextSibling.data=At:this.T(w$2.createTextNode(At)),this._$AH=At}$(At){var jt;const{values:xt,_$litType$:Bt}=At,Nt=typeof Bt=="number"?this._$AC(At):(Bt.el===void 0&&(Bt.el=B$1.createElement(N$3(Bt.h,Bt.h[0]),this.options)),Bt);if(((jt=this._$AH)==null?void 0:jt._$AD)===Nt)this._$AH.p(xt);else{const Ut=new F$1(Nt,this),Lt=Ut.u(this.options);Ut.p(xt),this.T(Lt),this._$AH=Ut}}_$AC(At){let xt=V$1.get(At.strings);return xt===void 0&&V$1.set(At.strings,xt=new B$1(At)),xt}k(At){g$3(this._$AH)||(this._$AH=[],this._$AR());const xt=this._$AH;let Bt,Nt=0;for(const jt of At)Nt===xt.length?xt.push(Bt=new ss(this.O(lt$1()),this.O(lt$1()),this,this.options)):Bt=xt[Nt],Bt._$AI(jt),Nt++;Nt<xt.length&&(this._$AR(Bt&&Bt._$AB.nextSibling,Nt),xt.length=Nt)}_$AR(At=this._$AA.nextSibling,xt){var Bt;for((Bt=this._$AP)==null?void 0:Bt.call(this,!1,!0,xt);At&&At!==this._$AB;){const Nt=At.nextSibling;At.remove(),At=Nt}}setConnected(At){var xt;this._$AM===void 0&&(this.v=At,(xt=this._$AP)==null||xt.call(this,At))}},G$5=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(At,xt,Bt,Nt,jt){this.type=1,this._$AH=D$1,this._$AN=void 0,this.element=At,this.name=xt,this._$AM=Nt,this.options=jt,Bt.length>2||Bt[0]!==""||Bt[1]!==""?(this._$AH=Array(Bt.length-1).fill(new String),this.strings=Bt):this._$AH=D$1}_$AI(At,xt=this,Bt,Nt){const jt=this.strings;let Ut=!1;if(jt===void 0)At=z$1(this,At,xt,0),Ut=!st$1(At)||At!==this._$AH&&At!==R$2,Ut&&(this._$AH=At);else{const Lt=At;let Ht,Vt;for(At=jt[0],Ht=0;Ht<jt.length-1;Ht++)Vt=z$1(this,Lt[Bt+Ht],xt,Ht),Vt===R$2&&(Vt=this._$AH[Ht]),Ut||=!st$1(Vt)||Vt!==this._$AH[Ht],Vt===D$1?At=D$1:At!==D$1&&(At+=(Vt??"")+jt[Ht+1]),this._$AH[Ht]=Vt}Ut&&!Nt&&this.j(At)}j(At){At===D$1?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,At??"")}},Y$1=class extends G$5{constructor(){super(...arguments),this.type=3}j(At){this.element[this.name]=At===D$1?void 0:At}},Z$1=class extends G$5{constructor(){super(...arguments),this.type=4}j(At){this.element.toggleAttribute(this.name,!!At&&At!==D$1)}},q$1=class extends G$5{constructor(At,xt,Bt,Nt,jt){super(At,xt,Bt,Nt,jt),this.type=5}_$AI(At,xt=this){if((At=z$1(this,At,xt,0)??D$1)===R$2)return;const Bt=this._$AH,Nt=At===D$1&&Bt!==D$1||At.capture!==Bt.capture||At.once!==Bt.once||At.passive!==Bt.passive,jt=At!==D$1&&(Bt===D$1||Nt);Nt&&this.element.removeEventListener(this.name,this,Bt),jt&&this.element.addEventListener(this.name,this,At),this._$AH=At}handleEvent(At){var xt;typeof this._$AH=="function"?this._$AH.call(((xt=this.options)==null?void 0:xt.host)??this.element,At):this._$AH.handleEvent(At)}},K$6=class{constructor(At,xt,Bt){this.element=At,this.type=6,this._$AN=void 0,this._$AM=xt,this.options=Bt}get _$AU(){return this._$AM._$AU}_$AI(At){z$1(this,At)}};const Re$1=n$2.litHtmlPolyfillSupport;Re$1==null||Re$1(B$1,et$1),(n$2.litHtmlVersions??=[]).push("3.2.0");const Q$1=(kt,At,xt)=>{const Bt=(xt==null?void 0:xt.renderBefore)??At;let Nt=Bt._$litPart$;if(Nt===void 0){const jt=(xt==null?void 0:xt.renderBefore)??null;Bt._$litPart$=Nt=new et$1(At.insertBefore(lt$1(),jt),jt,void 0,xt??{})}return Nt._$AI(kt),Nt};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let h$2=class extends b$1{constructor(){super(...arguments),this.renderOptions={host:this},this.o=void 0}createRenderRoot(){const At=super.createRenderRoot();return this.renderOptions.renderBefore??=At.firstChild,At}update(At){const xt=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(At),this.o=Q$1(xt,this.renderRoot,this.renderOptions)}connectedCallback(){var At;super.connectedCallback(),(At=this.o)==null||At.setConnected(!0)}disconnectedCallback(){var At;super.disconnectedCallback(),(At=this.o)==null||At.setConnected(!1)}render(){return R$2}};var rs;h$2._$litElement$=!0,h$2.finalized=!0,(rs=globalThis.litElementHydrateSupport)==null||rs.call(globalThis,{LitElement:h$2});const f$3=globalThis.litElementPolyfillSupport;f$3==null||f$3({LitElement:h$2});(globalThis.litElementVersions??=[]).push("4.1.0");/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function defineCustomElement(kt,At="24.4.10"){Object.defineProperty(kt,"version",{get(){return At}});const xt=customElements.get(kt.is);if(!xt)customElements.define(kt.is,kt);else{const Bt=xt.version;Bt&&kt.version&&Bt===kt.version?console.warn(`The component ${kt.is} has been loaded twice`):console.error(`Tried to define ${kt.is} version ${kt.version} when version ${xt.version} is already in use. Something will probably break.`)}}/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class Lumo extends HTMLElement{static get is(){return"vaadin-lumo-styles"}}defineCustomElement(Lumo);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ThemePropertyMixin=kt=>class extends kt{static get properties(){return{_theme:{type:String,readOnly:!0}}}static get observedAttributes(){return[...super.observedAttributes,"theme"]}attributeChangedCallback(xt,Bt,Nt){super.attributeChangedCallback(xt,Bt,Nt),xt==="theme"&&this._set_theme(Nt)}};/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const themeRegistry=[],themableInstances=new Set,themableTagNames=new Set;function classHasThemes(kt){return kt&&Object.prototype.hasOwnProperty.call(kt,"__themes")}function hasThemes(kt){return classHasThemes(customElements.get(kt))}function flattenStyles(kt=[]){return[kt].flat(1/0).filter(At=>At instanceof n$4?!0:(console.warn("An item in styles is not of type CSSResult. Use `unsafeCSS` or `css`."),!1))}function matchesThemeFor(kt,At){return(kt||"").split(" ").some(xt=>new RegExp(`^${xt.split("*").join(".*")}$`,"u").test(At))}function getCssText(kt){return kt.map(At=>At.cssText).join(`
`)}const STYLE_ID="vaadin-themable-mixin-style";function addStylesToTemplate(kt,At){const xt=document.createElement("style");xt.id=STYLE_ID,xt.textContent=getCssText(kt),At.content.appendChild(xt)}function updateInstanceStyles(kt){if(!kt.shadowRoot)return;const At=kt.constructor;if(kt instanceof h$2)[...kt.shadowRoot.querySelectorAll("style")].forEach(xt=>xt.remove()),S$2(kt.shadowRoot,At.elementStyles);else{const xt=kt.shadowRoot.getElementById(STYLE_ID),Bt=At.prototype._template;xt.textContent=Bt.content.getElementById(STYLE_ID).textContent}}function updateInstanceStylesOfType(kt){themableInstances.forEach(At=>{const xt=At.deref();xt instanceof kt?updateInstanceStyles(xt):xt||themableInstances.delete(At)})}function updateComponentStyles(kt){if(kt.prototype instanceof h$2)kt.elementStyles=kt.finalizeStyles(kt.styles);else{const At=kt.prototype._template;At.content.getElementById(STYLE_ID).textContent=getCssText(kt.getStylesForThis())}themableTagNames.forEach(At=>{const xt=customElements.get(At);xt!==kt&&xt.prototype instanceof kt&&updateComponentStyles(xt)})}function hasMatchingStyle(kt,At){const xt=kt.__themes;return!xt||!At?!1:xt.some(Bt=>Bt.styles.some(Nt=>At.some(jt=>jt.cssText===Nt.cssText)))}function registerStyles(kt,At,xt={}){At=flattenStyles(At),window.Vaadin&&window.Vaadin.styleModules?window.Vaadin.styleModules.registerStyles(kt,At,xt):themeRegistry.push({themeFor:kt,styles:At,include:xt.include,moduleId:xt.moduleId}),kt&&themableTagNames.forEach(Bt=>{if(matchesThemeFor(kt,Bt)&&hasThemes(Bt)){const Nt=customElements.get(Bt);hasMatchingStyle(Nt,At)?console.warn(`Registering styles that already exist for ${Bt}`):(!window.Vaadin||!window.Vaadin.suppressPostFinalizeStylesWarning)&&console.warn(`The custom element definition for "${Bt}" was finalized before a style module was registered. Ideally, import component specific style modules before importing the corresponding custom element. This warning can be suppressed by setting "window.Vaadin.suppressPostFinalizeStylesWarning = true".`),updateComponentStyles(Nt),updateInstanceStylesOfType(Nt)}})}function getAllThemes(){return window.Vaadin&&window.Vaadin.styleModules?window.Vaadin.styleModules.getAllThemes():themeRegistry}function getIncludePriority(kt=""){let At=0;return kt.startsWith("lumo-")||kt.startsWith("material-")?At=1:kt.startsWith("vaadin-")&&(At=2),At}function getIncludedStyles(kt){const At=[];return kt.include&&[].concat(kt.include).forEach(xt=>{const Bt=getAllThemes().find(Nt=>Nt.moduleId===xt);Bt?At.push(...getIncludedStyles(Bt),...Bt.styles):console.warn(`Included moduleId ${xt} not found in style registry`)},kt.styles),At}function getThemes(kt){const At=`${kt}-default-theme`,xt=getAllThemes().filter(Bt=>Bt.moduleId!==At&&matchesThemeFor(Bt.themeFor,kt)).map(Bt=>({...Bt,styles:[...getIncludedStyles(Bt),...Bt.styles],includePriority:getIncludePriority(Bt.moduleId)})).sort((Bt,Nt)=>Nt.includePriority-Bt.includePriority);return xt.length>0?xt:getAllThemes().filter(Bt=>Bt.moduleId===At)}const ThemableMixin=kt=>class extends ThemePropertyMixin(kt){constructor(){super(),themableInstances.add(new WeakRef(this))}static finalize(){if(super.finalize(),this.is&&themableTagNames.add(this.is),this.elementStyles)return;const xt=this.prototype._template;!xt||classHasThemes(this)||addStylesToTemplate(this.getStylesForThis(),xt)}static finalizeStyles(xt){const Bt=this.getStylesForThis();return xt?[...[xt].flat(1/0),...Bt]:Bt}static getStylesForThis(){const xt=kt.__themes||[],Bt=Object.getPrototypeOf(this.prototype),Nt=(Bt?Bt.constructor.__themes:[])||[];this.__themes=[...xt,...Nt,...getThemes(this.is)];const jt=this.__themes.flatMap(Ut=>Ut.styles);return jt.filter((Ut,Lt)=>Lt===jt.lastIndexOf(Ut))}};/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const addGlobalThemeStyles=(kt,...At)=>{const xt=document.createElement("style");xt.id=kt,xt.textContent=At.map(Bt=>Bt.toString()).join(`
`).replace(":host","html"),document.head.insertAdjacentElement("afterbegin",xt)},addLumoGlobalStyles=(kt,...At)=>{addGlobalThemeStyles(`lumo-${kt}`,At)};/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const colorBase=i$7`
  :host {
    /* Base (background) */
    --lumo-base-color: #fff;

    /* Tint */
    --lumo-tint-5pct: hsla(0, 0%, 100%, 0.3);
    --lumo-tint-10pct: hsla(0, 0%, 100%, 0.37);
    --lumo-tint-20pct: hsla(0, 0%, 100%, 0.44);
    --lumo-tint-30pct: hsla(0, 0%, 100%, 0.5);
    --lumo-tint-40pct: hsla(0, 0%, 100%, 0.57);
    --lumo-tint-50pct: hsla(0, 0%, 100%, 0.64);
    --lumo-tint-60pct: hsla(0, 0%, 100%, 0.7);
    --lumo-tint-70pct: hsla(0, 0%, 100%, 0.77);
    --lumo-tint-80pct: hsla(0, 0%, 100%, 0.84);
    --lumo-tint-90pct: hsla(0, 0%, 100%, 0.9);
    --lumo-tint: #fff;

    /* Shade */
    --lumo-shade-5pct: hsla(214, 61%, 25%, 0.05);
    --lumo-shade-10pct: hsla(214, 57%, 24%, 0.1);
    --lumo-shade-20pct: hsla(214, 53%, 23%, 0.16);
    --lumo-shade-30pct: hsla(214, 50%, 22%, 0.26);
    --lumo-shade-40pct: hsla(214, 47%, 21%, 0.38);
    --lumo-shade-50pct: hsla(214, 45%, 20%, 0.52);
    --lumo-shade-60pct: hsla(214, 43%, 19%, 0.6);
    --lumo-shade-70pct: hsla(214, 42%, 18%, 0.69);
    --lumo-shade-80pct: hsla(214, 41%, 17%, 0.83);
    --lumo-shade-90pct: hsla(214, 40%, 16%, 0.94);
    --lumo-shade: hsl(214, 35%, 15%);

    /* Contrast */
    --lumo-contrast-5pct: var(--lumo-shade-5pct);
    --lumo-contrast-10pct: var(--lumo-shade-10pct);
    --lumo-contrast-20pct: var(--lumo-shade-20pct);
    --lumo-contrast-30pct: var(--lumo-shade-30pct);
    --lumo-contrast-40pct: var(--lumo-shade-40pct);
    --lumo-contrast-50pct: var(--lumo-shade-50pct);
    --lumo-contrast-60pct: var(--lumo-shade-60pct);
    --lumo-contrast-70pct: var(--lumo-shade-70pct);
    --lumo-contrast-80pct: var(--lumo-shade-80pct);
    --lumo-contrast-90pct: var(--lumo-shade-90pct);
    --lumo-contrast: var(--lumo-shade);

    /* Text */
    --lumo-header-text-color: var(--lumo-contrast);
    --lumo-body-text-color: var(--lumo-contrast-90pct);
    --lumo-secondary-text-color: var(--lumo-contrast-70pct);
    --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
    --lumo-disabled-text-color: var(--lumo-contrast-30pct);

    /* Primary */
    --lumo-primary-color: hsl(214, 100%, 48%);
    --lumo-primary-color-50pct: hsla(214, 100%, 49%, 0.76);
    --lumo-primary-color-10pct: hsla(214, 100%, 60%, 0.13);
    --lumo-primary-text-color: hsl(214, 100%, 43%);
    --lumo-primary-contrast-color: #fff;

    /* Error */
    --lumo-error-color: hsl(3, 85%, 48%);
    --lumo-error-color-50pct: hsla(3, 85%, 49%, 0.5);
    --lumo-error-color-10pct: hsla(3, 85%, 49%, 0.1);
    --lumo-error-text-color: hsl(3, 89%, 42%);
    --lumo-error-contrast-color: #fff;

    /* Success */
    --lumo-success-color: hsl(145, 72%, 30%);
    --lumo-success-color-50pct: hsla(145, 72%, 31%, 0.5);
    --lumo-success-color-10pct: hsla(145, 72%, 31%, 0.1);
    --lumo-success-text-color: hsl(145, 85%, 25%);
    --lumo-success-contrast-color: #fff;

    /* Warning */
    --lumo-warning-color: hsl(48, 100%, 50%);
    --lumo-warning-color-10pct: hsla(48, 100%, 50%, 0.25);
    --lumo-warning-text-color: hsl(32, 100%, 30%);
    --lumo-warning-contrast-color: var(--lumo-shade-90pct);
  }

  /* forced-colors mode adjustments */
  @media (forced-colors: active) {
    html {
      --lumo-disabled-text-color: GrayText;
    }
  }
`;addLumoGlobalStyles("color-props",colorBase);const color=i$7`
  [theme~='dark'] {
    /* Base (background) */
    --lumo-base-color: hsl(214, 35%, 21%);

    /* Tint */
    --lumo-tint-5pct: hsla(214, 65%, 85%, 0.06);
    --lumo-tint-10pct: hsla(214, 60%, 80%, 0.14);
    --lumo-tint-20pct: hsla(214, 64%, 82%, 0.23);
    --lumo-tint-30pct: hsla(214, 69%, 84%, 0.32);
    --lumo-tint-40pct: hsla(214, 73%, 86%, 0.41);
    --lumo-tint-50pct: hsla(214, 78%, 88%, 0.5);
    --lumo-tint-60pct: hsla(214, 82%, 90%, 0.58);
    --lumo-tint-70pct: hsla(214, 87%, 92%, 0.69);
    --lumo-tint-80pct: hsla(214, 91%, 94%, 0.8);
    --lumo-tint-90pct: hsla(214, 96%, 96%, 0.9);
    --lumo-tint: hsl(214, 100%, 98%);

    /* Shade */
    --lumo-shade-5pct: hsla(214, 0%, 0%, 0.07);
    --lumo-shade-10pct: hsla(214, 4%, 2%, 0.15);
    --lumo-shade-20pct: hsla(214, 8%, 4%, 0.23);
    --lumo-shade-30pct: hsla(214, 12%, 6%, 0.32);
    --lumo-shade-40pct: hsla(214, 16%, 8%, 0.41);
    --lumo-shade-50pct: hsla(214, 20%, 10%, 0.5);
    --lumo-shade-60pct: hsla(214, 24%, 12%, 0.6);
    --lumo-shade-70pct: hsla(214, 28%, 13%, 0.7);
    --lumo-shade-80pct: hsla(214, 32%, 13%, 0.8);
    --lumo-shade-90pct: hsla(214, 33%, 13%, 0.9);
    --lumo-shade: hsl(214, 33%, 13%);

    /* Contrast */
    --lumo-contrast-5pct: var(--lumo-tint-5pct);
    --lumo-contrast-10pct: var(--lumo-tint-10pct);
    --lumo-contrast-20pct: var(--lumo-tint-20pct);
    --lumo-contrast-30pct: var(--lumo-tint-30pct);
    --lumo-contrast-40pct: var(--lumo-tint-40pct);
    --lumo-contrast-50pct: var(--lumo-tint-50pct);
    --lumo-contrast-60pct: var(--lumo-tint-60pct);
    --lumo-contrast-70pct: var(--lumo-tint-70pct);
    --lumo-contrast-80pct: var(--lumo-tint-80pct);
    --lumo-contrast-90pct: var(--lumo-tint-90pct);
    --lumo-contrast: var(--lumo-tint);

    /* Text */
    --lumo-header-text-color: var(--lumo-contrast);
    --lumo-body-text-color: var(--lumo-contrast-90pct);
    --lumo-secondary-text-color: var(--lumo-contrast-70pct);
    --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
    --lumo-disabled-text-color: var(--lumo-contrast-30pct);

    /* Primary */
    --lumo-primary-color: hsl(214, 90%, 48%);
    --lumo-primary-color-50pct: hsla(214, 90%, 70%, 0.69);
    --lumo-primary-color-10pct: hsla(214, 90%, 55%, 0.13);
    --lumo-primary-text-color: hsl(214, 90%, 77%);
    --lumo-primary-contrast-color: #fff;

    /* Error */
    --lumo-error-color: hsl(3, 79%, 49%);
    --lumo-error-color-50pct: hsla(3, 75%, 62%, 0.5);
    --lumo-error-color-10pct: hsla(3, 75%, 62%, 0.14);
    --lumo-error-text-color: hsl(3, 100%, 80%);

    /* Success */
    --lumo-success-color: hsl(145, 72%, 30%);
    --lumo-success-color-50pct: hsla(145, 92%, 51%, 0.5);
    --lumo-success-color-10pct: hsla(145, 92%, 51%, 0.1);
    --lumo-success-text-color: hsl(145, 85%, 46%);

    /* Warning */
    --lumo-warning-color: hsl(43, 100%, 48%);
    --lumo-warning-color-10pct: hsla(40, 100%, 50%, 0.2);
    --lumo-warning-text-color: hsl(45, 100%, 60%);
    --lumo-warning-contrast-color: var(--lumo-shade-90pct);
  }

  html {
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
    color-scheme: light;
  }

  [theme~='dark'] {
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
    color-scheme: dark;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--lumo-header-text-color);
  }

  a:where(:any-link) {
    color: var(--lumo-primary-text-color);
  }

  a:not(:any-link) {
    color: var(--lumo-disabled-text-color);
  }

  blockquote {
    color: var(--lumo-secondary-text-color);
  }

  code,
  pre {
    background-color: var(--lumo-contrast-10pct);
    border-radius: var(--lumo-border-radius-m);
  }
  pre code {
    background: transparent;
  }
`;registerStyles("",color,{moduleId:"lumo-color"});/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const spacing=i$7`
  :host {
    /* Square */
    --lumo-space-xs: 0.25rem;
    --lumo-space-s: 0.5rem;
    --lumo-space-m: 1rem;
    --lumo-space-l: 1.5rem;
    --lumo-space-xl: 2.5rem;

    /* Wide */
    --lumo-space-wide-xs: calc(var(--lumo-space-xs) / 2) var(--lumo-space-xs);
    --lumo-space-wide-s: calc(var(--lumo-space-s) / 2) var(--lumo-space-s);
    --lumo-space-wide-m: calc(var(--lumo-space-m) / 2) var(--lumo-space-m);
    --lumo-space-wide-l: calc(var(--lumo-space-l) / 2) var(--lumo-space-l);
    --lumo-space-wide-xl: calc(var(--lumo-space-xl) / 2) var(--lumo-space-xl);

    /* Tall */
    --lumo-space-tall-xs: var(--lumo-space-xs) calc(var(--lumo-space-xs) / 2);
    --lumo-space-tall-s: var(--lumo-space-s) calc(var(--lumo-space-s) / 2);
    --lumo-space-tall-m: var(--lumo-space-m) calc(var(--lumo-space-m) / 2);
    --lumo-space-tall-l: var(--lumo-space-l) calc(var(--lumo-space-l) / 2);
    --lumo-space-tall-xl: var(--lumo-space-xl) calc(var(--lumo-space-xl) / 2);
  }
`;addLumoGlobalStyles("spacing-props",spacing);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const font=i$7`
  :host {
    /* prettier-ignore */
    --lumo-font-family: -apple-system, BlinkMacSystemFont, 'Roboto', 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';

    /* Font sizes */
    --lumo-font-size-xxs: 0.75rem;
    --lumo-font-size-xs: 0.8125rem;
    --lumo-font-size-s: 0.875rem;
    --lumo-font-size-m: 1rem;
    --lumo-font-size-l: 1.125rem;
    --lumo-font-size-xl: 1.375rem;
    --lumo-font-size-xxl: 1.75rem;
    --lumo-font-size-xxxl: 2.5rem;

    /* Line heights */
    --lumo-line-height-xs: 1.25;
    --lumo-line-height-s: 1.375;
    --lumo-line-height-m: 1.625;
  }
`,typography=i$7`
  body,
  :host {
    font-family: var(--lumo-font-family);
    font-size: var(--lumo-font-size-m);
    line-height: var(--lumo-line-height-m);
    -webkit-text-size-adjust: 100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  small,
  [theme~='font-size-s'] {
    font-size: var(--lumo-font-size-s);
    line-height: var(--lumo-line-height-s);
  }

  [theme~='font-size-xs'] {
    font-size: var(--lumo-font-size-xs);
    line-height: var(--lumo-line-height-xs);
  }

  :where(h1, h2, h3, h4, h5, h6) {
    font-weight: 600;
    line-height: var(--lumo-line-height-xs);
    margin-block: 0;
  }

  :where(h1) {
    font-size: var(--lumo-font-size-xxxl);
  }

  :where(h2) {
    font-size: var(--lumo-font-size-xxl);
  }

  :where(h3) {
    font-size: var(--lumo-font-size-xl);
  }

  :where(h4) {
    font-size: var(--lumo-font-size-l);
  }

  :where(h5) {
    font-size: var(--lumo-font-size-m);
  }

  :where(h6) {
    font-size: var(--lumo-font-size-xs);
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  p,
  blockquote {
    margin-top: 0.5em;
    margin-bottom: 0.75em;
  }

  a {
    text-decoration: none;
  }

  a:where(:any-link):hover {
    text-decoration: underline;
  }

  hr {
    display: block;
    align-self: stretch;
    height: 1px;
    border: 0;
    padding: 0;
    margin: var(--lumo-space-s) calc(var(--lumo-border-radius-m) / 2);
    background-color: var(--lumo-contrast-10pct);
  }

  blockquote {
    border-left: 2px solid var(--lumo-contrast-30pct);
  }

  b,
  strong {
    font-weight: 600;
  }

  /* RTL specific styles */
  blockquote[dir='rtl'] {
    border-left: none;
    border-right: 2px solid var(--lumo-contrast-30pct);
  }
`;registerStyles("",typography,{moduleId:"lumo-typography"});addLumoGlobalStyles("typography-props",font);registerStyles("vaadin-app-layout",i$7`
    [part='navbar'],
    [part='drawer'] {
      background-color: var(--lumo-base-color);
      background-clip: padding-box;
    }

    [part='navbar'] {
      min-height: var(--lumo-size-xl);
      border-bottom: 1px solid var(--lumo-contrast-10pct);
    }

    [part='navbar'][bottom] {
      border-bottom: none;
      border-top: 1px solid var(--lumo-contrast-10pct);
    }

    [part='drawer'] {
      border-inline-end: 1px solid var(--lumo-contrast-10pct);
    }

    :host([overlay]) [part='drawer'] {
      border-inline-end: none;
      box-shadow: var(--lumo-box-shadow-s);
    }

    :host([primary-section='navbar']) [part='navbar'] {
      border: none;
      background-image: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct));
    }

    :host([primary-section='drawer']:not([overlay])) [part='drawer'] {
      background-image: linear-gradient(var(--lumo-shade-5pct), var(--lumo-shade-5pct));
    }

    [part='backdrop'] {
      background-color: var(--lumo-shade-20pct);
      opacity: 1;
    }

    [part] ::slotted(h2),
    [part] ::slotted(h3),
    [part] ::slotted(h4) {
      margin-top: var(--lumo-space-xs) !important;
      margin-bottom: var(--lumo-space-xs) !important;
    }
  `,{moduleId:"lumo-app-layout"});/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const testUserAgent=kt=>kt.test(navigator.userAgent),testPlatform=kt=>kt.test(navigator.platform),testVendor=kt=>kt.test(navigator.vendor);testUserAgent(/Android/u);testUserAgent(/Chrome/u)&&testVendor(/Google Inc/u);testUserAgent(/Firefox/u);const isIPad=testPlatform(/^iPad/u)||testPlatform(/^Mac/u)&&navigator.maxTouchPoints>1,isIPhone=testPlatform(/^iPhone/u),isIOS=isIPhone||isIPad;testUserAgent(/^((?!chrome|android).)*safari/iu);const isTouch=(()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}})();/**
 * @license
 * Copyright (c) 2018 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function _detectIosNavbar(){if(isIOS){const kt=window.innerHeight,xt=window.innerWidth>kt,Bt=document.documentElement.clientHeight;xt&&Bt>kt?document.documentElement.style.setProperty("--vaadin-viewport-offset-bottom",`${Bt-kt}px`):document.documentElement.style.setProperty("--vaadin-viewport-offset-bottom","")}}_detectIosNavbar();window.addEventListener("resize",_detectIosNavbar);const template$2=document.createElement("template");template$2.innerHTML=`
  <style>
    /* Use units so that the values can be used in calc() */
    html {
      --safe-area-inset-top: env(safe-area-inset-top, 0px);
      --safe-area-inset-right: env(safe-area-inset-right, 0px);
      --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
      --safe-area-inset-left: env(safe-area-inset-left, 0px);
    }
  </style>
`;document.head.appendChild(template$2.content);/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/window.JSCompiler_renameProperty=function(kt,At){return kt};/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let scheduled=!1,beforeRenderQueue=[],afterRenderQueue=[];function schedule(){scheduled=!0,requestAnimationFrame(function(){scheduled=!1,flushQueue(beforeRenderQueue),setTimeout(function(){runQueue(afterRenderQueue)})})}function flushQueue(kt){for(;kt.length;)callMethod(kt.shift())}function runQueue(kt){for(let At=0,xt=kt.length;At<xt;At++)callMethod(kt.shift())}function callMethod(kt){const At=kt[0],xt=kt[1],Bt=kt[2];try{xt.apply(At,Bt)}catch(Nt){setTimeout(()=>{throw Nt})}}function beforeNextRender(kt,At,xt){scheduled||schedule(),beforeRenderQueue.push([kt,At,xt])}function afterNextRender(kt,At,xt){scheduled||schedule(),afterRenderQueue.push([kt,At,xt])}/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let CSS_URL_RX=/(url\()([^)]*)(\))/g,ABS_URL=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/,workingURL,resolveDoc;function resolveUrl$1(kt,At){if(kt&&ABS_URL.test(kt)||kt==="//")return kt;if(workingURL===void 0){workingURL=!1;try{const xt=new URL("b","http://a");xt.pathname="c%20d",workingURL=xt.href==="http://a/c%20d"}catch{}}if(At||(At=document.baseURI||window.location.href),workingURL)try{return new URL(kt,At).href}catch{return kt}return resolveDoc||(resolveDoc=document.implementation.createHTMLDocument("temp"),resolveDoc.base=resolveDoc.createElement("base"),resolveDoc.head.appendChild(resolveDoc.base),resolveDoc.anchor=resolveDoc.createElement("a"),resolveDoc.body.appendChild(resolveDoc.anchor)),resolveDoc.base.href=At,resolveDoc.anchor.href=kt,resolveDoc.anchor.href||kt}function resolveCss(kt,At){return kt.replace(CSS_URL_RX,function(xt,Bt,Nt,jt){return Bt+"'"+resolveUrl$1(Nt.replace(/["']/g,""),At)+"'"+jt})}function pathFromUrl(kt){return kt.substring(0,kt.lastIndexOf("/")+1)}/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const useShadow=!window.ShadyDOM||!window.ShadyDOM.inUse;!window.ShadyCSS||window.ShadyCSS.nativeCss;const supportsAdoptingStyleSheets=useShadow&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const kt=new CSSStyleSheet;kt.replaceSync("");const At=document.createElement("div");return At.attachShadow({mode:"open"}),At.shadowRoot.adoptedStyleSheets=[kt],At.shadowRoot.adoptedStyleSheets[0]===kt}catch{return!1}})();let rootPath=window.Polymer&&window.Polymer.rootPath||pathFromUrl(document.baseURI||window.location.href),sanitizeDOMValue=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0;window.Polymer&&window.Polymer.setPassiveTouchGestures;let strictTemplatePolicy=window.Polymer&&window.Polymer.strictTemplatePolicy||!1,allowTemplateFromDomModule=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1,legacyOptimizations=window.Polymer&&window.Polymer.legacyOptimizations||!1,legacyWarnings=window.Polymer&&window.Polymer.legacyWarnings||!1,syncInitialRender=window.Polymer&&window.Polymer.syncInitialRender||!1,legacyUndefined=window.Polymer&&window.Polymer.legacyUndefined||!1,orderedComputed=window.Polymer&&window.Polymer.orderedComputed||!1,removeNestedTemplates=window.Polymer&&window.Polymer.removeNestedTemplates||!1,fastDomIf=window.Polymer&&window.Polymer.fastDomIf||!1;window.Polymer&&window.Polymer.suppressTemplateNotifications;window.Polymer&&window.Polymer.legacyNoObservedAttributes;let useAdoptedStyleSheetsWithBuiltCSS=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1;/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let dedupeId$1=0;const dedupingMixin=function(kt){let At=kt.__mixinApplications;At||(At=new WeakMap,kt.__mixinApplications=At);let xt=dedupeId$1++;function Bt(Nt){let jt=Nt.__mixinSet;if(jt&&jt[xt])return Nt;let Ut=At,Lt=Ut.get(Nt);if(!Lt){Lt=kt(Nt),Ut.set(Nt,Lt);let Ht=Object.create(Lt.__mixinSet||jt||null);Ht[xt]=!0,Lt.__mixinSet=Ht}return Lt}return Bt};/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let modules={},lcModules={};function setModule(kt,At){modules[kt]=lcModules[kt.toLowerCase()]=At}function findModule(kt){return modules[kt]||lcModules[kt.toLowerCase()]}function styleOutsideTemplateCheck(kt){kt.querySelector("style")&&console.warn("dom-module %s has style outside template",kt.id)}class DomModule extends HTMLElement{static get observedAttributes(){return["id"]}static import(At,xt){if(At){let Bt=findModule(At);return Bt&&xt?Bt.querySelector(xt):Bt}return null}attributeChangedCallback(At,xt,Bt,Nt){xt!==Bt&&this.register()}get assetpath(){if(!this.__assetpath){const At=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,xt=resolveUrl$1(this.getAttribute("assetpath")||"",At.baseURI);this.__assetpath=pathFromUrl(xt)}return this.__assetpath}register(At){if(At=At||this.id,At){if(strictTemplatePolicy&&findModule(At)!==void 0)throw setModule(At,null),new Error(`strictTemplatePolicy: dom-module ${At} re-registered`);this.id=At,setModule(At,this),styleOutsideTemplateCheck(this)}}}DomModule.prototype.modules=modules;customElements.define("dom-module",DomModule);/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const MODULE_STYLE_LINK_SELECTOR="link[rel=import][type~=css]",INCLUDE_ATTR="include",SHADY_UNSCOPED_ATTR="shady-unscoped";function importModule(kt){return DomModule.import(kt)}function styleForImport(kt){let At=kt.body?kt.body:kt;const xt=resolveCss(At.textContent,kt.baseURI),Bt=document.createElement("style");return Bt.textContent=xt,Bt}function stylesFromModules(kt){const At=kt.trim().split(/\s+/),xt=[];for(let Bt=0;Bt<At.length;Bt++)xt.push(...stylesFromModule(At[Bt]));return xt}function stylesFromModule(kt){const At=importModule(kt);if(!At)return console.warn("Could not find style data in module named",kt),[];if(At._styles===void 0){const xt=[];xt.push(..._stylesFromModuleImports(At));const Bt=At.querySelector("template");Bt&&xt.push(...stylesFromTemplate(Bt,At.assetpath)),At._styles=xt}return At._styles}function stylesFromTemplate(kt,At){if(!kt._styles){const xt=[],Bt=kt.content.querySelectorAll("style");for(let Nt=0;Nt<Bt.length;Nt++){let jt=Bt[Nt],Ut=jt.getAttribute(INCLUDE_ATTR);Ut&&xt.push(...stylesFromModules(Ut).filter(function(Lt,Ht,Vt){return Vt.indexOf(Lt)===Ht})),At&&(jt.textContent=resolveCss(jt.textContent,At)),xt.push(jt)}kt._styles=xt}return kt._styles}function stylesFromModuleImports(kt){let At=importModule(kt);return At?_stylesFromModuleImports(At):[]}function _stylesFromModuleImports(kt){const At=[],xt=kt.querySelectorAll(MODULE_STYLE_LINK_SELECTOR);for(let Bt=0;Bt<xt.length;Bt++){let Nt=xt[Bt];if(Nt.import){const jt=Nt.import,Ut=Nt.hasAttribute(SHADY_UNSCOPED_ATTR);if(Ut&&!jt._unscopedStyle){const Lt=styleForImport(jt);Lt.setAttribute(SHADY_UNSCOPED_ATTR,""),jt._unscopedStyle=Lt}else jt._style||(jt._style=styleForImport(jt));At.push(Ut?jt._unscopedStyle:jt._style)}}return At}/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const wrap$1=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?kt=>ShadyDOM.patch(kt):kt=>kt;/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function isPath(kt){return kt.indexOf(".")>=0}function root$2(kt){let At=kt.indexOf(".");return At===-1?kt:kt.slice(0,At)}function isAncestor(kt,At){return kt.indexOf(At+".")===0}function isDescendant(kt,At){return At.indexOf(kt+".")===0}function translate(kt,At,xt){return At+xt.slice(kt.length)}function normalize$1(kt){if(Array.isArray(kt)){let At=[];for(let xt=0;xt<kt.length;xt++){let Bt=kt[xt].toString().split(".");for(let Nt=0;Nt<Bt.length;Nt++)At.push(Bt[Nt])}return At.join(".")}else return kt}function split$2(kt){return Array.isArray(kt)?normalize$1(kt).split("."):kt.toString().split(".")}function get$2(kt,At,xt){let Bt=kt,Nt=split$2(At);for(let jt=0;jt<Nt.length;jt++){if(!Bt)return;let Ut=Nt[jt];Bt=Bt[Ut]}return xt&&(xt.path=Nt.join(".")),Bt}function set$1(kt,At,xt){let Bt=kt,Nt=split$2(At),jt=Nt[Nt.length-1];if(Nt.length>1){for(let Ut=0;Ut<Nt.length-1;Ut++){let Lt=Nt[Ut];if(Bt=Bt[Lt],!Bt)return}Bt[jt]=xt}else Bt[At]=xt;return Nt.join(".")}/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const caseMap$1={},DASH_TO_CAMEL=/-[a-z]/g,CAMEL_TO_DASH$1=/([A-Z])/g;function dashToCamelCase(kt){return caseMap$1[kt]||(caseMap$1[kt]=kt.indexOf("-")<0?kt:kt.replace(DASH_TO_CAMEL,At=>At[1].toUpperCase()))}function camelToDashCase(kt){return caseMap$1[kt]||(caseMap$1[kt]=kt.replace(CAMEL_TO_DASH$1,"-$1").toLowerCase())}/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let microtaskCurrHandle$1=0,microtaskLastHandle$1=0,microtaskCallbacks$1=[],microtaskNodeContent=0,microtaskScheduled$1=!1,microtaskNode=document.createTextNode("");new window.MutationObserver(microtaskFlush$1).observe(microtaskNode,{characterData:!0});function microtaskFlush$1(){microtaskScheduled$1=!1;const kt=microtaskCallbacks$1.length;for(let At=0;At<kt;At++){let xt=microtaskCallbacks$1[At];if(xt)try{xt()}catch(Bt){setTimeout(()=>{throw Bt})}}microtaskCallbacks$1.splice(0,kt),microtaskLastHandle$1+=kt}const microTask$1={run(kt){return microtaskScheduled$1||(microtaskScheduled$1=!0,microtaskNode.textContent=microtaskNodeContent++),microtaskCallbacks$1.push(kt),microtaskCurrHandle$1++},cancel(kt){const At=kt-microtaskLastHandle$1;if(At>=0){if(!microtaskCallbacks$1[At])throw new Error("invalid async handle: "+kt);microtaskCallbacks$1[At]=null}}};/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const microtask=microTask$1,PropertiesChanged=dedupingMixin(kt=>{class At extends kt{static createProperties(Bt){const Nt=this.prototype;for(let jt in Bt)jt in Nt||Nt._createPropertyAccessor(jt)}static attributeNameForProperty(Bt){return Bt.toLowerCase()}static typeForProperty(Bt){}_createPropertyAccessor(Bt,Nt){this._addPropertyToAttributeMap(Bt),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[Bt]||(this.__dataHasAccessor[Bt]=!0,this._definePropertyAccessor(Bt,Nt))}_addPropertyToAttributeMap(Bt){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let Nt=this.__dataAttributes[Bt];return Nt||(Nt=this.constructor.attributeNameForProperty(Bt),this.__dataAttributes[Nt]=Bt),Nt}_definePropertyAccessor(Bt,Nt){Object.defineProperty(this,Bt,{get(){return this.__data[Bt]},set:Nt?function(){}:function(jt){this._setPendingProperty(Bt,jt,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let Bt in this.__dataHasAccessor)this.hasOwnProperty(Bt)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[Bt]=this[Bt],delete this[Bt])}_initializeInstanceProperties(Bt){Object.assign(this,Bt)}_setProperty(Bt,Nt){this._setPendingProperty(Bt,Nt)&&this._invalidateProperties()}_getProperty(Bt){return this.__data[Bt]}_setPendingProperty(Bt,Nt,jt){let Ut=this.__data[Bt],Lt=this._shouldPropertyChange(Bt,Nt,Ut);return Lt&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),this.__dataOld&&!(Bt in this.__dataOld)&&(this.__dataOld[Bt]=Ut),this.__data[Bt]=Nt,this.__dataPending[Bt]=Nt),Lt}_isPropertyPending(Bt){return!!(this.__dataPending&&this.__dataPending.hasOwnProperty(Bt))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,microtask.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;const Bt=this.__data,Nt=this.__dataPending,jt=this.__dataOld;this._shouldPropertiesChange(Bt,Nt,jt)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(Bt,Nt,jt)),this.__dataCounter--}_shouldPropertiesChange(Bt,Nt,jt){return!!Nt}_propertiesChanged(Bt,Nt,jt){}_shouldPropertyChange(Bt,Nt,jt){return jt!==Nt&&(jt===jt||Nt===Nt)}attributeChangedCallback(Bt,Nt,jt,Ut){Nt!==jt&&this._attributeToProperty(Bt,jt),super.attributeChangedCallback&&super.attributeChangedCallback(Bt,Nt,jt,Ut)}_attributeToProperty(Bt,Nt,jt){if(!this.__serializing){const Ut=this.__dataAttributes,Lt=Ut&&Ut[Bt]||Bt;this[Lt]=this._deserializeValue(Nt,jt||this.constructor.typeForProperty(Lt))}}_propertyToAttribute(Bt,Nt,jt){this.__serializing=!0,jt=arguments.length<3?this[Bt]:jt,this._valueToNodeAttribute(this,jt,Nt||this.constructor.attributeNameForProperty(Bt)),this.__serializing=!1}_valueToNodeAttribute(Bt,Nt,jt){const Ut=this._serializeValue(Nt);(jt==="class"||jt==="name"||jt==="slot")&&(Bt=wrap$1(Bt)),Ut===void 0?Bt.removeAttribute(jt):Bt.setAttribute(jt,Ut===""&&window.trustedTypes?window.trustedTypes.emptyScript:Ut)}_serializeValue(Bt){switch(typeof Bt){case"boolean":return Bt?"":void 0;default:return Bt!=null?Bt.toString():void 0}}_deserializeValue(Bt,Nt){switch(Nt){case Boolean:return Bt!==null;case Number:return Number(Bt);default:return Bt}}}return At});/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const nativeProperties={};let proto$1=HTMLElement.prototype;for(;proto$1;){let kt=Object.getOwnPropertyNames(proto$1);for(let At=0;At<kt.length;At++)nativeProperties[kt[At]]=!0;proto$1=Object.getPrototypeOf(proto$1)}const isTrustedType=window.trustedTypes?kt=>trustedTypes.isHTML(kt)||trustedTypes.isScript(kt)||trustedTypes.isScriptURL(kt):()=>!1;function saveAccessorValue(kt,At){if(!nativeProperties[At]){let xt=kt[At];xt!==void 0&&(kt.__data?kt._setPendingProperty(At,xt):(kt.__dataProto?kt.hasOwnProperty(JSCompiler_renameProperty("__dataProto",kt))||(kt.__dataProto=Object.create(kt.__dataProto)):kt.__dataProto={},kt.__dataProto[At]=xt))}}const PropertyAccessors=dedupingMixin(kt=>{const At=PropertiesChanged(kt);class xt extends At{static createPropertiesForAttributes(){let Nt=this.observedAttributes;for(let jt=0;jt<Nt.length;jt++)this.prototype._createPropertyAccessor(dashToCamelCase(Nt[jt]))}static attributeNameForProperty(Nt){return camelToDashCase(Nt)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(Nt){for(let jt in Nt)this._setProperty(jt,Nt[jt])}_ensureAttribute(Nt,jt){const Ut=this;Ut.hasAttribute(Nt)||this._valueToNodeAttribute(Ut,jt,Nt)}_serializeValue(Nt){switch(typeof Nt){case"object":if(Nt instanceof Date)return Nt.toString();if(Nt){if(isTrustedType(Nt))return Nt;try{return JSON.stringify(Nt)}catch{return""}}default:return super._serializeValue(Nt)}}_deserializeValue(Nt,jt){let Ut;switch(jt){case Object:try{Ut=JSON.parse(Nt)}catch{Ut=Nt}break;case Array:try{Ut=JSON.parse(Nt)}catch{Ut=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${Nt}`)}break;case Date:Ut=isNaN(Nt)?String(Nt):Number(Nt),Ut=new Date(Ut);break;default:Ut=super._deserializeValue(Nt,jt);break}return Ut}_definePropertyAccessor(Nt,jt){saveAccessorValue(this,Nt),super._definePropertyAccessor(Nt,jt)}_hasAccessor(Nt){return this.__dataHasAccessor&&this.__dataHasAccessor[Nt]}_isPropertyPending(Nt){return!!(this.__dataPending&&Nt in this.__dataPending)}}return xt});/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const templateExtensions={"dom-if":!0,"dom-repeat":!0};let placeholderBugDetect=!1,placeholderBug=!1;function hasPlaceholderBug(){if(!placeholderBugDetect){placeholderBugDetect=!0;const kt=document.createElement("textarea");kt.placeholder="a",placeholderBug=kt.placeholder===kt.textContent}return placeholderBug}function fixPlaceholder(kt){hasPlaceholderBug()&&kt.localName==="textarea"&&kt.placeholder&&kt.placeholder===kt.textContent&&(kt.textContent=null)}const copyAttributeWithTemplateEventPolicy=(()=>{const kt=window.trustedTypes&&window.trustedTypes.createPolicy("polymer-template-event-attribute-policy",{createScript:At=>At});return(At,xt,Bt)=>{const Nt=xt.getAttribute(Bt);if(kt&&Bt.startsWith("on-")){At.setAttribute(Bt,kt.createScript(Nt,Bt));return}At.setAttribute(Bt,Nt)}})();function wrapTemplateExtension(kt){let At=kt.getAttribute("is");if(At&&templateExtensions[At]){let xt=kt;for(xt.removeAttribute("is"),kt=xt.ownerDocument.createElement(At),xt.parentNode.replaceChild(kt,xt),kt.appendChild(xt);xt.attributes.length;){const{name:Bt}=xt.attributes[0];copyAttributeWithTemplateEventPolicy(kt,xt,Bt),xt.removeAttribute(Bt)}}return kt}function findTemplateNode(kt,At){let xt=At.parentInfo&&findTemplateNode(kt,At.parentInfo);if(xt){for(let Bt=xt.firstChild,Nt=0;Bt;Bt=Bt.nextSibling)if(At.parentIndex===Nt++)return Bt}else return kt}function applyIdToMap(kt,At,xt,Bt){Bt.id&&(At[Bt.id]=xt)}function applyEventListener(kt,At,xt){if(xt.events&&xt.events.length)for(let Bt=0,Nt=xt.events,jt;Bt<Nt.length&&(jt=Nt[Bt]);Bt++)kt._addMethodEventListenerToNode(At,jt.name,jt.value,kt)}function applyTemplateInfo(kt,At,xt,Bt){xt.templateInfo&&(At._templateInfo=xt.templateInfo,At._parentTemplateInfo=Bt)}function createNodeEventHandler(kt,At,xt){return kt=kt._methodHost||kt,function(Nt){kt[xt]?kt[xt](Nt,Nt.detail):console.warn("listener method `"+xt+"` not defined")}}const TemplateStamp=dedupingMixin(kt=>{class At extends kt{static _parseTemplate(Bt,Nt){if(!Bt._templateInfo){let jt=Bt._templateInfo={};jt.nodeInfoList=[],jt.nestedTemplate=!!Nt,jt.stripWhiteSpace=Nt&&Nt.stripWhiteSpace||Bt.hasAttribute&&Bt.hasAttribute("strip-whitespace"),this._parseTemplateContent(Bt,jt,{parent:null})}return Bt._templateInfo}static _parseTemplateContent(Bt,Nt,jt){return this._parseTemplateNode(Bt.content,Nt,jt)}static _parseTemplateNode(Bt,Nt,jt){let Ut=!1,Lt=Bt;return Lt.localName=="template"&&!Lt.hasAttribute("preserve-content")?Ut=this._parseTemplateNestedTemplate(Lt,Nt,jt)||Ut:Lt.localName==="slot"&&(Nt.hasInsertionPoint=!0),fixPlaceholder(Lt),Lt.firstChild&&this._parseTemplateChildNodes(Lt,Nt,jt),Lt.hasAttributes&&Lt.hasAttributes()&&(Ut=this._parseTemplateNodeAttributes(Lt,Nt,jt)||Ut),Ut||jt.noted}static _parseTemplateChildNodes(Bt,Nt,jt){if(!(Bt.localName==="script"||Bt.localName==="style"))for(let Ut=Bt.firstChild,Lt=0,Ht;Ut;Ut=Ht){if(Ut.localName=="template"&&(Ut=wrapTemplateExtension(Ut)),Ht=Ut.nextSibling,Ut.nodeType===Node.TEXT_NODE){let zt=Ht;for(;zt&&zt.nodeType===Node.TEXT_NODE;)Ut.textContent+=zt.textContent,Ht=zt.nextSibling,Bt.removeChild(zt),zt=Ht;if(Nt.stripWhiteSpace&&!Ut.textContent.trim()){Bt.removeChild(Ut);continue}}let Vt={parentIndex:Lt,parentInfo:jt};this._parseTemplateNode(Ut,Nt,Vt)&&(Vt.infoIndex=Nt.nodeInfoList.push(Vt)-1),Ut.parentNode&&Lt++}}static _parseTemplateNestedTemplate(Bt,Nt,jt){let Ut=Bt,Lt=this._parseTemplate(Ut,Nt);return(Lt.content=Ut.content.ownerDocument.createDocumentFragment()).appendChild(Ut.content),jt.templateInfo=Lt,!0}static _parseTemplateNodeAttributes(Bt,Nt,jt){let Ut=!1,Lt=Array.from(Bt.attributes);for(let Ht=Lt.length-1,Vt;Vt=Lt[Ht];Ht--)Ut=this._parseTemplateNodeAttribute(Bt,Nt,jt,Vt.name,Vt.value)||Ut;return Ut}static _parseTemplateNodeAttribute(Bt,Nt,jt,Ut,Lt){return Ut.slice(0,3)==="on-"?(Bt.removeAttribute(Ut),jt.events=jt.events||[],jt.events.push({name:Ut.slice(3),value:Lt}),!0):Ut==="id"?(jt.id=Lt,!0):!1}static _contentForTemplate(Bt){let Nt=Bt._templateInfo;return Nt&&Nt.content||Bt.content}_stampTemplate(Bt,Nt){Bt&&!Bt.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(Bt),Nt=Nt||this.constructor._parseTemplate(Bt);let jt=Nt.nodeInfoList,Ut=Nt.content||Bt.content,Lt=document.importNode(Ut,!0);Lt.__noInsertionPoint=!Nt.hasInsertionPoint;let Ht=Lt.nodeList=new Array(jt.length);Lt.$={};for(let Vt=0,zt=jt.length,Wt;Vt<zt&&(Wt=jt[Vt]);Vt++){let Jt=Ht[Vt]=findTemplateNode(Lt,Wt);applyIdToMap(this,Lt.$,Jt,Wt),applyTemplateInfo(this,Jt,Wt,Nt),applyEventListener(this,Jt,Wt)}return Lt=Lt,Lt}_addMethodEventListenerToNode(Bt,Nt,jt,Ut){Ut=Ut||Bt;let Lt=createNodeEventHandler(Ut,Nt,jt);return this._addEventListenerToNode(Bt,Nt,Lt),Lt}_addEventListenerToNode(Bt,Nt,jt){Bt.addEventListener(Nt,jt)}_removeEventListenerFromNode(Bt,Nt,jt){Bt.removeEventListener(Nt,jt)}}return At});/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */let dedupeId=0;const NOOP=[],TYPES={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},COMPUTE_INFO="__computeInfo",capitalAttributeRegex=/[A-Z]/;function ensureOwnEffectMap(kt,At,xt){let Bt=kt[At];if(!Bt)Bt=kt[At]={};else if(!kt.hasOwnProperty(At)&&(Bt=kt[At]=Object.create(kt[At]),xt))for(let Nt in Bt){let jt=Bt[Nt],Ut=Bt[Nt]=Array(jt.length);for(let Lt=0;Lt<jt.length;Lt++)Ut[Lt]=jt[Lt]}return Bt}function runEffects(kt,At,xt,Bt,Nt,jt){if(At){let Ut=!1;const Lt=dedupeId++;for(let Ht in xt){let Vt=Nt?root$2(Ht):Ht,zt=At[Vt];if(zt)for(let Wt=0,Jt=zt.length,Qt;Wt<Jt&&(Qt=zt[Wt]);Wt++)(!Qt.info||Qt.info.lastRun!==Lt)&&(!Nt||pathMatchesTrigger(Ht,Qt.trigger))&&(Qt.info&&(Qt.info.lastRun=Lt),Qt.fn(kt,Ht,xt,Bt,Qt.info,Nt,jt),Ut=!0)}return Ut}return!1}function runEffectsForProperty(kt,At,xt,Bt,Nt,jt,Ut,Lt){let Ht=!1,Vt=Ut?root$2(Bt):Bt,zt=At[Vt];if(zt)for(let Wt=0,Jt=zt.length,Qt;Wt<Jt&&(Qt=zt[Wt]);Wt++)(!Qt.info||Qt.info.lastRun!==xt)&&(!Ut||pathMatchesTrigger(Bt,Qt.trigger))&&(Qt.info&&(Qt.info.lastRun=xt),Qt.fn(kt,Bt,Nt,jt,Qt.info,Ut,Lt),Ht=!0);return Ht}function pathMatchesTrigger(kt,At){if(At){let xt=At.name;return xt==kt||!!(At.structured&&isAncestor(xt,kt))||!!(At.wildcard&&isDescendant(xt,kt))}else return!0}function runObserverEffect(kt,At,xt,Bt,Nt){let jt=typeof Nt.method=="string"?kt[Nt.method]:Nt.method,Ut=Nt.property;jt?jt.call(kt,kt.__data[Ut],Bt[Ut]):Nt.dynamicFn||console.warn("observer method `"+Nt.method+"` not defined")}function runNotifyEffects(kt,At,xt,Bt,Nt){let jt=kt[TYPES.NOTIFY],Ut,Lt=dedupeId++;for(let Vt in At)At[Vt]&&(jt&&runEffectsForProperty(kt,jt,Lt,Vt,xt,Bt,Nt)||Nt&&notifyPath(kt,Vt,xt))&&(Ut=!0);let Ht;Ut&&(Ht=kt.__dataHost)&&Ht._invalidateProperties&&Ht._invalidateProperties()}function notifyPath(kt,At,xt){let Bt=root$2(At);if(Bt!==At){let Nt=camelToDashCase(Bt)+"-changed";return dispatchNotifyEvent(kt,Nt,xt[At],At),!0}return!1}function dispatchNotifyEvent(kt,At,xt,Bt){let Nt={value:xt,queueProperty:!0};Bt&&(Nt.path=Bt),wrap$1(kt).dispatchEvent(new CustomEvent(At,{detail:Nt}))}function runNotifyEffect(kt,At,xt,Bt,Nt,jt){let Lt=(jt?root$2(At):At)!=At?At:null,Ht=Lt?get$2(kt,Lt):kt.__data[At];Lt&&Ht===void 0&&(Ht=xt[At]),dispatchNotifyEvent(kt,Nt.eventName,Ht,Lt)}function handleNotification(kt,At,xt,Bt,Nt){let jt,Ut=kt.detail,Lt=Ut&&Ut.path;Lt?(Bt=translate(xt,Bt,Lt),jt=Ut&&Ut.value):jt=kt.currentTarget[xt],jt=Nt?!jt:jt,(!At[TYPES.READ_ONLY]||!At[TYPES.READ_ONLY][Bt])&&At._setPendingPropertyOrPath(Bt,jt,!0,!!Lt)&&(!Ut||!Ut.queueProperty)&&At._invalidateProperties()}function runReflectEffect(kt,At,xt,Bt,Nt){let jt=kt.__data[At];sanitizeDOMValue&&(jt=sanitizeDOMValue(jt,Nt.attrName,"attribute",kt)),kt._propertyToAttribute(At,Nt.attrName,jt)}function runComputedEffects(kt,At,xt,Bt){let Nt=kt[TYPES.COMPUTE];if(Nt)if(orderedComputed){dedupeId++;const jt=getComputedOrder(kt),Ut=[];for(let Ht in At)enqueueEffectsFor(Ht,Nt,Ut,jt,Bt);let Lt;for(;Lt=Ut.shift();)runComputedEffect(kt,"",At,xt,Lt)&&enqueueEffectsFor(Lt.methodInfo,Nt,Ut,jt,Bt);Object.assign(xt,kt.__dataOld),Object.assign(At,kt.__dataPending),kt.__dataPending=null}else{let jt=At;for(;runEffects(kt,Nt,jt,xt,Bt);)Object.assign(xt,kt.__dataOld),Object.assign(At,kt.__dataPending),jt=kt.__dataPending,kt.__dataPending=null}}const insertEffect=(kt,At,xt)=>{let Bt=0,Nt=At.length-1,jt=-1;for(;Bt<=Nt;){const Ut=Bt+Nt>>1,Lt=xt.get(At[Ut].methodInfo)-xt.get(kt.methodInfo);if(Lt<0)Bt=Ut+1;else if(Lt>0)Nt=Ut-1;else{jt=Ut;break}}jt<0&&(jt=Nt+1),At.splice(jt,0,kt)},enqueueEffectsFor=(kt,At,xt,Bt,Nt)=>{const jt=Nt?root$2(kt):kt,Ut=At[jt];if(Ut)for(let Lt=0;Lt<Ut.length;Lt++){const Ht=Ut[Lt];Ht.info.lastRun!==dedupeId&&(!Nt||pathMatchesTrigger(kt,Ht.trigger))&&(Ht.info.lastRun=dedupeId,insertEffect(Ht.info,xt,Bt))}};function getComputedOrder(kt){let At=kt.constructor.__orderedComputedDeps;if(!At){At=new Map;const xt=kt[TYPES.COMPUTE];let{counts:Bt,ready:Nt,total:jt}=dependencyCounts(kt),Ut;for(;Ut=Nt.shift();){At.set(Ut,At.size);const Lt=xt[Ut];Lt&&Lt.forEach(Ht=>{const Vt=Ht.info.methodInfo;--jt,--Bt[Vt]===0&&Nt.push(Vt)})}jt!==0&&console.warn(`Computed graph for ${kt.localName} incomplete; circular?`),kt.constructor.__orderedComputedDeps=At}return At}function dependencyCounts(kt){const At=kt[COMPUTE_INFO],xt={},Bt=kt[TYPES.COMPUTE],Nt=[];let jt=0;for(let Ut in At){const Lt=At[Ut];jt+=xt[Ut]=Lt.args.filter(Ht=>!Ht.literal).length+(Lt.dynamicFn?1:0)}for(let Ut in Bt)At[Ut]||Nt.push(Ut);return{counts:xt,ready:Nt,total:jt}}function runComputedEffect(kt,At,xt,Bt,Nt){let jt=runMethodEffect(kt,At,xt,Bt,Nt);if(jt===NOOP)return!1;let Ut=Nt.methodInfo;return kt.__dataHasAccessor&&kt.__dataHasAccessor[Ut]?kt._setPendingProperty(Ut,jt,!0):(kt[Ut]=jt,!1)}function computeLinkedPaths(kt,At,xt){let Bt=kt.__dataLinkedPaths;if(Bt){let Nt;for(let jt in Bt){let Ut=Bt[jt];isDescendant(jt,At)?(Nt=translate(jt,Ut,At),kt._setPendingPropertyOrPath(Nt,xt,!0,!0)):isDescendant(Ut,At)&&(Nt=translate(Ut,jt,At),kt._setPendingPropertyOrPath(Nt,xt,!0,!0))}}}function addBinding(kt,At,xt,Bt,Nt,jt,Ut){xt.bindings=xt.bindings||[];let Lt={kind:Bt,target:Nt,parts:jt,literal:Ut,isCompound:jt.length!==1};if(xt.bindings.push(Lt),shouldAddListener(Lt)){let{event:Vt,negate:zt}=Lt.parts[0];Lt.listenerEvent=Vt||camelToDashCase(Nt)+"-changed",Lt.listenerNegate=zt}let Ht=At.nodeInfoList.length;for(let Vt=0;Vt<Lt.parts.length;Vt++){let zt=Lt.parts[Vt];zt.compoundIndex=Vt,addEffectForBindingPart(kt,At,Lt,zt,Ht)}}function addEffectForBindingPart(kt,At,xt,Bt,Nt){if(!Bt.literal)if(xt.kind==="attribute"&&xt.target[0]==="-")console.warn("Cannot set attribute "+xt.target+' because "-" is not a valid attribute starting character');else{let jt=Bt.dependencies,Ut={index:Nt,binding:xt,part:Bt,evaluator:kt};for(let Lt=0;Lt<jt.length;Lt++){let Ht=jt[Lt];typeof Ht=="string"&&(Ht=parseArg(Ht),Ht.wildcard=!0),kt._addTemplatePropertyEffect(At,Ht.rootProperty,{fn:runBindingEffect,info:Ut,trigger:Ht})}}}function runBindingEffect(kt,At,xt,Bt,Nt,jt,Ut){let Lt=Ut[Nt.index],Ht=Nt.binding,Vt=Nt.part;if(jt&&Vt.source&&At.length>Vt.source.length&&Ht.kind=="property"&&!Ht.isCompound&&Lt.__isPropertyEffectsClient&&Lt.__dataHasAccessor&&Lt.__dataHasAccessor[Ht.target]){let zt=xt[At];At=translate(Vt.source,Ht.target,At),Lt._setPendingPropertyOrPath(At,zt,!1,!0)&&kt._enqueueClient(Lt)}else{let zt=Nt.evaluator._evaluateBinding(kt,Vt,At,xt,Bt,jt);zt!==NOOP&&applyBindingValue(kt,Lt,Ht,Vt,zt)}}function applyBindingValue(kt,At,xt,Bt,Nt){if(Nt=computeBindingValue(At,Nt,xt,Bt),sanitizeDOMValue&&(Nt=sanitizeDOMValue(Nt,xt.target,xt.kind,At)),xt.kind=="attribute")kt._valueToNodeAttribute(At,Nt,xt.target);else{let jt=xt.target;At.__isPropertyEffectsClient&&At.__dataHasAccessor&&At.__dataHasAccessor[jt]?(!At[TYPES.READ_ONLY]||!At[TYPES.READ_ONLY][jt])&&At._setPendingProperty(jt,Nt)&&kt._enqueueClient(At):kt._setUnmanagedPropertyToNode(At,jt,Nt)}}function computeBindingValue(kt,At,xt,Bt){if(xt.isCompound){let Nt=kt.__dataCompoundStorage[xt.target];Nt[Bt.compoundIndex]=At,At=Nt.join("")}return xt.kind!=="attribute"&&(xt.target==="textContent"||xt.target==="value"&&(kt.localName==="input"||kt.localName==="textarea"))&&(At=At??""),At}function shouldAddListener(kt){return!!kt.target&&kt.kind!="attribute"&&kt.kind!="text"&&!kt.isCompound&&kt.parts[0].mode==="{"}function setupBindings(kt,At){let{nodeList:xt,nodeInfoList:Bt}=At;if(Bt.length)for(let Nt=0;Nt<Bt.length;Nt++){let jt=Bt[Nt],Ut=xt[Nt],Lt=jt.bindings;if(Lt)for(let Ht=0;Ht<Lt.length;Ht++){let Vt=Lt[Ht];setupCompoundStorage(Ut,Vt),addNotifyListener(Ut,kt,Vt)}Ut.__dataHost=kt}}function setupCompoundStorage(kt,At){if(At.isCompound){let xt=kt.__dataCompoundStorage||(kt.__dataCompoundStorage={}),Bt=At.parts,Nt=new Array(Bt.length);for(let Ut=0;Ut<Bt.length;Ut++)Nt[Ut]=Bt[Ut].literal;let jt=At.target;xt[jt]=Nt,At.literal&&At.kind=="property"&&(jt==="className"&&(kt=wrap$1(kt)),kt[jt]=At.literal)}}function addNotifyListener(kt,At,xt){if(xt.listenerEvent){let Bt=xt.parts[0];kt.addEventListener(xt.listenerEvent,function(Nt){handleNotification(Nt,At,xt.target,Bt.source,Bt.negate)})}}function createMethodEffect(kt,At,xt,Bt,Nt,jt){jt=At.static||jt&&(typeof jt!="object"||jt[At.methodName]);let Ut={methodName:At.methodName,args:At.args,methodInfo:Nt,dynamicFn:jt};for(let Lt=0,Ht;Lt<At.args.length&&(Ht=At.args[Lt]);Lt++)Ht.literal||kt._addPropertyEffect(Ht.rootProperty,xt,{fn:Bt,info:Ut,trigger:Ht});return jt&&kt._addPropertyEffect(At.methodName,xt,{fn:Bt,info:Ut}),Ut}function runMethodEffect(kt,At,xt,Bt,Nt){let jt=kt._methodHost||kt,Ut=jt[Nt.methodName];if(Ut){let Lt=kt._marshalArgs(Nt.args,At,xt);return Lt===NOOP?NOOP:Ut.apply(jt,Lt)}else Nt.dynamicFn||console.warn("method `"+Nt.methodName+"` not defined")}const emptyArray=[],IDENT="(?:[a-zA-Z_$][\\w.:$\\-*]*)",NUMBER="(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)",SQUOTE_STRING="(?:'(?:[^'\\\\]|\\\\.)*')",DQUOTE_STRING='(?:"(?:[^"\\\\]|\\\\.)*")',STRING="(?:"+SQUOTE_STRING+"|"+DQUOTE_STRING+")",ARGUMENT="(?:("+IDENT+"|"+NUMBER+"|"+STRING+")\\s*)",ARGUMENTS="(?:"+ARGUMENT+"(?:,\\s*"+ARGUMENT+")*)",ARGUMENT_LIST="(?:\\(\\s*(?:"+ARGUMENTS+"?)\\)\\s*)",BINDING="("+IDENT+"\\s*"+ARGUMENT_LIST+"?)",OPEN_BRACKET="(\\[\\[|{{)\\s*",CLOSE_BRACKET="(?:]]|}})",NEGATE="(?:(!)\\s*)?",EXPRESSION=OPEN_BRACKET+NEGATE+BINDING+CLOSE_BRACKET,bindingRegex=new RegExp(EXPRESSION,"g");function literalFromParts(kt){let At="";for(let xt=0;xt<kt.length;xt++){let Bt=kt[xt].literal;At+=Bt||""}return At}function parseMethod(kt){let At=kt.match(/([^\s]+?)\(([\s\S]*)\)/);if(At){let Bt={methodName:At[1],static:!0,args:emptyArray};if(At[2].trim()){let Nt=At[2].replace(/\\,/g,"&comma;").split(",");return parseArgs(Nt,Bt)}else return Bt}return null}function parseArgs(kt,At){return At.args=kt.map(function(xt){let Bt=parseArg(xt);return Bt.literal||(At.static=!1),Bt},this),At}function parseArg(kt){let At=kt.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),xt={name:At,value:"",literal:!1},Bt=At[0];switch(Bt==="-"&&(Bt=At[1]),Bt>="0"&&Bt<="9"&&(Bt="#"),Bt){case"'":case'"':xt.value=At.slice(1,-1),xt.literal=!0;break;case"#":xt.value=Number(At),xt.literal=!0;break}return xt.literal||(xt.rootProperty=root$2(At),xt.structured=isPath(At),xt.structured&&(xt.wildcard=At.slice(-2)==".*",xt.wildcard&&(xt.name=At.slice(0,-2)))),xt}function getArgValue(kt,At,xt){let Bt=get$2(kt,xt);return Bt===void 0&&(Bt=At[xt]),Bt}function notifySplices(kt,At,xt,Bt){const Nt={indexSplices:Bt};legacyUndefined&&!kt._overrideLegacyUndefined&&(At.splices=Nt),kt.notifyPath(xt+".splices",Nt),kt.notifyPath(xt+".length",At.length),legacyUndefined&&!kt._overrideLegacyUndefined&&(Nt.indexSplices=[])}function notifySplice(kt,At,xt,Bt,Nt,jt){notifySplices(kt,At,xt,[{index:Bt,addedCount:Nt,removed:jt,object:At,type:"splice"}])}function upper$1(kt){return kt[0].toUpperCase()+kt.substring(1)}const PropertyEffects=dedupingMixin(kt=>{const At=TemplateStamp(PropertyAccessors(kt));class xt extends At{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return TYPES}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if(hostStack.length){let Nt=hostStack[hostStack.length-1];Nt._enqueueClient(this),this.__dataHost=Nt}}_initializeProtoProperties(Nt){this.__data=Object.create(Nt),this.__dataPending=Object.create(Nt),this.__dataOld={}}_initializeInstanceProperties(Nt){let jt=this[TYPES.READ_ONLY];for(let Ut in Nt)(!jt||!jt[Ut])&&(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[Ut]=this.__dataPending[Ut]=Nt[Ut])}_addPropertyEffect(Nt,jt,Ut){this._createPropertyAccessor(Nt,jt==TYPES.READ_ONLY);let Lt=ensureOwnEffectMap(this,jt,!0)[Nt];Lt||(Lt=this[jt][Nt]=[]),Lt.push(Ut)}_removePropertyEffect(Nt,jt,Ut){let Lt=ensureOwnEffectMap(this,jt,!0)[Nt],Ht=Lt.indexOf(Ut);Ht>=0&&Lt.splice(Ht,1)}_hasPropertyEffect(Nt,jt){let Ut=this[jt];return!!(Ut&&Ut[Nt])}_hasReadOnlyEffect(Nt){return this._hasPropertyEffect(Nt,TYPES.READ_ONLY)}_hasNotifyEffect(Nt){return this._hasPropertyEffect(Nt,TYPES.NOTIFY)}_hasReflectEffect(Nt){return this._hasPropertyEffect(Nt,TYPES.REFLECT)}_hasComputedEffect(Nt){return this._hasPropertyEffect(Nt,TYPES.COMPUTE)}_setPendingPropertyOrPath(Nt,jt,Ut,Lt){if(Lt||root$2(Array.isArray(Nt)?Nt[0]:Nt)!==Nt){if(!Lt){let Ht=get$2(this,Nt);if(Nt=set$1(this,Nt,jt),!Nt||!super._shouldPropertyChange(Nt,jt,Ht))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(Nt,jt,Ut))return computeLinkedPaths(this,Nt,jt),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[Nt])return this._setPendingProperty(Nt,jt,Ut);this[Nt]=jt}return!1}_setUnmanagedPropertyToNode(Nt,jt,Ut){(Ut!==Nt[jt]||typeof Ut=="object")&&(jt==="className"&&(Nt=wrap$1(Nt)),Nt[jt]=Ut)}_setPendingProperty(Nt,jt,Ut){let Lt=this.__dataHasPaths&&isPath(Nt),Ht=Lt?this.__dataTemp:this.__data;return this._shouldPropertyChange(Nt,jt,Ht[Nt])?(this.__dataPending||(this.__dataPending={},this.__dataOld={}),Nt in this.__dataOld||(this.__dataOld[Nt]=this.__data[Nt]),Lt?this.__dataTemp[Nt]=jt:this.__data[Nt]=jt,this.__dataPending[Nt]=jt,(Lt||this[TYPES.NOTIFY]&&this[TYPES.NOTIFY][Nt])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[Nt]=Ut),!0):!1}_setProperty(Nt,jt){this._setPendingProperty(Nt,jt,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(Nt){this.__dataPendingClients=this.__dataPendingClients||[],Nt!==this&&this.__dataPendingClients.push(Nt)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let Nt=this.__dataPendingClients;if(Nt){this.__dataPendingClients=null;for(let jt=0;jt<Nt.length;jt++){let Ut=Nt[jt];Ut.__dataEnabled?Ut.__dataPending&&Ut._flushProperties():Ut._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(Nt,jt){for(let Ut in Nt)(jt||!this[TYPES.READ_ONLY]||!this[TYPES.READ_ONLY][Ut])&&this._setPendingPropertyOrPath(Ut,Nt[Ut],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(Nt,jt,Ut){let Lt=this.__dataHasPaths;this.__dataHasPaths=!1;let Ht;runComputedEffects(this,jt,Ut,Lt),Ht=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(jt,Ut,Lt),this._flushClients(),runEffects(this,this[TYPES.REFLECT],jt,Ut,Lt),runEffects(this,this[TYPES.OBSERVE],jt,Ut,Lt),Ht&&runNotifyEffects(this,Ht,jt,Ut,Lt),this.__dataCounter==1&&(this.__dataTemp={})}_propagatePropertyChanges(Nt,jt,Ut){this[TYPES.PROPAGATE]&&runEffects(this,this[TYPES.PROPAGATE],Nt,jt,Ut),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,Nt,jt,Ut)}_runEffectsForTemplate(Nt,jt,Ut,Lt){const Ht=(Vt,zt)=>{runEffects(this,Nt.propertyEffects,Vt,Ut,zt,Nt.nodeList);for(let Wt=Nt.firstChild;Wt;Wt=Wt.nextSibling)this._runEffectsForTemplate(Wt,Vt,Ut,zt)};Nt.runEffects?Nt.runEffects(Ht,jt,Lt):Ht(jt,Lt)}linkPaths(Nt,jt){Nt=normalize$1(Nt),jt=normalize$1(jt),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[Nt]=jt}unlinkPaths(Nt){Nt=normalize$1(Nt),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[Nt]}notifySplices(Nt,jt){let Ut={path:""},Lt=get$2(this,Nt,Ut);notifySplices(this,Lt,Ut.path,jt)}get(Nt,jt){return get$2(jt||this,Nt)}set(Nt,jt,Ut){Ut?set$1(Ut,Nt,jt):(!this[TYPES.READ_ONLY]||!this[TYPES.READ_ONLY][Nt])&&this._setPendingPropertyOrPath(Nt,jt,!0)&&this._invalidateProperties()}push(Nt,...jt){let Ut={path:""},Lt=get$2(this,Nt,Ut),Ht=Lt.length,Vt=Lt.push(...jt);return jt.length&&notifySplice(this,Lt,Ut.path,Ht,jt.length,[]),Vt}pop(Nt){let jt={path:""},Ut=get$2(this,Nt,jt),Lt=!!Ut.length,Ht=Ut.pop();return Lt&&notifySplice(this,Ut,jt.path,Ut.length,0,[Ht]),Ht}splice(Nt,jt,Ut,...Lt){let Ht={path:""},Vt=get$2(this,Nt,Ht);jt<0?jt=Vt.length-Math.floor(-jt):jt&&(jt=Math.floor(jt));let zt;return arguments.length===2?zt=Vt.splice(jt):zt=Vt.splice(jt,Ut,...Lt),(Lt.length||zt.length)&&notifySplice(this,Vt,Ht.path,jt,Lt.length,zt),zt}shift(Nt){let jt={path:""},Ut=get$2(this,Nt,jt),Lt=!!Ut.length,Ht=Ut.shift();return Lt&&notifySplice(this,Ut,jt.path,0,0,[Ht]),Ht}unshift(Nt,...jt){let Ut={path:""},Lt=get$2(this,Nt,Ut),Ht=Lt.unshift(...jt);return jt.length&&notifySplice(this,Lt,Ut.path,0,jt.length,[]),Ht}notifyPath(Nt,jt){let Ut;if(arguments.length==1){let Lt={path:""};jt=get$2(this,Nt,Lt),Ut=Lt.path}else Array.isArray(Nt)?Ut=normalize$1(Nt):Ut=Nt;this._setPendingPropertyOrPath(Ut,jt,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(Nt,jt){this._addPropertyEffect(Nt,TYPES.READ_ONLY),jt&&(this["_set"+upper$1(Nt)]=function(Ut){this._setProperty(Nt,Ut)})}_createPropertyObserver(Nt,jt,Ut){let Lt={property:Nt,method:jt,dynamicFn:!!Ut};this._addPropertyEffect(Nt,TYPES.OBSERVE,{fn:runObserverEffect,info:Lt,trigger:{name:Nt}}),Ut&&this._addPropertyEffect(jt,TYPES.OBSERVE,{fn:runObserverEffect,info:Lt,trigger:{name:jt}})}_createMethodObserver(Nt,jt){let Ut=parseMethod(Nt);if(!Ut)throw new Error("Malformed observer expression '"+Nt+"'");createMethodEffect(this,Ut,TYPES.OBSERVE,runMethodEffect,null,jt)}_createNotifyingProperty(Nt){this._addPropertyEffect(Nt,TYPES.NOTIFY,{fn:runNotifyEffect,info:{eventName:camelToDashCase(Nt)+"-changed",property:Nt}})}_createReflectedProperty(Nt){let jt=this.constructor.attributeNameForProperty(Nt);jt[0]==="-"?console.warn("Property "+Nt+" cannot be reflected to attribute "+jt+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(Nt,TYPES.REFLECT,{fn:runReflectEffect,info:{attrName:jt}})}_createComputedProperty(Nt,jt,Ut){let Lt=parseMethod(jt);if(!Lt)throw new Error("Malformed computed expression '"+jt+"'");const Ht=createMethodEffect(this,Lt,TYPES.COMPUTE,runComputedEffect,Nt,Ut);ensureOwnEffectMap(this,COMPUTE_INFO)[Nt]=Ht}_marshalArgs(Nt,jt,Ut){const Lt=this.__data,Ht=[];for(let Vt=0,zt=Nt.length;Vt<zt;Vt++){let{name:Wt,structured:Jt,wildcard:Qt,value:Xt,literal:tr}=Nt[Vt];if(!tr)if(Qt){const rr=isDescendant(Wt,jt),nr=getArgValue(Lt,Ut,rr?jt:Wt);Xt={path:rr?jt:Wt,value:nr,base:rr?get$2(Lt,Wt):nr}}else Xt=Jt?getArgValue(Lt,Ut,Wt):Lt[Wt];if(legacyUndefined&&!this._overrideLegacyUndefined&&Xt===void 0&&Nt.length>1)return NOOP;Ht[Vt]=Xt}return Ht}static addPropertyEffect(Nt,jt,Ut){this.prototype._addPropertyEffect(Nt,jt,Ut)}static createPropertyObserver(Nt,jt,Ut){this.prototype._createPropertyObserver(Nt,jt,Ut)}static createMethodObserver(Nt,jt){this.prototype._createMethodObserver(Nt,jt)}static createNotifyingProperty(Nt){this.prototype._createNotifyingProperty(Nt)}static createReadOnlyProperty(Nt,jt){this.prototype._createReadOnlyProperty(Nt,jt)}static createReflectedProperty(Nt){this.prototype._createReflectedProperty(Nt)}static createComputedProperty(Nt,jt,Ut){this.prototype._createComputedProperty(Nt,jt,Ut)}static bindTemplate(Nt){return this.prototype._bindTemplate(Nt)}_bindTemplate(Nt,jt){let Ut=this.constructor._parseTemplate(Nt),Lt=this.__preBoundTemplateInfo==Ut;if(!Lt)for(let Ht in Ut.propertyEffects)this._createPropertyAccessor(Ht);if(jt)if(Ut=Object.create(Ut),Ut.wasPreBound=Lt,!this.__templateInfo)this.__templateInfo=Ut;else{const Ht=Nt._parentTemplateInfo||this.__templateInfo,Vt=Ht.lastChild;Ut.parent=Ht,Ht.lastChild=Ut,Ut.previousSibling=Vt,Vt?Vt.nextSibling=Ut:Ht.firstChild=Ut}else this.__preBoundTemplateInfo=Ut;return Ut}static _addTemplatePropertyEffect(Nt,jt,Ut){let Lt=Nt.hostProps=Nt.hostProps||{};Lt[jt]=!0;let Ht=Nt.propertyEffects=Nt.propertyEffects||{};(Ht[jt]=Ht[jt]||[]).push(Ut)}_stampTemplate(Nt,jt){jt=jt||this._bindTemplate(Nt,!0),hostStack.push(this);let Ut=super._stampTemplate(Nt,jt);if(hostStack.pop(),jt.nodeList=Ut.nodeList,!jt.wasPreBound){let Lt=jt.childNodes=[];for(let Ht=Ut.firstChild;Ht;Ht=Ht.nextSibling)Lt.push(Ht)}return Ut.templateInfo=jt,setupBindings(this,jt),this.__dataClientsReady&&(this._runEffectsForTemplate(jt,this.__data,null,!1),this._flushClients()),Ut}_removeBoundDom(Nt){const jt=Nt.templateInfo,{previousSibling:Ut,nextSibling:Lt,parent:Ht}=jt;Ut?Ut.nextSibling=Lt:Ht&&(Ht.firstChild=Lt),Lt?Lt.previousSibling=Ut:Ht&&(Ht.lastChild=Ut),jt.nextSibling=jt.previousSibling=null;let Vt=jt.childNodes;for(let zt=0;zt<Vt.length;zt++){let Wt=Vt[zt];wrap$1(wrap$1(Wt).parentNode).removeChild(Wt)}}static _parseTemplateNode(Nt,jt,Ut){let Lt=At._parseTemplateNode.call(this,Nt,jt,Ut);if(Nt.nodeType===Node.TEXT_NODE){let Ht=this._parseBindings(Nt.textContent,jt);Ht&&(Nt.textContent=literalFromParts(Ht)||" ",addBinding(this,jt,Ut,"text","textContent",Ht),Lt=!0)}return Lt}static _parseTemplateNodeAttribute(Nt,jt,Ut,Lt,Ht){let Vt=this._parseBindings(Ht,jt);if(Vt){let zt=Lt,Wt="property";capitalAttributeRegex.test(Lt)?Wt="attribute":Lt[Lt.length-1]=="$"&&(Lt=Lt.slice(0,-1),Wt="attribute");let Jt=literalFromParts(Vt);return Jt&&Wt=="attribute"&&(Lt=="class"&&Nt.hasAttribute("class")&&(Jt+=" "+Nt.getAttribute(Lt)),Nt.setAttribute(Lt,Jt)),Wt=="attribute"&&zt=="disable-upgrade$"&&Nt.setAttribute(Lt,""),Nt.localName==="input"&&zt==="value"&&Nt.setAttribute(zt,""),Nt.removeAttribute(zt),Wt==="property"&&(Lt=dashToCamelCase(Lt)),addBinding(this,jt,Ut,Wt,Lt,Vt,Jt),!0}else return At._parseTemplateNodeAttribute.call(this,Nt,jt,Ut,Lt,Ht)}static _parseTemplateNestedTemplate(Nt,jt,Ut){let Lt=At._parseTemplateNestedTemplate.call(this,Nt,jt,Ut);const Ht=Nt.parentNode,Vt=Ut.templateInfo,zt=Ht.localName==="dom-if",Wt=Ht.localName==="dom-repeat";removeNestedTemplates&&(zt||Wt)&&(Ht.removeChild(Nt),Ut=Ut.parentInfo,Ut.templateInfo=Vt,Ut.noted=!0,Lt=!1);let Jt=Vt.hostProps;if(fastDomIf&&zt)Jt&&(jt.hostProps=Object.assign(jt.hostProps||{},Jt),removeNestedTemplates||(Ut.parentInfo.noted=!0));else{let Qt="{";for(let Xt in Jt){let tr=[{mode:Qt,source:Xt,dependencies:[Xt],hostProp:!0}];addBinding(this,jt,Ut,"property","_host_"+Xt,tr)}}return Lt}static _parseBindings(Nt,jt){let Ut=[],Lt=0,Ht;for(;(Ht=bindingRegex.exec(Nt))!==null;){Ht.index>Lt&&Ut.push({literal:Nt.slice(Lt,Ht.index)});let Vt=Ht[1][0],zt=!!Ht[2],Wt=Ht[3].trim(),Jt=!1,Qt="",Xt=-1;Vt=="{"&&(Xt=Wt.indexOf("::"))>0&&(Qt=Wt.substring(Xt+2),Wt=Wt.substring(0,Xt),Jt=!0);let tr=parseMethod(Wt),rr=[];if(tr){let{args:nr,methodName:ar}=tr;for(let lr=0;lr<nr.length;lr++){let yr=nr[lr];yr.literal||rr.push(yr)}let ir=jt.dynamicFns;(ir&&ir[ar]||tr.static)&&(rr.push(ar),tr.dynamicFn=!0)}else rr.push(Wt);Ut.push({source:Wt,mode:Vt,negate:zt,customEvent:Jt,signature:tr,dependencies:rr,event:Qt}),Lt=bindingRegex.lastIndex}if(Lt&&Lt<Nt.length){let Vt=Nt.substring(Lt);Vt&&Ut.push({literal:Vt})}return Ut.length?Ut:null}static _evaluateBinding(Nt,jt,Ut,Lt,Ht,Vt){let zt;return jt.signature?zt=runMethodEffect(Nt,Ut,Lt,Ht,jt.signature):Ut!=jt.source?zt=get$2(Nt,jt.source):Vt&&isPath(Ut)?zt=get$2(Nt,Ut):zt=Nt.__data[Ut],jt.negate&&(zt=!zt),zt}}return xt}),hostStack=[];/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function register$1(kt){}/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function normalizeProperties(kt){const At={};for(let xt in kt){const Bt=kt[xt];At[xt]=typeof Bt=="function"?{type:Bt}:Bt}return At}const PropertiesMixin=dedupingMixin(kt=>{const At=PropertiesChanged(kt);function xt(jt){const Ut=Object.getPrototypeOf(jt);return Ut.prototype instanceof Nt?Ut:null}function Bt(jt){if(!jt.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",jt))){let Ut=null;if(jt.hasOwnProperty(JSCompiler_renameProperty("properties",jt))){const Lt=jt.properties;Lt&&(Ut=normalizeProperties(Lt))}jt.__ownProperties=Ut}return jt.__ownProperties}class Nt extends At{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){this.prototype;const Ut=this._properties;this.__observedAttributes=Ut?Object.keys(Ut).map(Lt=>this.prototype._addPropertyToAttributeMap(Lt)):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const Ut=xt(this);Ut&&Ut.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const Ut=Bt(this);Ut&&this.createProperties(Ut)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const Ut=xt(this);this.__properties=Object.assign({},Ut&&Ut._properties,Bt(this))}return this.__properties}static typeForProperty(Ut){const Lt=this._properties[Ut];return Lt&&Lt.type}_initializeProperties(){this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return Nt});/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */const version$1="3.5.1",builtCSS=window.ShadyCSS&&window.ShadyCSS.cssBuild,ElementMixin$1=dedupingMixin(kt=>{const At=PropertiesMixin(PropertyEffects(kt));function xt(Ht){if(!Ht.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",Ht))){Ht.__propertyDefaults=null;let Vt=Ht._properties;for(let zt in Vt){let Wt=Vt[zt];"value"in Wt&&(Ht.__propertyDefaults=Ht.__propertyDefaults||{},Ht.__propertyDefaults[zt]=Wt)}}return Ht.__propertyDefaults}function Bt(Ht){return Ht.hasOwnProperty(JSCompiler_renameProperty("__ownObservers",Ht))||(Ht.__ownObservers=Ht.hasOwnProperty(JSCompiler_renameProperty("observers",Ht))?Ht.observers:null),Ht.__ownObservers}function Nt(Ht,Vt,zt,Wt){zt.computed&&(zt.readOnly=!0),zt.computed&&(Ht._hasReadOnlyEffect(Vt)?console.warn(`Cannot redefine computed property '${Vt}'.`):Ht._createComputedProperty(Vt,zt.computed,Wt)),zt.readOnly&&!Ht._hasReadOnlyEffect(Vt)?Ht._createReadOnlyProperty(Vt,!zt.computed):zt.readOnly===!1&&Ht._hasReadOnlyEffect(Vt)&&console.warn(`Cannot make readOnly property '${Vt}' non-readOnly.`),zt.reflectToAttribute&&!Ht._hasReflectEffect(Vt)?Ht._createReflectedProperty(Vt):zt.reflectToAttribute===!1&&Ht._hasReflectEffect(Vt)&&console.warn(`Cannot make reflected property '${Vt}' non-reflected.`),zt.notify&&!Ht._hasNotifyEffect(Vt)?Ht._createNotifyingProperty(Vt):zt.notify===!1&&Ht._hasNotifyEffect(Vt)&&console.warn(`Cannot make notify property '${Vt}' non-notify.`),zt.observer&&Ht._createPropertyObserver(Vt,zt.observer,Wt[zt.observer]),Ht._addPropertyToAttributeMap(Vt)}function jt(Ht,Vt,zt,Wt){if(!builtCSS){const Jt=Vt.content.querySelectorAll("style"),Qt=stylesFromTemplate(Vt),Xt=stylesFromModuleImports(zt),tr=Vt.content.firstElementChild;for(let nr=0;nr<Xt.length;nr++){let ar=Xt[nr];ar.textContent=Ht._processStyleText(ar.textContent,Wt),Vt.content.insertBefore(ar,tr)}let rr=0;for(let nr=0;nr<Qt.length;nr++){let ar=Qt[nr],ir=Jt[rr];ir!==ar?(ar=ar.cloneNode(!0),ir.parentNode.insertBefore(ar,ir)):rr++,ar.textContent=Ht._processStyleText(ar.textContent,Wt)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(Vt,zt),useAdoptedStyleSheetsWithBuiltCSS&&builtCSS&&supportsAdoptingStyleSheets){const Jt=Vt.content.querySelectorAll("style");if(Jt){let Qt="";Array.from(Jt).forEach(Xt=>{Qt+=Xt.textContent,Xt.parentNode.removeChild(Xt)}),Ht._styleSheet=new CSSStyleSheet,Ht._styleSheet.replaceSync(Qt)}}}function Ut(Ht){let Vt=null;if(Ht&&(!strictTemplatePolicy||allowTemplateFromDomModule)&&(Vt=DomModule.import(Ht,"template"),strictTemplatePolicy&&!Vt))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${Ht}`);return Vt}class Lt extends At{static get polymerElementVersion(){return version$1}static _finalizeClass(){At._finalizeClass.call(this);const Vt=Bt(this);Vt&&this.createObservers(Vt,this._properties),this._prepareTemplate()}static _prepareTemplate(){let Vt=this.template;Vt&&(typeof Vt=="string"?(console.error("template getter must return HTMLTemplateElement"),Vt=null):legacyOptimizations||(Vt=Vt.cloneNode(!0))),this.prototype._template=Vt}static createProperties(Vt){for(let zt in Vt)Nt(this.prototype,zt,Vt[zt],Vt)}static createObservers(Vt,zt){const Wt=this.prototype;for(let Jt=0;Jt<Vt.length;Jt++)Wt._createMethodObserver(Vt[Jt],zt)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){let Vt=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;typeof Vt=="function"&&(Vt=Vt()),this._template=Vt!==void 0?Vt:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&Ut(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(Vt){this._template=Vt}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const Vt=this.importMeta;if(Vt)this._importPath=pathFromUrl(Vt.url);else{const zt=DomModule.import(this.is);this._importPath=zt&&zt.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=rootPath,this.importPath=this.constructor.importPath;let Vt=xt(this.constructor);if(Vt)for(let zt in Vt){let Wt=Vt[zt];if(this._canApplyPropertyDefault(zt)){let Jt=typeof Wt.value=="function"?Wt.value.call(this):Wt.value;this._hasAccessor(zt)?this._setPendingProperty(zt,Jt,!0):this[zt]=Jt}}}_canApplyPropertyDefault(Vt){return!this.hasOwnProperty(Vt)}static _processStyleText(Vt,zt){return resolveCss(Vt,zt)}static _finalizeTemplate(Vt){const zt=this.prototype._template;if(zt&&!zt.__polymerFinalized){zt.__polymerFinalized=!0;const Wt=this.importPath,Jt=Wt?resolveUrl$1(Wt):"";jt(this,zt,Vt,Jt),this.prototype._bindTemplate(zt)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(Vt){const zt=wrap$1(this);if(zt.attachShadow)return Vt?(zt.shadowRoot||(zt.attachShadow({mode:"open",shadyUpgradeFragment:Vt}),zt.shadowRoot.appendChild(Vt),this.constructor._styleSheet&&(zt.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),syncInitialRender&&window.ShadyDOM&&window.ShadyDOM.flushInitial(zt.shadowRoot),zt.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(Vt){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,Vt)}resolveUrl(Vt,zt){return!zt&&this.importPath&&(zt=resolveUrl$1(this.importPath)),resolveUrl$1(Vt,zt)}static _parseTemplateContent(Vt,zt,Wt){return zt.dynamicFns=zt.dynamicFns||this._properties,At._parseTemplateContent.call(this,Vt,zt,Wt)}static _addTemplatePropertyEffect(Vt,zt,Wt){return legacyWarnings&&!(zt in this._properties)&&!(Wt.info.part.signature&&Wt.info.part.signature.static)&&!Wt.info.part.hostProp&&!Vt.nestedTemplate&&console.warn(`Property '${zt}' used in template but not declared in 'properties'; attribute will not be observed.`),At._addTemplatePropertyEffect.call(this,Vt,zt,Wt)}}return Lt});/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const policy=window.trustedTypes&&trustedTypes.createPolicy("polymer-html-literal",{createHTML:kt=>kt});class LiteralString{constructor(At,xt){assertValidTemplateStringParameters(At,xt);const Bt=xt.reduce((Nt,jt,Ut)=>Nt+literalValue(jt)+At[Ut+1],At[0]);this.value=Bt.toString()}toString(){return this.value}}function literalValue(kt){if(kt instanceof LiteralString)return kt.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${kt}`)}function htmlValue(kt){if(kt instanceof HTMLTemplateElement)return kt.innerHTML;if(kt instanceof LiteralString)return literalValue(kt);throw new Error(`non-template value passed to Polymer's html function: ${kt}`)}const html=function(At,...xt){assertValidTemplateStringParameters(At,xt);const Bt=document.createElement("template");let Nt=xt.reduce((jt,Ut,Lt)=>jt+htmlValue(Ut)+At[Lt+1],At[0]);return policy&&(Nt=policy.createHTML(Nt)),Bt.innerHTML=Nt,Bt},assertValidTemplateStringParameters=(kt,At)=>{if(!Array.isArray(kt)||!Array.isArray(kt.raw)||At.length!==kt.length-1)throw new TypeError("Invalid call to the html template tag")};/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const PolymerElement=ElementMixin$1(HTMLElement);/**
 * @license
 * Copyright (c) 2017 Anton Korzunov
 * SPDX-License-Identifier: MIT
 */let counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0;const isElement$1=kt=>kt&&kt.nodeType===Node.ELEMENT_NODE,logError=(...kt)=>{console.error(`Error: ${kt.join(" ")}. Skip setting aria-hidden.`)},correctTargets=(kt,At)=>isElement$1(kt)?At.map(xt=>{if(!isElement$1(xt))return logError(xt,"is not a valid element"),null;let Bt=xt;for(;Bt&&Bt!==kt;){if(kt.contains(Bt))return xt;Bt=Bt.getRootNode().host}return logError(xt,"is not contained inside",kt),null}).filter(xt=>!!xt):(logError(kt,"is not a valid element"),[]),applyAttributeToOthers=(kt,At,xt,Bt)=>{const Nt=correctTargets(At,Array.isArray(kt)?kt:[kt]);markerMap[xt]||(markerMap[xt]=new WeakMap);const jt=markerMap[xt],Ut=[],Lt=new Set,Ht=new Set(Nt),Vt=Wt=>{if(!Wt||Lt.has(Wt))return;Lt.add(Wt);const Jt=Wt.assignedSlot;Jt&&Vt(Jt),Vt(Wt.parentNode||Wt.host)};Nt.forEach(Vt);const zt=Wt=>{if(!Wt||Ht.has(Wt))return;const Jt=Wt.shadowRoot;(Jt?[...Wt.children,...Jt.children]:[...Wt.children]).forEach(Xt=>{if(!["template","script","style"].includes(Xt.localName))if(Lt.has(Xt))zt(Xt);else{const tr=Xt.getAttribute(Bt),rr=tr!==null&&tr!=="false",nr=(counterMap.get(Xt)||0)+1,ar=(jt.get(Xt)||0)+1;counterMap.set(Xt,nr),jt.set(Xt,ar),Ut.push(Xt),nr===1&&rr&&uncontrolledNodes.set(Xt,!0),ar===1&&Xt.setAttribute(xt,"true"),rr||Xt.setAttribute(Bt,"true")}})};return zt(At),Lt.clear(),lockCount+=1,()=>{Ut.forEach(Wt=>{const Jt=counterMap.get(Wt)-1,Qt=jt.get(Wt)-1;counterMap.set(Wt,Jt),jt.set(Wt,Qt),Jt||(uncontrolledNodes.has(Wt)?uncontrolledNodes.delete(Wt):Wt.removeAttribute(Bt)),Qt||Wt.removeAttribute(xt)}),lockCount-=1,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=(kt,At=document.body,xt="data-aria-hidden")=>{const Bt=Array.from(Array.isArray(kt)?kt:[kt]);return At&&Bt.push(...Array.from(At.querySelectorAll("[aria-live]"))),applyAttributeToOthers(Bt,At,xt,"aria-hidden")};/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class AriaModalController{constructor(At,xt){this.host=At,this.callback=typeof xt=="function"?xt:()=>At}showModal(){const At=this.callback();this.__showOthers=hideOthers(At)}close(){this.__showOthers&&(this.__showOthers(),this.__showOthers=null)}}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */let keyboardActive=!1;window.addEventListener("keydown",()=>{keyboardActive=!0},{capture:!0});window.addEventListener("mousedown",()=>{keyboardActive=!1},{capture:!0});function isKeyboardActive(){return keyboardActive}function isElementHiddenDirectly(kt){const At=kt.style;if(At.visibility==="hidden"||At.display==="none")return!0;const xt=window.getComputedStyle(kt);return xt.visibility==="hidden"||xt.display==="none"}function hasLowerTabOrder(kt,At){const xt=Math.max(kt.tabIndex,0),Bt=Math.max(At.tabIndex,0);return xt===0||Bt===0?Bt>xt:xt>Bt}function mergeSortByTabIndex(kt,At){const xt=[];for(;kt.length>0&&At.length>0;)hasLowerTabOrder(kt[0],At[0])?xt.push(At.shift()):xt.push(kt.shift());return xt.concat(kt,At)}function sortElementsByTabIndex(kt){const At=kt.length;if(At<2)return kt;const xt=Math.ceil(At/2),Bt=sortElementsByTabIndex(kt.slice(0,xt)),Nt=sortElementsByTabIndex(kt.slice(xt));return mergeSortByTabIndex(Bt,Nt)}function isElementFocusable(kt){return kt.matches('[tabindex="-1"]')?!1:kt.matches("input, select, textarea, button, object")?kt.matches(":not([disabled])"):kt.matches("a[href], area[href], iframe, [tabindex], [contentEditable]")}function isElementFocused(kt){return kt.getRootNode().activeElement===kt}function normalizeTabIndex(kt){if(!isElementFocusable(kt))return-1;const At=kt.getAttribute("tabindex")||0;return Number(At)}function collectFocusableNodes(kt,At){if(kt.nodeType!==Node.ELEMENT_NODE||isElementHiddenDirectly(kt))return!1;const xt=kt,Bt=normalizeTabIndex(xt);let Nt=Bt>0;Bt>=0&&At.push(xt);let jt=[];return xt.localName==="slot"?jt=xt.assignedNodes({flatten:!0}):jt=(xt.shadowRoot||xt).children,[...jt].forEach(Ut=>{Nt=collectFocusableNodes(Ut,At)||Nt}),Nt}function getFocusableElements(kt){const At=[];return collectFocusableNodes(kt,At)?sortElementsByTabIndex(At):At}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const instances$1=[];class FocusTrapController{constructor(At){this.host=At,this.__trapNode=null,this.__onKeyDown=this.__onKeyDown.bind(this)}get __focusableElements(){return getFocusableElements(this.__trapNode)}get __focusedElementIndex(){const At=this.__focusableElements;return At.indexOf(At.filter(isElementFocused).pop())}hostConnected(){document.addEventListener("keydown",this.__onKeyDown)}hostDisconnected(){document.removeEventListener("keydown",this.__onKeyDown)}trapFocus(At){if(this.__trapNode=At,this.__focusableElements.length===0)throw this.__trapNode=null,new Error("The trap node should have at least one focusable descendant or be focusable itself.");instances$1.push(this),this.__focusedElementIndex===-1&&this.__focusableElements[0].focus()}releaseFocus(){this.__trapNode=null,instances$1.pop()}__onKeyDown(At){if(this.__trapNode&&this===Array.from(instances$1).pop()&&At.key==="Tab"){At.preventDefault();const xt=At.shiftKey;this.__focusNextElement(xt)}}__focusNextElement(At=!1){const xt=this.__focusableElements,Bt=At?-1:1,Nt=this.__focusedElementIndex,jt=(xt.length+Nt+Bt)%xt.length,Ut=xt[jt];Ut.focus(),Ut.localName==="input"&&Ut.select()}}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ControllerMixin=dedupingMixin(kt=>typeof kt.prototype.addController=="function"?kt:class extends kt{constructor(){super(),this.__controllers=new Set}connectedCallback(){super.connectedCallback(),this.__controllers.forEach(xt=>{xt.hostConnected&&xt.hostConnected()})}disconnectedCallback(){super.disconnectedCallback(),this.__controllers.forEach(xt=>{xt.hostDisconnected&&xt.hostDisconnected()})}addController(xt){this.__controllers.add(xt),this.$!==void 0&&this.isConnected&&xt.hostConnected&&xt.hostConnected()}removeController(xt){this.__controllers.delete(xt)}}),DEV_MODE_CODE_REGEXP=/\/\*[\*!]\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i,FlowClients=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function isMinified(){function kt(){return!0}return uncommentAndRun(kt)}function isDevelopmentMode(){try{return isForcedDevelopmentMode()?!0:isLocalhost()?FlowClients?!isFlowProductionMode():!isMinified():!1}catch{return!1}}function isForcedDevelopmentMode(){return localStorage.getItem("vaadin.developmentmode.force")}function isLocalhost(){return["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0}function isFlowProductionMode(){return!!(FlowClients&&Object.keys(FlowClients).map(At=>FlowClients[At]).filter(At=>At.productionMode).length>0)}function uncommentAndRun(kt,At){if(typeof kt!="function")return;const xt=DEV_MODE_CODE_REGEXP.exec(kt.toString());if(xt)try{kt=new Function(xt[1])}catch(Bt){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",Bt)}return kt(At)}window.Vaadin=window.Vaadin||{};const runIfDevelopmentMode=function(kt,At){if(window.Vaadin.developmentMode)return uncommentAndRun(kt,At)};window.Vaadin.developmentMode===void 0&&(window.Vaadin.developmentMode=isDevelopmentMode());function maybeGatherAndSendStats(){}const usageStatistics=function(){if(typeof runIfDevelopmentMode=="function")return runIfDevelopmentMode(maybeGatherAndSendStats)};/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */let microtaskCurrHandle=0,microtaskLastHandle=0;const microtaskCallbacks=[];let microtaskScheduled=!1;function microtaskFlush(){microtaskScheduled=!1;const kt=microtaskCallbacks.length;for(let At=0;At<kt;At++){const xt=microtaskCallbacks[At];if(xt)try{xt()}catch(Bt){setTimeout(()=>{throw Bt})}}microtaskCallbacks.splice(0,kt),microtaskLastHandle+=kt}const animationFrame={run(kt){return window.requestAnimationFrame(kt)},cancel(kt){window.cancelAnimationFrame(kt)}},idlePeriod={run(kt){return window.requestIdleCallback?window.requestIdleCallback(kt):window.setTimeout(kt,16)},cancel(kt){window.cancelIdleCallback?window.cancelIdleCallback(kt):window.clearTimeout(kt)}},microTask={run(kt){microtaskScheduled||(microtaskScheduled=!0,queueMicrotask(()=>microtaskFlush())),microtaskCallbacks.push(kt);const At=microtaskCurrHandle;return microtaskCurrHandle+=1,At},cancel(kt){const At=kt-microtaskLastHandle;if(At>=0){if(!microtaskCallbacks[At])throw new Error(`invalid async handle: ${kt}`);microtaskCallbacks[At]=null}}};/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const debouncerQueue=new Set;class Debouncer{static debounce(At,xt,Bt){return At instanceof Debouncer?At._cancelAsync():At=new Debouncer,At.setConfig(xt,Bt),At}constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(At,xt){this._asyncModule=At,this._callback=xt,this._timer=this._asyncModule.run(()=>{this._timer=null,debouncerQueue.delete(this),this._callback()})}cancel(){this.isActive()&&(this._cancelAsync(),debouncerQueue.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return this._timer!=null}}function enqueueDebouncer(kt){debouncerQueue.add(kt)}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const directionSubscribers=[];function alignDirs(kt,At,xt=kt.getAttribute("dir")){At?kt.setAttribute("dir",At):xt!=null&&kt.removeAttribute("dir")}function getDocumentDir(){return document.documentElement.getAttribute("dir")}function directionUpdater(){const kt=getDocumentDir();directionSubscribers.forEach(At=>{alignDirs(At,kt)})}const directionObserver=new MutationObserver(directionUpdater);directionObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]});const DirMixin=kt=>class extends kt{static get properties(){return{dir:{type:String,value:"",reflectToAttribute:!0,converter:{fromAttribute:xt=>xt||"",toAttribute:xt=>xt===""?null:xt}}}}get __isRTL(){return this.getAttribute("dir")==="rtl"}connectedCallback(){super.connectedCallback(),(!this.hasAttribute("dir")||this.__restoreSubscription)&&(this.__subscribe(),alignDirs(this,getDocumentDir(),null))}attributeChangedCallback(xt,Bt,Nt){if(super.attributeChangedCallback(xt,Bt,Nt),xt!=="dir")return;const jt=getDocumentDir(),Ut=Nt===jt&&directionSubscribers.indexOf(this)===-1,Lt=!Nt&&Bt&&directionSubscribers.indexOf(this)===-1;Ut||Lt?(this.__subscribe(),alignDirs(this,jt,Nt)):Nt!==jt&&Bt===jt&&this.__unsubscribe()}disconnectedCallback(){super.disconnectedCallback(),this.__restoreSubscription=directionSubscribers.includes(this),this.__unsubscribe()}_valueToNodeAttribute(xt,Bt,Nt){Nt==="dir"&&Bt===""&&!xt.hasAttribute("dir")||super._valueToNodeAttribute(xt,Bt,Nt)}_attributeToProperty(xt,Bt,Nt){xt==="dir"&&!Bt?this.dir="":super._attributeToProperty(xt,Bt,Nt)}__subscribe(){directionSubscribers.includes(this)||directionSubscribers.push(this)}__unsubscribe(){directionSubscribers.includes(this)&&directionSubscribers.splice(directionSubscribers.indexOf(this),1)}};/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */window.Vaadin||(window.Vaadin={});window.Vaadin.registrations||(window.Vaadin.registrations=[]);window.Vaadin.developmentModeCallback||(window.Vaadin.developmentModeCallback={});window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]=function(){usageStatistics()};let statsJob;const registered=new Set,ElementMixin=kt=>class extends DirMixin(kt){static finalize(){super.finalize();const{is:xt}=this;xt&&!registered.has(xt)&&(window.Vaadin.registrations.push(this),registered.add(xt),window.Vaadin.developmentModeCallback&&(statsJob=Debouncer.debounce(statsJob,idlePeriod,()=>{window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]()}),enqueueDebouncer(statsJob)))}constructor(){super(),document.doctype===null&&console.warn('Vaadin components require the "standards mode" declaration. Please add <!DOCTYPE html> to the HTML document.')}};/**
 * @license
 * Copyright (c) 2018 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class AppLayout extends ElementMixin(ThemableMixin(ControllerMixin(PolymerElement))){static get template(){return html`
      <style>
        :host {
          display: block;
          box-sizing: border-box;
          height: 100%;
          --vaadin-app-layout-transition: 200ms;
          transition: padding var(--vaadin-app-layout-transition);
          --_vaadin-app-layout-drawer-width: var(--vaadin-app-layout-drawer-width, 16em);
          --vaadin-app-layout-touch-optimized: false;
          --vaadin-app-layout-navbar-offset-top: var(--_vaadin-app-layout-navbar-offset-size);
          --vaadin-app-layout-navbar-offset-bottom: var(--_vaadin-app-layout-navbar-offset-size-bottom);
          padding-block: var(--vaadin-app-layout-navbar-offset-top) var(--vaadin-app-layout-navbar-offset-bottom);
          padding-inline-start: var(--vaadin-app-layout-navbar-offset-left);
        }

        :host([hidden]),
        [hidden] {
          display: none !important;
        }

        :host([no-anim]) {
          --vaadin-app-layout-transition: none !important;
        }

        :host([drawer-opened]) {
          --vaadin-app-layout-drawer-offset-left: var(--_vaadin-app-layout-drawer-offset-size);
        }

        :host([overlay]) {
          --vaadin-app-layout-drawer-offset-left: 0;
          --vaadin-app-layout-navbar-offset-left: 0;
        }

        :host(:not([no-scroll])) [content] {
          overflow: auto;
        }

        [content] {
          height: 100%;
        }

        @media (pointer: coarse) and (max-width: 800px) and (min-height: 500px) {
          :host {
            --vaadin-app-layout-touch-optimized: true;
          }
        }

        [part='navbar'] {
          position: fixed;
          display: flex;
          align-items: center;
          top: 0;
          inset-inline: 0;
          transition: inset-inline-start var(--vaadin-app-layout-transition);
          padding-top: var(--safe-area-inset-top);
          padding-left: var(--safe-area-inset-left);
          padding-right: var(--safe-area-inset-right);
          z-index: 1;
        }

        :host([primary-section='drawer'][drawer-opened]:not([overlay])) [part='navbar'] {
          inset-inline-start: var(--vaadin-app-layout-drawer-offset-left, 0);
        }

        :host([primary-section='drawer']) [part='drawer'] {
          top: 0;
        }

        [part='navbar'][bottom] {
          top: auto;
          bottom: 0;
          padding-bottom: var(--safe-area-inset-bottom);
        }

        [part='drawer'] {
          overflow: auto;
          position: fixed;
          top: var(--vaadin-app-layout-navbar-offset-top, 0);
          bottom: var(--vaadin-app-layout-navbar-offset-bottom, var(--vaadin-viewport-offset-bottom, 0));
          inset-inline: var(--vaadin-app-layout-navbar-offset-left, 0) auto;
          transition: transform var(--vaadin-app-layout-transition), visibility var(--vaadin-app-layout-transition);
          transform: translateX(-100%);
          max-width: 90%;
          width: var(--_vaadin-app-layout-drawer-width);
          box-sizing: border-box;
          padding: var(--safe-area-inset-top) 0 var(--safe-area-inset-bottom) var(--safe-area-inset-left);
          outline: none;
          /* The drawer should be inaccessible by the tabbing navigation when it is closed. */
          visibility: hidden;
          display: flex;
          flex-direction: column;
        }

        :host([drawer-opened]) [part='drawer'] {
          /* The drawer should be accessible by the tabbing navigation when it is opened. */
          visibility: visible;
          transform: translateX(0%);
          touch-action: manipulation;
        }

        [part='backdrop'] {
          background-color: #000;
          opacity: 0.3;
        }

        :host(:not([drawer-opened])) [part='backdrop'] {
          opacity: 0;
        }

        :host([overlay]) [part='backdrop'] {
          position: fixed;
          inset: 0;
          pointer-events: none;
          transition: opacity var(--vaadin-app-layout-transition);
          -webkit-tap-highlight-color: transparent;
        }

        :host([overlay]) [part='drawer'] {
          top: 0;
          bottom: 0;
        }

        :host([overlay]) [part='drawer'],
        :host([overlay]) [part='backdrop'] {
          z-index: 2;
        }

        :host([drawer-opened][overlay]) [part='backdrop'] {
          pointer-events: auto;
          touch-action: manipulation;
        }

        :host([dir='rtl']) [part='drawer'] {
          transform: translateX(100%);
        }

        :host([dir='rtl'][drawer-opened]) [part='drawer'] {
          transform: translateX(0%);
        }

        :host([drawer-opened]:not([overlay])) {
          padding-inline-start: var(--vaadin-app-layout-drawer-offset-left);
        }

        @media (max-width: 800px), (max-height: 600px) {
          :host {
            --vaadin-app-layout-drawer-overlay: true;
            --_vaadin-app-layout-drawer-width: var(--vaadin-app-layout-drawer-width, 20em);
          }
        }

        /* If a vaadin-scroller is used in the drawer, allow it to take all remaining space and contain scrolling */
        [part='drawer'] ::slotted(vaadin-scroller) {
          flex: 1;
          overscroll-behavior: contain;
        }
      </style>
      <div part="navbar" id="navbarTop">
        <slot name="navbar" on-slotchange="_updateTouchOptimizedMode"></slot>
      </div>
      <div part="backdrop" on-click="_onBackdropClick" on-touchend="_onBackdropTouchend"></div>
      <div part="drawer" id="drawer">
        <slot name="drawer" id="drawerSlot" on-slotchange="_updateDrawerSize"></slot>
      </div>
      <div content>
        <slot></slot>
      </div>
      <div part="navbar" id="navbarBottom" bottom hidden>
        <slot name="navbar-bottom"></slot>
      </div>
      <div hidden>
        <slot id="touchSlot" name="navbar touch-optimized" on-slotchange="_updateTouchOptimizedMode"></slot>
      </div>
    `}static get is(){return"vaadin-app-layout"}static get properties(){return{i18n:{type:Object,observer:"__i18nChanged",value:()=>({drawer:"Drawer"})},primarySection:{type:String,value:"navbar",notify:!0,reflectToAttribute:!0,observer:"__primarySectionChanged"},drawerOpened:{type:Boolean,notify:!0,value:!0,reflectToAttribute:!0,observer:"__drawerOpenedChanged"},overlay:{type:Boolean,notify:!0,readOnly:!0,value:!1,reflectToAttribute:!0},closeDrawerOn:{type:String,value:"vaadin-router-location-changed",observer:"_closeDrawerOnChanged"}}}static dispatchCloseOverlayDrawerEvent(){window.dispatchEvent(new CustomEvent("close-overlay-drawer"))}constructor(){super(),this.__boundResizeListener=this._resize.bind(this),this.__drawerToggleClickListener=this._drawerToggleClick.bind(this),this.__onDrawerKeyDown=this.__onDrawerKeyDown.bind(this),this.__closeOverlayDrawerListener=this.__closeOverlayDrawer.bind(this),this.__trapFocusInDrawer=this.__trapFocusInDrawer.bind(this),this.__releaseFocusFromDrawer=this.__releaseFocusFromDrawer.bind(this),this.__ariaModalController=new AriaModalController(this,()=>[...this.querySelectorAll('vaadin-drawer-toggle, [slot="drawer"]')]),this.__focusTrapController=new FocusTrapController(this)}connectedCallback(){super.connectedCallback(),this._blockAnimationUntilAfterNextRender(),window.addEventListener("resize",this.__boundResizeListener),this.addEventListener("drawer-toggle-click",this.__drawerToggleClickListener),beforeNextRender(this,this._afterFirstRender),this._updateTouchOptimizedMode(),this._updateDrawerSize(),this._updateOverlayMode(),this._navbarSizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.__isDrawerAnimating?this.__updateOffsetSizePending=!0:this._updateOffsetSize()})}),this._navbarSizeObserver.observe(this.$.navbarTop),this._navbarSizeObserver.observe(this.$.navbarBottom),window.addEventListener("close-overlay-drawer",this.__closeOverlayDrawerListener),window.addEventListener("keydown",this.__onDrawerKeyDown)}ready(){super.ready(),this.addController(this.__focusTrapController),this.__setAriaExpanded(),this.$.drawer.addEventListener("transitionstart",()=>{this.__isDrawerAnimating=!0}),this.$.drawer.addEventListener("transitionend",()=>{this.__updateOffsetSizePending&&(this.__updateOffsetSizePending=!1,this._updateOffsetSize()),requestAnimationFrame(()=>{this.__isDrawerAnimating=!1})})}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",this.__boundResizeListener),this.removeEventListener("drawer-toggle-click",this.__drawerToggleClickListener),window.removeEventListener("close-overlay-drawer",this.__drawerToggleClickListener),window.removeEventListener("keydown",this.__onDrawerKeyDown)}__primarySectionChanged(At){["navbar","drawer"].includes(At)||this.set("primarySection","navbar")}__drawerOpenedChanged(At,xt){this.overlay&&(At?this.__trapFocusInDrawer():xt&&this.__releaseFocusFromDrawer()),this.__setAriaExpanded()}__i18nChanged(){this.__updateDrawerAriaAttributes()}_afterFirstRender(){this._blockAnimationUntilAfterNextRender(),this._updateOffsetSize()}_drawerToggleClick(At){At.stopPropagation(),this.drawerOpened=!this.drawerOpened}__closeOverlayDrawer(){this.overlay&&(this.drawerOpened=!1)}__setAriaExpanded(){const At=this.querySelector("vaadin-drawer-toggle");At&&At.setAttribute("aria-expanded",this.drawerOpened)}_updateDrawerSize(){const At=this.querySelectorAll("[slot=drawer]").length,xt=this.$.drawer;At===0?(xt.setAttribute("hidden",""),this.style.setProperty("--_vaadin-app-layout-drawer-width",0)):(xt.removeAttribute("hidden"),this.style.removeProperty("--_vaadin-app-layout-drawer-width")),this._updateOffsetSize()}_resize(){this._blockAnimationUntilAfterNextRender(),this._updateTouchOptimizedMode(),this._updateOverlayMode()}_updateOffsetSize(){const xt=this.$.navbarTop.getBoundingClientRect(),Nt=this.$.navbarBottom.getBoundingClientRect(),Ut=this.$.drawer.getBoundingClientRect();this.style.setProperty("--_vaadin-app-layout-navbar-offset-size",`${xt.height}px`),this.style.setProperty("--_vaadin-app-layout-navbar-offset-size-bottom",`${Nt.height}px`),this.style.setProperty("--_vaadin-app-layout-drawer-offset-size",`${Ut.width}px`)}_updateOverlayMode(){const At=this._getCustomPropertyValue("--vaadin-app-layout-drawer-overlay")==="true";!this.overlay&&At&&(this._drawerStateSaved=this.drawerOpened,this.drawerOpened=!1),this._setOverlay(At),!this.overlay&&this._drawerStateSaved&&(this.drawerOpened=this._drawerStateSaved,this._drawerStateSaved=null),this.__updateDrawerAriaAttributes()}__updateDrawerAriaAttributes(){const At=this.$.drawer;this.overlay?(At.setAttribute("role","dialog"),At.setAttribute("aria-modal","true"),At.setAttribute("aria-label",this.i18n.drawer)):(At.removeAttribute("role"),At.removeAttribute("aria-modal"),At.removeAttribute("aria-label"))}__drawerTransitionComplete(){return new Promise(At=>{if(this._getCustomPropertyValue("--vaadin-app-layout-transition")==="none"){At();return}this.$.drawer.addEventListener("transitionend",At,{once:!0})})}async __trapFocusInDrawer(){await this.__drawerTransitionComplete(),this.drawerOpened&&(this.$.drawer.setAttribute("tabindex","0"),this.__ariaModalController.showModal(),this.__focusTrapController.trapFocus(this.$.drawer))}async __releaseFocusFromDrawer(){if(await this.__drawerTransitionComplete(),this.drawerOpened)return;this.__ariaModalController.close(),this.__focusTrapController.releaseFocus(),this.$.drawer.removeAttribute("tabindex");const At=this.querySelector("vaadin-drawer-toggle");At&&(At.focus(),At.setAttribute("focus-ring","focus"))}__onDrawerKeyDown(At){At.key==="Escape"&&this.overlay&&(this.drawerOpened=!1)}_closeDrawerOnChanged(At,xt){xt&&window.removeEventListener(xt,this.__closeOverlayDrawerListener),At&&window.addEventListener(At,this.__closeOverlayDrawerListener)}_onBackdropClick(){this._close()}_onBackdropTouchend(At){At.preventDefault(),this._close()}_close(){this.drawerOpened=!1}_getCustomPropertyValue(At){return(getComputedStyle(this).getPropertyValue(At)||"").trim().toLowerCase()}_updateTouchOptimizedMode(){const At=this._getCustomPropertyValue("--vaadin-app-layout-touch-optimized")==="true",xt=this.querySelectorAll('[slot*="navbar"]');xt.length>0&&Array.from(xt).forEach(Bt=>{Bt.getAttribute("slot").indexOf("touch-optimized")>-1&&(Bt.__touchOptimized=!0),At&&Bt.__touchOptimized?Bt.setAttribute("slot","navbar-bottom"):Bt.setAttribute("slot","navbar")}),this.$.navbarTop.querySelector("[name=navbar]").assignedNodes().length===0?this.$.navbarTop.setAttribute("hidden",""):this.$.navbarTop.removeAttribute("hidden"),this.$.navbarBottom.querySelector("[name=navbar-bottom]").assignedNodes().length===0?this.$.navbarBottom.setAttribute("hidden",""):this.$.navbarBottom.removeAttribute("hidden"),this._updateOffsetSize()}_blockAnimationUntilAfterNextRender(){this.setAttribute("no-anim",""),afterNextRender(this,()=>{this.removeAttribute("no-anim")})}}defineCustomElement(AppLayout);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const sizing=i$7`
  :host {
    --lumo-size-xs: 1.625rem;
    --lumo-size-s: 1.875rem;
    --lumo-size-m: 2.25rem;
    --lumo-size-l: 2.75rem;
    --lumo-size-xl: 3.5rem;

    /* Icons */
    --lumo-icon-size-s: 1.25em;
    --lumo-icon-size-m: 1.5em;
    --lumo-icon-size-l: 2.25em;
    /* For backwards compatibility */
    --lumo-icon-size: var(--lumo-icon-size-m);
  }
`;addLumoGlobalStyles("sizing-props",sizing);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const style=i$7`
  :host {
    /* Border radius */
    --lumo-border-radius-s: 0.25em; /* Checkbox, badge, date-picker year indicator, etc */
    --lumo-border-radius-m: var(--lumo-border-radius, 0.25em); /* Button, text field, menu overlay, etc */
    --lumo-border-radius-l: 0.5em; /* Dialog, notification, etc */

    /* Shadow */
    --lumo-box-shadow-xs: 0 1px 4px -1px var(--lumo-shade-50pct);
    --lumo-box-shadow-s: 0 2px 4px -1px var(--lumo-shade-20pct), 0 3px 12px -1px var(--lumo-shade-30pct);
    --lumo-box-shadow-m: 0 2px 6px -1px var(--lumo-shade-20pct), 0 8px 24px -4px var(--lumo-shade-40pct);
    --lumo-box-shadow-l: 0 3px 18px -2px var(--lumo-shade-20pct), 0 12px 48px -6px var(--lumo-shade-40pct);
    --lumo-box-shadow-xl: 0 4px 24px -3px var(--lumo-shade-20pct), 0 18px 64px -8px var(--lumo-shade-40pct);

    /* Clickable element cursor */
    --lumo-clickable-cursor: default;
  }
`;i$7`
  html {
    /* Button */
    --vaadin-button-background: var(--lumo-contrast-5pct);
    --vaadin-button-border: none;
    --vaadin-button-border-radius: var(--lumo-border-radius-m);
    --vaadin-button-font-size: var(--lumo-font-size-m);
    --vaadin-button-font-weight: 500;
    --vaadin-button-height: var(--lumo-size-m);
    --vaadin-button-margin: var(--lumo-space-xs) 0;
    --vaadin-button-min-width: calc(var(--vaadin-button-height) * 2);
    --vaadin-button-padding: 0 calc(var(--vaadin-button-height) / 3 + var(--lumo-border-radius-m) / 2);
    --vaadin-button-text-color: var(--lumo-primary-text-color);
    --vaadin-button-primary-background: var(--lumo-primary-color);
    --vaadin-button-primary-border: none;
    --vaadin-button-primary-font-weight: 600;
    --vaadin-button-primary-text-color: var(--lumo-primary-contrast-color);
    --vaadin-button-tertiary-background: transparent !important;
    --vaadin-button-tertiary-text-color: var(--lumo-primary-text-color);
    --vaadin-button-tertiary-font-weight: 500;
    --vaadin-button-tertiary-padding: 0 calc(var(--vaadin-button-height) / 6);
    /* Checkbox */
    --vaadin-checkbox-background: var(--lumo-contrast-20pct);
    --vaadin-checkbox-background-hover: var(--lumo-contrast-30pct);
    --vaadin-checkbox-border-radius: var(--lumo-border-radius-s);
    --vaadin-checkbox-checkmark-char: var(--lumo-icons-checkmark);
    --vaadin-checkbox-checkmark-char-indeterminate: '';
    --vaadin-checkbox-checkmark-color: var(--lumo-primary-contrast-color);
    --vaadin-checkbox-checkmark-size: calc(var(--vaadin-checkbox-size) + 2px);
    --vaadin-checkbox-label-color: var(--lumo-body-text-color);
    --vaadin-checkbox-label-font-size: var(--lumo-font-size-m);
    --vaadin-checkbox-label-padding: var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs) var(--lumo-space-xs);
    --vaadin-checkbox-size: calc(var(--lumo-size-m) / 2);
    /* Radio button */
    --vaadin-radio-button-background: var(--lumo-contrast-20pct);
    --vaadin-radio-button-background-hover: var(--lumo-contrast-30pct);
    --vaadin-radio-button-dot-color: var(--lumo-primary-contrast-color);
    --vaadin-radio-button-dot-size: 3px;
    --vaadin-radio-button-label-color: var(--lumo-body-text-color);
    --vaadin-radio-button-label-font-size: var(--lumo-font-size-m);
    --vaadin-radio-button-label-padding: var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs)
      var(--lumo-space-xs);
    --vaadin-radio-button-size: calc(var(--lumo-size-m) / 2);
    --vaadin-selection-color: var(--lumo-primary-color);
    --vaadin-selection-color-text: var(--lumo-primary-text-color);
    --vaadin-input-field-border-radius: var(--lumo-border-radius-m);
    --vaadin-focus-ring-color: var(--lumo-primary-color-50pct);
    --vaadin-focus-ring-width: 2px;
    /* Label */
    --vaadin-input-field-label-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-focused-label-color: var(--lumo-primary-text-color);
    --vaadin-input-field-hovered-label-color: var(--lumo-body-text-color);
    --vaadin-input-field-label-font-size: var(--lumo-font-size-s);
    --vaadin-input-field-label-font-weight: 500;
    /* Helper */
    --vaadin-input-field-helper-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-helper-font-size: var(--lumo-font-size-xs);
    --vaadin-input-field-helper-font-weight: 400;
    --vaadin-input-field-helper-spacing: 0.4em;
    /* Error message */
    --vaadin-input-field-error-color: var(--lumo-error-text-color);
    --vaadin-input-field-error-font-size: var(--lumo-font-size-xs);
    --vaadin-input-field-error-font-weight: 400;
    /* Input field */
    --vaadin-input-field-background: var(--lumo-contrast-10pct);
    --vaadin-input-field-icon-color: var(--lumo-contrast-60pct);
    --vaadin-input-field-icon-size: var(--lumo-icon-size-m);
    --vaadin-input-field-invalid-background: var(--lumo-error-color-10pct);
    --vaadin-input-field-invalid-hover-highlight: var(--lumo-error-color-50pct);
    --vaadin-input-field-height: var(--lumo-size-m);
    --vaadin-input-field-hover-highlight: var(--lumo-contrast-50pct);
    --vaadin-input-field-placeholder-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-readonly-border: 1px dashed var(--lumo-contrast-30pct);
    --vaadin-input-field-value-color: var(--lumo-body-text-color);
    --vaadin-input-field-value-font-size: var(--lumo-font-size-m);
    --vaadin-input-field-value-font-weight: 400;
  }
`;addLumoGlobalStyles("style-props",style);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const fontIcons=i$7`
  @font-face {
    font-family: 'lumo-icons';
    src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABEgAAsAAAAAIjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAQwAAAFZAIUuKY21hcAAAAYgAAAD4AAADrsCU8d5nbHlmAAACgAAAC2cAABeAWri7U2hlYWQAAA3oAAAAMAAAADZa/6SsaGhlYQAADhgAAAAdAAAAJAbpA35obXR4AAAOOAAAABAAAACspBAAAGxvY2EAAA5IAAAAWAAAAFh57oA4bWF4cAAADqAAAAAfAAAAIAFKAXBuYW1lAAAOwAAAATEAAAIuUUJZCHBvc3QAAA/0AAABKwAAAelm8SzVeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS+yDiBgZWBgamKaQ8DA0MPhGZ8wGDIyAQUZWBlZsAKAtJcUxgcXjG+0mIO+p/FEMUcxDANKMwIkgMABn8MLQB4nO3SWW6DMABF0UtwCEnIPM/zhLK8LqhfXRybSP14XUYtHV9hGYQwQBNIo3cUIPkhQeM7rib1ekqnXg981XuC1qvy84lzojleh3puxL0hPjGjRU473teloEefAUNGjJkwZcacBUtWrNmwZceeA0dOnLlw5cadB09elPGhGf+j0NTI/65KfXerT6JhqKnpRKtgOpuqaTrtKjPUlqHmhto21I7pL6i6hlqY3q7qGWrfUAeGOjTUkaGODXViqFNDnRnq3FAXhro01JWhrg11Y6hbQ90Z6t5QD4Z6NNSToZ4N9WKoV0O9GerdUB+G+jTUl6GWRvkL24BkEXictVh9bFvVFb/nxvbz+7Rf/N6zHcd2bCfP+Wic1Z9N0jpNHCD9SNqqoVBgbQoMjY+pjA4hNnWa2pV1rHSIif0DGkyT2k10Kmu1Cag6huj4ZpqYBHSqJsTEJgZCG3TaVBFv595nO3ZIv4RIrPPuvefe884599zzO/cRF8G/tgn6CFFImNgkR0ggX8wlspbhSSWSdrC5ozd30s2dw5afzvgtyz9/zG9t1hV4RtF1pXolowvtzc2z6L2aYUQM45jKH9WDTvd1LRDoDASYWhfTzTyvboXz6uZX4ARX5wrF39y+HM2+CJ8d0pkyqBIqoze3D12ez4DrFoYzxI8dWwMrDlZ2DMqQAR9AROsJU+2smlTPaTTco52BVxXa2a2+I8vvqd2dVHm1LoPeTn/AZPRYGthDYOeZjBjKoFsVGulR3lGU95SeCK44oHU7MhWUGUKZDT3oSUcG2GWuh+EDDfUYA/jhIhl0TOsJNYSEu7mQmi3UzfXwZKA4BsVsHLXQYGgJW95qEtpJ1VcW9HiTriZBlFEqxsDjA09yCNUoQxxwd7KWSTt2y3GTKifkqHRCoWZc3m11Wa/dKdFgXD4kSYfkeJBKd8KMz7J8dZn/cGRCcLGDnA2Ge3bKzcvlnTDNthFWLH7Xt80ua5FMjA4WKelWv5Xo16vHuYzpRbJhhdVlftuRK0VlR27D9lu5TF0DPBi60OrHNO0AfP/uRWvhn/U3LXICE+nh+3IHPUJ8JE6GyBjZQLbjGchlrSgYngF8zyrIF4NJD3atUcgWsWunGN/UHX5B5/yg7uF87Nqp4Gf52F3gH73DjEZNRoqCKAr9giQJp5rGJABpiVE2htNhW9R8nw0jqYjCYcY4LIjwYNScf4WN06IZnZCEqsI4cFaQbo4Z1TsZBx40YhXkHOecaYE5oY37IIQ+iJJ+UsDYSun5MuRSBRZRUUhlY2DqOGajOR6zrSU/5My6l2DnusH1GQgnw5BZP7iuYM/ahcfQ7Z8y51ddfutvuwNqWQ0cBYr8fj0U0vsHpwerVaB2sWhXT2NExi2r1KUE2tUuVMnkepVQrxTmpQrZTG4iu8he8iPyM3KcPE/+RP5KPoE2CEAKclCBzXATxkYOtUY/o961PWRqsj0chRrHFBbtrjP9/P0ven5pcbRdpL94vfsy33e5+izuwz3nFLFPVNayPZx/jdG1fOChflFRvYzsW6L18efgLrSWIgvcqnGJYi4skO4xREURjbDuxKke5v0T3Mrzkt2fi31uyZlLLrqIpEuXXsMlgw442Jb0GAxjS1DM20kBoCzHLXm/jEm0IltdcvU0fEW24jgiwwRjVd9u4NJHcIyoHJcwvyVqgqj5hqBJ1ZWSJryh9p56UWhX1XbhRbW2ZopuZWsQd5y8mEQ8M+C6xjRYxZbDKWf5AgY+Qq/l6wSPk16zDFjowYuu+wjx13mfkxbyDDxadYT/LijZyI0THB+6yfLaWsRcO82zo9mWTNtpO18qlorZoIVMwSN40tky5DOQ1MCIAe24mvlsuwIIxPb10+uXDQ4uWz/9m3rj+ql7p6bufZARuPVq5tXtsn6KwfP8Jy0TeWOyNhUJN6mhX5rkUTtUppQWEMNTqEdaCGKFYKJaQrCE4JtDLYOlNEKmO5kBTPGY2A0N2sY3+dVlo1N9ycBsIGtOjQ2p/tlZvzo0ur4v6cOh8NTospB7U/X40KahoU3bGIH97dnwmtHlYffVG3R1YOwKM2vNhrPhCT5zk64sG53oS4b31aYjqe/B7+kQiXBN+b6h21hNUPMq29B8CU4elINdygMPKF1B+WBTG7Z9ZshpN/xwEuuDQZR+nuoo4CDaAiiwXmLpmukMQyPf/JMclqgL1ixZQ/nnP2VbdUODFGt2fgBvL123rlLYu/6A9ckb7F3K0/CyBMEu6aQoPscroCcacVehvyQyCZAsizsWWBkoLC+WAiWnOksLKaeuQDzGuqSk42aiYTiJ4zf9afl17SrqaTO1f+XlZAfIuYcq7/IqYMaMrksOJ6vHkOCPDq943xcCnHqVD9pHFRpMqSPXrIua1WNs+tOz1U+ciTCDpPk+c4QYJIHnYhxP/kVPAq+ahFpVhPcHp8qyarhiF+HsBU9Hrl+UZa876fbKipL0KqB6OdUveErgtOI97fZ63ae9SvWU6k2w1JfwqnUbHsYcFCJFrC/W12zIMMirWYEHxMPs6LGYSdkSZ5TsNP9PCpwnWC3HKZ1lydNjWHC2Mn3l6vL0dHn1ldP3LTSrX+vKrBqv7KmMr8p0SR6P1NqF63or6XRlIyO90f7+kf7+myOhvt4tq7f09oUiTc2/dycGgqFQcCDRLYmi1NL7fk0CknVMxEg/cdfs/TnpJMNkgqwj17B8beVazSrVbU4lG67IZYOCnWrYy3yBR9cyWcChywos3LJBEdhhFoAdYjiw0rLGm0xU5OzoGm5/ZfmHjVZpNNg6SznzGKDdwv2cCtVn6Eaxo12cfxLprpVtTcZ6hVx6dow7Yq7e8LXO8PY9Jgjoze9yCtU5FNbegcKkQMdCbt9au/te4Ebe0jkc0ukUL32eYnTpNs20h0KpUOhZPYwVcfhZnfdqeCvDfXiuCbAoYWcXERPc/mDQD3/hdF+wK4i/xv3kYfprIpAuMkk2kW3kdtS0kBIKpZwp8KxmsCyfM1MFzAss9LBkDxRyThiaqTLwKYKJVTwmWTudMyz+yks09346MDh4m72yOxCKrt1XMlQ1qPVlTEVVQ1ofdK/sCWjtZu9qGwZ8YZ9PPWlo1IV3eW3+U0aXblP39zrt+JPf6UhEQ1rUjNBULN+utyuaDNW34kpAVuSOeMTyWbSNWnooFu+QFNWQ4d/Ox4IPWx41fP/fB/Rjeoz08ezPA9TysMtmnOXfGN7Ui3xIYLDALrlDLOP09qtJuY2OeL0+QZXdRnR1nxRVBF/SOyKKPpcrn9mWzH4rH9IidE+PTNU2182+hOgSItrE1slByS24vaLvJpxOqe4Pduf3HJkZ+jLqUz9rRzB7p8gKcgWZwV1L8JtUS5Z2JxZSOCuBoMTQihMzLbCPA0KqGMAljRQjONklW/wjnXKy8vxT/Elvm3/KiMUMOoV0/vnDYlhec0SMKtt3/kKMyOt33tj2bqxQLsTjSGLl+EAsNhCnTyRGktW55EgCn/A4PlnWn+Mg8bgZrWqHxTbPwMuyy1u5YeZF2SUM7JRhddwRgiRuxpmgJmxn9ZW7XpcF3ViX/ar6ptRpGJ0S9Adg4qhb9sI3vbL7qNJV/y4i07t5TZBiho1imFoMz3gED+CtjYUxvP4SOxov4bFoNPg5aR1e+G4UgDPoedJTpogyCJ7oYvRqoVS0MQAy+CoNEdTDUjok5ZHZL/WtjV7rFj3PKQE3iKp7ou+rIxN3b9LB1dGjeT4cvKo3FrnWpYpuaFd/h3dtV8UeKN1Y9hpR3dt4p0H/zKuPQq0kZQUIIpuDfoiETsnIk+gCWMJZUXHtE8V9LkUc2TE8vOMbO4ax/MACabzyaGXc7u3FBr11ThBdB8SIeMAlCntG2KThHSPsaj2Dc9KNyY2a0KZ7ODaTHoRiFkeYz+shZBpCS4X6471KKKnuHd84edfk5F37d1XO5bbkcltu2ZLNbvnPXiUVAnVvprJrP+NObryjxrllS65md6Tm6wzFHRR4dY3QUUjb7MgxaIixU8hspi98fl/Xc+IB4iU66eCVL9YfAfahiSUt4TONS8x0D8W7u8vd3fGWx6OXlM/U1IoU/s61PGhpyXRFa3eReq2qG56lvmYtXavCC1iN7lbiBpWxXHU+cSlztVLVz0tVN600fVsLxaVDknhYioeoXP3t4lqV1r79MAw0GCI1FTL1YIGzPL1MMlJ9ZsN9P7lvA2yr9ZFUzwzPrVgxN/x/SS+chwB4nGNgZGBgAOLPrYdY4vltvjJwM78AijDUqG5oRND/XzNPZboF5HIwMIFEAU/lC+J4nGNgZGBgDvqfBSRfMAAB81QGRgZUoA0AVvYDbwAAAHicY2BgYGB+MTQwAM8EJo8AAAAAAE4AmgDoAQoBLAFOAXABmgHEAe4CGgKcAugEmgS8BNYE8gUOBSoFegXQBf4GRAZmBrYHGAeQCBgIUghqCP4JRgm+CdoKBAo+CoQKugr0C1QLmgvAeJxjYGRgYNBmTGEQZQABJiDmAkIGhv9gPgMAGJQBvAB4nG2RPU7DMBiG3/QP0UoIBGJh8QILavozdmRo9w7d09RpUzlx5LgVvQMn4BAcgoEzcAgOwVvzSZVQbcnf48fvFysJgGt8IcJxROiG9TgauODuj5ukG+EW+UG4jR4ehTv0Q+EunjER7uEWmk+IWpc0d3gVbuAKb8JN+nfhFvlDuI17fAp36L+Fu1jgR7iHp+jF7Arbz1Nb1nO93pnEncSJFtrVuS3VKB6e5EyX2iVer9TyoOr9eux9pjJnCzW1pdfGWFU5u9WpjzfeV5PBIBMfp7aAwQ4FLPrIkbKWqDHn+67pDRK4s4lzbsEux5qHvcIIMb/nueSMyTKkE3jWFdNLHLjW2PPmMa1Hxn3GjGW/wjT0HtOG09JU4WxLk9LH2ISuiv9twJn9y8fh9uIXI+BknAAAAHicbY7ZboMwEEW5CVBCSLrv+76kfJRjTwHFsdGAG+Xvy5JUfehIHp0rnxmNN/D6ir3/a4YBhvARIMQOIowQY4wEE0yxiz3s4wCHOMIxTnCKM5zjApe4wjVucIs73OMBj3jCM17wije84wMzfHqJ0EVmUkmmJo77oOmrHvfIRZbXsTCZplTZldlgb3TYGVHProwFs11t1A57tcON2rErR3PBqcwF1/6ctI6k0GSU4JHMSS6WghdJQ99sTbfuN7QLJ9vQ37dNrgyktnIxlDYLJNuqitpRbYWKFNuyDT6pog6oOYKHtKakeakqKjHXpPwlGRcsC+OqxLIiJpXqoqqDMreG2l5bv9Ri3TRX+c23DZna9WFFgmXuO6Ps1Jm/w6ErW8N3FbHn/QC444j0AA==)
      format('woff');
    font-weight: normal;
    font-style: normal;
  }

  html {
    --lumo-icons-align-center: '\\ea01';
    --lumo-icons-align-left: '\\ea02';
    --lumo-icons-align-right: '\\ea03';
    --lumo-icons-angle-down: '\\ea04';
    --lumo-icons-angle-left: '\\ea05';
    --lumo-icons-angle-right: '\\ea06';
    --lumo-icons-angle-up: '\\ea07';
    --lumo-icons-arrow-down: '\\ea08';
    --lumo-icons-arrow-left: '\\ea09';
    --lumo-icons-arrow-right: '\\ea0a';
    --lumo-icons-arrow-up: '\\ea0b';
    --lumo-icons-bar-chart: '\\ea0c';
    --lumo-icons-bell: '\\ea0d';
    --lumo-icons-calendar: '\\ea0e';
    --lumo-icons-checkmark: '\\ea0f';
    --lumo-icons-chevron-down: '\\ea10';
    --lumo-icons-chevron-left: '\\ea11';
    --lumo-icons-chevron-right: '\\ea12';
    --lumo-icons-chevron-up: '\\ea13';
    --lumo-icons-clock: '\\ea14';
    --lumo-icons-cog: '\\ea15';
    --lumo-icons-cross: '\\ea16';
    --lumo-icons-download: '\\ea17';
    --lumo-icons-dropdown: '\\ea18';
    --lumo-icons-edit: '\\ea19';
    --lumo-icons-error: '\\ea1a';
    --lumo-icons-eye: '\\ea1b';
    --lumo-icons-eye-disabled: '\\ea1c';
    --lumo-icons-menu: '\\ea1d';
    --lumo-icons-minus: '\\ea1e';
    --lumo-icons-ordered-list: '\\ea1f';
    --lumo-icons-phone: '\\ea20';
    --lumo-icons-photo: '\\ea21';
    --lumo-icons-play: '\\ea22';
    --lumo-icons-plus: '\\ea23';
    --lumo-icons-redo: '\\ea24';
    --lumo-icons-reload: '\\ea25';
    --lumo-icons-search: '\\ea26';
    --lumo-icons-undo: '\\ea27';
    --lumo-icons-unordered-list: '\\ea28';
    --lumo-icons-upload: '\\ea29';
    --lumo-icons-user: '\\ea2a';
  }
`;addLumoGlobalStyles("font-icons",fontIcons);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const fieldButton=i$7`
  [part$='button'] {
    flex: none;
    width: 1em;
    height: 1em;
    line-height: 1;
    font-size: var(--lumo-icon-size-m);
    text-align: center;
    color: var(--lumo-contrast-60pct);
    transition: 0.2s color;
    cursor: var(--lumo-clickable-cursor);
  }

  [part$='button']:hover {
    color: var(--lumo-contrast-90pct);
  }

  :host([disabled]) [part$='button'],
  :host([readonly]) [part$='button'] {
    color: var(--lumo-contrast-20pct);
    cursor: default;
  }

  [part$='button']::before {
    font-family: 'lumo-icons';
    display: block;
  }
`;registerStyles("",fieldButton,{moduleId:"lumo-field-button"});const sideNavItemStyles=i$7`
  :host {
    --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
    --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
  }

  [part='link'] {
    width: 100%;
    gap: var(--lumo-space-xs);
    padding: var(--lumo-space-s);
    padding-inline-start: calc(var(--lumo-space-s) + var(--_child-indent, 0px));
    border-radius: var(--lumo-border-radius-m);
    transition: background-color 140ms, color 140ms;
    cursor: var(--lumo-clickable-cursor, default);
    min-height: var(--lumo-icon-size-m);
  }

  [part='link'][href] {
    cursor: pointer;
  }

  :host([disabled]) [part='link'] {
    color: var(--lumo-disabled-text-color);
  }

  [part='toggle-button'] {
    margin-inline-end: calc(var(--lumo-space-xs) * -1);
    width: var(--lumo-size-s);
    height: var(--lumo-size-s);
  }

  :host([has-children]) [part='content'] {
    padding-inline-end: var(--lumo-space-s);
  }

  @media (any-hover: hover) {
    [part='link']:hover {
      color: var(--lumo-header-text-color);
    }

    [part='toggle-button']:hover {
      color: var(--lumo-body-text-color);
    }
  }

  [part='link']:active:focus {
    background-color: var(--lumo-contrast-5pct);
  }

  [part='toggle-button']::before {
    content: var(--lumo-icons-dropdown);
    transform: rotate(-90deg);
    transition: transform 140ms;
  }

  :host([dir='rtl']) [part='toggle-button']::before {
    transform: rotate(90deg);
  }

  :host([expanded]) [part='toggle-button']::before {
    transform: none;
  }

  @supports selector(:focus-visible) {
    [part='link'],
    [part='toggle-button'] {
      outline: none;
    }

    [part='link']:focus-visible,
    [part='toggle-button']:focus-visible {
      border-radius: var(--lumo-border-radius-m);
      box-shadow: 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
    }
  }

  [part='link']:active {
    color: var(--lumo-header-text-color);
  }

  slot:not([name]) {
    margin: 0 var(--lumo-space-s);
  }

  slot[name='prefix']::slotted(:is(vaadin-icon, [class*='icon'])) {
    padding: 0.1em;
    flex-shrink: 0;
    color: var(--lumo-contrast-60pct);
  }

  :host([disabled]) slot[name='prefix']::slotted(:is(vaadin-icon, [class*='icon'])) {
    color: var(--lumo-disabled-text-color);
  }

  :host([current]) slot[name='prefix']::slotted(:is(vaadin-icon, [class*='icon'])) {
    color: inherit;
  }

  slot[name='children'] {
    --_child-indent: calc(var(--_child-indent-2, 0px) + var(--vaadin-side-nav-child-indent, var(--lumo-space-l)));
  }

  slot[name='children']::slotted(*) {
    --_child-indent-2: var(--_child-indent);
  }

  :host([current]) [part='content'] {
    background-color: var(--lumo-primary-color-10pct);
    color: var(--vaadin-selection-color-text, var(--lumo-primary-text-color));
    border-radius: var(--lumo-border-radius-m);
  }
`;registerStyles("vaadin-side-nav-item",[fieldButton,sideNavItemStyles],{moduleId:"lumo-side-nav-item"});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const to=kt=>kt??D$1;/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const DisabledMixin=dedupingMixin(kt=>class extends kt{static get properties(){return{disabled:{type:Boolean,value:!1,observer:"_disabledChanged",reflectToAttribute:!0}}}_disabledChanged(xt){this._setAriaDisabled(xt)}_setAriaDisabled(xt){xt?this.setAttribute("aria-disabled","true"):this.removeAttribute("aria-disabled")}click(){this.disabled||super.click()}});/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd..
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const screenReaderOnly=i$7`
  .sr-only {
    border: 0 !important;
    clip: rect(1px, 1px, 1px, 1px) !important;
    -webkit-clip-path: inset(50%) !important;
    clip-path: inset(50%) !important;
    height: 1px !important;
    margin: -1px !important;
    overflow: hidden !important;
    padding: 0 !important;
    position: absolute !important;
    width: 1px !important;
    white-space: nowrap !important;
  }
`,appliedClassMixins=new WeakMap;function wasMixinPreviouslyApplied(kt,At){let xt=At;for(;xt;){if(appliedClassMixins.get(xt)===kt)return!0;xt=Object.getPrototypeOf(xt)}return!1}function dedupeMixin(kt){return At=>{if(wasMixinPreviouslyApplied(kt,At))return At;const xt=kt(At);return appliedClassMixins.set(xt,kt),xt}}/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function get$1(kt,At){return kt.split(".").reduce((xt,Bt)=>xt?xt[Bt]:void 0,At)}function set(kt,At,xt){const Bt=kt.split("."),Nt=Bt.pop(),jt=Bt.reduce((Ut,Lt)=>Ut[Lt],xt);jt[Nt]=At}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const caseMap={},CAMEL_TO_DASH=/([A-Z])/gu;function camelToDash(kt){return caseMap[kt]||(caseMap[kt]=kt.replace(CAMEL_TO_DASH,"-$1").toLowerCase()),caseMap[kt]}function upper(kt){return kt[0].toUpperCase()+kt.substring(1)}function parseObserver(kt){const[At,xt]=kt.split("("),Bt=xt.replace(")","").split(",").map(Nt=>Nt.trim());return{method:At,observerProps:Bt}}function getOrCreateMap(kt,At){return Object.prototype.hasOwnProperty.call(kt,At)||(kt[At]=new Map(kt[At])),kt[At]}const PolylitMixinImplementation=kt=>{class At extends kt{static createProperty(Bt,Nt){[String,Boolean,Number,Array].includes(Nt)&&(Nt={type:Nt}),Nt.reflectToAttribute&&(Nt.reflect=!0),super.createProperty(Bt,Nt)}static getOrCreateMap(Bt){return getOrCreateMap(this,Bt)}static finalize(){if(super.finalize(),Array.isArray(this.observers)){const Bt=this.getOrCreateMap("__complexObservers");this.observers.forEach(Nt=>{const{method:jt,observerProps:Ut}=parseObserver(Nt);Bt.set(jt,Ut)})}}static addCheckedInitializer(Bt){super.addInitializer(Nt=>{Nt instanceof this&&Bt(Nt)})}static getPropertyDescriptor(Bt,Nt,jt){const Ut=super.getPropertyDescriptor(Bt,Nt,jt);let Lt=Ut;if(this.getOrCreateMap("__propKeys").set(Bt,Nt),jt.sync&&(Lt={get:Ut.get,set(Ht){const Vt=this[Bt];this[Nt]=Ht,this.requestUpdate(Bt,Vt,jt),this.hasUpdated&&this.performUpdate()},configurable:!0,enumerable:!0}),jt.readOnly){const Ht=Ut.set;this.addCheckedInitializer(Vt=>{Vt[`_set${upper(Bt)}`]=function(zt){Ht.call(Vt,zt),jt.sync&&this.performUpdate()}}),Lt={get:Ut.get,set(){},configurable:!0,enumerable:!0}}if("value"in jt&&this.addCheckedInitializer(Ht=>{const Vt=typeof jt.value=="function"?jt.value.call(Ht):jt.value;jt.readOnly?Ht[`_set${upper(Bt)}`](Vt):Ht[Bt]=Vt}),jt.observer){const Ht=jt.observer;this.getOrCreateMap("__observers").set(Bt,Ht),this.addCheckedInitializer(Vt=>{Vt[Ht]||console.warn(`observer method ${Ht} not defined`)})}if(jt.notify){if(!this.__notifyProps)this.__notifyProps=new Set;else if(!this.hasOwnProperty("__notifyProps")){const Ht=this.__notifyProps;this.__notifyProps=new Set(Ht)}this.__notifyProps.add(Bt)}if(jt.computed){const Ht=`__assignComputed${Bt}`,Vt=parseObserver(jt.computed);this.prototype[Ht]=function(...zt){this[Bt]=this[Vt.method](...zt)},this.getOrCreateMap("__complexObservers").set(Ht,Vt.observerProps)}return jt.attribute||(jt.attribute=camelToDash(Bt)),Lt}firstUpdated(){super.firstUpdated(),this.$||(this.$={}),this.renderRoot.querySelectorAll("[id]").forEach(Bt=>{this.$[Bt.id]=Bt})}ready(){}updated(Bt){this.constructor.__observers&&this.__runObservers(Bt,this.constructor.__observers),this.constructor.__complexObservers&&this.__runComplexObservers(Bt,this.constructor.__complexObservers),this.__dynamicObservers&&this.__runComplexObservers(Bt,this.__dynamicObservers),this.constructor.__notifyProps&&this.__runNotifyProps(Bt,this.constructor.__notifyProps),this.__isReadyInvoked||(this.__isReadyInvoked=!0,this.ready())}setProperties(Bt){Object.entries(Bt).forEach(([Nt,jt])=>{const Ut=this.constructor.__propKeys.get(Nt),Lt=this[Ut];this[Ut]=jt,this.requestUpdate(Nt,Lt)}),this.hasUpdated&&this.performUpdate()}_createMethodObserver(Bt){const Nt=getOrCreateMap(this,"__dynamicObservers"),{method:jt,observerProps:Ut}=parseObserver(Bt);Nt.set(jt,Ut)}__runComplexObservers(Bt,Nt){Nt.forEach((jt,Ut)=>{jt.some(Lt=>Bt.has(Lt))&&(this[Ut]?this[Ut](...jt.map(Lt=>this[Lt])):console.warn(`observer method ${Ut} not defined`))})}__runObservers(Bt,Nt){Bt.forEach((jt,Ut)=>{const Lt=Nt.get(Ut);Lt!==void 0&&this[Lt]&&this[Lt](this[Ut],jt)})}__runNotifyProps(Bt,Nt){Bt.forEach((jt,Ut)=>{Nt.has(Ut)&&this.dispatchEvent(new CustomEvent(`${camelToDash(Ut)}-changed`,{detail:{value:this[Ut]}}))})}_get(Bt,Nt){return get$1(Bt,Nt)}_set(Bt,Nt,jt){set(Bt,Nt,jt)}}return At},PolylitMixin=dedupeMixin(PolylitMixinImplementation);/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function containsQueryParams(kt,At){return[...At.entries()].every(([xt,Bt])=>kt.getAll(xt).includes(Bt))}function matchPaths(kt,At){const xt=document.baseURI,Bt=new URL(kt,xt),Nt=new URL(At,xt);return Bt.origin===Nt.origin&&Bt.pathname===Nt.pathname&&containsQueryParams(Bt.searchParams,Nt.searchParams)}/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const sideNavItemBaseStyles=i$7`
  :host {
    display: block;
  }

  :host([hidden]),
  [hidden] {
    display: none !important;
  }

  :host([disabled]) {
    pointer-events: none;
  }

  [part='content'] {
    display: flex;
    align-items: center;
  }

  [part='link'] {
    flex: auto;
    min-width: 0;
    display: flex;
    align-items: center;
    text-decoration: none;
    color: inherit;
    font: inherit;
  }

  button {
    -webkit-appearance: none;
    appearance: none;
    flex: none;
    position: relative;
    margin: 0;
    padding: 0;
    border: 0;
    background: transparent;
  }

  [part='children'] {
    padding: 0;
    margin: 0;
    list-style-type: none;
  }

  :host(:not([has-children])) button {
    display: none !important;
  }

  slot[name='prefix'],
  slot[name='suffix'] {
    flex: none;
  }

  slot:not([name]) {
    display: block;
    flex: auto;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
`,sideNavBaseStyles=i$7`
  :host {
    display: block;
  }

  :host([hidden]) {
    display: none !important;
  }

  button {
    display: flex;
    align-items: center;
    justify-content: inherit;
    width: 100%;
    margin: 0;
    padding: 0;
    background-color: initial;
    color: inherit;
    border: initial;
    outline: none;
    font: inherit;
    text-align: inherit;
  }

  [part='children'] {
    padding: 0;
    margin: 0;
    list-style-type: none;
  }
`;/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function isEmptyTextNode(kt){return kt.nodeType===Node.TEXT_NODE&&kt.textContent.trim()===""}/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class SlotObserver{constructor(At,xt){this.slot=At,this.callback=xt,this._storedNodes=[],this._connected=!1,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){this.slot.addEventListener("slotchange",this._boundSchedule),this._connected=!0}disconnect(){this.slot.removeEventListener("slotchange",this._boundSchedule),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,queueMicrotask(()=>{this.flush()}))}flush(){this._connected&&(this._scheduled=!1,this._processNodes())}_processNodes(){const At=this.slot.assignedNodes({flatten:!0});let xt=[];const Bt=[],Nt=[];At.length&&(xt=At.filter(jt=>!this._storedNodes.includes(jt))),this._storedNodes.length&&this._storedNodes.forEach((jt,Ut)=>{const Lt=At.indexOf(jt);Lt===-1?Bt.push(jt):Lt!==Ut&&Nt.push(jt)}),(xt.length||Bt.length||Nt.length)&&this.callback({addedNodes:xt,movedNodes:Nt,removedNodes:Bt}),this._storedNodes=At}}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */let uniqueId=0;function generateUniqueId(){return uniqueId++}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class SlotController extends EventTarget{static generateId(At,xt){return`${xt||"default"}-${At.localName}-${generateUniqueId()}`}constructor(At,xt,Bt,Nt={}){super();const{initializer:jt,multiple:Ut,observe:Lt,useUniqueId:Ht}=Nt;this.host=At,this.slotName=xt,this.tagName=Bt,this.observe=typeof Lt=="boolean"?Lt:!0,this.multiple=typeof Ut=="boolean"?Ut:!1,this.slotInitializer=jt,Ut&&(this.nodes=[]),Ht&&(this.defaultId=this.constructor.generateId(At,xt))}hostConnected(){this.initialized||(this.multiple?this.initMultiple():this.initSingle(),this.observe&&this.observeSlot(),this.initialized=!0)}initSingle(){let At=this.getSlotChild();At?(this.node=At,this.initAddedNode(At)):(At=this.attachDefaultNode(),this.initNode(At))}initMultiple(){const At=this.getSlotChildren();if(At.length===0){const xt=this.attachDefaultNode();xt&&(this.nodes=[xt],this.initNode(xt))}else this.nodes=At,At.forEach(xt=>{this.initAddedNode(xt)})}attachDefaultNode(){const{host:At,slotName:xt,tagName:Bt}=this;let Nt=this.defaultNode;return!Nt&&Bt&&(Nt=document.createElement(Bt),Nt instanceof Element&&(xt!==""&&Nt.setAttribute("slot",xt),this.defaultNode=Nt)),Nt&&(this.node=Nt,At.appendChild(Nt)),Nt}getSlotChildren(){const{slotName:At}=this;return Array.from(this.host.childNodes).filter(xt=>xt.nodeType===Node.ELEMENT_NODE&&xt.slot===At||xt.nodeType===Node.TEXT_NODE&&xt.textContent.trim()&&At==="")}getSlotChild(){return this.getSlotChildren()[0]}initNode(At){const{slotInitializer:xt}=this;xt&&xt(At,this.host)}initCustomNode(At){}teardownNode(At){}initAddedNode(At){At!==this.defaultNode&&(this.initCustomNode(At),this.initNode(At))}observeSlot(){const{slotName:At}=this,xt=At===""?"slot:not([name])":`slot[name=${At}]`,Bt=this.host.shadowRoot.querySelector(xt);this.__slotObserver=new SlotObserver(Bt,({addedNodes:Nt,removedNodes:jt})=>{const Ut=this.multiple?this.nodes:[this.node],Lt=Nt.filter(Ht=>!isEmptyTextNode(Ht)&&!Ut.includes(Ht));jt.length&&(this.nodes=Ut.filter(Ht=>!jt.includes(Ht)),jt.forEach(Ht=>{this.teardownNode(Ht)})),Lt&&Lt.length>0&&(this.multiple?(this.defaultNode&&this.defaultNode.remove(),this.nodes=[...Ut,...Lt].filter(Ht=>Ht!==this.defaultNode),Lt.forEach(Ht=>{this.initAddedNode(Ht)})):(this.node&&this.node.remove(),this.node=Lt[0],this.initAddedNode(this.node)))})}}/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class ChildrenController extends SlotController{constructor(At,xt){super(At,xt,null,{observe:!0,multiple:!0})}initAddedNode(){this.host.requestUpdate()}teardownNode(){this.host.requestUpdate()}}const SideNavChildrenMixin=kt=>class extends kt{static get properties(){return{i18n:{type:Object,value:()=>({toggle:"Toggle child items"})},_itemsCount:{type:Number,value:0}}}constructor(){super(),this._childrenController=new ChildrenController(this,this._itemsSlotName)}get _items(){return this._childrenController.nodes}get _itemsSlotName(){return"children"}firstUpdated(){super.firstUpdated(),this.addController(this._childrenController)}willUpdate(xt){super.willUpdate(xt),this._itemsCount=this._items.length}updated(xt){super.updated(xt),xt.has("_itemsCount")&&this.toggleAttribute("has-children",this._itemsCount>0),(xt.has("_itemsCount")||xt.has("i18n"))&&this._items.forEach(Bt=>{Bt.i18n=this.i18n})}};/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class SideNavItem extends SideNavChildrenMixin(DisabledMixin(ElementMixin(ThemableMixin(PolylitMixin(h$2))))){static get is(){return"vaadin-side-nav-item"}static get properties(){return{path:String,pathAliases:{type:Array,value:()=>[]},expanded:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},current:{type:Boolean,value:!1,readOnly:!0,reflectToAttribute:!0},target:String,routerIgnore:{type:Boolean,value:!1}}}static get styles(){return[screenReaderOnly,sideNavItemBaseStyles]}constructor(){super(),this.__boundUpdateCurrent=this.__updateCurrent.bind(this)}get _button(){return this.shadowRoot.querySelector("button")}firstUpdated(){super.firstUpdated(),this.hasAttribute("role")||this.setAttribute("role","listitem")}updated(At){super.updated(At),(At.has("path")||At.has("pathAliases"))&&this.__updateCurrent(),(At.has("disabled")||At.has("_itemsCount"))&&this._items.forEach(xt=>{xt.disabled=this.disabled})}connectedCallback(){super.connectedCallback(),this.__updateCurrent(),window.addEventListener("popstate",this.__boundUpdateCurrent),window.addEventListener("vaadin-navigated",this.__boundUpdateCurrent),window.addEventListener("side-nav-location-changed",this.__boundUpdateCurrent)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("popstate",this.__boundUpdateCurrent),window.removeEventListener("vaadin-navigated",this.__boundUpdateCurrent),window.removeEventListener("side-nav-location-changed",this.__boundUpdateCurrent)}render(){return ke$2`
      <div part="content" @click="${this._onContentClick}">
        <a
          id="link"
          ?disabled="${this.disabled}"
          tabindex="${this.disabled||this.path==null?"-1":"0"}"
          href="${to(this.disabled?null:this.path)}"
          target="${to(this.target)}"
          ?router-ignore="${this.routerIgnore}"
          part="link"
          aria-current="${this.current?"page":"false"}"
        >
          <slot name="prefix"></slot>
          <slot></slot>
          <slot name="suffix"></slot>
        </a>
        <button
          part="toggle-button"
          ?disabled="${this.disabled}"
          @click="${this._onButtonClick}"
          aria-controls="children"
          aria-expanded="${this.expanded}"
          aria-labelledby="link i18n"
        ></button>
      </div>
      <ul part="children" role="list" ?hidden="${!this.expanded}" aria-hidden="${this.expanded?"false":"true"}">
        <slot name="children"></slot>
      </ul>
      <div class="sr-only" id="i18n">${this.i18n.toggle}</div>
    `}_onButtonClick(At){At.stopPropagation(),this.__toggleExpanded()}_onContentClick(){this.path==null&&this.hasAttribute("has-children")&&this.__toggleExpanded()}__toggleExpanded(){this.expanded=!this.expanded}__updateCurrent(){this._setCurrent(this.__isCurrent()),this.current&&(this.__expandParentItems(),this.expanded=this._items.length>0)}__expandParentItems(){const At=this.__getParentItem();At&&At.__expandParentItems(),this.expanded=!0}__getParentItem(){return this.parentElement instanceof SideNavItem?this.parentElement:null}__isCurrent(){if(this.path==null)return!1;const At=`${document.location.pathname}${document.location.search}`;return matchPaths(At,this.path)||this.pathAliases.some(xt=>matchPaths(At,xt))}}defineCustomElement(SideNavItem);const sideNavStyles=i$7`
  :host {
    font-family: var(--lumo-font-family);
    font-size: var(--lumo-font-size-m);
    font-weight: 500;
    line-height: var(--lumo-line-height-xs);
    color: var(--lumo-body-text-color);
    -webkit-tap-highlight-color: transparent;
    --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
    --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
  }

  [part='label'] {
    display: flex;
    align-items: center;
    width: 100%;
    outline: none;
    box-sizing: border-box;
    border-radius: var(--lumo-border-radius-m);
    font-family: var(--lumo-font-family);
    font-size: var(--lumo-font-size-s);
    font-weight: 500;
    line-height: var(--lumo-line-height-xs);
  }

  [part='label'] ::slotted([slot='label']) {
    color: var(--lumo-secondary-text-color);
    margin: var(--lumo-space-s);
  }

  :host([focus-ring]) [part='label'] {
    box-shadow: 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
  }

  [part='toggle-button'] {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--lumo-size-s);
    height: var(--lumo-size-s);
    margin-inline-start: auto;
    margin-inline-end: var(--lumo-space-xs);
    font-size: var(--lumo-icon-size-m);
    line-height: 1;
    color: var(--lumo-contrast-60pct);
    font-family: 'lumo-icons';
    cursor: var(--lumo-clickable-cursor);
  }

  [part='toggle-button']::before {
    content: var(--lumo-icons-angle-right);
    transition: transform 140ms;
  }

  :host(:not([collapsible])) [part='toggle-button'] {
    display: none !important;
  }

  :host(:not([collapsed])) [part='toggle-button']::before {
    transform: rotate(90deg);
  }

  :host([collapsed][dir='rtl']) [part='toggle-button']::before {
    transform: rotate(180deg);
  }

  @media (any-hover: hover) {
    [part='label']:hover [part='toggle-button'] {
      color: var(--lumo-body-text-color);
    }
  }
`;registerStyles("vaadin-side-nav",sideNavStyles,{moduleId:"lumo-side-nav"});/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const FocusMixin=dedupingMixin(kt=>class extends kt{get _keyboardActive(){return isKeyboardActive()}ready(){this.addEventListener("focusin",xt=>{this._shouldSetFocus(xt)&&this._setFocused(!0)}),this.addEventListener("focusout",xt=>{this._shouldRemoveFocus(xt)&&this._setFocused(!1)}),super.ready()}disconnectedCallback(){super.disconnectedCallback(),this.hasAttribute("focused")&&this._setFocused(!1)}_setFocused(xt){this.toggleAttribute("focused",xt),this.toggleAttribute("focus-ring",xt&&this._keyboardActive)}_shouldSetFocus(xt){return!0}_shouldRemoveFocus(xt){return!0}});/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class SideNav extends SideNavChildrenMixin(FocusMixin(ElementMixin(ThemableMixin(PolylitMixin(h$2))))){static get is(){return"vaadin-side-nav"}static get shadowRootOptions(){return{...h$2.shadowRootOptions,delegatesFocus:!0}}static get properties(){return{collapsible:{type:Boolean,value:!1,reflectToAttribute:!0},collapsed:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},onNavigate:{attribute:!1},location:{observer:"__locationChanged"}}}static get styles(){return sideNavBaseStyles}constructor(){super(),this._labelId=`side-nav-label-${generateUniqueId()}`,this.addEventListener("click",this.__onClick)}get _itemsSlotName(){return""}get focusElement(){return this.shadowRoot.querySelector("button")}firstUpdated(){super.firstUpdated(),this.hasAttribute("role")||this.setAttribute("role","navigation")}render(){return ke$2`
      ${this.collapsible?ke$2`
            <button
              part="label"
              @click="${this._onLabelClick}"
              aria-expanded="${!this.collapsed}"
              aria-controls="children"
            >
              <slot name="label" @slotchange="${this._onLabelSlotChange}"></slot>
              <span part="toggle-button" aria-hidden="true"></span>
            </button>
          `:ke$2`
            <div part="label">
              <slot name="label" @slotchange="${this._onLabelSlotChange}"></slot>
            </div>
          `}
      <ul
        id="children"
        role="list"
        part="children"
        ?hidden="${this.collapsed}"
        aria-hidden="${this.collapsed?"true":"false"}"
      >
        <slot></slot>
      </ul>
    `}_shouldSetFocus(At){return At.composedPath()[0]===this.focusElement}_onLabelClick(){this.collapsible&&this.__toggleCollapsed()}_onLabelSlotChange(){const At=this.querySelector('[slot="label"]');At?(At.id||(At.id=this._labelId),this.setAttribute("aria-labelledby",At.id)):this.removeAttribute("aria-labelledby")}__locationChanged(){window.dispatchEvent(new CustomEvent("side-nav-location-changed"))}__toggleCollapsed(){this.collapsed=!this.collapsed}__onClick(At){if(!this.onNavigate||At.metaKey||At.shiftKey)return;const Bt=At.composedPath(),Nt=Bt.find(Ht=>Ht.localName&&Ht.localName.includes("side-nav-item")),jt=Bt.find(Ht=>Ht instanceof HTMLAnchorElement);if(!Nt||!Nt.shadowRoot.contains(jt)||!(jt.href&&jt.href.startsWith(location.origin))||Nt.target==="_blank"||Nt.routerIgnore)return;this.onNavigate({path:Nt.path,target:Nt.target,current:Nt.current,expanded:Nt.expanded,pathAliases:Nt.pathAliases,originalEvent:At})!==!1&&At.preventDefault()}}defineCustomElement(SideNav);const scroller=i$7`
  :host {
    outline: none;
    --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
    --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
  }

  :host([focus-ring]) {
    box-shadow: 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
  }

  /* Show dividers when content overflows */

  :host([theme~='overflow-indicators'])::before,
  :host([theme~='overflow-indicators'])::after {
    content: '';
    display: none;
    position: sticky;
    inset: 0;
    z-index: 9999;
    height: 1px;
    margin-bottom: -1px;
    background: var(--lumo-contrast-10pct);
  }

  :host([theme~='overflow-indicators'])::after {
    margin-bottom: 0;
    margin-top: -1px;
  }

  :host([theme~='overflow-indicators'][overflow~='top'])::before,
  :host([theme~='overflow-indicators'][overflow~='bottom'])::after {
    display: block;
  }
`;registerStyles("vaadin-scroller",scroller,{moduleId:"lumo-scroller"});/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class OverflowController{constructor(At,xt){this.host=At,this.scrollTarget=xt||At,this.__boundOnScroll=this.__onScroll.bind(this)}hostConnected(){this.initialized||(this.initialized=!0,this.observe())}observe(){const{host:At}=this;this.__resizeObserver=new ResizeObserver(xt=>{this.__debounceOverflow=Debouncer.debounce(this.__debounceOverflow,animationFrame,()=>{this.__updateOverflow()})}),this.__resizeObserver.observe(At),[...At.children].forEach(xt=>{this.__resizeObserver.observe(xt)}),this.__childObserver=new MutationObserver(xt=>{xt.forEach(({addedNodes:Bt,removedNodes:Nt})=>{Bt.forEach(jt=>{jt.nodeType===Node.ELEMENT_NODE&&this.__resizeObserver.observe(jt)}),Nt.forEach(jt=>{jt.nodeType===Node.ELEMENT_NODE&&this.__resizeObserver.unobserve(jt)})}),this.__updateOverflow()}),this.__childObserver.observe(At,{childList:!0}),this.scrollTarget.addEventListener("scroll",this.__boundOnScroll),this.__updateOverflow()}__onScroll(){this.__updateOverflow()}__updateOverflow(){const At=this.scrollTarget;let xt="";At.scrollTop>0&&(xt+=" top"),Math.ceil(At.scrollTop)<Math.ceil(At.scrollHeight-At.clientHeight)&&(xt+=" bottom");const Bt=Math.abs(At.scrollLeft);Bt>0&&(xt+=" start"),Math.ceil(Bt)<Math.ceil(At.scrollWidth-At.clientWidth)&&(xt+=" end"),xt=xt.trim(),xt.length>0&&this.host.getAttribute("overflow")!==xt?this.host.setAttribute("overflow",xt):xt.length===0&&this.host.hasAttribute("overflow")&&this.host.removeAttribute("overflow")}}/**
 * @license
 * Copyright (c) 2020 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class Scroller extends FocusMixin(ElementMixin(ControllerMixin(ThemableMixin(PolymerElement)))){static get template(){return html`
      <style>
        :host([hidden]) {
          display: none !important;
        }

        :host {
          display: block;
          overflow: auto;
        }

        :host([scroll-direction='vertical']) {
          overflow-x: hidden;
        }

        :host([scroll-direction='horizontal']) {
          overflow-y: hidden;
        }

        :host([scroll-direction='none']) {
          overflow: hidden;
        }
      </style>

      <slot></slot>
    `}static get is(){return"vaadin-scroller"}static get properties(){return{scrollDirection:{type:String,reflectToAttribute:!0},tabindex:{type:Number,value:0,reflectToAttribute:!0}}}ready(){super.ready(),this.__overflowController=new OverflowController(this),this.addController(this.__overflowController)}_shouldSetFocus(At){return At.target===this}}defineCustomElement(Scroller);const button=i$7`
  :host {
    /* Sizing */
    --lumo-button-size: var(--lumo-size-m);
    min-width: var(--vaadin-button-min-width, calc(var(--_button-size) * 2));
    height: var(--_button-size);
    padding: var(--vaadin-button-padding, 0 calc(var(--_button-size) / 3 + var(--lumo-border-radius-m) / 2));
    margin: var(--vaadin-button-margin, var(--lumo-space-xs) 0);
    box-sizing: border-box;
    /* Style */
    font-family: var(--lumo-font-family);
    font-size: var(--vaadin-button-font-size, var(--lumo-font-size-m));
    font-weight: var(--vaadin-button-font-weight, 500);
    color: var(--_lumo-button-text-color);
    background: var(--_lumo-button-background);
    border: var(--vaadin-button-border, none);
    border-radius: var(--vaadin-button-border-radius, var(--lumo-border-radius-m));
    cursor: var(--lumo-clickable-cursor);
    -webkit-tap-highlight-color: transparent;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    flex-shrink: 0;
    --_button-size: var(--vaadin-button-height, var(--lumo-button-size));
    --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
    --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
    /* Used by notification */
    --_lumo-button-background: var(--vaadin-button-background, var(--lumo-contrast-5pct));
    --_lumo-button-text-color: var(--vaadin-button-text-color, var(--lumo-primary-text-color));
    --_lumo-button-primary-background: var(--vaadin-button-primary-background, var(--lumo-primary-color));
    --_lumo-button-primary-text-color: var(--vaadin-button-primary-text-color, var(--lumo-primary-contrast-color));
  }

  /* Set only for the internal parts so we don't affect the host vertical alignment */
  [part='label'],
  [part='prefix'],
  [part='suffix'] {
    line-height: var(--lumo-line-height-xs);
  }

  [part='label'] {
    padding: calc(var(--lumo-button-size) / 6) 0;
  }

  :host([theme~='small']) {
    font-size: var(--lumo-font-size-s);
    --lumo-button-size: var(--lumo-size-s);
  }

  :host([theme~='large']) {
    font-size: var(--lumo-font-size-l);
    --lumo-button-size: var(--lumo-size-l);
  }

  /* For interaction states */
  :host::before,
  :host::after {
    content: '';
    /* We rely on the host always being relative */
    position: absolute;
    z-index: 1;
    inset: 0;
    background-color: currentColor;
    border-radius: inherit;
    opacity: 0;
    pointer-events: none;
  }

  /* Hover */

  @media (any-hover: hover) {
    :host(:hover)::before {
      opacity: 0.02;
    }
  }

  /* Active */

  :host::after {
    transition: opacity 1.4s, transform 0.1s;
    filter: blur(8px);
  }

  :host([active])::before {
    opacity: 0.05;
    transition-duration: 0s;
  }

  :host([active])::after {
    opacity: 0.1;
    transition-duration: 0s, 0s;
    transform: scale(0);
  }

  /* Keyboard focus */

  :host([focus-ring]) {
    box-shadow: 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
  }

  :host([theme~='primary'][focus-ring]) {
    box-shadow: 0 0 0 1px var(--lumo-base-color), 0 0 0 3px var(--lumo-primary-color-50pct);
  }

  /* Types (primary, tertiary, tertiary-inline */

  :host([theme~='tertiary']),
  :host([theme~='tertiary-inline']) {
    --_background: transparent !important;
    background: var(--vaadin-button-tertiary-background, var(--_background));
    min-width: 0;
  }

  :host([theme~='tertiary']) {
    border: var(--vaadin-button-tertiary-border, none);
    color: var(--vaadin-button-tertiary-text-color, var(--lumo-primary-text-color));
    font-weight: var(--vaadin-button-tertiary-font-weight, 500);
    padding: var(--vaadin-button-tertiary-padding, 0 calc(var(--_button-size) / 6));
  }

  :host([theme~='tertiary-inline'])::before {
    display: none;
  }

  :host([theme~='tertiary-inline']) {
    margin: 0;
    height: auto;
    padding: 0;
    line-height: inherit;
    font-size: inherit;
  }

  :host([theme~='tertiary-inline']) [part='label'] {
    padding: 0;
    overflow: visible;
    line-height: inherit;
  }

  :host([theme~='primary']) {
    background: var(--_lumo-button-primary-background);
    border: var(--vaadin-button-primary-border, none);
    color: var(--_lumo-button-primary-text-color);
    font-weight: var(--vaadin-button-primary-font-weight, 600);
    min-width: calc(var(--lumo-button-size) * 2.5);
  }

  :host([theme~='primary'])::before {
    background-color: black;
  }

  @media (any-hover: hover) {
    :host([theme~='primary']:hover)::before {
      opacity: 0.05;
    }
  }

  :host([theme~='primary'][active])::before {
    opacity: 0.1;
  }

  :host([theme~='primary'][active])::after {
    opacity: 0.2;
  }

  /* Colors (success, error, contrast) */

  :host([theme~='success']) {
    color: var(--lumo-success-text-color);
  }

  :host([theme~='success'][theme~='primary']) {
    background-color: var(--lumo-success-color);
    color: var(--lumo-success-contrast-color);
  }

  :host([theme~='error']) {
    color: var(--lumo-error-text-color);
  }

  :host([theme~='error'][theme~='primary']) {
    background-color: var(--lumo-error-color);
    color: var(--lumo-error-contrast-color);
  }

  :host([theme~='contrast']) {
    color: var(--lumo-contrast);
  }

  :host([theme~='contrast'][theme~='primary']) {
    background-color: var(--lumo-contrast);
    color: var(--lumo-base-color);
  }

  /* Disabled state. Keep selectors after other color variants. */

  :host([disabled]) {
    pointer-events: none;
    color: var(--lumo-disabled-text-color);
  }

  :host([theme~='primary'][disabled]) {
    background-color: var(--lumo-contrast-30pct);
    color: var(--lumo-base-color);
  }

  :host([theme~='primary'][disabled]) [part] {
    opacity: 0.7;
  }

  /* Icons */

  [part] ::slotted(vaadin-icon) {
    display: inline-block;
    width: var(--lumo-icon-size-m);
    height: var(--lumo-icon-size-m);
  }

  /* Vaadin icons are based on a 16x16 grid (unlike Lumo and Material icons with 24x24), so they look too big by default */
  [part] ::slotted(vaadin-icon[icon^='vaadin:']) {
    padding: 0.25em;
    box-sizing: border-box !important;
  }

  [part='prefix'] {
    margin-left: -0.25em;
    margin-right: 0.25em;
  }

  [part='suffix'] {
    margin-left: 0.25em;
    margin-right: -0.25em;
  }

  /* Icon-only */

  :host([theme~='icon']:not([theme~='tertiary-inline'])) {
    min-width: var(--lumo-button-size);
    padding-left: calc(var(--lumo-button-size) / 4);
    padding-right: calc(var(--lumo-button-size) / 4);
  }

  :host([theme~='icon']) [part='prefix'],
  :host([theme~='icon']) [part='suffix'] {
    margin-left: 0;
    margin-right: 0;
  }

  /* RTL specific styles */

  :host([dir='rtl']) [part='prefix'] {
    margin-left: 0.25em;
    margin-right: -0.25em;
  }

  :host([dir='rtl']) [part='suffix'] {
    margin-left: -0.25em;
    margin-right: 0.25em;
  }

  :host([dir='rtl'][theme~='icon']) [part='prefix'],
  :host([dir='rtl'][theme~='icon']) [part='suffix'] {
    margin-left: 0;
    margin-right: 0;
  }
`;registerStyles("vaadin-button",button,{moduleId:"lumo-button"});/**
 * @license
 * Copyright (c) 2022 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class TooltipController extends SlotController{constructor(At){super(At,"tooltip"),this.setTarget(At)}initCustomNode(At){At.target=this.target,this.ariaTarget!==void 0&&(At.ariaTarget=this.ariaTarget),this.context!==void 0&&(At.context=this.context),this.manual!==void 0&&(At.manual=this.manual),this.opened!==void 0&&(At.opened=this.opened),this.position!==void 0&&(At._position=this.position),this.shouldShow!==void 0&&(At.shouldShow=this.shouldShow),this.__notifyChange()}teardownNode(){this.__notifyChange()}setAriaTarget(At){this.ariaTarget=At;const xt=this.node;xt&&(xt.ariaTarget=At)}setContext(At){this.context=At;const xt=this.node;xt&&(xt.context=At)}setManual(At){this.manual=At;const xt=this.node;xt&&(xt.manual=At)}setOpened(At){this.opened=At;const xt=this.node;xt&&(xt.opened=At)}setPosition(At){this.position=At;const xt=this.node;xt&&(xt._position=At)}setShouldShow(At){this.shouldShow=At;const xt=this.node;xt&&(xt.shouldShow=At)}setTarget(At){this.target=At;const xt=this.node;xt&&(xt.target=At)}__notifyChange(){this.dispatchEvent(new CustomEvent("tooltip-changed",{detail:{node:this.node}}))}}/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const buttonStyles=i$7`
  :host {
    display: inline-block;
    position: relative;
    outline: none;
    white-space: nowrap;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }

  :host([hidden]) {
    display: none !important;
  }

  /* Aligns the button with form fields when placed on the same line.
  Note, to make it work, the form fields should have the same "::before" pseudo-element. */
  .vaadin-button-container::before {
    content: '\\2003';
    display: inline-block;
    width: 0;
    max-height: 100%;
  }

  .vaadin-button-container {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    width: 100%;
    height: 100%;
    min-height: inherit;
    text-shadow: inherit;
  }

  [part='prefix'],
  [part='suffix'] {
    flex: none;
  }

  [part='label'] {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  @media (forced-colors: active) {
    :host {
      outline: 1px solid;
      outline-offset: -1px;
    }

    :host([focused]) {
      outline-width: 2px;
    }

    :host([disabled]) {
      outline-color: GrayText;
    }
  }
`,buttonTemplate=kt=>kt`
  <div class="vaadin-button-container">
    <span part="prefix" aria-hidden="true">
      <slot name="prefix"></slot>
    </span>
    <span part="label">
      <slot></slot>
    </span>
    <span part="suffix" aria-hidden="true">
      <slot name="suffix"></slot>
    </span>
  </div>
  <slot name="tooltip"></slot>
`;/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const passiveTouchGestures=!1,wrap=kt=>kt,HAS_NATIVE_TA=typeof document.head.style.touchAction=="string",GESTURE_KEY="__polymerGestures",HANDLED_OBJ="__polymerGesturesHandled",TOUCH_ACTION="__polymerGesturesTouchAction",TAP_DISTANCE=25,TRACK_DISTANCE=5,TRACK_LENGTH=2,MOUSE_EVENTS=["mousedown","mousemove","mouseup","click"],MOUSE_WHICH_TO_BUTTONS=[0,1,4,2],MOUSE_HAS_BUTTONS=function(){try{return new MouseEvent("test",{buttons:1}).buttons===1}catch{return!1}}();function isMouseEvent(kt){return MOUSE_EVENTS.indexOf(kt)>-1}let supportsPassive=!1;(function(){try{const kt=Object.defineProperty({},"passive",{get(){supportsPassive=!0}});window.addEventListener("test",null,kt),window.removeEventListener("test",null,kt)}catch{}})();function PASSIVE_TOUCH(kt){if(!(isMouseEvent(kt)||kt==="touchend")&&HAS_NATIVE_TA&&supportsPassive&&passiveTouchGestures)return{passive:!0}}const IS_TOUCH_ONLY=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/u),canBeDisabled={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function hasLeftMouseButton(kt){const At=kt.type;if(!isMouseEvent(At))return!1;if(At==="mousemove"){let Bt=kt.buttons===void 0?1:kt.buttons;return kt instanceof window.MouseEvent&&!MOUSE_HAS_BUTTONS&&(Bt=MOUSE_WHICH_TO_BUTTONS[kt.which]||0),!!(Bt&1)}return(kt.button===void 0?0:kt.button)===0}function isSyntheticClick(kt){if(kt.type==="click"){if(kt.detail===0)return!0;const At=_findOriginalTarget(kt);if(!At.nodeType||At.nodeType!==Node.ELEMENT_NODE)return!0;const xt=At.getBoundingClientRect(),Bt=kt.pageX,Nt=kt.pageY;return!(Bt>=xt.left&&Bt<=xt.right&&Nt>=xt.top&&Nt<=xt.bottom)}return!1}const POINTERSTATE={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function firstTouchAction(kt){let At="auto";const xt=getComposedPath(kt);for(let Bt=0,Nt;Bt<xt.length;Bt++)if(Nt=xt[Bt],Nt[TOUCH_ACTION]){At=Nt[TOUCH_ACTION];break}return At}function trackDocument(kt,At,xt){kt.movefn=At,kt.upfn=xt,document.addEventListener("mousemove",At),document.addEventListener("mouseup",xt)}function untrackDocument(kt){document.removeEventListener("mousemove",kt.movefn),document.removeEventListener("mouseup",kt.upfn),kt.movefn=null,kt.upfn=null}const getComposedPath=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:kt=>kt.composedPath&&kt.composedPath()||[],gestures={},recognizers=[];function deepTargetFind(kt,At){let xt=document.elementFromPoint(kt,At),Bt=xt;for(;Bt&&Bt.shadowRoot&&!window.ShadyDOM;){const Nt=Bt;if(Bt=Bt.shadowRoot.elementFromPoint(kt,At),Nt===Bt)break;Bt&&(xt=Bt)}return xt}function _findOriginalTarget(kt){const At=getComposedPath(kt);return At.length>0?At[0]:kt.target}function _handleNative(kt){const At=kt.type,Bt=kt.currentTarget[GESTURE_KEY];if(!Bt)return;const Nt=Bt[At];if(!Nt)return;if(!kt[HANDLED_OBJ]&&(kt[HANDLED_OBJ]={},At.startsWith("touch"))){const Ut=kt.changedTouches[0];if(At==="touchstart"&&kt.touches.length===1&&(POINTERSTATE.touch.id=Ut.identifier),POINTERSTATE.touch.id!==Ut.identifier)return;HAS_NATIVE_TA||(At==="touchstart"||At==="touchmove")&&_handleTouchAction(kt)}const jt=kt[HANDLED_OBJ];if(!jt.skip){for(let Ut=0,Lt;Ut<recognizers.length;Ut++)Lt=recognizers[Ut],Nt[Lt.name]&&!jt[Lt.name]&&Lt.flow&&Lt.flow.start.indexOf(kt.type)>-1&&Lt.reset&&Lt.reset();for(let Ut=0,Lt;Ut<recognizers.length;Ut++)Lt=recognizers[Ut],Nt[Lt.name]&&!jt[Lt.name]&&(jt[Lt.name]=!0,Lt[At](kt))}}function _handleTouchAction(kt){const At=kt.changedTouches[0],xt=kt.type;if(xt==="touchstart")POINTERSTATE.touch.x=At.clientX,POINTERSTATE.touch.y=At.clientY,POINTERSTATE.touch.scrollDecided=!1;else if(xt==="touchmove"){if(POINTERSTATE.touch.scrollDecided)return;POINTERSTATE.touch.scrollDecided=!0;const Bt=firstTouchAction(kt);let Nt=!1;const jt=Math.abs(POINTERSTATE.touch.x-At.clientX),Ut=Math.abs(POINTERSTATE.touch.y-At.clientY);kt.cancelable&&(Bt==="none"?Nt=!0:Bt==="pan-x"?Nt=Ut>jt:Bt==="pan-y"&&(Nt=jt>Ut)),Nt?kt.preventDefault():prevent("track")}}function addListener(kt,At,xt){return gestures[At]?(_add(kt,At,xt),!0):!1}function _add(kt,At,xt){const Bt=gestures[At],Nt=Bt.deps,jt=Bt.name;let Ut=kt[GESTURE_KEY];Ut||(kt[GESTURE_KEY]=Ut={});for(let Lt=0,Ht,Vt;Lt<Nt.length;Lt++)Ht=Nt[Lt],!(IS_TOUCH_ONLY&&isMouseEvent(Ht)&&Ht!=="click")&&(Vt=Ut[Ht],Vt||(Ut[Ht]=Vt={_count:0}),Vt._count===0&&kt.addEventListener(Ht,_handleNative,PASSIVE_TOUCH(Ht)),Vt[jt]=(Vt[jt]||0)+1,Vt._count=(Vt._count||0)+1);kt.addEventListener(At,xt),Bt.touchAction&&setTouchAction(kt,Bt.touchAction)}function register(kt){recognizers.push(kt),kt.emits.forEach(At=>{gestures[At]=kt})}function _findRecognizerByEvent(kt){for(let At=0,xt;At<recognizers.length;At++){xt=recognizers[At];for(let Bt=0,Nt;Bt<xt.emits.length;Bt++)if(Nt=xt.emits[Bt],Nt===kt)return xt}return null}function setTouchAction(kt,At){HAS_NATIVE_TA&&kt instanceof HTMLElement&&microTask.run(()=>{kt.style.touchAction=At}),kt[TOUCH_ACTION]=At}function _fire(kt,At,xt){const Bt=new Event(At,{bubbles:!0,cancelable:!0,composed:!0});if(Bt.detail=xt,wrap(kt).dispatchEvent(Bt),Bt.defaultPrevented){const Nt=xt.preventer||xt.sourceEvent;Nt&&Nt.preventDefault&&Nt.preventDefault()}}function prevent(kt){const At=_findRecognizerByEvent(kt);At.info&&(At.info.prevent=!0)}register({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset(){untrackDocument(this.info)},mousedown(kt){if(!hasLeftMouseButton(kt))return;const At=_findOriginalTarget(kt),xt=this,Bt=jt=>{hasLeftMouseButton(jt)||(downupFire("up",At,jt),untrackDocument(xt.info))},Nt=jt=>{hasLeftMouseButton(jt)&&downupFire("up",At,jt),untrackDocument(xt.info)};trackDocument(this.info,Bt,Nt),downupFire("down",At,kt)},touchstart(kt){downupFire("down",_findOriginalTarget(kt),kt.changedTouches[0],kt)},touchend(kt){downupFire("up",_findOriginalTarget(kt),kt.changedTouches[0],kt)}});function downupFire(kt,At,xt,Bt){At&&_fire(At,kt,{x:xt.clientX,y:xt.clientY,sourceEvent:xt,preventer:Bt,prevent(Nt){return prevent(Nt)}})}register({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove(kt){this.moves.length>TRACK_LENGTH&&this.moves.shift(),this.moves.push(kt)},movefn:null,upfn:null,prevent:!1},reset(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,untrackDocument(this.info)},mousedown(kt){if(!hasLeftMouseButton(kt))return;const At=_findOriginalTarget(kt),xt=this,Bt=jt=>{const Ut=jt.clientX,Lt=jt.clientY;trackHasMovedEnough(xt.info,Ut,Lt)&&(xt.info.state=xt.info.started?jt.type==="mouseup"?"end":"track":"start",xt.info.state==="start"&&prevent("tap"),xt.info.addMove({x:Ut,y:Lt}),hasLeftMouseButton(jt)||(xt.info.state="end",untrackDocument(xt.info)),At&&trackFire(xt.info,At,jt),xt.info.started=!0)},Nt=jt=>{xt.info.started&&Bt(jt),untrackDocument(xt.info)};trackDocument(this.info,Bt,Nt),this.info.x=kt.clientX,this.info.y=kt.clientY},touchstart(kt){const At=kt.changedTouches[0];this.info.x=At.clientX,this.info.y=At.clientY},touchmove(kt){const At=_findOriginalTarget(kt),xt=kt.changedTouches[0],Bt=xt.clientX,Nt=xt.clientY;trackHasMovedEnough(this.info,Bt,Nt)&&(this.info.state==="start"&&prevent("tap"),this.info.addMove({x:Bt,y:Nt}),trackFire(this.info,At,xt),this.info.state="track",this.info.started=!0)},touchend(kt){const At=_findOriginalTarget(kt),xt=kt.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:xt.clientX,y:xt.clientY}),trackFire(this.info,At,xt))}});function trackHasMovedEnough(kt,At,xt){if(kt.prevent)return!1;if(kt.started)return!0;const Bt=Math.abs(kt.x-At),Nt=Math.abs(kt.y-xt);return Bt>=TRACK_DISTANCE||Nt>=TRACK_DISTANCE}function trackFire(kt,At,xt){if(!At)return;const Bt=kt.moves[kt.moves.length-2],Nt=kt.moves[kt.moves.length-1],jt=Nt.x-kt.x,Ut=Nt.y-kt.y;let Lt,Ht=0;Bt&&(Lt=Nt.x-Bt.x,Ht=Nt.y-Bt.y),_fire(At,"track",{state:kt.state,x:xt.clientX,y:xt.clientY,dx:jt,dy:Ut,ddx:Lt,ddy:Ht,sourceEvent:xt,hover(){return deepTargetFind(xt.clientX,xt.clientY)}})}register({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown(kt){hasLeftMouseButton(kt)&&(this.info.x=kt.clientX,this.info.y=kt.clientY)},click(kt){hasLeftMouseButton(kt)&&trackForward(this.info,kt)},touchstart(kt){const At=kt.changedTouches[0];this.info.x=At.clientX,this.info.y=At.clientY},touchend(kt){trackForward(this.info,kt.changedTouches[0],kt)}});function trackForward(kt,At,xt){const Bt=Math.abs(At.clientX-kt.x),Nt=Math.abs(At.clientY-kt.y),jt=_findOriginalTarget(xt||At);!jt||canBeDisabled[jt.localName]&&jt.hasAttribute("disabled")||(isNaN(Bt)||isNaN(Nt)||Bt<=TAP_DISTANCE&&Nt<=TAP_DISTANCE||isSyntheticClick(At))&&(kt.prevent||_fire(jt,"tap",{x:At.clientX,y:At.clientY,sourceEvent:At,preventer:xt}))}/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const KeyboardMixin=dedupingMixin(kt=>class extends kt{ready(){super.ready(),this.addEventListener("keydown",xt=>{this._onKeyDown(xt)}),this.addEventListener("keyup",xt=>{this._onKeyUp(xt)})}_onKeyDown(xt){switch(xt.key){case"Enter":this._onEnter(xt);break;case"Escape":this._onEscape(xt);break}}_onKeyUp(xt){}_onEnter(xt){}_onEscape(xt){}});/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ActiveMixin=kt=>class extends DisabledMixin(KeyboardMixin(kt)){get _activeKeys(){return[" "]}ready(){super.ready(),addListener(this,"down",xt=>{this._shouldSetActive(xt)&&this._setActive(!0)}),addListener(this,"up",()=>{this._setActive(!1)})}disconnectedCallback(){super.disconnectedCallback(),this._setActive(!1)}_shouldSetActive(xt){return!this.disabled}_onKeyDown(xt){super._onKeyDown(xt),this._shouldSetActive(xt)&&this._activeKeys.includes(xt.key)&&(this._setActive(!0),document.addEventListener("keyup",Bt=>{this._activeKeys.includes(Bt.key)&&this._setActive(!1)},{once:!0}))}_setActive(xt){this.toggleAttribute("active",xt)}};/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const TabindexMixin=kt=>class extends DisabledMixin(kt){static get properties(){return{tabindex:{type:Number,reflectToAttribute:!0,observer:"_tabindexChanged"},_lastTabIndex:{type:Number}}}_disabledChanged(xt,Bt){super._disabledChanged(xt,Bt),xt?(this.tabindex!==void 0&&(this._lastTabIndex=this.tabindex),this.tabindex=-1):Bt&&(this.tabindex=this._lastTabIndex)}_tabindexChanged(xt){this.disabled&&xt!==-1&&(this._lastTabIndex=xt,this.tabindex=-1)}};/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ButtonMixin=kt=>class extends ActiveMixin(TabindexMixin(FocusMixin(kt))){static get properties(){return{tabindex:{type:Number,value:0,reflectToAttribute:!0}}}get _activeKeys(){return["Enter"," "]}ready(){super.ready(),this.hasAttribute("role")||this.setAttribute("role","button")}_onKeyDown(xt){super._onKeyDown(xt),!(xt.altKey||xt.shiftKey||xt.ctrlKey||xt.metaKey)&&this._activeKeys.includes(xt.key)&&(xt.preventDefault(),this.click())}};/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */registerStyles("vaadin-button",buttonStyles,{moduleId:"vaadin-button-styles"});class Button extends ButtonMixin(ElementMixin(ThemableMixin(ControllerMixin(PolymerElement)))){static get is(){return"vaadin-button"}static get template(){return buttonTemplate(html)}ready(){super.ready(),this._tooltipController=new TooltipController(this),this.addController(this._tooltipController)}}defineCustomElement(Button);registerStyles("vaadin-progress-bar",i$7`
    :host {
      height: calc(var(--lumo-size-l) / 10);
      margin: var(--lumo-space-s) 0;
    }

    [part='bar'] {
      border-radius: var(--lumo-border-radius-m);
      background-color: var(--lumo-contrast-10pct);
    }

    [part='value'] {
      border-radius: var(--lumo-border-radius-m);
      background-color: var(--lumo-primary-color);
      /* Use width instead of transform to preserve border radius */
      transform: none;
      width: calc(var(--vaadin-progress-value) * 100%);
      will-change: width;
      transition: 0.1s width linear;
    }

    /* Indeterminate mode */
    :host([indeterminate]) [part='value'] {
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to right,
        var(--lumo-primary-color-10pct) 10%,
        var(--lumo-primary-color)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to left,
        var(--lumo-primary-color-10pct) 10%,
        var(--lumo-primary-color)
      );
      width: 100%;
      background-color: transparent !important;
      background-image: var(--lumo-progress-indeterminate-progress-bar-background);
      opacity: 0.75;
      will-change: transform;
      animation: vaadin-progress-indeterminate 1.6s infinite cubic-bezier(0.645, 0.045, 0.355, 1);
    }

    @keyframes vaadin-progress-indeterminate {
      0% {
        transform: scaleX(0.015);
        transform-origin: 0% 0%;
      }

      25% {
        transform: scaleX(0.4);
      }

      50% {
        transform: scaleX(0.015);
        transform-origin: 100% 0%;
        background-image: var(--lumo-progress-indeterminate-progress-bar-background);
      }

      50.1% {
        transform: scaleX(0.015);
        transform-origin: 100% 0%;
        background-image: var(--lumo-progress-indeterminate-progress-bar-background-reverse);
      }

      75% {
        transform: scaleX(0.4);
      }

      100% {
        transform: scaleX(0.015);
        transform-origin: 0% 0%;
        background-image: var(--lumo-progress-indeterminate-progress-bar-background-reverse);
      }
    }

    :host(:not([aria-valuenow])) [part='value']::before,
    :host([indeterminate]) [part='value']::before {
      content: '';
      display: block;
      width: 100%;
      height: 100%;
      border-radius: inherit;
      background-color: var(--lumo-primary-color);
      will-change: opacity;
      animation: vaadin-progress-pulse3 1.6s infinite cubic-bezier(0.645, 0.045, 0.355, 1);
    }

    @keyframes vaadin-progress-pulse3 {
      0% {
        opacity: 1;
      }

      10% {
        opacity: 0;
      }

      40% {
        opacity: 0;
      }

      50% {
        opacity: 1;
      }

      50.1% {
        opacity: 1;
      }

      60% {
        opacity: 0;
      }

      90% {
        opacity: 0;
      }

      100% {
        opacity: 1;
      }
    }

    /* Contrast color */
    :host([theme~='contrast']) [part='value'],
    :host([theme~='contrast']) [part='value']::before {
      background-color: var(--lumo-contrast-80pct);
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to right,
        var(--lumo-contrast-5pct) 10%,
        var(--lumo-contrast-80pct)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to left,
        var(--lumo-contrast-5pct) 10%,
        var(--lumo-contrast-60pct)
      );
    }

    /* Error color */
    :host([theme~='error']) [part='value'],
    :host([theme~='error']) [part='value']::before {
      background-color: var(--lumo-error-color);
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to right,
        var(--lumo-error-color-10pct) 10%,
        var(--lumo-error-color)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to left,
        var(--lumo-error-color-10pct) 10%,
        var(--lumo-error-color)
      );
    }

    /* Primary color */
    :host([theme~='success']) [part='value'],
    :host([theme~='success']) [part='value']::before {
      background-color: var(--lumo-success-color);
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to right,
        var(--lumo-success-color-10pct) 10%,
        var(--lumo-success-color)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to left,
        var(--lumo-success-color-10pct) 10%,
        var(--lumo-success-color)
      );
    }

    /* RTL specific styles */
    :host([indeterminate][dir='rtl']) [part='value'] {
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to left,
        var(--lumo-primary-color-10pct) 10%,
        var(--lumo-primary-color)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to right,
        var(--lumo-primary-color-10pct) 10%,
        var(--lumo-primary-color)
      );
      animation: vaadin-progress-indeterminate-rtl 1.6s infinite cubic-bezier(0.355, 0.045, 0.645, 1);
    }

    :host(:not([aria-valuenow])[dir='rtl']) [part='value']::before,
    :host([indeterminate][dir='rtl']) [part='value']::before {
      animation: vaadin-progress-pulse3 1.6s infinite cubic-bezier(0.355, 0.045, 0.645, 1);
    }

    @keyframes vaadin-progress-indeterminate-rtl {
      0% {
        transform: scaleX(0.015);
        transform-origin: 100% 0%;
      }

      25% {
        transform: scaleX(0.4);
      }

      50% {
        transform: scaleX(0.015);
        transform-origin: 0% 0%;
        background-image: var(--lumo-progress-indeterminate-progress-bar-background);
      }

      50.1% {
        transform: scaleX(0.015);
        transform-origin: 0% 0%;
        background-image: var(--lumo-progress-indeterminate-progress-bar-background-reverse);
      }

      75% {
        transform: scaleX(0.4);
      }

      100% {
        transform: scaleX(0.015);
        transform-origin: 100% 0%;
        background-image: var(--lumo-progress-indeterminate-progress-bar-background-reverse);
      }
    }

    /* Contrast color */
    :host([theme~='contrast'][dir='rtl']) [part='value'],
    :host([theme~='contrast'][dir='rtl']) [part='value']::before {
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to left,
        var(--lumo-contrast-5pct) 10%,
        var(--lumo-contrast-80pct)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to right,
        var(--lumo-contrast-5pct) 10%,
        var(--lumo-contrast-60pct)
      );
    }

    /* Error color */
    :host([theme~='error'][dir='rtl']) [part='value'],
    :host([theme~='error'][dir='rtl']) [part='value']::before {
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to left,
        var(--lumo-error-color-10pct) 10%,
        var(--lumo-error-color)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to right,
        var(--lumo-error-color-10pct) 10%,
        var(--lumo-error-color)
      );
    }

    /* Primary color */
    :host([theme~='success'][dir='rtl']) [part='value'],
    :host([theme~='success'][dir='rtl']) [part='value']::before {
      --lumo-progress-indeterminate-progress-bar-background: linear-gradient(
        to left,
        var(--lumo-success-color-10pct) 10%,
        var(--lumo-success-color)
      );
      --lumo-progress-indeterminate-progress-bar-background-reverse: linear-gradient(
        to right,
        var(--lumo-success-color-10pct) 10%,
        var(--lumo-success-color)
      );
    }
  `,{moduleId:"lumo-progress-bar"});const template$1=document.createElement("template");template$1.innerHTML=`
  <style>
    @keyframes vaadin-progress-pulse3 {
      0% { opacity: 1; }
      10% { opacity: 0; }
      40% { opacity: 0; }
      50% { opacity: 1; }
      50.1% { opacity: 1; }
      60% { opacity: 0; }
      90% { opacity: 0; }
      100% { opacity: 1; }
    }
  </style>
`;document.head.appendChild(template$1.content);/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const progressBarStyles=i$7`
  :host {
    display: block;
    width: 100%; /* prevent collapsing inside non-stretching column flex */
    height: 8px;
  }

  :host([hidden]) {
    display: none !important;
  }

  [part='bar'] {
    height: 100%;
  }

  [part='value'] {
    height: 100%;
    transform-origin: 0 50%;
    transform: scaleX(var(--vaadin-progress-value));
  }

  :host([dir='rtl']) [part='value'] {
    transform-origin: 100% 50%;
  }

  @media (forced-colors: active) {
    [part='bar'] {
      outline: 1px solid;
    }

    [part='value'] {
      background-color: AccentColor !important;
      forced-color-adjust: none;
    }
  }
`;/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ProgressMixin=kt=>class extends kt{static get properties(){return{value:{type:Number,observer:"_valueChanged"},min:{type:Number,value:0,observer:"_minChanged"},max:{type:Number,value:1,observer:"_maxChanged"},indeterminate:{type:Boolean,value:!1,reflectToAttribute:!0}}}static get observers(){return["_normalizedValueChanged(value, min, max)"]}ready(){super.ready(),this.setAttribute("role","progressbar")}_normalizedValueChanged(xt,Bt,Nt){const jt=this._normalizeValue(xt,Bt,Nt);this.style.setProperty("--vaadin-progress-value",jt)}_valueChanged(xt){this.setAttribute("aria-valuenow",xt)}_minChanged(xt){this.setAttribute("aria-valuemin",xt)}_maxChanged(xt){this.setAttribute("aria-valuemax",xt)}_normalizeValue(xt,Bt,Nt){let jt;return!xt&&xt!==0?jt=0:Bt>=Nt?jt=1:(jt=(xt-Bt)/(Nt-Bt),jt=Math.min(Math.max(jt,0),1)),jt}};/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */registerStyles("vaadin-progress-bar",progressBarStyles,{moduleId:"vaadin-progress-bar-styles"});class ProgressBar extends ElementMixin(ThemableMixin(ProgressMixin(PolymerElement))){static get is(){return"vaadin-progress-bar"}static get template(){return html`
      <div part="bar">
        <div part="value"></div>
      </div>
    `}}defineCustomElement(ProgressBar);registerStyles("vaadin-upload",i$7`
    :host {
      line-height: var(--lumo-line-height-m);
    }

    :host(:not([nodrop])) {
      overflow: hidden;
      border: 1px dashed var(--lumo-contrast-20pct);
      border-radius: var(--lumo-border-radius-l);
      padding: var(--lumo-space-m);
      transition: background-color 0.6s, border-color 0.6s;
    }

    [part='drop-label'] {
      display: inline-block;
      white-space: normal;
      padding: 0 var(--lumo-space-s);
      color: var(--lumo-secondary-text-color);
      font-family: var(--lumo-font-family);
    }

    :host([dragover-valid]) {
      border-color: var(--lumo-primary-color-50pct);
      background: var(--lumo-primary-color-10pct);
      transition: background-color 0.1s, border-color 0.1s;
    }

    :host([dragover-valid]) [part='drop-label'] {
      color: var(--lumo-primary-text-color);
    }

    :host([max-files-reached]) [part='drop-label'] {
      color: var(--lumo-disabled-text-color);
    }
  `,{moduleId:"lumo-upload"});registerStyles("vaadin-upload-icon",i$7`
    :host::before {
      content: var(--lumo-icons-upload);
      font-family: lumo-icons;
      font-size: var(--lumo-icon-size-m);
      line-height: 1;
      vertical-align: -0.25em;
    }
  `,{moduleId:"lumo-upload-icon"});registerStyles("vaadin-upload-file-list",i$7`
    ::slotted(li:not(:first-of-type)) {
      border-top: 1px solid var(--lumo-contrast-10pct);
    }
  `,{moduleId:"lumo-upload-file-list"});const uploadFile=i$7`
  :host {
    padding: var(--lumo-space-s) 0;
    outline: none;
    --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
    --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
  }

  :host([focus-ring]) [part='row'] {
    border-radius: var(--lumo-border-radius-s);
    box-shadow: 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
  }

  [part='row'] {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
  }

  [part='status'],
  [part='error'] {
    color: var(--lumo-secondary-text-color);
    font-size: var(--lumo-font-size-s);
  }

  [part='info'] {
    display: flex;
    align-items: baseline;
    flex: auto;
  }

  [part='meta'] {
    width: 0.001px;
    flex: 1 1 auto;
  }

  [part='name'] {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  [part='commands'] {
    display: flex;
    align-items: baseline;
    flex: none;
  }

  [part$='icon'] {
    margin-right: var(--lumo-space-xs);
    font-size: var(--lumo-icon-size-m);
    font-family: 'lumo-icons';
    line-height: 1;
  }

  /* When both icons are hidden, let us keep space for one */
  [part='done-icon'][hidden] + [part='warning-icon'][hidden] {
    display: block !important;
    visibility: hidden;
  }

  [part$='button'] {
    flex: none;
    margin-left: var(--lumo-space-xs);
    cursor: var(--lumo-clickable-cursor);
  }

  [part$='button']:focus {
    outline: none;
    border-radius: var(--lumo-border-radius-s);
    box-shadow: 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
  }

  [part$='icon']::before,
  [part$='button']::before {
    vertical-align: -0.25em;
  }

  [part='done-icon']::before {
    content: var(--lumo-icons-checkmark);
    color: var(--lumo-primary-text-color);
  }

  [part='warning-icon']::before {
    content: var(--lumo-icons-error);
    color: var(--lumo-error-text-color);
  }

  [part='start-button']::before {
    content: var(--lumo-icons-play);
  }

  [part='retry-button']::before {
    content: var(--lumo-icons-reload);
  }

  [part='remove-button']::before {
    content: var(--lumo-icons-cross);
  }

  [part='error'] {
    color: var(--lumo-error-text-color);
  }

  ::slotted([slot='progress']) {
    width: auto;
    margin-left: calc(var(--lumo-icon-size-m) + var(--lumo-space-xs));
    margin-right: calc(var(--lumo-icon-size-m) + var(--lumo-space-xs));
  }
`;registerStyles("vaadin-upload-file",[fieldButton,uploadFile],{moduleId:"lumo-upload-file"});/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class UploadIcon extends ThemableMixin(PolymerElement){static get is(){return"vaadin-upload-icon"}static get template(){return html`
      <style>
        :host {
          display: inline-block;
        }

        :host([hidden]) {
          display: none !important;
        }
      </style>
    `}}defineCustomElement(UploadIcon);/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const template=document.createElement("template");template.innerHTML=`
  <style>
    @font-face {
      font-family: 'vaadin-upload-icons';
      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAasAAsAAAAABmAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgDxIF5mNtYXAAAAFoAAAAVAAAAFQXVtKMZ2FzcAAAAbwAAAAIAAAACAAAABBnbHlmAAABxAAAAfQAAAH0bBJxYWhlYWQAAAO4AAAANgAAADYPD267aGhlYQAAA/AAAAAkAAAAJAfCA8tobXR4AAAEFAAAACgAAAAoHgAAx2xvY2EAAAQ8AAAAFgAAABYCSgHsbWF4cAAABFQAAAAgAAAAIAAOADVuYW1lAAAEdAAAAhYAAAIWmmcHf3Bvc3QAAAaMAAAAIAAAACAAAwAAAAMDtwGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA6QUDwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADgAAAAKAAgAAgACAAEAIOkF//3//wAAAAAAIOkA//3//wAB/+MXBAADAAEAAAAAAAAAAAAAAAEAAf//AA8AAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAgAA/8AEAAPAABkAMgAAEz4DMzIeAhczLgMjIg4CBycRIScFIRcOAyMiLgInIx4DMzI+AjcXphZGWmo6SH9kQwyADFiGrmJIhXJbIEYBAFoDWv76YBZGXGw8Rn5lRQyADFmIrWBIhHReIkYCWjJVPSIyVnVDXqN5RiVEYTxG/wBa2loyVT0iMlZ1Q16jeUYnRWE5RgAAAAABAIAAAAOAA4AAAgAAExEBgAMAA4D8gAHAAAAAAwAAAAAEAAOAAAIADgASAAAJASElIiY1NDYzMhYVFAYnETMRAgD+AAQA/gAdIyMdHSMjXYADgPyAgCMdHSMjHR0jwAEA/wAAAQANADMD5gNaAAUAACUBNwUBFwHT/jptATMBppMzAU2a4AIgdAAAAAEAOv/6A8YDhgALAAABJwkBBwkBFwkBNwEDxoz+xv7GjAFA/sCMAToBOoz+wAL6jP7AAUCM/sb+xowBQP7AjAE6AAAAAwAA/8AEAAPAAAcACwASAAABFSE1IREhEQEjNTMJAjMRIRECwP6A/sAEAP0AgIACQP7A/sDAAQABQICA/oABgP8AgAHAAUD+wP6AAYAAAAABAAAAAQAAdhiEdV8PPPUACwQAAAAAANX4FR8AAAAA1fgVHwAA/8AEAAPAAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAQAAAEAAAAAAAAAAAAAAAAAAAAKBAAAAAAAAAAAAAAAAgAAAAQAAAAEAACABAAAAAQAAA0EAAA6BAAAAAAAAAAACgAUAB4AagB4AJwAsADSAPoAAAABAAAACgAzAAMAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAADgCuAAEAAAAAAAEAEwAAAAEAAAAAAAIABwDMAAEAAAAAAAMAEwBaAAEAAAAAAAQAEwDhAAEAAAAAAAUACwA5AAEAAAAAAAYAEwCTAAEAAAAAAAoAGgEaAAMAAQQJAAEAJgATAAMAAQQJAAIADgDTAAMAAQQJAAMAJgBtAAMAAQQJAAQAJgD0AAMAAQQJAAUAFgBEAAMAAQQJAAYAJgCmAAMAAQQJAAoANAE0dmFhZGluLXVwbG9hZC1pY29ucwB2AGEAYQBkAGkAbgAtAHUAcABsAG8AYQBkAC0AaQBjAG8AbgBzVmVyc2lvbiAxLjAAVgBlAHIAcwBpAG8AbgAgADEALgAwdmFhZGluLXVwbG9hZC1pY29ucwB2AGEAYQBkAGkAbgAtAHUAcABsAG8AYQBkAC0AaQBjAG8AbgBzdmFhZGluLXVwbG9hZC1pY29ucwB2AGEAYQBkAGkAbgAtAHUAcABsAG8AYQBkAC0AaQBjAG8AbgBzUmVndWxhcgBSAGUAZwB1AGwAYQBydmFhZGluLXVwbG9hZC1pY29ucwB2AGEAYQBkAGkAbgAtAHUAcABsAG8AYQBkAC0AaQBjAG8AbgBzRm9udCBnZW5lcmF0ZWQgYnkgSWNvTW9vbi4ARgBvAG4AdAAgAGcAZQBuAGUAcgBhAHQAZQBkACAAYgB5ACAASQBjAG8ATQBvAG8AbgAuAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==) format('woff');
      font-weight: normal;
      font-style: normal;
    }
  </style>
`;document.head.appendChild(template.content);/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const UploadFileMixin=kt=>class extends FocusMixin(kt){static get properties(){return{complete:{type:Boolean,value:!1,reflectToAttribute:!0},errorMessage:{type:String,value:"",observer:"_errorMessageChanged"},file:{type:Object},fileName:{type:String},held:{type:Boolean,value:!1},indeterminate:{type:Boolean,value:!1,reflectToAttribute:!0},i18n:{type:Object},progress:{type:Number},status:{type:String},tabindex:{type:Number,value:0,reflectToAttribute:!0},uploading:{type:Boolean,value:!1,reflectToAttribute:!0},_progress:{type:Object}}}static get observers(){return["__updateProgress(_progress, progress, indeterminate)"]}ready(){super.ready(),this.addController(new SlotController(this,"progress","vaadin-progress-bar",{initializer:xt=>{this._progress=xt}})),this.shadowRoot.addEventListener("focusin",xt=>{xt.composedPath()[0].getAttribute("part").endsWith("button")&&this._setFocused(!1)}),this.shadowRoot.addEventListener("focusout",xt=>{xt.relatedTarget===this&&this._setFocused(!0)})}_shouldSetFocus(xt){return xt.composedPath()[0]===this}_errorMessageChanged(xt){this.toggleAttribute("error",!!xt)}__updateProgress(xt,Bt,Nt){xt&&(xt.value=isNaN(Bt)?0:Bt/100,xt.indeterminate=Nt)}_fireFileEvent(xt){return xt.preventDefault(),this.dispatchEvent(new CustomEvent(xt.target.getAttribute("file-event"),{detail:{file:this.file},bubbles:!0,composed:!0}))}};/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const uploadFileStyles=i$7`
  :host {
    display: block;
  }

  [hidden] {
    display: none;
  }

  [part='row'] {
    list-style-type: none;
  }

  button {
    background: transparent;
    padding: 0;
    border: none;
    box-shadow: none;
  }

  :host([complete]) ::slotted([slot='progress']),
  :host([error]) ::slotted([slot='progress']) {
    display: none !important;
  }
`;/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */registerStyles("vaadin-upload-file",uploadFileStyles,{moduleId:"vaadin-upload-file-styles"});class UploadFile extends UploadFileMixin(ThemableMixin(ControllerMixin(PolymerElement))){static get template(){return html`
      <div part="row">
        <div part="info">
          <div part="done-icon" hidden$="[[!complete]]" aria-hidden="true"></div>
          <div part="warning-icon" hidden$="[[!errorMessage]]" aria-hidden="true"></div>

          <div part="meta">
            <div part="name" id="name">[[fileName]]</div>
            <div part="status" hidden$="[[!status]]" id="status">[[status]]</div>
            <div part="error" id="error" hidden$="[[!errorMessage]]">[[errorMessage]]</div>
          </div>
        </div>
        <div part="commands">
          <button
            type="button"
            part="start-button"
            file-event="file-start"
            on-click="_fireFileEvent"
            hidden$="[[!held]]"
            aria-label$="[[i18n.file.start]]"
            aria-describedby="name"
          ></button>
          <button
            type="button"
            part="retry-button"
            file-event="file-retry"
            on-click="_fireFileEvent"
            hidden$="[[!errorMessage]]"
            aria-label$="[[i18n.file.retry]]"
            aria-describedby="name"
          ></button>
          <button
            type="button"
            part="remove-button"
            file-event="file-abort"
            on-click="_fireFileEvent"
            aria-label$="[[i18n.file.remove]]"
            aria-describedby="name"
          ></button>
        </div>
      </div>

      <slot name="progress"></slot>
    `}static get is(){return"vaadin-upload-file"}}defineCustomElement(UploadFile);/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const UploadFileListMixin=kt=>class extends kt{static get properties(){return{items:{type:Array},i18n:{type:Object}}}static get observers(){return["__updateItems(items, i18n)"]}__updateItems(xt,Bt){xt&&Bt&&this.requestContentUpdate()}requestContentUpdate(){const{items:xt,i18n:Bt}=this;Q$1(ke$2`
          ${xt.map(Nt=>ke$2`
              <li>
                <vaadin-upload-file
                  .file="${Nt}"
                  .complete="${Nt.complete}"
                  .errorMessage="${Nt.error}"
                  .fileName="${Nt.name}"
                  .held="${Nt.held}"
                  .indeterminate="${Nt.indeterminate}"
                  .progress="${Nt.progress}"
                  .status="${Nt.status}"
                  .uploading="${Nt.uploading}"
                  .i18n="${Bt}"
                ></vaadin-upload-file>
              </li>
            `)}
        `,this)}};/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class UploadFileList extends UploadFileListMixin(ThemableMixin(PolymerElement)){static get is(){return"vaadin-upload-file-list"}static get template(){return html`
      <style>
        :host {
          display: block;
        }

        :host([hidden]) {
          display: none !important;
        }

        [part='list'] {
          padding: 0;
          margin: 0;
          list-style-type: none;
        }
      </style>
      <ul part="list">
        <slot></slot>
      </ul>
    `}}defineCustomElement(UploadFileList);/**
 * @license
 * Copyright (c) 2022 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const region=document.createElement("div");region.style.position="fixed";region.style.clip="rect(0px, 0px, 0px, 0px)";region.setAttribute("aria-live","polite");document.body.appendChild(region);let alertDebouncer;function announce(kt,At={}){const xt=At.mode||"polite",Bt=At.timeout===void 0?150:At.timeout;xt==="alert"?(region.removeAttribute("aria-live"),region.removeAttribute("role"),alertDebouncer=Debouncer.debounce(alertDebouncer,animationFrame,()=>{region.setAttribute("role","alert")})):(alertDebouncer&&alertDebouncer.cancel(),region.removeAttribute("role"),region.setAttribute("aria-live",xt)),region.textContent="",setTimeout(()=>{region.textContent=kt},Bt)}/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class AddButtonController extends SlotController{constructor(At){super(At,"add-button","vaadin-button")}initNode(At){At._isDefault&&(this.defaultNode=At),At.addEventListener("touchend",xt=>{this.host._onAddFilesTouchEnd(xt)}),At.addEventListener("click",xt=>{this.host._onAddFilesClick(xt)}),this.host._addButton=At}}class DropLabelController extends SlotController{constructor(At){super(At,"drop-label","span")}initNode(At){At._isDefault&&(this.defaultNode=At),this.host._dropLabel=At}}const UploadMixin=kt=>class extends kt{static get properties(){return{nodrop:{type:Boolean,reflectToAttribute:!0,value:isTouch},target:{type:String,value:""},method:{type:String,value:"POST"},headers:{type:Object,value:{}},timeout:{type:Number,value:0},_dragover:{type:Boolean,value:!1,observer:"_dragoverChanged"},files:{type:Array,notify:!0,value:()=>[],sync:!0},maxFiles:{type:Number,value:1/0,sync:!0},maxFilesReached:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},accept:{type:String,value:""},maxFileSize:{type:Number,value:1/0},_dragoverValid:{type:Boolean,value:!1,observer:"_dragoverValidChanged"},formDataName:{type:String,value:"file"},noAuto:{type:Boolean,value:!1},withCredentials:{type:Boolean,value:!1},capture:String,i18n:{type:Object,value(){return{dropFiles:{one:"Drop file here",many:"Drop files here"},addFiles:{one:"Upload File...",many:"Upload Files..."},error:{tooManyFiles:"Too Many Files.",fileIsTooBig:"File is Too Big.",incorrectFileType:"Incorrect File Type."},uploading:{status:{connecting:"Connecting...",stalled:"Stalled",processing:"Processing File...",held:"Queued"},remainingTime:{prefix:"remaining time: ",unknown:"unknown remaining time"},error:{serverUnavailable:"Upload failed, please try again later",unexpectedServerError:"Upload failed due to server error",forbidden:"Upload forbidden"}},file:{retry:"Retry",start:"Start",remove:"Remove"},units:{size:["B","kB","MB","GB","TB","PB","EB","ZB","YB"]}}}},_addButton:{type:Object},_dropLabel:{type:Object},_fileList:{type:Object},_files:{type:Array}}}static get observers(){return["__updateAddButton(_addButton, maxFiles, i18n, maxFilesReached)","__updateDropLabel(_dropLabel, maxFiles, i18n)","__updateFileList(_fileList, files, i18n)","__updateMaxFilesReached(maxFiles, files)"]}get __acceptRegexp(){if(!this.accept)return null;const xt=this.accept.split(",").map(Bt=>{let Nt=Bt.trim();return Nt=Nt.replace(/[+.]/gu,"\\$&"),Nt.startsWith("\\.")&&(Nt=`.*${Nt}$`),Nt.replace(/\/\*/gu,"/.*")});return new RegExp(`^(${xt.join("|")})$`,"iu")}ready(){super.ready(),this.addEventListener("dragover",this._onDragover.bind(this)),this.addEventListener("dragleave",this._onDragleave.bind(this)),this.addEventListener("drop",this._onDrop.bind(this)),this.addEventListener("file-retry",this._onFileRetry.bind(this)),this.addEventListener("file-abort",this._onFileAbort.bind(this)),this.addEventListener("file-start",this._onFileStart.bind(this)),this.addEventListener("file-reject",this._onFileReject.bind(this)),this.addEventListener("upload-start",this._onUploadStart.bind(this)),this.addEventListener("upload-success",this._onUploadSuccess.bind(this)),this.addEventListener("upload-error",this._onUploadError.bind(this)),this._addButtonController=new AddButtonController(this),this.addController(this._addButtonController),this._dropLabelController=new DropLabelController(this),this.addController(this._dropLabelController),this.addController(new SlotController(this,"file-list","vaadin-upload-file-list",{initializer:xt=>{this._fileList=xt}})),this.addController(new SlotController(this,"drop-label-icon","vaadin-upload-icon"))}_formatSize(xt){if(typeof this.i18n.formatSize=="function")return this.i18n.formatSize(xt);const Bt=this.i18n.units.sizeBase||1e3,Nt=~~(Math.log(xt)/Math.log(Bt)),jt=Math.max(0,Math.min(3,Nt-1));return`${parseFloat((xt/Bt**Nt).toFixed(jt))} ${this.i18n.units.size[Nt]}`}_splitTimeByUnits(xt){const Bt=[60,60,24,1/0],Nt=[0];for(let jt=0;jt<Bt.length&&xt>0;jt++)Nt[jt]=xt%Bt[jt],xt=Math.floor(xt/Bt[jt]);return Nt}_formatTime(xt,Bt){if(typeof this.i18n.formatTime=="function")return this.i18n.formatTime(xt,Bt);for(;Bt.length<3;)Bt.push(0);return Bt.reverse().map(Nt=>(Nt<10?"0":"")+Nt).join(":")}_formatFileProgress(xt){const Bt=xt.loaded>0?this.i18n.uploading.remainingTime.prefix+xt.remainingStr:this.i18n.uploading.remainingTime.unknown;return`${xt.totalStr}: ${xt.progress}% (${Bt})`}__updateMaxFilesReached(xt,Bt){this._setMaxFilesReached(xt>=0&&Bt.length>=xt)}__updateAddButton(xt,Bt,Nt,jt){xt&&(xt.disabled=jt,xt===this._addButtonController.defaultNode&&(xt.textContent=this._i18nPlural(Bt,Nt.addFiles)))}__updateDropLabel(xt,Bt,Nt){xt&&xt===this._dropLabelController.defaultNode&&(xt.textContent=this._i18nPlural(Bt,Nt.dropFiles))}__updateFileList(xt,Bt,Nt){xt&&(xt.items=[...Bt],xt.i18n=Nt)}_onDragover(xt){xt.preventDefault(),!this.nodrop&&!this._dragover&&(this._dragoverValid=!this.maxFilesReached,this._dragover=!0),xt.dataTransfer.dropEffect=!this._dragoverValid||this.nodrop?"none":"copy"}_onDragleave(xt){xt.preventDefault(),this._dragover&&!this.nodrop&&(this._dragover=this._dragoverValid=!1)}_onDrop(xt){this.nodrop||(xt.preventDefault(),this._dragover=this._dragoverValid=!1,this._addFiles(xt.dataTransfer.files))}_createXhr(){return new XMLHttpRequest}_configureXhr(xt){if(typeof this.headers=="string")try{this.headers=JSON.parse(this.headers)}catch{this.headers=void 0}Object.entries(this.headers).forEach(([Bt,Nt])=>{xt.setRequestHeader(Bt,Nt)}),this.timeout&&(xt.timeout=this.timeout),xt.withCredentials=this.withCredentials}_setStatus(xt,Bt,Nt,jt){xt.elapsed=jt,xt.elapsedStr=this._formatTime(xt.elapsed,this._splitTimeByUnits(xt.elapsed)),xt.remaining=Math.ceil(jt*(Bt/Nt-1)),xt.remainingStr=this._formatTime(xt.remaining,this._splitTimeByUnits(xt.remaining)),xt.speed=~~(Bt/jt/1024),xt.totalStr=this._formatSize(Bt),xt.loadedStr=this._formatSize(Nt),xt.status=this._formatFileProgress(xt)}uploadFiles(xt=this.files){xt&&!Array.isArray(xt)&&(xt=[xt]),xt=xt.filter(Bt=>!Bt.complete),Array.prototype.forEach.call(xt,this._uploadFile.bind(this))}_uploadFile(xt){if(xt.uploading)return;const Bt=Date.now(),Nt=xt.xhr=this._createXhr();let jt,Ut;Nt.upload.onprogress=zt=>{clearTimeout(jt),Ut=Date.now();const Wt=(Ut-Bt)/1e3,Jt=zt.loaded,Qt=zt.total,Xt=~~(Jt/Qt*100);xt.loaded=Jt,xt.progress=Xt,xt.indeterminate=Jt<=0||Jt>=Qt,xt.error?xt.indeterminate=xt.status=void 0:xt.abort||(Xt<100?(this._setStatus(xt,Qt,Jt,Wt),jt=setTimeout(()=>{xt.status=this.i18n.uploading.status.stalled,this._renderFileList()},2e3)):(xt.loadedStr=xt.totalStr,xt.status=this.i18n.uploading.status.processing)),this._renderFileList(),this.dispatchEvent(new CustomEvent("upload-progress",{detail:{file:xt,xhr:Nt}}))},Nt.onreadystatechange=()=>{if(Nt.readyState===4){if(clearTimeout(jt),xt.indeterminate=xt.uploading=!1,xt.abort||(xt.status="",!this.dispatchEvent(new CustomEvent("upload-response",{detail:{file:xt,xhr:Nt},cancelable:!0}))))return;Nt.status===0?xt.error=this.i18n.uploading.error.serverUnavailable:Nt.status>=500?xt.error=this.i18n.uploading.error.unexpectedServerError:Nt.status>=400&&(xt.error=this.i18n.uploading.error.forbidden),xt.complete=!xt.error,this.dispatchEvent(new CustomEvent(`upload-${xt.error?"error":"success"}`,{detail:{file:xt,xhr:Nt}})),this._renderFileList()}};const Lt=new FormData;if(xt.uploadTarget=xt.uploadTarget||this.target||"",xt.formDataName=this.formDataName,!this.dispatchEvent(new CustomEvent("upload-before",{detail:{file:xt,xhr:Nt},cancelable:!0})))return;Lt.append(xt.formDataName,xt,xt.name),Nt.open(this.method,xt.uploadTarget,!0),this._configureXhr(Nt),xt.status=this.i18n.uploading.status.connecting,xt.uploading=xt.indeterminate=!0,xt.complete=xt.abort=xt.error=xt.held=!1,Nt.upload.onloadstart=()=>{this.dispatchEvent(new CustomEvent("upload-start",{detail:{file:xt,xhr:Nt}})),this._renderFileList()},this.dispatchEvent(new CustomEvent("upload-request",{detail:{file:xt,xhr:Nt,formData:Lt},cancelable:!0}))&&Nt.send(Lt)}_retryFileUpload(xt){this.dispatchEvent(new CustomEvent("upload-retry",{detail:{file:xt,xhr:xt.xhr},cancelable:!0}))&&this._uploadFile(xt)}_abortFileUpload(xt){this.dispatchEvent(new CustomEvent("upload-abort",{detail:{file:xt,xhr:xt.xhr},cancelable:!0}))&&(xt.abort=!0,xt.xhr&&xt.xhr.abort(),this._removeFile(xt))}_renderFileList(){this._fileList&&this._fileList.requestContentUpdate()}_addFiles(xt){Array.prototype.forEach.call(xt,this._addFile.bind(this))}_addFile(xt){if(this.maxFilesReached){this.dispatchEvent(new CustomEvent("file-reject",{detail:{file:xt,error:this.i18n.error.tooManyFiles}}));return}if(this.maxFileSize>=0&&xt.size>this.maxFileSize){this.dispatchEvent(new CustomEvent("file-reject",{detail:{file:xt,error:this.i18n.error.fileIsTooBig}}));return}const Bt=this.__acceptRegexp;if(Bt&&!(Bt.test(xt.type)||Bt.test(xt.name))){this.dispatchEvent(new CustomEvent("file-reject",{detail:{file:xt,error:this.i18n.error.incorrectFileType}}));return}xt.loaded=0,xt.held=!0,xt.status=this.i18n.uploading.status.held,this.files=[xt,...this.files],this.noAuto||this._uploadFile(xt)}_removeFile(xt){this.files.indexOf(xt)>-1&&(this.files=this.files.filter(Bt=>Bt!==xt),this.dispatchEvent(new CustomEvent("file-remove",{detail:{file:xt},bubbles:!0,composed:!0})))}_onAddFilesTouchEnd(xt){xt.preventDefault(),this._onAddFilesClick(xt)}_onAddFilesClick(xt){this.maxFilesReached||(xt.stopPropagation(),this.$.fileInput.value="",this.$.fileInput.click())}_onFileInputChange(xt){this._addFiles(xt.target.files)}_onFileStart(xt){this._uploadFile(xt.detail.file)}_onFileRetry(xt){this._retryFileUpload(xt.detail.file)}_onFileAbort(xt){this._abortFileUpload(xt.detail.file)}_onFileReject(xt){announce(`${xt.detail.file.name}: ${xt.detail.error}`,{mode:"alert"})}_onUploadStart(xt){announce(`${xt.detail.file.name}: 0%`,{mode:"alert"})}_onUploadSuccess(xt){announce(`${xt.detail.file.name}: 100%`,{mode:"alert"})}_onUploadError(xt){announce(`${xt.detail.file.name}: ${xt.detail.file.error}`,{mode:"alert"})}_dragoverChanged(xt){xt?this.setAttribute("dragover",xt):this.removeAttribute("dragover")}_dragoverValidChanged(xt){xt?this.setAttribute("dragover-valid",xt):this.removeAttribute("dragover-valid")}_i18nPlural(xt,Bt){return xt===1?Bt.one:Bt.many}_isMultiple(xt){return xt!==1}};/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class Upload extends UploadMixin(ElementMixin(ThemableMixin(ControllerMixin(PolymerElement)))){static get template(){return html`
      <style>
        :host {
          display: block;
          position: relative;
          box-sizing: border-box;
        }

        :host([hidden]) {
          display: none !important;
        }

        [hidden] {
          display: none !important;
        }
      </style>

      <div part="primary-buttons">
        <slot name="add-button"></slot>
        <div part="drop-label" hidden$="[[nodrop]]" id="dropLabelContainer" aria-hidden="true">
          <slot name="drop-label-icon"></slot>
          <slot name="drop-label"></slot>
        </div>
      </div>
      <slot name="file-list"></slot>
      <slot></slot>
      <input
        type="file"
        id="fileInput"
        hidden
        on-change="_onFileInputChange"
        accept$="{{accept}}"
        multiple$="[[_isMultiple(maxFiles)]]"
        capture$="[[capture]]"
      />
    `}static get is(){return"vaadin-upload"}}defineCustomElement(Upload);const scriptRel="modulepreload",assetsURL=function(kt){return"/"+kt},seen={},__vitePreload=function(At,xt,Bt){let Nt=Promise.resolve();if(xt&&xt.length>0){document.getElementsByTagName("link");const jt=document.querySelector("meta[property=csp-nonce]"),Ut=(jt==null?void 0:jt.nonce)||(jt==null?void 0:jt.getAttribute("nonce"));Nt=Promise.all(xt.map(Lt=>{if(Lt=assetsURL(Lt),Lt in seen)return;seen[Lt]=!0;const Ht=Lt.endsWith(".css"),Vt=Ht?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Lt}"]${Vt}`))return;const zt=document.createElement("link");if(zt.rel=Ht?"stylesheet":scriptRel,Ht||(zt.as="script",zt.crossOrigin=""),zt.href=Lt,Ut&&zt.setAttribute("nonce",Ut),document.head.appendChild(zt),Ht)return new Promise((Wt,Jt)=>{zt.addEventListener("load",Wt),zt.addEventListener("error",()=>Jt(new Error(`Unable to preload CSS for ${Lt}`)))})}))}return Nt.then(()=>At()).catch(jt=>{const Ut=new Event("vite:preloadError",{cancelable:!0});if(Ut.payload=jt,window.dispatchEvent(Ut),!Ut.defaultPrevented)throw jt})};function registerSW(kt={}){const{immediate:At=!1,onNeedRefresh:xt,onOfflineReady:Bt,onRegistered:Nt,onRegisteredSW:jt,onRegisterError:Ut}=kt;let Lt,Ht;const Vt=async(Wt=!0)=>{await Ht};async function zt(){if("serviceWorker"in navigator){if(Lt=await __vitePreload(async()=>{const{Workbox:Wt}=await import("./workbox-window.prod.es5-D5gOYdM7.js");return{Workbox:Wt}},[]).then(({Workbox:Wt})=>new Wt("/sw.js",{scope:"/",type:"classic"})).catch(Wt=>{Ut==null||Ut(Wt)}),!Lt)return;Lt.addEventListener("activated",Wt=>{(Wt.isUpdate||Wt.isExternal)&&window.location.reload()}),Lt.addEventListener("installed",Wt=>{Wt.isUpdate||Bt==null||Bt()}),Lt.register({immediate:At}).then(Wt=>{jt?jt("/sw.js",Wt):Nt==null||Nt(Wt)}).catch(Wt=>{Ut==null||Ut(Wt)})}}return Ht=zt(),Vt}class PwaBadge extends h$2{static get properties(){return{_period:{type:Number,state:!1},_swActivated:{type:Boolean,state:!1},_offlineReady:{type:Boolean,state:!0},_needRefresh:{type:Boolean,state:!0},_updateServiceWorker:{type:Function,state:!1}}}constructor(){super(),this._offlineReady=!1,this._needRefresh=!1,this._swActivated=!1,this._period=60*60*1e3,this._updateServiceWorker=void 0}firstUpdated(){this._updateServiceWorker=registerSW({immediate:!0,onNeedRefresh:()=>this._needRefresh=!0,onRegisteredSW:this._onRegisteredSW})}render(){const At=[];this._offlineReady?At.push("show"):this._needRefresh&&At.push("show","refresh");const xt=this._offlineReady?"App ready to work offline":this._needRefresh?"New content available, click on reload button to update":"";return ke$2`
            <div
                id="pwa-toast"
                role="alert"
                aria-labelledby="toast-message"
                class=${At.join(" ")}
            >
                <div class="message">
                    <span id="toast-message">${xt}</span>
                </div>
                <div class="buttons">
                    <button id="pwa-refresh" type="button" @click=${this._refreshApp}>
                        Reload
                    </button>
                    <button id="pwa-close" type="button" @click=${this._closeBadge}>
                        Close
                    </button>
                </div>
            </div>
    `}_refreshApp(){this._updateServiceWorker&&this._needRefresh&&this._updateServiceWorker()}_closeBadge(){this._offlineReady=!1,this._needRefresh=!1}_onRegisteredSW(At,xt){var Bt;this._period<=0||(((Bt=xt==null?void 0:xt.active)==null?void 0:Bt.state)==="activated"?(this._swActivated=!0,this._registerPeriodicSync(At,xt)):xt!=null&&xt.installing&&xt.installing.addEventListener("statechange",Nt=>{const jt=Nt.target;this._swActivated=jt.state==="activated",this._swActivated&&this._registerPeriodicSync(At,xt)}))}_registerPeriodicSync(At,xt){this._period<=0||setInterval(async()=>{if("onLine"in navigator&&!navigator.onLine)return;const Bt=await fetch(At,{cache:"no-store",headers:{cache:"no-store","cache-control":"no-cache"}});(Bt==null?void 0:Bt.status)===200&&await xt.update()},this._period)}static styles=i$7`
    :host {
      max-width: 0;
      margin: 0;
      padding: 0;
    }

    #pwa-toast {
        visibility: hidden;
        position: fixed;
        right: 0;
        bottom: 0;
        margin: 16px;
        padding: 12px;
        border: 1px solid #8885;
        border-radius: 4px;
        z-index: 1;
        text-align: left;
        box-shadow: 3px 4px 5px 0 #8885;
        display: grid;
    }
    #pwa-toast .message {
        margin-bottom: 8px;
    }
    #pwa-toast .buttons {
        display: flex;
    }
    #pwa-toast button {
        border: 1px solid #8885;
        outline: none;
        margin-right: 5px;
        border-radius: 2px;
        padding: 3px 10px;
    }
    #pwa-toast.show {
        visibility: visible;
    }
    button#pwa-refresh {
        display: none;
    }
    #pwa-toast.show.refresh button#pwa-refresh {
        display: block;
    }
  `}window.customElements.define("pwa-badge",PwaBadge);var avatar_styles_default=i$7`
  :host {
    display: inline-block;

    --size: 3rem;
  }

  .avatar {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: var(--size);
    height: var(--size);
    background-color: var(--sl-color-neutral-400);
    font-family: var(--sl-font-sans);
    font-size: calc(var(--size) * 0.5);
    font-weight: var(--sl-font-weight-normal);
    color: var(--sl-color-neutral-0);
    user-select: none;
    -webkit-user-select: none;
    vertical-align: middle;
  }

  .avatar--circle,
  .avatar--circle .avatar__image {
    border-radius: var(--sl-border-radius-circle);
  }

  .avatar--rounded,
  .avatar--rounded .avatar__image {
    border-radius: var(--sl-border-radius-medium);
  }

  .avatar--square {
    border-radius: 0;
  }

  .avatar__icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .avatar__initials {
    line-height: 1;
    text-transform: uppercase;
  }

  .avatar__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    overflow: hidden;
  }
`,basePath="";function setBasePath(kt){basePath=kt}function getBasePath(kt=""){if(!basePath){const At=[...document.getElementsByTagName("script")],xt=At.find(Bt=>Bt.hasAttribute("data-shoelace"));if(xt)setBasePath(xt.getAttribute("data-shoelace"));else{const Bt=At.find(jt=>/shoelace(\.min)?\.js($|\?)/.test(jt.src)||/shoelace-autoloader(\.min)?\.js($|\?)/.test(jt.src));let Nt="";Bt&&(Nt=Bt.getAttribute("src")),setBasePath(Nt.split("/").slice(0,-1).join("/"))}}return basePath.replace(/\/$/,"")+(kt?`/${kt.replace(/^\//,"")}`:"")}var library={name:"default",resolver:kt=>getBasePath(`assets/icons/${kt}.svg`)},library_default_default=library,icons={caret:`
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
  `,check:`
    <svg part="checked-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor">
          <g transform="translate(3.428571, 3.428571)">
            <path d="M0,5.71428571 L3.42857143,9.14285714"></path>
            <path d="M9.14285714,0 L3.42857143,9.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"chevron-down":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,"chevron-left":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
    </svg>
  `,"chevron-right":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,copy:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2Zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H6ZM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1H2Z"/>
    </svg>
  `,eye:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
      <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
      <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
    </svg>
  `,"eye-slash":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash" viewBox="0 0 16 16">
      <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"/>
      <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"/>
      <path d="M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"/>
    </svg>
  `,eyedropper:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eyedropper" viewBox="0 0 16 16">
      <path d="M13.354.646a1.207 1.207 0 0 0-1.708 0L8.5 3.793l-.646-.647a.5.5 0 1 0-.708.708L8.293 5l-7.147 7.146A.5.5 0 0 0 1 12.5v1.793l-.854.853a.5.5 0 1 0 .708.707L1.707 15H3.5a.5.5 0 0 0 .354-.146L11 7.707l1.146 1.147a.5.5 0 0 0 .708-.708l-.647-.646 3.147-3.146a1.207 1.207 0 0 0 0-1.708l-2-2zM2 12.707l7-7L10.293 7l-7 7H2v-1.293z"></path>
    </svg>
  `,"grip-vertical":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grip-vertical" viewBox="0 0 16 16">
      <path d="M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path>
    </svg>
  `,indeterminate:`
    <svg part="indeterminate-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor" stroke-width="2">
          <g transform="translate(2.285714, 6.857143)">
            <path d="M10.2857143,1.14285714 L1.14285714,1.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"person-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
      <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
    </svg>
  `,"play-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">
      <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"></path>
    </svg>
  `,"pause-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">
      <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path>
    </svg>
  `,radio:`
    <svg part="checked-icon" class="radio__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g fill="currentColor">
          <circle cx="8" cy="8" r="3.42857143"></circle>
        </g>
      </g>
    </svg>
  `,"star-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
      <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
    </svg>
  `,"x-lg":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
      <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
    </svg>
  `,"x-circle-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"></path>
    </svg>
  `},systemLibrary={name:"system",resolver:kt=>kt in icons?`data:image/svg+xml,${encodeURIComponent(icons[kt])}`:""},library_system_default=systemLibrary,registry=[library_default_default,library_system_default],watchedIcons=[];function watchIcon(kt){watchedIcons.push(kt)}function unwatchIcon(kt){watchedIcons=watchedIcons.filter(At=>At!==kt)}function getIconLibrary(kt){return registry.find(At=>At.name===kt)}var icon_styles_default=i$7`
  :host {
    display: inline-block;
    width: 1em;
    height: 1em;
    box-sizing: content-box !important;
  }

  svg {
    display: block;
    height: 100%;
    width: 100%;
  }
`,__defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__knownSymbol=(kt,At)=>(At=Symbol[kt])?At:Symbol.for("Symbol."+kt),__defNormalProp=(kt,At,xt)=>At in kt?__defProp(kt,At,{enumerable:!0,configurable:!0,writable:!0,value:xt}):kt[At]=xt,__spreadValues=(kt,At)=>{for(var xt in At||(At={}))__hasOwnProp.call(At,xt)&&__defNormalProp(kt,xt,At[xt]);if(__getOwnPropSymbols)for(var xt of __getOwnPropSymbols(At))__propIsEnum.call(At,xt)&&__defNormalProp(kt,xt,At[xt]);return kt},__spreadProps=(kt,At)=>__defProps(kt,__getOwnPropDescs(At)),__decorateClass=(kt,At,xt,Bt)=>{for(var Nt=Bt>1?void 0:Bt?__getOwnPropDesc(At,xt):At,jt=kt.length-1,Ut;jt>=0;jt--)(Ut=kt[jt])&&(Nt=(Bt?Ut(At,xt,Nt):Ut(Nt))||Nt);return Bt&&Nt&&__defProp(At,xt,Nt),Nt},__await$7=function(kt,At){this[0]=kt,this[1]=At},__yieldStar=kt=>{var At=kt[__knownSymbol("asyncIterator")],xt=!1,Bt,Nt={};return At==null?(At=kt[__knownSymbol("iterator")](),Bt=jt=>Nt[jt]=Ut=>At[jt](Ut)):(At=At.call(kt),Bt=jt=>Nt[jt]=Ut=>{if(xt){if(xt=!1,jt==="throw")throw Ut;return Ut}return xt=!0,{done:!1,value:new __await$7(new Promise(Lt=>{var Ht=At[jt](Ut);if(!(Ht instanceof Object))throw TypeError("Object expected");Lt(Ht)}),1)}}),Nt[__knownSymbol("iterator")]=()=>Nt,Bt("next"),"throw"in At?Bt("throw"):Nt.throw=jt=>{throw jt},"return"in At&&Bt("return"),Nt};function watch(kt,At){const xt=__spreadValues({waitUntilFirstUpdate:!1},At);return(Bt,Nt)=>{const{update:jt}=Bt,Ut=Array.isArray(kt)?kt:[kt];Bt.update=function(Lt){Ut.forEach(Ht=>{const Vt=Ht;if(Lt.has(Vt)){const zt=Lt.get(Vt),Wt=this[Vt];zt!==Wt&&(!xt.waitUntilFirstUpdate||this.hasUpdated)&&this[Nt](zt,Wt)}}),jt.call(this,Lt)}}}var component_styles_default=i$7`
  :host {
    box-sizing: border-box;
  }

  :host *,
  :host *::before,
  :host *::after {
    box-sizing: inherit;
  }

  [hidden] {
    display: none !important;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o$4={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$5},r$4=(kt=o$4,At,xt)=>{const{kind:Bt,metadata:Nt}=xt;let jt=globalThis.litPropertyMetadata.get(Nt);if(jt===void 0&&globalThis.litPropertyMetadata.set(Nt,jt=new Map),jt.set(xt.name,kt),Bt==="accessor"){const{name:Ut}=xt;return{set(Lt){const Ht=At.get.call(this);At.set.call(this,Lt),this.requestUpdate(Ut,Ht,kt)},init(Lt){return Lt!==void 0&&this.P(Ut,void 0,kt),Lt}}}if(Bt==="setter"){const{name:Ut}=xt;return function(Lt){const Ht=this[Ut];At.call(this,Lt),this.requestUpdate(Ut,Ht,kt)}}throw Error("Unsupported decorator location: "+Bt)};function n$1(kt){return(At,xt)=>typeof xt=="object"?r$4(kt,At,xt):((Bt,Nt,jt)=>{const Ut=Nt.hasOwnProperty(jt);return Nt.constructor.createProperty(jt,Ut?{...Bt,wrapped:!0}:Bt),Ut?Object.getOwnPropertyDescriptor(Nt,jt):void 0})(kt,At,xt)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function r$3(kt){return n$1({...kt,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function t$4(kt){return(At,xt)=>{const Bt=typeof At=="function"?At:At[xt];Object.assign(Bt,kt)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const e$4=(kt,At,xt)=>(xt.configurable=!0,xt.enumerable=!0,Reflect.decorate&&typeof At!="object"&&Object.defineProperty(kt,At,xt),xt);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function e$3(kt,At){return(xt,Bt,Nt)=>{const jt=Ut=>{var Lt;return((Lt=Ut.renderRoot)==null?void 0:Lt.querySelector(kt))??null};return e$4(xt,Bt,{get(){return jt(this)}})}}var ShoelaceElement=class extends h$2{constructor(){super(),Object.entries(this.constructor.dependencies).forEach(([kt,At])=>{this.constructor.define(kt,At)})}emit(kt,At){const xt=new CustomEvent(kt,__spreadValues({bubbles:!0,cancelable:!1,composed:!0,detail:{}},At));return this.dispatchEvent(xt),xt}static define(kt,At=this,xt={}){const Bt=customElements.get(kt);if(!Bt){try{customElements.define(kt,At,xt)}catch{customElements.define(kt,class extends At{},xt)}return}let Nt=" (unknown version)",jt=Nt;"version"in At&&At.version&&(Nt=" v"+At.version),"version"in Bt&&Bt.version&&(jt=" v"+Bt.version),!(Nt&&jt&&Nt===jt)&&console.warn(`Attempted to register <${kt}>${Nt}, but <${kt}>${jt} has already been registered.`)}};ShoelaceElement.version="2.16.0";ShoelaceElement.dependencies={};__decorateClass([n$1()],ShoelaceElement.prototype,"dir",2);__decorateClass([n$1()],ShoelaceElement.prototype,"lang",2);/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const nt$1=(kt,At)=>(kt==null?void 0:kt._$litType$)!==void 0,rt$1=kt=>kt.strings===void 0,ht$1={},dt$1=(kt,At=ht$1)=>kt._$AH=At;var CACHEABLE_ERROR=Symbol(),RETRYABLE_ERROR=Symbol(),parser,iconCache=new Map,SlIcon=class extends ShoelaceElement{constructor(){super(...arguments),this.initialRender=!1,this.svg=null,this.label="",this.library="default"}async resolveIcon(kt,At){var xt;let Bt;if(At!=null&&At.spriteSheet){this.svg=ke$2`<svg part="svg">
        <use part="use" href="${kt}"></use>
      </svg>`,await this.updateComplete;const Nt=this.shadowRoot.querySelector("[part='svg']");return typeof At.mutator=="function"&&At.mutator(Nt),this.svg}try{if(Bt=await fetch(kt,{mode:"cors"}),!Bt.ok)return Bt.status===410?CACHEABLE_ERROR:RETRYABLE_ERROR}catch{return RETRYABLE_ERROR}try{const Nt=document.createElement("div");Nt.innerHTML=await Bt.text();const jt=Nt.firstElementChild;if(((xt=jt==null?void 0:jt.tagName)==null?void 0:xt.toLowerCase())!=="svg")return CACHEABLE_ERROR;parser||(parser=new DOMParser);const Lt=parser.parseFromString(jt.outerHTML,"text/html").body.querySelector("svg");return Lt?(Lt.part.add("svg"),document.adoptNode(Lt)):CACHEABLE_ERROR}catch{return CACHEABLE_ERROR}}connectedCallback(){super.connectedCallback(),watchIcon(this)}firstUpdated(){this.initialRender=!0,this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),unwatchIcon(this)}getIconSource(){const kt=getIconLibrary(this.library);return this.name&&kt?{url:kt.resolver(this.name),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){var kt;const{url:At,fromLibrary:xt}=this.getIconSource(),Bt=xt?getIconLibrary(this.library):void 0;if(!At){this.svg=null;return}let Nt=iconCache.get(At);if(Nt||(Nt=this.resolveIcon(At,Bt),iconCache.set(At,Nt)),!this.initialRender)return;const jt=await Nt;if(jt===RETRYABLE_ERROR&&iconCache.delete(At),At===this.getIconSource().url){if(nt$1(jt)){this.svg=jt;return}switch(jt){case RETRYABLE_ERROR:case CACHEABLE_ERROR:this.svg=null,this.emit("sl-error");break;default:this.svg=jt.cloneNode(!0),(kt=Bt==null?void 0:Bt.mutator)==null||kt.call(Bt,this.svg),this.emit("sl-load")}}}render(){return this.svg}};SlIcon.styles=[component_styles_default,icon_styles_default];__decorateClass([r$3()],SlIcon.prototype,"svg",2);__decorateClass([n$1({reflect:!0})],SlIcon.prototype,"name",2);__decorateClass([n$1()],SlIcon.prototype,"src",2);__decorateClass([n$1()],SlIcon.prototype,"label",2);__decorateClass([n$1({reflect:!0})],SlIcon.prototype,"library",2);__decorateClass([watch("label")],SlIcon.prototype,"handleLabelChange",1);__decorateClass([watch(["name","src","library"])],SlIcon.prototype,"setIcon",1);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$3={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e$2=kt=>(...At)=>({_$litDirective$:kt,values:At});let i$5=class{constructor(At){}get _$AU(){return this._$AM._$AU}_$AT(At,xt,Bt){this.t=At,this._$AM=xt,this.i=Bt}_$AS(At,xt){return this.update(At,xt)}update(At,xt){return this.render(...xt)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Rt$1=e$2(class extends i$5{constructor(kt){var At;if(super(kt),kt.type!==t$3.ATTRIBUTE||kt.name!=="class"||((At=kt.strings)==null?void 0:At.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(kt){return" "+Object.keys(kt).filter(At=>kt[At]).join(" ")+" "}update(kt,[At]){var Bt,Nt;if(this.st===void 0){this.st=new Set,kt.strings!==void 0&&(this.nt=new Set(kt.strings.join(" ").split(/\s/).filter(jt=>jt!=="")));for(const jt in At)At[jt]&&!((Bt=this.nt)!=null&&Bt.has(jt))&&this.st.add(jt);return this.render(At)}const xt=kt.element.classList;for(const jt of this.st)jt in At||(xt.remove(jt),this.st.delete(jt));for(const jt in At){const Ut=!!At[jt];Ut===this.st.has(jt)||(Nt=this.nt)!=null&&Nt.has(jt)||(Ut?(xt.add(jt),this.st.add(jt)):(xt.remove(jt),this.st.delete(jt)))}return R$2}});var SlAvatar=class extends ShoelaceElement{constructor(){super(...arguments),this.hasError=!1,this.image="",this.label="",this.initials="",this.loading="eager",this.shape="circle"}handleImageChange(){this.hasError=!1}handleImageLoadError(){this.hasError=!0,this.emit("sl-error")}render(){const kt=ke$2`
      <img
        part="image"
        class="avatar__image"
        src="${this.image}"
        loading="${this.loading}"
        alt=""
        @error="${this.handleImageLoadError}"
      />
    `;let At=ke$2``;return this.initials?At=ke$2`<div part="initials" class="avatar__initials">${this.initials}</div>`:At=ke$2`
        <div part="icon" class="avatar__icon" aria-hidden="true">
          <slot name="icon">
            <sl-icon name="person-fill" library="system"></sl-icon>
          </slot>
        </div>
      `,ke$2`
      <div
        part="base"
        class=${Rt$1({avatar:!0,"avatar--circle":this.shape==="circle","avatar--rounded":this.shape==="rounded","avatar--square":this.shape==="square"})}
        role="img"
        aria-label=${this.label}
      >
        ${this.image&&!this.hasError?kt:At}
      </div>
    `}};SlAvatar.styles=[component_styles_default,avatar_styles_default];SlAvatar.dependencies={"sl-icon":SlIcon};__decorateClass([r$3()],SlAvatar.prototype,"hasError",2);__decorateClass([n$1()],SlAvatar.prototype,"image",2);__decorateClass([n$1()],SlAvatar.prototype,"label",2);__decorateClass([n$1()],SlAvatar.prototype,"initials",2);__decorateClass([n$1()],SlAvatar.prototype,"loading",2);__decorateClass([n$1({reflect:!0})],SlAvatar.prototype,"shape",2);__decorateClass([watch("image")],SlAvatar.prototype,"handleImageChange",1);SlAvatar.define("sl-avatar");var spinner_styles_default=i$7`
  :host {
    --track-width: 2px;
    --track-color: rgb(128 128 128 / 25%);
    --indicator-color: var(--sl-color-primary-600);
    --speed: 2s;

    display: inline-flex;
    width: 1em;
    height: 1em;
    flex: none;
  }

  .spinner {
    flex: 1 1 auto;
    height: 100%;
    width: 100%;
  }

  .spinner__track,
  .spinner__indicator {
    fill: none;
    stroke-width: var(--track-width);
    r: calc(0.5em - var(--track-width) / 2);
    cx: 0.5em;
    cy: 0.5em;
    transform-origin: 50% 50%;
  }

  .spinner__track {
    stroke: var(--track-color);
    transform-origin: 0% 0%;
  }

  .spinner__indicator {
    stroke: var(--indicator-color);
    stroke-linecap: round;
    stroke-dasharray: 150% 75%;
    animation: spin var(--speed) linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
      stroke-dasharray: 0.05em, 3em;
    }

    50% {
      transform: rotate(450deg);
      stroke-dasharray: 1.375em, 1.375em;
    }

    100% {
      transform: rotate(1080deg);
      stroke-dasharray: 0.05em, 3em;
    }
  }
`;const connectedElements=new Set,translations=new Map;let fallback,documentDirection="ltr",documentLanguage="en";const isClient=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(isClient){const kt=new MutationObserver(update);documentDirection=document.documentElement.dir||"ltr",documentLanguage=document.documentElement.lang||navigator.language,kt.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function registerTranslation(...kt){kt.map(At=>{const xt=At.$code.toLowerCase();translations.has(xt)?translations.set(xt,Object.assign(Object.assign({},translations.get(xt)),At)):translations.set(xt,At),fallback||(fallback=At)}),update()}function update(){isClient&&(documentDirection=document.documentElement.dir||"ltr",documentLanguage=document.documentElement.lang||navigator.language),[...connectedElements.keys()].map(kt=>{typeof kt.requestUpdate=="function"&&kt.requestUpdate()})}let LocalizeController$1=class{constructor(At){this.host=At,this.host.addController(this)}hostConnected(){connectedElements.add(this.host)}hostDisconnected(){connectedElements.delete(this.host)}dir(){return`${this.host.dir||documentDirection}`.toLowerCase()}lang(){return`${this.host.lang||documentLanguage}`.toLowerCase()}getTranslationData(At){var xt,Bt;const Nt=new Intl.Locale(At.replace(/_/g,"-")),jt=Nt==null?void 0:Nt.language.toLowerCase(),Ut=(Bt=(xt=Nt==null?void 0:Nt.region)===null||xt===void 0?void 0:xt.toLowerCase())!==null&&Bt!==void 0?Bt:"",Lt=translations.get(`${jt}-${Ut}`),Ht=translations.get(jt);return{locale:Nt,language:jt,region:Ut,primary:Lt,secondary:Ht}}exists(At,xt){var Bt;const{primary:Nt,secondary:jt}=this.getTranslationData((Bt=xt.lang)!==null&&Bt!==void 0?Bt:this.lang());return xt=Object.assign({includeFallback:!1},xt),!!(Nt&&Nt[At]||jt&&jt[At]||xt.includeFallback&&fallback&&fallback[At])}term(At,...xt){const{primary:Bt,secondary:Nt}=this.getTranslationData(this.lang());let jt;if(Bt&&Bt[At])jt=Bt[At];else if(Nt&&Nt[At])jt=Nt[At];else if(fallback&&fallback[At])jt=fallback[At];else return console.error(`No translation found for: ${String(At)}`),String(At);return typeof jt=="function"?jt(...xt):jt}date(At,xt){return At=new Date(At),new Intl.DateTimeFormat(this.lang(),xt).format(At)}number(At,xt){return At=Number(At),isNaN(At)?"":new Intl.NumberFormat(this.lang(),xt).format(At)}relativeTime(At,xt,Bt){return new Intl.RelativeTimeFormat(this.lang(),Bt).format(At,xt)}};var translation={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",error:"Error",goToSlide:(kt,At)=>`Go to slide ${kt} of ${At}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:kt=>kt===0?"No options selected":kt===1?"1 option selected":`${kt} options selected`,previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:kt=>`Slide ${kt}`,toggleColorFormat:"Toggle color format"};registerTranslation(translation);var en_default=translation,LocalizeController=class extends LocalizeController$1{};registerTranslation(en_default);var SlSpinner=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this)}render(){return ke$2`
      <svg part="base" class="spinner" role="progressbar" aria-label=${this.localize.term("loading")}>
        <circle class="spinner__track"></circle>
        <circle class="spinner__indicator"></circle>
      </svg>
    `}};SlSpinner.styles=[component_styles_default,spinner_styles_default];var formCollections=new WeakMap,reportValidityOverloads=new WeakMap,checkValidityOverloads=new WeakMap,userInteractedControls=new WeakSet,interactions=new WeakMap,FormControlController=class{constructor(kt,At){this.handleFormData=xt=>{const Bt=this.options.disabled(this.host),Nt=this.options.name(this.host),jt=this.options.value(this.host),Ut=this.host.tagName.toLowerCase()==="sl-button";this.host.isConnected&&!Bt&&!Ut&&typeof Nt=="string"&&Nt.length>0&&typeof jt<"u"&&(Array.isArray(jt)?jt.forEach(Lt=>{xt.formData.append(Nt,Lt.toString())}):xt.formData.append(Nt,jt.toString()))},this.handleFormSubmit=xt=>{var Bt;const Nt=this.options.disabled(this.host),jt=this.options.reportValidity;this.form&&!this.form.noValidate&&((Bt=formCollections.get(this.form))==null||Bt.forEach(Ut=>{this.setUserInteracted(Ut,!0)})),this.form&&!this.form.noValidate&&!Nt&&!jt(this.host)&&(xt.preventDefault(),xt.stopImmediatePropagation())},this.handleFormReset=()=>{this.options.setValue(this.host,this.options.defaultValue(this.host)),this.setUserInteracted(this.host,!1),interactions.set(this.host,[])},this.handleInteraction=xt=>{const Bt=interactions.get(this.host);Bt.includes(xt.type)||Bt.push(xt.type),Bt.length===this.options.assumeInteractionOn.length&&this.setUserInteracted(this.host,!0)},this.checkFormValidity=()=>{if(this.form&&!this.form.noValidate){const xt=this.form.querySelectorAll("*");for(const Bt of xt)if(typeof Bt.checkValidity=="function"&&!Bt.checkValidity())return!1}return!0},this.reportFormValidity=()=>{if(this.form&&!this.form.noValidate){const xt=this.form.querySelectorAll("*");for(const Bt of xt)if(typeof Bt.reportValidity=="function"&&!Bt.reportValidity())return!1}return!0},(this.host=kt).addController(this),this.options=__spreadValues({form:xt=>{const Bt=xt.form;if(Bt){const jt=xt.getRootNode().querySelector(`#${Bt}`);if(jt)return jt}return xt.closest("form")},name:xt=>xt.name,value:xt=>xt.value,defaultValue:xt=>xt.defaultValue,disabled:xt=>{var Bt;return(Bt=xt.disabled)!=null?Bt:!1},reportValidity:xt=>typeof xt.reportValidity=="function"?xt.reportValidity():!0,checkValidity:xt=>typeof xt.checkValidity=="function"?xt.checkValidity():!0,setValue:(xt,Bt)=>xt.value=Bt,assumeInteractionOn:["sl-input"]},At)}hostConnected(){const kt=this.options.form(this.host);kt&&this.attachForm(kt),interactions.set(this.host,[]),this.options.assumeInteractionOn.forEach(At=>{this.host.addEventListener(At,this.handleInteraction)})}hostDisconnected(){this.detachForm(),interactions.delete(this.host),this.options.assumeInteractionOn.forEach(kt=>{this.host.removeEventListener(kt,this.handleInteraction)})}hostUpdated(){const kt=this.options.form(this.host);kt||this.detachForm(),kt&&this.form!==kt&&(this.detachForm(),this.attachForm(kt)),this.host.hasUpdated&&this.setValidity(this.host.validity.valid)}attachForm(kt){kt?(this.form=kt,formCollections.has(this.form)?formCollections.get(this.form).add(this.host):formCollections.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),reportValidityOverloads.has(this.form)||(reportValidityOverloads.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity()),checkValidityOverloads.has(this.form)||(checkValidityOverloads.set(this.form,this.form.checkValidity),this.form.checkValidity=()=>this.checkFormValidity())):this.form=void 0}detachForm(){if(!this.form)return;const kt=formCollections.get(this.form);kt&&(kt.delete(this.host),kt.size<=0&&(this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),reportValidityOverloads.has(this.form)&&(this.form.reportValidity=reportValidityOverloads.get(this.form),reportValidityOverloads.delete(this.form)),checkValidityOverloads.has(this.form)&&(this.form.checkValidity=checkValidityOverloads.get(this.form),checkValidityOverloads.delete(this.form)),this.form=void 0))}setUserInteracted(kt,At){At?userInteractedControls.add(kt):userInteractedControls.delete(kt),kt.requestUpdate()}doAction(kt,At){if(this.form){const xt=document.createElement("button");xt.type=kt,xt.style.position="absolute",xt.style.width="0",xt.style.height="0",xt.style.clipPath="inset(50%)",xt.style.overflow="hidden",xt.style.whiteSpace="nowrap",At&&(xt.name=At.name,xt.value=At.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(Bt=>{At.hasAttribute(Bt)&&xt.setAttribute(Bt,At.getAttribute(Bt))})),this.form.append(xt),xt.click(),xt.remove()}}getForm(){var kt;return(kt=this.form)!=null?kt:null}reset(kt){this.doAction("reset",kt)}submit(kt){this.doAction("submit",kt)}setValidity(kt){const At=this.host,xt=!!userInteractedControls.has(At),Bt=!!At.required;At.toggleAttribute("data-required",Bt),At.toggleAttribute("data-optional",!Bt),At.toggleAttribute("data-invalid",!kt),At.toggleAttribute("data-valid",kt),At.toggleAttribute("data-user-invalid",!kt&&xt),At.toggleAttribute("data-user-valid",kt&&xt)}updateValidity(){const kt=this.host;this.setValidity(kt.validity.valid)}emitInvalidEvent(kt){const At=new CustomEvent("sl-invalid",{bubbles:!1,composed:!1,cancelable:!0,detail:{}});kt||At.preventDefault(),this.host.dispatchEvent(At)||kt==null||kt.preventDefault()}},validValidityState=Object.freeze({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1}),valueMissingValidityState=Object.freeze(__spreadProps(__spreadValues({},validValidityState),{valid:!1,valueMissing:!0})),customErrorValidityState=Object.freeze(__spreadProps(__spreadValues({},validValidityState),{valid:!1,customError:!0})),button_styles_default=i$7`
  :host {
    display: inline-block;
    position: relative;
    width: auto;
    cursor: pointer;
  }

  .button {
    display: inline-flex;
    align-items: stretch;
    justify-content: center;
    width: 100%;
    border-style: solid;
    border-width: var(--sl-input-border-width);
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-font-weight-semibold);
    text-decoration: none;
    user-select: none;
    -webkit-user-select: none;
    white-space: nowrap;
    vertical-align: middle;
    padding: 0;
    transition:
      var(--sl-transition-x-fast) background-color,
      var(--sl-transition-x-fast) color,
      var(--sl-transition-x-fast) border,
      var(--sl-transition-x-fast) box-shadow;
    cursor: inherit;
  }

  .button::-moz-focus-inner {
    border: 0;
  }

  .button:focus {
    outline: none;
  }

  .button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* When disabled, prevent mouse events from bubbling up from children */
  .button--disabled * {
    pointer-events: none;
  }

  .button__prefix,
  .button__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    pointer-events: none;
  }

  .button__label {
    display: inline-block;
  }

  .button__label::slotted(sl-icon) {
    vertical-align: -2px;
  }

  /*
   * Standard buttons
   */

  /* Default */
  .button--standard.button--default {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-input-border-color);
    color: var(--sl-color-neutral-700);
  }

  .button--standard.button--default:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-300);
    color: var(--sl-color-primary-700);
  }

  .button--standard.button--default:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-100);
    border-color: var(--sl-color-primary-400);
    color: var(--sl-color-primary-700);
  }

  /* Primary */
  .button--standard.button--primary {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--standard.button--success {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:hover:not(.button--disabled) {
    background-color: var(--sl-color-success-500);
    border-color: var(--sl-color-success-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:active:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--standard.button--neutral {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:hover:not(.button--disabled) {
    background-color: var(--sl-color-neutral-500);
    border-color: var(--sl-color-neutral-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:active:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--standard.button--warning {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }
  .button--standard.button--warning:hover:not(.button--disabled) {
    background-color: var(--sl-color-warning-500);
    border-color: var(--sl-color-warning-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--warning:active:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--standard.button--danger {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:hover:not(.button--disabled) {
    background-color: var(--sl-color-danger-500);
    border-color: var(--sl-color-danger-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:active:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /*
   * Outline buttons
   */

  .button--outline {
    background: none;
    border: solid 1px;
  }

  /* Default */
  .button--outline.button--default {
    border-color: var(--sl-input-border-color);
    color: var(--sl-color-neutral-700);
  }

  .button--outline.button--default:hover:not(.button--disabled),
  .button--outline.button--default.button--checked:not(.button--disabled) {
    border-color: var(--sl-color-primary-600);
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--default:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Primary */
  .button--outline.button--primary {
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-primary-600);
  }

  .button--outline.button--primary:hover:not(.button--disabled),
  .button--outline.button--primary.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--primary:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--outline.button--success {
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-success-600);
  }

  .button--outline.button--success:hover:not(.button--disabled),
  .button--outline.button--success.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--success:active:not(.button--disabled) {
    border-color: var(--sl-color-success-700);
    background-color: var(--sl-color-success-700);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--outline.button--neutral {
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-600);
  }

  .button--outline.button--neutral:hover:not(.button--disabled),
  .button--outline.button--neutral.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--neutral:active:not(.button--disabled) {
    border-color: var(--sl-color-neutral-700);
    background-color: var(--sl-color-neutral-700);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--outline.button--warning {
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-warning-600);
  }

  .button--outline.button--warning:hover:not(.button--disabled),
  .button--outline.button--warning.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--warning:active:not(.button--disabled) {
    border-color: var(--sl-color-warning-700);
    background-color: var(--sl-color-warning-700);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--outline.button--danger {
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-danger-600);
  }

  .button--outline.button--danger:hover:not(.button--disabled),
  .button--outline.button--danger.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--danger:active:not(.button--disabled) {
    border-color: var(--sl-color-danger-700);
    background-color: var(--sl-color-danger-700);
    color: var(--sl-color-neutral-0);
  }

  @media (forced-colors: active) {
    .button.button--outline.button--checked:not(.button--disabled) {
      outline: solid 2px transparent;
    }
  }

  /*
   * Text buttons
   */

  .button--text {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-600);
  }

  .button--text:hover:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:focus-visible:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:active:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-700);
  }

  /*
   * Size modifiers
   */

  .button--small {
    height: auto;
    min-height: var(--sl-input-height-small);
    font-size: var(--sl-button-font-size-small);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
  }

  .button--medium {
    height: auto;
    min-height: var(--sl-input-height-medium);
    font-size: var(--sl-button-font-size-medium);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
  }

  .button--large {
    height: auto;
    min-height: var(--sl-input-height-large);
    font-size: var(--sl-button-font-size-large);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
  }

  /*
   * Pill modifier
   */

  .button--pill.button--small {
    border-radius: var(--sl-input-height-small);
  }

  .button--pill.button--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .button--pill.button--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Circle modifier
   */

  .button--circle {
    padding-left: 0;
    padding-right: 0;
  }

  .button--circle.button--small {
    width: var(--sl-input-height-small);
    border-radius: 50%;
  }

  .button--circle.button--medium {
    width: var(--sl-input-height-medium);
    border-radius: 50%;
  }

  .button--circle.button--large {
    width: var(--sl-input-height-large);
    border-radius: 50%;
  }

  .button--circle .button__prefix,
  .button--circle .button__suffix,
  .button--circle .button__caret {
    display: none;
  }

  /*
   * Caret modifier
   */

  .button--caret .button__suffix {
    display: none;
  }

  .button--caret .button__caret {
    height: auto;
  }

  /*
   * Loading modifier
   */

  .button--loading {
    position: relative;
    cursor: wait;
  }

  .button--loading .button__prefix,
  .button--loading .button__label,
  .button--loading .button__suffix,
  .button--loading .button__caret {
    visibility: hidden;
  }

  .button--loading sl-spinner {
    --indicator-color: currentColor;
    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }

  /*
   * Badges
   */

  .button ::slotted(sl-badge) {
    position: absolute;
    top: 0;
    right: 0;
    translate: 50% -50%;
    pointer-events: none;
  }

  .button--rtl ::slotted(sl-badge) {
    right: auto;
    left: 0;
    translate: -50% -50%;
  }

  /*
   * Button spacing
   */

  .button--has-label.button--small .button__label {
    padding: 0 var(--sl-spacing-small);
  }

  .button--has-label.button--medium .button__label {
    padding: 0 var(--sl-spacing-medium);
  }

  .button--has-label.button--large .button__label {
    padding: 0 var(--sl-spacing-large);
  }

  .button--has-prefix.button--small {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--small .button__label {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--medium {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--medium .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-suffix.button--small,
  .button--caret.button--small {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--small .button__label,
  .button--caret.button--small .button__label {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--medium,
  .button--caret.button--medium {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--medium .button__label,
  .button--caret.button--medium .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large,
  .button--caret.button--large {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large .button__label,
  .button--caret.button--large .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  /*
   * Button groups support a variety of button types (e.g. buttons with tooltips, buttons as dropdown triggers, etc.).
   * This means buttons aren't always direct descendants of the button group, thus we can't target them with the
   * ::slotted selector. To work around this, the button group component does some magic to add these special classes to
   * buttons and we style them here instead.
   */

  :host([data-sl-button-group__button--first]:not([data-sl-button-group__button--last])) .button {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
  }

  :host([data-sl-button-group__button--inner]) .button {
    border-radius: 0;
  }

  :host([data-sl-button-group__button--last]:not([data-sl-button-group__button--first])) .button {
    border-start-start-radius: 0;
    border-end-start-radius: 0;
  }

  /* All except the first */
  :host([data-sl-button-group__button]:not([data-sl-button-group__button--first])) {
    margin-inline-start: calc(-1 * var(--sl-input-border-width));
  }

  /* Add a visual separator between solid buttons */
  :host(
      [data-sl-button-group__button]:not(
          [data-sl-button-group__button--first],
          [data-sl-button-group__button--radio],
          [variant='default']
        ):not(:hover)
    )
    .button:after {
    content: '';
    position: absolute;
    top: 0;
    inset-inline-start: 0;
    bottom: 0;
    border-left: solid 1px rgb(128 128 128 / 33%);
    mix-blend-mode: multiply;
  }

  /* Bump hovered, focused, and checked buttons up so their focus ring isn't clipped */
  :host([data-sl-button-group__button--hover]) {
    z-index: 1;
  }

  /* Focus and checked are always on top */
  :host([data-sl-button-group__button--focus]),
  :host([data-sl-button-group__button][checked]) {
    z-index: 2;
  }
`,HasSlotController=class{constructor(kt,...At){this.slotNames=[],this.handleSlotChange=xt=>{const Bt=xt.target;(this.slotNames.includes("[default]")&&!Bt.name||Bt.name&&this.slotNames.includes(Bt.name))&&this.host.requestUpdate()},(this.host=kt).addController(this),this.slotNames=At}hasDefaultSlot(){return[...this.host.childNodes].some(kt=>{if(kt.nodeType===kt.TEXT_NODE&&kt.textContent.trim()!=="")return!0;if(kt.nodeType===kt.ELEMENT_NODE){const At=kt;if(At.tagName.toLowerCase()==="sl-visually-hidden")return!1;if(!At.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(kt){return this.host.querySelector(`:scope > [slot="${kt}"]`)!==null}test(kt){return kt==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(kt)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};function getTextContent(kt){if(!kt)return"";const At=kt.assignedNodes({flatten:!0});let xt="";return[...At].forEach(Bt=>{Bt.nodeType===Node.TEXT_NODE&&(xt+=Bt.textContent)}),xt}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const $e$1=Symbol.for(""),xe$1=kt=>{if((kt==null?void 0:kt.r)===$e$1)return kt==null?void 0:kt._$litStatic$},er=(kt,...At)=>({_$litStatic$:At.reduce((xt,Bt,Nt)=>xt+(jt=>{if(jt._$litStatic$!==void 0)return jt._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${jt}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(Bt)+kt[Nt+1],kt[0]),r:$e$1}),Te$1=new Map,Ee$1=kt=>(At,...xt)=>{const Bt=xt.length;let Nt,jt;const Ut=[],Lt=[];let Ht,Vt=0,zt=!1;for(;Vt<Bt;){for(Ht=At[Vt];Vt<Bt&&(jt=xt[Vt],(Nt=xe$1(jt))!==void 0);)Ht+=Nt+At[++Vt],zt=!0;Vt!==Bt&&Lt.push(jt),Ut.push(Ht),Vt++}if(Vt===Bt&&Ut.push(At[Bt]),zt){const Wt=Ut.join("$$lit$$");(At=Te$1.get(Wt))===void 0&&(Ut.raw=Ut,Te$1.set(Wt,At=Ut)),xt=Lt}return kt(At,...xt)},ke$1=Ee$1(ke$2);var SlButton=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this,{assumeInteractionOn:["click"]}),this.hasSlotController=new HasSlotController(this,"[default]","prefix","suffix"),this.localize=new LocalizeController(this),this.hasFocus=!1,this.invalid=!1,this.title="",this.variant="default",this.size="medium",this.caret=!1,this.disabled=!1,this.loading=!1,this.outline=!1,this.pill=!1,this.circle=!1,this.type="button",this.name="",this.value="",this.href="",this.rel="noreferrer noopener"}get validity(){return this.isButton()?this.button.validity:validValidityState}get validationMessage(){return this.isButton()?this.button.validationMessage:""}firstUpdated(){this.isButton()&&this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(){this.type==="submit"&&this.formControlController.submit(this),this.type==="reset"&&this.formControlController.reset(this)}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.isButton()&&this.formControlController.setValidity(this.disabled)}click(){this.button.click()}focus(kt){this.button.focus(kt)}blur(){this.button.blur()}checkValidity(){return this.isButton()?this.button.checkValidity():!0}getForm(){return this.formControlController.getForm()}reportValidity(){return this.isButton()?this.button.reportValidity():!0}setCustomValidity(kt){this.isButton()&&(this.button.setCustomValidity(kt),this.formControlController.updateValidity())}render(){const kt=this.isLink(),At=kt?er`a`:er`button`;return ke$1`
      <${At}
        part="base"
        class=${Rt$1({button:!0,"button--default":this.variant==="default","button--primary":this.variant==="primary","button--success":this.variant==="success","button--neutral":this.variant==="neutral","button--warning":this.variant==="warning","button--danger":this.variant==="danger","button--text":this.variant==="text","button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--caret":this.caret,"button--circle":this.circle,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--loading":this.loading,"button--standard":!this.outline,"button--outline":this.outline,"button--pill":this.pill,"button--rtl":this.localize.dir()==="rtl","button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
        ?disabled=${to(kt?void 0:this.disabled)}
        type=${to(kt?void 0:this.type)}
        title=${this.title}
        name=${to(kt?void 0:this.name)}
        value=${to(kt?void 0:this.value)}
        href=${to(kt?this.href:void 0)}
        target=${to(kt?this.target:void 0)}
        download=${to(kt?this.download:void 0)}
        rel=${to(kt?this.rel:void 0)}
        role=${to(kt?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="prefix" part="prefix" class="button__prefix"></slot>
        <slot part="label" class="button__label"></slot>
        <slot name="suffix" part="suffix" class="button__suffix"></slot>
        ${this.caret?ke$1` <sl-icon part="caret" class="button__caret" library="system" name="caret"></sl-icon> `:""}
        ${this.loading?ke$1`<sl-spinner part="spinner"></sl-spinner>`:""}
      </${At}>
    `}};SlButton.styles=[component_styles_default,button_styles_default];SlButton.dependencies={"sl-icon":SlIcon,"sl-spinner":SlSpinner};__decorateClass([e$3(".button")],SlButton.prototype,"button",2);__decorateClass([r$3()],SlButton.prototype,"hasFocus",2);__decorateClass([r$3()],SlButton.prototype,"invalid",2);__decorateClass([n$1()],SlButton.prototype,"title",2);__decorateClass([n$1({reflect:!0})],SlButton.prototype,"variant",2);__decorateClass([n$1({reflect:!0})],SlButton.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlButton.prototype,"caret",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlButton.prototype,"disabled",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlButton.prototype,"loading",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlButton.prototype,"outline",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlButton.prototype,"pill",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlButton.prototype,"circle",2);__decorateClass([n$1()],SlButton.prototype,"type",2);__decorateClass([n$1()],SlButton.prototype,"name",2);__decorateClass([n$1()],SlButton.prototype,"value",2);__decorateClass([n$1()],SlButton.prototype,"href",2);__decorateClass([n$1()],SlButton.prototype,"target",2);__decorateClass([n$1()],SlButton.prototype,"rel",2);__decorateClass([n$1()],SlButton.prototype,"download",2);__decorateClass([n$1()],SlButton.prototype,"form",2);__decorateClass([n$1({attribute:"formaction"})],SlButton.prototype,"formAction",2);__decorateClass([n$1({attribute:"formenctype"})],SlButton.prototype,"formEnctype",2);__decorateClass([n$1({attribute:"formmethod"})],SlButton.prototype,"formMethod",2);__decorateClass([n$1({attribute:"formnovalidate",type:Boolean})],SlButton.prototype,"formNoValidate",2);__decorateClass([n$1({attribute:"formtarget"})],SlButton.prototype,"formTarget",2);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlButton.prototype,"handleDisabledChange",1);SlButton.define("sl-button");var button_group_styles_default=i$7`
  :host {
    display: inline-block;
  }

  .button-group {
    display: flex;
    flex-wrap: nowrap;
  }
`,SlButtonGroup=class extends ShoelaceElement{constructor(){super(...arguments),this.disableRole=!1,this.label=""}handleFocus(kt){const At=findButton(kt.target);At==null||At.toggleAttribute("data-sl-button-group__button--focus",!0)}handleBlur(kt){const At=findButton(kt.target);At==null||At.toggleAttribute("data-sl-button-group__button--focus",!1)}handleMouseOver(kt){const At=findButton(kt.target);At==null||At.toggleAttribute("data-sl-button-group__button--hover",!0)}handleMouseOut(kt){const At=findButton(kt.target);At==null||At.toggleAttribute("data-sl-button-group__button--hover",!1)}handleSlotChange(){const kt=[...this.defaultSlot.assignedElements({flatten:!0})];kt.forEach(At=>{const xt=kt.indexOf(At),Bt=findButton(At);Bt&&(Bt.toggleAttribute("data-sl-button-group__button",!0),Bt.toggleAttribute("data-sl-button-group__button--first",xt===0),Bt.toggleAttribute("data-sl-button-group__button--inner",xt>0&&xt<kt.length-1),Bt.toggleAttribute("data-sl-button-group__button--last",xt===kt.length-1),Bt.toggleAttribute("data-sl-button-group__button--radio",Bt.tagName.toLowerCase()==="sl-radio-button"))})}render(){return ke$2`
      <div
        part="base"
        class="button-group"
        role="${this.disableRole?"presentation":"group"}"
        aria-label=${this.label}
        @focusout=${this.handleBlur}
        @focusin=${this.handleFocus}
        @mouseover=${this.handleMouseOver}
        @mouseout=${this.handleMouseOut}
      >
        <slot @slotchange=${this.handleSlotChange}></slot>
      </div>
    `}};SlButtonGroup.styles=[component_styles_default,button_group_styles_default];__decorateClass([e$3("slot")],SlButtonGroup.prototype,"defaultSlot",2);__decorateClass([r$3()],SlButtonGroup.prototype,"disableRole",2);__decorateClass([n$1()],SlButtonGroup.prototype,"label",2);function findButton(kt){var At;const xt="sl-button, sl-radio-button";return(At=kt.closest(xt))!=null?At:kt.querySelector(xt)}SlButtonGroup.define("sl-button-group");var badge_styles_default=i$7`
  :host {
    display: inline-flex;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: max(12px, 0.75em);
    font-weight: var(--sl-font-weight-semibold);
    letter-spacing: var(--sl-letter-spacing-normal);
    line-height: 1;
    border-radius: var(--sl-border-radius-small);
    border: solid 1px var(--sl-color-neutral-0);
    white-space: nowrap;
    padding: 0.35em 0.6em;
    user-select: none;
    -webkit-user-select: none;
    cursor: inherit;
  }

  /* Variant modifiers */
  .badge--primary {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--success {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--neutral {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--warning {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .badge--danger {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /* Pill modifier */
  .badge--pill {
    border-radius: var(--sl-border-radius-pill);
  }

  /* Pulse modifier */
  .badge--pulse {
    animation: pulse 1.5s infinite;
  }

  .badge--pulse.badge--primary {
    --pulse-color: var(--sl-color-primary-600);
  }

  .badge--pulse.badge--success {
    --pulse-color: var(--sl-color-success-600);
  }

  .badge--pulse.badge--neutral {
    --pulse-color: var(--sl-color-neutral-600);
  }

  .badge--pulse.badge--warning {
    --pulse-color: var(--sl-color-warning-600);
  }

  .badge--pulse.badge--danger {
    --pulse-color: var(--sl-color-danger-600);
  }

  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 var(--pulse-color);
    }
    70% {
      box-shadow: 0 0 0 0.5rem transparent;
    }
    100% {
      box-shadow: 0 0 0 0 transparent;
    }
  }
`,SlBadge=class extends ShoelaceElement{constructor(){super(...arguments),this.variant="primary",this.pill=!1,this.pulse=!1}render(){return ke$2`
      <span
        part="base"
        class=${Rt$1({badge:!0,"badge--primary":this.variant==="primary","badge--success":this.variant==="success","badge--neutral":this.variant==="neutral","badge--warning":this.variant==="warning","badge--danger":this.variant==="danger","badge--pill":this.pill,"badge--pulse":this.pulse})}
        role="status"
      >
        <slot></slot>
      </span>
    `}};SlBadge.styles=[component_styles_default,badge_styles_default];__decorateClass([n$1({reflect:!0})],SlBadge.prototype,"variant",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlBadge.prototype,"pill",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlBadge.prototype,"pulse",2);SlBadge.define("sl-badge");var card_styles_default=i$7`
  :host {
    --border-color: var(--sl-color-neutral-200);
    --border-radius: var(--sl-border-radius-medium);
    --border-width: 1px;
    --padding: var(--sl-spacing-large);

    display: inline-block;
  }

  .card {
    display: flex;
    flex-direction: column;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-small);
    border: solid var(--border-width) var(--border-color);
    border-radius: var(--border-radius);
  }

  .card__image {
    display: flex;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    margin: calc(-1 * var(--border-width));
    overflow: hidden;
  }

  .card__image::slotted(img) {
    display: block;
    width: 100%;
  }

  .card:not(.card--has-image) .card__image {
    display: none;
  }

  .card__header {
    display: block;
    border-bottom: solid var(--border-width) var(--border-color);
    padding: calc(var(--padding) / 2) var(--padding);
  }

  .card:not(.card--has-header) .card__header {
    display: none;
  }

  .card:not(.card--has-image) .card__header {
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
  }

  .card__body {
    display: block;
    padding: var(--padding);
  }

  .card--has-footer .card__footer {
    display: block;
    border-top: solid var(--border-width) var(--border-color);
    padding: var(--padding);
  }

  .card:not(.card--has-footer) .card__footer {
    display: none;
  }
`,SlCard=class extends ShoelaceElement{constructor(){super(...arguments),this.hasSlotController=new HasSlotController(this,"footer","header","image")}render(){return ke$2`
      <div
        part="base"
        class=${Rt$1({card:!0,"card--has-footer":this.hasSlotController.test("footer"),"card--has-image":this.hasSlotController.test("image"),"card--has-header":this.hasSlotController.test("header")})}
      >
        <slot name="image" part="image" class="card__image"></slot>
        <slot name="header" part="header" class="card__header"></slot>
        <slot part="body" class="card__body"></slot>
        <slot name="footer" part="footer" class="card__footer"></slot>
      </div>
    `}};SlCard.styles=[component_styles_default,card_styles_default];SlCard.define("sl-card");var tooltip_styles_default=i$7`
  :host {
    --max-width: 20rem;
    --hide-delay: 0ms;
    --show-delay: 150ms;

    display: contents;
  }

  .tooltip {
    --arrow-size: var(--sl-tooltip-arrow-size);
    --arrow-color: var(--sl-tooltip-background-color);
  }

  .tooltip::part(popup) {
    z-index: var(--sl-z-index-tooltip);
  }

  .tooltip[placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .tooltip[placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  .tooltip[placement^='left']::part(popup) {
    transform-origin: right;
  }

  .tooltip[placement^='right']::part(popup) {
    transform-origin: left;
  }

  .tooltip__body {
    display: block;
    width: max-content;
    max-width: var(--max-width);
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    text-align: start;
    white-space: normal;
    color: var(--sl-tooltip-color);
    padding: var(--sl-tooltip-padding);
    pointer-events: none;
    user-select: none;
    -webkit-user-select: none;
  }
`,popup_styles_default=i$7`
  :host {
    --arrow-color: var(--sl-color-neutral-1000);
    --arrow-size: 6px;

    /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
    --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
    --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

    display: contents;
  }

  .popup {
    position: absolute;
    isolation: isolate;
    max-width: var(--auto-size-available-width, none);
    max-height: var(--auto-size-available-height, none);
  }

  .popup--fixed {
    position: fixed;
  }

  .popup:not(.popup--active) {
    display: none;
  }

  .popup__arrow {
    position: absolute;
    width: calc(var(--arrow-size-diagonal) * 2);
    height: calc(var(--arrow-size-diagonal) * 2);
    rotate: 45deg;
    background: var(--arrow-color);
    z-index: -1;
  }

  /* Hover bridge */
  .popup-hover-bridge:not(.popup-hover-bridge--visible) {
    display: none;
  }

  .popup-hover-bridge {
    position: fixed;
    z-index: calc(var(--sl-z-index-dropdown) - 1);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    clip-path: polygon(
      var(--hover-bridge-top-left-x, 0) var(--hover-bridge-top-left-y, 0),
      var(--hover-bridge-top-right-x, 0) var(--hover-bridge-top-right-y, 0),
      var(--hover-bridge-bottom-right-x, 0) var(--hover-bridge-bottom-right-y, 0),
      var(--hover-bridge-bottom-left-x, 0) var(--hover-bridge-bottom-left-y, 0)
    );
  }
`;const min=Math.min,max$1=Math.max,round=Math.round,floor=Math.floor,createCoords=kt=>({x:kt,y:kt}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$1(kt,At,xt){return max$1(kt,min(At,xt))}function evaluate(kt,At){return typeof kt=="function"?kt(At):kt}function getSide(kt){return kt.split("-")[0]}function getAlignment(kt){return kt.split("-")[1]}function getOppositeAxis(kt){return kt==="x"?"y":"x"}function getAxisLength(kt){return kt==="y"?"height":"width"}function getSideAxis(kt){return["top","bottom"].includes(getSide(kt))?"y":"x"}function getAlignmentAxis(kt){return getOppositeAxis(getSideAxis(kt))}function getAlignmentSides(kt,At,xt){xt===void 0&&(xt=!1);const Bt=getAlignment(kt),Nt=getAlignmentAxis(kt),jt=getAxisLength(Nt);let Ut=Nt==="x"?Bt===(xt?"end":"start")?"right":"left":Bt==="start"?"bottom":"top";return At.reference[jt]>At.floating[jt]&&(Ut=getOppositePlacement(Ut)),[Ut,getOppositePlacement(Ut)]}function getExpandedPlacements(kt){const At=getOppositePlacement(kt);return[getOppositeAlignmentPlacement(kt),At,getOppositeAlignmentPlacement(At)]}function getOppositeAlignmentPlacement(kt){return kt.replace(/start|end/g,At=>oppositeAlignmentMap[At])}function getSideList(kt,At,xt){const Bt=["left","right"],Nt=["right","left"],jt=["top","bottom"],Ut=["bottom","top"];switch(kt){case"top":case"bottom":return xt?At?Nt:Bt:At?Bt:Nt;case"left":case"right":return At?jt:Ut;default:return[]}}function getOppositeAxisPlacements(kt,At,xt,Bt){const Nt=getAlignment(kt);let jt=getSideList(getSide(kt),xt==="start",Bt);return Nt&&(jt=jt.map(Ut=>Ut+"-"+Nt),At&&(jt=jt.concat(jt.map(getOppositeAlignmentPlacement)))),jt}function getOppositePlacement(kt){return kt.replace(/left|right|bottom|top/g,At=>oppositeSideMap[At])}function expandPaddingObject(kt){return{top:0,right:0,bottom:0,left:0,...kt}}function getPaddingObject(kt){return typeof kt!="number"?expandPaddingObject(kt):{top:kt,right:kt,bottom:kt,left:kt}}function rectToClientRect(kt){const{x:At,y:xt,width:Bt,height:Nt}=kt;return{width:Bt,height:Nt,top:xt,left:At,right:At+Bt,bottom:xt+Nt,x:At,y:xt}}function computeCoordsFromPlacement(kt,At,xt){let{reference:Bt,floating:Nt}=kt;const jt=getSideAxis(At),Ut=getAlignmentAxis(At),Lt=getAxisLength(Ut),Ht=getSide(At),Vt=jt==="y",zt=Bt.x+Bt.width/2-Nt.width/2,Wt=Bt.y+Bt.height/2-Nt.height/2,Jt=Bt[Lt]/2-Nt[Lt]/2;let Qt;switch(Ht){case"top":Qt={x:zt,y:Bt.y-Nt.height};break;case"bottom":Qt={x:zt,y:Bt.y+Bt.height};break;case"right":Qt={x:Bt.x+Bt.width,y:Wt};break;case"left":Qt={x:Bt.x-Nt.width,y:Wt};break;default:Qt={x:Bt.x,y:Bt.y}}switch(getAlignment(At)){case"start":Qt[Ut]-=Jt*(xt&&Vt?-1:1);break;case"end":Qt[Ut]+=Jt*(xt&&Vt?-1:1);break}return Qt}const computePosition$1=async(kt,At,xt)=>{const{placement:Bt="bottom",strategy:Nt="absolute",middleware:jt=[],platform:Ut}=xt,Lt=jt.filter(Boolean),Ht=await(Ut.isRTL==null?void 0:Ut.isRTL(At));let Vt=await Ut.getElementRects({reference:kt,floating:At,strategy:Nt}),{x:zt,y:Wt}=computeCoordsFromPlacement(Vt,Bt,Ht),Jt=Bt,Qt={},Xt=0;for(let tr=0;tr<Lt.length;tr++){const{name:rr,fn:nr}=Lt[tr],{x:ar,y:ir,data:lr,reset:yr}=await nr({x:zt,y:Wt,initialPlacement:Bt,placement:Jt,strategy:Nt,middlewareData:Qt,rects:Vt,platform:Ut,elements:{reference:kt,floating:At}});zt=ar??zt,Wt=ir??Wt,Qt={...Qt,[rr]:{...Qt[rr],...lr}},yr&&Xt<=50&&(Xt++,typeof yr=="object"&&(yr.placement&&(Jt=yr.placement),yr.rects&&(Vt=yr.rects===!0?await Ut.getElementRects({reference:kt,floating:At,strategy:Nt}):yr.rects),{x:zt,y:Wt}=computeCoordsFromPlacement(Vt,Jt,Ht)),tr=-1)}return{x:zt,y:Wt,placement:Jt,strategy:Nt,middlewareData:Qt}};async function detectOverflow(kt,At){var xt;At===void 0&&(At={});const{x:Bt,y:Nt,platform:jt,rects:Ut,elements:Lt,strategy:Ht}=kt,{boundary:Vt="clippingAncestors",rootBoundary:zt="viewport",elementContext:Wt="floating",altBoundary:Jt=!1,padding:Qt=0}=evaluate(At,kt),Xt=getPaddingObject(Qt),rr=Lt[Jt?Wt==="floating"?"reference":"floating":Wt],nr=rectToClientRect(await jt.getClippingRect({element:(xt=await(jt.isElement==null?void 0:jt.isElement(rr)))==null||xt?rr:rr.contextElement||await(jt.getDocumentElement==null?void 0:jt.getDocumentElement(Lt.floating)),boundary:Vt,rootBoundary:zt,strategy:Ht})),ar=Wt==="floating"?{x:Bt,y:Nt,width:Ut.floating.width,height:Ut.floating.height}:Ut.reference,ir=await(jt.getOffsetParent==null?void 0:jt.getOffsetParent(Lt.floating)),lr=await(jt.isElement==null?void 0:jt.isElement(ir))?await(jt.getScale==null?void 0:jt.getScale(ir))||{x:1,y:1}:{x:1,y:1},yr=rectToClientRect(jt.convertOffsetParentRelativeRectToViewportRelativeRect?await jt.convertOffsetParentRelativeRectToViewportRelativeRect({elements:Lt,rect:ar,offsetParent:ir,strategy:Ht}):ar);return{top:(nr.top-yr.top+Xt.top)/lr.y,bottom:(yr.bottom-nr.bottom+Xt.bottom)/lr.y,left:(nr.left-yr.left+Xt.left)/lr.x,right:(yr.right-nr.right+Xt.right)/lr.x}}const arrow$1=kt=>({name:"arrow",options:kt,async fn(At){const{x:xt,y:Bt,placement:Nt,rects:jt,platform:Ut,elements:Lt,middlewareData:Ht}=At,{element:Vt,padding:zt=0}=evaluate(kt,At)||{};if(Vt==null)return{};const Wt=getPaddingObject(zt),Jt={x:xt,y:Bt},Qt=getAlignmentAxis(Nt),Xt=getAxisLength(Qt),tr=await Ut.getDimensions(Vt),rr=Qt==="y",nr=rr?"top":"left",ar=rr?"bottom":"right",ir=rr?"clientHeight":"clientWidth",lr=jt.reference[Xt]+jt.reference[Qt]-Jt[Qt]-jt.floating[Xt],yr=Jt[Qt]-jt.reference[Qt],Sr=await(Ut.getOffsetParent==null?void 0:Ut.getOffsetParent(Vt));let Ar=Sr?Sr[ir]:0;(!Ar||!await(Ut.isElement==null?void 0:Ut.isElement(Sr)))&&(Ar=Lt.floating[ir]||jt.floating[Xt]);const Dr=lr/2-yr/2,Br=Ar/2-tr[Xt]/2-1,Lr=min(Wt[nr],Br),Or=min(Wt[ar],Br),vr=Lr,pr=Ar-tr[Xt]-Or,dr=Ar/2-tr[Xt]/2+Dr,ur=clamp$1(vr,dr,pr),$r=!Ht.arrow&&getAlignment(Nt)!=null&&dr!==ur&&jt.reference[Xt]/2-(dr<vr?Lr:Or)-tr[Xt]/2<0,wr=$r?dr<vr?dr-vr:dr-pr:0;return{[Qt]:Jt[Qt]+wr,data:{[Qt]:ur,centerOffset:dr-ur-wr,...$r&&{alignmentOffset:wr}},reset:$r}}}),flip$1=function(kt){return kt===void 0&&(kt={}),{name:"flip",options:kt,async fn(At){var xt,Bt;const{placement:Nt,middlewareData:jt,rects:Ut,initialPlacement:Lt,platform:Ht,elements:Vt}=At,{mainAxis:zt=!0,crossAxis:Wt=!0,fallbackPlacements:Jt,fallbackStrategy:Qt="bestFit",fallbackAxisSideDirection:Xt="none",flipAlignment:tr=!0,...rr}=evaluate(kt,At);if((xt=jt.arrow)!=null&&xt.alignmentOffset)return{};const nr=getSide(Nt),ar=getSideAxis(Lt),ir=getSide(Lt)===Lt,lr=await(Ht.isRTL==null?void 0:Ht.isRTL(Vt.floating)),yr=Jt||(ir||!tr?[getOppositePlacement(Lt)]:getExpandedPlacements(Lt)),Sr=Xt!=="none";!Jt&&Sr&&yr.push(...getOppositeAxisPlacements(Lt,tr,Xt,lr));const Ar=[Lt,...yr],Dr=await detectOverflow(At,rr),Br=[];let Lr=((Bt=jt.flip)==null?void 0:Bt.overflows)||[];if(zt&&Br.push(Dr[nr]),Wt){const dr=getAlignmentSides(Nt,Ut,lr);Br.push(Dr[dr[0]],Dr[dr[1]])}if(Lr=[...Lr,{placement:Nt,overflows:Br}],!Br.every(dr=>dr<=0)){var Or,vr;const dr=(((Or=jt.flip)==null?void 0:Or.index)||0)+1,ur=Ar[dr];if(ur)return{data:{index:dr,overflows:Lr},reset:{placement:ur}};let $r=(vr=Lr.filter(wr=>wr.overflows[0]<=0).sort((wr,Er)=>wr.overflows[1]-Er.overflows[1])[0])==null?void 0:vr.placement;if(!$r)switch(Qt){case"bestFit":{var pr;const wr=(pr=Lr.filter(Er=>{if(Sr){const gr=getSideAxis(Er.placement);return gr===ar||gr==="y"}return!0}).map(Er=>[Er.placement,Er.overflows.filter(gr=>gr>0).reduce((gr,fr)=>gr+fr,0)]).sort((Er,gr)=>Er[1]-gr[1])[0])==null?void 0:pr[0];wr&&($r=wr);break}case"initialPlacement":$r=Lt;break}if(Nt!==$r)return{reset:{placement:$r}}}return{}}}};async function convertValueToCoords(kt,At){const{placement:xt,platform:Bt,elements:Nt}=kt,jt=await(Bt.isRTL==null?void 0:Bt.isRTL(Nt.floating)),Ut=getSide(xt),Lt=getAlignment(xt),Ht=getSideAxis(xt)==="y",Vt=["left","top"].includes(Ut)?-1:1,zt=jt&&Ht?-1:1,Wt=evaluate(At,kt);let{mainAxis:Jt,crossAxis:Qt,alignmentAxis:Xt}=typeof Wt=="number"?{mainAxis:Wt,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...Wt};return Lt&&typeof Xt=="number"&&(Qt=Lt==="end"?Xt*-1:Xt),Ht?{x:Qt*zt,y:Jt*Vt}:{x:Jt*Vt,y:Qt*zt}}const offset$1=function(kt){return kt===void 0&&(kt=0),{name:"offset",options:kt,async fn(At){var xt,Bt;const{x:Nt,y:jt,placement:Ut,middlewareData:Lt}=At,Ht=await convertValueToCoords(At,kt);return Ut===((xt=Lt.offset)==null?void 0:xt.placement)&&(Bt=Lt.arrow)!=null&&Bt.alignmentOffset?{}:{x:Nt+Ht.x,y:jt+Ht.y,data:{...Ht,placement:Ut}}}}},shift$1=function(kt){return kt===void 0&&(kt={}),{name:"shift",options:kt,async fn(At){const{x:xt,y:Bt,placement:Nt}=At,{mainAxis:jt=!0,crossAxis:Ut=!1,limiter:Lt={fn:rr=>{let{x:nr,y:ar}=rr;return{x:nr,y:ar}}},...Ht}=evaluate(kt,At),Vt={x:xt,y:Bt},zt=await detectOverflow(At,Ht),Wt=getSideAxis(getSide(Nt)),Jt=getOppositeAxis(Wt);let Qt=Vt[Jt],Xt=Vt[Wt];if(jt){const rr=Jt==="y"?"top":"left",nr=Jt==="y"?"bottom":"right",ar=Qt+zt[rr],ir=Qt-zt[nr];Qt=clamp$1(ar,Qt,ir)}if(Ut){const rr=Wt==="y"?"top":"left",nr=Wt==="y"?"bottom":"right",ar=Xt+zt[rr],ir=Xt-zt[nr];Xt=clamp$1(ar,Xt,ir)}const tr=Lt.fn({...At,[Jt]:Qt,[Wt]:Xt});return{...tr,data:{x:tr.x-xt,y:tr.y-Bt}}}}},size$1=function(kt){return kt===void 0&&(kt={}),{name:"size",options:kt,async fn(At){const{placement:xt,rects:Bt,platform:Nt,elements:jt}=At,{apply:Ut=()=>{},...Lt}=evaluate(kt,At),Ht=await detectOverflow(At,Lt),Vt=getSide(xt),zt=getAlignment(xt),Wt=getSideAxis(xt)==="y",{width:Jt,height:Qt}=Bt.floating;let Xt,tr;Vt==="top"||Vt==="bottom"?(Xt=Vt,tr=zt===(await(Nt.isRTL==null?void 0:Nt.isRTL(jt.floating))?"start":"end")?"left":"right"):(tr=Vt,Xt=zt==="end"?"top":"bottom");const rr=Qt-Ht.top-Ht.bottom,nr=Jt-Ht.left-Ht.right,ar=min(Qt-Ht[Xt],rr),ir=min(Jt-Ht[tr],nr),lr=!At.middlewareData.shift;let yr=ar,Sr=ir;if(Wt?Sr=zt||lr?min(ir,nr):nr:yr=zt||lr?min(ar,rr):rr,lr&&!zt){const Dr=max$1(Ht.left,0),Br=max$1(Ht.right,0),Lr=max$1(Ht.top,0),Or=max$1(Ht.bottom,0);Wt?Sr=Jt-2*(Dr!==0||Br!==0?Dr+Br:max$1(Ht.left,Ht.right)):yr=Qt-2*(Lr!==0||Or!==0?Lr+Or:max$1(Ht.top,Ht.bottom))}await Ut({...At,availableWidth:Sr,availableHeight:yr});const Ar=await Nt.getDimensions(jt.floating);return Jt!==Ar.width||Qt!==Ar.height?{reset:{rects:!0}}:{}}}};function getNodeName(kt){return isNode(kt)?(kt.nodeName||"").toLowerCase():"#document"}function getWindow(kt){var At;return(kt==null||(At=kt.ownerDocument)==null?void 0:At.defaultView)||window}function getDocumentElement(kt){var At;return(At=(isNode(kt)?kt.ownerDocument:kt.document)||window.document)==null?void 0:At.documentElement}function isNode(kt){return kt instanceof Node||kt instanceof getWindow(kt).Node}function isElement(kt){return kt instanceof Element||kt instanceof getWindow(kt).Element}function isHTMLElement(kt){return kt instanceof HTMLElement||kt instanceof getWindow(kt).HTMLElement}function isShadowRoot(kt){return typeof ShadowRoot>"u"?!1:kt instanceof ShadowRoot||kt instanceof getWindow(kt).ShadowRoot}function isOverflowElement(kt){const{overflow:At,overflowX:xt,overflowY:Bt,display:Nt}=getComputedStyle$1(kt);return/auto|scroll|overlay|hidden|clip/.test(At+Bt+xt)&&!["inline","contents"].includes(Nt)}function isTableElement(kt){return["table","td","th"].includes(getNodeName(kt))}function isTopLayer(kt){return[":popover-open",":modal"].some(At=>{try{return kt.matches(At)}catch{return!1}})}function isContainingBlock(kt){const At=isWebKit(),xt=isElement(kt)?getComputedStyle$1(kt):kt;return xt.transform!=="none"||xt.perspective!=="none"||(xt.containerType?xt.containerType!=="normal":!1)||!At&&(xt.backdropFilter?xt.backdropFilter!=="none":!1)||!At&&(xt.filter?xt.filter!=="none":!1)||["transform","perspective","filter"].some(Bt=>(xt.willChange||"").includes(Bt))||["paint","layout","strict","content"].some(Bt=>(xt.contain||"").includes(Bt))}function getContainingBlock(kt){let At=getParentNode(kt);for(;isHTMLElement(At)&&!isLastTraversableNode(At);){if(isContainingBlock(At))return At;if(isTopLayer(At))return null;At=getParentNode(At)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(kt){return["html","body","#document"].includes(getNodeName(kt))}function getComputedStyle$1(kt){return getWindow(kt).getComputedStyle(kt)}function getNodeScroll(kt){return isElement(kt)?{scrollLeft:kt.scrollLeft,scrollTop:kt.scrollTop}:{scrollLeft:kt.scrollX,scrollTop:kt.scrollY}}function getParentNode(kt){if(getNodeName(kt)==="html")return kt;const At=kt.assignedSlot||kt.parentNode||isShadowRoot(kt)&&kt.host||getDocumentElement(kt);return isShadowRoot(At)?At.host:At}function getNearestOverflowAncestor(kt){const At=getParentNode(kt);return isLastTraversableNode(At)?kt.ownerDocument?kt.ownerDocument.body:kt.body:isHTMLElement(At)&&isOverflowElement(At)?At:getNearestOverflowAncestor(At)}function getOverflowAncestors(kt,At,xt){var Bt;At===void 0&&(At=[]),xt===void 0&&(xt=!0);const Nt=getNearestOverflowAncestor(kt),jt=Nt===((Bt=kt.ownerDocument)==null?void 0:Bt.body),Ut=getWindow(Nt);if(jt){const Lt=getFrameElement(Ut);return At.concat(Ut,Ut.visualViewport||[],isOverflowElement(Nt)?Nt:[],Lt&&xt?getOverflowAncestors(Lt):[])}return At.concat(Nt,getOverflowAncestors(Nt,[],xt))}function getFrameElement(kt){return kt.parent&&Object.getPrototypeOf(kt.parent)?kt.frameElement:null}function getCssDimensions(kt){const At=getComputedStyle$1(kt);let xt=parseFloat(At.width)||0,Bt=parseFloat(At.height)||0;const Nt=isHTMLElement(kt),jt=Nt?kt.offsetWidth:xt,Ut=Nt?kt.offsetHeight:Bt,Lt=round(xt)!==jt||round(Bt)!==Ut;return Lt&&(xt=jt,Bt=Ut),{width:xt,height:Bt,$:Lt}}function unwrapElement(kt){return isElement(kt)?kt:kt.contextElement}function getScale(kt){const At=unwrapElement(kt);if(!isHTMLElement(At))return createCoords(1);const xt=At.getBoundingClientRect(),{width:Bt,height:Nt,$:jt}=getCssDimensions(At);let Ut=(jt?round(xt.width):xt.width)/Bt,Lt=(jt?round(xt.height):xt.height)/Nt;return(!Ut||!Number.isFinite(Ut))&&(Ut=1),(!Lt||!Number.isFinite(Lt))&&(Lt=1),{x:Ut,y:Lt}}const noOffsets=createCoords(0);function getVisualOffsets(kt){const At=getWindow(kt);return!isWebKit()||!At.visualViewport?noOffsets:{x:At.visualViewport.offsetLeft,y:At.visualViewport.offsetTop}}function shouldAddVisualOffsets(kt,At,xt){return At===void 0&&(At=!1),!xt||At&&xt!==getWindow(kt)?!1:At}function getBoundingClientRect(kt,At,xt,Bt){At===void 0&&(At=!1),xt===void 0&&(xt=!1);const Nt=kt.getBoundingClientRect(),jt=unwrapElement(kt);let Ut=createCoords(1);At&&(Bt?isElement(Bt)&&(Ut=getScale(Bt)):Ut=getScale(kt));const Lt=shouldAddVisualOffsets(jt,xt,Bt)?getVisualOffsets(jt):createCoords(0);let Ht=(Nt.left+Lt.x)/Ut.x,Vt=(Nt.top+Lt.y)/Ut.y,zt=Nt.width/Ut.x,Wt=Nt.height/Ut.y;if(jt){const Jt=getWindow(jt),Qt=Bt&&isElement(Bt)?getWindow(Bt):Bt;let Xt=Jt,tr=getFrameElement(Xt);for(;tr&&Bt&&Qt!==Xt;){const rr=getScale(tr),nr=tr.getBoundingClientRect(),ar=getComputedStyle$1(tr),ir=nr.left+(tr.clientLeft+parseFloat(ar.paddingLeft))*rr.x,lr=nr.top+(tr.clientTop+parseFloat(ar.paddingTop))*rr.y;Ht*=rr.x,Vt*=rr.y,zt*=rr.x,Wt*=rr.y,Ht+=ir,Vt+=lr,Xt=getWindow(tr),tr=getFrameElement(Xt)}}return rectToClientRect({width:zt,height:Wt,x:Ht,y:Vt})}function convertOffsetParentRelativeRectToViewportRelativeRect(kt){let{elements:At,rect:xt,offsetParent:Bt,strategy:Nt}=kt;const jt=Nt==="fixed",Ut=getDocumentElement(Bt),Lt=At?isTopLayer(At.floating):!1;if(Bt===Ut||Lt&&jt)return xt;let Ht={scrollLeft:0,scrollTop:0},Vt=createCoords(1);const zt=createCoords(0),Wt=isHTMLElement(Bt);if((Wt||!Wt&&!jt)&&((getNodeName(Bt)!=="body"||isOverflowElement(Ut))&&(Ht=getNodeScroll(Bt)),isHTMLElement(Bt))){const Jt=getBoundingClientRect(Bt);Vt=getScale(Bt),zt.x=Jt.x+Bt.clientLeft,zt.y=Jt.y+Bt.clientTop}return{width:xt.width*Vt.x,height:xt.height*Vt.y,x:xt.x*Vt.x-Ht.scrollLeft*Vt.x+zt.x,y:xt.y*Vt.y-Ht.scrollTop*Vt.y+zt.y}}function getClientRects(kt){return Array.from(kt.getClientRects())}function getWindowScrollBarX(kt){return getBoundingClientRect(getDocumentElement(kt)).left+getNodeScroll(kt).scrollLeft}function getDocumentRect(kt){const At=getDocumentElement(kt),xt=getNodeScroll(kt),Bt=kt.ownerDocument.body,Nt=max$1(At.scrollWidth,At.clientWidth,Bt.scrollWidth,Bt.clientWidth),jt=max$1(At.scrollHeight,At.clientHeight,Bt.scrollHeight,Bt.clientHeight);let Ut=-xt.scrollLeft+getWindowScrollBarX(kt);const Lt=-xt.scrollTop;return getComputedStyle$1(Bt).direction==="rtl"&&(Ut+=max$1(At.clientWidth,Bt.clientWidth)-Nt),{width:Nt,height:jt,x:Ut,y:Lt}}function getViewportRect(kt,At){const xt=getWindow(kt),Bt=getDocumentElement(kt),Nt=xt.visualViewport;let jt=Bt.clientWidth,Ut=Bt.clientHeight,Lt=0,Ht=0;if(Nt){jt=Nt.width,Ut=Nt.height;const Vt=isWebKit();(!Vt||Vt&&At==="fixed")&&(Lt=Nt.offsetLeft,Ht=Nt.offsetTop)}return{width:jt,height:Ut,x:Lt,y:Ht}}function getInnerBoundingClientRect(kt,At){const xt=getBoundingClientRect(kt,!0,At==="fixed"),Bt=xt.top+kt.clientTop,Nt=xt.left+kt.clientLeft,jt=isHTMLElement(kt)?getScale(kt):createCoords(1),Ut=kt.clientWidth*jt.x,Lt=kt.clientHeight*jt.y,Ht=Nt*jt.x,Vt=Bt*jt.y;return{width:Ut,height:Lt,x:Ht,y:Vt}}function getClientRectFromClippingAncestor(kt,At,xt){let Bt;if(At==="viewport")Bt=getViewportRect(kt,xt);else if(At==="document")Bt=getDocumentRect(getDocumentElement(kt));else if(isElement(At))Bt=getInnerBoundingClientRect(At,xt);else{const Nt=getVisualOffsets(kt);Bt={...At,x:At.x-Nt.x,y:At.y-Nt.y}}return rectToClientRect(Bt)}function hasFixedPositionAncestor(kt,At){const xt=getParentNode(kt);return xt===At||!isElement(xt)||isLastTraversableNode(xt)?!1:getComputedStyle$1(xt).position==="fixed"||hasFixedPositionAncestor(xt,At)}function getClippingElementAncestors(kt,At){const xt=At.get(kt);if(xt)return xt;let Bt=getOverflowAncestors(kt,[],!1).filter(Lt=>isElement(Lt)&&getNodeName(Lt)!=="body"),Nt=null;const jt=getComputedStyle$1(kt).position==="fixed";let Ut=jt?getParentNode(kt):kt;for(;isElement(Ut)&&!isLastTraversableNode(Ut);){const Lt=getComputedStyle$1(Ut),Ht=isContainingBlock(Ut);!Ht&&Lt.position==="fixed"&&(Nt=null),(jt?!Ht&&!Nt:!Ht&&Lt.position==="static"&&!!Nt&&["absolute","fixed"].includes(Nt.position)||isOverflowElement(Ut)&&!Ht&&hasFixedPositionAncestor(kt,Ut))?Bt=Bt.filter(zt=>zt!==Ut):Nt=Lt,Ut=getParentNode(Ut)}return At.set(kt,Bt),Bt}function getClippingRect(kt){let{element:At,boundary:xt,rootBoundary:Bt,strategy:Nt}=kt;const Ut=[...xt==="clippingAncestors"?isTopLayer(At)?[]:getClippingElementAncestors(At,this._c):[].concat(xt),Bt],Lt=Ut[0],Ht=Ut.reduce((Vt,zt)=>{const Wt=getClientRectFromClippingAncestor(At,zt,Nt);return Vt.top=max$1(Wt.top,Vt.top),Vt.right=min(Wt.right,Vt.right),Vt.bottom=min(Wt.bottom,Vt.bottom),Vt.left=max$1(Wt.left,Vt.left),Vt},getClientRectFromClippingAncestor(At,Lt,Nt));return{width:Ht.right-Ht.left,height:Ht.bottom-Ht.top,x:Ht.left,y:Ht.top}}function getDimensions(kt){const{width:At,height:xt}=getCssDimensions(kt);return{width:At,height:xt}}function getRectRelativeToOffsetParent(kt,At,xt){const Bt=isHTMLElement(At),Nt=getDocumentElement(At),jt=xt==="fixed",Ut=getBoundingClientRect(kt,!0,jt,At);let Lt={scrollLeft:0,scrollTop:0};const Ht=createCoords(0);if(Bt||!Bt&&!jt)if((getNodeName(At)!=="body"||isOverflowElement(Nt))&&(Lt=getNodeScroll(At)),Bt){const Wt=getBoundingClientRect(At,!0,jt,At);Ht.x=Wt.x+At.clientLeft,Ht.y=Wt.y+At.clientTop}else Nt&&(Ht.x=getWindowScrollBarX(Nt));const Vt=Ut.left+Lt.scrollLeft-Ht.x,zt=Ut.top+Lt.scrollTop-Ht.y;return{x:Vt,y:zt,width:Ut.width,height:Ut.height}}function isStaticPositioned(kt){return getComputedStyle$1(kt).position==="static"}function getTrueOffsetParent(kt,At){return!isHTMLElement(kt)||getComputedStyle$1(kt).position==="fixed"?null:At?At(kt):kt.offsetParent}function getOffsetParent(kt,At){const xt=getWindow(kt);if(isTopLayer(kt))return xt;if(!isHTMLElement(kt)){let Nt=getParentNode(kt);for(;Nt&&!isLastTraversableNode(Nt);){if(isElement(Nt)&&!isStaticPositioned(Nt))return Nt;Nt=getParentNode(Nt)}return xt}let Bt=getTrueOffsetParent(kt,At);for(;Bt&&isTableElement(Bt)&&isStaticPositioned(Bt);)Bt=getTrueOffsetParent(Bt,At);return Bt&&isLastTraversableNode(Bt)&&isStaticPositioned(Bt)&&!isContainingBlock(Bt)?xt:Bt||getContainingBlock(kt)||xt}const getElementRects=async function(kt){const At=this.getOffsetParent||getOffsetParent,xt=this.getDimensions,Bt=await xt(kt.floating);return{reference:getRectRelativeToOffsetParent(kt.reference,await At(kt.floating),kt.strategy),floating:{x:0,y:0,width:Bt.width,height:Bt.height}}};function isRTL(kt){return getComputedStyle$1(kt).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(kt,At){let xt=null,Bt;const Nt=getDocumentElement(kt);function jt(){var Lt;clearTimeout(Bt),(Lt=xt)==null||Lt.disconnect(),xt=null}function Ut(Lt,Ht){Lt===void 0&&(Lt=!1),Ht===void 0&&(Ht=1),jt();const{left:Vt,top:zt,width:Wt,height:Jt}=kt.getBoundingClientRect();if(Lt||At(),!Wt||!Jt)return;const Qt=floor(zt),Xt=floor(Nt.clientWidth-(Vt+Wt)),tr=floor(Nt.clientHeight-(zt+Jt)),rr=floor(Vt),ar={rootMargin:-Qt+"px "+-Xt+"px "+-tr+"px "+-rr+"px",threshold:max$1(0,min(1,Ht))||1};let ir=!0;function lr(yr){const Sr=yr[0].intersectionRatio;if(Sr!==Ht){if(!ir)return Ut();Sr?Ut(!1,Sr):Bt=setTimeout(()=>{Ut(!1,1e-7)},1e3)}ir=!1}try{xt=new IntersectionObserver(lr,{...ar,root:Nt.ownerDocument})}catch{xt=new IntersectionObserver(lr,ar)}xt.observe(kt)}return Ut(!0),jt}function autoUpdate(kt,At,xt,Bt){Bt===void 0&&(Bt={});const{ancestorScroll:Nt=!0,ancestorResize:jt=!0,elementResize:Ut=typeof ResizeObserver=="function",layoutShift:Lt=typeof IntersectionObserver=="function",animationFrame:Ht=!1}=Bt,Vt=unwrapElement(kt),zt=Nt||jt?[...Vt?getOverflowAncestors(Vt):[],...getOverflowAncestors(At)]:[];zt.forEach(nr=>{Nt&&nr.addEventListener("scroll",xt,{passive:!0}),jt&&nr.addEventListener("resize",xt)});const Wt=Vt&&Lt?observeMove(Vt,xt):null;let Jt=-1,Qt=null;Ut&&(Qt=new ResizeObserver(nr=>{let[ar]=nr;ar&&ar.target===Vt&&Qt&&(Qt.unobserve(At),cancelAnimationFrame(Jt),Jt=requestAnimationFrame(()=>{var ir;(ir=Qt)==null||ir.observe(At)})),xt()}),Vt&&!Ht&&Qt.observe(Vt),Qt.observe(At));let Xt,tr=Ht?getBoundingClientRect(kt):null;Ht&&rr();function rr(){const nr=getBoundingClientRect(kt);tr&&(nr.x!==tr.x||nr.y!==tr.y||nr.width!==tr.width||nr.height!==tr.height)&&xt(),tr=nr,Xt=requestAnimationFrame(rr)}return xt(),()=>{var nr;zt.forEach(ar=>{Nt&&ar.removeEventListener("scroll",xt),jt&&ar.removeEventListener("resize",xt)}),Wt==null||Wt(),(nr=Qt)==null||nr.disconnect(),Qt=null,Ht&&cancelAnimationFrame(Xt)}}const offset=offset$1,shift=shift$1,flip=flip$1,size=size$1,arrow=arrow$1,computePosition=(kt,At,xt)=>{const Bt=new Map,Nt={platform,...xt},jt={...Nt.platform,_c:Bt};return computePosition$1(kt,At,{...Nt,platform:jt})};function t$2(kt){return r$2(kt)}function o$3(kt){return kt.assignedSlot?kt.assignedSlot:kt.parentNode instanceof ShadowRoot?kt.parentNode.host:kt.parentNode}function r$2(kt){for(let At=kt;At;At=o$3(At))if(At instanceof Element&&getComputedStyle(At).display==="none")return null;for(let At=o$3(kt);At;At=o$3(At)){if(!(At instanceof Element))continue;const xt=getComputedStyle(At);if(xt.display!=="contents"&&(xt.position!=="static"||xt.filter!=="none"||At.tagName==="BODY"))return At}return null}function isVirtualElement(kt){return kt!==null&&typeof kt=="object"&&"getBoundingClientRect"in kt&&("contextElement"in kt?kt instanceof Element:!0)}var SlPopup=class extends ShoelaceElement{constructor(){super(...arguments),this.active=!1,this.placement="top",this.strategy="absolute",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0,this.hoverBridge=!1,this.updateHoverBridge=()=>{if(this.hoverBridge&&this.anchorEl){const kt=this.anchorEl.getBoundingClientRect(),At=this.popup.getBoundingClientRect(),xt=this.placement.includes("top")||this.placement.includes("bottom");let Bt=0,Nt=0,jt=0,Ut=0,Lt=0,Ht=0,Vt=0,zt=0;xt?kt.top<At.top?(Bt=kt.left,Nt=kt.bottom,jt=kt.right,Ut=kt.bottom,Lt=At.left,Ht=At.top,Vt=At.right,zt=At.top):(Bt=At.left,Nt=At.bottom,jt=At.right,Ut=At.bottom,Lt=kt.left,Ht=kt.top,Vt=kt.right,zt=kt.top):kt.left<At.left?(Bt=kt.right,Nt=kt.top,jt=At.left,Ut=At.top,Lt=kt.right,Ht=kt.bottom,Vt=At.left,zt=At.bottom):(Bt=At.right,Nt=At.top,jt=kt.left,Ut=kt.top,Lt=At.right,Ht=At.bottom,Vt=kt.left,zt=kt.bottom),this.style.setProperty("--hover-bridge-top-left-x",`${Bt}px`),this.style.setProperty("--hover-bridge-top-left-y",`${Nt}px`),this.style.setProperty("--hover-bridge-top-right-x",`${jt}px`),this.style.setProperty("--hover-bridge-top-right-y",`${Ut}px`),this.style.setProperty("--hover-bridge-bottom-left-x",`${Lt}px`),this.style.setProperty("--hover-bridge-bottom-left-y",`${Ht}px`),this.style.setProperty("--hover-bridge-bottom-right-x",`${Vt}px`),this.style.setProperty("--hover-bridge-bottom-right-y",`${zt}px`)}}}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){super.disconnectedCallback(),this.stop()}async updated(kt){super.updated(kt),kt.has("active")&&(this.active?this.start():this.stop()),kt.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const kt=this.getRootNode();this.anchorEl=kt.getElementById(this.anchor)}else this.anchor instanceof Element||isVirtualElement(this.anchor)?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),this.anchorEl&&this.start()}start(){this.anchorEl&&(this.cleanup=autoUpdate(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(kt=>{this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>kt())):kt()})}reposition(){if(!this.active||!this.anchorEl)return;const kt=[offset({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?kt.push(size({apply:({rects:xt})=>{const Bt=this.sync==="width"||this.sync==="both",Nt=this.sync==="height"||this.sync==="both";this.popup.style.width=Bt?`${xt.reference.width}px`:"",this.popup.style.height=Nt?`${xt.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height=""),this.flip&&kt.push(flip({boundary:this.flipBoundary,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&kt.push(shift({boundary:this.shiftBoundary,padding:this.shiftPadding})),this.autoSize?kt.push(size({boundary:this.autoSizeBoundary,padding:this.autoSizePadding,apply:({availableWidth:xt,availableHeight:Bt})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${Bt}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${xt}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&kt.push(arrow({element:this.arrowEl,padding:this.arrowPadding}));const At=this.strategy==="absolute"?xt=>platform.getOffsetParent(xt,t$2):platform.getOffsetParent;computePosition(this.anchorEl,this.popup,{placement:this.placement,middleware:kt,strategy:this.strategy,platform:__spreadProps(__spreadValues({},platform),{getOffsetParent:At})}).then(({x:xt,y:Bt,middlewareData:Nt,placement:jt})=>{const Ut=this.matches(":dir(rtl)"),Lt={top:"bottom",right:"left",bottom:"top",left:"right"}[jt.split("-")[0]];if(this.setAttribute("data-current-placement",jt),Object.assign(this.popup.style,{left:`${xt}px`,top:`${Bt}px`}),this.arrow){const Ht=Nt.arrow.x,Vt=Nt.arrow.y;let zt="",Wt="",Jt="",Qt="";if(this.arrowPlacement==="start"){const Xt=typeof Ht=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";zt=typeof Vt=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",Wt=Ut?Xt:"",Qt=Ut?"":Xt}else if(this.arrowPlacement==="end"){const Xt=typeof Ht=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";Wt=Ut?"":Xt,Qt=Ut?Xt:"",Jt=typeof Vt=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(Qt=typeof Ht=="number"?"calc(50% - var(--arrow-size-diagonal))":"",zt=typeof Vt=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(Qt=typeof Ht=="number"?`${Ht}px`:"",zt=typeof Vt=="number"?`${Vt}px`:"");Object.assign(this.arrowEl.style,{top:zt,right:Wt,bottom:Jt,left:Qt,[Lt]:"calc(var(--arrow-size-diagonal) * -1)"})}}),requestAnimationFrame(()=>this.updateHoverBridge()),this.emit("sl-reposition")}render(){return ke$2`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <span
        part="hover-bridge"
        class=${Rt$1({"popup-hover-bridge":!0,"popup-hover-bridge--visible":this.hoverBridge&&this.active})}
      ></span>

      <div
        part="popup"
        class=${Rt$1({popup:!0,"popup--active":this.active,"popup--fixed":this.strategy==="fixed","popup--has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?ke$2`<div part="arrow" class="popup__arrow" role="presentation"></div>`:""}
      </div>
    `}};SlPopup.styles=[component_styles_default,popup_styles_default];__decorateClass([e$3(".popup")],SlPopup.prototype,"popup",2);__decorateClass([e$3(".popup__arrow")],SlPopup.prototype,"arrowEl",2);__decorateClass([n$1()],SlPopup.prototype,"anchor",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlPopup.prototype,"active",2);__decorateClass([n$1({reflect:!0})],SlPopup.prototype,"placement",2);__decorateClass([n$1({reflect:!0})],SlPopup.prototype,"strategy",2);__decorateClass([n$1({type:Number})],SlPopup.prototype,"distance",2);__decorateClass([n$1({type:Number})],SlPopup.prototype,"skidding",2);__decorateClass([n$1({type:Boolean})],SlPopup.prototype,"arrow",2);__decorateClass([n$1({attribute:"arrow-placement"})],SlPopup.prototype,"arrowPlacement",2);__decorateClass([n$1({attribute:"arrow-padding",type:Number})],SlPopup.prototype,"arrowPadding",2);__decorateClass([n$1({type:Boolean})],SlPopup.prototype,"flip",2);__decorateClass([n$1({attribute:"flip-fallback-placements",converter:{fromAttribute:kt=>kt.split(" ").map(At=>At.trim()).filter(At=>At!==""),toAttribute:kt=>kt.join(" ")}})],SlPopup.prototype,"flipFallbackPlacements",2);__decorateClass([n$1({attribute:"flip-fallback-strategy"})],SlPopup.prototype,"flipFallbackStrategy",2);__decorateClass([n$1({type:Object})],SlPopup.prototype,"flipBoundary",2);__decorateClass([n$1({attribute:"flip-padding",type:Number})],SlPopup.prototype,"flipPadding",2);__decorateClass([n$1({type:Boolean})],SlPopup.prototype,"shift",2);__decorateClass([n$1({type:Object})],SlPopup.prototype,"shiftBoundary",2);__decorateClass([n$1({attribute:"shift-padding",type:Number})],SlPopup.prototype,"shiftPadding",2);__decorateClass([n$1({attribute:"auto-size"})],SlPopup.prototype,"autoSize",2);__decorateClass([n$1()],SlPopup.prototype,"sync",2);__decorateClass([n$1({type:Object})],SlPopup.prototype,"autoSizeBoundary",2);__decorateClass([n$1({attribute:"auto-size-padding",type:Number})],SlPopup.prototype,"autoSizePadding",2);__decorateClass([n$1({attribute:"hover-bridge",type:Boolean})],SlPopup.prototype,"hoverBridge",2);var defaultAnimationRegistry=new Map,customAnimationRegistry=new WeakMap;function ensureAnimation(kt){return kt??{keyframes:[],options:{duration:0}}}function getLogicalAnimation(kt,At){return At.toLowerCase()==="rtl"?{keyframes:kt.rtlKeyframes||kt.keyframes,options:kt.options}:kt}function setDefaultAnimation(kt,At){defaultAnimationRegistry.set(kt,ensureAnimation(At))}function getAnimation(kt,At,xt){const Bt=customAnimationRegistry.get(kt);if(Bt!=null&&Bt[At])return getLogicalAnimation(Bt[At],xt.dir);const Nt=defaultAnimationRegistry.get(At);return Nt?getLogicalAnimation(Nt,xt.dir):{keyframes:[],options:{duration:0}}}function waitForEvent(kt,At){return new Promise(xt=>{function Bt(Nt){Nt.target===kt&&(kt.removeEventListener(At,Bt),xt())}kt.addEventListener(At,Bt)})}function animateTo(kt,At,xt){return new Promise(Bt=>{if((xt==null?void 0:xt.duration)===1/0)throw new Error("Promise-based animations must be finite.");const Nt=kt.animate(At,__spreadProps(__spreadValues({},xt),{duration:prefersReducedMotion()?0:xt.duration}));Nt.addEventListener("cancel",Bt,{once:!0}),Nt.addEventListener("finish",Bt,{once:!0})})}function parseDuration(kt){return kt=kt.toString().toLowerCase(),kt.indexOf("ms")>-1?parseFloat(kt):kt.indexOf("s")>-1?parseFloat(kt)*1e3:parseFloat(kt)}function prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}function stopAnimations(kt){return Promise.all(kt.getAnimations().map(At=>new Promise(xt=>{At.cancel(),requestAnimationFrame(xt)})))}function shimKeyframesHeightAuto(kt,At){return kt.map(xt=>__spreadProps(__spreadValues({},xt),{height:xt.height==="auto"?`${At}px`:xt.height}))}var SlTooltip=class extends ShoelaceElement{constructor(){super(),this.localize=new LocalizeController(this),this.content="",this.placement="top",this.disabled=!1,this.distance=8,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.handleBlur=()=>{this.hasTrigger("focus")&&this.hide()},this.handleClick=()=>{this.hasTrigger("click")&&(this.open?this.hide():this.show())},this.handleFocus=()=>{this.hasTrigger("focus")&&this.show()},this.handleDocumentKeyDown=kt=>{kt.key==="Escape"&&(kt.stopPropagation(),this.hide())},this.handleMouseOver=()=>{if(this.hasTrigger("hover")){const kt=parseDuration(getComputedStyle(this).getPropertyValue("--show-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.show(),kt)}},this.handleMouseOut=()=>{if(this.hasTrigger("hover")){const kt=parseDuration(getComputedStyle(this).getPropertyValue("--hide-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.hide(),kt)}},this.addEventListener("blur",this.handleBlur,!0),this.addEventListener("focus",this.handleFocus,!0),this.addEventListener("click",this.handleClick),this.addEventListener("mouseover",this.handleMouseOver),this.addEventListener("mouseout",this.handleMouseOut)}disconnectedCallback(){var kt;(kt=this.closeWatcher)==null||kt.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown)}firstUpdated(){this.body.hidden=!this.open,this.open&&(this.popup.active=!0,this.popup.reposition())}hasTrigger(kt){return this.trigger.split(" ").includes(kt)}async handleOpenChange(){var kt,At;if(this.open){if(this.disabled)return;this.emit("sl-show"),"CloseWatcher"in window?((kt=this.closeWatcher)==null||kt.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>{this.hide()}):document.addEventListener("keydown",this.handleDocumentKeyDown),await stopAnimations(this.body),this.body.hidden=!1,this.popup.active=!0;const{keyframes:xt,options:Bt}=getAnimation(this,"tooltip.show",{dir:this.localize.dir()});await animateTo(this.popup.popup,xt,Bt),this.popup.reposition(),this.emit("sl-after-show")}else{this.emit("sl-hide"),(At=this.closeWatcher)==null||At.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown),await stopAnimations(this.body);const{keyframes:xt,options:Bt}=getAnimation(this,"tooltip.hide",{dir:this.localize.dir()});await animateTo(this.popup.popup,xt,Bt),this.popup.active=!1,this.body.hidden=!0,this.emit("sl-after-hide")}}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,waitForEvent(this,"sl-after-hide")}render(){return ke$2`
      <sl-popup
        part="base"
        exportparts="
          popup:base__popup,
          arrow:base__arrow
        "
        class=${Rt$1({tooltip:!0,"tooltip--open":this.open})}
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        strategy=${this.hoist?"fixed":"absolute"}
        flip
        shift
        arrow
        hover-bridge
      >
        ${""}
        <slot slot="anchor" aria-describedby="tooltip"></slot>

        ${""}
        <div part="body" id="tooltip" class="tooltip__body" role="tooltip" aria-live=${this.open?"polite":"off"}>
          <slot name="content">${this.content}</slot>
        </div>
      </sl-popup>
    `}};SlTooltip.styles=[component_styles_default,tooltip_styles_default];SlTooltip.dependencies={"sl-popup":SlPopup};__decorateClass([e$3("slot:not([name])")],SlTooltip.prototype,"defaultSlot",2);__decorateClass([e$3(".tooltip__body")],SlTooltip.prototype,"body",2);__decorateClass([e$3("sl-popup")],SlTooltip.prototype,"popup",2);__decorateClass([n$1()],SlTooltip.prototype,"content",2);__decorateClass([n$1()],SlTooltip.prototype,"placement",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTooltip.prototype,"disabled",2);__decorateClass([n$1({type:Number})],SlTooltip.prototype,"distance",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTooltip.prototype,"open",2);__decorateClass([n$1({type:Number})],SlTooltip.prototype,"skidding",2);__decorateClass([n$1()],SlTooltip.prototype,"trigger",2);__decorateClass([n$1({type:Boolean})],SlTooltip.prototype,"hoist",2);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlTooltip.prototype,"handleOpenChange",1);__decorateClass([watch(["content","distance","hoist","placement","skidding"])],SlTooltip.prototype,"handleOptionsChange",1);__decorateClass([watch("disabled")],SlTooltip.prototype,"handleDisabledChange",1);setDefaultAnimation("tooltip.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}});setDefaultAnimation("tooltip.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}});var copy_button_styles_default=i$7`
  :host {
    --error-color: var(--sl-color-danger-600);
    --success-color: var(--sl-color-success-600);

    display: inline-block;
  }

  .copy-button__button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    background: none;
    border: none;
    border-radius: var(--sl-border-radius-medium);
    font-size: inherit;
    color: inherit;
    padding: var(--sl-spacing-x-small);
    cursor: pointer;
    transition: var(--sl-transition-x-fast) color;
  }

  .copy-button--success .copy-button__button {
    color: var(--success-color);
  }

  .copy-button--error .copy-button__button {
    color: var(--error-color);
  }

  .copy-button__button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .copy-button__button[disabled] {
    opacity: 0.5;
    cursor: not-allowed !important;
  }

  slot {
    display: inline-flex;
  }
`,SlCopyButton=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.isCopying=!1,this.status="rest",this.value="",this.from="",this.disabled=!1,this.copyLabel="",this.successLabel="",this.errorLabel="",this.feedbackDuration=1e3,this.tooltipPlacement="top",this.hoist=!1}async handleCopy(){if(this.disabled||this.isCopying)return;this.isCopying=!0;let kt=this.value;if(this.from){const At=this.getRootNode(),xt=this.from.includes("."),Bt=this.from.includes("[")&&this.from.includes("]");let Nt=this.from,jt="";xt?[Nt,jt]=this.from.trim().split("."):Bt&&([Nt,jt]=this.from.trim().replace(/\]$/,"").split("["));const Ut="getElementById"in At?At.getElementById(Nt):null;Ut?Bt?kt=Ut.getAttribute(jt)||"":xt?kt=Ut[jt]||"":kt=Ut.textContent||"":(this.showStatus("error"),this.emit("sl-error"))}if(!kt)this.showStatus("error"),this.emit("sl-error");else try{await navigator.clipboard.writeText(kt),this.showStatus("success"),this.emit("sl-copy",{detail:{value:kt}})}catch{this.showStatus("error"),this.emit("sl-error")}}async showStatus(kt){const At=this.copyLabel||this.localize.term("copy"),xt=this.successLabel||this.localize.term("copied"),Bt=this.errorLabel||this.localize.term("error"),Nt=kt==="success"?this.successIcon:this.errorIcon,jt=getAnimation(this,"copy.in",{dir:"ltr"}),Ut=getAnimation(this,"copy.out",{dir:"ltr"});this.tooltip.content=kt==="success"?xt:Bt,await this.copyIcon.animate(Ut.keyframes,Ut.options).finished,this.copyIcon.hidden=!0,this.status=kt,Nt.hidden=!1,await Nt.animate(jt.keyframes,jt.options).finished,setTimeout(async()=>{await Nt.animate(Ut.keyframes,Ut.options).finished,Nt.hidden=!0,this.status="rest",this.copyIcon.hidden=!1,await this.copyIcon.animate(jt.keyframes,jt.options).finished,this.tooltip.content=At,this.isCopying=!1},this.feedbackDuration)}render(){const kt=this.copyLabel||this.localize.term("copy");return ke$2`
      <sl-tooltip
        class=${Rt$1({"copy-button":!0,"copy-button--success":this.status==="success","copy-button--error":this.status==="error"})}
        content=${kt}
        placement=${this.tooltipPlacement}
        ?disabled=${this.disabled}
        ?hoist=${this.hoist}
        exportparts="
          base:tooltip__base,
          base__popup:tooltip__base__popup,
          base__arrow:tooltip__base__arrow,
          body:tooltip__body
        "
      >
        <button
          class="copy-button__button"
          part="button"
          type="button"
          ?disabled=${this.disabled}
          @click=${this.handleCopy}
        >
          <slot part="copy-icon" name="copy-icon">
            <sl-icon library="system" name="copy"></sl-icon>
          </slot>
          <slot part="success-icon" name="success-icon" hidden>
            <sl-icon library="system" name="check"></sl-icon>
          </slot>
          <slot part="error-icon" name="error-icon" hidden>
            <sl-icon library="system" name="x-lg"></sl-icon>
          </slot>
        </button>
      </sl-tooltip>
    `}};SlCopyButton.styles=[component_styles_default,copy_button_styles_default];SlCopyButton.dependencies={"sl-icon":SlIcon,"sl-tooltip":SlTooltip};__decorateClass([e$3('slot[name="copy-icon"]')],SlCopyButton.prototype,"copyIcon",2);__decorateClass([e$3('slot[name="success-icon"]')],SlCopyButton.prototype,"successIcon",2);__decorateClass([e$3('slot[name="error-icon"]')],SlCopyButton.prototype,"errorIcon",2);__decorateClass([e$3("sl-tooltip")],SlCopyButton.prototype,"tooltip",2);__decorateClass([r$3()],SlCopyButton.prototype,"isCopying",2);__decorateClass([r$3()],SlCopyButton.prototype,"status",2);__decorateClass([n$1()],SlCopyButton.prototype,"value",2);__decorateClass([n$1()],SlCopyButton.prototype,"from",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCopyButton.prototype,"disabled",2);__decorateClass([n$1({attribute:"copy-label"})],SlCopyButton.prototype,"copyLabel",2);__decorateClass([n$1({attribute:"success-label"})],SlCopyButton.prototype,"successLabel",2);__decorateClass([n$1({attribute:"error-label"})],SlCopyButton.prototype,"errorLabel",2);__decorateClass([n$1({attribute:"feedback-duration",type:Number})],SlCopyButton.prototype,"feedbackDuration",2);__decorateClass([n$1({attribute:"tooltip-placement"})],SlCopyButton.prototype,"tooltipPlacement",2);__decorateClass([n$1({type:Boolean})],SlCopyButton.prototype,"hoist",2);setDefaultAnimation("copy.in",{keyframes:[{scale:".25",opacity:".25"},{scale:"1",opacity:"1"}],options:{duration:100}});setDefaultAnimation("copy.out",{keyframes:[{scale:"1",opacity:"1"},{scale:".25",opacity:"0"}],options:{duration:100}});SlCopyButton.define("sl-copy-button");var checkbox_styles_default=i$7`
  :host {
    display: inline-block;
  }

  .checkbox {
    position: relative;
    display: inline-flex;
    align-items: flex-start;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    color: var(--sl-input-label-color);
    vertical-align: middle;
    cursor: pointer;
  }

  .checkbox--small {
    --toggle-size: var(--sl-toggle-size-small);
    font-size: var(--sl-input-font-size-small);
  }

  .checkbox--medium {
    --toggle-size: var(--sl-toggle-size-medium);
    font-size: var(--sl-input-font-size-medium);
  }

  .checkbox--large {
    --toggle-size: var(--sl-toggle-size-large);
    font-size: var(--sl-input-font-size-large);
  }

  .checkbox__control {
    flex: 0 0 auto;
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--toggle-size);
    height: var(--toggle-size);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
    border-radius: 2px;
    background-color: var(--sl-input-background-color);
    color: var(--sl-color-neutral-0);
    transition:
      var(--sl-transition-fast) border-color,
      var(--sl-transition-fast) background-color,
      var(--sl-transition-fast) color,
      var(--sl-transition-fast) box-shadow;
  }

  .checkbox__input {
    position: absolute;
    opacity: 0;
    padding: 0;
    margin: 0;
    pointer-events: none;
  }

  .checkbox__checked-icon,
  .checkbox__indeterminate-icon {
    display: inline-flex;
    width: var(--toggle-size);
    height: var(--toggle-size);
  }

  /* Hover */
  .checkbox:not(.checkbox--checked):not(.checkbox--disabled) .checkbox__control:hover {
    border-color: var(--sl-input-border-color-hover);
    background-color: var(--sl-input-background-color-hover);
  }

  /* Focus */
  .checkbox:not(.checkbox--checked):not(.checkbox--disabled) .checkbox__input:focus-visible ~ .checkbox__control {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Checked/indeterminate */
  .checkbox--checked .checkbox__control,
  .checkbox--indeterminate .checkbox__control {
    border-color: var(--sl-color-primary-600);
    background-color: var(--sl-color-primary-600);
  }

  /* Checked/indeterminate + hover */
  .checkbox.checkbox--checked:not(.checkbox--disabled) .checkbox__control:hover,
  .checkbox.checkbox--indeterminate:not(.checkbox--disabled) .checkbox__control:hover {
    border-color: var(--sl-color-primary-500);
    background-color: var(--sl-color-primary-500);
  }

  /* Checked/indeterminate + focus */
  .checkbox.checkbox--checked:not(.checkbox--disabled) .checkbox__input:focus-visible ~ .checkbox__control,
  .checkbox.checkbox--indeterminate:not(.checkbox--disabled) .checkbox__input:focus-visible ~ .checkbox__control {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Disabled */
  .checkbox--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .checkbox__label {
    display: inline-block;
    color: var(--sl-input-label-color);
    line-height: var(--toggle-size);
    margin-inline-start: 0.5em;
    user-select: none;
    -webkit-user-select: none;
  }

  :host([required]) .checkbox__label::after {
    content: var(--sl-input-required-content);
    color: var(--sl-input-required-content-color);
    margin-inline-start: var(--sl-input-required-content-offset);
  }
`,defaultValue=(kt="value")=>(At,xt)=>{const Bt=At.constructor,Nt=Bt.prototype.attributeChangedCallback;Bt.prototype.attributeChangedCallback=function(jt,Ut,Lt){var Ht;const Vt=Bt.getPropertyOptions(kt),zt=typeof Vt.attribute=="string"?Vt.attribute:kt;if(jt===zt){const Wt=Vt.converter||u$1,Qt=(typeof Wt=="function"?Wt:(Ht=Wt==null?void 0:Wt.fromAttribute)!=null?Ht:u$1.fromAttribute)(Lt,Vt.type);this[kt]!==Qt&&(this[xt]=Qt)}Nt.call(this,jt,Ut,Lt)}},form_control_styles_default=i$7`
  .form-control .form-control__label {
    display: none;
  }

  .form-control .form-control__help-text {
    display: none;
  }

  /* Label */
  .form-control--has-label .form-control__label {
    display: inline-block;
    color: var(--sl-input-label-color);
    margin-bottom: var(--sl-spacing-3x-small);
  }

  .form-control--has-label.form-control--small .form-control__label {
    font-size: var(--sl-input-label-font-size-small);
  }

  .form-control--has-label.form-control--medium .form-control__label {
    font-size: var(--sl-input-label-font-size-medium);
  }

  .form-control--has-label.form-control--large .form-control__label {
    font-size: var(--sl-input-label-font-size-large);
  }

  :host([required]) .form-control--has-label .form-control__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
    color: var(--sl-input-required-content-color);
  }

  /* Help text */
  .form-control--has-help-text .form-control__help-text {
    display: block;
    color: var(--sl-input-help-text-color);
    margin-top: var(--sl-spacing-3x-small);
  }

  .form-control--has-help-text.form-control--small .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-small);
  }

  .form-control--has-help-text.form-control--medium .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-medium);
  }

  .form-control--has-help-text.form-control--large .form-control__help-text {
    font-size: var(--sl-input-help-text-font-size-large);
  }

  .form-control--has-help-text.form-control--radio-group .form-control__help-text {
    margin-top: var(--sl-spacing-2x-small);
  }
`;/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ft$1=e$2(class extends i$5{constructor(kt){if(super(kt),kt.type!==t$3.PROPERTY&&kt.type!==t$3.ATTRIBUTE&&kt.type!==t$3.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!rt$1(kt))throw Error("`live` bindings can only contain a single expression")}render(kt){return kt}update(kt,[At]){if(At===R$2||At===D$1)return At;const xt=kt.element,Bt=kt.name;if(kt.type===t$3.PROPERTY){if(At===xt[Bt])return R$2}else if(kt.type===t$3.BOOLEAN_ATTRIBUTE){if(!!At===xt.hasAttribute(Bt))return R$2}else if(kt.type===t$3.ATTRIBUTE&&xt.getAttribute(Bt)===At+"")return R$2;return dt$1(kt),At}});var SlCheckbox=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this,{value:kt=>kt.checked?kt.value||"on":void 0,defaultValue:kt=>kt.defaultChecked,setValue:(kt,At)=>kt.checked=At}),this.hasSlotController=new HasSlotController(this,"help-text"),this.hasFocus=!1,this.title="",this.name="",this.size="medium",this.disabled=!1,this.checked=!1,this.indeterminate=!1,this.defaultChecked=!1,this.form="",this.required=!1,this.helpText=""}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleClick(){this.checked=!this.checked,this.indeterminate=!1,this.emit("sl-change")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleInput(){this.emit("sl-input")}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}handleStateChange(){this.input.checked=this.checked,this.input.indeterminate=this.indeterminate,this.formControlController.updateValidity()}click(){this.input.click()}focus(kt){this.input.focus(kt)}blur(){this.input.blur()}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(kt){this.input.setCustomValidity(kt),this.formControlController.updateValidity()}render(){const kt=this.hasSlotController.test("help-text"),At=this.helpText?!0:!!kt;return ke$2`
      <div
        class=${Rt$1({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-help-text":At})}
      >
        <label
          part="base"
          class=${Rt$1({checkbox:!0,"checkbox--checked":this.checked,"checkbox--disabled":this.disabled,"checkbox--focused":this.hasFocus,"checkbox--indeterminate":this.indeterminate,"checkbox--small":this.size==="small","checkbox--medium":this.size==="medium","checkbox--large":this.size==="large"})}
        >
          <input
            class="checkbox__input"
            type="checkbox"
            title=${this.title}
            name=${this.name}
            value=${to(this.value)}
            .indeterminate=${Ft$1(this.indeterminate)}
            .checked=${Ft$1(this.checked)}
            .disabled=${this.disabled}
            .required=${this.required}
            aria-checked=${this.checked?"true":"false"}
            aria-describedby="help-text"
            @click=${this.handleClick}
            @input=${this.handleInput}
            @invalid=${this.handleInvalid}
            @blur=${this.handleBlur}
            @focus=${this.handleFocus}
          />

          <span
            part="control${this.checked?" control--checked":""}${this.indeterminate?" control--indeterminate":""}"
            class="checkbox__control"
          >
            ${this.checked?ke$2`
                  <sl-icon part="checked-icon" class="checkbox__checked-icon" library="system" name="check"></sl-icon>
                `:""}
            ${!this.checked&&this.indeterminate?ke$2`
                  <sl-icon
                    part="indeterminate-icon"
                    class="checkbox__indeterminate-icon"
                    library="system"
                    name="indeterminate"
                  ></sl-icon>
                `:""}
          </span>

          <div part="label" class="checkbox__label">
            <slot></slot>
          </div>
        </label>

        <div
          aria-hidden=${At?"false":"true"}
          class="form-control__help-text"
          id="help-text"
          part="form-control-help-text"
        >
          <slot name="help-text">${this.helpText}</slot>
        </div>
      </div>
    `}};SlCheckbox.styles=[component_styles_default,form_control_styles_default,checkbox_styles_default];SlCheckbox.dependencies={"sl-icon":SlIcon};__decorateClass([e$3('input[type="checkbox"]')],SlCheckbox.prototype,"input",2);__decorateClass([r$3()],SlCheckbox.prototype,"hasFocus",2);__decorateClass([n$1()],SlCheckbox.prototype,"title",2);__decorateClass([n$1()],SlCheckbox.prototype,"name",2);__decorateClass([n$1()],SlCheckbox.prototype,"value",2);__decorateClass([n$1({reflect:!0})],SlCheckbox.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCheckbox.prototype,"disabled",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCheckbox.prototype,"checked",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCheckbox.prototype,"indeterminate",2);__decorateClass([defaultValue("checked")],SlCheckbox.prototype,"defaultChecked",2);__decorateClass([n$1({reflect:!0})],SlCheckbox.prototype,"form",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCheckbox.prototype,"required",2);__decorateClass([n$1({attribute:"help-text"})],SlCheckbox.prototype,"helpText",2);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlCheckbox.prototype,"handleDisabledChange",1);__decorateClass([watch(["checked","indeterminate"],{waitUntilFirstUpdate:!0})],SlCheckbox.prototype,"handleStateChange",1);SlCheckbox.define("sl-checkbox");var menu_styles_default=i$7`
  :host {
    display: block;
    position: relative;
    background: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-radius: var(--sl-border-radius-medium);
    padding: var(--sl-spacing-x-small) 0;
    overflow: auto;
    overscroll-behavior: none;
  }

  ::slotted(sl-divider) {
    --spacing: var(--sl-spacing-x-small);
  }
`,SlMenu=class extends ShoelaceElement{connectedCallback(){super.connectedCallback(),this.setAttribute("role","menu")}handleClick(kt){const At=["menuitem","menuitemcheckbox"],xt=kt.composedPath(),Bt=xt.find(Lt=>{var Ht;return At.includes(((Ht=Lt==null?void 0:Lt.getAttribute)==null?void 0:Ht.call(Lt,"role"))||"")});if(!Bt||xt.find(Lt=>{var Ht;return((Ht=Lt==null?void 0:Lt.getAttribute)==null?void 0:Ht.call(Lt,"role"))==="menu"})!==this)return;const Ut=Bt;Ut.type==="checkbox"&&(Ut.checked=!Ut.checked),this.emit("sl-select",{detail:{item:Ut}})}handleKeyDown(kt){if(kt.key==="Enter"||kt.key===" "){const At=this.getCurrentItem();kt.preventDefault(),kt.stopPropagation(),At==null||At.click()}else if(["ArrowDown","ArrowUp","Home","End"].includes(kt.key)){const At=this.getAllItems(),xt=this.getCurrentItem();let Bt=xt?At.indexOf(xt):0;At.length>0&&(kt.preventDefault(),kt.stopPropagation(),kt.key==="ArrowDown"?Bt++:kt.key==="ArrowUp"?Bt--:kt.key==="Home"?Bt=0:kt.key==="End"&&(Bt=At.length-1),Bt<0&&(Bt=At.length-1),Bt>At.length-1&&(Bt=0),this.setCurrentItem(At[Bt]),At[Bt].focus())}}handleMouseDown(kt){const At=kt.target;this.isMenuItem(At)&&this.setCurrentItem(At)}handleSlotChange(){const kt=this.getAllItems();kt.length>0&&this.setCurrentItem(kt[0])}isMenuItem(kt){var At;return kt.tagName.toLowerCase()==="sl-menu-item"||["menuitem","menuitemcheckbox","menuitemradio"].includes((At=kt.getAttribute("role"))!=null?At:"")}getAllItems(){return[...this.defaultSlot.assignedElements({flatten:!0})].filter(kt=>!(kt.inert||!this.isMenuItem(kt)))}getCurrentItem(){return this.getAllItems().find(kt=>kt.getAttribute("tabindex")==="0")}setCurrentItem(kt){this.getAllItems().forEach(xt=>{xt.setAttribute("tabindex",xt===kt?"0":"-1")})}render(){return ke$2`
      <slot
        @slotchange=${this.handleSlotChange}
        @click=${this.handleClick}
        @keydown=${this.handleKeyDown}
        @mousedown=${this.handleMouseDown}
      ></slot>
    `}};SlMenu.styles=[component_styles_default,menu_styles_default];__decorateClass([e$3("slot")],SlMenu.prototype,"defaultSlot",2);SlMenu.define("sl-menu");var menu_item_styles_default=i$7`
  :host {
    --submenu-offset: -2px;

    display: block;
  }

  :host([inert]) {
    display: none;
  }

  .menu-item {
    position: relative;
    display: flex;
    align-items: stretch;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    line-height: var(--sl-line-height-normal);
    letter-spacing: var(--sl-letter-spacing-normal);
    color: var(--sl-color-neutral-700);
    padding: var(--sl-spacing-2x-small) var(--sl-spacing-2x-small);
    transition: var(--sl-transition-fast) fill;
    user-select: none;
    -webkit-user-select: none;
    white-space: nowrap;
    cursor: pointer;
  }

  .menu-item.menu-item--disabled {
    outline: none;
    opacity: 0.5;
    cursor: not-allowed;
  }

  .menu-item.menu-item--loading {
    outline: none;
    cursor: wait;
  }

  .menu-item.menu-item--loading *:not(sl-spinner) {
    opacity: 0.5;
  }

  .menu-item--loading sl-spinner {
    --indicator-color: currentColor;
    --track-width: 1px;
    position: absolute;
    font-size: 0.75em;
    top: calc(50% - 0.5em);
    left: 0.65rem;
    opacity: 1;
  }

  .menu-item .menu-item__label {
    flex: 1 1 auto;
    display: inline-block;
    text-overflow: ellipsis;
    overflow: hidden;
  }

  .menu-item .menu-item__prefix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .menu-item .menu-item__prefix::slotted(*) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .menu-item .menu-item__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .menu-item .menu-item__suffix::slotted(*) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  /* Safe triangle */
  .menu-item--submenu-expanded::after {
    content: '';
    position: fixed;
    z-index: calc(var(--sl-z-index-dropdown) - 1);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    clip-path: polygon(
      var(--safe-triangle-cursor-x, 0) var(--safe-triangle-cursor-y, 0),
      var(--safe-triangle-submenu-start-x, 0) var(--safe-triangle-submenu-start-y, 0),
      var(--safe-triangle-submenu-end-x, 0) var(--safe-triangle-submenu-end-y, 0)
    );
  }

  :host(:focus-visible) {
    outline: none;
  }

  :host(:hover:not([aria-disabled='true'], :focus-visible)) .menu-item,
  .menu-item--submenu-expanded {
    background-color: var(--sl-color-neutral-100);
    color: var(--sl-color-neutral-1000);
  }

  :host(:focus-visible) .menu-item {
    outline: none;
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
    opacity: 1;
  }

  .menu-item .menu-item__check,
  .menu-item .menu-item__chevron {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1.5em;
    visibility: hidden;
  }

  .menu-item--checked .menu-item__check,
  .menu-item--has-submenu .menu-item__chevron {
    visibility: visible;
  }

  /* Add elevation and z-index to submenus */
  sl-popup::part(popup) {
    box-shadow: var(--sl-shadow-large);
    z-index: var(--sl-z-index-dropdown);
    margin-left: var(--submenu-offset);
  }

  .menu-item--rtl sl-popup::part(popup) {
    margin-left: calc(-1 * var(--submenu-offset));
  }

  @media (forced-colors: active) {
    :host(:hover:not([aria-disabled='true'])) .menu-item,
    :host(:focus-visible) .menu-item {
      outline: dashed 1px SelectedItem;
      outline-offset: -1px;
    }
  }

  ::slotted(sl-menu) {
    max-width: var(--auto-size-available-width) !important;
    max-height: var(--auto-size-available-height) !important;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mt$1=(kt,At)=>{var Bt;const xt=kt._$AN;if(xt===void 0)return!1;for(const Nt of xt)(Bt=Nt._$AO)==null||Bt.call(Nt,At,!1),mt$1(Nt,At);return!0},_t=kt=>{let At,xt;do{if((At=kt._$AM)===void 0)break;xt=At._$AN,xt.delete(kt),kt=At}while((xt==null?void 0:xt.size)===0)},wt$1=kt=>{for(let At;At=kt._$AM;kt=At){let xt=At._$AN;if(xt===void 0)At._$AN=xt=new Set;else if(xt.has(kt))break;xt.add(kt),gt$1(At)}};function bt$1(kt){this._$AN!==void 0?(_t(this),this._$AM=kt,wt$1(this)):this._$AM=kt}function yt$1(kt,At=!1,xt=0){const Bt=this._$AH,Nt=this._$AN;if(Nt!==void 0&&Nt.size!==0)if(At)if(Array.isArray(Bt))for(let jt=xt;jt<Bt.length;jt++)mt$1(Bt[jt],!1),_t(Bt[jt]);else Bt!=null&&(mt$1(Bt,!1),_t(Bt));else mt$1(this,kt)}const gt$1=kt=>{kt.type==t$3.CHILD&&(kt._$AP??=yt$1,kt._$AQ??=bt$1)};class $t extends i$5{constructor(){super(...arguments),this._$AN=void 0}_$AT(At,xt,Bt){super._$AT(At,xt,Bt),wt$1(this),this.isConnected=At._$AU}_$AO(At,xt=!0){var Bt,Nt;At!==this.isConnected&&(this.isConnected=At,At?(Bt=this.reconnected)==null||Bt.call(this):(Nt=this.disconnected)==null||Nt.call(this)),xt&&(mt$1(this,At),_t(this))}setValue(At){if(rt$1(this.t))this.t._$AI(At,this);else{const xt=[...this.t._$AH];xt[this.i]=At,this.t._$AI(xt,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ii=()=>new Zt$1;let Zt$1=class{};const qt=new WeakMap,Kt=e$2(class extends $t{render(kt){return D$1}update(kt,[At]){var Bt;const xt=At!==this.Y;return xt&&this.Y!==void 0&&this.rt(void 0),(xt||this.lt!==this.ct)&&(this.Y=At,this.ht=(Bt=kt.options)==null?void 0:Bt.host,this.rt(this.ct=kt.element)),D$1}rt(kt){if(this.isConnected||(kt=void 0),typeof this.Y=="function"){const At=this.ht??globalThis;let xt=qt.get(At);xt===void 0&&(xt=new WeakMap,qt.set(At,xt)),xt.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),xt.set(this.Y,kt),kt!==void 0&&this.Y.call(this.ht,kt)}else this.Y.value=kt}get lt(){var kt,At;return typeof this.Y=="function"?(kt=qt.get(this.ht??globalThis))==null?void 0:kt.get(this.Y):(At=this.Y)==null?void 0:At.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});var SubmenuController=class{constructor(kt,At){this.popupRef=ii(),this.enableSubmenuTimer=-1,this.isConnected=!1,this.isPopupConnected=!1,this.skidding=0,this.submenuOpenDelay=100,this.handleMouseMove=xt=>{this.host.style.setProperty("--safe-triangle-cursor-x",`${xt.clientX}px`),this.host.style.setProperty("--safe-triangle-cursor-y",`${xt.clientY}px`)},this.handleMouseOver=()=>{this.hasSlotController.test("submenu")&&this.enableSubmenu()},this.handleKeyDown=xt=>{switch(xt.key){case"Escape":case"Tab":this.disableSubmenu();break;case"ArrowLeft":xt.target!==this.host&&(xt.preventDefault(),xt.stopPropagation(),this.host.focus(),this.disableSubmenu());break;case"ArrowRight":case"Enter":case" ":this.handleSubmenuEntry(xt);break}},this.handleClick=xt=>{var Bt;xt.target===this.host?(xt.preventDefault(),xt.stopPropagation()):xt.target instanceof Element&&(xt.target.tagName==="sl-menu-item"||(Bt=xt.target.role)!=null&&Bt.startsWith("menuitem"))&&this.disableSubmenu()},this.handleFocusOut=xt=>{xt.relatedTarget&&xt.relatedTarget instanceof Element&&this.host.contains(xt.relatedTarget)||this.disableSubmenu()},this.handlePopupMouseover=xt=>{xt.stopPropagation()},this.handlePopupReposition=()=>{const xt=this.host.renderRoot.querySelector("slot[name='submenu']"),Bt=xt==null?void 0:xt.assignedElements({flatten:!0}).filter(Vt=>Vt.localName==="sl-menu")[0],Nt=this.host.matches(":dir(rtl)");if(!Bt)return;const{left:jt,top:Ut,width:Lt,height:Ht}=Bt.getBoundingClientRect();this.host.style.setProperty("--safe-triangle-submenu-start-x",`${Nt?jt+Lt:jt}px`),this.host.style.setProperty("--safe-triangle-submenu-start-y",`${Ut}px`),this.host.style.setProperty("--safe-triangle-submenu-end-x",`${Nt?jt+Lt:jt}px`),this.host.style.setProperty("--safe-triangle-submenu-end-y",`${Ut+Ht}px`)},(this.host=kt).addController(this),this.hasSlotController=At}hostConnected(){this.hasSlotController.test("submenu")&&!this.host.disabled&&this.addListeners()}hostDisconnected(){this.removeListeners()}hostUpdated(){this.hasSlotController.test("submenu")&&!this.host.disabled?(this.addListeners(),this.updateSkidding()):this.removeListeners()}addListeners(){this.isConnected||(this.host.addEventListener("mousemove",this.handleMouseMove),this.host.addEventListener("mouseover",this.handleMouseOver),this.host.addEventListener("keydown",this.handleKeyDown),this.host.addEventListener("click",this.handleClick),this.host.addEventListener("focusout",this.handleFocusOut),this.isConnected=!0),this.isPopupConnected||this.popupRef.value&&(this.popupRef.value.addEventListener("mouseover",this.handlePopupMouseover),this.popupRef.value.addEventListener("sl-reposition",this.handlePopupReposition),this.isPopupConnected=!0)}removeListeners(){this.isConnected&&(this.host.removeEventListener("mousemove",this.handleMouseMove),this.host.removeEventListener("mouseover",this.handleMouseOver),this.host.removeEventListener("keydown",this.handleKeyDown),this.host.removeEventListener("click",this.handleClick),this.host.removeEventListener("focusout",this.handleFocusOut),this.isConnected=!1),this.isPopupConnected&&this.popupRef.value&&(this.popupRef.value.removeEventListener("mouseover",this.handlePopupMouseover),this.popupRef.value.removeEventListener("sl-reposition",this.handlePopupReposition),this.isPopupConnected=!1)}handleSubmenuEntry(kt){const At=this.host.renderRoot.querySelector("slot[name='submenu']");if(!At){console.error("Cannot activate a submenu if no corresponding menuitem can be found.",this);return}let xt=null;for(const Bt of At.assignedElements())if(xt=Bt.querySelectorAll("sl-menu-item, [role^='menuitem']"),xt.length!==0)break;if(!(!xt||xt.length===0)){xt[0].setAttribute("tabindex","0");for(let Bt=1;Bt!==xt.length;++Bt)xt[Bt].setAttribute("tabindex","-1");this.popupRef.value&&(kt.preventDefault(),kt.stopPropagation(),this.popupRef.value.active?xt[0]instanceof HTMLElement&&xt[0].focus():(this.enableSubmenu(!1),this.host.updateComplete.then(()=>{xt[0]instanceof HTMLElement&&xt[0].focus()}),this.host.requestUpdate()))}}setSubmenuState(kt){this.popupRef.value&&this.popupRef.value.active!==kt&&(this.popupRef.value.active=kt,this.host.requestUpdate())}enableSubmenu(kt=!0){kt?(window.clearTimeout(this.enableSubmenuTimer),this.enableSubmenuTimer=window.setTimeout(()=>{this.setSubmenuState(!0)},this.submenuOpenDelay)):this.setSubmenuState(!0)}disableSubmenu(){window.clearTimeout(this.enableSubmenuTimer),this.setSubmenuState(!1)}updateSkidding(){var kt;if(!((kt=this.host.parentElement)!=null&&kt.computedStyleMap))return;const At=this.host.parentElement.computedStyleMap(),Bt=["padding-top","border-top-width","margin-top"].reduce((Nt,jt)=>{var Ut;const Lt=(Ut=At.get(jt))!=null?Ut:new CSSUnitValue(0,"px"),Vt=(Lt instanceof CSSUnitValue?Lt:new CSSUnitValue(0,"px")).to("px");return Nt-Vt.value},0);this.skidding=Bt}isExpanded(){return this.popupRef.value?this.popupRef.value.active:!1}renderSubmenu(){const kt=this.host.matches(":dir(rtl)");return this.isConnected?ke$2`
      <sl-popup
        ${Kt(this.popupRef)}
        placement=${kt?"left-start":"right-start"}
        anchor="anchor"
        flip
        flip-fallback-strategy="best-fit"
        skidding="${this.skidding}"
        strategy="fixed"
        auto-size="vertical"
        auto-size-padding="10"
      >
        <slot name="submenu"></slot>
      </sl-popup>
    `:ke$2` <slot name="submenu" hidden></slot> `}},SlMenuItem=class extends ShoelaceElement{constructor(){super(...arguments),this.type="normal",this.checked=!1,this.value="",this.loading=!1,this.disabled=!1,this.hasSlotController=new HasSlotController(this,"submenu"),this.submenuController=new SubmenuController(this,this.hasSlotController),this.handleHostClick=kt=>{this.disabled&&(kt.preventDefault(),kt.stopImmediatePropagation())},this.handleMouseOver=kt=>{this.focus(),kt.stopPropagation()}}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.handleHostClick),this.addEventListener("mouseover",this.handleMouseOver)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.handleHostClick),this.removeEventListener("mouseover",this.handleMouseOver)}handleDefaultSlotChange(){const kt=this.getTextLabel();if(typeof this.cachedTextLabel>"u"){this.cachedTextLabel=kt;return}kt!==this.cachedTextLabel&&(this.cachedTextLabel=kt,this.emit("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))}handleCheckedChange(){if(this.checked&&this.type!=="checkbox"){this.checked=!1,console.error('The checked attribute can only be used on menu items with type="checkbox"',this);return}this.type==="checkbox"?this.setAttribute("aria-checked",this.checked?"true":"false"):this.removeAttribute("aria-checked")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}handleTypeChange(){this.type==="checkbox"?(this.setAttribute("role","menuitemcheckbox"),this.setAttribute("aria-checked",this.checked?"true":"false")):(this.setAttribute("role","menuitem"),this.removeAttribute("aria-checked"))}getTextLabel(){return getTextContent(this.defaultSlot)}isSubmenu(){return this.hasSlotController.test("submenu")}render(){const kt=this.matches(":dir(rtl)"),At=this.submenuController.isExpanded();return ke$2`
      <div
        id="anchor"
        part="base"
        class=${Rt$1({"menu-item":!0,"menu-item--rtl":kt,"menu-item--checked":this.checked,"menu-item--disabled":this.disabled,"menu-item--loading":this.loading,"menu-item--has-submenu":this.isSubmenu(),"menu-item--submenu-expanded":At})}
        ?aria-haspopup="${this.isSubmenu()}"
        ?aria-expanded="${!!At}"
      >
        <span part="checked-icon" class="menu-item__check">
          <sl-icon name="check" library="system" aria-hidden="true"></sl-icon>
        </span>

        <slot name="prefix" part="prefix" class="menu-item__prefix"></slot>

        <slot part="label" class="menu-item__label" @slotchange=${this.handleDefaultSlotChange}></slot>

        <slot name="suffix" part="suffix" class="menu-item__suffix"></slot>

        <span part="submenu-icon" class="menu-item__chevron">
          <sl-icon name=${kt?"chevron-left":"chevron-right"} library="system" aria-hidden="true"></sl-icon>
        </span>

        ${this.submenuController.renderSubmenu()}
        ${this.loading?ke$2` <sl-spinner part="spinner" exportparts="base:spinner__base"></sl-spinner> `:""}
      </div>
    `}};SlMenuItem.styles=[component_styles_default,menu_item_styles_default];SlMenuItem.dependencies={"sl-icon":SlIcon,"sl-popup":SlPopup,"sl-spinner":SlSpinner};__decorateClass([e$3("slot:not([name])")],SlMenuItem.prototype,"defaultSlot",2);__decorateClass([e$3(".menu-item")],SlMenuItem.prototype,"menuItem",2);__decorateClass([n$1()],SlMenuItem.prototype,"type",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlMenuItem.prototype,"checked",2);__decorateClass([n$1()],SlMenuItem.prototype,"value",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlMenuItem.prototype,"loading",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlMenuItem.prototype,"disabled",2);__decorateClass([watch("checked")],SlMenuItem.prototype,"handleCheckedChange",1);__decorateClass([watch("disabled")],SlMenuItem.prototype,"handleDisabledChange",1);__decorateClass([watch("type")],SlMenuItem.prototype,"handleTypeChange",1);SlMenuItem.define("sl-menu-item");var dropdown_styles_default=i$7`
  :host {
    display: inline-block;
  }

  .dropdown::part(popup) {
    z-index: var(--sl-z-index-dropdown);
  }

  .dropdown[data-current-placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .dropdown[data-current-placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  .dropdown[data-current-placement^='left']::part(popup) {
    transform-origin: right;
  }

  .dropdown[data-current-placement^='right']::part(popup) {
    transform-origin: left;
  }

  .dropdown__trigger {
    display: block;
  }

  .dropdown__panel {
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    box-shadow: var(--sl-shadow-large);
    border-radius: var(--sl-border-radius-medium);
    pointer-events: none;
  }

  .dropdown--open .dropdown__panel {
    display: block;
    pointer-events: all;
  }

  /* When users slot a menu, make sure it conforms to the popup's auto-size */
  ::slotted(sl-menu) {
    max-width: var(--auto-size-available-width) !important;
    max-height: var(--auto-size-available-height) !important;
  }
`,computedStyleMap=new WeakMap;function getCachedComputedStyle(kt){let At=computedStyleMap.get(kt);return At||(At=window.getComputedStyle(kt,null),computedStyleMap.set(kt,At)),At}function isVisible(kt){if(typeof kt.checkVisibility=="function")return kt.checkVisibility({checkOpacity:!1,checkVisibilityCSS:!0});const At=getCachedComputedStyle(kt);return At.visibility!=="hidden"&&At.display!=="none"}function isOverflowingAndTabbable(kt){const At=getCachedComputedStyle(kt),{overflowY:xt,overflowX:Bt}=At;return xt==="scroll"||Bt==="scroll"?!0:xt!=="auto"||Bt!=="auto"?!1:kt.scrollHeight>kt.clientHeight&&xt==="auto"||kt.scrollWidth>kt.clientWidth&&Bt==="auto"}function isTabbable(kt){const At=kt.tagName.toLowerCase(),xt=Number(kt.getAttribute("tabindex"));return kt.hasAttribute("tabindex")&&(isNaN(xt)||xt<=-1)||kt.hasAttribute("disabled")||kt.closest("[inert]")||At==="input"&&kt.getAttribute("type")==="radio"&&!kt.hasAttribute("checked")||!isVisible(kt)?!1:(At==="audio"||At==="video")&&kt.hasAttribute("controls")||kt.hasAttribute("tabindex")||kt.hasAttribute("contenteditable")&&kt.getAttribute("contenteditable")!=="false"||["button","input","select","textarea","a","audio","video","summary","iframe"].includes(At)?!0:isOverflowingAndTabbable(kt)}function getTabbableBoundary(kt){var At,xt;const Bt=getTabbableElements(kt),Nt=(At=Bt[0])!=null?At:null,jt=(xt=Bt[Bt.length-1])!=null?xt:null;return{start:Nt,end:jt}}function getSlottedChildrenOutsideRootElement(kt,At){var xt;return((xt=kt.getRootNode({composed:!0}))==null?void 0:xt.host)!==At}function getTabbableElements(kt){const At=new WeakMap,xt=[];function Bt(Nt){if(Nt instanceof Element){if(Nt.hasAttribute("inert")||Nt.closest("[inert]")||At.has(Nt))return;At.set(Nt,!0),!xt.includes(Nt)&&isTabbable(Nt)&&xt.push(Nt),Nt instanceof HTMLSlotElement&&getSlottedChildrenOutsideRootElement(Nt,kt)&&Nt.assignedElements({flatten:!0}).forEach(jt=>{Bt(jt)}),Nt.shadowRoot!==null&&Nt.shadowRoot.mode==="open"&&Bt(Nt.shadowRoot)}for(const jt of Nt.children)Bt(jt)}return Bt(kt),xt.sort((Nt,jt)=>{const Ut=Number(Nt.getAttribute("tabindex"))||0;return(Number(jt.getAttribute("tabindex"))||0)-Ut})}var SlDropdown=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.open=!1,this.placement="bottom-start",this.disabled=!1,this.stayOpenOnSelect=!1,this.distance=0,this.skidding=0,this.hoist=!1,this.sync=void 0,this.handleKeyDown=kt=>{this.open&&kt.key==="Escape"&&(kt.stopPropagation(),this.hide(),this.focusOnTrigger())},this.handleDocumentKeyDown=kt=>{var At;if(kt.key==="Escape"&&this.open&&!this.closeWatcher){kt.stopPropagation(),this.focusOnTrigger(),this.hide();return}if(kt.key==="Tab"){if(this.open&&((At=document.activeElement)==null?void 0:At.tagName.toLowerCase())==="sl-menu-item"){kt.preventDefault(),this.hide(),this.focusOnTrigger();return}setTimeout(()=>{var xt,Bt,Nt;const jt=((xt=this.containingElement)==null?void 0:xt.getRootNode())instanceof ShadowRoot?(Nt=(Bt=document.activeElement)==null?void 0:Bt.shadowRoot)==null?void 0:Nt.activeElement:document.activeElement;(!this.containingElement||(jt==null?void 0:jt.closest(this.containingElement.tagName.toLowerCase()))!==this.containingElement)&&this.hide()})}},this.handleDocumentMouseDown=kt=>{const At=kt.composedPath();this.containingElement&&!At.includes(this.containingElement)&&this.hide()},this.handlePanelSelect=kt=>{const At=kt.target;!this.stayOpenOnSelect&&At.tagName.toLowerCase()==="sl-menu"&&(this.hide(),this.focusOnTrigger())}}connectedCallback(){super.connectedCallback(),this.containingElement||(this.containingElement=this)}firstUpdated(){this.panel.hidden=!this.open,this.open&&(this.addOpenListeners(),this.popup.active=!0)}disconnectedCallback(){super.disconnectedCallback(),this.removeOpenListeners(),this.hide()}focusOnTrigger(){const kt=this.trigger.assignedElements({flatten:!0})[0];typeof(kt==null?void 0:kt.focus)=="function"&&kt.focus()}getMenu(){return this.panel.assignedElements({flatten:!0}).find(kt=>kt.tagName.toLowerCase()==="sl-menu")}handleTriggerClick(){this.open?this.hide():(this.show(),this.focusOnTrigger())}async handleTriggerKeyDown(kt){if([" ","Enter"].includes(kt.key)){kt.preventDefault(),this.handleTriggerClick();return}const At=this.getMenu();if(At){const xt=At.getAllItems(),Bt=xt[0],Nt=xt[xt.length-1];["ArrowDown","ArrowUp","Home","End"].includes(kt.key)&&(kt.preventDefault(),this.open||(this.show(),await this.updateComplete),xt.length>0&&this.updateComplete.then(()=>{(kt.key==="ArrowDown"||kt.key==="Home")&&(At.setCurrentItem(Bt),Bt.focus()),(kt.key==="ArrowUp"||kt.key==="End")&&(At.setCurrentItem(Nt),Nt.focus())}))}}handleTriggerKeyUp(kt){kt.key===" "&&kt.preventDefault()}handleTriggerSlotChange(){this.updateAccessibleTrigger()}updateAccessibleTrigger(){const At=this.trigger.assignedElements({flatten:!0}).find(Bt=>getTabbableBoundary(Bt).start);let xt;if(At){switch(At.tagName.toLowerCase()){case"sl-button":case"sl-icon-button":xt=At.button;break;default:xt=At}xt.setAttribute("aria-haspopup","true"),xt.setAttribute("aria-expanded",this.open?"true":"false")}}async show(){if(!this.open)return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,waitForEvent(this,"sl-after-hide")}reposition(){this.popup.reposition()}addOpenListeners(){var kt;this.panel.addEventListener("sl-select",this.handlePanelSelect),"CloseWatcher"in window?((kt=this.closeWatcher)==null||kt.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>{this.hide(),this.focusOnTrigger()}):this.panel.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("mousedown",this.handleDocumentMouseDown)}removeOpenListeners(){var kt;this.panel&&(this.panel.removeEventListener("sl-select",this.handlePanelSelect),this.panel.removeEventListener("keydown",this.handleKeyDown)),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("mousedown",this.handleDocumentMouseDown),(kt=this.closeWatcher)==null||kt.destroy()}async handleOpenChange(){if(this.disabled){this.open=!1;return}if(this.updateAccessibleTrigger(),this.open){this.emit("sl-show"),this.addOpenListeners(),await stopAnimations(this),this.panel.hidden=!1,this.popup.active=!0;const{keyframes:kt,options:At}=getAnimation(this,"dropdown.show",{dir:this.localize.dir()});await animateTo(this.popup.popup,kt,At),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),await stopAnimations(this);const{keyframes:kt,options:At}=getAnimation(this,"dropdown.hide",{dir:this.localize.dir()});await animateTo(this.popup.popup,kt,At),this.panel.hidden=!0,this.popup.active=!1,this.emit("sl-after-hide")}}render(){return ke$2`
      <sl-popup
        part="base"
        exportparts="popup:base__popup"
        id="dropdown"
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        strategy=${this.hoist?"fixed":"absolute"}
        flip
        shift
        auto-size="vertical"
        auto-size-padding="10"
        sync=${to(this.sync?this.sync:void 0)}
        class=${Rt$1({dropdown:!0,"dropdown--open":this.open})}
      >
        <slot
          name="trigger"
          slot="anchor"
          part="trigger"
          class="dropdown__trigger"
          @click=${this.handleTriggerClick}
          @keydown=${this.handleTriggerKeyDown}
          @keyup=${this.handleTriggerKeyUp}
          @slotchange=${this.handleTriggerSlotChange}
        ></slot>

        <div aria-hidden=${this.open?"false":"true"} aria-labelledby="dropdown">
          <slot part="panel" class="dropdown__panel"></slot>
        </div>
      </sl-popup>
    `}};SlDropdown.styles=[component_styles_default,dropdown_styles_default];SlDropdown.dependencies={"sl-popup":SlPopup};__decorateClass([e$3(".dropdown")],SlDropdown.prototype,"popup",2);__decorateClass([e$3(".dropdown__trigger")],SlDropdown.prototype,"trigger",2);__decorateClass([e$3(".dropdown__panel")],SlDropdown.prototype,"panel",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDropdown.prototype,"open",2);__decorateClass([n$1({reflect:!0})],SlDropdown.prototype,"placement",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDropdown.prototype,"disabled",2);__decorateClass([n$1({attribute:"stay-open-on-select",type:Boolean,reflect:!0})],SlDropdown.prototype,"stayOpenOnSelect",2);__decorateClass([n$1({attribute:!1})],SlDropdown.prototype,"containingElement",2);__decorateClass([n$1({type:Number})],SlDropdown.prototype,"distance",2);__decorateClass([n$1({type:Number})],SlDropdown.prototype,"skidding",2);__decorateClass([n$1({type:Boolean})],SlDropdown.prototype,"hoist",2);__decorateClass([n$1({reflect:!0})],SlDropdown.prototype,"sync",2);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlDropdown.prototype,"handleOpenChange",1);setDefaultAnimation("dropdown.show",{keyframes:[{opacity:0,scale:.9},{opacity:1,scale:1}],options:{duration:100,easing:"ease"}});setDefaultAnimation("dropdown.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.9}],options:{duration:100,easing:"ease"}});SlDropdown.define("sl-dropdown");SlIcon.define("sl-icon");var icon_button_styles_default=i$7`
  :host {
    display: inline-block;
    color: var(--sl-color-neutral-600);
  }

  .icon-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    background: none;
    border: none;
    border-radius: var(--sl-border-radius-medium);
    font-size: inherit;
    color: inherit;
    padding: var(--sl-spacing-x-small);
    cursor: pointer;
    transition: var(--sl-transition-x-fast) color;
    -webkit-appearance: none;
  }

  .icon-button:hover:not(.icon-button--disabled),
  .icon-button:focus-visible:not(.icon-button--disabled) {
    color: var(--sl-color-primary-600);
  }

  .icon-button:active:not(.icon-button--disabled) {
    color: var(--sl-color-primary-700);
  }

  .icon-button:focus {
    outline: none;
  }

  .icon-button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .icon-button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .icon-button__icon {
    pointer-events: none;
  }
`,SlIconButton=class extends ShoelaceElement{constructor(){super(...arguments),this.hasFocus=!1,this.label="",this.disabled=!1}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(kt){this.disabled&&(kt.preventDefault(),kt.stopPropagation())}click(){this.button.click()}focus(kt){this.button.focus(kt)}blur(){this.button.blur()}render(){const kt=!!this.href,At=kt?er`a`:er`button`;return ke$1`
      <${At}
        part="base"
        class=${Rt$1({"icon-button":!0,"icon-button--disabled":!kt&&this.disabled,"icon-button--focused":this.hasFocus})}
        ?disabled=${to(kt?void 0:this.disabled)}
        type=${to(kt?void 0:"button")}
        href=${to(kt?this.href:void 0)}
        target=${to(kt?this.target:void 0)}
        download=${to(kt?this.download:void 0)}
        rel=${to(kt&&this.target?"noreferrer noopener":void 0)}
        role=${to(kt?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        aria-label="${this.label}"
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @click=${this.handleClick}
      >
        <sl-icon
          class="icon-button__icon"
          name=${to(this.name)}
          library=${to(this.library)}
          src=${to(this.src)}
          aria-hidden="true"
        ></sl-icon>
      </${At}>
    `}};SlIconButton.styles=[component_styles_default,icon_button_styles_default];SlIconButton.dependencies={"sl-icon":SlIcon};__decorateClass([e$3(".icon-button")],SlIconButton.prototype,"button",2);__decorateClass([r$3()],SlIconButton.prototype,"hasFocus",2);__decorateClass([n$1()],SlIconButton.prototype,"name",2);__decorateClass([n$1()],SlIconButton.prototype,"library",2);__decorateClass([n$1()],SlIconButton.prototype,"src",2);__decorateClass([n$1()],SlIconButton.prototype,"href",2);__decorateClass([n$1()],SlIconButton.prototype,"target",2);__decorateClass([n$1()],SlIconButton.prototype,"download",2);__decorateClass([n$1()],SlIconButton.prototype,"label",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlIconButton.prototype,"disabled",2);SlIconButton.define("sl-icon-button");var radio_button_styles_default=i$7`
  ${button_styles_default}

  .button__prefix,
  .button__suffix,
  .button__label {
    display: inline-flex;
    position: relative;
    align-items: center;
  }

  /* We use a hidden input so constraint validation errors work, since they don't appear to show when used with buttons.
    We can't actually hide it, though, otherwise the messages will be suppressed by the browser. */
  .hidden-input {
    all: unset;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    outline: dotted 1px red;
    opacity: 0;
    z-index: -1;
  }
`,SlRadioButton=class extends ShoelaceElement{constructor(){super(...arguments),this.hasSlotController=new HasSlotController(this,"[default]","prefix","suffix"),this.hasFocus=!1,this.checked=!1,this.disabled=!1,this.size="medium",this.pill=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","presentation")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleClick(kt){if(this.disabled){kt.preventDefault(),kt.stopPropagation();return}this.checked=!0}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}focus(kt){this.input.focus(kt)}blur(){this.input.blur()}render(){return ke$1`
      <div part="base" role="presentation">
        <button
          part="${`button${this.checked?" button--checked":""}`}"
          role="radio"
          aria-checked="${this.checked}"
          class=${Rt$1({button:!0,"button--default":!0,"button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--checked":this.checked,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--outline":!0,"button--pill":this.pill,"button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
          aria-disabled=${this.disabled}
          type="button"
          value=${to(this.value)}
          @blur=${this.handleBlur}
          @focus=${this.handleFocus}
          @click=${this.handleClick}
        >
          <slot name="prefix" part="prefix" class="button__prefix"></slot>
          <slot part="label" class="button__label"></slot>
          <slot name="suffix" part="suffix" class="button__suffix"></slot>
        </button>
      </div>
    `}};SlRadioButton.styles=[component_styles_default,radio_button_styles_default];__decorateClass([e$3(".button")],SlRadioButton.prototype,"input",2);__decorateClass([e$3(".hidden-input")],SlRadioButton.prototype,"hiddenInput",2);__decorateClass([r$3()],SlRadioButton.prototype,"hasFocus",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlRadioButton.prototype,"checked",2);__decorateClass([n$1()],SlRadioButton.prototype,"value",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlRadioButton.prototype,"disabled",2);__decorateClass([n$1({reflect:!0})],SlRadioButton.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlRadioButton.prototype,"pill",2);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlRadioButton.prototype,"handleDisabledChange",1);SlRadioButton.define("sl-radio-button");var radio_group_styles_default=i$7`
  :host {
    display: block;
  }

  .form-control {
    position: relative;
    border: none;
    padding: 0;
    margin: 0;
  }

  .form-control__label {
    padding: 0;
  }

  .radio-group--required .radio-group__label::after {
    content: var(--sl-input-required-content);
    margin-inline-start: var(--sl-input-required-content-offset);
  }

  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
`,SlRadioGroup=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this),this.hasSlotController=new HasSlotController(this,"help-text","label"),this.customValidityMessage="",this.hasButtonGroup=!1,this.errorMessage="",this.defaultValue="",this.label="",this.helpText="",this.name="option",this.value="",this.size="medium",this.form="",this.required=!1}get validity(){const kt=this.required&&!this.value;return this.customValidityMessage!==""?customErrorValidityState:kt?valueMissingValidityState:validValidityState}get validationMessage(){const kt=this.required&&!this.value;return this.customValidityMessage!==""?this.customValidityMessage:kt?this.validationInput.validationMessage:""}connectedCallback(){super.connectedCallback(),this.defaultValue=this.value}firstUpdated(){this.formControlController.updateValidity()}getAllRadios(){return[...this.querySelectorAll("sl-radio, sl-radio-button")]}handleRadioClick(kt){const At=kt.target.closest("sl-radio, sl-radio-button"),xt=this.getAllRadios(),Bt=this.value;!At||At.disabled||(this.value=At.value,xt.forEach(Nt=>Nt.checked=Nt===At),this.value!==Bt&&(this.emit("sl-change"),this.emit("sl-input")))}handleKeyDown(kt){var At;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(kt.key))return;const xt=this.getAllRadios().filter(Lt=>!Lt.disabled),Bt=(At=xt.find(Lt=>Lt.checked))!=null?At:xt[0],Nt=kt.key===" "?0:["ArrowUp","ArrowLeft"].includes(kt.key)?-1:1,jt=this.value;let Ut=xt.indexOf(Bt)+Nt;Ut<0&&(Ut=xt.length-1),Ut>xt.length-1&&(Ut=0),this.getAllRadios().forEach(Lt=>{Lt.checked=!1,this.hasButtonGroup||Lt.setAttribute("tabindex","-1")}),this.value=xt[Ut].value,xt[Ut].checked=!0,this.hasButtonGroup?xt[Ut].shadowRoot.querySelector("button").focus():(xt[Ut].setAttribute("tabindex","0"),xt[Ut].focus()),this.value!==jt&&(this.emit("sl-change"),this.emit("sl-input")),kt.preventDefault()}handleLabelClick(){const kt=this.getAllRadios(),xt=kt.find(Bt=>Bt.checked)||kt[0];xt&&xt.focus()}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}async syncRadioElements(){var kt,At;const xt=this.getAllRadios();if(await Promise.all(xt.map(async Bt=>{await Bt.updateComplete,Bt.checked=Bt.value===this.value,Bt.size=this.size})),this.hasButtonGroup=xt.some(Bt=>Bt.tagName.toLowerCase()==="sl-radio-button"),xt.length>0&&!xt.some(Bt=>Bt.checked))if(this.hasButtonGroup){const Bt=(kt=xt[0].shadowRoot)==null?void 0:kt.querySelector("button");Bt&&Bt.setAttribute("tabindex","0")}else xt[0].setAttribute("tabindex","0");if(this.hasButtonGroup){const Bt=(At=this.shadowRoot)==null?void 0:At.querySelector("sl-button-group");Bt&&(Bt.disableRole=!0)}}syncRadios(){if(customElements.get("sl-radio")&&customElements.get("sl-radio-button")){this.syncRadioElements();return}customElements.get("sl-radio")?this.syncRadioElements():customElements.whenDefined("sl-radio").then(()=>this.syncRadios()),customElements.get("sl-radio-button")?this.syncRadioElements():customElements.whenDefined("sl-radio-button").then(()=>this.syncRadios())}updateCheckedRadio(){this.getAllRadios().forEach(At=>At.checked=At.value===this.value),this.formControlController.setValidity(this.validity.valid)}handleSizeChange(){this.syncRadios()}handleValueChange(){this.hasUpdated&&this.updateCheckedRadio()}checkValidity(){const kt=this.required&&!this.value,At=this.customValidityMessage!=="";return kt||At?(this.formControlController.emitInvalidEvent(),!1):!0}getForm(){return this.formControlController.getForm()}reportValidity(){const kt=this.validity.valid;return this.errorMessage=this.customValidityMessage||kt?"":this.validationInput.validationMessage,this.formControlController.setValidity(kt),this.validationInput.hidden=!0,clearTimeout(this.validationTimeout),kt||(this.validationInput.hidden=!1,this.validationInput.reportValidity(),this.validationTimeout=setTimeout(()=>this.validationInput.hidden=!0,1e4)),kt}setCustomValidity(kt=""){this.customValidityMessage=kt,this.errorMessage=kt,this.validationInput.setCustomValidity(kt),this.formControlController.updateValidity()}render(){const kt=this.hasSlotController.test("label"),At=this.hasSlotController.test("help-text"),xt=this.label?!0:!!kt,Bt=this.helpText?!0:!!At,Nt=ke$2`
      <slot @slotchange=${this.syncRadios} @click=${this.handleRadioClick} @keydown=${this.handleKeyDown}></slot>
    `;return ke$2`
      <fieldset
        part="form-control"
        class=${Rt$1({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--radio-group":!0,"form-control--has-label":xt,"form-control--has-help-text":Bt})}
        role="radiogroup"
        aria-labelledby="label"
        aria-describedby="help-text"
        aria-errormessage="error-message"
      >
        <label
          part="form-control-label"
          id="label"
          class="form-control__label"
          aria-hidden=${xt?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div class="visually-hidden">
            <div id="error-message" aria-live="assertive">${this.errorMessage}</div>
            <label class="radio-group__validation">
              <input
                type="text"
                class="radio-group__validation-input"
                ?required=${this.required}
                tabindex="-1"
                hidden
                @invalid=${this.handleInvalid}
              />
            </label>
          </div>

          ${this.hasButtonGroup?ke$2`
                <sl-button-group part="button-group" exportparts="base:button-group__base" role="presentation">
                  ${Nt}
                </sl-button-group>
              `:Nt}
        </div>

        <div
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${Bt?"false":"true"}
        >
          <slot name="help-text">${this.helpText}</slot>
        </div>
      </fieldset>
    `}};SlRadioGroup.styles=[component_styles_default,form_control_styles_default,radio_group_styles_default];SlRadioGroup.dependencies={"sl-button-group":SlButtonGroup};__decorateClass([e$3("slot:not([name])")],SlRadioGroup.prototype,"defaultSlot",2);__decorateClass([e$3(".radio-group__validation-input")],SlRadioGroup.prototype,"validationInput",2);__decorateClass([r$3()],SlRadioGroup.prototype,"hasButtonGroup",2);__decorateClass([r$3()],SlRadioGroup.prototype,"errorMessage",2);__decorateClass([r$3()],SlRadioGroup.prototype,"defaultValue",2);__decorateClass([n$1()],SlRadioGroup.prototype,"label",2);__decorateClass([n$1({attribute:"help-text"})],SlRadioGroup.prototype,"helpText",2);__decorateClass([n$1()],SlRadioGroup.prototype,"name",2);__decorateClass([n$1({reflect:!0})],SlRadioGroup.prototype,"value",2);__decorateClass([n$1({reflect:!0})],SlRadioGroup.prototype,"size",2);__decorateClass([n$1({reflect:!0})],SlRadioGroup.prototype,"form",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlRadioGroup.prototype,"required",2);__decorateClass([watch("size",{waitUntilFirstUpdate:!0})],SlRadioGroup.prototype,"handleSizeChange",1);__decorateClass([watch("value")],SlRadioGroup.prototype,"handleValueChange",1);SlRadioGroup.define("sl-radio-group");var input_styles_default=i$7`
  :host {
    display: block;
  }

  .input {
    flex: 1 1 auto;
    display: inline-flex;
    align-items: stretch;
    justify-content: start;
    position: relative;
    width: 100%;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    overflow: hidden;
    cursor: text;
    transition:
      var(--sl-transition-fast) color,
      var(--sl-transition-fast) border,
      var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
  }

  /* Standard inputs */
  .input--standard {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .input--standard:hover:not(.input--disabled) {
    background-color: var(--sl-input-background-color-hover);
    border-color: var(--sl-input-border-color-hover);
  }

  .input--standard.input--focused:not(.input--disabled) {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  .input--standard.input--focused:not(.input--disabled) .input__control {
    color: var(--sl-input-color-focus);
  }

  .input--standard.input--disabled {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .input--standard.input--disabled .input__control {
    color: var(--sl-input-color-disabled);
  }

  .input--standard.input--disabled .input__control::placeholder {
    color: var(--sl-input-placeholder-color-disabled);
  }

  /* Filled inputs */
  .input--filled {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .input--filled:hover:not(.input--disabled) {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .input--filled.input--focused:not(.input--disabled) {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .input--filled.input--disabled {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .input__control {
    flex: 1 1 auto;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    min-width: 0;
    height: 100%;
    color: var(--sl-input-color);
    border: none;
    background: inherit;
    box-shadow: none;
    padding: 0;
    margin: 0;
    cursor: inherit;
    -webkit-appearance: none;
  }

  .input__control::-webkit-search-decoration,
  .input__control::-webkit-search-cancel-button,
  .input__control::-webkit-search-results-button,
  .input__control::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  .input__control:-webkit-autofill,
  .input__control:-webkit-autofill:hover,
  .input__control:-webkit-autofill:focus,
  .input__control:-webkit-autofill:active {
    box-shadow: 0 0 0 var(--sl-input-height-large) var(--sl-input-background-color-hover) inset !important;
    -webkit-text-fill-color: var(--sl-color-primary-500);
    caret-color: var(--sl-input-color);
  }

  .input--filled .input__control:-webkit-autofill,
  .input--filled .input__control:-webkit-autofill:hover,
  .input--filled .input__control:-webkit-autofill:focus,
  .input--filled .input__control:-webkit-autofill:active {
    box-shadow: 0 0 0 var(--sl-input-height-large) var(--sl-input-filled-background-color) inset !important;
  }

  .input__control::placeholder {
    color: var(--sl-input-placeholder-color);
    user-select: none;
    -webkit-user-select: none;
  }

  .input:hover:not(.input--disabled) .input__control {
    color: var(--sl-input-color-hover);
  }

  .input__control:focus {
    outline: none;
  }

  .input__prefix,
  .input__suffix {
    display: inline-flex;
    flex: 0 0 auto;
    align-items: center;
    cursor: default;
  }

  .input__prefix ::slotted(sl-icon),
  .input__suffix ::slotted(sl-icon) {
    color: var(--sl-input-icon-color);
  }

  /*
   * Size modifiers
   */

  .input--small {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
    height: var(--sl-input-height-small);
  }

  .input--small .input__control {
    height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-small);
  }

  .input--small .input__clear,
  .input--small .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-small) * 2);
  }

  .input--small .input__prefix ::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-small);
  }

  .input--small .input__suffix ::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-small);
  }

  .input--medium {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
    height: var(--sl-input-height-medium);
  }

  .input--medium .input__control {
    height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-medium);
  }

  .input--medium .input__clear,
  .input--medium .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-medium) * 2);
  }

  .input--medium .input__prefix ::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-medium);
  }

  .input--medium .input__suffix ::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-medium);
  }

  .input--large {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
    height: var(--sl-input-height-large);
  }

  .input--large .input__control {
    height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    padding: 0 var(--sl-input-spacing-large);
  }

  .input--large .input__clear,
  .input--large .input__password-toggle {
    width: calc(1em + var(--sl-input-spacing-large) * 2);
  }

  .input--large .input__prefix ::slotted(*) {
    margin-inline-start: var(--sl-input-spacing-large);
  }

  .input--large .input__suffix ::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-large);
  }

  /*
   * Pill modifier
   */

  .input--pill.input--small {
    border-radius: var(--sl-input-height-small);
  }

  .input--pill.input--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .input--pill.input--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Clearable + Password Toggle
   */

  .input__clear,
  .input__password-toggle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: inherit;
    color: var(--sl-input-icon-color);
    border: none;
    background: none;
    padding: 0;
    transition: var(--sl-transition-fast) color;
    cursor: pointer;
  }

  .input__clear:hover,
  .input__password-toggle:hover {
    color: var(--sl-input-icon-color-hover);
  }

  .input__clear:focus,
  .input__password-toggle:focus {
    outline: none;
  }

  /* Don't show the browser's password toggle in Edge */
  ::-ms-reveal {
    display: none;
  }

  /* Hide the built-in number spinner */
  .input--no-spin-buttons input[type='number']::-webkit-outer-spin-button,
  .input--no-spin-buttons input[type='number']::-webkit-inner-spin-button {
    -webkit-appearance: none;
    display: none;
  }

  .input--no-spin-buttons input[type='number'] {
    -moz-appearance: textfield;
  }
`,SlInput=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new HasSlotController(this,"help-text","label"),this.localize=new LocalizeController(this),this.hasFocus=!1,this.title="",this.__numberInput=Object.assign(document.createElement("input"),{type:"number"}),this.__dateInput=Object.assign(document.createElement("input"),{type:"date"}),this.type="text",this.name="",this.value="",this.defaultValue="",this.size="medium",this.filled=!1,this.pill=!1,this.label="",this.helpText="",this.clearable=!1,this.disabled=!1,this.placeholder="",this.readonly=!1,this.passwordToggle=!1,this.passwordVisible=!1,this.noSpinButtons=!1,this.form="",this.required=!1,this.spellcheck=!0}get valueAsDate(){var kt;return this.__dateInput.type=this.type,this.__dateInput.value=this.value,((kt=this.input)==null?void 0:kt.valueAsDate)||this.__dateInput.valueAsDate}set valueAsDate(kt){this.__dateInput.type=this.type,this.__dateInput.valueAsDate=kt,this.value=this.__dateInput.value}get valueAsNumber(){var kt;return this.__numberInput.value=this.value,((kt=this.input)==null?void 0:kt.valueAsNumber)||this.__numberInput.valueAsNumber}set valueAsNumber(kt){this.__numberInput.valueAsNumber=kt,this.value=this.__numberInput.value}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleChange(){this.value=this.input.value,this.emit("sl-change")}handleClearClick(kt){kt.preventDefault(),this.value!==""&&(this.value="",this.emit("sl-clear"),this.emit("sl-input"),this.emit("sl-change")),this.input.focus()}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleInput(){this.value=this.input.value,this.formControlController.updateValidity(),this.emit("sl-input")}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}handleKeyDown(kt){const At=kt.metaKey||kt.ctrlKey||kt.shiftKey||kt.altKey;kt.key==="Enter"&&!At&&setTimeout(()=>{!kt.defaultPrevented&&!kt.isComposing&&this.formControlController.submit()})}handlePasswordToggle(){this.passwordVisible=!this.passwordVisible}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}handleStepChange(){this.input.step=String(this.step),this.formControlController.updateValidity()}async handleValueChange(){await this.updateComplete,this.formControlController.updateValidity()}focus(kt){this.input.focus(kt)}blur(){this.input.blur()}select(){this.input.select()}setSelectionRange(kt,At,xt="none"){this.input.setSelectionRange(kt,At,xt)}setRangeText(kt,At,xt,Bt="preserve"){const Nt=At??this.input.selectionStart,jt=xt??this.input.selectionEnd;this.input.setRangeText(kt,Nt,jt,Bt),this.value!==this.input.value&&(this.value=this.input.value)}showPicker(){"showPicker"in HTMLInputElement.prototype&&this.input.showPicker()}stepUp(){this.input.stepUp(),this.value!==this.input.value&&(this.value=this.input.value)}stepDown(){this.input.stepDown(),this.value!==this.input.value&&(this.value=this.input.value)}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(kt){this.input.setCustomValidity(kt),this.formControlController.updateValidity()}render(){const kt=this.hasSlotController.test("label"),At=this.hasSlotController.test("help-text"),xt=this.label?!0:!!kt,Bt=this.helpText?!0:!!At,jt=this.clearable&&!this.disabled&&!this.readonly&&(typeof this.value=="number"||this.value.length>0);return ke$2`
      <div
        part="form-control"
        class=${Rt$1({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":xt,"form-control--has-help-text":Bt})}
      >
        <label
          part="form-control-label"
          class="form-control__label"
          for="input"
          aria-hidden=${xt?"false":"true"}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div
            part="base"
            class=${Rt$1({input:!0,"input--small":this.size==="small","input--medium":this.size==="medium","input--large":this.size==="large","input--pill":this.pill,"input--standard":!this.filled,"input--filled":this.filled,"input--disabled":this.disabled,"input--focused":this.hasFocus,"input--empty":!this.value,"input--no-spin-buttons":this.noSpinButtons})}
          >
            <span part="prefix" class="input__prefix">
              <slot name="prefix"></slot>
            </span>

            <input
              part="input"
              id="input"
              class="input__control"
              type=${this.type==="password"&&this.passwordVisible?"text":this.type}
              title=${this.title}
              name=${to(this.name)}
              ?disabled=${this.disabled}
              ?readonly=${this.readonly}
              ?required=${this.required}
              placeholder=${to(this.placeholder)}
              minlength=${to(this.minlength)}
              maxlength=${to(this.maxlength)}
              min=${to(this.min)}
              max=${to(this.max)}
              step=${to(this.step)}
              .value=${Ft$1(this.value)}
              autocapitalize=${to(this.autocapitalize)}
              autocomplete=${to(this.autocomplete)}
              autocorrect=${to(this.autocorrect)}
              ?autofocus=${this.autofocus}
              spellcheck=${this.spellcheck}
              pattern=${to(this.pattern)}
              enterkeyhint=${to(this.enterkeyhint)}
              inputmode=${to(this.inputmode)}
              aria-describedby="help-text"
              @change=${this.handleChange}
              @input=${this.handleInput}
              @invalid=${this.handleInvalid}
              @keydown=${this.handleKeyDown}
              @focus=${this.handleFocus}
              @blur=${this.handleBlur}
            />

            ${jt?ke$2`
                  <button
                    part="clear-button"
                    class="input__clear"
                    type="button"
                    aria-label=${this.localize.term("clearEntry")}
                    @click=${this.handleClearClick}
                    tabindex="-1"
                  >
                    <slot name="clear-icon">
                      <sl-icon name="x-circle-fill" library="system"></sl-icon>
                    </slot>
                  </button>
                `:""}
            ${this.passwordToggle&&!this.disabled?ke$2`
                  <button
                    part="password-toggle-button"
                    class="input__password-toggle"
                    type="button"
                    aria-label=${this.localize.term(this.passwordVisible?"hidePassword":"showPassword")}
                    @click=${this.handlePasswordToggle}
                    tabindex="-1"
                  >
                    ${this.passwordVisible?ke$2`
                          <slot name="show-password-icon">
                            <sl-icon name="eye-slash" library="system"></sl-icon>
                          </slot>
                        `:ke$2`
                          <slot name="hide-password-icon">
                            <sl-icon name="eye" library="system"></sl-icon>
                          </slot>
                        `}
                  </button>
                `:""}

            <span part="suffix" class="input__suffix">
              <slot name="suffix"></slot>
            </span>
          </div>
        </div>

        <div
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${Bt?"false":"true"}
        >
          <slot name="help-text">${this.helpText}</slot>
        </div>
      </div>
    `}};SlInput.styles=[component_styles_default,form_control_styles_default,input_styles_default];SlInput.dependencies={"sl-icon":SlIcon};__decorateClass([e$3(".input__control")],SlInput.prototype,"input",2);__decorateClass([r$3()],SlInput.prototype,"hasFocus",2);__decorateClass([n$1()],SlInput.prototype,"title",2);__decorateClass([n$1({reflect:!0})],SlInput.prototype,"type",2);__decorateClass([n$1()],SlInput.prototype,"name",2);__decorateClass([n$1()],SlInput.prototype,"value",2);__decorateClass([defaultValue()],SlInput.prototype,"defaultValue",2);__decorateClass([n$1({reflect:!0})],SlInput.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlInput.prototype,"filled",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlInput.prototype,"pill",2);__decorateClass([n$1()],SlInput.prototype,"label",2);__decorateClass([n$1({attribute:"help-text"})],SlInput.prototype,"helpText",2);__decorateClass([n$1({type:Boolean})],SlInput.prototype,"clearable",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlInput.prototype,"disabled",2);__decorateClass([n$1()],SlInput.prototype,"placeholder",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlInput.prototype,"readonly",2);__decorateClass([n$1({attribute:"password-toggle",type:Boolean})],SlInput.prototype,"passwordToggle",2);__decorateClass([n$1({attribute:"password-visible",type:Boolean})],SlInput.prototype,"passwordVisible",2);__decorateClass([n$1({attribute:"no-spin-buttons",type:Boolean})],SlInput.prototype,"noSpinButtons",2);__decorateClass([n$1({reflect:!0})],SlInput.prototype,"form",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlInput.prototype,"required",2);__decorateClass([n$1()],SlInput.prototype,"pattern",2);__decorateClass([n$1({type:Number})],SlInput.prototype,"minlength",2);__decorateClass([n$1({type:Number})],SlInput.prototype,"maxlength",2);__decorateClass([n$1()],SlInput.prototype,"min",2);__decorateClass([n$1()],SlInput.prototype,"max",2);__decorateClass([n$1()],SlInput.prototype,"step",2);__decorateClass([n$1()],SlInput.prototype,"autocapitalize",2);__decorateClass([n$1()],SlInput.prototype,"autocorrect",2);__decorateClass([n$1()],SlInput.prototype,"autocomplete",2);__decorateClass([n$1({type:Boolean})],SlInput.prototype,"autofocus",2);__decorateClass([n$1()],SlInput.prototype,"enterkeyhint",2);__decorateClass([n$1({type:Boolean,converter:{fromAttribute:kt=>!(!kt||kt==="false"),toAttribute:kt=>kt?"true":"false"}})],SlInput.prototype,"spellcheck",2);__decorateClass([n$1()],SlInput.prototype,"inputmode",2);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlInput.prototype,"handleDisabledChange",1);__decorateClass([watch("step",{waitUntilFirstUpdate:!0})],SlInput.prototype,"handleStepChange",1);__decorateClass([watch("value",{waitUntilFirstUpdate:!0})],SlInput.prototype,"handleValueChange",1);SlInput.define("sl-input");var tab_styles_default=i$7`
  :host {
    display: inline-block;
  }

  .tab {
    display: inline-flex;
    align-items: center;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-semibold);
    border-radius: var(--sl-border-radius-medium);
    color: var(--sl-color-neutral-600);
    padding: var(--sl-spacing-medium) var(--sl-spacing-large);
    white-space: nowrap;
    user-select: none;
    -webkit-user-select: none;
    cursor: pointer;
    transition:
      var(--transition-speed) box-shadow,
      var(--transition-speed) color;
  }

  .tab:hover:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  :host(:focus) {
    outline: transparent;
  }

  :host(:focus-visible):not([disabled]) {
    color: var(--sl-color-primary-600);
  }

  :host(:focus-visible) {
    outline: var(--sl-focus-ring);
    outline-offset: calc(-1 * var(--sl-focus-ring-width) - var(--sl-focus-ring-offset));
  }

  .tab.tab--active:not(.tab--disabled) {
    color: var(--sl-color-primary-600);
  }

  .tab.tab--closable {
    padding-inline-end: var(--sl-spacing-small);
  }

  .tab.tab--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .tab__close-button {
    font-size: var(--sl-font-size-small);
    margin-inline-start: var(--sl-spacing-small);
  }

  .tab__close-button::part(base) {
    padding: var(--sl-spacing-3x-small);
  }

  @media (forced-colors: active) {
    .tab.tab--active:not(.tab--disabled) {
      outline: solid 1px transparent;
      outline-offset: -3px;
    }
  }
`,id$2=0,SlTab=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.attrId=++id$2,this.componentId=`sl-tab-${this.attrId}`,this.panel="",this.active=!1,this.closable=!1,this.disabled=!1,this.tabIndex=0}connectedCallback(){super.connectedCallback(),this.setAttribute("role","tab")}handleCloseClick(kt){kt.stopPropagation(),this.emit("sl-close")}handleActiveChange(){this.setAttribute("aria-selected",this.active?"true":"false")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false"),this.disabled&&!this.active?this.tabIndex=-1:this.tabIndex=0}render(){return this.id=this.id.length>0?this.id:this.componentId,ke$2`
      <div
        part="base"
        class=${Rt$1({tab:!0,"tab--active":this.active,"tab--closable":this.closable,"tab--disabled":this.disabled})}
      >
        <slot></slot>
        ${this.closable?ke$2`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                class="tab__close-button"
                @click=${this.handleCloseClick}
                tabindex="-1"
              ></sl-icon-button>
            `:""}
      </div>
    `}};SlTab.styles=[component_styles_default,tab_styles_default];SlTab.dependencies={"sl-icon-button":SlIconButton};__decorateClass([e$3(".tab")],SlTab.prototype,"tab",2);__decorateClass([n$1({reflect:!0})],SlTab.prototype,"panel",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTab.prototype,"active",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTab.prototype,"closable",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTab.prototype,"disabled",2);__decorateClass([n$1({type:Number,reflect:!0})],SlTab.prototype,"tabIndex",2);__decorateClass([watch("active")],SlTab.prototype,"handleActiveChange",1);__decorateClass([watch("disabled")],SlTab.prototype,"handleDisabledChange",1);SlTab.define("sl-tab");var tab_panel_styles_default=i$7`
  :host {
    --padding: 0;

    display: none;
  }

  :host([active]) {
    display: block;
  }

  .tab-panel {
    display: block;
    padding: var(--padding);
  }
`,id$1=0,SlTabPanel=class extends ShoelaceElement{constructor(){super(...arguments),this.attrId=++id$1,this.componentId=`sl-tab-panel-${this.attrId}`,this.name="",this.active=!1}connectedCallback(){super.connectedCallback(),this.id=this.id.length>0?this.id:this.componentId,this.setAttribute("role","tabpanel")}handleActiveChange(){this.setAttribute("aria-hidden",this.active?"false":"true")}render(){return ke$2`
      <slot
        part="base"
        class=${Rt$1({"tab-panel":!0,"tab-panel--active":this.active})}
      ></slot>
    `}};SlTabPanel.styles=[component_styles_default,tab_panel_styles_default];__decorateClass([n$1({reflect:!0})],SlTabPanel.prototype,"name",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTabPanel.prototype,"active",2);__decorateClass([watch("active")],SlTabPanel.prototype,"handleActiveChange",1);SlTabPanel.define("sl-tab-panel");var tab_group_styles_default=i$7`
  :host {
    --indicator-color: var(--sl-color-primary-600);
    --track-color: var(--sl-color-neutral-200);
    --track-width: 2px;

    display: block;
  }

  .tab-group {
    display: flex;
    border-radius: 0;
  }

  .tab-group__tabs {
    display: flex;
    position: relative;
  }

  .tab-group__indicator {
    position: absolute;
    transition:
      var(--sl-transition-fast) translate ease,
      var(--sl-transition-fast) width ease;
  }

  .tab-group--has-scroll-controls .tab-group__nav-container {
    position: relative;
    padding: 0 var(--sl-spacing-x-large);
  }

  .tab-group__body {
    display: block;
    overflow: auto;
  }

  .tab-group__scroll-button {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    bottom: 0;
    width: var(--sl-spacing-x-large);
  }

  .tab-group__scroll-button--start {
    left: 0;
  }

  .tab-group__scroll-button--end {
    right: 0;
  }

  .tab-group--rtl .tab-group__scroll-button--start {
    left: auto;
    right: 0;
  }

  .tab-group--rtl .tab-group__scroll-button--end {
    left: 0;
    right: auto;
  }

  /*
   * Top
   */

  .tab-group--top {
    flex-direction: column;
  }

  .tab-group--top .tab-group__nav-container {
    order: 1;
  }

  .tab-group--top .tab-group__nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group--top .tab-group__nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group--top .tab-group__tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-bottom: solid var(--track-width) var(--track-color);
  }

  .tab-group--top .tab-group__indicator {
    bottom: calc(-1 * var(--track-width));
    border-bottom: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--top .tab-group__body {
    order: 2;
  }

  .tab-group--top ::slotted(sl-tab-panel) {
    --padding: var(--sl-spacing-medium) 0;
  }

  /*
   * Bottom
   */

  .tab-group--bottom {
    flex-direction: column;
  }

  .tab-group--bottom .tab-group__nav-container {
    order: 2;
  }

  .tab-group--bottom .tab-group__nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group--bottom .tab-group__nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group--bottom .tab-group__tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-top: solid var(--track-width) var(--track-color);
  }

  .tab-group--bottom .tab-group__indicator {
    top: calc(-1 * var(--track-width));
    border-top: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--bottom .tab-group__body {
    order: 1;
  }

  .tab-group--bottom ::slotted(sl-tab-panel) {
    --padding: var(--sl-spacing-medium) 0;
  }

  /*
   * Start
   */

  .tab-group--start {
    flex-direction: row;
  }

  .tab-group--start .tab-group__nav-container {
    order: 1;
  }

  .tab-group--start .tab-group__tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-inline-end: solid var(--track-width) var(--track-color);
  }

  .tab-group--start .tab-group__indicator {
    right: calc(-1 * var(--track-width));
    border-right: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--start.tab-group--rtl .tab-group__indicator {
    right: auto;
    left: calc(-1 * var(--track-width));
  }

  .tab-group--start .tab-group__body {
    flex: 1 1 auto;
    order: 2;
  }

  .tab-group--start ::slotted(sl-tab-panel) {
    --padding: 0 var(--sl-spacing-medium);
  }

  /*
   * End
   */

  .tab-group--end {
    flex-direction: row;
  }

  .tab-group--end .tab-group__nav-container {
    order: 2;
  }

  .tab-group--end .tab-group__tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-left: solid var(--track-width) var(--track-color);
  }

  .tab-group--end .tab-group__indicator {
    left: calc(-1 * var(--track-width));
    border-inline-start: solid var(--track-width) var(--indicator-color);
  }

  .tab-group--end.tab-group--rtl .tab-group__indicator {
    right: calc(-1 * var(--track-width));
    left: auto;
  }

  .tab-group--end .tab-group__body {
    flex: 1 1 auto;
    order: 1;
  }

  .tab-group--end ::slotted(sl-tab-panel) {
    --padding: 0 var(--sl-spacing-medium);
  }
`;function getOffset(kt,At){return{top:Math.round(kt.getBoundingClientRect().top-At.getBoundingClientRect().top),left:Math.round(kt.getBoundingClientRect().left-At.getBoundingClientRect().left)}}var locks=new Set;function getScrollbarWidth(){const kt=document.documentElement.clientWidth;return Math.abs(window.innerWidth-kt)}function getExistingBodyPadding(){const kt=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(kt)||!kt?0:kt}function lockBodyScrolling(kt){if(locks.add(kt),!document.documentElement.classList.contains("sl-scroll-lock")){const At=getScrollbarWidth()+getExistingBodyPadding();let xt=getComputedStyle(document.documentElement).scrollbarGutter;(!xt||xt==="auto")&&(xt="stable"),At<2&&(xt=""),document.documentElement.style.setProperty("--sl-scroll-lock-gutter",xt),document.documentElement.classList.add("sl-scroll-lock"),document.documentElement.style.setProperty("--sl-scroll-lock-size",`${At}px`)}}function unlockBodyScrolling(kt){locks.delete(kt),locks.size===0&&(document.documentElement.classList.remove("sl-scroll-lock"),document.documentElement.style.removeProperty("--sl-scroll-lock-size"))}function scrollIntoView(kt,At,xt="vertical",Bt="smooth"){const Nt=getOffset(kt,At),jt=Nt.top+At.scrollTop,Ut=Nt.left+At.scrollLeft,Lt=At.scrollLeft,Ht=At.scrollLeft+At.offsetWidth,Vt=At.scrollTop,zt=At.scrollTop+At.offsetHeight;(xt==="horizontal"||xt==="both")&&(Ut<Lt?At.scrollTo({left:Ut,behavior:Bt}):Ut+kt.clientWidth>Ht&&At.scrollTo({left:Ut-At.offsetWidth+kt.clientWidth,behavior:Bt})),(xt==="vertical"||xt==="both")&&(jt<Vt?At.scrollTo({top:jt,behavior:Bt}):jt+kt.clientHeight>zt&&At.scrollTo({top:jt-At.offsetHeight+kt.clientHeight,behavior:Bt}))}var SlTabGroup=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.tabs=[],this.focusableTabs=[],this.panels=[],this.hasScrollControls=!1,this.placement="top",this.activation="auto",this.noScrollControls=!1}connectedCallback(){const kt=Promise.all([customElements.whenDefined("sl-tab"),customElements.whenDefined("sl-tab-panel")]);super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>{this.repositionIndicator(),this.updateScrollControls()}),this.mutationObserver=new MutationObserver(At=>{At.some(xt=>!["aria-labelledby","aria-controls"].includes(xt.attributeName))&&setTimeout(()=>this.setAriaLabels()),At.some(xt=>xt.attributeName==="disabled")&&this.syncTabsAndPanels()}),this.updateComplete.then(()=>{this.syncTabsAndPanels(),this.mutationObserver.observe(this,{attributes:!0,childList:!0,subtree:!0}),this.resizeObserver.observe(this.nav),kt.then(()=>{new IntersectionObserver((xt,Bt)=>{var Nt;xt[0].intersectionRatio>0&&(this.setAriaLabels(),this.setActiveTab((Nt=this.getActiveTab())!=null?Nt:this.tabs[0],{emitEvents:!1}),Bt.unobserve(xt[0].target))}).observe(this.tabGroup)})})}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver.disconnect(),this.resizeObserver.unobserve(this.nav)}getAllTabs(){return this.shadowRoot.querySelector('slot[name="nav"]').assignedElements()}getAllPanels(){return[...this.body.assignedElements()].filter(kt=>kt.tagName.toLowerCase()==="sl-tab-panel")}getActiveTab(){return this.tabs.find(kt=>kt.active)}handleClick(kt){const xt=kt.target.closest("sl-tab");(xt==null?void 0:xt.closest("sl-tab-group"))===this&&xt!==null&&this.setActiveTab(xt,{scrollBehavior:"smooth"})}handleKeyDown(kt){const xt=kt.target.closest("sl-tab");if((xt==null?void 0:xt.closest("sl-tab-group"))===this&&(["Enter"," "].includes(kt.key)&&xt!==null&&(this.setActiveTab(xt,{scrollBehavior:"smooth"}),kt.preventDefault()),["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(kt.key))){const Nt=this.tabs.find(Lt=>Lt.matches(":focus")),jt=this.matches(":dir(rtl)");let Ut=null;if((Nt==null?void 0:Nt.tagName.toLowerCase())==="sl-tab"){if(kt.key==="Home")Ut=this.focusableTabs[0];else if(kt.key==="End")Ut=this.focusableTabs[this.focusableTabs.length-1];else if(["top","bottom"].includes(this.placement)&&kt.key===(jt?"ArrowRight":"ArrowLeft")||["start","end"].includes(this.placement)&&kt.key==="ArrowUp"){const Lt=this.tabs.findIndex(Ht=>Ht===Nt);Ut=this.findNextFocusableTab(Lt,"backward")}else if(["top","bottom"].includes(this.placement)&&kt.key===(jt?"ArrowLeft":"ArrowRight")||["start","end"].includes(this.placement)&&kt.key==="ArrowDown"){const Lt=this.tabs.findIndex(Ht=>Ht===Nt);Ut=this.findNextFocusableTab(Lt,"forward")}if(!Ut)return;Ut.tabIndex=0,Ut.focus({preventScroll:!0}),this.activation==="auto"?this.setActiveTab(Ut,{scrollBehavior:"smooth"}):this.tabs.forEach(Lt=>{Lt.tabIndex=Lt===Ut?0:-1}),["top","bottom"].includes(this.placement)&&scrollIntoView(Ut,this.nav,"horizontal"),kt.preventDefault()}}}handleScrollToStart(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft+this.nav.clientWidth:this.nav.scrollLeft-this.nav.clientWidth,behavior:"smooth"})}handleScrollToEnd(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft-this.nav.clientWidth:this.nav.scrollLeft+this.nav.clientWidth,behavior:"smooth"})}setActiveTab(kt,At){if(At=__spreadValues({emitEvents:!0,scrollBehavior:"auto"},At),kt!==this.activeTab&&!kt.disabled){const xt=this.activeTab;this.activeTab=kt,this.tabs.forEach(Bt=>{Bt.active=Bt===this.activeTab,Bt.tabIndex=Bt===this.activeTab?0:-1}),this.panels.forEach(Bt=>{var Nt;return Bt.active=Bt.name===((Nt=this.activeTab)==null?void 0:Nt.panel)}),this.syncIndicator(),["top","bottom"].includes(this.placement)&&scrollIntoView(this.activeTab,this.nav,"horizontal",At.scrollBehavior),At.emitEvents&&(xt&&this.emit("sl-tab-hide",{detail:{name:xt.panel}}),this.emit("sl-tab-show",{detail:{name:this.activeTab.panel}}))}}setAriaLabels(){this.tabs.forEach(kt=>{const At=this.panels.find(xt=>xt.name===kt.panel);At&&(kt.setAttribute("aria-controls",At.getAttribute("id")),At.setAttribute("aria-labelledby",kt.getAttribute("id")))})}repositionIndicator(){const kt=this.getActiveTab();if(!kt)return;const At=kt.clientWidth,xt=kt.clientHeight,Bt=this.matches(":dir(rtl)"),Nt=this.getAllTabs(),Ut=Nt.slice(0,Nt.indexOf(kt)).reduce((Lt,Ht)=>({left:Lt.left+Ht.clientWidth,top:Lt.top+Ht.clientHeight}),{left:0,top:0});switch(this.placement){case"top":case"bottom":this.indicator.style.width=`${At}px`,this.indicator.style.height="auto",this.indicator.style.translate=Bt?`${-1*Ut.left}px`:`${Ut.left}px`;break;case"start":case"end":this.indicator.style.width="auto",this.indicator.style.height=`${xt}px`,this.indicator.style.translate=`0 ${Ut.top}px`;break}}syncTabsAndPanels(){this.tabs=this.getAllTabs(),this.focusableTabs=this.tabs.filter(kt=>!kt.disabled),this.panels=this.getAllPanels(),this.syncIndicator(),this.updateComplete.then(()=>this.updateScrollControls())}findNextFocusableTab(kt,At){let xt=null;const Bt=At==="forward"?1:-1;let Nt=kt+Bt;for(;kt<this.tabs.length;){if(xt=this.tabs[Nt]||null,xt===null){At==="forward"?xt=this.focusableTabs[0]:xt=this.focusableTabs[this.focusableTabs.length-1];break}if(!xt.disabled)break;Nt+=Bt}return xt}updateScrollControls(){this.noScrollControls?this.hasScrollControls=!1:this.hasScrollControls=["top","bottom"].includes(this.placement)&&this.nav.scrollWidth>this.nav.clientWidth+1}syncIndicator(){this.getActiveTab()?(this.indicator.style.display="block",this.repositionIndicator()):this.indicator.style.display="none"}show(kt){const At=this.tabs.find(xt=>xt.panel===kt);At&&this.setActiveTab(At,{scrollBehavior:"smooth"})}render(){const kt=this.matches(":dir(rtl)");return ke$2`
      <div
        part="base"
        class=${Rt$1({"tab-group":!0,"tab-group--top":this.placement==="top","tab-group--bottom":this.placement==="bottom","tab-group--start":this.placement==="start","tab-group--end":this.placement==="end","tab-group--rtl":this.localize.dir()==="rtl","tab-group--has-scroll-controls":this.hasScrollControls})}
        @click=${this.handleClick}
        @keydown=${this.handleKeyDown}
      >
        <div class="tab-group__nav-container" part="nav">
          ${this.hasScrollControls?ke$2`
                <sl-icon-button
                  part="scroll-button scroll-button--start"
                  exportparts="base:scroll-button__base"
                  class="tab-group__scroll-button tab-group__scroll-button--start"
                  name=${kt?"chevron-right":"chevron-left"}
                  library="system"
                  label=${this.localize.term("scrollToStart")}
                  @click=${this.handleScrollToStart}
                ></sl-icon-button>
              `:""}

          <div class="tab-group__nav">
            <div part="tabs" class="tab-group__tabs" role="tablist">
              <div part="active-tab-indicator" class="tab-group__indicator"></div>
              <slot name="nav" @slotchange=${this.syncTabsAndPanels}></slot>
            </div>
          </div>

          ${this.hasScrollControls?ke$2`
                <sl-icon-button
                  part="scroll-button scroll-button--end"
                  exportparts="base:scroll-button__base"
                  class="tab-group__scroll-button tab-group__scroll-button--end"
                  name=${kt?"chevron-left":"chevron-right"}
                  library="system"
                  label=${this.localize.term("scrollToEnd")}
                  @click=${this.handleScrollToEnd}
                ></sl-icon-button>
              `:""}
        </div>

        <slot part="body" class="tab-group__body" @slotchange=${this.syncTabsAndPanels}></slot>
      </div>
    `}};SlTabGroup.styles=[component_styles_default,tab_group_styles_default];SlTabGroup.dependencies={"sl-icon-button":SlIconButton};__decorateClass([e$3(".tab-group")],SlTabGroup.prototype,"tabGroup",2);__decorateClass([e$3(".tab-group__body")],SlTabGroup.prototype,"body",2);__decorateClass([e$3(".tab-group__nav")],SlTabGroup.prototype,"nav",2);__decorateClass([e$3(".tab-group__indicator")],SlTabGroup.prototype,"indicator",2);__decorateClass([r$3()],SlTabGroup.prototype,"hasScrollControls",2);__decorateClass([n$1()],SlTabGroup.prototype,"placement",2);__decorateClass([n$1()],SlTabGroup.prototype,"activation",2);__decorateClass([n$1({attribute:"no-scroll-controls",type:Boolean})],SlTabGroup.prototype,"noScrollControls",2);__decorateClass([watch("noScrollControls",{waitUntilFirstUpdate:!0})],SlTabGroup.prototype,"updateScrollControls",1);__decorateClass([watch("placement",{waitUntilFirstUpdate:!0})],SlTabGroup.prototype,"syncIndicator",1);SlTabGroup.define("sl-tab-group");var textarea_styles_default=i$7`
  :host {
    display: block;
  }

  .textarea {
    display: flex;
    align-items: center;
    position: relative;
    width: 100%;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    line-height: var(--sl-line-height-normal);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    transition:
      var(--sl-transition-fast) color,
      var(--sl-transition-fast) border,
      var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
    cursor: text;
  }

  /* Standard textareas */
  .textarea--standard {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .textarea--standard:hover:not(.textarea--disabled) {
    background-color: var(--sl-input-background-color-hover);
    border-color: var(--sl-input-border-color-hover);
  }
  .textarea--standard:hover:not(.textarea--disabled) .textarea__control {
    color: var(--sl-input-color-hover);
  }

  .textarea--standard.textarea--focused:not(.textarea--disabled) {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    color: var(--sl-input-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  .textarea--standard.textarea--focused:not(.textarea--disabled) .textarea__control {
    color: var(--sl-input-color-focus);
  }

  .textarea--standard.textarea--disabled {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .textarea--standard.textarea--disabled .textarea__control {
    color: var(--sl-input-color-disabled);
  }

  .textarea--standard.textarea--disabled .textarea__control::placeholder {
    color: var(--sl-input-placeholder-color-disabled);
  }

  /* Filled textareas */
  .textarea--filled {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .textarea--filled:hover:not(.textarea--disabled) {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .textarea--filled.textarea--focused:not(.textarea--disabled) {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .textarea--filled.textarea--disabled {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .textarea__control {
    flex: 1 1 auto;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    line-height: 1.4;
    color: var(--sl-input-color);
    border: none;
    background: none;
    box-shadow: none;
    cursor: inherit;
    -webkit-appearance: none;
  }

  .textarea__control::-webkit-search-decoration,
  .textarea__control::-webkit-search-cancel-button,
  .textarea__control::-webkit-search-results-button,
  .textarea__control::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  .textarea__control::placeholder {
    color: var(--sl-input-placeholder-color);
    user-select: none;
    -webkit-user-select: none;
  }

  .textarea__control:focus {
    outline: none;
  }

  /*
   * Size modifiers
   */

  .textarea--small {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
  }

  .textarea--small .textarea__control {
    padding: 0.5em var(--sl-input-spacing-small);
  }

  .textarea--medium {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
  }

  .textarea--medium .textarea__control {
    padding: 0.5em var(--sl-input-spacing-medium);
  }

  .textarea--large {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
  }

  .textarea--large .textarea__control {
    padding: 0.5em var(--sl-input-spacing-large);
  }

  /*
   * Resize types
   */

  .textarea--resize-none .textarea__control {
    resize: none;
  }

  .textarea--resize-vertical .textarea__control {
    resize: vertical;
  }

  .textarea--resize-auto .textarea__control {
    height: auto;
    resize: none;
    overflow-y: hidden;
  }
`,SlTextarea=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new HasSlotController(this,"help-text","label"),this.hasFocus=!1,this.title="",this.name="",this.value="",this.size="medium",this.filled=!1,this.label="",this.helpText="",this.placeholder="",this.rows=4,this.resize="vertical",this.disabled=!1,this.readonly=!1,this.form="",this.required=!1,this.spellcheck=!0,this.defaultValue=""}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>this.setTextareaHeight()),this.updateComplete.then(()=>{this.setTextareaHeight(),this.resizeObserver.observe(this.input)})}firstUpdated(){this.formControlController.updateValidity()}disconnectedCallback(){super.disconnectedCallback(),this.input&&this.resizeObserver.unobserve(this.input)}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleChange(){this.value=this.input.value,this.setTextareaHeight(),this.emit("sl-change")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleInput(){this.value=this.input.value,this.emit("sl-input")}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}setTextareaHeight(){this.resize==="auto"?(this.input.style.height="auto",this.input.style.height=`${this.input.scrollHeight}px`):this.input.style.height=void 0}handleDisabledChange(){this.formControlController.setValidity(this.disabled)}handleRowsChange(){this.setTextareaHeight()}async handleValueChange(){await this.updateComplete,this.formControlController.updateValidity(),this.setTextareaHeight()}focus(kt){this.input.focus(kt)}blur(){this.input.blur()}select(){this.input.select()}scrollPosition(kt){if(kt){typeof kt.top=="number"&&(this.input.scrollTop=kt.top),typeof kt.left=="number"&&(this.input.scrollLeft=kt.left);return}return{top:this.input.scrollTop,left:this.input.scrollTop}}setSelectionRange(kt,At,xt="none"){this.input.setSelectionRange(kt,At,xt)}setRangeText(kt,At,xt,Bt="preserve"){const Nt=At??this.input.selectionStart,jt=xt??this.input.selectionEnd;this.input.setRangeText(kt,Nt,jt,Bt),this.value!==this.input.value&&(this.value=this.input.value,this.setTextareaHeight())}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(kt){this.input.setCustomValidity(kt),this.formControlController.updateValidity()}render(){const kt=this.hasSlotController.test("label"),At=this.hasSlotController.test("help-text"),xt=this.label?!0:!!kt,Bt=this.helpText?!0:!!At;return ke$2`
      <div
        part="form-control"
        class=${Rt$1({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":xt,"form-control--has-help-text":Bt})}
      >
        <label
          part="form-control-label"
          class="form-control__label"
          for="input"
          aria-hidden=${xt?"false":"true"}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <div
            part="base"
            class=${Rt$1({textarea:!0,"textarea--small":this.size==="small","textarea--medium":this.size==="medium","textarea--large":this.size==="large","textarea--standard":!this.filled,"textarea--filled":this.filled,"textarea--disabled":this.disabled,"textarea--focused":this.hasFocus,"textarea--empty":!this.value,"textarea--resize-none":this.resize==="none","textarea--resize-vertical":this.resize==="vertical","textarea--resize-auto":this.resize==="auto"})}
          >
            <textarea
              part="textarea"
              id="input"
              class="textarea__control"
              title=${this.title}
              name=${to(this.name)}
              .value=${Ft$1(this.value)}
              ?disabled=${this.disabled}
              ?readonly=${this.readonly}
              ?required=${this.required}
              placeholder=${to(this.placeholder)}
              rows=${to(this.rows)}
              minlength=${to(this.minlength)}
              maxlength=${to(this.maxlength)}
              autocapitalize=${to(this.autocapitalize)}
              autocorrect=${to(this.autocorrect)}
              ?autofocus=${this.autofocus}
              spellcheck=${to(this.spellcheck)}
              enterkeyhint=${to(this.enterkeyhint)}
              inputmode=${to(this.inputmode)}
              aria-describedby="help-text"
              @change=${this.handleChange}
              @input=${this.handleInput}
              @invalid=${this.handleInvalid}
              @focus=${this.handleFocus}
              @blur=${this.handleBlur}
            ></textarea>
          </div>
        </div>

        <div
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${Bt?"false":"true"}
        >
          <slot name="help-text">${this.helpText}</slot>
        </div>
      </div>
    `}};SlTextarea.styles=[component_styles_default,form_control_styles_default,textarea_styles_default];__decorateClass([e$3(".textarea__control")],SlTextarea.prototype,"input",2);__decorateClass([r$3()],SlTextarea.prototype,"hasFocus",2);__decorateClass([n$1()],SlTextarea.prototype,"title",2);__decorateClass([n$1()],SlTextarea.prototype,"name",2);__decorateClass([n$1()],SlTextarea.prototype,"value",2);__decorateClass([n$1({reflect:!0})],SlTextarea.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTextarea.prototype,"filled",2);__decorateClass([n$1()],SlTextarea.prototype,"label",2);__decorateClass([n$1({attribute:"help-text"})],SlTextarea.prototype,"helpText",2);__decorateClass([n$1()],SlTextarea.prototype,"placeholder",2);__decorateClass([n$1({type:Number})],SlTextarea.prototype,"rows",2);__decorateClass([n$1()],SlTextarea.prototype,"resize",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTextarea.prototype,"disabled",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTextarea.prototype,"readonly",2);__decorateClass([n$1({reflect:!0})],SlTextarea.prototype,"form",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTextarea.prototype,"required",2);__decorateClass([n$1({type:Number})],SlTextarea.prototype,"minlength",2);__decorateClass([n$1({type:Number})],SlTextarea.prototype,"maxlength",2);__decorateClass([n$1()],SlTextarea.prototype,"autocapitalize",2);__decorateClass([n$1()],SlTextarea.prototype,"autocorrect",2);__decorateClass([n$1()],SlTextarea.prototype,"autocomplete",2);__decorateClass([n$1({type:Boolean})],SlTextarea.prototype,"autofocus",2);__decorateClass([n$1()],SlTextarea.prototype,"enterkeyhint",2);__decorateClass([n$1({type:Boolean,converter:{fromAttribute:kt=>!(!kt||kt==="false"),toAttribute:kt=>kt?"true":"false"}})],SlTextarea.prototype,"spellcheck",2);__decorateClass([n$1()],SlTextarea.prototype,"inputmode",2);__decorateClass([defaultValue()],SlTextarea.prototype,"defaultValue",2);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlTextarea.prototype,"handleDisabledChange",1);__decorateClass([watch("rows",{waitUntilFirstUpdate:!0})],SlTextarea.prototype,"handleRowsChange",1);__decorateClass([watch("value",{waitUntilFirstUpdate:!0})],SlTextarea.prototype,"handleValueChange",1);SlTextarea.define("sl-textarea");function clamp(kt,At,xt){const Bt=Nt=>Object.is(Nt,-0)?0:Nt;return kt<At?Bt(At):kt>xt?Bt(xt):Bt(kt)}var AutoplayController=class{constructor(kt,At){this.timerId=0,this.activeInteractions=0,this.paused=!1,this.stopped=!0,this.pause=()=>{this.activeInteractions++||(this.paused=!0,this.host.requestUpdate())},this.resume=()=>{--this.activeInteractions||(this.paused=!1,this.host.requestUpdate())},kt.addController(this),this.host=kt,this.tickCallback=At}hostConnected(){this.host.addEventListener("mouseenter",this.pause),this.host.addEventListener("mouseleave",this.resume),this.host.addEventListener("focusin",this.pause),this.host.addEventListener("focusout",this.resume),this.host.addEventListener("touchstart",this.pause,{passive:!0}),this.host.addEventListener("touchend",this.resume)}hostDisconnected(){this.stop(),this.host.removeEventListener("mouseenter",this.pause),this.host.removeEventListener("mouseleave",this.resume),this.host.removeEventListener("focusin",this.pause),this.host.removeEventListener("focusout",this.resume),this.host.removeEventListener("touchstart",this.pause),this.host.removeEventListener("touchend",this.resume)}start(kt){this.stop(),this.stopped=!1,this.timerId=window.setInterval(()=>{this.paused||this.tickCallback()},kt)}stop(){clearInterval(this.timerId),this.stopped=!0,this.host.requestUpdate()}},carousel_styles_default=i$7`
  :host {
    --slide-gap: var(--sl-spacing-medium, 1rem);
    --aspect-ratio: 16 / 9;
    --scroll-hint: 0px;

    display: flex;
  }

  .carousel {
    display: grid;
    grid-template-columns: min-content 1fr min-content;
    grid-template-rows: 1fr min-content;
    grid-template-areas:
      '. slides .'
      '. pagination .';
    gap: var(--sl-spacing-medium);
    align-items: center;
    min-height: 100%;
    min-width: 100%;
    position: relative;
  }

  .carousel__pagination {
    grid-area: pagination;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--sl-spacing-small);
  }

  .carousel__slides {
    grid-area: slides;

    display: grid;
    height: 100%;
    width: 100%;
    align-items: center;
    justify-items: center;
    overflow: auto;
    overscroll-behavior-x: contain;
    scrollbar-width: none;
    aspect-ratio: calc(var(--aspect-ratio) * var(--slides-per-page));
    border-radius: var(--sl-border-radius-small);

    --slide-size: calc((100% - (var(--slides-per-page) - 1) * var(--slide-gap)) / var(--slides-per-page));
  }

  @media (prefers-reduced-motion) {
    :where(.carousel__slides) {
      scroll-behavior: auto;
    }
  }

  .carousel__slides--horizontal {
    grid-auto-flow: column;
    grid-auto-columns: var(--slide-size);
    grid-auto-rows: 100%;
    column-gap: var(--slide-gap);
    scroll-snap-type: x mandatory;
    scroll-padding-inline: var(--scroll-hint);
    padding-inline: var(--scroll-hint);
    overflow-y: hidden;
  }

  .carousel__slides--vertical {
    grid-auto-flow: row;
    grid-auto-columns: 100%;
    grid-auto-rows: var(--slide-size);
    row-gap: var(--slide-gap);
    scroll-snap-type: y mandatory;
    scroll-padding-block: var(--scroll-hint);
    padding-block: var(--scroll-hint);
    overflow-x: hidden;
  }

  .carousel__slides--dragging {
  }

  :host([vertical]) ::slotted(sl-carousel-item) {
    height: 100%;
  }

  .carousel__slides::-webkit-scrollbar {
    display: none;
  }

  .carousel__navigation {
    grid-area: navigation;
    display: contents;
    font-size: var(--sl-font-size-x-large);
  }

  .carousel__navigation-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    background: none;
    border: none;
    border-radius: var(--sl-border-radius-small);
    font-size: inherit;
    color: var(--sl-color-neutral-600);
    padding: var(--sl-spacing-x-small);
    cursor: pointer;
    transition: var(--sl-transition-medium) color;
    appearance: none;
  }

  .carousel__navigation-button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .carousel__navigation-button--disabled::part(base) {
    pointer-events: none;
  }

  .carousel__navigation-button--previous {
    grid-column: 1;
    grid-row: 1;
  }

  .carousel__navigation-button--next {
    grid-column: 3;
    grid-row: 1;
  }

  .carousel__pagination-item {
    display: block;
    cursor: pointer;
    background: none;
    border: 0;
    border-radius: var(--sl-border-radius-circle);
    width: var(--sl-spacing-small);
    height: var(--sl-spacing-small);
    background-color: var(--sl-color-neutral-300);
    padding: 0;
    margin: 0;
  }

  .carousel__pagination-item--active {
    background-color: var(--sl-color-neutral-700);
    transform: scale(1.2);
  }

  /* Focus styles */
  .carousel__slides:focus-visible,
  .carousel__navigation-button:focus-visible,
  .carousel__pagination-item:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }
`;/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*oo$1(kt,At){if(kt!==void 0){let xt=0;for(const Bt of kt)yield At(Bt,xt++)}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*oo(kt,At,xt=1){const Bt=At===void 0?0:kt;At??=kt;for(let Nt=Bt;xt>0?Nt<At:At<Nt;Nt+=xt)yield Nt}var debounce=(kt,At)=>{let xt=0;return function(...Bt){window.clearTimeout(xt),xt=window.setTimeout(()=>{kt.call(this,...Bt)},At)}},decorate=(kt,At,xt)=>{const Bt=kt[At];kt[At]=function(...Nt){Bt.call(this,...Nt),xt.call(this,Bt,...Nt)}},isSupported="onscrollend"in window;if(!isSupported){const kt=new Set,At=new WeakMap,xt=Nt=>{for(const jt of Nt.changedTouches)kt.add(jt.identifier)},Bt=Nt=>{for(const jt of Nt.changedTouches)kt.delete(jt.identifier)};document.addEventListener("touchstart",xt,!0),document.addEventListener("touchend",Bt,!0),document.addEventListener("touchcancel",Bt,!0),decorate(EventTarget.prototype,"addEventListener",function(Nt,jt){if(jt!=="scrollend")return;const Ut=debounce(()=>{kt.size?Ut():this.dispatchEvent(new Event("scrollend"))},100);Nt.call(this,"scroll",Ut,{passive:!0}),At.set(this,Ut)}),decorate(EventTarget.prototype,"removeEventListener",function(Nt,jt){if(jt!=="scrollend")return;const Ut=At.get(this);Ut&&Nt.call(this,"scroll",Ut,{passive:!0})})}var SlCarousel=class extends ShoelaceElement{constructor(){super(...arguments),this.loop=!1,this.navigation=!1,this.pagination=!1,this.autoplay=!1,this.autoplayInterval=3e3,this.slidesPerPage=1,this.slidesPerMove=1,this.orientation="horizontal",this.mouseDragging=!1,this.activeSlide=0,this.scrolling=!1,this.dragging=!1,this.autoplayController=new AutoplayController(this,()=>this.next()),this.localize=new LocalizeController(this),this.handleMouseDrag=kt=>{this.dragging||(this.scrollContainer.style.setProperty("scroll-snap-type","none"),this.dragging=!0),this.scrollContainer.scrollBy({left:-kt.movementX,top:-kt.movementY,behavior:"instant"})},this.handleMouseDragEnd=()=>{const kt=this.scrollContainer;document.removeEventListener("pointermove",this.handleMouseDrag,{capture:!0});const At=kt.scrollLeft,xt=kt.scrollTop;kt.style.removeProperty("scroll-snap-type"),kt.style.setProperty("overflow","hidden");const Bt=kt.scrollLeft,Nt=kt.scrollTop;kt.style.removeProperty("overflow"),kt.style.setProperty("scroll-snap-type","none"),kt.scrollTo({left:At,top:xt,behavior:"instant"}),requestAnimationFrame(async()=>{(At!==Bt||xt!==Nt)&&(kt.scrollTo({left:Bt,top:Nt,behavior:prefersReducedMotion()?"auto":"smooth"}),await waitForEvent(kt,"scrollend")),kt.style.removeProperty("scroll-snap-type"),this.dragging=!1,this.handleScrollEnd()})},this.handleSlotChange=kt=>{kt.some(xt=>[...xt.addedNodes,...xt.removedNodes].some(Bt=>this.isCarouselItem(Bt)&&!Bt.hasAttribute("data-clone")))&&this.initializeSlides(),this.requestUpdate()}}connectedCallback(){super.connectedCallback(),this.setAttribute("role","region"),this.setAttribute("aria-label",this.localize.term("carousel"))}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver.disconnect()}firstUpdated(){this.initializeSlides(),this.mutationObserver=new MutationObserver(this.handleSlotChange),this.mutationObserver.observe(this,{childList:!0,subtree:!0})}willUpdate(kt){(kt.has("slidesPerMove")||kt.has("slidesPerPage"))&&(this.slidesPerMove=Math.min(this.slidesPerMove,this.slidesPerPage))}getPageCount(){const kt=this.getSlides().length,{slidesPerPage:At,slidesPerMove:xt,loop:Bt}=this,Nt=Bt?kt/xt:(kt-At)/xt+1;return Math.ceil(Nt)}getCurrentPage(){return Math.ceil(this.activeSlide/this.slidesPerMove)}canScrollNext(){return this.loop||this.getCurrentPage()<this.getPageCount()-1}canScrollPrev(){return this.loop||this.getCurrentPage()>0}getSlides({excludeClones:kt=!0}={}){return[...this.children].filter(At=>this.isCarouselItem(At)&&(!kt||!At.hasAttribute("data-clone")))}handleKeyDown(kt){if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(kt.key)){const At=kt.target,xt=this.matches(":dir(rtl)"),Bt=At.closest('[part~="pagination-item"]')!==null,Nt=kt.key==="ArrowDown"||!xt&&kt.key==="ArrowRight"||xt&&kt.key==="ArrowLeft",jt=kt.key==="ArrowUp"||!xt&&kt.key==="ArrowLeft"||xt&&kt.key==="ArrowRight";kt.preventDefault(),jt&&this.previous(),Nt&&this.next(),kt.key==="Home"&&this.goToSlide(0),kt.key==="End"&&this.goToSlide(this.getSlides().length-1),Bt&&this.updateComplete.then(()=>{var Ut;const Lt=(Ut=this.shadowRoot)==null?void 0:Ut.querySelector('[part~="pagination-item--active"]');Lt&&Lt.focus()})}}handleMouseDragStart(kt){this.mouseDragging&&kt.button===0&&(kt.preventDefault(),document.addEventListener("pointermove",this.handleMouseDrag,{capture:!0,passive:!0}),document.addEventListener("pointerup",this.handleMouseDragEnd,{capture:!0,once:!0}))}handleScroll(){this.scrolling=!0}synchronizeSlides(){const kt=new IntersectionObserver(At=>{kt.disconnect();for(const Bt of At){const Nt=Bt.target;Nt.toggleAttribute("inert",!Bt.isIntersecting),Nt.classList.toggle("--in-view",Bt.isIntersecting),Nt.setAttribute("aria-hidden",Bt.isIntersecting?"false":"true")}const xt=At.find(Bt=>Bt.isIntersecting);if(xt)if(this.loop&&xt.target.hasAttribute("data-clone")){const Bt=Number(xt.target.getAttribute("data-clone"));this.goToSlide(Bt,"instant")}else{const Nt=this.getSlides().indexOf(xt.target);this.activeSlide=Math.ceil(Nt/this.slidesPerMove)*this.slidesPerMove}},{root:this.scrollContainer,threshold:.6});this.getSlides({excludeClones:!1}).forEach(At=>{kt.observe(At)})}handleScrollEnd(){!this.scrolling||this.dragging||(this.synchronizeSlides(),this.scrolling=!1)}isCarouselItem(kt){return kt instanceof Element&&kt.tagName.toLowerCase()==="sl-carousel-item"}initializeSlides(){this.getSlides({excludeClones:!1}).forEach((kt,At)=>{kt.classList.remove("--in-view"),kt.classList.remove("--is-active"),kt.setAttribute("aria-label",this.localize.term("slideNum",At+1)),kt.hasAttribute("data-clone")&&kt.remove()}),this.updateSlidesSnap(),this.loop&&this.createClones(),this.synchronizeSlides(),this.goToSlide(this.activeSlide,"auto")}createClones(){const kt=this.getSlides(),At=this.slidesPerPage,xt=kt.slice(-At),Bt=kt.slice(0,At);xt.reverse().forEach((Nt,jt)=>{const Ut=Nt.cloneNode(!0);Ut.setAttribute("data-clone",String(kt.length-jt-1)),this.prepend(Ut)}),Bt.forEach((Nt,jt)=>{const Ut=Nt.cloneNode(!0);Ut.setAttribute("data-clone",String(jt)),this.append(Ut)})}handelSlideChange(){const kt=this.getSlides();kt.forEach((At,xt)=>{At.classList.toggle("--is-active",xt===this.activeSlide)}),this.hasUpdated&&this.emit("sl-slide-change",{detail:{index:this.activeSlide,slide:kt[this.activeSlide]}})}updateSlidesSnap(){const kt=this.getSlides(),At=this.slidesPerMove;kt.forEach((xt,Bt)=>{(Bt+At)%At===0?xt.style.removeProperty("scroll-snap-align"):xt.style.setProperty("scroll-snap-align","none")})}handleAutoplayChange(){this.autoplayController.stop(),this.autoplay&&this.autoplayController.start(this.autoplayInterval)}previous(kt="smooth"){this.goToSlide(this.activeSlide-this.slidesPerMove,kt)}next(kt="smooth"){this.goToSlide(this.activeSlide+this.slidesPerMove,kt)}goToSlide(kt,At="smooth"){const{slidesPerPage:xt,loop:Bt}=this,Nt=this.getSlides(),jt=this.getSlides({excludeClones:!1});if(!Nt.length)return;const Ut=Bt?(kt+Nt.length)%Nt.length:clamp(kt,0,Nt.length-1);this.activeSlide=Ut;const Lt=clamp(kt+(Bt?xt:0),0,jt.length-1),Ht=jt[Lt];this.scrollToSlide(Ht,prefersReducedMotion()?"auto":At)}scrollToSlide(kt,At="smooth"){const xt=this.scrollContainer,Bt=xt.getBoundingClientRect(),Nt=kt.getBoundingClientRect(),jt=Nt.left-Bt.left,Ut=Nt.top-Bt.top;xt.scrollTo({left:jt+xt.scrollLeft,top:Ut+xt.scrollTop,behavior:At})}render(){const{slidesPerMove:kt,scrolling:At}=this,xt=this.getPageCount(),Bt=this.getCurrentPage(),Nt=this.canScrollPrev(),jt=this.canScrollNext(),Ut=this.matches(":dir(ltr)");return ke$2`
      <div part="base" class="carousel">
        <div
          id="scroll-container"
          part="scroll-container"
          class="${Rt$1({carousel__slides:!0,"carousel__slides--horizontal":this.orientation==="horizontal","carousel__slides--vertical":this.orientation==="vertical","carousel__slides--dragging":this.dragging})}"
          style="--slides-per-page: ${this.slidesPerPage};"
          aria-busy="${At?"true":"false"}"
          aria-atomic="true"
          tabindex="0"
          @keydown=${this.handleKeyDown}
          @mousedown="${this.handleMouseDragStart}"
          @scroll="${this.handleScroll}"
          @scrollend=${this.handleScrollEnd}
        >
          <slot></slot>
        </div>

        ${this.navigation?ke$2`
              <div part="navigation" class="carousel__navigation">
                <button
                  part="navigation-button navigation-button--previous"
                  class="${Rt$1({"carousel__navigation-button":!0,"carousel__navigation-button--previous":!0,"carousel__navigation-button--disabled":!Nt})}"
                  aria-label="${this.localize.term("previousSlide")}"
                  aria-controls="scroll-container"
                  aria-disabled="${Nt?"false":"true"}"
                  @click=${Nt?()=>this.previous():null}
                >
                  <slot name="previous-icon">
                    <sl-icon library="system" name="${Ut?"chevron-left":"chevron-right"}"></sl-icon>
                  </slot>
                </button>

                <button
                  part="navigation-button navigation-button--next"
                  class=${Rt$1({"carousel__navigation-button":!0,"carousel__navigation-button--next":!0,"carousel__navigation-button--disabled":!jt})}
                  aria-label="${this.localize.term("nextSlide")}"
                  aria-controls="scroll-container"
                  aria-disabled="${jt?"false":"true"}"
                  @click=${jt?()=>this.next():null}
                >
                  <slot name="next-icon">
                    <sl-icon library="system" name="${Ut?"chevron-right":"chevron-left"}"></sl-icon>
                  </slot>
                </button>
              </div>
            `:""}
        ${this.pagination?ke$2`
              <div part="pagination" role="tablist" class="carousel__pagination" aria-controls="scroll-container">
                ${oo$1(oo(xt),Lt=>{const Ht=Lt===Bt;return ke$2`
                    <button
                      part="pagination-item ${Ht?"pagination-item--active":""}"
                      class="${Rt$1({"carousel__pagination-item":!0,"carousel__pagination-item--active":Ht})}"
                      role="tab"
                      aria-selected="${Ht?"true":"false"}"
                      aria-label="${this.localize.term("goToSlide",Lt+1,xt)}"
                      tabindex=${Ht?"0":"-1"}
                      @click=${()=>this.goToSlide(Lt*kt)}
                      @keydown=${this.handleKeyDown}
                    ></button>
                  `})}
              </div>
            `:""}
      </div>
    `}};SlCarousel.styles=[component_styles_default,carousel_styles_default];SlCarousel.dependencies={"sl-icon":SlIcon};__decorateClass([n$1({type:Boolean,reflect:!0})],SlCarousel.prototype,"loop",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCarousel.prototype,"navigation",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCarousel.prototype,"pagination",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlCarousel.prototype,"autoplay",2);__decorateClass([n$1({type:Number,attribute:"autoplay-interval"})],SlCarousel.prototype,"autoplayInterval",2);__decorateClass([n$1({type:Number,attribute:"slides-per-page"})],SlCarousel.prototype,"slidesPerPage",2);__decorateClass([n$1({type:Number,attribute:"slides-per-move"})],SlCarousel.prototype,"slidesPerMove",2);__decorateClass([n$1()],SlCarousel.prototype,"orientation",2);__decorateClass([n$1({type:Boolean,reflect:!0,attribute:"mouse-dragging"})],SlCarousel.prototype,"mouseDragging",2);__decorateClass([e$3(".carousel__slides")],SlCarousel.prototype,"scrollContainer",2);__decorateClass([e$3(".carousel__pagination")],SlCarousel.prototype,"paginationContainer",2);__decorateClass([r$3()],SlCarousel.prototype,"activeSlide",2);__decorateClass([r$3()],SlCarousel.prototype,"scrolling",2);__decorateClass([r$3()],SlCarousel.prototype,"dragging",2);__decorateClass([t$4({passive:!0})],SlCarousel.prototype,"handleScroll",1);__decorateClass([watch("loop",{waitUntilFirstUpdate:!0}),watch("slidesPerPage",{waitUntilFirstUpdate:!0})],SlCarousel.prototype,"initializeSlides",1);__decorateClass([watch("activeSlide")],SlCarousel.prototype,"handelSlideChange",1);__decorateClass([watch("slidesPerMove")],SlCarousel.prototype,"updateSlidesSnap",1);__decorateClass([watch("autoplay")],SlCarousel.prototype,"handleAutoplayChange",1);SlCarousel.define("sl-carousel");var details_styles_default=i$7`
  :host {
    display: block;
  }

  .details {
    border: solid 1px var(--sl-color-neutral-200);
    border-radius: var(--sl-border-radius-medium);
    background-color: var(--sl-color-neutral-0);
    overflow-anchor: none;
  }

  .details--disabled {
    opacity: 0.5;
  }

  .details__header {
    display: flex;
    align-items: center;
    border-radius: inherit;
    padding: var(--sl-spacing-medium);
    user-select: none;
    -webkit-user-select: none;
    cursor: pointer;
  }

  .details__header::-webkit-details-marker {
    display: none;
  }

  .details__header:focus {
    outline: none;
  }

  .details__header:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: calc(1px + var(--sl-focus-ring-offset));
  }

  .details--disabled .details__header {
    cursor: not-allowed;
  }

  .details--disabled .details__header:focus-visible {
    outline: none;
    box-shadow: none;
  }

  .details__summary {
    flex: 1 1 auto;
    display: flex;
    align-items: center;
  }

  .details__summary-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    transition: var(--sl-transition-medium) rotate ease;
  }

  .details--open .details__summary-icon {
    rotate: 90deg;
  }

  .details--open.details--rtl .details__summary-icon {
    rotate: -90deg;
  }

  .details--open slot[name='expand-icon'],
  .details:not(.details--open) slot[name='collapse-icon'] {
    display: none;
  }

  .details__body {
    overflow: hidden;
  }

  .details__content {
    display: block;
    padding: var(--sl-spacing-medium);
  }
`,SlDetails=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.open=!1,this.disabled=!1}firstUpdated(){this.body.style.height=this.open?"auto":"0",this.open&&(this.details.open=!0),this.detailsObserver=new MutationObserver(kt=>{for(const At of kt)At.type==="attributes"&&At.attributeName==="open"&&(this.details.open?this.show():this.hide())}),this.detailsObserver.observe(this.details,{attributes:!0})}disconnectedCallback(){super.disconnectedCallback(),this.detailsObserver.disconnect()}handleSummaryClick(kt){kt.preventDefault(),this.disabled||(this.open?this.hide():this.show(),this.header.focus())}handleSummaryKeyDown(kt){(kt.key==="Enter"||kt.key===" ")&&(kt.preventDefault(),this.open?this.hide():this.show()),(kt.key==="ArrowUp"||kt.key==="ArrowLeft")&&(kt.preventDefault(),this.hide()),(kt.key==="ArrowDown"||kt.key==="ArrowRight")&&(kt.preventDefault(),this.show())}async handleOpenChange(){if(this.open){if(this.details.open=!0,this.emit("sl-show",{cancelable:!0}).defaultPrevented){this.open=!1,this.details.open=!1;return}await stopAnimations(this.body);const{keyframes:At,options:xt}=getAnimation(this,"details.show",{dir:this.localize.dir()});await animateTo(this.body,shimKeyframesHeightAuto(At,this.body.scrollHeight),xt),this.body.style.height="auto",this.emit("sl-after-show")}else{if(this.emit("sl-hide",{cancelable:!0}).defaultPrevented){this.details.open=!0,this.open=!0;return}await stopAnimations(this.body);const{keyframes:At,options:xt}=getAnimation(this,"details.hide",{dir:this.localize.dir()});await animateTo(this.body,shimKeyframesHeightAuto(At,this.body.scrollHeight),xt),this.body.style.height="auto",this.details.open=!1,this.emit("sl-after-hide")}}async show(){if(!(this.open||this.disabled))return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(!(!this.open||this.disabled))return this.open=!1,waitForEvent(this,"sl-after-hide")}render(){const kt=this.matches(":dir(rtl)");return ke$2`
      <details
        part="base"
        class=${Rt$1({details:!0,"details--open":this.open,"details--disabled":this.disabled,"details--rtl":kt})}
      >
        <summary
          part="header"
          id="header"
          class="details__header"
          role="button"
          aria-expanded=${this.open?"true":"false"}
          aria-controls="content"
          aria-disabled=${this.disabled?"true":"false"}
          tabindex=${this.disabled?"-1":"0"}
          @click=${this.handleSummaryClick}
          @keydown=${this.handleSummaryKeyDown}
        >
          <slot name="summary" part="summary" class="details__summary">${this.summary}</slot>

          <span part="summary-icon" class="details__summary-icon">
            <slot name="expand-icon">
              <sl-icon library="system" name=${kt?"chevron-left":"chevron-right"}></sl-icon>
            </slot>
            <slot name="collapse-icon">
              <sl-icon library="system" name=${kt?"chevron-left":"chevron-right"}></sl-icon>
            </slot>
          </span>
        </summary>

        <div class="details__body" role="region" aria-labelledby="header">
          <slot part="content" id="content" class="details__content"></slot>
        </div>
      </details>
    `}};SlDetails.styles=[component_styles_default,details_styles_default];SlDetails.dependencies={"sl-icon":SlIcon};__decorateClass([e$3(".details")],SlDetails.prototype,"details",2);__decorateClass([e$3(".details__header")],SlDetails.prototype,"header",2);__decorateClass([e$3(".details__body")],SlDetails.prototype,"body",2);__decorateClass([e$3(".details__expand-icon-slot")],SlDetails.prototype,"expandIconSlot",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDetails.prototype,"open",2);__decorateClass([n$1()],SlDetails.prototype,"summary",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDetails.prototype,"disabled",2);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlDetails.prototype,"handleOpenChange",1);setDefaultAnimation("details.show",{keyframes:[{height:"0",opacity:"0"},{height:"auto",opacity:"1"}],options:{duration:250,easing:"linear"}});setDefaultAnimation("details.hide",{keyframes:[{height:"auto",opacity:"1"},{height:"0",opacity:"0"}],options:{duration:250,easing:"linear"}});SlDetails.define("sl-details");var drawer_styles_default=i$7`
  :host {
    --size: 25rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .drawer {
    top: 0;
    inset-inline-start: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
  }

  .drawer--contained {
    position: absolute;
    z-index: initial;
  }

  .drawer--fixed {
    position: fixed;
    z-index: var(--sl-z-index-drawer);
  }

  .drawer__panel {
    position: absolute;
    display: flex;
    flex-direction: column;
    z-index: 2;
    max-width: 100%;
    max-height: 100%;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-large);
    overflow: auto;
    pointer-events: all;
  }

  .drawer__panel:focus {
    outline: none;
  }

  .drawer--top .drawer__panel {
    top: 0;
    inset-inline-end: auto;
    bottom: auto;
    inset-inline-start: 0;
    width: 100%;
    height: var(--size);
  }

  .drawer--end .drawer__panel {
    top: 0;
    inset-inline-end: 0;
    bottom: auto;
    inset-inline-start: auto;
    width: var(--size);
    height: 100%;
  }

  .drawer--bottom .drawer__panel {
    top: auto;
    inset-inline-end: auto;
    bottom: 0;
    inset-inline-start: 0;
    width: 100%;
    height: var(--size);
  }

  .drawer--start .drawer__panel {
    top: 0;
    inset-inline-end: auto;
    bottom: auto;
    inset-inline-start: 0;
    width: var(--size);
    height: 100%;
  }

  .drawer__header {
    display: flex;
  }

  .drawer__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .drawer__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .drawer__header-actions sl-icon-button,
  .drawer__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .drawer__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .drawer__footer {
    text-align: right;
    padding: var(--footer-spacing);
  }

  .drawer__footer ::slotted(sl-button:not(:last-of-type)) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .drawer:not(.drawer--has-footer) .drawer__footer {
    display: none;
  }

  .drawer__overlay {
    display: block;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
    pointer-events: all;
  }

  .drawer--contained .drawer__overlay {
    display: none;
  }

  @media (forced-colors: active) {
    .drawer__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`;function*activeElements(kt=document.activeElement){kt!=null&&(yield kt,"shadowRoot"in kt&&kt.shadowRoot&&kt.shadowRoot.mode!=="closed"&&(yield*__yieldStar(activeElements(kt.shadowRoot.activeElement))))}function getDeepestActiveElement(){return[...activeElements()].pop()}var activeModals=[],Modal=class{constructor(kt){this.tabDirection="forward",this.handleFocusIn=()=>{this.isActive()&&this.checkFocus()},this.handleKeyDown=At=>{var xt;if(At.key!=="Tab"||this.isExternalActivated||!this.isActive())return;const Bt=getDeepestActiveElement();if(this.previousFocus=Bt,this.previousFocus&&this.possiblyHasTabbableChildren(this.previousFocus))return;At.shiftKey?this.tabDirection="backward":this.tabDirection="forward";const Nt=getTabbableElements(this.element);let jt=Nt.findIndex(Lt=>Lt===Bt);this.previousFocus=this.currentFocus;const Ut=this.tabDirection==="forward"?1:-1;for(;;){jt+Ut>=Nt.length?jt=0:jt+Ut<0?jt=Nt.length-1:jt+=Ut,this.previousFocus=this.currentFocus;const Lt=Nt[jt];if(this.tabDirection==="backward"&&this.previousFocus&&this.possiblyHasTabbableChildren(this.previousFocus)||Lt&&this.possiblyHasTabbableChildren(Lt))return;At.preventDefault(),this.currentFocus=Lt,(xt=this.currentFocus)==null||xt.focus({preventScroll:!1});const Ht=[...activeElements()];if(Ht.includes(this.currentFocus)||!Ht.includes(this.previousFocus))break}setTimeout(()=>this.checkFocus())},this.handleKeyUp=()=>{this.tabDirection="forward"},this.element=kt,this.elementsWithTabbableControls=["iframe"]}activate(){activeModals.push(this.element),document.addEventListener("focusin",this.handleFocusIn),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}deactivate(){activeModals=activeModals.filter(kt=>kt!==this.element),this.currentFocus=null,document.removeEventListener("focusin",this.handleFocusIn),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}isActive(){return activeModals[activeModals.length-1]===this.element}activateExternal(){this.isExternalActivated=!0}deactivateExternal(){this.isExternalActivated=!1}checkFocus(){if(this.isActive()&&!this.isExternalActivated){const kt=getTabbableElements(this.element);if(!this.element.matches(":focus-within")){const At=kt[0],xt=kt[kt.length-1],Bt=this.tabDirection==="forward"?At:xt;typeof(Bt==null?void 0:Bt.focus)=="function"&&(this.currentFocus=Bt,Bt.focus({preventScroll:!1}))}}}possiblyHasTabbableChildren(kt){return this.elementsWithTabbableControls.includes(kt.tagName.toLowerCase())||kt.hasAttribute("controls")}};function uppercaseFirstLetter(kt){return kt.charAt(0).toUpperCase()+kt.slice(1)}var SlDrawer=class extends ShoelaceElement{constructor(){super(...arguments),this.hasSlotController=new HasSlotController(this,"footer"),this.localize=new LocalizeController(this),this.modal=new Modal(this),this.open=!1,this.label="",this.placement="end",this.contained=!1,this.noHeader=!1,this.handleDocumentKeyDown=kt=>{this.contained||kt.key==="Escape"&&this.modal.isActive()&&this.open&&(kt.stopImmediatePropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.drawer.hidden=!this.open,this.open&&(this.addOpenListeners(),this.contained||(this.modal.activate(),lockBodyScrolling(this)))}disconnectedCallback(){var kt;super.disconnectedCallback(),unlockBodyScrolling(this),(kt=this.closeWatcher)==null||kt.destroy()}requestClose(kt){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:kt}}).defaultPrevented){const xt=getAnimation(this,"drawer.denyClose",{dir:this.localize.dir()});animateTo(this.panel,xt.keyframes,xt.options);return}this.hide()}addOpenListeners(){var kt;"CloseWatcher"in window?((kt=this.closeWatcher)==null||kt.destroy(),this.contained||(this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>this.requestClose("keyboard"))):document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){var kt;document.removeEventListener("keydown",this.handleDocumentKeyDown),(kt=this.closeWatcher)==null||kt.destroy()}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.contained||(this.modal.activate(),lockBodyScrolling(this));const kt=this.querySelector("[autofocus]");kt&&kt.removeAttribute("autofocus"),await Promise.all([stopAnimations(this.drawer),stopAnimations(this.overlay)]),this.drawer.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(kt?kt.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),kt&&kt.setAttribute("autofocus","")});const At=getAnimation(this,`drawer.show${uppercaseFirstLetter(this.placement)}`,{dir:this.localize.dir()}),xt=getAnimation(this,"drawer.overlay.show",{dir:this.localize.dir()});await Promise.all([animateTo(this.panel,At.keyframes,At.options),animateTo(this.overlay,xt.keyframes,xt.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.contained||(this.modal.deactivate(),unlockBodyScrolling(this)),await Promise.all([stopAnimations(this.drawer),stopAnimations(this.overlay)]);const kt=getAnimation(this,`drawer.hide${uppercaseFirstLetter(this.placement)}`,{dir:this.localize.dir()}),At=getAnimation(this,"drawer.overlay.hide",{dir:this.localize.dir()});await Promise.all([animateTo(this.overlay,At.keyframes,At.options).then(()=>{this.overlay.hidden=!0}),animateTo(this.panel,kt.keyframes,kt.options).then(()=>{this.panel.hidden=!0})]),this.drawer.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1;const xt=this.originalTrigger;typeof(xt==null?void 0:xt.focus)=="function"&&setTimeout(()=>xt.focus()),this.emit("sl-after-hide")}}handleNoModalChange(){this.open&&!this.contained&&(this.modal.activate(),lockBodyScrolling(this)),this.open&&this.contained&&(this.modal.deactivate(),unlockBodyScrolling(this))}async show(){if(!this.open)return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,waitForEvent(this,"sl-after-hide")}render(){return ke$2`
      <div
        part="base"
        class=${Rt$1({drawer:!0,"drawer--open":this.open,"drawer--top":this.placement==="top","drawer--end":this.placement==="end","drawer--bottom":this.placement==="bottom","drawer--start":this.placement==="start","drawer--contained":this.contained,"drawer--fixed":!this.contained,"drawer--rtl":this.localize.dir()==="rtl","drawer--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="drawer__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="drawer__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${to(this.noHeader?this.label:void 0)}
          aria-labelledby=${to(this.noHeader?void 0:"title")}
          tabindex="0"
        >
          ${this.noHeader?"":ke$2`
                <header part="header" class="drawer__header">
                  <h2 part="title" class="drawer__title" id="title">
                    <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                    <slot name="label"> ${this.label.length>0?this.label:"\uFEFF"} </slot>
                  </h2>
                  <div part="header-actions" class="drawer__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="drawer__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click=${()=>this.requestClose("close-button")}
                    ></sl-icon-button>
                  </div>
                </header>
              `}

          <slot part="body" class="drawer__body"></slot>

          <footer part="footer" class="drawer__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};SlDrawer.styles=[component_styles_default,drawer_styles_default];SlDrawer.dependencies={"sl-icon-button":SlIconButton};__decorateClass([e$3(".drawer")],SlDrawer.prototype,"drawer",2);__decorateClass([e$3(".drawer__panel")],SlDrawer.prototype,"panel",2);__decorateClass([e$3(".drawer__overlay")],SlDrawer.prototype,"overlay",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDrawer.prototype,"open",2);__decorateClass([n$1({reflect:!0})],SlDrawer.prototype,"label",2);__decorateClass([n$1({reflect:!0})],SlDrawer.prototype,"placement",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDrawer.prototype,"contained",2);__decorateClass([n$1({attribute:"no-header",type:Boolean,reflect:!0})],SlDrawer.prototype,"noHeader",2);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlDrawer.prototype,"handleOpenChange",1);__decorateClass([watch("contained",{waitUntilFirstUpdate:!0})],SlDrawer.prototype,"handleNoModalChange",1);setDefaultAnimation("drawer.showTop",{keyframes:[{opacity:0,translate:"0 -100%"},{opacity:1,translate:"0 0"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.hideTop",{keyframes:[{opacity:1,translate:"0 0"},{opacity:0,translate:"0 -100%"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.showEnd",{keyframes:[{opacity:0,translate:"100%"},{opacity:1,translate:"0"}],rtlKeyframes:[{opacity:0,translate:"-100%"},{opacity:1,translate:"0"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.hideEnd",{keyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"100%"}],rtlKeyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"-100%"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.showBottom",{keyframes:[{opacity:0,translate:"0 100%"},{opacity:1,translate:"0 0"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.hideBottom",{keyframes:[{opacity:1,translate:"0 0"},{opacity:0,translate:"0 100%"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.showStart",{keyframes:[{opacity:0,translate:"-100%"},{opacity:1,translate:"0"}],rtlKeyframes:[{opacity:0,translate:"100%"},{opacity:1,translate:"0"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.hideStart",{keyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"-100%"}],rtlKeyframes:[{opacity:1,translate:"0"},{opacity:0,translate:"100%"}],options:{duration:250,easing:"ease"}});setDefaultAnimation("drawer.denyClose",{keyframes:[{scale:1},{scale:1.01},{scale:1}],options:{duration:250}});setDefaultAnimation("drawer.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});setDefaultAnimation("drawer.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});SlDrawer.define("sl-drawer");var dialog_styles_default=i$7`
  :host {
    --width: 31rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .dialog {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: var(--sl-z-index-dialog);
  }

  .dialog__panel {
    display: flex;
    flex-direction: column;
    z-index: 2;
    width: var(--width);
    max-width: calc(100% - var(--sl-spacing-2x-large));
    max-height: calc(100% - var(--sl-spacing-2x-large));
    background-color: var(--sl-panel-background-color);
    border-radius: var(--sl-border-radius-medium);
    box-shadow: var(--sl-shadow-x-large);
  }

  .dialog__panel:focus {
    outline: none;
  }

  /* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
  @media screen and (max-width: 420px) {
    .dialog__panel {
      max-height: 80vh;
    }
  }

  .dialog--open .dialog__panel {
    display: flex;
    opacity: 1;
  }

  .dialog__header {
    flex: 0 0 auto;
    display: flex;
  }

  .dialog__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .dialog__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .dialog__header-actions sl-icon-button,
  .dialog__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .dialog__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .dialog__footer {
    flex: 0 0 auto;
    text-align: right;
    padding: var(--footer-spacing);
  }

  .dialog__footer ::slotted(sl-button:not(:first-of-type)) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  .dialog:not(.dialog--has-footer) .dialog__footer {
    display: none;
  }

  .dialog__overlay {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
  }

  @media (forced-colors: active) {
    .dialog__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`,SlDialog=class extends ShoelaceElement{constructor(){super(...arguments),this.hasSlotController=new HasSlotController(this,"footer"),this.localize=new LocalizeController(this),this.modal=new Modal(this),this.open=!1,this.label="",this.noHeader=!1,this.handleDocumentKeyDown=kt=>{kt.key==="Escape"&&this.modal.isActive()&&this.open&&(kt.stopPropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.dialog.hidden=!this.open,this.open&&(this.addOpenListeners(),this.modal.activate(),lockBodyScrolling(this))}disconnectedCallback(){var kt;super.disconnectedCallback(),this.modal.deactivate(),unlockBodyScrolling(this),(kt=this.closeWatcher)==null||kt.destroy()}requestClose(kt){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:kt}}).defaultPrevented){const xt=getAnimation(this,"dialog.denyClose",{dir:this.localize.dir()});animateTo(this.panel,xt.keyframes,xt.options);return}this.hide()}addOpenListeners(){var kt;"CloseWatcher"in window?((kt=this.closeWatcher)==null||kt.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>this.requestClose("keyboard")):document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){var kt;(kt=this.closeWatcher)==null||kt.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown)}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.modal.activate(),lockBodyScrolling(this);const kt=this.querySelector("[autofocus]");kt&&kt.removeAttribute("autofocus"),await Promise.all([stopAnimations(this.dialog),stopAnimations(this.overlay)]),this.dialog.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(kt?kt.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),kt&&kt.setAttribute("autofocus","")});const At=getAnimation(this,"dialog.show",{dir:this.localize.dir()}),xt=getAnimation(this,"dialog.overlay.show",{dir:this.localize.dir()});await Promise.all([animateTo(this.panel,At.keyframes,At.options),animateTo(this.overlay,xt.keyframes,xt.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.modal.deactivate(),await Promise.all([stopAnimations(this.dialog),stopAnimations(this.overlay)]);const kt=getAnimation(this,"dialog.hide",{dir:this.localize.dir()}),At=getAnimation(this,"dialog.overlay.hide",{dir:this.localize.dir()});await Promise.all([animateTo(this.overlay,At.keyframes,At.options).then(()=>{this.overlay.hidden=!0}),animateTo(this.panel,kt.keyframes,kt.options).then(()=>{this.panel.hidden=!0})]),this.dialog.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1,unlockBodyScrolling(this);const xt=this.originalTrigger;typeof(xt==null?void 0:xt.focus)=="function"&&setTimeout(()=>xt.focus()),this.emit("sl-after-hide")}}async show(){if(!this.open)return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,waitForEvent(this,"sl-after-hide")}render(){return ke$2`
      <div
        part="base"
        class=${Rt$1({dialog:!0,"dialog--open":this.open,"dialog--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="dialog__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="dialog__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${to(this.noHeader?this.label:void 0)}
          aria-labelledby=${to(this.noHeader?void 0:"title")}
          tabindex="-1"
        >
          ${this.noHeader?"":ke$2`
                <header part="header" class="dialog__header">
                  <h2 part="title" class="dialog__title" id="title">
                    <slot name="label"> ${this.label.length>0?this.label:"\uFEFF"} </slot>
                  </h2>
                  <div part="header-actions" class="dialog__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="dialog__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click="${()=>this.requestClose("close-button")}"
                    ></sl-icon-button>
                  </div>
                </header>
              `}
          ${""}
          <div part="body" class="dialog__body" tabindex="-1"><slot></slot></div>

          <footer part="footer" class="dialog__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};SlDialog.styles=[component_styles_default,dialog_styles_default];SlDialog.dependencies={"sl-icon-button":SlIconButton};__decorateClass([e$3(".dialog")],SlDialog.prototype,"dialog",2);__decorateClass([e$3(".dialog__panel")],SlDialog.prototype,"panel",2);__decorateClass([e$3(".dialog__overlay")],SlDialog.prototype,"overlay",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlDialog.prototype,"open",2);__decorateClass([n$1({reflect:!0})],SlDialog.prototype,"label",2);__decorateClass([n$1({attribute:"no-header",type:Boolean,reflect:!0})],SlDialog.prototype,"noHeader",2);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlDialog.prototype,"handleOpenChange",1);setDefaultAnimation("dialog.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});setDefaultAnimation("dialog.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});setDefaultAnimation("dialog.denyClose",{keyframes:[{scale:1},{scale:1.02},{scale:1}],options:{duration:250}});setDefaultAnimation("dialog.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});setDefaultAnimation("dialog.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});SlDialog.define("sl-dialog");var alert_styles_default=i$7`
  :host {
    display: contents;

    /* For better DX, we'll reset the margin here so the base part can inherit it */
    margin: 0;
  }

  .alert {
    position: relative;
    display: flex;
    align-items: stretch;
    background-color: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-top-width: calc(var(--sl-panel-border-width) * 3);
    border-radius: var(--sl-border-radius-medium);
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-normal);
    line-height: 1.6;
    color: var(--sl-color-neutral-700);
    margin: inherit;
  }

  .alert:not(.alert--has-icon) .alert__icon,
  .alert:not(.alert--closable) .alert__close-button {
    display: none;
  }

  .alert__icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-large);
    padding-inline-start: var(--sl-spacing-large);
  }

  .alert--primary {
    border-top-color: var(--sl-color-primary-600);
  }

  .alert--primary .alert__icon {
    color: var(--sl-color-primary-600);
  }

  .alert--success {
    border-top-color: var(--sl-color-success-600);
  }

  .alert--success .alert__icon {
    color: var(--sl-color-success-600);
  }

  .alert--neutral {
    border-top-color: var(--sl-color-neutral-600);
  }

  .alert--neutral .alert__icon {
    color: var(--sl-color-neutral-600);
  }

  .alert--warning {
    border-top-color: var(--sl-color-warning-600);
  }

  .alert--warning .alert__icon {
    color: var(--sl-color-warning-600);
  }

  .alert--danger {
    border-top-color: var(--sl-color-danger-600);
  }

  .alert--danger .alert__icon {
    color: var(--sl-color-danger-600);
  }

  .alert__message {
    flex: 1 1 auto;
    display: block;
    padding: var(--sl-spacing-large);
    overflow: hidden;
  }

  .alert__close-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
    padding-inline-end: var(--sl-spacing-medium);
  }
`,toastStack=Object.assign(document.createElement("div"),{className:"sl-toast-stack"}),SlAlert=class extends ShoelaceElement{constructor(){super(...arguments),this.hasSlotController=new HasSlotController(this,"icon","suffix"),this.localize=new LocalizeController(this),this.open=!1,this.closable=!1,this.variant="primary",this.duration=1/0}firstUpdated(){this.base.hidden=!this.open}restartAutoHide(){clearTimeout(this.autoHideTimeout),this.open&&this.duration<1/0&&(this.autoHideTimeout=window.setTimeout(()=>this.hide(),this.duration))}handleCloseClick(){this.hide()}handleMouseMove(){this.restartAutoHide()}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.duration<1/0&&this.restartAutoHide(),await stopAnimations(this.base),this.base.hidden=!1;const{keyframes:kt,options:At}=getAnimation(this,"alert.show",{dir:this.localize.dir()});await animateTo(this.base,kt,At),this.emit("sl-after-show")}else{this.emit("sl-hide"),clearTimeout(this.autoHideTimeout),await stopAnimations(this.base);const{keyframes:kt,options:At}=getAnimation(this,"alert.hide",{dir:this.localize.dir()});await animateTo(this.base,kt,At),this.base.hidden=!0,this.emit("sl-after-hide")}}handleDurationChange(){this.restartAutoHide()}async show(){if(!this.open)return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,waitForEvent(this,"sl-after-hide")}async toast(){return new Promise(kt=>{toastStack.parentElement===null&&document.body.append(toastStack),toastStack.appendChild(this),requestAnimationFrame(()=>{this.clientWidth,this.show()}),this.addEventListener("sl-after-hide",()=>{toastStack.removeChild(this),kt(),toastStack.querySelector("sl-alert")===null&&toastStack.remove()},{once:!0})})}render(){return ke$2`
      <div
        part="base"
        class=${Rt$1({alert:!0,"alert--open":this.open,"alert--closable":this.closable,"alert--has-icon":this.hasSlotController.test("icon"),"alert--primary":this.variant==="primary","alert--success":this.variant==="success","alert--neutral":this.variant==="neutral","alert--warning":this.variant==="warning","alert--danger":this.variant==="danger"})}
        role="alert"
        aria-hidden=${this.open?"false":"true"}
        @mousemove=${this.handleMouseMove}
      >
        <div part="icon" class="alert__icon">
          <slot name="icon"></slot>
        </div>

        <div part="message" class="alert__message" aria-live="polite">
          <slot></slot>
        </div>

        ${this.closable?ke$2`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                class="alert__close-button"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                @click=${this.handleCloseClick}
              ></sl-icon-button>
            `:""}
      </div>
    `}};SlAlert.styles=[component_styles_default,alert_styles_default];SlAlert.dependencies={"sl-icon-button":SlIconButton};__decorateClass([e$3('[part~="base"]')],SlAlert.prototype,"base",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlAlert.prototype,"open",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlAlert.prototype,"closable",2);__decorateClass([n$1({reflect:!0})],SlAlert.prototype,"variant",2);__decorateClass([n$1({type:Number})],SlAlert.prototype,"duration",2);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlAlert.prototype,"handleOpenChange",1);__decorateClass([watch("duration")],SlAlert.prototype,"handleDurationChange",1);setDefaultAnimation("alert.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});setDefaultAnimation("alert.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});SlAlert.define("sl-alert");var skeleton_styles_default=i$7`
  :host {
    --border-radius: var(--sl-border-radius-pill);
    --color: var(--sl-color-neutral-200);
    --sheen-color: var(--sl-color-neutral-300);

    display: block;
    position: relative;
  }

  .skeleton {
    display: flex;
    width: 100%;
    height: 100%;
    min-height: 1rem;
  }

  .skeleton__indicator {
    flex: 1 1 auto;
    background: var(--color);
    border-radius: var(--border-radius);
  }

  .skeleton--sheen .skeleton__indicator {
    background: linear-gradient(270deg, var(--sheen-color), var(--color), var(--color), var(--sheen-color));
    background-size: 400% 100%;
    animation: sheen 8s ease-in-out infinite;
  }

  .skeleton--pulse .skeleton__indicator {
    animation: pulse 2s ease-in-out 0.5s infinite;
  }

  /* Forced colors mode */
  @media (forced-colors: active) {
    :host {
      --color: GrayText;
    }
  }

  @keyframes sheen {
    0% {
      background-position: 200% 0;
    }
    to {
      background-position: -200% 0;
    }
  }

  @keyframes pulse {
    0% {
      opacity: 1;
    }
    50% {
      opacity: 0.4;
    }
    100% {
      opacity: 1;
    }
  }
`,SlSkeleton=class extends ShoelaceElement{constructor(){super(...arguments),this.effect="none"}render(){return ke$2`
      <div
        part="base"
        class=${Rt$1({skeleton:!0,"skeleton--pulse":this.effect==="pulse","skeleton--sheen":this.effect==="sheen"})}
      >
        <div part="indicator" class="skeleton__indicator"></div>
      </div>
    `}};SlSkeleton.styles=[component_styles_default,skeleton_styles_default];__decorateClass([n$1()],SlSkeleton.prototype,"effect",2);SlSkeleton.define("sl-skeleton");SlPopup.define("sl-popup");SlTooltip.define("sl-tooltip");SlSpinner.define("sl-spinner");var split_panel_styles_default=i$7`
  :host {
    --divider-width: 4px;
    --divider-hit-area: 12px;
    --min: 0%;
    --max: 100%;

    display: grid;
  }

  .start,
  .end {
    overflow: hidden;
  }

  .divider {
    flex: 0 0 var(--divider-width);
    display: flex;
    position: relative;
    align-items: center;
    justify-content: center;
    background-color: var(--sl-color-neutral-200);
    color: var(--sl-color-neutral-900);
    z-index: 1;
  }

  .divider:focus {
    outline: none;
  }

  :host(:not([disabled])) .divider:focus-visible {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  :host([disabled]) .divider {
    cursor: not-allowed;
  }

  /* Horizontal */
  :host(:not([vertical], [disabled])) .divider {
    cursor: col-resize;
  }

  :host(:not([vertical])) .divider::after {
    display: flex;
    content: '';
    position: absolute;
    height: 100%;
    left: calc(var(--divider-hit-area) / -2 + var(--divider-width) / 2);
    width: var(--divider-hit-area);
  }

  /* Vertical */
  :host([vertical]) {
    flex-direction: column;
  }

  :host([vertical]:not([disabled])) .divider {
    cursor: row-resize;
  }

  :host([vertical]) .divider::after {
    content: '';
    position: absolute;
    width: 100%;
    top: calc(var(--divider-hit-area) / -2 + var(--divider-width) / 2);
    height: var(--divider-hit-area);
  }

  @media (forced-colors: active) {
    .divider {
      outline: solid 1px transparent;
    }
  }
`;function drag(kt,At){function xt(Nt){const jt=kt.getBoundingClientRect(),Ut=kt.ownerDocument.defaultView,Lt=jt.left+Ut.scrollX,Ht=jt.top+Ut.scrollY,Vt=Nt.pageX-Lt,zt=Nt.pageY-Ht;At!=null&&At.onMove&&At.onMove(Vt,zt)}function Bt(){document.removeEventListener("pointermove",xt),document.removeEventListener("pointerup",Bt),At!=null&&At.onStop&&At.onStop()}document.addEventListener("pointermove",xt,{passive:!0}),document.addEventListener("pointerup",Bt),(At==null?void 0:At.initialEvent)instanceof PointerEvent&&xt(At.initialEvent)}var SlSplitPanel=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.position=50,this.vertical=!1,this.disabled=!1,this.snapThreshold=12}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(kt=>this.handleResize(kt)),this.updateComplete.then(()=>this.resizeObserver.observe(this)),this.detectSize(),this.cachedPositionInPixels=this.percentageToPixels(this.position)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver.unobserve(this)}detectSize(){const{width:kt,height:At}=this.getBoundingClientRect();this.size=this.vertical?At:kt}percentageToPixels(kt){return this.size*(kt/100)}pixelsToPercentage(kt){return kt/this.size*100}handleDrag(kt){const At=this.matches(":dir(rtl)");this.disabled||(kt.cancelable&&kt.preventDefault(),drag(this,{onMove:(xt,Bt)=>{let Nt=this.vertical?Bt:xt;this.primary==="end"&&(Nt=this.size-Nt),this.snap&&this.snap.split(" ").forEach(Ut=>{let Lt;Ut.endsWith("%")?Lt=this.size*(parseFloat(Ut)/100):Lt=parseFloat(Ut),At&&!this.vertical&&(Lt=this.size-Lt),Nt>=Lt-this.snapThreshold&&Nt<=Lt+this.snapThreshold&&(Nt=Lt)}),this.position=clamp(this.pixelsToPercentage(Nt),0,100)},initialEvent:kt}))}handleKeyDown(kt){if(!this.disabled&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(kt.key)){let At=this.position;const xt=(kt.shiftKey?10:1)*(this.primary==="end"?-1:1);kt.preventDefault(),(kt.key==="ArrowLeft"&&!this.vertical||kt.key==="ArrowUp"&&this.vertical)&&(At-=xt),(kt.key==="ArrowRight"&&!this.vertical||kt.key==="ArrowDown"&&this.vertical)&&(At+=xt),kt.key==="Home"&&(At=this.primary==="end"?100:0),kt.key==="End"&&(At=this.primary==="end"?0:100),this.position=clamp(At,0,100)}}handleResize(kt){const{width:At,height:xt}=kt[0].contentRect;this.size=this.vertical?xt:At,(isNaN(this.cachedPositionInPixels)||this.position===1/0)&&(this.cachedPositionInPixels=Number(this.getAttribute("position-in-pixels")),this.positionInPixels=Number(this.getAttribute("position-in-pixels")),this.position=this.pixelsToPercentage(this.positionInPixels)),this.primary&&(this.position=this.pixelsToPercentage(this.cachedPositionInPixels))}handlePositionChange(){this.cachedPositionInPixels=this.percentageToPixels(this.position),this.positionInPixels=this.percentageToPixels(this.position),this.emit("sl-reposition")}handlePositionInPixelsChange(){this.position=this.pixelsToPercentage(this.positionInPixels)}handleVerticalChange(){this.detectSize()}render(){const kt=this.vertical?"gridTemplateRows":"gridTemplateColumns",At=this.vertical?"gridTemplateColumns":"gridTemplateRows",xt=this.matches(":dir(rtl)"),Bt=`
      clamp(
        0%,
        clamp(
          var(--min),
          ${this.position}% - var(--divider-width) / 2,
          var(--max)
        ),
        calc(100% - var(--divider-width))
      )
    `,Nt="auto";return this.primary==="end"?xt&&!this.vertical?this.style[kt]=`${Bt} var(--divider-width) ${Nt}`:this.style[kt]=`${Nt} var(--divider-width) ${Bt}`:xt&&!this.vertical?this.style[kt]=`${Nt} var(--divider-width) ${Bt}`:this.style[kt]=`${Bt} var(--divider-width) ${Nt}`,this.style[At]="",ke$2`
      <slot name="start" part="panel start" class="start"></slot>

      <div
        part="divider"
        class="divider"
        tabindex=${to(this.disabled?void 0:"0")}
        role="separator"
        aria-valuenow=${this.position}
        aria-valuemin="0"
        aria-valuemax="100"
        aria-label=${this.localize.term("resize")}
        @keydown=${this.handleKeyDown}
        @mousedown=${this.handleDrag}
        @touchstart=${this.handleDrag}
      >
        <slot name="divider"></slot>
      </div>

      <slot name="end" part="panel end" class="end"></slot>
    `}};SlSplitPanel.styles=[component_styles_default,split_panel_styles_default];__decorateClass([e$3(".divider")],SlSplitPanel.prototype,"divider",2);__decorateClass([n$1({type:Number,reflect:!0})],SlSplitPanel.prototype,"position",2);__decorateClass([n$1({attribute:"position-in-pixels",type:Number})],SlSplitPanel.prototype,"positionInPixels",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSplitPanel.prototype,"vertical",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSplitPanel.prototype,"disabled",2);__decorateClass([n$1()],SlSplitPanel.prototype,"primary",2);__decorateClass([n$1()],SlSplitPanel.prototype,"snap",2);__decorateClass([n$1({type:Number,attribute:"snap-threshold"})],SlSplitPanel.prototype,"snapThreshold",2);__decorateClass([watch("position")],SlSplitPanel.prototype,"handlePositionChange",1);__decorateClass([watch("positionInPixels")],SlSplitPanel.prototype,"handlePositionInPixelsChange",1);__decorateClass([watch("vertical")],SlSplitPanel.prototype,"handleVerticalChange",1);SlSplitPanel.define("sl-split-panel");var switch_styles_default=i$7`
  :host {
    display: inline-block;
  }

  :host([size='small']) {
    --height: var(--sl-toggle-size-small);
    --thumb-size: calc(var(--sl-toggle-size-small) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-small);
  }

  :host([size='medium']) {
    --height: var(--sl-toggle-size-medium);
    --thumb-size: calc(var(--sl-toggle-size-medium) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-medium);
  }

  :host([size='large']) {
    --height: var(--sl-toggle-size-large);
    --thumb-size: calc(var(--sl-toggle-size-large) + 4px);
    --width: calc(var(--height) * 2);

    font-size: var(--sl-input-font-size-large);
  }

  .switch {
    position: relative;
    display: inline-flex;
    align-items: center;
    font-family: var(--sl-input-font-family);
    font-size: inherit;
    font-weight: var(--sl-input-font-weight);
    color: var(--sl-input-label-color);
    vertical-align: middle;
    cursor: pointer;
  }

  .switch__control {
    flex: 0 0 auto;
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--width);
    height: var(--height);
    background-color: var(--sl-color-neutral-400);
    border: solid var(--sl-input-border-width) var(--sl-color-neutral-400);
    border-radius: var(--height);
    transition:
      var(--sl-transition-fast) border-color,
      var(--sl-transition-fast) background-color;
  }

  .switch__control .switch__thumb {
    width: var(--thumb-size);
    height: var(--thumb-size);
    background-color: var(--sl-color-neutral-0);
    border-radius: 50%;
    border: solid var(--sl-input-border-width) var(--sl-color-neutral-400);
    translate: calc((var(--width) - var(--height)) / -2);
    transition:
      var(--sl-transition-fast) translate ease,
      var(--sl-transition-fast) background-color,
      var(--sl-transition-fast) border-color,
      var(--sl-transition-fast) box-shadow;
  }

  .switch__input {
    position: absolute;
    opacity: 0;
    padding: 0;
    margin: 0;
    pointer-events: none;
  }

  /* Hover */
  .switch:not(.switch--checked):not(.switch--disabled) .switch__control:hover {
    background-color: var(--sl-color-neutral-400);
    border-color: var(--sl-color-neutral-400);
  }

  .switch:not(.switch--checked):not(.switch--disabled) .switch__control:hover .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-neutral-400);
  }

  /* Focus */
  .switch:not(.switch--checked):not(.switch--disabled) .switch__input:focus-visible ~ .switch__control {
    background-color: var(--sl-color-neutral-400);
    border-color: var(--sl-color-neutral-400);
  }

  .switch:not(.switch--checked):not(.switch--disabled) .switch__input:focus-visible ~ .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Checked */
  .switch--checked .switch__control {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch--checked .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    translate: calc((var(--width) - var(--height)) / 2);
  }

  /* Checked + hover */
  .switch.switch--checked:not(.switch--disabled) .switch__control:hover {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch.switch--checked:not(.switch--disabled) .switch__control:hover .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
  }

  /* Checked + focus */
  .switch.switch--checked:not(.switch--disabled) .switch__input:focus-visible ~ .switch__control {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
  }

  .switch.switch--checked:not(.switch--disabled) .switch__input:focus-visible ~ .switch__control .switch__thumb {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-color-primary-600);
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  /* Disabled */
  .switch--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .switch__label {
    display: inline-block;
    line-height: var(--height);
    margin-inline-start: 0.5em;
    user-select: none;
    -webkit-user-select: none;
  }

  :host([required]) .switch__label::after {
    content: var(--sl-input-required-content);
    color: var(--sl-input-required-content-color);
    margin-inline-start: var(--sl-input-required-content-offset);
  }

  @media (forced-colors: active) {
    .switch.switch--checked:not(.switch--disabled) .switch__control:hover .switch__thumb,
    .switch--checked .switch__control .switch__thumb {
      background-color: ButtonText;
    }
  }
`,SlSwitch=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this,{value:kt=>kt.checked?kt.value||"on":void 0,defaultValue:kt=>kt.defaultChecked,setValue:(kt,At)=>kt.checked=At}),this.hasSlotController=new HasSlotController(this,"help-text"),this.hasFocus=!1,this.title="",this.name="",this.size="medium",this.disabled=!1,this.checked=!1,this.defaultChecked=!1,this.form="",this.required=!1,this.helpText=""}get validity(){return this.input.validity}get validationMessage(){return this.input.validationMessage}firstUpdated(){this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleInput(){this.emit("sl-input")}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}handleClick(){this.checked=!this.checked,this.emit("sl-change")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleKeyDown(kt){kt.key==="ArrowLeft"&&(kt.preventDefault(),this.checked=!1,this.emit("sl-change"),this.emit("sl-input")),kt.key==="ArrowRight"&&(kt.preventDefault(),this.checked=!0,this.emit("sl-change"),this.emit("sl-input"))}handleCheckedChange(){this.input.checked=this.checked,this.formControlController.updateValidity()}handleDisabledChange(){this.formControlController.setValidity(!0)}click(){this.input.click()}focus(kt){this.input.focus(kt)}blur(){this.input.blur()}checkValidity(){return this.input.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.input.reportValidity()}setCustomValidity(kt){this.input.setCustomValidity(kt),this.formControlController.updateValidity()}render(){const kt=this.hasSlotController.test("help-text"),At=this.helpText?!0:!!kt;return ke$2`
      <div
        class=${Rt$1({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-help-text":At})}
      >
        <label
          part="base"
          class=${Rt$1({switch:!0,"switch--checked":this.checked,"switch--disabled":this.disabled,"switch--focused":this.hasFocus,"switch--small":this.size==="small","switch--medium":this.size==="medium","switch--large":this.size==="large"})}
        >
          <input
            class="switch__input"
            type="checkbox"
            title=${this.title}
            name=${this.name}
            value=${to(this.value)}
            .checked=${Ft$1(this.checked)}
            .disabled=${this.disabled}
            .required=${this.required}
            role="switch"
            aria-checked=${this.checked?"true":"false"}
            aria-describedby="help-text"
            @click=${this.handleClick}
            @input=${this.handleInput}
            @invalid=${this.handleInvalid}
            @blur=${this.handleBlur}
            @focus=${this.handleFocus}
            @keydown=${this.handleKeyDown}
          />

          <span part="control" class="switch__control">
            <span part="thumb" class="switch__thumb"></span>
          </span>

          <div part="label" class="switch__label">
            <slot></slot>
          </div>
        </label>

        <div
          aria-hidden=${At?"false":"true"}
          class="form-control__help-text"
          id="help-text"
          part="form-control-help-text"
        >
          <slot name="help-text">${this.helpText}</slot>
        </div>
      </div>
    `}};SlSwitch.styles=[component_styles_default,form_control_styles_default,switch_styles_default];__decorateClass([e$3('input[type="checkbox"]')],SlSwitch.prototype,"input",2);__decorateClass([r$3()],SlSwitch.prototype,"hasFocus",2);__decorateClass([n$1()],SlSwitch.prototype,"title",2);__decorateClass([n$1()],SlSwitch.prototype,"name",2);__decorateClass([n$1()],SlSwitch.prototype,"value",2);__decorateClass([n$1({reflect:!0})],SlSwitch.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSwitch.prototype,"disabled",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSwitch.prototype,"checked",2);__decorateClass([defaultValue("checked")],SlSwitch.prototype,"defaultChecked",2);__decorateClass([n$1({reflect:!0})],SlSwitch.prototype,"form",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSwitch.prototype,"required",2);__decorateClass([n$1({attribute:"help-text"})],SlSwitch.prototype,"helpText",2);__decorateClass([watch("checked",{waitUntilFirstUpdate:!0})],SlSwitch.prototype,"handleCheckedChange",1);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlSwitch.prototype,"handleDisabledChange",1);SlSwitch.define("sl-switch");var qr_code_styles_default=i$7`
  :host {
    display: inline-block;
  }
`;/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ee$1="important",ie$1=" !"+ee$1,se$1=e$2(class extends i$5{constructor(kt){var At;if(super(kt),kt.type!==t$3.ATTRIBUTE||kt.name!=="style"||((At=kt.strings)==null?void 0:At.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(kt){return Object.keys(kt).reduce((At,xt)=>{const Bt=kt[xt];return Bt==null?At:At+`${xt=xt.includes("-")?xt:xt.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${Bt};`},"")}update(kt,[At]){const{style:xt}=kt.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(At)),this.render(At);for(const Bt of this.ft)At[Bt]==null&&(this.ft.delete(Bt),Bt.includes("-")?xt.removeProperty(Bt):xt[Bt]=null);for(const Bt in At){const Nt=At[Bt];if(Nt!=null){this.ft.add(Bt);const jt=typeof Nt=="string"&&Nt.endsWith(ie$1);Bt.includes("-")||jt?xt.setProperty(Bt,jt?Nt.slice(0,-11):Nt,jt?ee$1:""):xt[Bt]=Nt}}return R$2}});let G$4=null,H$1=class{};H$1.render=function(kt,At){G$4(kt,At)};self.QrCreator=H$1;(function(kt){function At(Lt,Ht,Vt,zt){var Wt={},Jt=kt(Vt,Ht);Jt.u(Lt),Jt.J(),zt=zt||0;var Qt=Jt.h(),Xt=Jt.h()+2*zt;return Wt.text=Lt,Wt.level=Ht,Wt.version=Vt,Wt.O=Xt,Wt.a=function(tr,rr){return tr-=zt,rr-=zt,0>tr||tr>=Qt||0>rr||rr>=Qt?!1:Jt.a(tr,rr)},Wt}function xt(Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr){function nr(ar,ir,lr,yr,Sr,Ar,Dr){ar?(Lt.lineTo(ir+Ar,lr+Dr),Lt.arcTo(ir,lr,yr,Sr,Jt)):Lt.lineTo(ir,lr)}Qt?Lt.moveTo(Ht+Jt,Vt):Lt.moveTo(Ht,Vt),nr(Xt,zt,Vt,zt,Wt,-Jt,0),nr(tr,zt,Wt,Ht,Wt,0,-Jt),nr(rr,Ht,Wt,Ht,Vt,Jt,0),nr(Qt,Ht,Vt,zt,Vt,0,Jt)}function Bt(Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr){function nr(ar,ir,lr,yr){Lt.moveTo(ar+lr,ir),Lt.lineTo(ar,ir),Lt.lineTo(ar,ir+yr),Lt.arcTo(ar,ir,ar+lr,ir,Jt)}Qt&&nr(Ht,Vt,Jt,Jt),Xt&&nr(zt,Vt,-Jt,Jt),tr&&nr(zt,Wt,-Jt,-Jt),rr&&nr(Ht,Wt,Jt,-Jt)}function Nt(Lt,Ht){var Vt=Ht.fill;if(typeof Vt=="string")Lt.fillStyle=Vt;else{var zt=Vt.type,Wt=Vt.colorStops;if(Vt=Vt.position.map(Qt=>Math.round(Qt*Ht.size)),zt==="linear-gradient")var Jt=Lt.createLinearGradient.apply(Lt,Vt);else if(zt==="radial-gradient")Jt=Lt.createRadialGradient.apply(Lt,Vt);else throw Error("Unsupported fill");Wt.forEach(([Qt,Xt])=>{Jt.addColorStop(Qt,Xt)}),Lt.fillStyle=Jt}}function jt(Lt,Ht){e:{var Vt=Ht.text,zt=Ht.v,Wt=Ht.N,Jt=Ht.K,Qt=Ht.P;for(Wt=Math.max(1,Wt||1),Jt=Math.min(40,Jt||40);Wt<=Jt;Wt+=1)try{var Xt=At(Vt,zt,Wt,Qt);break e}catch{}Xt=void 0}if(!Xt)return null;for(Vt=Lt.getContext("2d"),Ht.background&&(Vt.fillStyle=Ht.background,Vt.fillRect(Ht.left,Ht.top,Ht.size,Ht.size)),zt=Xt.O,Jt=Ht.size/zt,Vt.beginPath(),Qt=0;Qt<zt;Qt+=1)for(Wt=0;Wt<zt;Wt+=1){var tr=Vt,rr=Ht.left+Wt*Jt,nr=Ht.top+Qt*Jt,ar=Qt,ir=Wt,lr=Xt.a,yr=rr+Jt,Sr=nr+Jt,Ar=ar-1,Dr=ar+1,Br=ir-1,Lr=ir+1,Or=Math.floor(Math.min(.5,Math.max(0,Ht.R))*Jt),vr=lr(ar,ir),pr=lr(Ar,Br),dr=lr(Ar,ir);Ar=lr(Ar,Lr);var ur=lr(ar,Lr);Lr=lr(Dr,Lr),ir=lr(Dr,ir),Dr=lr(Dr,Br),ar=lr(ar,Br),rr=Math.round(rr),nr=Math.round(nr),yr=Math.round(yr),Sr=Math.round(Sr),vr?xt(tr,rr,nr,yr,Sr,Or,!dr&&!ar,!dr&&!ur,!ir&&!ur,!ir&&!ar):Bt(tr,rr,nr,yr,Sr,Or,dr&&ar&&pr,dr&&ur&&Ar,ir&&ur&&Lr,ir&&ar&&Dr)}return Nt(Vt,Ht),Vt.fill(),Lt}var Ut={minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"no text",radius:.5,quiet:0};G$4=function(Lt,Ht){var Vt={};Object.assign(Vt,Ut,Lt),Vt.N=Vt.minVersion,Vt.K=Vt.maxVersion,Vt.v=Vt.ecLevel,Vt.left=Vt.left,Vt.top=Vt.top,Vt.size=Vt.size,Vt.fill=Vt.fill,Vt.background=Vt.background,Vt.text=Vt.text,Vt.R=Vt.radius,Vt.P=Vt.quiet,Ht instanceof HTMLCanvasElement?((Ht.width!==Vt.size||Ht.height!==Vt.size)&&(Ht.width=Vt.size,Ht.height=Vt.size),Ht.getContext("2d").clearRect(0,0,Ht.width,Ht.height),jt(Ht,Vt)):(Lt=document.createElement("canvas"),Lt.width=Vt.size,Lt.height=Vt.size,Vt=jt(Lt,Vt),Ht.appendChild(Vt))}})(function(){function kt(Ht){var Vt=xt.s(Ht);return{S:function(){return 4},b:function(){return Vt.length},write:function(zt){for(var Wt=0;Wt<Vt.length;Wt+=1)zt.put(Vt[Wt],8)}}}function At(){var Ht=[],Vt=0,zt={B:function(){return Ht},c:function(Wt){return(Ht[Math.floor(Wt/8)]>>>7-Wt%8&1)==1},put:function(Wt,Jt){for(var Qt=0;Qt<Jt;Qt+=1)zt.m((Wt>>>Jt-Qt-1&1)==1)},f:function(){return Vt},m:function(Wt){var Jt=Math.floor(Vt/8);Ht.length<=Jt&&Ht.push(0),Wt&&(Ht[Jt]|=128>>>Vt%8),Vt+=1}};return zt}function xt(Ht,Vt){function zt(ar,ir){for(var lr=-1;7>=lr;lr+=1)if(!(-1>=ar+lr||Xt<=ar+lr))for(var yr=-1;7>=yr;yr+=1)-1>=ir+yr||Xt<=ir+yr||(Qt[ar+lr][ir+yr]=0<=lr&&6>=lr&&(yr==0||yr==6)||0<=yr&&6>=yr&&(lr==0||lr==6)||2<=lr&&4>=lr&&2<=yr&&4>=yr)}function Wt(ar,ir){for(var lr=Xt=4*Ht+17,yr=Array(lr),Sr=0;Sr<lr;Sr+=1){yr[Sr]=Array(lr);for(var Ar=0;Ar<lr;Ar+=1)yr[Sr][Ar]=null}for(Qt=yr,zt(0,0),zt(Xt-7,0),zt(0,Xt-7),lr=jt.G(Ht),yr=0;yr<lr.length;yr+=1)for(Sr=0;Sr<lr.length;Sr+=1){Ar=lr[yr];var Dr=lr[Sr];if(Qt[Ar][Dr]==null)for(var Br=-2;2>=Br;Br+=1)for(var Lr=-2;2>=Lr;Lr+=1)Qt[Ar+Br][Dr+Lr]=Br==-2||Br==2||Lr==-2||Lr==2||Br==0&&Lr==0}for(lr=8;lr<Xt-8;lr+=1)Qt[lr][6]==null&&(Qt[lr][6]=lr%2==0);for(lr=8;lr<Xt-8;lr+=1)Qt[6][lr]==null&&(Qt[6][lr]=lr%2==0);for(lr=jt.w(Jt<<3|ir),yr=0;15>yr;yr+=1)Sr=!ar&&(lr>>yr&1)==1,Qt[6>yr?yr:8>yr?yr+1:Xt-15+yr][8]=Sr,Qt[8][8>yr?Xt-yr-1:9>yr?15-yr:14-yr]=Sr;if(Qt[Xt-8][8]=!ar,7<=Ht){for(lr=jt.A(Ht),yr=0;18>yr;yr+=1)Sr=!ar&&(lr>>yr&1)==1,Qt[Math.floor(yr/3)][yr%3+Xt-8-3]=Sr;for(yr=0;18>yr;yr+=1)Sr=!ar&&(lr>>yr&1)==1,Qt[yr%3+Xt-8-3][Math.floor(yr/3)]=Sr}if(tr==null){for(ar=Lt.I(Ht,Jt),lr=At(),yr=0;yr<rr.length;yr+=1)Sr=rr[yr],lr.put(4,4),lr.put(Sr.b(),jt.f(4,Ht)),Sr.write(lr);for(yr=Sr=0;yr<ar.length;yr+=1)Sr+=ar[yr].j;if(lr.f()>8*Sr)throw Error("code length overflow. ("+lr.f()+">"+8*Sr+")");for(lr.f()+4<=8*Sr&&lr.put(0,4);lr.f()%8!=0;)lr.m(!1);for(;!(lr.f()>=8*Sr)&&(lr.put(236,8),!(lr.f()>=8*Sr));)lr.put(17,8);var Or=0;for(Sr=yr=0,Ar=Array(ar.length),Dr=Array(ar.length),Br=0;Br<ar.length;Br+=1){var vr=ar[Br].j,pr=ar[Br].o-vr;for(yr=Math.max(yr,vr),Sr=Math.max(Sr,pr),Ar[Br]=Array(vr),Lr=0;Lr<Ar[Br].length;Lr+=1)Ar[Br][Lr]=255&lr.B()[Lr+Or];for(Or+=vr,Lr=jt.C(pr),vr=Bt(Ar[Br],Lr.b()-1).l(Lr),Dr[Br]=Array(Lr.b()-1),Lr=0;Lr<Dr[Br].length;Lr+=1)pr=Lr+vr.b()-Dr[Br].length,Dr[Br][Lr]=0<=pr?vr.c(pr):0}for(Lr=lr=0;Lr<ar.length;Lr+=1)lr+=ar[Lr].o;for(lr=Array(lr),Lr=Or=0;Lr<yr;Lr+=1)for(Br=0;Br<ar.length;Br+=1)Lr<Ar[Br].length&&(lr[Or]=Ar[Br][Lr],Or+=1);for(Lr=0;Lr<Sr;Lr+=1)for(Br=0;Br<ar.length;Br+=1)Lr<Dr[Br].length&&(lr[Or]=Dr[Br][Lr],Or+=1);tr=lr}for(ar=tr,lr=-1,yr=Xt-1,Sr=7,Ar=0,ir=jt.F(ir),Dr=Xt-1;0<Dr;Dr-=2)for(Dr==6&&--Dr;;){for(Br=0;2>Br;Br+=1)Qt[yr][Dr-Br]==null&&(Lr=!1,Ar<ar.length&&(Lr=(ar[Ar]>>>Sr&1)==1),ir(yr,Dr-Br)&&(Lr=!Lr),Qt[yr][Dr-Br]=Lr,--Sr,Sr==-1&&(Ar+=1,Sr=7));if(yr+=lr,0>yr||Xt<=yr){yr-=lr,lr=-lr;break}}}var Jt=Nt[Vt],Qt=null,Xt=0,tr=null,rr=[],nr={u:function(ar){ar=kt(ar),rr.push(ar),tr=null},a:function(ar,ir){if(0>ar||Xt<=ar||0>ir||Xt<=ir)throw Error(ar+","+ir);return Qt[ar][ir]},h:function(){return Xt},J:function(){for(var ar=0,ir=0,lr=0;8>lr;lr+=1){Wt(!0,lr);var yr=jt.D(nr);(lr==0||ar>yr)&&(ar=yr,ir=lr)}Wt(!1,ir)}};return nr}function Bt(Ht,Vt){if(typeof Ht.length>"u")throw Error(Ht.length+"/"+Vt);var zt=function(){for(var Jt=0;Jt<Ht.length&&Ht[Jt]==0;)Jt+=1;for(var Qt=Array(Ht.length-Jt+Vt),Xt=0;Xt<Ht.length-Jt;Xt+=1)Qt[Xt]=Ht[Xt+Jt];return Qt}(),Wt={c:function(Jt){return zt[Jt]},b:function(){return zt.length},multiply:function(Jt){for(var Qt=Array(Wt.b()+Jt.b()-1),Xt=0;Xt<Wt.b();Xt+=1)for(var tr=0;tr<Jt.b();tr+=1)Qt[Xt+tr]^=Ut.i(Ut.g(Wt.c(Xt))+Ut.g(Jt.c(tr)));return Bt(Qt,0)},l:function(Jt){if(0>Wt.b()-Jt.b())return Wt;for(var Qt=Ut.g(Wt.c(0))-Ut.g(Jt.c(0)),Xt=Array(Wt.b()),tr=0;tr<Wt.b();tr+=1)Xt[tr]=Wt.c(tr);for(tr=0;tr<Jt.b();tr+=1)Xt[tr]^=Ut.i(Ut.g(Jt.c(tr))+Qt);return Bt(Xt,0).l(Jt)}};return Wt}xt.s=function(Ht){for(var Vt=[],zt=0;zt<Ht.length;zt++){var Wt=Ht.charCodeAt(zt);128>Wt?Vt.push(Wt):2048>Wt?Vt.push(192|Wt>>6,128|Wt&63):55296>Wt||57344<=Wt?Vt.push(224|Wt>>12,128|Wt>>6&63,128|Wt&63):(zt++,Wt=65536+((Wt&1023)<<10|Ht.charCodeAt(zt)&1023),Vt.push(240|Wt>>18,128|Wt>>12&63,128|Wt>>6&63,128|Wt&63))}return Vt};var Nt={L:1,M:0,Q:3,H:2},jt=function(){function Ht(Wt){for(var Jt=0;Wt!=0;)Jt+=1,Wt>>>=1;return Jt}var Vt=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],zt={w:function(Wt){for(var Jt=Wt<<10;0<=Ht(Jt)-Ht(1335);)Jt^=1335<<Ht(Jt)-Ht(1335);return(Wt<<10|Jt)^21522},A:function(Wt){for(var Jt=Wt<<12;0<=Ht(Jt)-Ht(7973);)Jt^=7973<<Ht(Jt)-Ht(7973);return Wt<<12|Jt},G:function(Wt){return Vt[Wt-1]},F:function(Wt){switch(Wt){case 0:return function(Jt,Qt){return(Jt+Qt)%2==0};case 1:return function(Jt){return Jt%2==0};case 2:return function(Jt,Qt){return Qt%3==0};case 3:return function(Jt,Qt){return(Jt+Qt)%3==0};case 4:return function(Jt,Qt){return(Math.floor(Jt/2)+Math.floor(Qt/3))%2==0};case 5:return function(Jt,Qt){return Jt*Qt%2+Jt*Qt%3==0};case 6:return function(Jt,Qt){return(Jt*Qt%2+Jt*Qt%3)%2==0};case 7:return function(Jt,Qt){return(Jt*Qt%3+(Jt+Qt)%2)%2==0};default:throw Error("bad maskPattern:"+Wt)}},C:function(Wt){for(var Jt=Bt([1],0),Qt=0;Qt<Wt;Qt+=1)Jt=Jt.multiply(Bt([1,Ut.i(Qt)],0));return Jt},f:function(Wt,Jt){if(Wt!=4||1>Jt||40<Jt)throw Error("mode: "+Wt+"; type: "+Jt);return 10>Jt?8:16},D:function(Wt){for(var Jt=Wt.h(),Qt=0,Xt=0;Xt<Jt;Xt+=1)for(var tr=0;tr<Jt;tr+=1){for(var rr=0,nr=Wt.a(Xt,tr),ar=-1;1>=ar;ar+=1)if(!(0>Xt+ar||Jt<=Xt+ar))for(var ir=-1;1>=ir;ir+=1)0>tr+ir||Jt<=tr+ir||(ar!=0||ir!=0)&&nr==Wt.a(Xt+ar,tr+ir)&&(rr+=1);5<rr&&(Qt+=3+rr-5)}for(Xt=0;Xt<Jt-1;Xt+=1)for(tr=0;tr<Jt-1;tr+=1)rr=0,Wt.a(Xt,tr)&&(rr+=1),Wt.a(Xt+1,tr)&&(rr+=1),Wt.a(Xt,tr+1)&&(rr+=1),Wt.a(Xt+1,tr+1)&&(rr+=1),(rr==0||rr==4)&&(Qt+=3);for(Xt=0;Xt<Jt;Xt+=1)for(tr=0;tr<Jt-6;tr+=1)Wt.a(Xt,tr)&&!Wt.a(Xt,tr+1)&&Wt.a(Xt,tr+2)&&Wt.a(Xt,tr+3)&&Wt.a(Xt,tr+4)&&!Wt.a(Xt,tr+5)&&Wt.a(Xt,tr+6)&&(Qt+=40);for(tr=0;tr<Jt;tr+=1)for(Xt=0;Xt<Jt-6;Xt+=1)Wt.a(Xt,tr)&&!Wt.a(Xt+1,tr)&&Wt.a(Xt+2,tr)&&Wt.a(Xt+3,tr)&&Wt.a(Xt+4,tr)&&!Wt.a(Xt+5,tr)&&Wt.a(Xt+6,tr)&&(Qt+=40);for(tr=rr=0;tr<Jt;tr+=1)for(Xt=0;Xt<Jt;Xt+=1)Wt.a(Xt,tr)&&(rr+=1);return Qt+=Math.abs(100*rr/Jt/Jt-50)/5*10}};return zt}(),Ut=function(){for(var Ht=Array(256),Vt=Array(256),zt=0;8>zt;zt+=1)Ht[zt]=1<<zt;for(zt=8;256>zt;zt+=1)Ht[zt]=Ht[zt-4]^Ht[zt-5]^Ht[zt-6]^Ht[zt-8];for(zt=0;255>zt;zt+=1)Vt[Ht[zt]]=zt;return{g:function(Wt){if(1>Wt)throw Error("glog("+Wt+")");return Vt[Wt]},i:function(Wt){for(;0>Wt;)Wt+=255;for(;256<=Wt;)Wt-=255;return Ht[Wt]}}}(),Lt=function(){function Ht(Wt,Jt){switch(Jt){case Nt.L:return Vt[4*(Wt-1)];case Nt.M:return Vt[4*(Wt-1)+1];case Nt.Q:return Vt[4*(Wt-1)+2];case Nt.H:return Vt[4*(Wt-1)+3]}}var Vt=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],zt={I:function(Wt,Jt){var Qt=Ht(Wt,Jt);if(typeof Qt>"u")throw Error("bad rs block @ typeNumber:"+Wt+"/errorCorrectLevel:"+Jt);Wt=Qt.length/3,Jt=[];for(var Xt=0;Xt<Wt;Xt+=1)for(var tr=Qt[3*Xt],rr=Qt[3*Xt+1],nr=Qt[3*Xt+2],ar=0;ar<tr;ar+=1){var ir=nr,lr={};lr.o=rr,lr.j=ir,Jt.push(lr)}return Jt}};return zt}();return xt}());const QrCreator$1=QrCreator;var SlQrCode=class extends ShoelaceElement{constructor(){super(...arguments),this.value="",this.label="",this.size=128,this.fill="black",this.background="white",this.radius=0,this.errorCorrection="H"}firstUpdated(){this.generate()}generate(){this.hasUpdated&&QrCreator$1.render({text:this.value,radius:this.radius,ecLevel:this.errorCorrection,fill:this.fill,background:this.background,size:this.size*2},this.canvas)}render(){var kt;return ke$2`
      <canvas
        part="base"
        class="qr-code"
        role="img"
        aria-label=${((kt=this.label)==null?void 0:kt.length)>0?this.label:this.value}
        style=${se$1({width:`${this.size}px`,height:`${this.size}px`})}
      ></canvas>
    `}};SlQrCode.styles=[component_styles_default,qr_code_styles_default];__decorateClass([e$3("canvas")],SlQrCode.prototype,"canvas",2);__decorateClass([n$1()],SlQrCode.prototype,"value",2);__decorateClass([n$1()],SlQrCode.prototype,"label",2);__decorateClass([n$1({type:Number})],SlQrCode.prototype,"size",2);__decorateClass([n$1()],SlQrCode.prototype,"fill",2);__decorateClass([n$1()],SlQrCode.prototype,"background",2);__decorateClass([n$1({type:Number})],SlQrCode.prototype,"radius",2);__decorateClass([n$1({attribute:"error-correction"})],SlQrCode.prototype,"errorCorrection",2);__decorateClass([watch(["background","errorCorrection","fill","radius","size","value"])],SlQrCode.prototype,"generate",1);SlQrCode.define("sl-qr-code");var tag_styles_default=i$7`
  :host {
    display: inline-block;
  }

  .tag {
    display: flex;
    align-items: center;
    border: solid 1px;
    line-height: 1;
    white-space: nowrap;
    user-select: none;
    -webkit-user-select: none;
  }

  .tag__remove::part(base) {
    color: inherit;
    padding: 0;
  }

  /*
   * Variant modifiers
   */

  .tag--primary {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-200);
    color: var(--sl-color-primary-800);
  }

  .tag--primary:active > sl-icon-button {
    color: var(--sl-color-primary-600);
  }

  .tag--success {
    background-color: var(--sl-color-success-50);
    border-color: var(--sl-color-success-200);
    color: var(--sl-color-success-800);
  }

  .tag--success:active > sl-icon-button {
    color: var(--sl-color-success-600);
  }

  .tag--neutral {
    background-color: var(--sl-color-neutral-50);
    border-color: var(--sl-color-neutral-200);
    color: var(--sl-color-neutral-800);
  }

  .tag--neutral:active > sl-icon-button {
    color: var(--sl-color-neutral-600);
  }

  .tag--warning {
    background-color: var(--sl-color-warning-50);
    border-color: var(--sl-color-warning-200);
    color: var(--sl-color-warning-800);
  }

  .tag--warning:active > sl-icon-button {
    color: var(--sl-color-warning-600);
  }

  .tag--danger {
    background-color: var(--sl-color-danger-50);
    border-color: var(--sl-color-danger-200);
    color: var(--sl-color-danger-800);
  }

  .tag--danger:active > sl-icon-button {
    color: var(--sl-color-danger-600);
  }

  /*
   * Size modifiers
   */

  .tag--small {
    font-size: var(--sl-button-font-size-small);
    height: calc(var(--sl-input-height-small) * 0.8);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
    padding: 0 var(--sl-spacing-x-small);
  }

  .tag--medium {
    font-size: var(--sl-button-font-size-medium);
    height: calc(var(--sl-input-height-medium) * 0.8);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
    padding: 0 var(--sl-spacing-small);
  }

  .tag--large {
    font-size: var(--sl-button-font-size-large);
    height: calc(var(--sl-input-height-large) * 0.8);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
    padding: 0 var(--sl-spacing-medium);
  }

  .tag__remove {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  /*
   * Pill modifier
   */

  .tag--pill {
    border-radius: var(--sl-border-radius-pill);
  }
`,SlTag=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.variant="neutral",this.size="medium",this.pill=!1,this.removable=!1}handleRemoveClick(){this.emit("sl-remove")}render(){return ke$2`
      <span
        part="base"
        class=${Rt$1({tag:!0,"tag--primary":this.variant==="primary","tag--success":this.variant==="success","tag--neutral":this.variant==="neutral","tag--warning":this.variant==="warning","tag--danger":this.variant==="danger","tag--text":this.variant==="text","tag--small":this.size==="small","tag--medium":this.size==="medium","tag--large":this.size==="large","tag--pill":this.pill,"tag--removable":this.removable})}
      >
        <slot part="content" class="tag__content"></slot>

        ${this.removable?ke$2`
              <sl-icon-button
                part="remove-button"
                exportparts="base:remove-button__base"
                name="x-lg"
                library="system"
                label=${this.localize.term("remove")}
                class="tag__remove"
                @click=${this.handleRemoveClick}
                tabindex="-1"
              ></sl-icon-button>
            `:""}
      </span>
    `}};SlTag.styles=[component_styles_default,tag_styles_default];SlTag.dependencies={"sl-icon-button":SlIconButton};__decorateClass([n$1({reflect:!0})],SlTag.prototype,"variant",2);__decorateClass([n$1({reflect:!0})],SlTag.prototype,"size",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlTag.prototype,"pill",2);__decorateClass([n$1({type:Boolean})],SlTag.prototype,"removable",2);var select_styles_default=i$7`
  :host {
    display: block;
  }

  /** The popup */
  .select {
    flex: 1 1 auto;
    display: inline-flex;
    width: 100%;
    position: relative;
    vertical-align: middle;
  }

  .select::part(popup) {
    z-index: var(--sl-z-index-dropdown);
  }

  .select[data-current-placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .select[data-current-placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  /* Combobox */
  .select__combobox {
    flex: 1;
    display: flex;
    width: 100%;
    min-width: 0;
    position: relative;
    align-items: center;
    justify-content: start;
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-input-font-weight);
    letter-spacing: var(--sl-input-letter-spacing);
    vertical-align: middle;
    overflow: hidden;
    cursor: pointer;
    transition:
      var(--sl-transition-fast) color,
      var(--sl-transition-fast) border,
      var(--sl-transition-fast) box-shadow,
      var(--sl-transition-fast) background-color;
  }

  .select__display-input {
    position: relative;
    width: 100%;
    font: inherit;
    border: none;
    background: none;
    color: var(--sl-input-color);
    cursor: inherit;
    overflow: hidden;
    padding: 0;
    margin: 0;
    -webkit-appearance: none;
  }

  .select__display-input::placeholder {
    color: var(--sl-input-placeholder-color);
  }

  .select:not(.select--disabled):hover .select__display-input {
    color: var(--sl-input-color-hover);
  }

  .select__display-input:focus {
    outline: none;
  }

  /* Visually hide the display input when multiple is enabled */
  .select--multiple:not(.select--placeholder-visible) .select__display-input {
    position: absolute;
    z-index: -1;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
  }

  .select__value-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    opacity: 0;
    z-index: -1;
  }

  .select__tags {
    display: flex;
    flex: 1;
    align-items: center;
    flex-wrap: wrap;
    margin-inline-start: var(--sl-spacing-2x-small);
  }

  .select__tags::slotted(sl-tag) {
    cursor: pointer !important;
  }

  .select--disabled .select__tags,
  .select--disabled .select__tags::slotted(sl-tag) {
    cursor: not-allowed !important;
  }

  /* Standard selects */
  .select--standard .select__combobox {
    background-color: var(--sl-input-background-color);
    border: solid var(--sl-input-border-width) var(--sl-input-border-color);
  }

  .select--standard.select--disabled .select__combobox {
    background-color: var(--sl-input-background-color-disabled);
    border-color: var(--sl-input-border-color-disabled);
    color: var(--sl-input-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
    outline: none;
  }

  .select--standard:not(.select--disabled).select--open .select__combobox,
  .select--standard:not(.select--disabled).select--focused .select__combobox {
    background-color: var(--sl-input-background-color-focus);
    border-color: var(--sl-input-border-color-focus);
    box-shadow: 0 0 0 var(--sl-focus-ring-width) var(--sl-input-focus-ring-color);
  }

  /* Filled selects */
  .select--filled .select__combobox {
    border: none;
    background-color: var(--sl-input-filled-background-color);
    color: var(--sl-input-color);
  }

  .select--filled:hover:not(.select--disabled) .select__combobox {
    background-color: var(--sl-input-filled-background-color-hover);
  }

  .select--filled.select--disabled .select__combobox {
    background-color: var(--sl-input-filled-background-color-disabled);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .select--filled:not(.select--disabled).select--open .select__combobox,
  .select--filled:not(.select--disabled).select--focused .select__combobox {
    background-color: var(--sl-input-filled-background-color-focus);
    outline: var(--sl-focus-ring);
  }

  /* Sizes */
  .select--small .select__combobox {
    border-radius: var(--sl-input-border-radius-small);
    font-size: var(--sl-input-font-size-small);
    min-height: var(--sl-input-height-small);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-small);
  }

  .select--small .select__clear {
    margin-inline-start: var(--sl-input-spacing-small);
  }

  .select--small .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-small);
  }

  .select--small.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-block: 2px;
    padding-inline-start: 0;
  }

  .select--small .select__tags {
    gap: 2px;
  }

  .select--medium .select__combobox {
    border-radius: var(--sl-input-border-radius-medium);
    font-size: var(--sl-input-font-size-medium);
    min-height: var(--sl-input-height-medium);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-medium);
  }

  .select--medium .select__clear {
    margin-inline-start: var(--sl-input-spacing-medium);
  }

  .select--medium .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-medium);
  }

  .select--medium.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-inline-start: 0;
    padding-block: 3px;
  }

  .select--medium .select__tags {
    gap: 3px;
  }

  .select--large .select__combobox {
    border-radius: var(--sl-input-border-radius-large);
    font-size: var(--sl-input-font-size-large);
    min-height: var(--sl-input-height-large);
    padding-block: 0;
    padding-inline: var(--sl-input-spacing-large);
  }

  .select--large .select__clear {
    margin-inline-start: var(--sl-input-spacing-large);
  }

  .select--large .select__prefix::slotted(*) {
    margin-inline-end: var(--sl-input-spacing-large);
  }

  .select--large.select--multiple:not(.select--placeholder-visible) .select__combobox {
    padding-inline-start: 0;
    padding-block: 4px;
  }

  .select--large .select__tags {
    gap: 4px;
  }

  /* Pills */
  .select--pill.select--small .select__combobox {
    border-radius: var(--sl-input-height-small);
  }

  .select--pill.select--medium .select__combobox {
    border-radius: var(--sl-input-height-medium);
  }

  .select--pill.select--large .select__combobox {
    border-radius: var(--sl-input-height-large);
  }

  /* Prefix */
  .select__prefix {
    flex: 0;
    display: inline-flex;
    align-items: center;
    color: var(--sl-input-placeholder-color);
  }

  /* Suffix */
  .select__suffix {
    flex: 0;
    display: inline-flex;
    align-items: center;
    color: var(--sl-input-placeholder-color);
  }

  /* Clear button */
  .select__clear {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: inherit;
    color: var(--sl-input-icon-color);
    border: none;
    background: none;
    padding: 0;
    transition: var(--sl-transition-fast) color;
    cursor: pointer;
  }

  .select__clear:hover {
    color: var(--sl-input-icon-color-hover);
  }

  .select__clear:focus {
    outline: none;
  }

  /* Expand icon */
  .select__expand-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    transition: var(--sl-transition-medium) rotate ease;
    rotate: 0;
    margin-inline-start: var(--sl-spacing-small);
  }

  .select--open .select__expand-icon {
    rotate: -180deg;
  }

  /* Listbox */
  .select__listbox {
    display: block;
    position: relative;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    box-shadow: var(--sl-shadow-large);
    background: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-radius: var(--sl-border-radius-medium);
    padding-block: var(--sl-spacing-x-small);
    padding-inline: 0;
    overflow: auto;
    overscroll-behavior: none;

    /* Make sure it adheres to the popup's auto size */
    max-width: var(--auto-size-available-width);
    max-height: var(--auto-size-available-height);
  }

  .select__listbox ::slotted(sl-divider) {
    --spacing: var(--sl-spacing-x-small);
  }

  .select__listbox ::slotted(small) {
    display: block;
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-semibold);
    color: var(--sl-color-neutral-500);
    padding-block: var(--sl-spacing-2x-small);
    padding-inline: var(--sl-spacing-x-large);
  }
`;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let le$1=class extends i$5{constructor(At){if(super(At),this.it=D$1,At.type!==t$3.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(At){if(At===D$1||At==null)return this._t=void 0,this.it=At;if(At===R$2)return At;if(typeof At!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(At===this.it)return this._t;this.it=At;const xt=[At];return xt.raw=xt,this._t={_$litType$:this.constructor.resultType,strings:xt,values:[]}}};le$1.directiveName="unsafeHTML",le$1.resultType=1;const ae$1=e$2(le$1);var SlSelect=class extends ShoelaceElement{constructor(){super(...arguments),this.formControlController=new FormControlController(this,{assumeInteractionOn:["sl-blur","sl-input"]}),this.hasSlotController=new HasSlotController(this,"help-text","label"),this.localize=new LocalizeController(this),this.typeToSelectString="",this.hasFocus=!1,this.displayLabel="",this.selectedOptions=[],this.name="",this.value="",this.defaultValue="",this.size="medium",this.placeholder="",this.multiple=!1,this.maxOptionsVisible=3,this.disabled=!1,this.clearable=!1,this.open=!1,this.hoist=!1,this.filled=!1,this.pill=!1,this.label="",this.placement="bottom",this.helpText="",this.form="",this.required=!1,this.getTag=kt=>ke$2`
      <sl-tag
        part="tag"
        exportparts="
              base:tag__base,
              content:tag__content,
              remove-button:tag__remove-button,
              remove-button__base:tag__remove-button__base
            "
        ?pill=${this.pill}
        size=${this.size}
        removable
        @sl-remove=${At=>this.handleTagRemove(At,kt)}
      >
        ${kt.getTextLabel()}
      </sl-tag>
    `,this.handleDocumentFocusIn=kt=>{const At=kt.composedPath();this&&!At.includes(this)&&this.hide()},this.handleDocumentKeyDown=kt=>{const At=kt.target,xt=At.closest(".select__clear")!==null,Bt=At.closest("sl-icon-button")!==null;if(!(xt||Bt)){if(kt.key==="Escape"&&this.open&&!this.closeWatcher&&(kt.preventDefault(),kt.stopPropagation(),this.hide(),this.displayInput.focus({preventScroll:!0})),kt.key==="Enter"||kt.key===" "&&this.typeToSelectString===""){if(kt.preventDefault(),kt.stopImmediatePropagation(),!this.open){this.show();return}this.currentOption&&!this.currentOption.disabled&&(this.multiple?this.toggleOptionSelection(this.currentOption):this.setSelectedOptions(this.currentOption),this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})));return}if(["ArrowUp","ArrowDown","Home","End"].includes(kt.key)){const Nt=this.getAllOptions(),jt=Nt.indexOf(this.currentOption);let Ut=Math.max(0,jt);if(kt.preventDefault(),!this.open&&(this.show(),this.currentOption))return;kt.key==="ArrowDown"?(Ut=jt+1,Ut>Nt.length-1&&(Ut=0)):kt.key==="ArrowUp"?(Ut=jt-1,Ut<0&&(Ut=Nt.length-1)):kt.key==="Home"?Ut=0:kt.key==="End"&&(Ut=Nt.length-1),this.setCurrentOption(Nt[Ut])}if(kt.key.length===1||kt.key==="Backspace"){const Nt=this.getAllOptions();if(kt.metaKey||kt.ctrlKey||kt.altKey)return;if(!this.open){if(kt.key==="Backspace")return;this.show()}kt.stopPropagation(),kt.preventDefault(),clearTimeout(this.typeToSelectTimeout),this.typeToSelectTimeout=window.setTimeout(()=>this.typeToSelectString="",1e3),kt.key==="Backspace"?this.typeToSelectString=this.typeToSelectString.slice(0,-1):this.typeToSelectString+=kt.key.toLowerCase();for(const jt of Nt)if(jt.getTextLabel().toLowerCase().startsWith(this.typeToSelectString)){this.setCurrentOption(jt);break}}}},this.handleDocumentMouseDown=kt=>{const At=kt.composedPath();this&&!At.includes(this)&&this.hide()}}get validity(){return this.valueInput.validity}get validationMessage(){return this.valueInput.validationMessage}connectedCallback(){super.connectedCallback(),this.open=!1}addOpenListeners(){var kt;document.addEventListener("focusin",this.handleDocumentFocusIn),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("mousedown",this.handleDocumentMouseDown),this.getRootNode()!==document&&this.getRootNode().addEventListener("focusin",this.handleDocumentFocusIn),"CloseWatcher"in window&&((kt=this.closeWatcher)==null||kt.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>{this.open&&(this.hide(),this.displayInput.focus({preventScroll:!0}))})}removeOpenListeners(){var kt;document.removeEventListener("focusin",this.handleDocumentFocusIn),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("mousedown",this.handleDocumentMouseDown),this.getRootNode()!==document&&this.getRootNode().removeEventListener("focusin",this.handleDocumentFocusIn),(kt=this.closeWatcher)==null||kt.destroy()}handleFocus(){this.hasFocus=!0,this.displayInput.setSelectionRange(0,0),this.emit("sl-focus")}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleLabelClick(){this.displayInput.focus()}handleComboboxMouseDown(kt){const xt=kt.composedPath().some(Bt=>Bt instanceof Element&&Bt.tagName.toLowerCase()==="sl-icon-button");this.disabled||xt||(kt.preventDefault(),this.displayInput.focus({preventScroll:!0}),this.open=!this.open)}handleComboboxKeyDown(kt){kt.key!=="Tab"&&(kt.stopPropagation(),this.handleDocumentKeyDown(kt))}handleClearClick(kt){kt.stopPropagation(),this.value!==""&&(this.setSelectedOptions([]),this.displayInput.focus({preventScroll:!0}),this.updateComplete.then(()=>{this.emit("sl-clear"),this.emit("sl-input"),this.emit("sl-change")}))}handleClearMouseDown(kt){kt.stopPropagation(),kt.preventDefault()}handleOptionClick(kt){const xt=kt.target.closest("sl-option"),Bt=this.value;xt&&!xt.disabled&&(this.multiple?this.toggleOptionSelection(xt):this.setSelectedOptions(xt),this.updateComplete.then(()=>this.displayInput.focus({preventScroll:!0})),this.value!==Bt&&this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})))}handleDefaultSlotChange(){const kt=this.getAllOptions(),At=Array.isArray(this.value)?this.value:[this.value],xt=[];customElements.get("sl-option")?(kt.forEach(Bt=>xt.push(Bt.value)),this.setSelectedOptions(kt.filter(Bt=>At.includes(Bt.value)))):customElements.whenDefined("sl-option").then(()=>this.handleDefaultSlotChange())}handleTagRemove(kt,At){kt.stopPropagation(),this.disabled||(this.toggleOptionSelection(At,!1),this.updateComplete.then(()=>{this.emit("sl-input"),this.emit("sl-change")}))}getAllOptions(){return[...this.querySelectorAll("sl-option")]}getFirstOption(){return this.querySelector("sl-option")}setCurrentOption(kt){this.getAllOptions().forEach(xt=>{xt.current=!1,xt.tabIndex=-1}),kt&&(this.currentOption=kt,kt.current=!0,kt.tabIndex=0,kt.focus())}setSelectedOptions(kt){const At=this.getAllOptions(),xt=Array.isArray(kt)?kt:[kt];At.forEach(Bt=>Bt.selected=!1),xt.length&&xt.forEach(Bt=>Bt.selected=!0),this.selectionChanged()}toggleOptionSelection(kt,At){At===!0||At===!1?kt.selected=At:kt.selected=!kt.selected,this.selectionChanged()}selectionChanged(){var kt,At,xt,Bt;this.selectedOptions=this.getAllOptions().filter(Nt=>Nt.selected),this.multiple?(this.value=this.selectedOptions.map(Nt=>Nt.value),this.placeholder&&this.value.length===0?this.displayLabel="":this.displayLabel=this.localize.term("numOptionsSelected",this.selectedOptions.length)):(this.value=(At=(kt=this.selectedOptions[0])==null?void 0:kt.value)!=null?At:"",this.displayLabel=(Bt=(xt=this.selectedOptions[0])==null?void 0:xt.getTextLabel())!=null?Bt:""),this.updateComplete.then(()=>{this.formControlController.updateValidity()})}get tags(){return this.selectedOptions.map((kt,At)=>{if(At<this.maxOptionsVisible||this.maxOptionsVisible<=0){const xt=this.getTag(kt,At);return ke$2`<div @sl-remove=${Bt=>this.handleTagRemove(Bt,kt)}>
          ${typeof xt=="string"?ae$1(xt):xt}
        </div>`}else if(At===this.maxOptionsVisible)return ke$2`<sl-tag size=${this.size}>+${this.selectedOptions.length-At}</sl-tag>`;return ke$2``})}handleInvalid(kt){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(kt)}handleDisabledChange(){this.disabled&&(this.open=!1,this.handleOpenChange())}handleValueChange(){const kt=this.getAllOptions(),At=Array.isArray(this.value)?this.value:[this.value];this.setSelectedOptions(kt.filter(xt=>At.includes(xt.value)))}async handleOpenChange(){if(this.open&&!this.disabled){this.setCurrentOption(this.selectedOptions[0]||this.getFirstOption()),this.emit("sl-show"),this.addOpenListeners(),await stopAnimations(this),this.listbox.hidden=!1,this.popup.active=!0,requestAnimationFrame(()=>{this.setCurrentOption(this.currentOption)});const{keyframes:kt,options:At}=getAnimation(this,"select.show",{dir:this.localize.dir()});await animateTo(this.popup.popup,kt,At),this.currentOption&&scrollIntoView(this.currentOption,this.listbox,"vertical","auto"),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),await stopAnimations(this);const{keyframes:kt,options:At}=getAnimation(this,"select.hide",{dir:this.localize.dir()});await animateTo(this.popup.popup,kt,At),this.listbox.hidden=!0,this.popup.active=!1,this.emit("sl-after-hide")}}async show(){if(this.open||this.disabled){this.open=!1;return}return this.open=!0,waitForEvent(this,"sl-after-show")}async hide(){if(!this.open||this.disabled){this.open=!1;return}return this.open=!1,waitForEvent(this,"sl-after-hide")}checkValidity(){return this.valueInput.checkValidity()}getForm(){return this.formControlController.getForm()}reportValidity(){return this.valueInput.reportValidity()}setCustomValidity(kt){this.valueInput.setCustomValidity(kt),this.formControlController.updateValidity()}focus(kt){this.displayInput.focus(kt)}blur(){this.displayInput.blur()}render(){const kt=this.hasSlotController.test("label"),At=this.hasSlotController.test("help-text"),xt=this.label?!0:!!kt,Bt=this.helpText?!0:!!At,Nt=this.clearable&&!this.disabled&&this.value.length>0,jt=this.placeholder&&this.value.length===0;return ke$2`
      <div
        part="form-control"
        class=${Rt$1({"form-control":!0,"form-control--small":this.size==="small","form-control--medium":this.size==="medium","form-control--large":this.size==="large","form-control--has-label":xt,"form-control--has-help-text":Bt})}
      >
        <label
          id="label"
          part="form-control-label"
          class="form-control__label"
          aria-hidden=${xt?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <sl-popup
            class=${Rt$1({select:!0,"select--standard":!0,"select--filled":this.filled,"select--pill":this.pill,"select--open":this.open,"select--disabled":this.disabled,"select--multiple":this.multiple,"select--focused":this.hasFocus,"select--placeholder-visible":jt,"select--top":this.placement==="top","select--bottom":this.placement==="bottom","select--small":this.size==="small","select--medium":this.size==="medium","select--large":this.size==="large"})}
            placement=${this.placement}
            strategy=${this.hoist?"fixed":"absolute"}
            flip
            shift
            sync="width"
            auto-size="vertical"
            auto-size-padding="10"
          >
            <div
              part="combobox"
              class="select__combobox"
              slot="anchor"
              @keydown=${this.handleComboboxKeyDown}
              @mousedown=${this.handleComboboxMouseDown}
            >
              <slot part="prefix" name="prefix" class="select__prefix"></slot>

              <input
                part="display-input"
                class="select__display-input"
                type="text"
                placeholder=${this.placeholder}
                .disabled=${this.disabled}
                .value=${this.displayLabel}
                autocomplete="off"
                spellcheck="false"
                autocapitalize="off"
                readonly
                aria-controls="listbox"
                aria-expanded=${this.open?"true":"false"}
                aria-haspopup="listbox"
                aria-labelledby="label"
                aria-disabled=${this.disabled?"true":"false"}
                aria-describedby="help-text"
                role="combobox"
                tabindex="0"
                @focus=${this.handleFocus}
                @blur=${this.handleBlur}
              />

              ${this.multiple?ke$2`<div part="tags" class="select__tags">${this.tags}</div>`:""}

              <input
                class="select__value-input"
                type="text"
                ?disabled=${this.disabled}
                ?required=${this.required}
                .value=${Array.isArray(this.value)?this.value.join(", "):this.value}
                tabindex="-1"
                aria-hidden="true"
                @focus=${()=>this.focus()}
                @invalid=${this.handleInvalid}
              />

              ${Nt?ke$2`
                    <button
                      part="clear-button"
                      class="select__clear"
                      type="button"
                      aria-label=${this.localize.term("clearEntry")}
                      @mousedown=${this.handleClearMouseDown}
                      @click=${this.handleClearClick}
                      tabindex="-1"
                    >
                      <slot name="clear-icon">
                        <sl-icon name="x-circle-fill" library="system"></sl-icon>
                      </slot>
                    </button>
                  `:""}

              <slot name="suffix" part="suffix" class="select__suffix"></slot>

              <slot name="expand-icon" part="expand-icon" class="select__expand-icon">
                <sl-icon library="system" name="chevron-down"></sl-icon>
              </slot>
            </div>

            <div
              id="listbox"
              role="listbox"
              aria-expanded=${this.open?"true":"false"}
              aria-multiselectable=${this.multiple?"true":"false"}
              aria-labelledby="label"
              part="listbox"
              class="select__listbox"
              tabindex="-1"
              @mouseup=${this.handleOptionClick}
              @slotchange=${this.handleDefaultSlotChange}
            >
              <slot></slot>
            </div>
          </sl-popup>
        </div>

        <div
          part="form-control-help-text"
          id="help-text"
          class="form-control__help-text"
          aria-hidden=${Bt?"false":"true"}
        >
          <slot name="help-text">${this.helpText}</slot>
        </div>
      </div>
    `}};SlSelect.styles=[component_styles_default,form_control_styles_default,select_styles_default];SlSelect.dependencies={"sl-icon":SlIcon,"sl-popup":SlPopup,"sl-tag":SlTag};__decorateClass([e$3(".select")],SlSelect.prototype,"popup",2);__decorateClass([e$3(".select__combobox")],SlSelect.prototype,"combobox",2);__decorateClass([e$3(".select__display-input")],SlSelect.prototype,"displayInput",2);__decorateClass([e$3(".select__value-input")],SlSelect.prototype,"valueInput",2);__decorateClass([e$3(".select__listbox")],SlSelect.prototype,"listbox",2);__decorateClass([r$3()],SlSelect.prototype,"hasFocus",2);__decorateClass([r$3()],SlSelect.prototype,"displayLabel",2);__decorateClass([r$3()],SlSelect.prototype,"currentOption",2);__decorateClass([r$3()],SlSelect.prototype,"selectedOptions",2);__decorateClass([n$1()],SlSelect.prototype,"name",2);__decorateClass([n$1({converter:{fromAttribute:kt=>kt.split(" "),toAttribute:kt=>kt.join(" ")}})],SlSelect.prototype,"value",2);__decorateClass([defaultValue()],SlSelect.prototype,"defaultValue",2);__decorateClass([n$1({reflect:!0})],SlSelect.prototype,"size",2);__decorateClass([n$1()],SlSelect.prototype,"placeholder",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSelect.prototype,"multiple",2);__decorateClass([n$1({attribute:"max-options-visible",type:Number})],SlSelect.prototype,"maxOptionsVisible",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSelect.prototype,"disabled",2);__decorateClass([n$1({type:Boolean})],SlSelect.prototype,"clearable",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSelect.prototype,"open",2);__decorateClass([n$1({type:Boolean})],SlSelect.prototype,"hoist",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSelect.prototype,"filled",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSelect.prototype,"pill",2);__decorateClass([n$1()],SlSelect.prototype,"label",2);__decorateClass([n$1({reflect:!0})],SlSelect.prototype,"placement",2);__decorateClass([n$1({attribute:"help-text"})],SlSelect.prototype,"helpText",2);__decorateClass([n$1({reflect:!0})],SlSelect.prototype,"form",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlSelect.prototype,"required",2);__decorateClass([n$1()],SlSelect.prototype,"getTag",2);__decorateClass([watch("disabled",{waitUntilFirstUpdate:!0})],SlSelect.prototype,"handleDisabledChange",1);__decorateClass([watch("value",{waitUntilFirstUpdate:!0})],SlSelect.prototype,"handleValueChange",1);__decorateClass([watch("open",{waitUntilFirstUpdate:!0})],SlSelect.prototype,"handleOpenChange",1);setDefaultAnimation("select.show",{keyframes:[{opacity:0,scale:.9},{opacity:1,scale:1}],options:{duration:100,easing:"ease"}});setDefaultAnimation("select.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.9}],options:{duration:100,easing:"ease"}});SlSelect.define("sl-select");var option_styles_default=i$7`
  :host {
    display: block;
    user-select: none;
    -webkit-user-select: none;
  }

  :host(:focus) {
    outline: none;
  }

  .option {
    position: relative;
    display: flex;
    align-items: center;
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-medium);
    font-weight: var(--sl-font-weight-normal);
    line-height: var(--sl-line-height-normal);
    letter-spacing: var(--sl-letter-spacing-normal);
    color: var(--sl-color-neutral-700);
    padding: var(--sl-spacing-x-small) var(--sl-spacing-medium) var(--sl-spacing-x-small) var(--sl-spacing-x-small);
    transition: var(--sl-transition-fast) fill;
    cursor: pointer;
  }

  .option--hover:not(.option--current):not(.option--disabled) {
    background-color: var(--sl-color-neutral-100);
    color: var(--sl-color-neutral-1000);
  }

  .option--current,
  .option--current.option--disabled {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
    opacity: 1;
  }

  .option--disabled {
    outline: none;
    opacity: 0.5;
    cursor: not-allowed;
  }

  .option__label {
    flex: 1 1 auto;
    display: inline-block;
    line-height: var(--sl-line-height-dense);
  }

  .option .option__check {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    visibility: hidden;
    padding-inline-end: var(--sl-spacing-2x-small);
  }

  .option--selected .option__check {
    visibility: visible;
  }

  .option__prefix,
  .option__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .option__prefix::slotted(*) {
    margin-inline-end: var(--sl-spacing-x-small);
  }

  .option__suffix::slotted(*) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  @media (forced-colors: active) {
    :host(:hover:not([aria-disabled='true'])) .option {
      outline: dashed 1px SelectedItem;
      outline-offset: -1px;
    }
  }
`,SlOption=class extends ShoelaceElement{constructor(){super(...arguments),this.localize=new LocalizeController(this),this.current=!1,this.selected=!1,this.hasHover=!1,this.value="",this.disabled=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","option"),this.setAttribute("aria-selected","false")}handleDefaultSlotChange(){const kt=this.getTextLabel();if(typeof this.cachedTextLabel>"u"){this.cachedTextLabel=kt;return}kt!==this.cachedTextLabel&&(this.cachedTextLabel=kt,this.emit("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))}handleMouseEnter(){this.hasHover=!0}handleMouseLeave(){this.hasHover=!1}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}handleSelectedChange(){this.setAttribute("aria-selected",this.selected?"true":"false")}handleValueChange(){typeof this.value!="string"&&(this.value=String(this.value)),this.value.includes(" ")&&(console.error("Option values cannot include a space. All spaces have been replaced with underscores.",this),this.value=this.value.replace(/ /g,"_"))}getTextLabel(){const kt=this.childNodes;let At="";return[...kt].forEach(xt=>{xt.nodeType===Node.ELEMENT_NODE&&(xt.hasAttribute("slot")||(At+=xt.textContent)),xt.nodeType===Node.TEXT_NODE&&(At+=xt.textContent)}),At.trim()}render(){return ke$2`
      <div
        part="base"
        class=${Rt$1({option:!0,"option--current":this.current,"option--disabled":this.disabled,"option--selected":this.selected,"option--hover":this.hasHover})}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
      >
        <sl-icon part="checked-icon" class="option__check" name="check" library="system" aria-hidden="true"></sl-icon>
        <slot part="prefix" name="prefix" class="option__prefix"></slot>
        <slot part="label" class="option__label" @slotchange=${this.handleDefaultSlotChange}></slot>
        <slot part="suffix" name="suffix" class="option__suffix"></slot>
      </div>
    `}};SlOption.styles=[component_styles_default,option_styles_default];SlOption.dependencies={"sl-icon":SlIcon};__decorateClass([e$3(".option__label")],SlOption.prototype,"defaultSlot",2);__decorateClass([r$3()],SlOption.prototype,"current",2);__decorateClass([r$3()],SlOption.prototype,"selected",2);__decorateClass([r$3()],SlOption.prototype,"hasHover",2);__decorateClass([n$1({reflect:!0})],SlOption.prototype,"value",2);__decorateClass([n$1({type:Boolean,reflect:!0})],SlOption.prototype,"disabled",2);__decorateClass([watch("disabled")],SlOption.prototype,"handleDisabledChange",1);__decorateClass([watch("selected")],SlOption.prototype,"handleSelectedChange",1);__decorateClass([watch("value")],SlOption.prototype,"handleValueChange",1);SlOption.define("sl-option");var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function getDefaultExportFromCjs(kt){return kt&&kt.__esModule&&Object.prototype.hasOwnProperty.call(kt,"default")?kt.default:kt}function getAugmentedNamespace(kt){if(kt.__esModule)return kt;var At=kt.default;if(typeof At=="function"){var xt=function Bt(){return this instanceof Bt?Reflect.construct(At,arguments,this.constructor):At.apply(this,arguments)};xt.prototype=At.prototype}else xt={};return Object.defineProperty(xt,"__esModule",{value:!0}),Object.keys(kt).forEach(function(Bt){var Nt=Object.getOwnPropertyDescriptor(kt,Bt);Object.defineProperty(xt,Bt,Nt.get?Nt:{enumerable:!0,get:function(){return kt[Bt]}})}),xt}var freeGlobal$1=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,_freeGlobal=freeGlobal$1,freeGlobal=_freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root$1=freeGlobal||freeSelf||Function("return this")(),_root=root$1,root=_root,Symbol$a=root.Symbol,_Symbol=Symbol$a,Symbol$9=_Symbol,objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty,nativeObjectToString$1=objectProto$2.toString,symToStringTag$1=Symbol$9?Symbol$9.toStringTag:void 0;function getRawTag$1(kt){var At=hasOwnProperty$3.call(kt,symToStringTag$1),xt=kt[symToStringTag$1];try{kt[symToStringTag$1]=void 0;var Bt=!0}catch{}var Nt=nativeObjectToString$1.call(kt);return Bt&&(At?kt[symToStringTag$1]=xt:delete kt[symToStringTag$1]),Nt}var _getRawTag=getRawTag$1,objectProto$1=Object.prototype,nativeObjectToString=objectProto$1.toString;function objectToString$3(kt){return nativeObjectToString.call(kt)}var _objectToString=objectToString$3,Symbol$8=_Symbol,getRawTag=_getRawTag,objectToString$2=_objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$8?Symbol$8.toStringTag:void 0;function baseGetTag$1(kt){return kt==null?kt===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(kt)?getRawTag(kt):objectToString$2(kt)}var _baseGetTag=baseGetTag$1;function overArg$1(kt,At){return function(xt){return kt(At(xt))}}var _overArg=overArg$1,overArg=_overArg,getPrototype$1=overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype$1;function isObjectLike$1(kt){return kt!=null&&typeof kt=="object"}var isObjectLike_1=isObjectLike$1,baseGetTag=_baseGetTag,getPrototype=_getPrototype,isObjectLike=isObjectLike_1,objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$2=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(kt){if(!isObjectLike(kt)||baseGetTag(kt)!=objectTag)return!1;var At=getPrototype(kt);if(At===null)return!0;var xt=hasOwnProperty$2.call(At,"constructor")&&At.constructor;return typeof xt=="function"&&xt instanceof xt&&funcToString.call(xt)==objectCtorString}var isPlainObject_1=isPlainObject;const isPlainObject$1=getDefaultExportFromCjs(isPlainObject_1);function base$5(kt,At){if(kt.length>=255)throw new TypeError("Alphabet too long");for(var xt=new Uint8Array(256),Bt=0;Bt<xt.length;Bt++)xt[Bt]=255;for(var Nt=0;Nt<kt.length;Nt++){var jt=kt.charAt(Nt),Ut=jt.charCodeAt(0);if(xt[Ut]!==255)throw new TypeError(jt+" is ambiguous");xt[Ut]=Nt}var Lt=kt.length,Ht=kt.charAt(0),Vt=Math.log(Lt)/Math.log(256),zt=Math.log(256)/Math.log(Lt);function Wt(Xt){if(Xt instanceof Uint8Array||(ArrayBuffer.isView(Xt)?Xt=new Uint8Array(Xt.buffer,Xt.byteOffset,Xt.byteLength):Array.isArray(Xt)&&(Xt=Uint8Array.from(Xt))),!(Xt instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Xt.length===0)return"";for(var tr=0,rr=0,nr=0,ar=Xt.length;nr!==ar&&Xt[nr]===0;)nr++,tr++;for(var ir=(ar-nr)*zt+1>>>0,lr=new Uint8Array(ir);nr!==ar;){for(var yr=Xt[nr],Sr=0,Ar=ir-1;(yr!==0||Sr<rr)&&Ar!==-1;Ar--,Sr++)yr+=256*lr[Ar]>>>0,lr[Ar]=yr%Lt>>>0,yr=yr/Lt>>>0;if(yr!==0)throw new Error("Non-zero carry");rr=Sr,nr++}for(var Dr=ir-rr;Dr!==ir&&lr[Dr]===0;)Dr++;for(var Br=Ht.repeat(tr);Dr<ir;++Dr)Br+=kt.charAt(lr[Dr]);return Br}function Jt(Xt){if(typeof Xt!="string")throw new TypeError("Expected String");if(Xt.length===0)return new Uint8Array;var tr=0;if(Xt[tr]!==" "){for(var rr=0,nr=0;Xt[tr]===Ht;)rr++,tr++;for(var ar=(Xt.length-tr)*Vt+1>>>0,ir=new Uint8Array(ar);Xt[tr];){var lr=xt[Xt.charCodeAt(tr)];if(lr===255)return;for(var yr=0,Sr=ar-1;(lr!==0||yr<nr)&&Sr!==-1;Sr--,yr++)lr+=Lt*ir[Sr]>>>0,ir[Sr]=lr%256>>>0,lr=lr/256>>>0;if(lr!==0)throw new Error("Non-zero carry");nr=yr,tr++}if(Xt[tr]!==" "){for(var Ar=ar-nr;Ar!==ar&&ir[Ar]===0;)Ar++;for(var Dr=new Uint8Array(rr+(ar-Ar)),Br=rr;Ar!==ar;)Dr[Br++]=ir[Ar++];return Dr}}}function Qt(Xt){var tr=Jt(Xt);if(tr)return tr;throw new Error(`Non-${At} character`)}return{encode:Wt,decodeUnsafe:Jt,decode:Qt}}var src$3=base$5,_brrp__multiformats_scope_baseX$3=src$3;const equals$6=(kt,At)=>{if(kt===At)return!0;if(kt.byteLength!==At.byteLength)return!1;for(let xt=0;xt<kt.byteLength;xt++)if(kt[xt]!==At[xt])return!1;return!0},coerce$3=kt=>{if(kt instanceof Uint8Array&&kt.constructor.name==="Uint8Array")return kt;if(kt instanceof ArrayBuffer)return new Uint8Array(kt);if(ArrayBuffer.isView(kt))return new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength);throw new Error("Unknown type, must be binary type")};let Encoder$5=class{constructor(At,xt,Bt){this.name=At,this.prefix=xt,this.baseEncode=Bt}encode(At){if(At instanceof Uint8Array)return`${this.prefix}${this.baseEncode(At)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{constructor(At,xt,Bt){if(this.name=At,this.prefix=xt,xt.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=xt.codePointAt(0),this.baseDecode=Bt}decode(At){if(typeof At=="string"){if(At.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(At)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(At.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(At){return or$3(this,At)}},ComposedDecoder$3=class{constructor(At){this.decoders=At}or(At){return or$3(this,At)}decode(At){const xt=At[0],Bt=this.decoders[xt];if(Bt)return Bt.decode(At);throw RangeError(`Unable to decode multibase string ${JSON.stringify(At)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$3=(kt,At)=>new ComposedDecoder$3({...kt.decoders||{[kt.prefix]:kt},...At.decoders||{[At.prefix]:At}});let Codec$3=class{constructor(At,xt,Bt,Nt){this.name=At,this.prefix=xt,this.baseEncode=Bt,this.baseDecode=Nt,this.encoder=new Encoder$5(At,xt,Bt),this.decoder=new Decoder$3(At,xt,Nt)}encode(At){return this.encoder.encode(At)}decode(At){return this.decoder.decode(At)}};const from$a=({name:kt,prefix:At,encode:xt,decode:Bt})=>new Codec$3(kt,At,xt,Bt),baseX$3=({prefix:kt,name:At,alphabet:xt})=>{const{encode:Bt,decode:Nt}=_brrp__multiformats_scope_baseX$3(xt,At);return from$a({prefix:kt,name:At,encode:Bt,decode:jt=>coerce$3(Nt(jt))})},decode$p=(kt,At,xt,Bt)=>{const Nt={};for(let zt=0;zt<At.length;++zt)Nt[At[zt]]=zt;let jt=kt.length;for(;kt[jt-1]==="=";)--jt;const Ut=new Uint8Array(jt*xt/8|0);let Lt=0,Ht=0,Vt=0;for(let zt=0;zt<jt;++zt){const Wt=Nt[kt[zt]];if(Wt===void 0)throw new SyntaxError(`Non-${Bt} character`);Ht=Ht<<xt|Wt,Lt+=xt,Lt>=8&&(Lt-=8,Ut[Vt++]=255&Ht>>Lt)}if(Lt>=xt||255&Ht<<8-Lt)throw new SyntaxError("Unexpected end of data");return Ut},encode$j=(kt,At,xt)=>{const Bt=At[At.length-1]==="=",Nt=(1<<xt)-1;let jt="",Ut=0,Lt=0;for(let Ht=0;Ht<kt.length;++Ht)for(Lt=Lt<<8|kt[Ht],Ut+=8;Ut>xt;)Ut-=xt,jt+=At[Nt&Lt>>Ut];if(Ut&&(jt+=At[Nt&Lt<<xt-Ut]),Bt)for(;jt.length*xt&7;)jt+="=";return jt},rfc4648$3=({name:kt,prefix:At,bitsPerChar:xt,alphabet:Bt})=>from$a({prefix:At,name:kt,encode(Nt){return encode$j(Nt,Bt,xt)},decode(Nt){return decode$p(Nt,Bt,xt,kt)}});rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const base64url$3=rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});const textEncoder$8=new TextEncoder,textDecoder$6=new TextDecoder;let Encoder$4=class Ko{static base64UrlToBytes(At){return base64url$3.baseDecode(At)}static base64UrlToObject(At){const xt=base64url$3.baseDecode(At);return Ko.bytesToObject(xt)}static bytesToBase64Url(At){return base64url$3.baseEncode(At)}static bytesToString(At){return textDecoder$6.decode(At)}static bytesToObject(At){const xt=Ko.bytesToString(At);return JSON.parse(xt)}static objectToBytes(At){const xt=JSON.stringify(At);return textEncoder$8.encode(xt)}static stringToBase64Url(At){const xt=textEncoder$8.encode(At);return base64url$3.baseEncode(xt)}static stringToBytes(At){return textEncoder$8.encode(At)}};/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const P$2=2n**255n-19n,N$2=2n**252n+27742317777372353535851937790883648493n,Gx$1=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy$1=0x6666666666666666666666666666666666666666666666666666666666666658n,CURVE$1={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,p:P$2,n:N$2,h:8,Gx:Gx$1,Gy:Gy$1},err$1=(kt="")=>{throw new Error(kt)},str$1=kt=>typeof kt=="string",au8$1=(kt,At)=>!(kt instanceof Uint8Array)||typeof At=="number"&&At>0&&kt.length!==At?err$1("Uint8Array expected"):kt,u8n$4=kt=>new Uint8Array(kt),toU8$1=(kt,At)=>au8$1(str$1(kt)?h2b$3(kt):u8n$4(kt),At),mod$4=(kt,At=P$2)=>{let xt=kt%At;return xt>=0n?xt:At+xt},isPoint$1=kt=>kt instanceof Point$4?kt:err$1("Point expected");let Gpows$1,Point$4=class ho{constructor(At,xt,Bt,Nt){this.ex=At,this.ey=xt,this.ez=Bt,this.et=Nt}static fromAffine(At){return new ho(At.x,At.y,1n,mod$4(At.x*At.y))}static fromHex(At,xt=!0){const{d:Bt}=CURVE$1;At=toU8$1(At,32);const Nt=At.slice();Nt[31]=At[31]&-129;const jt=b2n_LE(Nt);jt===0n||(xt&&!(0n<jt&&jt<P$2)&&err$1("bad y coord 1"),!xt&&!(0n<jt&&jt<2n**256n)&&err$1("bad y coord 2"));const Ut=mod$4(jt*jt),Lt=mod$4(Ut-1n),Ht=mod$4(Bt*Ut+1n);let{isValid:Vt,value:zt}=uvRatio$1(Lt,Ht);Vt||err$1("bad y coordinate 3");const Wt=(zt&1n)===1n;return(At[31]&128)!==0!==Wt&&(zt=mod$4(-zt)),new ho(zt,jt,1n,mod$4(zt*jt))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(At){const{ex:xt,ey:Bt,ez:Nt}=this,{ex:jt,ey:Ut,ez:Lt}=isPoint$1(At),Ht=mod$4(xt*Lt),Vt=mod$4(jt*Nt),zt=mod$4(Bt*Lt),Wt=mod$4(Ut*Nt);return Ht===Vt&&zt===Wt}is0(){return this.equals(I$2)}negate(){return new ho(mod$4(-this.ex),this.ey,this.ez,mod$4(-this.et))}double(){const{ex:At,ey:xt,ez:Bt}=this,{a:Nt}=CURVE$1,jt=mod$4(At*At),Ut=mod$4(xt*xt),Lt=mod$4(2n*mod$4(Bt*Bt)),Ht=mod$4(Nt*jt),Vt=At+xt,zt=mod$4(mod$4(Vt*Vt)-jt-Ut),Wt=Ht+Ut,Jt=Wt-Lt,Qt=Ht-Ut,Xt=mod$4(zt*Jt),tr=mod$4(Wt*Qt),rr=mod$4(zt*Qt),nr=mod$4(Jt*Wt);return new ho(Xt,tr,nr,rr)}add(At){const{ex:xt,ey:Bt,ez:Nt,et:jt}=this,{ex:Ut,ey:Lt,ez:Ht,et:Vt}=isPoint$1(At),{a:zt,d:Wt}=CURVE$1,Jt=mod$4(xt*Ut),Qt=mod$4(Bt*Lt),Xt=mod$4(jt*Wt*Vt),tr=mod$4(Nt*Ht),rr=mod$4((xt+Bt)*(Ut+Lt)-Jt-Qt),nr=mod$4(tr-Xt),ar=mod$4(tr+Xt),ir=mod$4(Qt-zt*Jt),lr=mod$4(rr*nr),yr=mod$4(ar*ir),Sr=mod$4(rr*ir),Ar=mod$4(nr*ar);return new ho(lr,yr,Ar,Sr)}mul(At,xt=!0){if(At===0n)return xt===!0?err$1("cannot multiply by 0"):I$2;if(typeof At=="bigint"&&0n<At&&At<N$2||err$1("invalid scalar, must be < L"),!xt&&this.is0()||At===1n)return this;if(this.equals(G$3))return wNAF$4(At).p;let Bt=I$2,Nt=G$3;for(let jt=this;At>0n;jt=jt.double(),At>>=1n)At&1n?Bt=Bt.add(jt):xt&&(Nt=Nt.add(jt));return Bt}multiply(At){return this.mul(At)}clearCofactor(){return this.mul(BigInt(CURVE$1.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let At=this.mul(N$2/2n,!1).double();return N$2%2n&&(At=At.add(this)),At.is0()}toAffine(){const{ex:At,ey:xt,ez:Bt}=this;if(this.is0())return{x:0n,y:0n};const Nt=invert$3(Bt);return mod$4(Bt*Nt)!==1n&&err$1("invalid inverse"),{x:mod$4(At*Nt),y:mod$4(xt*Nt)}}toRawBytes(){const{x:At,y:xt}=this.toAffine(),Bt=n2b_32LE(xt);return Bt[31]|=At&1n?128:0,Bt}toHex(){return b2h$1(this.toRawBytes())}};Point$4.BASE=new Point$4(Gx$1,Gy$1,1n,mod$4(Gx$1*Gy$1));Point$4.ZERO=new Point$4(0n,1n,1n,0n);const{BASE:G$3,ZERO:I$2}=Point$4,padh$1=(kt,At)=>kt.toString(16).padStart(At,"0"),b2h$1=kt=>Array.from(kt).map(At=>padh$1(At,2)).join(""),h2b$3=kt=>{const At=kt.length;(!str$1(kt)||At%2)&&err$1("hex invalid 1");const xt=u8n$4(At/2);for(let Bt=0;Bt<xt.length;Bt++){const Nt=Bt*2,jt=kt.slice(Nt,Nt+2),Ut=Number.parseInt(jt,16);(Number.isNaN(Ut)||Ut<0)&&err$1("hex invalid 2"),xt[Bt]=Ut}return xt},n2b_32LE=kt=>h2b$3(padh$1(kt,32*2)).reverse(),b2n_LE=kt=>BigInt("0x"+b2h$1(u8n$4(au8$1(kt)).reverse())),concatB$1=(...kt)=>{const At=u8n$4(kt.reduce((Bt,Nt)=>Bt+au8$1(Nt).length,0));let xt=0;return kt.forEach(Bt=>{At.set(Bt,xt),xt+=Bt.length}),At},invert$3=(kt,At=P$2)=>{(kt===0n||At<=0n)&&err$1("no inverse n="+kt+" mod="+At);let xt=mod$4(kt,At),Bt=At,Nt=0n,jt=1n;for(;xt!==0n;){const Ut=Bt/xt,Lt=Bt%xt,Ht=Nt-jt*Ut;Bt=xt,xt=Lt,Nt=jt,jt=Ht}return Bt===1n?mod$4(Nt,At):err$1("no inverse")},pow2$2=(kt,At)=>{let xt=kt;for(;At-- >0n;)xt*=xt,xt%=P$2;return xt},pow_2_252_3=kt=>{const xt=kt*kt%P$2*kt%P$2,Bt=pow2$2(xt,2n)*xt%P$2,Nt=pow2$2(Bt,1n)*kt%P$2,jt=pow2$2(Nt,5n)*Nt%P$2,Ut=pow2$2(jt,10n)*jt%P$2,Lt=pow2$2(Ut,20n)*Ut%P$2,Ht=pow2$2(Lt,40n)*Lt%P$2,Vt=pow2$2(Ht,80n)*Ht%P$2,zt=pow2$2(Vt,80n)*Ht%P$2,Wt=pow2$2(zt,10n)*jt%P$2;return{pow_p_5_8:pow2$2(Wt,2n)*kt%P$2,b2:xt}},RM1=19681161376707505956807079304988542015446066515923890162744021073123829784752n,uvRatio$1=(kt,At)=>{const xt=mod$4(At*At*At),Bt=mod$4(xt*xt*At),Nt=pow_2_252_3(kt*Bt).pow_p_5_8;let jt=mod$4(kt*xt*Nt);const Ut=mod$4(At*jt*jt),Lt=jt,Ht=mod$4(jt*RM1),Vt=Ut===kt,zt=Ut===mod$4(-kt),Wt=Ut===mod$4(-kt*RM1);return Vt&&(jt=Lt),(zt||Wt)&&(jt=Ht),(mod$4(jt)&1n)===1n&&(jt=mod$4(-jt)),{isValid:Vt||zt,value:jt}},modL_LE=kt=>mod$4(b2n_LE(kt),N$2);let _shaS;const sha512a=(...kt)=>etc$1.sha512Async(...kt),sha512s=(...kt)=>typeof _shaS=="function"?_shaS(...kt):err$1("etc.sha512Sync not set"),hash2extK=kt=>{const At=kt.slice(0,32);At[0]&=248,At[31]&=127,At[31]|=64;const xt=kt.slice(32,64),Bt=modL_LE(At),Nt=G$3.mul(Bt),jt=Nt.toRawBytes();return{head:At,prefix:xt,scalar:Bt,point:Nt,pointBytes:jt}},getExtendedPublicKeyAsync=kt=>sha512a(toU8$1(kt,32)).then(hash2extK),getExtendedPublicKey=kt=>hash2extK(sha512s(toU8$1(kt,32))),getPublicKeyAsync=kt=>getExtendedPublicKeyAsync(kt).then(At=>At.pointBytes);function hashFinish(kt,At){return sha512a(At.hashable).then(At.finish)}const _sign=(kt,At,xt)=>{const{pointBytes:Bt,scalar:Nt}=kt,jt=modL_LE(At),Ut=G$3.mul(jt).toRawBytes();return{hashable:concatB$1(Ut,Bt,xt),finish:Vt=>{const zt=mod$4(jt+modL_LE(Vt)*Nt,N$2);return au8$1(concatB$1(Ut,n2b_32LE(zt)),64)}}},signAsync$1=async(kt,At)=>{const xt=toU8$1(kt),Bt=await getExtendedPublicKeyAsync(At),Nt=await sha512a(Bt.prefix,xt);return hashFinish(!0,_sign(Bt,Nt,xt))},_verify=(kt,At,xt)=>{At=toU8$1(At),kt=toU8$1(kt,64);const Bt=Point$4.fromHex(xt,!1),Nt=Point$4.fromHex(kt.slice(0,32),!1),jt=b2n_LE(kt.slice(32,64)),Ut=G$3.mul(jt,!1);return{hashable:concatB$1(Nt.toRawBytes(),Bt.toRawBytes(),At),finish:Vt=>{const zt=modL_LE(Vt);return Nt.add(Bt.mul(zt,!1)).add(Ut.negate()).clearCofactor().is0()}}},verifyAsync=async(kt,At,xt)=>hashFinish(!0,_verify(kt,At,xt)),cr$2=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,etc$1={bytesToHex:b2h$1,hexToBytes:h2b$3,concatBytes:concatB$1,mod:mod$4,invert:invert$3,randomBytes:kt=>{const At=cr$2();return At||err$1("crypto.getRandomValues must be defined"),At.getRandomValues(u8n$4(kt))},sha512Async:async(...kt)=>{const At=cr$2();At||err$1("crypto.subtle or etc.sha512Async must be defined");const xt=concatB$1(...kt);return u8n$4(await At.subtle.digest("SHA-512",xt.buffer))},sha512Sync:void 0};Object.defineProperties(etc$1,{sha512Sync:{configurable:!1,get(){return _shaS},set(kt){_shaS||(_shaS=kt)}}});const utils$y={getExtendedPublicKeyAsync,getExtendedPublicKey,randomPrivateKey:()=>etc$1.randomBytes(32),precompute(kt=8,At=G$3){return At.multiply(3n),At}},W$8=8,precompute$1=()=>{const kt=[],At=256/W$8+1;let xt=G$3,Bt=xt;for(let Nt=0;Nt<At;Nt++){Bt=xt,kt.push(Bt);for(let jt=1;jt<2**(W$8-1);jt++)Bt=Bt.add(xt),kt.push(Bt);xt=Bt.double()}return kt},wNAF$4=kt=>{const At=Gpows$1||(Gpows$1=precompute$1()),xt=(zt,Wt)=>{let Jt=Wt.negate();return zt?Jt:Wt};let Bt=I$2,Nt=G$3;const jt=1+256/W$8,Ut=2**(W$8-1),Lt=BigInt(2**W$8-1),Ht=2**W$8,Vt=BigInt(W$8);for(let zt=0;zt<jt;zt++){const Wt=zt*Ut;let Jt=Number(kt&Lt);kt>>=Vt,Jt>Ut&&(Jt-=Ht,kt+=1n);const Qt=Wt,Xt=Wt+Math.abs(Jt)-1,tr=zt%2!==0,rr=Jt<0;Jt===0?Nt=Nt.add(xt(tr,At[Qt])):Bt=Bt.add(xt(rr,At[Xt]))}return{p:Bt,f:Nt}};class DwnError extends Error{constructor(At,xt){super(`${At}: ${xt}`),this.code=At,this.name="DwnError"}}var DwnErrorCode;(function(kt){kt.AuthenticateJwsMissing="AuthenticateJwsMissing",kt.AuthenticateDescriptorCidMismatch="AuthenticateDescriptorCidMismatch",kt.AuthenticationMoreThanOneSignatureNotSupported="AuthenticationMoreThanOneSignatureNotSupported",kt.AuthorizationNotGrantedToAuthor="AuthorizationNotGrantedToAuthor",kt.ComputeCidCodecNotSupported="ComputeCidCodecNotSupported",kt.ComputeCidMultihashNotSupported="ComputeCidMultihashNotSupported",kt.Ed25519InvalidJwk="Ed25519InvalidJwk",kt.EventEmitterStreamNotOpenError="EventEmitterStreamNotOpenError",kt.MessagesGrantAuthorizationMismatchedProtocol="EventsGrantAuthorizationMismatchedProtocol",kt.MessagesSubscribeAuthorizationFailed="MessagesSubscribeAuthorizationFailed",kt.MessagesSubscribeEventStreamUnimplemented="MessagesSubscribeEventStreamUnimplemented",kt.GeneralJwsVerifierGetPublicKeyNotFound="GeneralJwsVerifierGetPublicKeyNotFound",kt.GeneralJwsVerifierInvalidSignature="GeneralJwsVerifierInvalidSignature",kt.GrantAuthorizationGrantExpired="GrantAuthorizationGrantExpired",kt.GrantAuthorizationGrantMissing="GrantAuthorizationGrantMissing",kt.GrantAuthorizationGrantRevoked="GrantAuthorizationGrantRevoked",kt.GrantAuthorizationInterfaceMismatch="GrantAuthorizationInterfaceMismatch",kt.GrantAuthorizationMethodMismatch="GrantAuthorizationMethodMismatch",kt.GrantAuthorizationNotGrantedForTenant="GrantAuthorizationNotGrantedForTenant",kt.GrantAuthorizationNotGrantedToAuthor="GrantAuthorizationNotGrantedToAuthor",kt.GrantAuthorizationGrantNotYetActive="GrantAuthorizationGrantNotYetActive",kt.HdKeyDerivationPathInvalid="HdKeyDerivationPathInvalid",kt.JwsVerifySignatureUnsupportedCrv="JwsVerifySignatureUnsupportedCrv",kt.IndexInvalidCursorValueType="IndexInvalidCursorValueType",kt.IndexInvalidCursorSortProperty="IndexInvalidCursorSortProperty",kt.IndexInvalidSortPropertyInMemory="IndexInvalidSortPropertyInMemory",kt.IndexMissingIndexableProperty="IndexMissingIndexableProperty",kt.JwsDecodePlainObjectPayloadInvalid="JwsDecodePlainObjectPayloadInvalid",kt.MessagesReadInvalidCid="MessagesReadInvalidCid",kt.MessagesReadAuthorizationFailed="MessagesReadAuthorizationFailed",kt.MessageGetInvalidCid="MessageGetInvalidCid",kt.MessagesQueryAuthorizationFailed="MessagesQueryAuthorizationFailed",kt.MessagesReadVerifyScopeFailed="MessagesReadVerifyScopeFailed",kt.ParseCidCodecNotSupported="ParseCidCodecNotSupported",kt.ParseCidMultihashNotSupported="ParseCidMultihashNotSupported",kt.PermissionsProtocolCreateGrantRecordsScopeMissingProtocol="PermissionsProtocolCreateGrantRecordsScopeMissingProtocol",kt.PermissionsProtocolCreateRequestRecordsScopeMissingProtocol="PermissionsProtocolCreateRequestRecordsScopeMissingProtocol",kt.PermissionsProtocolGetScopeInvalidProtocol="PermissionsProtocolGetScopeInvalidProtocol",kt.PermissionsProtocolValidateSchemaUnexpectedRecord="PermissionsProtocolValidateSchemaUnexpectedRecord",kt.PermissionsProtocolValidateScopeContextIdProhibitedProperties="PermissionsProtocolValidateScopeContextIdProhibitedProperties",kt.PermissionsProtocolValidateScopeProtocolMismatch="PermissionsProtocolValidateScopeProtocolMismatch",kt.PermissionsProtocolValidateScopeMissingProtocolTag="PermissionsProtocolValidateScopeMissingProtocolTag",kt.PermissionsProtocolValidateRevocationProtocolTagMismatch="PermissionsProtocolValidateRevocationProtocolTagMismatch",kt.PrivateKeySignerUnableToDeduceAlgorithm="PrivateKeySignerUnableToDeduceAlgorithm",kt.PrivateKeySignerUnableToDeduceKeyId="PrivateKeySignerUnableToDeduceKeyId",kt.PrivateKeySignerUnsupportedCurve="PrivateKeySignerUnsupportedCurve",kt.ProtocolAuthorizationActionNotAllowed="ProtocolAuthorizationActionNotAllowed",kt.ProtocolAuthorizationActionRulesNotFound="ProtocolAuthorizationActionRulesNotFound",kt.ProtocolAuthorizationIncorrectDataFormat="ProtocolAuthorizationIncorrectDataFormat",kt.ProtocolAuthorizationIncorrectContextId="ProtocolAuthorizationIncorrectContextId",kt.ProtocolAuthorizationIncorrectProtocolPath="ProtocolAuthorizationIncorrectProtocolPath",kt.ProtocolAuthorizationDuplicateRoleRecipient="ProtocolAuthorizationDuplicateRoleRecipient",kt.ProtocolAuthorizationInvalidSchema="ProtocolAuthorizationInvalidSchema",kt.ProtocolAuthorizationInvalidType="ProtocolAuthorizationInvalidType",kt.ProtocolAuthorizationMatchingRoleRecordNotFound="ProtocolAuthorizationMatchingRoleRecordNotFound",kt.ProtocolAuthorizationMaxSizeInvalid="ProtocolAuthorizationMaxSizeInvalid",kt.ProtocolAuthorizationMinSizeInvalid="ProtocolAuthorizationMinSizeInvalid",kt.ProtocolAuthorizationMissingContextId="ProtocolAuthorizationMissingContextId",kt.ProtocolAuthorizationMissingRuleSet="ProtocolAuthorizationMissingRuleSet",kt.ProtocolAuthorizationParentlessIncorrectProtocolPath="ProtocolAuthorizationParentlessIncorrectProtocolPath",kt.ProtocolAuthorizationNotARole="ProtocolAuthorizationNotARole",kt.ProtocolAuthorizationParentNotFoundConstructingRecordChain="ProtocolAuthorizationParentNotFoundConstructingRecordChain",kt.ProtocolAuthorizationProtocolNotFound="ProtocolAuthorizationProtocolNotFound",kt.ProtocolAuthorizationRoleMissingRecipient="ProtocolAuthorizationRoleMissingRecipient",kt.ProtocolAuthorizationTagsInvalidSchema="ProtocolAuthorizationTagsInvalidSchema",kt.ProtocolsConfigureAuthorizationFailed="ProtocolsConfigureAuthorizationFailed",kt.ProtocolsConfigureDuplicateActorInRuleSet="ProtocolsConfigureDuplicateActorInRuleSet",kt.ProtocolsConfigureDuplicateRoleInRuleSet="ProtocolsConfigureDuplicateRoleInRuleSet",kt.ProtocolsConfigureInvalidSize="ProtocolsConfigureInvalidSize",kt.ProtocolsConfigureInvalidActionMissingOf="ProtocolsConfigureInvalidActionMissingOf",kt.ProtocolsConfigureInvalidActionOfNotAllowed="ProtocolsConfigureInvalidActionOfNotAllowed",kt.ProtocolsConfigureInvalidActionDeleteWithoutCreate="ProtocolsConfigureInvalidActionDeleteWithoutCreate",kt.ProtocolsConfigureInvalidActionUpdateWithoutCreate="ProtocolsConfigureInvalidActionUpdateWithoutCreate",kt.ProtocolsConfigureInvalidRecipientOfAction="ProtocolsConfigureInvalidRecipientOfAction",kt.ProtocolsConfigureInvalidRuleSetRecordType="ProtocolsConfigureInvalidRuleSetRecordType",kt.ProtocolsConfigureInvalidTagSchema="ProtocolsConfigureInvalidTagSchema",kt.ProtocolsConfigureRecordNestingDepthExceeded="ProtocolsConfigureRecordNestingDepthExceeded",kt.ProtocolsConfigureRoleDoesNotExistAtGivenPath="ProtocolsConfigureRoleDoesNotExistAtGivenPath",kt.ProtocolsGrantAuthorizationQueryProtocolScopeMismatch="ProtocolsGrantAuthorizationQueryProtocolScopeMismatch",kt.ProtocolsGrantAuthorizationScopeProtocolMismatch="ProtocolsGrantAuthorizationScopeProtocolMismatch",kt.ProtocolsQueryUnauthorized="ProtocolsQueryUnauthorized",kt.RecordsAuthorDelegatedGrantAndIdExistenceMismatch="RecordsAuthorDelegatedGrantAndIdExistenceMismatch",kt.RecordsAuthorDelegatedGrantCidMismatch="RecordsAuthorDelegatedGrantCidMismatch",kt.RecordsAuthorDelegatedGrantGrantedToAndOwnerSignatureMismatch="RecordsAuthorDelegatedGrantGrantedToAndOwnerSignatureMismatch",kt.RecordsAuthorDelegatedGrantNotADelegatedGrant="RecordsAuthorDelegatedGrantNotADelegatedGrant",kt.RecordsDecryptNoMatchingKeyEncryptedFound="RecordsDecryptNoMatchingKeyEncryptedFound",kt.RecordsDeleteAuthorizationFailed="RecordsDeleteAuthorizationFailed",kt.RecordsQueryCreateFilterPublishedSortInvalid="RecordsQueryCreateFilterPublishedSortInvalid",kt.RecordsQueryParseFilterPublishedSortInvalid="RecordsQueryParseFilterPublishedSortInvalid",kt.RecordsGrantAuthorizationConditionPublicationProhibited="RecordsGrantAuthorizationConditionPublicationProhibited",kt.RecordsGrantAuthorizationConditionPublicationRequired="RecordsGrantAuthorizationConditionPublicationRequired",kt.RecordsGrantAuthorizationDeleteProtocolScopeMismatch="RecordsGrantAuthorizationDeleteProtocolScopeMismatch",kt.RecordsGrantAuthorizationQueryOrSubscribeProtocolScopeMismatch="RecordsGrantAuthorizationQueryOrSubscribeProtocolScopeMismatch",kt.RecordsGrantAuthorizationScopeContextIdMismatch="RecordsGrantAuthorizationScopeContextIdMismatch",kt.RecordsGrantAuthorizationScopeProtocolMismatch="RecordsGrantAuthorizationScopeProtocolMismatch",kt.RecordsGrantAuthorizationScopeProtocolPathMismatch="RecordsGrantAuthorizationScopeProtocolPathMismatch",kt.RecordsDerivePrivateKeyUnSupportedCurve="RecordsDerivePrivateKeyUnSupportedCurve",kt.RecordsInvalidAncestorKeyDerivationSegment="RecordsInvalidAncestorKeyDerivationSegment",kt.RecordsOwnerDelegatedGrantAndIdExistenceMismatch="RecordsOwnerDelegatedGrantAndIdExistenceMismatch",kt.RecordsOwnerDelegatedGrantCidMismatch="RecordsOwnerDelegatedGrantCidMismatch",kt.RecordsOwnerDelegatedGrantGrantedToAndOwnerSignatureMismatch="RecordsOwnerDelegatedGrantGrantedToAndOwnerSignatureMismatch",kt.RecordsOwnerDelegatedGrantNotADelegatedGrant="RecordsOwnerDelegatedGrantNotADelegatedGrant",kt.RecordsProtocolContextDerivationSchemeMissingContextId="RecordsProtocolContextDerivationSchemeMissingContextId",kt.RecordsProtocolPathDerivationSchemeMissingProtocol="RecordsProtocolPathDerivationSchemeMissingProtocol",kt.RecordsQueryFilterMissingRequiredProperties="RecordsQueryFilterMissingRequiredProperties",kt.RecordsReadReturnedMultiple="RecordsReadReturnedMultiple",kt.RecordsReadAuthorizationFailed="RecordsReadAuthorizationFailed",kt.RecordsSubscribeEventStreamUnimplemented="RecordsSubscribeEventStreamUnimplemented",kt.RecordsSubscribeFilterMissingRequiredProperties="RecordsSubscribeFilterMissingRequiredProperties",kt.RecordsSchemasDerivationSchemeMissingSchema="RecordsSchemasDerivationSchemeMissingSchema",kt.RecordsWriteAttestationIntegrityMoreThanOneSignature="RecordsWriteAttestationIntegrityMoreThanOneSignature",kt.RecordsWriteAttestationIntegrityDescriptorCidMismatch="RecordsWriteAttestationIntegrityDescriptorCidMismatch",kt.RecordsWriteAttestationIntegrityInvalidPayloadProperty="RecordsWriteAttestationIntegrityInvalidPayloadProperty",kt.RecordsWriteAuthorizationFailed="RecordsWriteAuthorizationFailed",kt.RecordsWriteCreateMissingSigner="RecordsWriteCreateMissingSigner",kt.RecordsWriteCreateDataAndDataCidMutuallyExclusive="RecordsWriteCreateDataAndDataCidMutuallyExclusive",kt.RecordsWriteCreateDataCidAndDataSizeMutuallyInclusive="RecordsWriteCreateDataCidAndDataSizeMutuallyInclusive",kt.RecordsWriteCreateProtocolAndProtocolPathMutuallyInclusive="RecordsWriteCreateProtocolAndProtocolPathMutuallyInclusive",kt.RecordsWriteDataCidMismatch="RecordsWriteDataCidMismatch",kt.RecordsWriteDataSizeMismatch="RecordsWriteDataSizeMismatch",kt.RecordsWriteGetEntryIdUndefinedAuthor="RecordsWriteGetEntryIdUndefinedAuthor",kt.RecordsWriteGetNewestWriteRecordNotFound="RecordsWriteGetNewestWriteRecordNotFound",kt.RecordsWriteGetInitialWriteNotFound="RecordsWriteGetInitialWriteNotFound",kt.RecordsWriteImmutablePropertyChanged="RecordsWriteImmutablePropertyChanged",kt.RecordsWriteMissingSigner="RecordsWriteMissingSigner",kt.RecordsWriteMissingDataInPrevious="RecordsWriteMissingDataInPrevious",kt.RecordsWriteMissingEncodedDataInPrevious="RecordsWriteMissingEncodedDataInPrevious",kt.RecordsWriteMissingProtocol="RecordsWriteMissingProtocol",kt.RecordsWriteMissingSchema="RecordsWriteMissingSchema",kt.RecordsWriteNotAllowedAfterDelete="RecordsWriteNotAllowedAfterDelete",kt.RecordsWriteOwnerAndTenantMismatch="RecordsWriteOwnerAndTenantMismatch",kt.RecordsWriteSignAsOwnerDelegateUnknownAuthor="RecordsWriteSignAsOwnerDelegateUnknownAuthor",kt.RecordsWriteSignAsOwnerUnknownAuthor="RecordsWriteSignAsOwnerUnknownAuthor",kt.RecordsWriteValidateIntegrityAttestationMismatch="RecordsWriteValidateIntegrityAttestationMismatch",kt.RecordsWriteValidateIntegrityContextIdMismatch="RecordsWriteValidateIntegrityContextIdMismatch",kt.RecordsWriteValidateIntegrityContextIdNotInSignerSignaturePayload="RecordsWriteValidateIntegrityContextIdNotInSignerSignaturePayload",kt.RecordsWriteValidateIntegrityDateCreatedMismatch="RecordsWriteValidateIntegrityDateCreatedMismatch",kt.RecordsWriteValidateIntegrityEncryptionCidMismatch="RecordsWriteValidateIntegrityEncryptionCidMismatch",kt.RecordsWriteValidateIntegrityRecordIdUnauthorized="RecordsWriteValidateIntegrityRecordIdUnauthorized",kt.SchemaValidatorAdditionalPropertyNotAllowed="SchemaValidatorAdditionalPropertyNotAllowed",kt.SchemaValidatorFailure="SchemaValidatorFailure",kt.SchemaValidatorSchemaNotFound="SchemaValidatorSchemaNotFound",kt.SchemaValidatorUnevaluatedPropertyNotAllowed="SchemaValidatorUnevaluatedPropertyNotAllowed",kt.Secp256k1KeyNotValid="Secp256k1KeyNotValid",kt.Secp256r1KeyNotValid="Secp256r1KeyNotValid",kt.TimestampInvalid="TimestampInvalid",kt.UrlProtocolNotNormalized="UrlProtocolNotNormalized",kt.UrlProtocolNotNormalizable="UrlProtocolNotNormalizable",kt.UrlSchemaNotNormalized="UrlSchemaNotNormalized"})(DwnErrorCode||(DwnErrorCode={}));var __awaiter$2J=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function validateKey(kt){if(kt.kty!=="OKP"||kt.crv!=="Ed25519")throw new DwnError(DwnErrorCode.Ed25519InvalidJwk,"invalid jwk. kty MUST be OKP. crv MUST be Ed25519")}function publicKeyToJwk(kt){return{alg:"EdDSA",kty:"OKP",crv:"Ed25519",x:Encoder$4.bytesToBase64Url(kt)}}const ed25519$2={sign:(kt,At)=>__awaiter$2J(void 0,void 0,void 0,function*(){validateKey(At);const xt=Encoder$4.base64UrlToBytes(At.d);return signAsync$1(kt,xt)}),verify:(kt,At,xt)=>__awaiter$2J(void 0,void 0,void 0,function*(){validateKey(xt);const Bt=Encoder$4.base64UrlToBytes(xt.x);return verifyAsync(At,kt,Bt)}),generateKeyPair:()=>__awaiter$2J(void 0,void 0,void 0,function*(){const kt=utils$y.randomPrivateKey(),At=yield getPublicKeyAsync(kt),xt=Encoder$4.bytesToBase64Url(kt),Bt=publicKeyToJwk(At),Nt=Object.assign(Object.assign({},Bt),{d:xt});return{publicJwk:Bt,privateJwk:Nt}}),publicKeyToJwk:kt=>__awaiter$2J(void 0,void 0,void 0,function*(){return publicKeyToJwk(kt)})};/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const B256=2n**256n,P$1=B256-0x1000003d1n,N$1=B256-0x14551231950b75fc4402da1732fc9bebfn,Gx=0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,CURVE={p:P$1,n:N$1,a:0n,b:7n,Gx,Gy},fLen=32,crv=kt=>mod$3(mod$3(kt*kt)*kt+CURVE.b),err=(kt="")=>{throw new Error(kt)},big=kt=>typeof kt=="bigint",str=kt=>typeof kt=="string",fe$1=kt=>big(kt)&&0n<kt&&kt<P$1,ge$1=kt=>big(kt)&&0n<kt&&kt<N$1,au8=(kt,At)=>!(kt instanceof Uint8Array)||typeof At=="number"&&At>0&&kt.length!==At?err("Uint8Array expected"):kt,u8n$3=kt=>new Uint8Array(kt),toU8=(kt,At)=>au8(str(kt)?h2b$2(kt):u8n$3(kt),At),mod$3=(kt,At=P$1)=>{let xt=kt%At;return xt>=0n?xt:At+xt},isPoint=kt=>kt instanceof Point$3?kt:err("Point expected");let Gpows,Point$3=class po{constructor(At,xt,Bt){this.px=At,this.py=xt,this.pz=Bt}static fromAffine(At){return new po(At.x,At.y,1n)}static fromHex(At){At=toU8(At);let xt;const Bt=At[0],Nt=At.subarray(1),jt=slcNum(Nt,0,fLen),Ut=At.length;if(Ut===33&&[2,3].includes(Bt)){fe$1(jt)||err("Point hex invalid: x not FE");let Lt=sqrt(crv(jt));const Ht=(Lt&1n)===1n;(Bt&1)===1!==Ht&&(Lt=mod$3(-Lt)),xt=new po(jt,Lt,1n)}return Ut===65&&Bt===4&&(xt=new po(jt,slcNum(Nt,fLen,2*fLen),1n)),xt?xt.ok():err("Point is not on curve")}static fromPrivateKey(At){return G$2.mul(toPriv(At))}get x(){return this.aff().x}get y(){return this.aff().y}equals(At){const{px:xt,py:Bt,pz:Nt}=this,{px:jt,py:Ut,pz:Lt}=isPoint(At),Ht=mod$3(xt*Lt),Vt=mod$3(jt*Nt),zt=mod$3(Bt*Lt),Wt=mod$3(Ut*Nt);return Ht===Vt&&zt===Wt}negate(){return new po(this.px,mod$3(-this.py),this.pz)}double(){return this.add(this)}add(At){const{px:xt,py:Bt,pz:Nt}=this,{px:jt,py:Ut,pz:Lt}=isPoint(At),{a:Ht,b:Vt}=CURVE;let zt=0n,Wt=0n,Jt=0n;const Qt=mod$3(Vt*3n);let Xt=mod$3(xt*jt),tr=mod$3(Bt*Ut),rr=mod$3(Nt*Lt),nr=mod$3(xt+Bt),ar=mod$3(jt+Ut);nr=mod$3(nr*ar),ar=mod$3(Xt+tr),nr=mod$3(nr-ar),ar=mod$3(xt+Nt);let ir=mod$3(jt+Lt);return ar=mod$3(ar*ir),ir=mod$3(Xt+rr),ar=mod$3(ar-ir),ir=mod$3(Bt+Nt),zt=mod$3(Ut+Lt),ir=mod$3(ir*zt),zt=mod$3(tr+rr),ir=mod$3(ir-zt),Jt=mod$3(Ht*ar),zt=mod$3(Qt*rr),Jt=mod$3(zt+Jt),zt=mod$3(tr-Jt),Jt=mod$3(tr+Jt),Wt=mod$3(zt*Jt),tr=mod$3(Xt+Xt),tr=mod$3(tr+Xt),rr=mod$3(Ht*rr),ar=mod$3(Qt*ar),tr=mod$3(tr+rr),rr=mod$3(Xt-rr),rr=mod$3(Ht*rr),ar=mod$3(ar+rr),Xt=mod$3(tr*ar),Wt=mod$3(Wt+Xt),Xt=mod$3(ir*ar),zt=mod$3(nr*zt),zt=mod$3(zt-Xt),Xt=mod$3(nr*tr),Jt=mod$3(ir*Jt),Jt=mod$3(Jt+Xt),new po(zt,Wt,Jt)}mul(At,xt=!0){if(!xt&&At===0n)return I$1;if(ge$1(At)||err("invalid scalar"),this.equals(G$2))return wNAF$3(At).p;let Bt=I$1,Nt=G$2;for(let jt=this;At>0n;jt=jt.double(),At>>=1n)At&1n?Bt=Bt.add(jt):xt&&(Nt=Nt.add(jt));return Bt}mulAddQUns(At,xt,Bt){return this.mul(xt,!1).add(At.mul(Bt,!1)).ok()}toAffine(){const{px:At,py:xt,pz:Bt}=this;if(this.equals(I$1))return{x:0n,y:0n};if(Bt===1n)return{x:At,y:xt};const Nt=inv(Bt);return mod$3(Bt*Nt)!==1n&&err("invalid inverse"),{x:mod$3(At*Nt),y:mod$3(xt*Nt)}}assertValidity(){const{x:At,y:xt}=this.aff();return(!fe$1(At)||!fe$1(xt))&&err("Point invalid: x or y"),mod$3(xt*xt)===crv(At)?this:err("Point invalid: not on curve")}multiply(At){return this.mul(At)}aff(){return this.toAffine()}ok(){return this.assertValidity()}toHex(At=!0){const{x:xt,y:Bt}=this.aff();return(At?(Bt&1n)===0n?"02":"03":"04")+n2h(xt)+(At?"":n2h(Bt))}toRawBytes(At=!0){return h2b$2(this.toHex(At))}};Point$3.BASE=new Point$3(Gx,Gy,1n);Point$3.ZERO=new Point$3(0n,1n,0n);const{BASE:G$2,ZERO:I$1}=Point$3,padh=(kt,At)=>kt.toString(16).padStart(At,"0"),b2h=kt=>Array.from(kt).map(At=>padh(At,2)).join(""),h2b$2=kt=>{const At=kt.length;(!str(kt)||At%2)&&err("hex invalid 1");const xt=u8n$3(At/2);for(let Bt=0;Bt<xt.length;Bt++){const Nt=Bt*2,jt=kt.slice(Nt,Nt+2),Ut=Number.parseInt(jt,16);(Number.isNaN(Ut)||Ut<0)&&err("hex invalid 2"),xt[Bt]=Ut}return xt},b2n$2=kt=>BigInt("0x"+(b2h(kt)||"0")),slcNum=(kt,At,xt)=>b2n$2(kt.slice(At,xt)),n2b=kt=>big(kt)&&kt>=0n&&kt<B256?h2b$2(padh(kt,2*fLen)):err("bigint expected"),n2h=kt=>b2h(n2b(kt)),concatB=(...kt)=>{const At=u8n$3(kt.reduce((Bt,Nt)=>Bt+au8(Nt).length,0));let xt=0;return kt.forEach(Bt=>{At.set(Bt,xt),xt+=Bt.length}),At},inv=(kt,At=P$1)=>{(kt===0n||At<=0n)&&err("no inverse n="+kt+" mod="+At);let xt=mod$3(kt,At),Bt=At,Nt=0n,jt=1n;for(;xt!==0n;){const Ut=Bt/xt,Lt=Bt%xt,Ht=Nt-jt*Ut;Bt=xt,xt=Lt,Nt=jt,jt=Ht}return Bt===1n?mod$3(Nt,At):err("no inverse")},sqrt=kt=>{let At=1n;for(let xt=kt,Bt=(P$1+1n)/4n;Bt>0n;Bt>>=1n)Bt&1n&&(At=At*xt%P$1),xt=xt*xt%P$1;return mod$3(At*At)===kt?At:err("sqrt invalid")},toPriv=kt=>(big(kt)||(kt=b2n$2(toU8(kt,fLen))),ge$1(kt)?kt:err("private key out of range")),moreThanHalfN=kt=>kt>N$1>>1n;function getPublicKey$1(kt,At=!0){return Point$3.fromPrivateKey(kt).toRawBytes(At)}let Signature$3=class Go{constructor(At,xt,Bt){this.r=At,this.s=xt,this.recovery=Bt,this.assertValidity()}static fromCompact(At){return At=toU8(At,64),new Go(slcNum(At,0,fLen),slcNum(At,fLen,2*fLen))}assertValidity(){return ge$1(this.r)&&ge$1(this.s)?this:err()}addRecoveryBit(At){return new Go(this.r,this.s,At)}hasHighS(){return moreThanHalfN(this.s)}recoverPublicKey(At){const{r:xt,s:Bt,recovery:Nt}=this;[0,1,2,3].includes(Nt)||err("recovery id invalid");const jt=bits2int_modN(toU8(At,32)),Ut=Nt===2||Nt===3?xt+N$1:xt;Ut>=P$1&&err("q.x invalid");const Lt=Nt&1?"03":"02",Ht=Point$3.fromHex(Lt+n2h(Ut)),Vt=inv(Ut,N$1),zt=mod$3(-jt*Vt,N$1),Wt=mod$3(Bt*Vt,N$1);return G$2.mulAddQUns(Ht,zt,Wt)}toCompactRawBytes(){return h2b$2(this.toCompactHex())}toCompactHex(){return n2h(this.r)+n2h(this.s)}};const bits2int=kt=>{const At=kt.length*8-256,xt=b2n$2(kt);return At>0?xt>>BigInt(At):xt},bits2int_modN=kt=>mod$3(bits2int(kt),N$1),i2o=kt=>n2b(kt),cr$1=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;let _hmacSync;const optS={lowS:!0},optV={lowS:!0};function prepSig(kt,At,xt=optS){["der","recovered","canonical"].some(Wt=>Wt in xt)&&err("sign() legacy options not supported");let{lowS:Bt}=xt;Bt==null&&(Bt=!0);const Nt=bits2int_modN(toU8(kt)),jt=i2o(Nt),Ut=toPriv(At),Lt=[i2o(Ut),jt];let Ht=xt.extraEntropy;if(Ht){Ht===!0&&(Ht=etc.randomBytes(fLen));const Wt=toU8(Ht);Wt.length!==fLen&&err(),Lt.push(Wt)}const Vt=Nt,zt=Wt=>{const Jt=bits2int(Wt);if(!ge$1(Jt))return;const Qt=inv(Jt,N$1),Xt=G$2.mul(Jt).aff(),tr=mod$3(Xt.x,N$1);if(tr===0n)return;const rr=mod$3(Qt*mod$3(Vt+mod$3(Ut*tr,N$1),N$1),N$1);if(rr===0n)return;let nr=rr,ar=(Xt.x===tr?0:2)|Number(Xt.y&1n);return Bt&&moreThanHalfN(rr)&&(nr=mod$3(-rr,N$1),ar^=1),new Signature$3(tr,nr,ar)};return{seed:concatB(...Lt),k2sig:zt}}function hmacDrbg$1(kt){let At=u8n$3(fLen),xt=u8n$3(fLen),Bt=0;const Nt=()=>{At.fill(1),xt.fill(0),Bt=0},jt="drbg: tried 1000 values";{const Ut=(...Vt)=>etc.hmacSha256Async(xt,At,...Vt),Lt=async(Vt=u8n$3())=>{xt=await Ut(u8n$3([0]),Vt),At=await Ut(),Vt.length!==0&&(xt=await Ut(u8n$3([1]),Vt),At=await Ut())},Ht=async()=>(Bt++>=1e3&&err(jt),At=await Ut(),At);return async(Vt,zt)=>{Nt(),await Lt(Vt);let Wt;for(;!(Wt=zt(await Ht()));)await Lt();return Nt(),Wt}}}async function signAsync(kt,At,xt=optS){const{seed:Bt,k2sig:Nt}=prepSig(kt,At,xt);return hmacDrbg$1()(Bt,Nt)}function verify(kt,At,xt,Bt=optV){let{lowS:Nt}=Bt;Nt==null&&(Nt=!0),"strict"in Bt&&err("verify() legacy options not supported");let jt,Ut,Lt;const Ht=kt&&typeof kt=="object"&&"r"in kt;!Ht&&toU8(kt).length!==2*fLen&&err("signature must be 64 bytes");try{jt=Ht?new Signature$3(kt.r,kt.s).assertValidity():Signature$3.fromCompact(kt),Ut=bits2int_modN(toU8(At,fLen)),Lt=xt instanceof Point$3?xt.ok():Point$3.fromHex(xt)}catch{return!1}if(!jt)return!1;const{r:Vt,s:zt}=jt;if(Nt&&moreThanHalfN(zt))return!1;let Wt;try{const Qt=inv(zt,N$1),Xt=mod$3(Ut*Qt,N$1),tr=mod$3(Vt*Qt,N$1);Wt=G$2.mulAddQUns(Lt,Xt,tr).aff()}catch{return!1}return Wt?mod$3(Wt.x,N$1)===Vt:!1}function hashToPrivateKey(kt){kt=toU8(kt);const At=fLen+8;(kt.length<At||kt.length>1024)&&err("expected proper params");const xt=mod$3(b2n$2(kt),N$1-1n)+1n;return n2b(xt)}const etc={hexToBytes:h2b$2,bytesToHex:b2h,concatBytes:concatB,bytesToNumberBE:b2n$2,numberToBytesBE:n2b,mod:mod$3,invert:inv,hmacSha256Async:async(kt,...At)=>{const xt=cr$1();if(!xt)return err("etc.hmacSha256Async not set");const Bt=xt.subtle,Nt=await Bt.importKey("raw",kt,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return u8n$3(await Bt.sign("HMAC",Nt,concatB(...At)))},hmacSha256Sync:_hmacSync,hashToPrivateKey,randomBytes:kt=>{const At=cr$1();return At||err("crypto.getRandomValues must be defined"),At.getRandomValues(u8n$3(kt))}},utils$x={normPrivateKeyToScalar:toPriv,isValidPrivateKey:kt=>{try{return!!toPriv(kt)}catch{return!1}},randomPrivateKey:()=>hashToPrivateKey(etc.randomBytes(fLen+8)),precompute(kt=8,At=G$2){return At.multiply(3n),At}};Object.defineProperties(etc,{hmacSha256Sync:{configurable:!1,get(){return _hmacSync},set(kt){_hmacSync||(_hmacSync=kt)}}});const W$7=8,precompute=()=>{const kt=[],At=256/W$7+1;let xt=G$2,Bt=xt;for(let Nt=0;Nt<At;Nt++){Bt=xt,kt.push(Bt);for(let jt=1;jt<2**(W$7-1);jt++)Bt=Bt.add(xt),kt.push(Bt);xt=Bt.double()}return kt},wNAF$3=kt=>{const At=Gpows||(Gpows=precompute()),xt=(zt,Wt)=>{let Jt=Wt.negate();return zt?Jt:Wt};let Bt=I$1,Nt=G$2;const jt=1+256/W$7,Ut=2**(W$7-1),Lt=BigInt(2**W$7-1),Ht=2**W$7,Vt=BigInt(W$7);for(let zt=0;zt<jt;zt++){const Wt=zt*Ut;let Jt=Number(kt&Lt);kt>>=Vt,Jt>Ut&&(Jt-=Ht,kt+=1n);const Qt=Wt,Xt=Wt+Math.abs(Jt)-1,tr=zt%2!==0,rr=Jt<0;Jt===0?Nt=Nt.add(xt(tr,At[Qt])):Bt=Bt.add(xt(rr,At[Xt]))}return{p:Bt,f:Nt}};var encode_1$3=encode$i,MSB$5=128,REST$5=127,MSBALL$3=~REST$5,INT$3=Math.pow(2,31);function encode$i(kt,At,xt){At=At||[],xt=xt||0;for(var Bt=xt;kt>=INT$3;)At[xt++]=kt&255|MSB$5,kt/=128;for(;kt&MSBALL$3;)At[xt++]=kt&255|MSB$5,kt>>>=7;return At[xt]=kt|0,encode$i.bytes=xt-Bt+1,At}var decode$o=read$4,MSB$1$3=128,REST$1$3=127;function read$4(kt,Bt){var xt=0,Bt=Bt||0,Nt=0,jt=Bt,Ut,Lt=kt.length;do{if(jt>=Lt)throw read$4.bytes=0,new RangeError("Could not decode varint");Ut=kt[jt++],xt+=Nt<28?(Ut&REST$1$3)<<Nt:(Ut&REST$1$3)*Math.pow(2,Nt),Nt+=7}while(Ut>=MSB$1$3);return read$4.bytes=jt-Bt,xt}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),length$4=function(kt){return kt<N1$4?1:kt<N2$4?2:kt<N3$4?3:kt<N4$4?4:kt<N5$4?5:kt<N6$4?6:kt<N7$4?7:kt<N8$3?8:kt<N9$3?9:10},varint$3={encode:encode_1$3,decode:decode$o,encodingLength:length$4},_brrp_varint$3=varint$3;const decode$n=(kt,At=0)=>[_brrp_varint$3.decode(kt,At),_brrp_varint$3.decode.bytes],encodeTo$3=(kt,At,xt=0)=>(_brrp_varint$3.encode(kt,At,xt),At),encodingLength$8=kt=>_brrp_varint$3.encodingLength(kt),create$2=(kt,At)=>{const xt=At.byteLength,Bt=encodingLength$8(kt),Nt=Bt+encodingLength$8(xt),jt=new Uint8Array(Nt+xt);return encodeTo$3(kt,jt,0),encodeTo$3(xt,jt,Bt),jt.set(At,Nt),new Digest$2(kt,xt,At,jt)},decode$m=kt=>{const At=coerce$3(kt),[xt,Bt]=decode$n(At),[Nt,jt]=decode$n(At.subarray(Bt)),Ut=At.subarray(Bt+jt);if(Ut.byteLength!==Nt)throw new Error("Incorrect length");return new Digest$2(xt,Nt,Ut,At)},equals$5=(kt,At)=>{if(kt===At)return!0;{const xt=At;return kt.code===xt.code&&kt.size===xt.size&&xt.bytes instanceof Uint8Array&&equals$6(kt.bytes,xt.bytes)}};let Digest$2=class{constructor(At,xt,Bt,Nt){this.code=At,this.size=xt,this.digest=Bt,this.bytes=Nt}};const from$9=({name:kt,code:At,encode:xt})=>new Hasher$2(kt,At,xt);let Hasher$2=class{constructor(At,xt,Bt){this.name=At,this.code=xt,this.encode=Bt}digest(At){if(At instanceof Uint8Array){const xt=this.encode(At);return xt instanceof Uint8Array?create$2(this.code,xt):xt.then(Bt=>create$2(this.code,Bt))}else throw Error("Unknown type, must be binary type")}};const sha$6=kt=>async At=>new Uint8Array(await crypto.subtle.digest(kt,At)),sha256$7=from$9({name:"sha2-256",code:18,encode:sha$6("SHA-256")});var __awaiter$2I=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$A=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Secp256k1$3=class Hi{static validateKey(At){if(At.kty!=="EC"||At.crv!=="secp256k1")throw new DwnError(DwnErrorCode.Secp256k1KeyNotValid,"Invalid SECP256K1 JWK: `kty` MUST be `EC`. `crv` MUST be `secp256k1`")}static publicKeyToJwk(At){return __awaiter$2I(this,void 0,void 0,function*(){let xt;At.byteLength===33?xt=Point$3.fromHex(At).toRawBytes(!1):xt=At;const Bt=Encoder$4.bytesToBase64Url(xt.subarray(1,33)),Nt=Encoder$4.bytesToBase64Url(xt.subarray(33,65));return{alg:"ES256K",kty:"EC",crv:"secp256k1",x:Bt,y:Nt}})}static privateKeyToJwk(At){return __awaiter$2I(this,void 0,void 0,function*(){const xt=yield Hi.getPublicKey(At),Bt=yield Hi.publicKeyToJwk(xt);return Bt.d=Encoder$4.bytesToBase64Url(At),Bt})}static publicJwkToBytes(At){const xt=Encoder$4.base64UrlToBytes(At.x),Bt=Encoder$4.base64UrlToBytes(At.y);return Point$3.fromAffine({x:etc.bytesToNumberBE(xt),y:etc.bytesToNumberBE(Bt)}).toRawBytes(!0)}static privateJwkToBytes(At){return Encoder$4.base64UrlToBytes(At.d)}static sign(At,xt){return __awaiter$2I(this,void 0,void 0,function*(){Hi.validateKey(xt);const Bt=yield sha256$7.encode(At),Nt=Hi.privateJwkToBytes(xt);return(yield signAsync(Bt,Nt)).toCompactRawBytes()})}static verify(At,xt,Bt){return __awaiter$2I(this,void 0,void 0,function*(){Hi.validateKey(Bt);const Nt=Hi.publicJwkToBytes(Bt),jt=yield sha256$7.encode(At);return verify(xt,jt,Nt)})}static generateKeyPair(){return __awaiter$2I(this,void 0,void 0,function*(){const At=utils$x.randomPrivateKey(),xt=getPublicKey$1(At,!1),Bt=Encoder$4.bytesToBase64Url(At),Nt=yield Hi.publicKeyToJwk(xt),jt=Object.assign(Object.assign({},Nt),{d:Bt});return{publicJwk:Nt,privateJwk:jt}})}static generateKeyPairRaw(){return __awaiter$2I(this,void 0,void 0,function*(){const At=utils$x.randomPrivateKey();return{publicKey:getPublicKey$1(At,!0),privateKey:At}})}static getPublicKey(At){return __awaiter$2I(this,void 0,void 0,function*(){return getPublicKey$1(At,!0)})}static getPublicJwk(At){return __awaiter$2I(this,void 0,void 0,function*(){return __rest$A(At,["d"])})}};function number$4(kt){if(!Number.isSafeInteger(kt)||kt<0)throw new Error(`positive integer expected, not ${kt}`)}function isBytes$b(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}function bytes$5(kt,...At){if(!isBytes$b(kt))throw new Error("Uint8Array expected");if(At.length>0&&!At.includes(kt.length))throw new Error(`Uint8Array expected of length ${At}, not of length=${kt.length}`)}function hash$7(kt){if(typeof kt!="function"||typeof kt.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$4(kt.outputLen),number$4(kt.blockLen)}function exists$6(kt,At=!0){if(kt.destroyed)throw new Error("Hash instance has been destroyed");if(At&&kt.finished)throw new Error("Hash#digest() has already been called")}function output$5(kt,At){bytes$5(kt);const xt=At.outputLen;if(kt.length<xt)throw new Error(`digestInto() expects output buffer of length at least ${xt}`)}const crypto$7=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$a(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}const u8=kt=>new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength),u32$2=kt=>new Uint32Array(kt.buffer,kt.byteOffset,Math.floor(kt.byteLength/4)),createView$2=kt=>new DataView(kt.buffer,kt.byteOffset,kt.byteLength),rotr$1=(kt,At)=>kt<<32-At|kt>>>At,rotl$4=(kt,At)=>kt<<At|kt>>>32-At>>>0,isLE$3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,byteSwap=kt=>kt<<24&4278190080|kt<<8&16711680|kt>>>8&65280|kt>>>24&255,byteSwapIfBE=isLE$3?kt=>kt:kt=>byteSwap(kt);function byteSwap32(kt){for(let At=0;At<kt.length;At++)kt[At]=byteSwap(kt[At])}const hexes$4=Array.from({length:256},(kt,At)=>At.toString(16).padStart(2,"0"));function bytesToHex$4(kt){bytes$5(kt);let At="";for(let xt=0;xt<kt.length;xt++)At+=hexes$4[kt[xt]];return At}const asciis$4={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$4(kt){if(kt>=asciis$4._0&&kt<=asciis$4._9)return kt-asciis$4._0;if(kt>=asciis$4._A&&kt<=asciis$4._F)return kt-(asciis$4._A-10);if(kt>=asciis$4._a&&kt<=asciis$4._f)return kt-(asciis$4._a-10)}function hexToBytes$4(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);const At=kt.length,xt=At/2;if(At%2)throw new Error("padded hex string expected, got unpadded hex of length "+At);const Bt=new Uint8Array(xt);for(let Nt=0,jt=0;Nt<xt;Nt++,jt+=2){const Ut=asciiToBase16$4(kt.charCodeAt(jt)),Lt=asciiToBase16$4(kt.charCodeAt(jt+1));if(Ut===void 0||Lt===void 0){const Ht=kt[jt]+kt[jt+1];throw new Error('hex string expected, got non-hex character "'+Ht+'" at index '+jt)}Bt[Nt]=Ut*16+Lt}return Bt}const nextTick$4=async()=>{};async function asyncLoop$1(kt,At,xt){let Bt=Date.now();for(let Nt=0;Nt<kt;Nt++){xt(Nt);const jt=Date.now()-Bt;jt>=0&&jt<At||(await nextTick$4(),Bt+=jt)}}function utf8ToBytes$7(kt){if(typeof kt!="string")throw new Error(`utf8ToBytes expected string, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function toBytes$3(kt){return typeof kt=="string"&&(kt=utf8ToBytes$7(kt)),bytes$5(kt),kt}function concatBytes$4(...kt){let At=0;for(let Bt=0;Bt<kt.length;Bt++){const Nt=kt[Bt];bytes$5(Nt),At+=Nt.length}const xt=new Uint8Array(At);for(let Bt=0,Nt=0;Bt<kt.length;Bt++){const jt=kt[Bt];xt.set(jt,Nt),Nt+=jt.length}return xt}let Hash$9=class{clone(){return this._cloneInto()}};const toStr$5={}.toString;function checkOpts$2(kt,At){if(At!==void 0&&toStr$5.call(At)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(kt,At)}function wrapConstructor$1(kt){const At=Bt=>kt().update(toBytes$3(Bt)).digest(),xt=kt();return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=()=>kt(),At}function wrapConstructorWithOpts(kt){const At=(Bt,Nt)=>kt(Nt).update(toBytes$3(Bt)).digest(),xt=kt({});return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=Bt=>kt(Bt),At}function wrapXOFConstructorWithOpts(kt){const At=(Bt,Nt)=>kt(Nt).update(toBytes$3(Bt)).digest(),xt=kt({});return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=Bt=>kt(Bt),At}function randomBytes$7(kt=32){if(crypto$7&&typeof crypto$7.getRandomValues=="function")return crypto$7.getRandomValues(new Uint8Array(kt));throw new Error("crypto.getRandomValues must be defined")}const utils$w=Object.freeze(Object.defineProperty({__proto__:null,Hash:Hash$9,asyncLoop:asyncLoop$1,byteSwap,byteSwap32,byteSwapIfBE,bytesToHex:bytesToHex$4,checkOpts:checkOpts$2,concatBytes:concatBytes$4,createView:createView$2,hexToBytes:hexToBytes$4,isBytes:isBytes$a,isLE:isLE$3,nextTick:nextTick$4,randomBytes:randomBytes$7,rotl:rotl$4,rotr:rotr$1,toBytes:toBytes$3,u32:u32$2,u8,utf8ToBytes:utf8ToBytes$7,wrapConstructor:wrapConstructor$1,wrapConstructorWithOpts,wrapXOFConstructorWithOpts},Symbol.toStringTag,{value:"Module"}));function setBigUint64$3(kt,At,xt,Bt){if(typeof kt.setBigUint64=="function")return kt.setBigUint64(At,xt,Bt);const Nt=BigInt(32),jt=BigInt(4294967295),Ut=Number(xt>>Nt&jt),Lt=Number(xt&jt),Ht=Bt?4:0,Vt=Bt?0:4;kt.setUint32(At+Ht,Ut,Bt),kt.setUint32(At+Vt,Lt,Bt)}const Chi$2=(kt,At,xt)=>kt&At^~kt&xt,Maj$2=(kt,At,xt)=>kt&At^kt&xt^At&xt;let HashMD$1=class extends Hash$9{constructor(At,xt,Bt,Nt){super(),this.blockLen=At,this.outputLen=xt,this.padOffset=Bt,this.isLE=Nt,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(At),this.view=createView$2(this.buffer)}update(At){exists$6(this);const{view:xt,buffer:Bt,blockLen:Nt}=this;At=toBytes$3(At);const jt=At.length;for(let Ut=0;Ut<jt;){const Lt=Math.min(Nt-this.pos,jt-Ut);if(Lt===Nt){const Ht=createView$2(At);for(;Nt<=jt-Ut;Ut+=Nt)this.process(Ht,Ut);continue}Bt.set(At.subarray(Ut,Ut+Lt),this.pos),this.pos+=Lt,Ut+=Lt,this.pos===Nt&&(this.process(xt,0),this.pos=0)}return this.length+=At.length,this.roundClean(),this}digestInto(At){exists$6(this),output$5(At,this),this.finished=!0;const{buffer:xt,view:Bt,blockLen:Nt,isLE:jt}=this;let{pos:Ut}=this;xt[Ut++]=128,this.buffer.subarray(Ut).fill(0),this.padOffset>Nt-Ut&&(this.process(Bt,0),Ut=0);for(let Wt=Ut;Wt<Nt;Wt++)xt[Wt]=0;setBigUint64$3(Bt,Nt-8,BigInt(this.length*8),jt),this.process(Bt,0);const Lt=createView$2(At),Ht=this.outputLen;if(Ht%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Vt=Ht/4,zt=this.get();if(Vt>zt.length)throw new Error("_sha2: outputLen bigger than state");for(let Wt=0;Wt<Vt;Wt++)Lt.setUint32(4*Wt,zt[Wt],jt)}digest(){const{buffer:At,outputLen:xt}=this;this.digestInto(At);const Bt=At.slice(0,xt);return this.destroy(),Bt}_cloneInto(At){At||(At=new this.constructor),At.set(...this.get());const{blockLen:xt,buffer:Bt,length:Nt,finished:jt,destroyed:Ut,pos:Lt}=this;return At.length=Nt,At.pos=Lt,At.finished=jt,At.destroyed=Ut,Nt%xt&&At.buffer.set(Bt),At}};const SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$4=class extends HashMD$1{constructor(){super(64,32,8,!1),this.A=SHA256_IV$1[0]|0,this.B=SHA256_IV$1[1]|0,this.C=SHA256_IV$1[2]|0,this.D=SHA256_IV$1[3]|0,this.E=SHA256_IV$1[4]|0,this.F=SHA256_IV$1[5]|0,this.G=SHA256_IV$1[6]|0,this.H=SHA256_IV$1[7]|0}get(){const{A:At,B:xt,C:Bt,D:Nt,E:jt,F:Ut,G:Lt,H:Ht}=this;return[At,xt,Bt,Nt,jt,Ut,Lt,Ht]}set(At,xt,Bt,Nt,jt,Ut,Lt,Ht){this.A=At|0,this.B=xt|0,this.C=Bt|0,this.D=Nt|0,this.E=jt|0,this.F=Ut|0,this.G=Lt|0,this.H=Ht|0}process(At,xt){for(let Wt=0;Wt<16;Wt++,xt+=4)SHA256_W$2[Wt]=At.getUint32(xt,!1);for(let Wt=16;Wt<64;Wt++){const Jt=SHA256_W$2[Wt-15],Qt=SHA256_W$2[Wt-2],Xt=rotr$1(Jt,7)^rotr$1(Jt,18)^Jt>>>3,tr=rotr$1(Qt,17)^rotr$1(Qt,19)^Qt>>>10;SHA256_W$2[Wt]=tr+SHA256_W$2[Wt-7]+Xt+SHA256_W$2[Wt-16]|0}let{A:Bt,B:Nt,C:jt,D:Ut,E:Lt,F:Ht,G:Vt,H:zt}=this;for(let Wt=0;Wt<64;Wt++){const Jt=rotr$1(Lt,6)^rotr$1(Lt,11)^rotr$1(Lt,25),Qt=zt+Jt+Chi$2(Lt,Ht,Vt)+SHA256_K$2[Wt]+SHA256_W$2[Wt]|0,tr=(rotr$1(Bt,2)^rotr$1(Bt,13)^rotr$1(Bt,22))+Maj$2(Bt,Nt,jt)|0;zt=Vt,Vt=Ht,Ht=Lt,Lt=Ut+Qt|0,Ut=jt,jt=Nt,Nt=Bt,Bt=Qt+tr|0}Bt=Bt+this.A|0,Nt=Nt+this.B|0,jt=jt+this.C|0,Ut=Ut+this.D|0,Lt=Lt+this.E|0,Ht=Ht+this.F|0,Vt=Vt+this.G|0,zt=zt+this.H|0,this.set(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},SHA224$2=class extends SHA256$4{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};const sha256$5=wrapConstructor$1(()=>new SHA256$4),sha224$2=wrapConstructor$1(()=>new SHA224$2),sha256$6=Object.freeze(Object.defineProperty({__proto__:null,sha224:sha224$2,sha256:sha256$5},Symbol.toStringTag,{value:"Module"}));let HMAC$1=class extends Hash$9{constructor(At,xt){super(),this.finished=!1,this.destroyed=!1,hash$7(At);const Bt=toBytes$3(xt);if(this.iHash=At.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Nt=this.blockLen,jt=new Uint8Array(Nt);jt.set(Bt.length>Nt?At.create().update(Bt).digest():Bt);for(let Ut=0;Ut<jt.length;Ut++)jt[Ut]^=54;this.iHash.update(jt),this.oHash=At.create();for(let Ut=0;Ut<jt.length;Ut++)jt[Ut]^=106;this.oHash.update(jt),jt.fill(0)}update(At){return exists$6(this),this.iHash.update(At),this}digestInto(At){exists$6(this),bytes$5(At,this.outputLen),this.finished=!0,this.iHash.digestInto(At),this.oHash.update(At),this.oHash.digestInto(At),this.destroy()}digest(){const At=new Uint8Array(this.oHash.outputLen);return this.digestInto(At),At}_cloneInto(At){At||(At=Object.create(Object.getPrototypeOf(this),{}));const{oHash:xt,iHash:Bt,finished:Nt,destroyed:jt,blockLen:Ut,outputLen:Lt}=this;return At=At,At.finished=Nt,At.destroyed=jt,At.blockLen=Ut,At.outputLen=Lt,At.oHash=xt._cloneInto(At.oHash),At.iHash=Bt._cloneInto(At.iHash),At}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$3=(kt,At,xt)=>new HMAC$1(kt,At).update(xt).digest();hmac$3.create=(kt,At)=>new HMAC$1(kt,At);const hmac$4=Object.freeze(Object.defineProperty({__proto__:null,HMAC:HMAC$1,hmac:hmac$3},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$e=BigInt(0),_1n$g=BigInt(1),_2n$9=BigInt(2);function isBytes$9(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}function abytes$1(kt){if(!isBytes$9(kt))throw new Error("Uint8Array expected")}const hexes$3=Array.from({length:256},(kt,At)=>At.toString(16).padStart(2,"0"));function bytesToHex$3(kt){abytes$1(kt);let At="";for(let xt=0;xt<kt.length;xt++)At+=hexes$3[kt[xt]];return At}function numberToHexUnpadded$2(kt){const At=kt.toString(16);return At.length&1?`0${At}`:At}function hexToNumber$2(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);return BigInt(kt===""?"0":`0x${kt}`)}const asciis$3={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$3(kt){if(kt>=asciis$3._0&&kt<=asciis$3._9)return kt-asciis$3._0;if(kt>=asciis$3._A&&kt<=asciis$3._F)return kt-(asciis$3._A-10);if(kt>=asciis$3._a&&kt<=asciis$3._f)return kt-(asciis$3._a-10)}function hexToBytes$3(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);const At=kt.length,xt=At/2;if(At%2)throw new Error("padded hex string expected, got unpadded hex of length "+At);const Bt=new Uint8Array(xt);for(let Nt=0,jt=0;Nt<xt;Nt++,jt+=2){const Ut=asciiToBase16$3(kt.charCodeAt(jt)),Lt=asciiToBase16$3(kt.charCodeAt(jt+1));if(Ut===void 0||Lt===void 0){const Ht=kt[jt]+kt[jt+1];throw new Error('hex string expected, got non-hex character "'+Ht+'" at index '+jt)}Bt[Nt]=Ut*16+Lt}return Bt}function bytesToNumberBE$2(kt){return hexToNumber$2(bytesToHex$3(kt))}function bytesToNumberLE$2(kt){return abytes$1(kt),hexToNumber$2(bytesToHex$3(Uint8Array.from(kt).reverse()))}function numberToBytesBE$2(kt,At){return hexToBytes$3(kt.toString(16).padStart(At*2,"0"))}function numberToBytesLE$2(kt,At){return numberToBytesBE$2(kt,At).reverse()}function numberToVarBytesBE$2(kt){return hexToBytes$3(numberToHexUnpadded$2(kt))}function ensureBytes$4(kt,At,xt){let Bt;if(typeof At=="string")try{Bt=hexToBytes$3(At)}catch(jt){throw new Error(`${kt} must be valid hex string, got "${At}". Cause: ${jt}`)}else if(isBytes$9(At))Bt=Uint8Array.from(At);else throw new Error(`${kt} must be hex string or Uint8Array`);const Nt=Bt.length;if(typeof xt=="number"&&Nt!==xt)throw new Error(`${kt} expected ${xt} bytes, got ${Nt}`);return Bt}function concatBytes$3(...kt){let At=0;for(let Bt=0;Bt<kt.length;Bt++){const Nt=kt[Bt];abytes$1(Nt),At+=Nt.length}const xt=new Uint8Array(At);for(let Bt=0,Nt=0;Bt<kt.length;Bt++){const jt=kt[Bt];xt.set(jt,Nt),Nt+=jt.length}return xt}function equalBytes$3(kt,At){if(kt.length!==At.length)return!1;let xt=0;for(let Bt=0;Bt<kt.length;Bt++)xt|=kt[Bt]^At[Bt];return xt===0}function utf8ToBytes$6(kt){if(typeof kt!="string")throw new Error(`utf8ToBytes expected string, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function bitLen$2(kt){let At;for(At=0;kt>_0n$e;kt>>=_1n$g,At+=1);return At}function bitGet$2(kt,At){return kt>>BigInt(At)&_1n$g}function bitSet$2(kt,At,xt){return kt|(xt?_1n$g:_0n$e)<<BigInt(At)}const bitMask$2=kt=>(_2n$9<<BigInt(kt-1))-_1n$g,u8n$2=kt=>new Uint8Array(kt),u8fr$2=kt=>Uint8Array.from(kt);function createHmacDrbg$2(kt,At,xt){if(typeof kt!="number"||kt<2)throw new Error("hashLen must be a number");if(typeof At!="number"||At<2)throw new Error("qByteLen must be a number");if(typeof xt!="function")throw new Error("hmacFn must be a function");let Bt=u8n$2(kt),Nt=u8n$2(kt),jt=0;const Ut=()=>{Bt.fill(1),Nt.fill(0),jt=0},Lt=(...Wt)=>xt(Nt,Bt,...Wt),Ht=(Wt=u8n$2())=>{Nt=Lt(u8fr$2([0]),Wt),Bt=Lt(),Wt.length!==0&&(Nt=Lt(u8fr$2([1]),Wt),Bt=Lt())},Vt=()=>{if(jt++>=1e3)throw new Error("drbg: tried 1000 values");let Wt=0;const Jt=[];for(;Wt<At;){Bt=Lt();const Qt=Bt.slice();Jt.push(Qt),Wt+=Bt.length}return concatBytes$3(...Jt)};return(Wt,Jt)=>{Ut(),Ht(Wt);let Qt;for(;!(Qt=Jt(Vt()));)Ht();return Ut(),Qt}}const validatorFns$2={bigint:kt=>typeof kt=="bigint",function:kt=>typeof kt=="function",boolean:kt=>typeof kt=="boolean",string:kt=>typeof kt=="string",stringOrUint8Array:kt=>typeof kt=="string"||isBytes$9(kt),isSafeInteger:kt=>Number.isSafeInteger(kt),array:kt=>Array.isArray(kt),field:(kt,At)=>At.Fp.isValid(kt),hash:kt=>typeof kt=="function"&&Number.isSafeInteger(kt.outputLen)};function validateObject$8(kt,At,xt={}){const Bt=(Nt,jt,Ut)=>{const Lt=validatorFns$2[jt];if(typeof Lt!="function")throw new Error(`Invalid validator "${jt}", expected function`);const Ht=kt[Nt];if(!(Ut&&Ht===void 0)&&!Lt(Ht,kt))throw new Error(`Invalid param ${String(Nt)}=${Ht} (${typeof Ht}), expected ${jt}`)};for(const[Nt,jt]of Object.entries(At))Bt(Nt,jt,!1);for(const[Nt,jt]of Object.entries(xt))Bt(Nt,jt,!0);return kt}const ut$2=Object.freeze(Object.defineProperty({__proto__:null,abytes:abytes$1,bitGet:bitGet$2,bitLen:bitLen$2,bitMask:bitMask$2,bitSet:bitSet$2,bytesToHex:bytesToHex$3,bytesToNumberBE:bytesToNumberBE$2,bytesToNumberLE:bytesToNumberLE$2,concatBytes:concatBytes$3,createHmacDrbg:createHmacDrbg$2,ensureBytes:ensureBytes$4,equalBytes:equalBytes$3,hexToBytes:hexToBytes$3,hexToNumber:hexToNumber$2,isBytes:isBytes$9,numberToBytesBE:numberToBytesBE$2,numberToBytesLE:numberToBytesLE$2,numberToHexUnpadded:numberToHexUnpadded$2,numberToVarBytesBE:numberToVarBytesBE$2,utf8ToBytes:utf8ToBytes$6,validateObject:validateObject$8},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$d=BigInt(0),_1n$f=BigInt(1),_2n$8=BigInt(2),_3n$4=BigInt(3),_4n$2=BigInt(4),_5n$3=BigInt(5),_8n$4=BigInt(8);BigInt(9);BigInt(16);function mod$2(kt,At){const xt=kt%At;return xt>=_0n$d?xt:At+xt}function pow$2(kt,At,xt){if(xt<=_0n$d||At<_0n$d)throw new Error("Expected power/modulo > 0");if(xt===_1n$f)return _0n$d;let Bt=_1n$f;for(;At>_0n$d;)At&_1n$f&&(Bt=Bt*kt%xt),kt=kt*kt%xt,At>>=_1n$f;return Bt}function invert$2(kt,At){if(kt===_0n$d||At<=_0n$d)throw new Error(`invert: expected positive integers, got n=${kt} mod=${At}`);let xt=mod$2(kt,At),Bt=At,Nt=_0n$d,jt=_1n$f;for(;xt!==_0n$d;){const Lt=Bt/xt,Ht=Bt%xt,Vt=Nt-jt*Lt;Bt=xt,xt=Ht,Nt=jt,jt=Vt}if(Bt!==_1n$f)throw new Error("invert: does not exist");return mod$2(Nt,At)}function tonelliShanks$2(kt){const At=(kt-_1n$f)/_2n$8;let xt,Bt,Nt;for(xt=kt-_1n$f,Bt=0;xt%_2n$8===_0n$d;xt/=_2n$8,Bt++);for(Nt=_2n$8;Nt<kt&&pow$2(Nt,At,kt)!==kt-_1n$f;Nt++);if(Bt===1){const Ut=(kt+_1n$f)/_4n$2;return function(Ht,Vt){const zt=Ht.pow(Vt,Ut);if(!Ht.eql(Ht.sqr(zt),Vt))throw new Error("Cannot find square root");return zt}}const jt=(xt+_1n$f)/_2n$8;return function(Lt,Ht){if(Lt.pow(Ht,At)===Lt.neg(Lt.ONE))throw new Error("Cannot find square root");let Vt=Bt,zt=Lt.pow(Lt.mul(Lt.ONE,Nt),xt),Wt=Lt.pow(Ht,jt),Jt=Lt.pow(Ht,xt);for(;!Lt.eql(Jt,Lt.ONE);){if(Lt.eql(Jt,Lt.ZERO))return Lt.ZERO;let Qt=1;for(let tr=Lt.sqr(Jt);Qt<Vt&&!Lt.eql(tr,Lt.ONE);Qt++)tr=Lt.sqr(tr);const Xt=Lt.pow(zt,_1n$f<<BigInt(Vt-Qt-1));zt=Lt.sqr(Xt),Wt=Lt.mul(Wt,Xt),Jt=Lt.mul(Jt,zt),Vt=Qt}return Wt}}function FpSqrt$2(kt){if(kt%_4n$2===_3n$4){const At=(kt+_1n$f)/_4n$2;return function(Bt,Nt){const jt=Bt.pow(Nt,At);if(!Bt.eql(Bt.sqr(jt),Nt))throw new Error("Cannot find square root");return jt}}if(kt%_8n$4===_5n$3){const At=(kt-_5n$3)/_8n$4;return function(Bt,Nt){const jt=Bt.mul(Nt,_2n$8),Ut=Bt.pow(jt,At),Lt=Bt.mul(Nt,Ut),Ht=Bt.mul(Bt.mul(Lt,_2n$8),Ut),Vt=Bt.mul(Lt,Bt.sub(Ht,Bt.ONE));if(!Bt.eql(Bt.sqr(Vt),Nt))throw new Error("Cannot find square root");return Vt}}return tonelliShanks$2(kt)}const FIELD_FIELDS$2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$2(kt){const At={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},xt=FIELD_FIELDS$2.reduce((Bt,Nt)=>(Bt[Nt]="function",Bt),At);return validateObject$8(kt,xt)}function FpPow$2(kt,At,xt){if(xt<_0n$d)throw new Error("Expected power > 0");if(xt===_0n$d)return kt.ONE;if(xt===_1n$f)return At;let Bt=kt.ONE,Nt=At;for(;xt>_0n$d;)xt&_1n$f&&(Bt=kt.mul(Bt,Nt)),Nt=kt.sqr(Nt),xt>>=_1n$f;return Bt}function FpInvertBatch$2(kt,At){const xt=new Array(At.length),Bt=At.reduce((jt,Ut,Lt)=>kt.is0(Ut)?jt:(xt[Lt]=jt,kt.mul(jt,Ut)),kt.ONE),Nt=kt.inv(Bt);return At.reduceRight((jt,Ut,Lt)=>kt.is0(Ut)?jt:(xt[Lt]=kt.mul(jt,xt[Lt]),kt.mul(jt,Ut)),Nt),xt}function nLength$2(kt,At){const xt=At!==void 0?At:kt.toString(2).length,Bt=Math.ceil(xt/8);return{nBitLength:xt,nByteLength:Bt}}function Field$2(kt,At,xt=!1,Bt={}){if(kt<=_0n$d)throw new Error(`Expected Field ORDER > 0, got ${kt}`);const{nBitLength:Nt,nByteLength:jt}=nLength$2(kt,At);if(jt>2048)throw new Error("Field lengths over 2048 bytes are not supported");const Ut=FpSqrt$2(kt),Lt=Object.freeze({ORDER:kt,BITS:Nt,BYTES:jt,MASK:bitMask$2(Nt),ZERO:_0n$d,ONE:_1n$f,create:Ht=>mod$2(Ht,kt),isValid:Ht=>{if(typeof Ht!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof Ht}`);return _0n$d<=Ht&&Ht<kt},is0:Ht=>Ht===_0n$d,isOdd:Ht=>(Ht&_1n$f)===_1n$f,neg:Ht=>mod$2(-Ht,kt),eql:(Ht,Vt)=>Ht===Vt,sqr:Ht=>mod$2(Ht*Ht,kt),add:(Ht,Vt)=>mod$2(Ht+Vt,kt),sub:(Ht,Vt)=>mod$2(Ht-Vt,kt),mul:(Ht,Vt)=>mod$2(Ht*Vt,kt),pow:(Ht,Vt)=>FpPow$2(Lt,Ht,Vt),div:(Ht,Vt)=>mod$2(Ht*invert$2(Vt,kt),kt),sqrN:Ht=>Ht*Ht,addN:(Ht,Vt)=>Ht+Vt,subN:(Ht,Vt)=>Ht-Vt,mulN:(Ht,Vt)=>Ht*Vt,inv:Ht=>invert$2(Ht,kt),sqrt:Bt.sqrt||(Ht=>Ut(Lt,Ht)),invertBatch:Ht=>FpInvertBatch$2(Lt,Ht),cmov:(Ht,Vt,zt)=>zt?Vt:Ht,toBytes:Ht=>xt?numberToBytesLE$2(Ht,jt):numberToBytesBE$2(Ht,jt),fromBytes:Ht=>{if(Ht.length!==jt)throw new Error(`Fp.fromBytes: expected ${jt}, got ${Ht.length}`);return xt?bytesToNumberLE$2(Ht):bytesToNumberBE$2(Ht)}});return Object.freeze(Lt)}function getFieldBytesLength$2(kt){if(typeof kt!="bigint")throw new Error("field order must be bigint");const At=kt.toString(2).length;return Math.ceil(At/8)}function getMinHashLength$2(kt){const At=getFieldBytesLength$2(kt);return At+Math.ceil(At/2)}function mapHashToField$2(kt,At,xt=!1){const Bt=kt.length,Nt=getFieldBytesLength$2(At),jt=getMinHashLength$2(At);if(Bt<16||Bt<jt||Bt>1024)throw new Error(`expected ${jt}-1024 bytes of input, got ${Bt}`);const Ut=xt?bytesToNumberBE$2(kt):bytesToNumberLE$2(kt),Lt=mod$2(Ut,At-_1n$f)+_1n$f;return xt?numberToBytesLE$2(Lt,Nt):numberToBytesBE$2(Lt,Nt)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$c=BigInt(0),_1n$e=BigInt(1);function wNAF$2(kt,At){const xt=(Nt,jt)=>{const Ut=jt.negate();return Nt?Ut:jt},Bt=Nt=>{const jt=Math.ceil(At/Nt)+1,Ut=2**(Nt-1);return{windows:jt,windowSize:Ut}};return{constTimeNegate:xt,unsafeLadder(Nt,jt){let Ut=kt.ZERO,Lt=Nt;for(;jt>_0n$c;)jt&_1n$e&&(Ut=Ut.add(Lt)),Lt=Lt.double(),jt>>=_1n$e;return Ut},precomputeWindow(Nt,jt){const{windows:Ut,windowSize:Lt}=Bt(jt),Ht=[];let Vt=Nt,zt=Vt;for(let Wt=0;Wt<Ut;Wt++){zt=Vt,Ht.push(zt);for(let Jt=1;Jt<Lt;Jt++)zt=zt.add(Vt),Ht.push(zt);Vt=zt.double()}return Ht},wNAF(Nt,jt,Ut){const{windows:Lt,windowSize:Ht}=Bt(Nt);let Vt=kt.ZERO,zt=kt.BASE;const Wt=BigInt(2**Nt-1),Jt=2**Nt,Qt=BigInt(Nt);for(let Xt=0;Xt<Lt;Xt++){const tr=Xt*Ht;let rr=Number(Ut&Wt);Ut>>=Qt,rr>Ht&&(rr-=Jt,Ut+=_1n$e);const nr=tr,ar=tr+Math.abs(rr)-1,ir=Xt%2!==0,lr=rr<0;rr===0?zt=zt.add(xt(ir,jt[nr])):Vt=Vt.add(xt(lr,jt[ar]))}return{p:Vt,f:zt}},wNAFCached(Nt,jt,Ut,Lt){const Ht=Nt._WINDOW_SIZE||1;let Vt=jt.get(Nt);return Vt||(Vt=this.precomputeWindow(Nt,Ht),Ht!==1&&jt.set(Nt,Lt(Vt))),this.wNAF(Ht,Vt,Ut)}}}function validateBasic$2(kt){return validateField$2(kt.Fp),validateObject$8(kt,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$2(kt.n,kt.nBitLength),...kt,p:kt.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts$1(kt){const At=validateBasic$2(kt);validateObject$8(At,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:xt,Fp:Bt,a:Nt}=At;if(xt){if(!Bt.eql(Nt,Bt.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof xt!="object"||typeof xt.beta!="bigint"||typeof xt.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...At})}const{bytesToNumberBE:b2n$1,hexToBytes:h2b$1}=ut$2,DER$1={Err:class extends Error{constructor(At=""){super(At)}},_parseInt(kt){const{Err:At}=DER$1;if(kt.length<2||kt[0]!==2)throw new At("Invalid signature integer tag");const xt=kt[1],Bt=kt.subarray(2,xt+2);if(!xt||Bt.length!==xt)throw new At("Invalid signature integer: wrong length");if(Bt[0]&128)throw new At("Invalid signature integer: negative");if(Bt[0]===0&&!(Bt[1]&128))throw new At("Invalid signature integer: unnecessary leading zero");return{d:b2n$1(Bt),l:kt.subarray(xt+2)}},toSig(kt){const{Err:At}=DER$1,xt=typeof kt=="string"?h2b$1(kt):kt;abytes$1(xt);let Bt=xt.length;if(Bt<2||xt[0]!=48)throw new At("Invalid signature tag");if(xt[1]!==Bt-2)throw new At("Invalid signature: incorrect length");const{d:Nt,l:jt}=DER$1._parseInt(xt.subarray(2)),{d:Ut,l:Lt}=DER$1._parseInt(jt);if(Lt.length)throw new At("Invalid signature: left bytes after parsing");return{r:Nt,s:Ut}},hexFromSig(kt){const At=Vt=>Number.parseInt(Vt[0],16)&8?"00"+Vt:Vt,xt=Vt=>{const zt=Vt.toString(16);return zt.length&1?`0${zt}`:zt},Bt=At(xt(kt.s)),Nt=At(xt(kt.r)),jt=Bt.length/2,Ut=Nt.length/2,Lt=xt(jt),Ht=xt(Ut);return`30${xt(Ut+jt+4)}02${Ht}${Nt}02${Lt}${Bt}`}},_0n$b=BigInt(0),_1n$d=BigInt(1);BigInt(2);const _3n$3=BigInt(3);BigInt(4);function weierstrassPoints$1(kt){const At=validatePointOpts$1(kt),{Fp:xt}=At,Bt=At.toBytes||((Xt,tr,rr)=>{const nr=tr.toAffine();return concatBytes$3(Uint8Array.from([4]),xt.toBytes(nr.x),xt.toBytes(nr.y))}),Nt=At.fromBytes||(Xt=>{const tr=Xt.subarray(1),rr=xt.fromBytes(tr.subarray(0,xt.BYTES)),nr=xt.fromBytes(tr.subarray(xt.BYTES,2*xt.BYTES));return{x:rr,y:nr}});function jt(Xt){const{a:tr,b:rr}=At,nr=xt.sqr(Xt),ar=xt.mul(nr,Xt);return xt.add(xt.add(ar,xt.mul(Xt,tr)),rr)}if(!xt.eql(xt.sqr(At.Gy),jt(At.Gx)))throw new Error("bad generator point: equation left != right");function Ut(Xt){return typeof Xt=="bigint"&&_0n$b<Xt&&Xt<At.n}function Lt(Xt){if(!Ut(Xt))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function Ht(Xt){const{allowedPrivateKeyLengths:tr,nByteLength:rr,wrapPrivateKey:nr,n:ar}=At;if(tr&&typeof Xt!="bigint"){if(isBytes$9(Xt)&&(Xt=bytesToHex$3(Xt)),typeof Xt!="string"||!tr.includes(Xt.length))throw new Error("Invalid key");Xt=Xt.padStart(rr*2,"0")}let ir;try{ir=typeof Xt=="bigint"?Xt:bytesToNumberBE$2(ensureBytes$4("private key",Xt,rr))}catch{throw new Error(`private key must be ${rr} bytes, hex or bigint, not ${typeof Xt}`)}return nr&&(ir=mod$2(ir,ar)),Lt(ir),ir}const Vt=new Map;function zt(Xt){if(!(Xt instanceof Wt))throw new Error("ProjectivePoint expected")}class Wt{constructor(tr,rr,nr){if(this.px=tr,this.py=rr,this.pz=nr,tr==null||!xt.isValid(tr))throw new Error("x required");if(rr==null||!xt.isValid(rr))throw new Error("y required");if(nr==null||!xt.isValid(nr))throw new Error("z required")}static fromAffine(tr){const{x:rr,y:nr}=tr||{};if(!tr||!xt.isValid(rr)||!xt.isValid(nr))throw new Error("invalid affine point");if(tr instanceof Wt)throw new Error("projective point not allowed");const ar=ir=>xt.eql(ir,xt.ZERO);return ar(rr)&&ar(nr)?Wt.ZERO:new Wt(rr,nr,xt.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(tr){const rr=xt.invertBatch(tr.map(nr=>nr.pz));return tr.map((nr,ar)=>nr.toAffine(rr[ar])).map(Wt.fromAffine)}static fromHex(tr){const rr=Wt.fromAffine(Nt(ensureBytes$4("pointHex",tr)));return rr.assertValidity(),rr}static fromPrivateKey(tr){return Wt.BASE.multiply(Ht(tr))}_setWindowSize(tr){this._WINDOW_SIZE=tr,Vt.delete(this)}assertValidity(){if(this.is0()){if(At.allowInfinityPoint&&!xt.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:tr,y:rr}=this.toAffine();if(!xt.isValid(tr)||!xt.isValid(rr))throw new Error("bad point: x or y not FE");const nr=xt.sqr(rr),ar=jt(tr);if(!xt.eql(nr,ar))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:tr}=this.toAffine();if(xt.isOdd)return!xt.isOdd(tr);throw new Error("Field doesn't support isOdd")}equals(tr){zt(tr);const{px:rr,py:nr,pz:ar}=this,{px:ir,py:lr,pz:yr}=tr,Sr=xt.eql(xt.mul(rr,yr),xt.mul(ir,ar)),Ar=xt.eql(xt.mul(nr,yr),xt.mul(lr,ar));return Sr&&Ar}negate(){return new Wt(this.px,xt.neg(this.py),this.pz)}double(){const{a:tr,b:rr}=At,nr=xt.mul(rr,_3n$3),{px:ar,py:ir,pz:lr}=this;let yr=xt.ZERO,Sr=xt.ZERO,Ar=xt.ZERO,Dr=xt.mul(ar,ar),Br=xt.mul(ir,ir),Lr=xt.mul(lr,lr),Or=xt.mul(ar,ir);return Or=xt.add(Or,Or),Ar=xt.mul(ar,lr),Ar=xt.add(Ar,Ar),yr=xt.mul(tr,Ar),Sr=xt.mul(nr,Lr),Sr=xt.add(yr,Sr),yr=xt.sub(Br,Sr),Sr=xt.add(Br,Sr),Sr=xt.mul(yr,Sr),yr=xt.mul(Or,yr),Ar=xt.mul(nr,Ar),Lr=xt.mul(tr,Lr),Or=xt.sub(Dr,Lr),Or=xt.mul(tr,Or),Or=xt.add(Or,Ar),Ar=xt.add(Dr,Dr),Dr=xt.add(Ar,Dr),Dr=xt.add(Dr,Lr),Dr=xt.mul(Dr,Or),Sr=xt.add(Sr,Dr),Lr=xt.mul(ir,lr),Lr=xt.add(Lr,Lr),Dr=xt.mul(Lr,Or),yr=xt.sub(yr,Dr),Ar=xt.mul(Lr,Br),Ar=xt.add(Ar,Ar),Ar=xt.add(Ar,Ar),new Wt(yr,Sr,Ar)}add(tr){zt(tr);const{px:rr,py:nr,pz:ar}=this,{px:ir,py:lr,pz:yr}=tr;let Sr=xt.ZERO,Ar=xt.ZERO,Dr=xt.ZERO;const Br=At.a,Lr=xt.mul(At.b,_3n$3);let Or=xt.mul(rr,ir),vr=xt.mul(nr,lr),pr=xt.mul(ar,yr),dr=xt.add(rr,nr),ur=xt.add(ir,lr);dr=xt.mul(dr,ur),ur=xt.add(Or,vr),dr=xt.sub(dr,ur),ur=xt.add(rr,ar);let $r=xt.add(ir,yr);return ur=xt.mul(ur,$r),$r=xt.add(Or,pr),ur=xt.sub(ur,$r),$r=xt.add(nr,ar),Sr=xt.add(lr,yr),$r=xt.mul($r,Sr),Sr=xt.add(vr,pr),$r=xt.sub($r,Sr),Dr=xt.mul(Br,ur),Sr=xt.mul(Lr,pr),Dr=xt.add(Sr,Dr),Sr=xt.sub(vr,Dr),Dr=xt.add(vr,Dr),Ar=xt.mul(Sr,Dr),vr=xt.add(Or,Or),vr=xt.add(vr,Or),pr=xt.mul(Br,pr),ur=xt.mul(Lr,ur),vr=xt.add(vr,pr),pr=xt.sub(Or,pr),pr=xt.mul(Br,pr),ur=xt.add(ur,pr),Or=xt.mul(vr,ur),Ar=xt.add(Ar,Or),Or=xt.mul($r,ur),Sr=xt.mul(dr,Sr),Sr=xt.sub(Sr,Or),Or=xt.mul(dr,vr),Dr=xt.mul($r,Dr),Dr=xt.add(Dr,Or),new Wt(Sr,Ar,Dr)}subtract(tr){return this.add(tr.negate())}is0(){return this.equals(Wt.ZERO)}wNAF(tr){return Qt.wNAFCached(this,Vt,tr,rr=>{const nr=xt.invertBatch(rr.map(ar=>ar.pz));return rr.map((ar,ir)=>ar.toAffine(nr[ir])).map(Wt.fromAffine)})}multiplyUnsafe(tr){const rr=Wt.ZERO;if(tr===_0n$b)return rr;if(Lt(tr),tr===_1n$d)return this;const{endo:nr}=At;if(!nr)return Qt.unsafeLadder(this,tr);let{k1neg:ar,k1:ir,k2neg:lr,k2:yr}=nr.splitScalar(tr),Sr=rr,Ar=rr,Dr=this;for(;ir>_0n$b||yr>_0n$b;)ir&_1n$d&&(Sr=Sr.add(Dr)),yr&_1n$d&&(Ar=Ar.add(Dr)),Dr=Dr.double(),ir>>=_1n$d,yr>>=_1n$d;return ar&&(Sr=Sr.negate()),lr&&(Ar=Ar.negate()),Ar=new Wt(xt.mul(Ar.px,nr.beta),Ar.py,Ar.pz),Sr.add(Ar)}multiply(tr){Lt(tr);let rr=tr,nr,ar;const{endo:ir}=At;if(ir){const{k1neg:lr,k1:yr,k2neg:Sr,k2:Ar}=ir.splitScalar(rr);let{p:Dr,f:Br}=this.wNAF(yr),{p:Lr,f:Or}=this.wNAF(Ar);Dr=Qt.constTimeNegate(lr,Dr),Lr=Qt.constTimeNegate(Sr,Lr),Lr=new Wt(xt.mul(Lr.px,ir.beta),Lr.py,Lr.pz),nr=Dr.add(Lr),ar=Br.add(Or)}else{const{p:lr,f:yr}=this.wNAF(rr);nr=lr,ar=yr}return Wt.normalizeZ([nr,ar])[0]}multiplyAndAddUnsafe(tr,rr,nr){const ar=Wt.BASE,ir=(yr,Sr)=>Sr===_0n$b||Sr===_1n$d||!yr.equals(ar)?yr.multiplyUnsafe(Sr):yr.multiply(Sr),lr=ir(this,rr).add(ir(tr,nr));return lr.is0()?void 0:lr}toAffine(tr){const{px:rr,py:nr,pz:ar}=this,ir=this.is0();tr==null&&(tr=ir?xt.ONE:xt.inv(ar));const lr=xt.mul(rr,tr),yr=xt.mul(nr,tr),Sr=xt.mul(ar,tr);if(ir)return{x:xt.ZERO,y:xt.ZERO};if(!xt.eql(Sr,xt.ONE))throw new Error("invZ was invalid");return{x:lr,y:yr}}isTorsionFree(){const{h:tr,isTorsionFree:rr}=At;if(tr===_1n$d)return!0;if(rr)return rr(Wt,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:tr,clearCofactor:rr}=At;return tr===_1n$d?this:rr?rr(Wt,this):this.multiplyUnsafe(At.h)}toRawBytes(tr=!0){return this.assertValidity(),Bt(Wt,this,tr)}toHex(tr=!0){return bytesToHex$3(this.toRawBytes(tr))}}Wt.BASE=new Wt(At.Gx,At.Gy,xt.ONE),Wt.ZERO=new Wt(xt.ZERO,xt.ONE,xt.ZERO);const Jt=At.nBitLength,Qt=wNAF$2(Wt,At.endo?Math.ceil(Jt/2):Jt);return{CURVE:At,ProjectivePoint:Wt,normPrivateKeyToScalar:Ht,weierstrassEquation:jt,isWithinCurveOrder:Ut}}function validateOpts$5(kt){const At=validateBasic$2(kt);return validateObject$8(At,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...At})}function weierstrass$2(kt){const At=validateOpts$5(kt),{Fp:xt,n:Bt}=At,Nt=xt.BYTES+1,jt=2*xt.BYTES+1;function Ut(ur){return _0n$b<ur&&ur<xt.ORDER}function Lt(ur){return mod$2(ur,Bt)}function Ht(ur){return invert$2(ur,Bt)}const{ProjectivePoint:Vt,normPrivateKeyToScalar:zt,weierstrassEquation:Wt,isWithinCurveOrder:Jt}=weierstrassPoints$1({...At,toBytes(ur,$r,wr){const Er=$r.toAffine(),gr=xt.toBytes(Er.x),fr=concatBytes$3;return wr?fr(Uint8Array.from([$r.hasEvenY()?2:3]),gr):fr(Uint8Array.from([4]),gr,xt.toBytes(Er.y))},fromBytes(ur){const $r=ur.length,wr=ur[0],Er=ur.subarray(1);if($r===Nt&&(wr===2||wr===3)){const gr=bytesToNumberBE$2(Er);if(!Ut(gr))throw new Error("Point is not on curve");const fr=Wt(gr);let br;try{br=xt.sqrt(fr)}catch(Pr){const Nr=Pr instanceof Error?": "+Pr.message:"";throw new Error("Point is not on curve"+Nr)}const _r=(br&_1n$d)===_1n$d;return(wr&1)===1!==_r&&(br=xt.neg(br)),{x:gr,y:br}}else if($r===jt&&wr===4){const gr=xt.fromBytes(Er.subarray(0,xt.BYTES)),fr=xt.fromBytes(Er.subarray(xt.BYTES,2*xt.BYTES));return{x:gr,y:fr}}else throw new Error(`Point of length ${$r} was invalid. Expected ${Nt} compressed bytes or ${jt} uncompressed bytes`)}}),Qt=ur=>bytesToHex$3(numberToBytesBE$2(ur,At.nByteLength));function Xt(ur){const $r=Bt>>_1n$d;return ur>$r}function tr(ur){return Xt(ur)?Lt(-ur):ur}const rr=(ur,$r,wr)=>bytesToNumberBE$2(ur.slice($r,wr));class nr{constructor($r,wr,Er){this.r=$r,this.s=wr,this.recovery=Er,this.assertValidity()}static fromCompact($r){const wr=At.nByteLength;return $r=ensureBytes$4("compactSignature",$r,wr*2),new nr(rr($r,0,wr),rr($r,wr,2*wr))}static fromDER($r){const{r:wr,s:Er}=DER$1.toSig(ensureBytes$4("DER",$r));return new nr(wr,Er)}assertValidity(){if(!Jt(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!Jt(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit($r){return new nr(this.r,this.s,$r)}recoverPublicKey($r){const{r:wr,s:Er,recovery:gr}=this,fr=Ar(ensureBytes$4("msgHash",$r));if(gr==null||![0,1,2,3].includes(gr))throw new Error("recovery id invalid");const br=gr===2||gr===3?wr+At.n:wr;if(br>=xt.ORDER)throw new Error("recovery id 2 or 3 invalid");const _r=gr&1?"03":"02",Tr=Vt.fromHex(_r+Qt(br)),Pr=Ht(br),Nr=Lt(-fr*Pr),Cr=Lt(Er*Pr),xr=Vt.BASE.multiplyAndAddUnsafe(Tr,Nr,Cr);if(!xr)throw new Error("point at infinify");return xr.assertValidity(),xr}hasHighS(){return Xt(this.s)}normalizeS(){return this.hasHighS()?new nr(this.r,Lt(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$3(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$3(this.toCompactHex())}toCompactHex(){return Qt(this.r)+Qt(this.s)}}const ar={isValidPrivateKey(ur){try{return zt(ur),!0}catch{return!1}},normPrivateKeyToScalar:zt,randomPrivateKey:()=>{const ur=getMinHashLength$2(At.n);return mapHashToField$2(At.randomBytes(ur),At.n)},precompute(ur=8,$r=Vt.BASE){return $r._setWindowSize(ur),$r.multiply(BigInt(3)),$r}};function ir(ur,$r=!0){return Vt.fromPrivateKey(ur).toRawBytes($r)}function lr(ur){const $r=isBytes$9(ur),wr=typeof ur=="string",Er=($r||wr)&&ur.length;return $r?Er===Nt||Er===jt:wr?Er===2*Nt||Er===2*jt:ur instanceof Vt}function yr(ur,$r,wr=!0){if(lr(ur))throw new Error("first arg must be private key");if(!lr($r))throw new Error("second arg must be public key");return Vt.fromHex($r).multiply(zt(ur)).toRawBytes(wr)}const Sr=At.bits2int||function(ur){const $r=bytesToNumberBE$2(ur),wr=ur.length*8-At.nBitLength;return wr>0?$r>>BigInt(wr):$r},Ar=At.bits2int_modN||function(ur){return Lt(Sr(ur))},Dr=bitMask$2(At.nBitLength);function Br(ur){if(typeof ur!="bigint")throw new Error("bigint expected");if(!(_0n$b<=ur&&ur<Dr))throw new Error(`bigint expected < 2^${At.nBitLength}`);return numberToBytesBE$2(ur,At.nByteLength)}function Lr(ur,$r,wr=Or){if(["recovered","canonical"].some(qr=>qr in wr))throw new Error("sign() legacy options not supported");const{hash:Er,randomBytes:gr}=At;let{lowS:fr,prehash:br,extraEntropy:_r}=wr;fr==null&&(fr=!0),ur=ensureBytes$4("msgHash",ur),br&&(ur=ensureBytes$4("prehashed msgHash",Er(ur)));const Tr=Ar(ur),Pr=zt($r),Nr=[Br(Pr),Br(Tr)];if(_r!=null&&_r!==!1){const qr=_r===!0?gr(xt.BYTES):_r;Nr.push(ensureBytes$4("extraEntropy",qr))}const Cr=concatBytes$3(...Nr),xr=Tr;function Rr(qr){const Vr=Sr(qr);if(!Jt(Vr))return;const Gr=Ht(Vr),Ur=Vt.BASE.multiply(Vr).toAffine(),kr=Lt(Ur.x);if(kr===_0n$b)return;const Fr=Lt(Gr*Lt(xr+kr*Pr));if(Fr===_0n$b)return;let Wr=(Ur.x===kr?0:2)|Number(Ur.y&_1n$d),jr=Fr;return fr&&Xt(Fr)&&(jr=tr(Fr),Wr^=1),new nr(kr,jr,Wr)}return{seed:Cr,k2sig:Rr}}const Or={lowS:At.lowS,prehash:!1},vr={lowS:At.lowS,prehash:!1};function pr(ur,$r,wr=Or){const{seed:Er,k2sig:gr}=Lr(ur,$r,wr),fr=At;return createHmacDrbg$2(fr.hash.outputLen,fr.nByteLength,fr.hmac)(Er,gr)}Vt.BASE._setWindowSize(8);function dr(ur,$r,wr,Er=vr){var Ur;const gr=ur;if($r=ensureBytes$4("msgHash",$r),wr=ensureBytes$4("publicKey",wr),"strict"in Er)throw new Error("options.strict was renamed to lowS");const{lowS:fr,prehash:br}=Er;let _r,Tr;try{if(typeof gr=="string"||isBytes$9(gr))try{_r=nr.fromDER(gr)}catch(kr){if(!(kr instanceof DER$1.Err))throw kr;_r=nr.fromCompact(gr)}else if(typeof gr=="object"&&typeof gr.r=="bigint"&&typeof gr.s=="bigint"){const{r:kr,s:Fr}=gr;_r=new nr(kr,Fr)}else throw new Error("PARSE");Tr=Vt.fromHex(wr)}catch(kr){if(kr.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(fr&&_r.hasHighS())return!1;br&&($r=At.hash($r));const{r:Pr,s:Nr}=_r,Cr=Ar($r),xr=Ht(Nr),Rr=Lt(Cr*xr),qr=Lt(Pr*xr),Vr=(Ur=Vt.BASE.multiplyAndAddUnsafe(Tr,Rr,qr))==null?void 0:Ur.toAffine();return Vr?Lt(Vr.x)===Pr:!1}return{CURVE:At,getPublicKey:ir,getSharedSecret:yr,sign:pr,verify:dr,ProjectivePoint:Vt,Signature:nr,utils:ar}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash$2(kt){return{hash:kt,hmac:(At,...xt)=>hmac$3(kt,At,concatBytes$4(...xt)),randomBytes:randomBytes$7}}function createCurve$2(kt,At){const xt=Bt=>weierstrass$2({...kt,...getHash$2(Bt)});return Object.freeze({...xt(At),create:xt})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fp$3=Field$2(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),CURVE_A$1=Fp$3.create(BigInt("-3")),CURVE_B$1=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),p256$1=createCurve$2({a:CURVE_A$1,b:CURVE_B$1,Fp:Fp$3,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},sha256$5),secp256r1$1=p256$1;function equals$4(kt,At){if(kt===At)return!0;if(kt.byteLength!==At.byteLength)return!1;for(let xt=0;xt<kt.byteLength;xt++)if(kt[xt]!==At[xt])return!1;return!0}function alloc$3(kt=0){return new Uint8Array(kt)}function allocUnsafe$1(kt=0){return new Uint8Array(kt)}function asUint8Array$1(kt){return kt}function concat$2(kt,At){At==null&&(At=kt.reduce((Nt,jt)=>Nt+jt.length,0));const xt=allocUnsafe$1(At);let Bt=0;for(const Nt of kt)xt.set(Nt,Bt),Bt+=Nt.length;return xt}const empty=new Uint8Array(0);function fromHex(kt){const At=kt.match(/../g);return At!=null?new Uint8Array(At.map(xt=>parseInt(xt,16))):empty}function equals$3(kt,At){if(kt===At)return!0;if(kt.byteLength!==At.byteLength)return!1;for(let xt=0;xt<kt.byteLength;xt++)if(kt[xt]!==At[xt])return!1;return!0}function coerce$2(kt){if(kt instanceof Uint8Array&&kt.constructor.name==="Uint8Array")return kt;if(kt instanceof ArrayBuffer)return new Uint8Array(kt);if(ArrayBuffer.isView(kt))return new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength);throw new Error("Unknown type, must be binary type")}function fromString$4(kt){return new TextEncoder().encode(kt)}function toString$9(kt){return new TextDecoder().decode(kt)}function base$4(kt,At){if(kt.length>=255)throw new TypeError("Alphabet too long");for(var xt=new Uint8Array(256),Bt=0;Bt<xt.length;Bt++)xt[Bt]=255;for(var Nt=0;Nt<kt.length;Nt++){var jt=kt.charAt(Nt),Ut=jt.charCodeAt(0);if(xt[Ut]!==255)throw new TypeError(jt+" is ambiguous");xt[Ut]=Nt}var Lt=kt.length,Ht=kt.charAt(0),Vt=Math.log(Lt)/Math.log(256),zt=Math.log(256)/Math.log(Lt);function Wt(Xt){if(Xt instanceof Uint8Array||(ArrayBuffer.isView(Xt)?Xt=new Uint8Array(Xt.buffer,Xt.byteOffset,Xt.byteLength):Array.isArray(Xt)&&(Xt=Uint8Array.from(Xt))),!(Xt instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Xt.length===0)return"";for(var tr=0,rr=0,nr=0,ar=Xt.length;nr!==ar&&Xt[nr]===0;)nr++,tr++;for(var ir=(ar-nr)*zt+1>>>0,lr=new Uint8Array(ir);nr!==ar;){for(var yr=Xt[nr],Sr=0,Ar=ir-1;(yr!==0||Sr<rr)&&Ar!==-1;Ar--,Sr++)yr+=256*lr[Ar]>>>0,lr[Ar]=yr%Lt>>>0,yr=yr/Lt>>>0;if(yr!==0)throw new Error("Non-zero carry");rr=Sr,nr++}for(var Dr=ir-rr;Dr!==ir&&lr[Dr]===0;)Dr++;for(var Br=Ht.repeat(tr);Dr<ir;++Dr)Br+=kt.charAt(lr[Dr]);return Br}function Jt(Xt){if(typeof Xt!="string")throw new TypeError("Expected String");if(Xt.length===0)return new Uint8Array;var tr=0;if(Xt[tr]!==" "){for(var rr=0,nr=0;Xt[tr]===Ht;)rr++,tr++;for(var ar=(Xt.length-tr)*Vt+1>>>0,ir=new Uint8Array(ar);Xt[tr];){var lr=xt[Xt.charCodeAt(tr)];if(lr===255)return;for(var yr=0,Sr=ar-1;(lr!==0||yr<nr)&&Sr!==-1;Sr--,yr++)lr+=Lt*ir[Sr]>>>0,ir[Sr]=lr%256>>>0,lr=lr/256>>>0;if(lr!==0)throw new Error("Non-zero carry");nr=yr,tr++}if(Xt[tr]!==" "){for(var Ar=ar-nr;Ar!==ar&&ir[Ar]===0;)Ar++;for(var Dr=new Uint8Array(rr+(ar-Ar)),Br=rr;Ar!==ar;)Dr[Br++]=ir[Ar++];return Dr}}}function Qt(Xt){var tr=Jt(Xt);if(tr)return tr;throw new Error(`Non-${At} character`)}return{encode:Wt,decodeUnsafe:Jt,decode:Qt}}var src$2=base$4,_brrp__multiformats_scope_baseX$2=src$2;let Encoder$3=class{name;prefix;baseEncode;constructor(At,xt,Bt){this.name=At,this.prefix=xt,this.baseEncode=Bt}encode(At){if(At instanceof Uint8Array)return`${this.prefix}${this.baseEncode(At)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{name;prefix;baseDecode;prefixCodePoint;constructor(At,xt,Bt){if(this.name=At,this.prefix=xt,xt.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=xt.codePointAt(0),this.baseDecode=Bt}decode(At){if(typeof At=="string"){if(At.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(At)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(At.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(At){return or$2(this,At)}},ComposedDecoder$2=class{decoders;constructor(At){this.decoders=At}or(At){return or$2(this,At)}decode(At){const xt=At[0],Bt=this.decoders[xt];if(Bt!=null)return Bt.decode(At);throw RangeError(`Unable to decode multibase string ${JSON.stringify(At)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$2(kt,At){return new ComposedDecoder$2({...kt.decoders??{[kt.prefix]:kt},...At.decoders??{[At.prefix]:At}})}let Codec$2=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(At,xt,Bt,Nt){this.name=At,this.prefix=xt,this.baseEncode=Bt,this.baseDecode=Nt,this.encoder=new Encoder$3(At,xt,Bt),this.decoder=new Decoder$2(At,xt,Nt)}encode(At){return this.encoder.encode(At)}decode(At){return this.decoder.decode(At)}};function from$8({name:kt,prefix:At,encode:xt,decode:Bt}){return new Codec$2(kt,At,xt,Bt)}function baseX$2({name:kt,prefix:At,alphabet:xt}){const{encode:Bt,decode:Nt}=_brrp__multiformats_scope_baseX$2(xt,kt);return from$8({prefix:At,name:kt,encode:Bt,decode:jt=>coerce$2(Nt(jt))})}function decode$l(kt,At,xt,Bt){const Nt={};for(let zt=0;zt<At.length;++zt)Nt[At[zt]]=zt;let jt=kt.length;for(;kt[jt-1]==="=";)--jt;const Ut=new Uint8Array(jt*xt/8|0);let Lt=0,Ht=0,Vt=0;for(let zt=0;zt<jt;++zt){const Wt=Nt[kt[zt]];if(Wt===void 0)throw new SyntaxError(`Non-${Bt} character`);Ht=Ht<<xt|Wt,Lt+=xt,Lt>=8&&(Lt-=8,Ut[Vt++]=255&Ht>>Lt)}if(Lt>=xt||255&Ht<<8-Lt)throw new SyntaxError("Unexpected end of data");return Ut}function encode$h(kt,At,xt){const Bt=At[At.length-1]==="=",Nt=(1<<xt)-1;let jt="",Ut=0,Lt=0;for(let Ht=0;Ht<kt.length;++Ht)for(Lt=Lt<<8|kt[Ht],Ut+=8;Ut>xt;)Ut-=xt,jt+=At[Nt&Lt>>Ut];if(Ut!==0&&(jt+=At[Nt&Lt<<xt-Ut]),Bt)for(;jt.length*xt&7;)jt+="=";return jt}function rfc4648$2({name:kt,prefix:At,bitsPerChar:xt,alphabet:Bt}){return from$8({prefix:At,name:kt,encode(Nt){return encode$h(Nt,Bt,xt)},decode(Nt){return decode$l(Nt,Bt,xt,kt)}})}const base10$2=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),alphabet$3=Array.from(""),alphabetBytesToChars$1=alphabet$3.reduce((kt,At,xt)=>(kt[xt]=At,kt),[]),alphabetCharsToBytes$1=alphabet$3.reduce((kt,At,xt)=>(kt[At.codePointAt(0)]=xt,kt),[]);function encode$g(kt){return kt.reduce((At,xt)=>(At+=alphabetBytesToChars$1[xt],At),"")}function decode$k(kt){const At=[];for(const xt of kt){const Bt=alphabetCharsToBytes$1[xt.codePointAt(0)];if(Bt===void 0)throw new Error(`Non-base256emoji character: ${xt}`);At.push(Bt)}return new Uint8Array(At)}const base256emoji$2=from$8({prefix:"",name:"base256emoji",encode:encode$g,decode:decode$k}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"})),base32$3=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$3=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$4=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$3,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$3},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$3=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$3,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$2=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$3=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$2,base64pad:base64pad$1,base64url:base64url$2,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),identity$3=from$8({prefix:"\0",name:"identity",encode:kt=>toString$9(kt),decode:kt=>fromString$4(kt)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;var encode_1$2=encode$f,MSB$4=128,REST$4=127,MSBALL$2=~REST$4,INT$2=Math.pow(2,31);function encode$f(kt,At,xt){At=At||[],xt=xt||0;for(var Bt=xt;kt>=INT$2;)At[xt++]=kt&255|MSB$4,kt/=128;for(;kt&MSBALL$2;)At[xt++]=kt&255|MSB$4,kt>>>=7;return At[xt]=kt|0,encode$f.bytes=xt-Bt+1,At}var decode$j=read$3,MSB$1$2=128,REST$1$2=127;function read$3(kt,Bt){var xt=0,Bt=Bt||0,Nt=0,jt=Bt,Ut,Lt=kt.length;do{if(jt>=Lt)throw read$3.bytes=0,new RangeError("Could not decode varint");Ut=kt[jt++],xt+=Nt<28?(Ut&REST$1$2)<<Nt:(Ut&REST$1$2)*Math.pow(2,Nt),Nt+=7}while(Ut>=MSB$1$2);return read$3.bytes=jt-Bt,xt}var N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$3=function(kt){return kt<N1$3?1:kt<N2$3?2:kt<N3$3?3:kt<N4$3?4:kt<N5$3?5:kt<N6$3?6:kt<N7$3?7:kt<N8$2?8:kt<N9$2?9:10},varint$2={encode:encode_1$2,decode:decode$j,encodingLength:length$3},_brrp_varint$2=varint$2;function decode$i(kt,At=0){return[_brrp_varint$2.decode(kt,At),_brrp_varint$2.decode.bytes]}function encodeTo$2(kt,At,xt=0){return _brrp_varint$2.encode(kt,At,xt),At}function encodingLength$7(kt){return _brrp_varint$2.encodingLength(kt)}function create$1(kt,At){const xt=At.byteLength,Bt=encodingLength$7(kt),Nt=Bt+encodingLength$7(xt),jt=new Uint8Array(Nt+xt);return encodeTo$2(kt,jt,0),encodeTo$2(xt,jt,Bt),jt.set(At,Nt),new Digest$1(kt,xt,At,jt)}function decode$h(kt){const At=coerce$2(kt),[xt,Bt]=decode$i(At),[Nt,jt]=decode$i(At.subarray(Bt)),Ut=At.subarray(Bt+jt);if(Ut.byteLength!==Nt)throw new Error("Incorrect length");return new Digest$1(xt,Nt,Ut,At)}function equals$2(kt,At){if(kt===At)return!0;{const xt=At;return kt.code===xt.code&&kt.size===xt.size&&xt.bytes instanceof Uint8Array&&equals$3(kt.bytes,xt.bytes)}}let Digest$1=class{code;size;digest;bytes;constructor(At,xt,Bt,Nt){this.code=At,this.size=xt,this.digest=Bt,this.bytes=Nt}};function from$7({name:kt,code:At,encode:xt}){return new Hasher$1(kt,At,xt)}let Hasher$1=class{name;code;encode;constructor(At,xt,Bt){this.name=At,this.code=xt,this.encode=Bt}digest(At){if(At instanceof Uint8Array){const xt=this.encode(At);return xt instanceof Uint8Array?create$1(this.code,xt):xt.then(Bt=>create$1(this.code,Bt))}else throw Error("Unknown type, must be binary type")}};function format$9(kt,At){const{bytes:xt,version:Bt}=kt;switch(Bt){case 0:return toStringV0$2(xt,baseCache$2(kt),At??base58btc$3.encoder);default:return toStringV1$2(xt,baseCache$2(kt),At??base32$3.encoder)}}const cache$3=new WeakMap;function baseCache$2(kt){const At=cache$3.get(kt);if(At==null){const xt=new Map;return cache$3.set(kt,xt),xt}return At}let CID$2=class mi{code;version;multihash;bytes;"/";constructor(At,xt,Bt,Nt){this.code=xt,this.version=At,this.multihash=Bt,this.bytes=Nt,this["/"]=Nt}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:At,multihash:xt}=this;if(At!==DAG_PB_CODE$2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(xt.code!==SHA_256_CODE$2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return mi.createV0(xt)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:At,digest:xt}=this.multihash,Bt=create$1(At,xt);return mi.createV1(this.code,Bt)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(At){return mi.equals(this,At)}static equals(At,xt){const Bt=xt;return Bt!=null&&At.code===Bt.code&&At.version===Bt.version&&equals$2(At.multihash,Bt.multihash)}toString(At){return format$9(this,At)}toJSON(){return{"/":format$9(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(At){if(At==null)return null;const xt=At;if(xt instanceof mi)return xt;if(xt["/"]!=null&&xt["/"]===xt.bytes||xt.asCID===xt){const{version:Bt,code:Nt,multihash:jt,bytes:Ut}=xt;return new mi(Bt,Nt,jt,Ut??encodeCID$2(Bt,Nt,jt.bytes))}else if(xt[cidSymbol$2]===!0){const{version:Bt,multihash:Nt,code:jt}=xt,Ut=decode$h(Nt);return mi.create(Bt,jt,Ut)}else return null}static create(At,xt,Bt){if(typeof xt!="number")throw new Error("String codecs are no longer supported");if(!(Bt.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(At){case 0:{if(xt!==DAG_PB_CODE$2)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$2}) block encoding`);return new mi(At,xt,Bt,Bt.bytes)}case 1:{const Nt=encodeCID$2(At,xt,Bt.bytes);return new mi(At,xt,Bt,Nt)}default:throw new Error("Invalid version")}}static createV0(At){return mi.create(0,DAG_PB_CODE$2,At)}static createV1(At,xt){return mi.create(1,At,xt)}static decode(At){const[xt,Bt]=mi.decodeFirst(At);if(Bt.length!==0)throw new Error("Incorrect length");return xt}static decodeFirst(At){const xt=mi.inspectBytes(At),Bt=xt.size-xt.multihashSize,Nt=coerce$2(At.subarray(Bt,Bt+xt.multihashSize));if(Nt.byteLength!==xt.multihashSize)throw new Error("Incorrect length");const jt=Nt.subarray(xt.multihashSize-xt.digestSize),Ut=new Digest$1(xt.multihashCode,xt.digestSize,jt,Nt);return[xt.version===0?mi.createV0(Ut):mi.createV1(xt.codec,Ut),At.subarray(xt.size)]}static inspectBytes(At){let xt=0;const Bt=()=>{const[Wt,Jt]=decode$i(At.subarray(xt));return xt+=Jt,Wt};let Nt=Bt(),jt=DAG_PB_CODE$2;if(Nt===18?(Nt=0,xt=0):jt=Bt(),Nt!==0&&Nt!==1)throw new RangeError(`Invalid CID version ${Nt}`);const Ut=xt,Lt=Bt(),Ht=Bt(),Vt=xt+Ht,zt=Vt-Ut;return{version:Nt,codec:jt,multihashCode:Lt,digestSize:Ht,multihashSize:zt,size:Vt}}static parse(At,xt){const[Bt,Nt]=parseCIDtoBytes$2(At,xt),jt=mi.decode(Nt);if(jt.version===0&&At[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$2(jt).set(Bt,At),jt}};function parseCIDtoBytes$2(kt,At){switch(kt[0]){case"Q":{const xt=At??base58btc$3;return[base58btc$3.prefix,xt.decode(`${base58btc$3.prefix}${kt}`)]}case base58btc$3.prefix:{const xt=At??base58btc$3;return[base58btc$3.prefix,xt.decode(kt)]}case base32$3.prefix:{const xt=At??base32$3;return[base32$3.prefix,xt.decode(kt)]}default:{if(At==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[kt[0],At.decode(kt)]}}}function toStringV0$2(kt,At,xt){const{prefix:Bt}=xt;if(Bt!==base58btc$3.prefix)throw Error(`Cannot string encode V0 in ${xt.name} encoding`);const Nt=At.get(Bt);if(Nt==null){const jt=xt.encode(kt).slice(1);return At.set(Bt,jt),jt}else return Nt}function toStringV1$2(kt,At,xt){const{prefix:Bt}=xt,Nt=At.get(Bt);if(Nt==null){const jt=xt.encode(kt);return At.set(Bt,jt),jt}else return Nt}const DAG_PB_CODE$2=112,SHA_256_CODE$2=18;function encodeCID$2(kt,At,xt){const Bt=encodingLength$7(kt),Nt=Bt+encodingLength$7(At),jt=new Uint8Array(Nt+xt.byteLength);return encodeTo$2(kt,jt,0),encodeTo$2(At,jt,Bt),jt.set(xt,Nt),jt}const cidSymbol$2=Symbol.for("@ipld/js-cid/CID"),bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$4,...base36$3,...base58$1,...base64$3,...base256emoji$3};function createCodec$2(kt,At,xt,Bt){return{name:kt,prefix:At,encoder:{name:kt,prefix:At,encode:xt},decoder:{decode:Bt}}}const string$2=createCodec$2("utf8","u",kt=>"u"+new TextDecoder("utf8").decode(kt),kt=>new TextEncoder().encode(kt.substring(1))),ascii$1=createCodec$2("ascii","a",kt=>{let At="a";for(let xt=0;xt<kt.length;xt++)At+=String.fromCharCode(kt[xt]);return At},kt=>{kt=kt.substring(1);const At=allocUnsafe$1(kt.length);for(let xt=0;xt<kt.length;xt++)At[xt]=kt.charCodeAt(xt);return At}),BASES$1={utf8:string$2,"utf-8":string$2,hex:bases$1.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1,...bases$1};function fromString$3(kt,At="utf8"){const xt=BASES$1[At];if(xt==null)throw new Error(`Unsupported encoding "${At}"`);return xt.decoder.decode(`${xt.prefix}${kt}`)}function toString$8(kt,At="utf8"){const xt=BASES$1[At];if(xt==null)throw new Error(`Unsupported encoding "${At}"`);return xt.encoder.encode(kt).substring(1)}var __awaiter$2H=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const u8a={toString:toString$8,fromString:fromString$3};let Secp256r1$3=class eo{static validateKey(At){if(At.kty!=="EC"||At.crv!=="P-256")throw new DwnError(DwnErrorCode.Secp256r1KeyNotValid,"Invalid SECP256R1 JWK: `kty` MUST be `EC`. `crv` MUST be `P-256`")}static publicKeyToJwk(At){return __awaiter$2H(this,void 0,void 0,function*(){let xt;At.byteLength===33?xt=p256$1.ProjectivePoint.fromHex(At).toRawBytes(!1):xt=At;const Bt=Encoder$4.bytesToBase64Url(xt.subarray(1,33)),Nt=Encoder$4.bytesToBase64Url(xt.subarray(33,65));return{alg:"ES256",kty:"EC",crv:"P-256",x:Bt,y:Nt}})}static privateJwkToBytes(At){return Encoder$4.base64UrlToBytes(At.d)}static sign(At,xt){return __awaiter$2H(this,void 0,void 0,function*(){eo.validateKey(xt);const Bt=yield sha256$7.encode(At),Nt=eo.privateJwkToBytes(xt);return Promise.resolve(p256$1.sign(Bt,Nt).toCompactRawBytes())})}static verify(At,xt,Bt){return __awaiter$2H(this,void 0,void 0,function*(){eo.validateKey(Bt);let Nt;xt.length===64?Nt=p256$1.Signature.fromCompact(xt):Nt=p256$1.Signature.fromDER(xt);const jt=yield sha256$7.encode(At),Ut=p256$1.ProjectivePoint.fromAffine({x:eo.bytesToBigInt(Encoder$4.base64UrlToBytes(Bt.x)),y:eo.bytesToBigInt(Encoder$4.base64UrlToBytes(Bt.y))}).toRawBytes(!1);return p256$1.verify(Nt,jt,Ut)})}static generateKeyPair(){return __awaiter$2H(this,void 0,void 0,function*(){const At=p256$1.utils.randomPrivateKey(),xt=secp256r1$1.getPublicKey(At,!1),Bt=Encoder$4.bytesToBase64Url(At),Nt=yield eo.publicKeyToJwk(xt),jt=Object.assign(Object.assign({},Nt),{d:Bt});return{publicJwk:Nt,privateJwk:jt}})}static bytesToBigInt(At){return BigInt("0x"+u8a.toString(At,"base16"))}};const signatureAlgorithms={Ed25519:ed25519$2,secp256k1:{sign:Secp256k1$3.sign,verify:Secp256k1$3.verify,generateKeyPair:Secp256k1$3.generateKeyPair,publicKeyToJwk:Secp256k1$3.publicKeyToJwk},"P-256":{sign:Secp256r1$3.sign,verify:Secp256r1$3.verify,generateKeyPair:Secp256r1$3.generateKeyPair,publicKeyToJwk:Secp256r1$3.publicKeyToJwk}};var __awaiter$2G=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class PrivateKeySigner{constructor(At){var xt,Bt;if(At.keyId===void 0&&At.privateJwk.kid===void 0)throw new DwnError(DwnErrorCode.PrivateKeySignerUnableToDeduceKeyId,"Unable to deduce the key ID");if(At.algorithm===void 0&&At.privateJwk.alg===void 0)throw new DwnError(DwnErrorCode.PrivateKeySignerUnableToDeduceAlgorithm,"Unable to deduce the signature algorithm");if(this.keyId=(xt=At.keyId)!==null&&xt!==void 0?xt:At.privateJwk.kid,this.algorithm=(Bt=At.algorithm)!==null&&Bt!==void 0?Bt:At.privateJwk.alg,this.privateJwk=At.privateJwk,this.signatureAlgorithm=signatureAlgorithms[At.privateJwk.crv],!this.signatureAlgorithm)throw new DwnError(DwnErrorCode.PrivateKeySignerUnsupportedCurve,`Unsupported crv ${At.privateJwk.crv}, crv must be one of ${Object.keys(signatureAlgorithms)}`)}sign(At){return __awaiter$2G(this,void 0,void 0,function*(){return yield this.signatureAlgorithm.sign(At,this.privateJwk)})}}var __awaiter$2F=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Jws{static getKid(At){const{kid:xt}=Encoder$4.base64UrlToObject(At.protected);return xt}static getSignerDid(At){const xt=Jws.getKid(At);return Jws.extractDid(xt)}static verifySignature(At,xt,Bt){return __awaiter$2F(this,void 0,void 0,function*(){const Nt=signatureAlgorithms[Bt.crv];if(!Nt)throw new DwnError(DwnErrorCode.JwsVerifySignatureUnsupportedCrv,`unsupported crv. crv must be one of ${Object.keys(signatureAlgorithms)}`);const jt=Encoder$4.stringToBytes(`${xt.protected}.${At}`),Ut=Encoder$4.base64UrlToBytes(xt.signature);return yield Nt.verify(jt,Ut,Bt)})}static decodePlainObjectPayload(At){let xt;try{xt=Encoder$4.base64UrlToObject(At.payload)}catch{throw new DwnError(DwnErrorCode.JwsDecodePlainObjectPayloadInvalid,"payload is not a JSON object")}if(!isPlainObject$1(xt))throw new DwnError(DwnErrorCode.JwsDecodePlainObjectPayloadInvalid,"signed payload must be a plain object");return xt}static extractDid(At){const[xt]=At.split("#");return xt}static createSigners(At){return At.map(Bt=>Jws.createSigner(Bt))}static createSigner(At){const xt=At.keyPair.privateJwk,Bt=At.keyId;return new PrivateKeySigner({privateJwk:xt,keyId:Bt})}}var buffer$2={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup$2=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code$6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$4=0,len=code$6.length;i$4<len;++i$4)lookup$2[i$4]=code$6[i$4],revLookup[code$6.charCodeAt(i$4)]=i$4;revLookup[45]=62;revLookup[95]=63;function getLens(kt){var At=kt.length;if(At%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var xt=kt.indexOf("=");xt===-1&&(xt=At);var Bt=xt===At?0:4-xt%4;return[xt,Bt]}function byteLength(kt){var At=getLens(kt),xt=At[0],Bt=At[1];return(xt+Bt)*3/4-Bt}function _byteLength(kt,At,xt){return(At+xt)*3/4-xt}function toByteArray(kt){var At,xt=getLens(kt),Bt=xt[0],Nt=xt[1],jt=new Arr(_byteLength(kt,Bt,Nt)),Ut=0,Lt=Nt>0?Bt-4:Bt,Ht;for(Ht=0;Ht<Lt;Ht+=4)At=revLookup[kt.charCodeAt(Ht)]<<18|revLookup[kt.charCodeAt(Ht+1)]<<12|revLookup[kt.charCodeAt(Ht+2)]<<6|revLookup[kt.charCodeAt(Ht+3)],jt[Ut++]=At>>16&255,jt[Ut++]=At>>8&255,jt[Ut++]=At&255;return Nt===2&&(At=revLookup[kt.charCodeAt(Ht)]<<2|revLookup[kt.charCodeAt(Ht+1)]>>4,jt[Ut++]=At&255),Nt===1&&(At=revLookup[kt.charCodeAt(Ht)]<<10|revLookup[kt.charCodeAt(Ht+1)]<<4|revLookup[kt.charCodeAt(Ht+2)]>>2,jt[Ut++]=At>>8&255,jt[Ut++]=At&255),jt}function tripletToBase64(kt){return lookup$2[kt>>18&63]+lookup$2[kt>>12&63]+lookup$2[kt>>6&63]+lookup$2[kt&63]}function encodeChunk(kt,At,xt){for(var Bt,Nt=[],jt=At;jt<xt;jt+=3)Bt=(kt[jt]<<16&16711680)+(kt[jt+1]<<8&65280)+(kt[jt+2]&255),Nt.push(tripletToBase64(Bt));return Nt.join("")}function fromByteArray(kt){for(var At,xt=kt.length,Bt=xt%3,Nt=[],jt=16383,Ut=0,Lt=xt-Bt;Ut<Lt;Ut+=jt)Nt.push(encodeChunk(kt,Ut,Ut+jt>Lt?Lt:Ut+jt));return Bt===1?(At=kt[xt-1],Nt.push(lookup$2[At>>2]+lookup$2[At<<4&63]+"==")):Bt===2&&(At=(kt[xt-2]<<8)+kt[xt-1],Nt.push(lookup$2[At>>10]+lookup$2[At>>4&63]+lookup$2[At<<2&63]+"=")),Nt.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(kt,At,xt,Bt,Nt){var jt,Ut,Lt=Nt*8-Bt-1,Ht=(1<<Lt)-1,Vt=Ht>>1,zt=-7,Wt=xt?Nt-1:0,Jt=xt?-1:1,Qt=kt[At+Wt];for(Wt+=Jt,jt=Qt&(1<<-zt)-1,Qt>>=-zt,zt+=Lt;zt>0;jt=jt*256+kt[At+Wt],Wt+=Jt,zt-=8);for(Ut=jt&(1<<-zt)-1,jt>>=-zt,zt+=Bt;zt>0;Ut=Ut*256+kt[At+Wt],Wt+=Jt,zt-=8);if(jt===0)jt=1-Vt;else{if(jt===Ht)return Ut?NaN:(Qt?-1:1)*(1/0);Ut=Ut+Math.pow(2,Bt),jt=jt-Vt}return(Qt?-1:1)*Ut*Math.pow(2,jt-Bt)};ieee754.write=function(kt,At,xt,Bt,Nt,jt){var Ut,Lt,Ht,Vt=jt*8-Nt-1,zt=(1<<Vt)-1,Wt=zt>>1,Jt=Nt===23?Math.pow(2,-24)-Math.pow(2,-77):0,Qt=Bt?0:jt-1,Xt=Bt?1:-1,tr=At<0||At===0&&1/At<0?1:0;for(At=Math.abs(At),isNaN(At)||At===1/0?(Lt=isNaN(At)?1:0,Ut=zt):(Ut=Math.floor(Math.log(At)/Math.LN2),At*(Ht=Math.pow(2,-Ut))<1&&(Ut--,Ht*=2),Ut+Wt>=1?At+=Jt/Ht:At+=Jt*Math.pow(2,1-Wt),At*Ht>=2&&(Ut++,Ht/=2),Ut+Wt>=zt?(Lt=0,Ut=zt):Ut+Wt>=1?(Lt=(At*Ht-1)*Math.pow(2,Nt),Ut=Ut+Wt):(Lt=At*Math.pow(2,Wt-1)*Math.pow(2,Nt),Ut=0));Nt>=8;kt[xt+Qt]=Lt&255,Qt+=Xt,Lt/=256,Nt-=8);for(Ut=Ut<<Nt|Lt,Vt+=Nt;Vt>0;kt[xt+Qt]=Ut&255,Qt+=Xt,Ut/=256,Vt-=8);kt[xt+Qt-Xt]|=tr*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(kt){var At=base64Js,xt=ieee754,Bt=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;kt.Buffer=Lt,kt.SlowBuffer=ar,kt.INSPECT_MAX_BYTES=50;var Nt=2147483647;kt.kMaxLength=Nt,Lt.TYPED_ARRAY_SUPPORT=jt(),!Lt.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function jt(){try{var jr=new Uint8Array(1),Ir={foo:function(){return 42}};return Object.setPrototypeOf(Ir,Uint8Array.prototype),Object.setPrototypeOf(jr,Ir),jr.foo()===42}catch{return!1}}Object.defineProperty(Lt.prototype,"parent",{enumerable:!0,get:function(){if(Lt.isBuffer(this))return this.buffer}}),Object.defineProperty(Lt.prototype,"offset",{enumerable:!0,get:function(){if(Lt.isBuffer(this))return this.byteOffset}});function Ut(jr){if(jr>Nt)throw new RangeError('The value "'+jr+'" is invalid for option "size"');var Ir=new Uint8Array(jr);return Object.setPrototypeOf(Ir,Lt.prototype),Ir}function Lt(jr,Ir,Mr){if(typeof jr=="number"){if(typeof Ir=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Wt(jr)}return Ht(jr,Ir,Mr)}Lt.poolSize=8192;function Ht(jr,Ir,Mr){if(typeof jr=="string")return Jt(jr,Ir);if(ArrayBuffer.isView(jr))return Xt(jr);if(jr==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof jr);if(kr(jr,ArrayBuffer)||jr&&kr(jr.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(kr(jr,SharedArrayBuffer)||jr&&kr(jr.buffer,SharedArrayBuffer)))return tr(jr,Ir,Mr);if(typeof jr=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Hr=jr.valueOf&&jr.valueOf();if(Hr!=null&&Hr!==jr)return Lt.from(Hr,Ir,Mr);var Qr=rr(jr);if(Qr)return Qr;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof jr[Symbol.toPrimitive]=="function")return Lt.from(jr[Symbol.toPrimitive]("string"),Ir,Mr);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof jr)}Lt.from=function(jr,Ir,Mr){return Ht(jr,Ir,Mr)},Object.setPrototypeOf(Lt.prototype,Uint8Array.prototype),Object.setPrototypeOf(Lt,Uint8Array);function Vt(jr){if(typeof jr!="number")throw new TypeError('"size" argument must be of type number');if(jr<0)throw new RangeError('The value "'+jr+'" is invalid for option "size"')}function zt(jr,Ir,Mr){return Vt(jr),jr<=0?Ut(jr):Ir!==void 0?typeof Mr=="string"?Ut(jr).fill(Ir,Mr):Ut(jr).fill(Ir):Ut(jr)}Lt.alloc=function(jr,Ir,Mr){return zt(jr,Ir,Mr)};function Wt(jr){return Vt(jr),Ut(jr<0?0:nr(jr)|0)}Lt.allocUnsafe=function(jr){return Wt(jr)},Lt.allocUnsafeSlow=function(jr){return Wt(jr)};function Jt(jr,Ir){if((typeof Ir!="string"||Ir==="")&&(Ir="utf8"),!Lt.isEncoding(Ir))throw new TypeError("Unknown encoding: "+Ir);var Mr=ir(jr,Ir)|0,Hr=Ut(Mr),Qr=Hr.write(jr,Ir);return Qr!==Mr&&(Hr=Hr.slice(0,Qr)),Hr}function Qt(jr){for(var Ir=jr.length<0?0:nr(jr.length)|0,Mr=Ut(Ir),Hr=0;Hr<Ir;Hr+=1)Mr[Hr]=jr[Hr]&255;return Mr}function Xt(jr){if(kr(jr,Uint8Array)){var Ir=new Uint8Array(jr);return tr(Ir.buffer,Ir.byteOffset,Ir.byteLength)}return Qt(jr)}function tr(jr,Ir,Mr){if(Ir<0||jr.byteLength<Ir)throw new RangeError('"offset" is outside of buffer bounds');if(jr.byteLength<Ir+(Mr||0))throw new RangeError('"length" is outside of buffer bounds');var Hr;return Ir===void 0&&Mr===void 0?Hr=new Uint8Array(jr):Mr===void 0?Hr=new Uint8Array(jr,Ir):Hr=new Uint8Array(jr,Ir,Mr),Object.setPrototypeOf(Hr,Lt.prototype),Hr}function rr(jr){if(Lt.isBuffer(jr)){var Ir=nr(jr.length)|0,Mr=Ut(Ir);return Mr.length===0||jr.copy(Mr,0,0,Ir),Mr}if(jr.length!==void 0)return typeof jr.length!="number"||Fr(jr.length)?Ut(0):Qt(jr);if(jr.type==="Buffer"&&Array.isArray(jr.data))return Qt(jr.data)}function nr(jr){if(jr>=Nt)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Nt.toString(16)+" bytes");return jr|0}function ar(jr){return+jr!=jr&&(jr=0),Lt.alloc(+jr)}Lt.isBuffer=function(Ir){return Ir!=null&&Ir._isBuffer===!0&&Ir!==Lt.prototype},Lt.compare=function(Ir,Mr){if(kr(Ir,Uint8Array)&&(Ir=Lt.from(Ir,Ir.offset,Ir.byteLength)),kr(Mr,Uint8Array)&&(Mr=Lt.from(Mr,Mr.offset,Mr.byteLength)),!Lt.isBuffer(Ir)||!Lt.isBuffer(Mr))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Ir===Mr)return 0;for(var Hr=Ir.length,Qr=Mr.length,on=0,nn=Math.min(Hr,Qr);on<nn;++on)if(Ir[on]!==Mr[on]){Hr=Ir[on],Qr=Mr[on];break}return Hr<Qr?-1:Qr<Hr?1:0},Lt.isEncoding=function(Ir){switch(String(Ir).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Lt.concat=function(Ir,Mr){if(!Array.isArray(Ir))throw new TypeError('"list" argument must be an Array of Buffers');if(Ir.length===0)return Lt.alloc(0);var Hr;if(Mr===void 0)for(Mr=0,Hr=0;Hr<Ir.length;++Hr)Mr+=Ir[Hr].length;var Qr=Lt.allocUnsafe(Mr),on=0;for(Hr=0;Hr<Ir.length;++Hr){var nn=Ir[Hr];if(kr(nn,Uint8Array))on+nn.length>Qr.length?Lt.from(nn).copy(Qr,on):Uint8Array.prototype.set.call(Qr,nn,on);else if(Lt.isBuffer(nn))nn.copy(Qr,on);else throw new TypeError('"list" argument must be an Array of Buffers');on+=nn.length}return Qr};function ir(jr,Ir){if(Lt.isBuffer(jr))return jr.length;if(ArrayBuffer.isView(jr)||kr(jr,ArrayBuffer))return jr.byteLength;if(typeof jr!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof jr);var Mr=jr.length,Hr=arguments.length>2&&arguments[2]===!0;if(!Hr&&Mr===0)return 0;for(var Qr=!1;;)switch(Ir){case"ascii":case"latin1":case"binary":return Mr;case"utf8":case"utf-8":return Rr(jr).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mr*2;case"hex":return Mr>>>1;case"base64":return Gr(jr).length;default:if(Qr)return Hr?-1:Rr(jr).length;Ir=(""+Ir).toLowerCase(),Qr=!0}}Lt.byteLength=ir;function lr(jr,Ir,Mr){var Hr=!1;if((Ir===void 0||Ir<0)&&(Ir=0),Ir>this.length||((Mr===void 0||Mr>this.length)&&(Mr=this.length),Mr<=0)||(Mr>>>=0,Ir>>>=0,Mr<=Ir))return"";for(jr||(jr="utf8");;)switch(jr){case"hex":return gr(this,Ir,Mr);case"utf8":case"utf-8":return dr(this,Ir,Mr);case"ascii":return wr(this,Ir,Mr);case"latin1":case"binary":return Er(this,Ir,Mr);case"base64":return pr(this,Ir,Mr);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fr(this,Ir,Mr);default:if(Hr)throw new TypeError("Unknown encoding: "+jr);jr=(jr+"").toLowerCase(),Hr=!0}}Lt.prototype._isBuffer=!0;function yr(jr,Ir,Mr){var Hr=jr[Ir];jr[Ir]=jr[Mr],jr[Mr]=Hr}Lt.prototype.swap16=function(){var Ir=this.length;if(Ir%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Mr=0;Mr<Ir;Mr+=2)yr(this,Mr,Mr+1);return this},Lt.prototype.swap32=function(){var Ir=this.length;if(Ir%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Mr=0;Mr<Ir;Mr+=4)yr(this,Mr,Mr+3),yr(this,Mr+1,Mr+2);return this},Lt.prototype.swap64=function(){var Ir=this.length;if(Ir%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Mr=0;Mr<Ir;Mr+=8)yr(this,Mr,Mr+7),yr(this,Mr+1,Mr+6),yr(this,Mr+2,Mr+5),yr(this,Mr+3,Mr+4);return this},Lt.prototype.toString=function(){var Ir=this.length;return Ir===0?"":arguments.length===0?dr(this,0,Ir):lr.apply(this,arguments)},Lt.prototype.toLocaleString=Lt.prototype.toString,Lt.prototype.equals=function(Ir){if(!Lt.isBuffer(Ir))throw new TypeError("Argument must be a Buffer");return this===Ir?!0:Lt.compare(this,Ir)===0},Lt.prototype.inspect=function(){var Ir="",Mr=kt.INSPECT_MAX_BYTES;return Ir=this.toString("hex",0,Mr).replace(/(.{2})/g,"$1 ").trim(),this.length>Mr&&(Ir+=" ... "),"<Buffer "+Ir+">"},Bt&&(Lt.prototype[Bt]=Lt.prototype.inspect),Lt.prototype.compare=function(Ir,Mr,Hr,Qr,on){if(kr(Ir,Uint8Array)&&(Ir=Lt.from(Ir,Ir.offset,Ir.byteLength)),!Lt.isBuffer(Ir))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Ir);if(Mr===void 0&&(Mr=0),Hr===void 0&&(Hr=Ir?Ir.length:0),Qr===void 0&&(Qr=0),on===void 0&&(on=this.length),Mr<0||Hr>Ir.length||Qr<0||on>this.length)throw new RangeError("out of range index");if(Qr>=on&&Mr>=Hr)return 0;if(Qr>=on)return-1;if(Mr>=Hr)return 1;if(Mr>>>=0,Hr>>>=0,Qr>>>=0,on>>>=0,this===Ir)return 0;for(var nn=on-Qr,fn=Hr-Mr,hn=Math.min(nn,fn),Jr=this.slice(Qr,on),Yr=Ir.slice(Mr,Hr),an=0;an<hn;++an)if(Jr[an]!==Yr[an]){nn=Jr[an],fn=Yr[an];break}return nn<fn?-1:fn<nn?1:0};function Sr(jr,Ir,Mr,Hr,Qr){if(jr.length===0)return-1;if(typeof Mr=="string"?(Hr=Mr,Mr=0):Mr>2147483647?Mr=2147483647:Mr<-2147483648&&(Mr=-2147483648),Mr=+Mr,Fr(Mr)&&(Mr=Qr?0:jr.length-1),Mr<0&&(Mr=jr.length+Mr),Mr>=jr.length){if(Qr)return-1;Mr=jr.length-1}else if(Mr<0)if(Qr)Mr=0;else return-1;if(typeof Ir=="string"&&(Ir=Lt.from(Ir,Hr)),Lt.isBuffer(Ir))return Ir.length===0?-1:Ar(jr,Ir,Mr,Hr,Qr);if(typeof Ir=="number")return Ir=Ir&255,typeof Uint8Array.prototype.indexOf=="function"?Qr?Uint8Array.prototype.indexOf.call(jr,Ir,Mr):Uint8Array.prototype.lastIndexOf.call(jr,Ir,Mr):Ar(jr,[Ir],Mr,Hr,Qr);throw new TypeError("val must be string, number or Buffer")}function Ar(jr,Ir,Mr,Hr,Qr){var on=1,nn=jr.length,fn=Ir.length;if(Hr!==void 0&&(Hr=String(Hr).toLowerCase(),Hr==="ucs2"||Hr==="ucs-2"||Hr==="utf16le"||Hr==="utf-16le")){if(jr.length<2||Ir.length<2)return-1;on=2,nn/=2,fn/=2,Mr/=2}function hn(cn,vn){return on===1?cn[vn]:cn.readUInt16BE(vn*on)}var Jr;if(Qr){var Yr=-1;for(Jr=Mr;Jr<nn;Jr++)if(hn(jr,Jr)===hn(Ir,Yr===-1?0:Jr-Yr)){if(Yr===-1&&(Yr=Jr),Jr-Yr+1===fn)return Yr*on}else Yr!==-1&&(Jr-=Jr-Yr),Yr=-1}else for(Mr+fn>nn&&(Mr=nn-fn),Jr=Mr;Jr>=0;Jr--){for(var an=!0,dn=0;dn<fn;dn++)if(hn(jr,Jr+dn)!==hn(Ir,dn)){an=!1;break}if(an)return Jr}return-1}Lt.prototype.includes=function(Ir,Mr,Hr){return this.indexOf(Ir,Mr,Hr)!==-1},Lt.prototype.indexOf=function(Ir,Mr,Hr){return Sr(this,Ir,Mr,Hr,!0)},Lt.prototype.lastIndexOf=function(Ir,Mr,Hr){return Sr(this,Ir,Mr,Hr,!1)};function Dr(jr,Ir,Mr,Hr){Mr=Number(Mr)||0;var Qr=jr.length-Mr;Hr?(Hr=Number(Hr),Hr>Qr&&(Hr=Qr)):Hr=Qr;var on=Ir.length;Hr>on/2&&(Hr=on/2);for(var nn=0;nn<Hr;++nn){var fn=parseInt(Ir.substr(nn*2,2),16);if(Fr(fn))return nn;jr[Mr+nn]=fn}return nn}function Br(jr,Ir,Mr,Hr){return Ur(Rr(Ir,jr.length-Mr),jr,Mr,Hr)}function Lr(jr,Ir,Mr,Hr){return Ur(qr(Ir),jr,Mr,Hr)}function Or(jr,Ir,Mr,Hr){return Ur(Gr(Ir),jr,Mr,Hr)}function vr(jr,Ir,Mr,Hr){return Ur(Vr(Ir,jr.length-Mr),jr,Mr,Hr)}Lt.prototype.write=function(Ir,Mr,Hr,Qr){if(Mr===void 0)Qr="utf8",Hr=this.length,Mr=0;else if(Hr===void 0&&typeof Mr=="string")Qr=Mr,Hr=this.length,Mr=0;else if(isFinite(Mr))Mr=Mr>>>0,isFinite(Hr)?(Hr=Hr>>>0,Qr===void 0&&(Qr="utf8")):(Qr=Hr,Hr=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var on=this.length-Mr;if((Hr===void 0||Hr>on)&&(Hr=on),Ir.length>0&&(Hr<0||Mr<0)||Mr>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qr||(Qr="utf8");for(var nn=!1;;)switch(Qr){case"hex":return Dr(this,Ir,Mr,Hr);case"utf8":case"utf-8":return Br(this,Ir,Mr,Hr);case"ascii":case"latin1":case"binary":return Lr(this,Ir,Mr,Hr);case"base64":return Or(this,Ir,Mr,Hr);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vr(this,Ir,Mr,Hr);default:if(nn)throw new TypeError("Unknown encoding: "+Qr);Qr=(""+Qr).toLowerCase(),nn=!0}},Lt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function pr(jr,Ir,Mr){return Ir===0&&Mr===jr.length?At.fromByteArray(jr):At.fromByteArray(jr.slice(Ir,Mr))}function dr(jr,Ir,Mr){Mr=Math.min(jr.length,Mr);for(var Hr=[],Qr=Ir;Qr<Mr;){var on=jr[Qr],nn=null,fn=on>239?4:on>223?3:on>191?2:1;if(Qr+fn<=Mr){var hn,Jr,Yr,an;switch(fn){case 1:on<128&&(nn=on);break;case 2:hn=jr[Qr+1],(hn&192)===128&&(an=(on&31)<<6|hn&63,an>127&&(nn=an));break;case 3:hn=jr[Qr+1],Jr=jr[Qr+2],(hn&192)===128&&(Jr&192)===128&&(an=(on&15)<<12|(hn&63)<<6|Jr&63,an>2047&&(an<55296||an>57343)&&(nn=an));break;case 4:hn=jr[Qr+1],Jr=jr[Qr+2],Yr=jr[Qr+3],(hn&192)===128&&(Jr&192)===128&&(Yr&192)===128&&(an=(on&15)<<18|(hn&63)<<12|(Jr&63)<<6|Yr&63,an>65535&&an<1114112&&(nn=an))}}nn===null?(nn=65533,fn=1):nn>65535&&(nn-=65536,Hr.push(nn>>>10&1023|55296),nn=56320|nn&1023),Hr.push(nn),Qr+=fn}return $r(Hr)}var ur=4096;function $r(jr){var Ir=jr.length;if(Ir<=ur)return String.fromCharCode.apply(String,jr);for(var Mr="",Hr=0;Hr<Ir;)Mr+=String.fromCharCode.apply(String,jr.slice(Hr,Hr+=ur));return Mr}function wr(jr,Ir,Mr){var Hr="";Mr=Math.min(jr.length,Mr);for(var Qr=Ir;Qr<Mr;++Qr)Hr+=String.fromCharCode(jr[Qr]&127);return Hr}function Er(jr,Ir,Mr){var Hr="";Mr=Math.min(jr.length,Mr);for(var Qr=Ir;Qr<Mr;++Qr)Hr+=String.fromCharCode(jr[Qr]);return Hr}function gr(jr,Ir,Mr){var Hr=jr.length;(!Ir||Ir<0)&&(Ir=0),(!Mr||Mr<0||Mr>Hr)&&(Mr=Hr);for(var Qr="",on=Ir;on<Mr;++on)Qr+=Wr[jr[on]];return Qr}function fr(jr,Ir,Mr){for(var Hr=jr.slice(Ir,Mr),Qr="",on=0;on<Hr.length-1;on+=2)Qr+=String.fromCharCode(Hr[on]+Hr[on+1]*256);return Qr}Lt.prototype.slice=function(Ir,Mr){var Hr=this.length;Ir=~~Ir,Mr=Mr===void 0?Hr:~~Mr,Ir<0?(Ir+=Hr,Ir<0&&(Ir=0)):Ir>Hr&&(Ir=Hr),Mr<0?(Mr+=Hr,Mr<0&&(Mr=0)):Mr>Hr&&(Mr=Hr),Mr<Ir&&(Mr=Ir);var Qr=this.subarray(Ir,Mr);return Object.setPrototypeOf(Qr,Lt.prototype),Qr};function br(jr,Ir,Mr){if(jr%1!==0||jr<0)throw new RangeError("offset is not uint");if(jr+Ir>Mr)throw new RangeError("Trying to access beyond buffer length")}Lt.prototype.readUintLE=Lt.prototype.readUIntLE=function(Ir,Mr,Hr){Ir=Ir>>>0,Mr=Mr>>>0,Hr||br(Ir,Mr,this.length);for(var Qr=this[Ir],on=1,nn=0;++nn<Mr&&(on*=256);)Qr+=this[Ir+nn]*on;return Qr},Lt.prototype.readUintBE=Lt.prototype.readUIntBE=function(Ir,Mr,Hr){Ir=Ir>>>0,Mr=Mr>>>0,Hr||br(Ir,Mr,this.length);for(var Qr=this[Ir+--Mr],on=1;Mr>0&&(on*=256);)Qr+=this[Ir+--Mr]*on;return Qr},Lt.prototype.readUint8=Lt.prototype.readUInt8=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,1,this.length),this[Ir]},Lt.prototype.readUint16LE=Lt.prototype.readUInt16LE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,2,this.length),this[Ir]|this[Ir+1]<<8},Lt.prototype.readUint16BE=Lt.prototype.readUInt16BE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,2,this.length),this[Ir]<<8|this[Ir+1]},Lt.prototype.readUint32LE=Lt.prototype.readUInt32LE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,4,this.length),(this[Ir]|this[Ir+1]<<8|this[Ir+2]<<16)+this[Ir+3]*16777216},Lt.prototype.readUint32BE=Lt.prototype.readUInt32BE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,4,this.length),this[Ir]*16777216+(this[Ir+1]<<16|this[Ir+2]<<8|this[Ir+3])},Lt.prototype.readIntLE=function(Ir,Mr,Hr){Ir=Ir>>>0,Mr=Mr>>>0,Hr||br(Ir,Mr,this.length);for(var Qr=this[Ir],on=1,nn=0;++nn<Mr&&(on*=256);)Qr+=this[Ir+nn]*on;return on*=128,Qr>=on&&(Qr-=Math.pow(2,8*Mr)),Qr},Lt.prototype.readIntBE=function(Ir,Mr,Hr){Ir=Ir>>>0,Mr=Mr>>>0,Hr||br(Ir,Mr,this.length);for(var Qr=Mr,on=1,nn=this[Ir+--Qr];Qr>0&&(on*=256);)nn+=this[Ir+--Qr]*on;return on*=128,nn>=on&&(nn-=Math.pow(2,8*Mr)),nn},Lt.prototype.readInt8=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,1,this.length),this[Ir]&128?(255-this[Ir]+1)*-1:this[Ir]},Lt.prototype.readInt16LE=function(Ir,Mr){Ir=Ir>>>0,Mr||br(Ir,2,this.length);var Hr=this[Ir]|this[Ir+1]<<8;return Hr&32768?Hr|4294901760:Hr},Lt.prototype.readInt16BE=function(Ir,Mr){Ir=Ir>>>0,Mr||br(Ir,2,this.length);var Hr=this[Ir+1]|this[Ir]<<8;return Hr&32768?Hr|4294901760:Hr},Lt.prototype.readInt32LE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,4,this.length),this[Ir]|this[Ir+1]<<8|this[Ir+2]<<16|this[Ir+3]<<24},Lt.prototype.readInt32BE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,4,this.length),this[Ir]<<24|this[Ir+1]<<16|this[Ir+2]<<8|this[Ir+3]},Lt.prototype.readFloatLE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,4,this.length),xt.read(this,Ir,!0,23,4)},Lt.prototype.readFloatBE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,4,this.length),xt.read(this,Ir,!1,23,4)},Lt.prototype.readDoubleLE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,8,this.length),xt.read(this,Ir,!0,52,8)},Lt.prototype.readDoubleBE=function(Ir,Mr){return Ir=Ir>>>0,Mr||br(Ir,8,this.length),xt.read(this,Ir,!1,52,8)};function _r(jr,Ir,Mr,Hr,Qr,on){if(!Lt.isBuffer(jr))throw new TypeError('"buffer" argument must be a Buffer instance');if(Ir>Qr||Ir<on)throw new RangeError('"value" argument is out of bounds');if(Mr+Hr>jr.length)throw new RangeError("Index out of range")}Lt.prototype.writeUintLE=Lt.prototype.writeUIntLE=function(Ir,Mr,Hr,Qr){if(Ir=+Ir,Mr=Mr>>>0,Hr=Hr>>>0,!Qr){var on=Math.pow(2,8*Hr)-1;_r(this,Ir,Mr,Hr,on,0)}var nn=1,fn=0;for(this[Mr]=Ir&255;++fn<Hr&&(nn*=256);)this[Mr+fn]=Ir/nn&255;return Mr+Hr},Lt.prototype.writeUintBE=Lt.prototype.writeUIntBE=function(Ir,Mr,Hr,Qr){if(Ir=+Ir,Mr=Mr>>>0,Hr=Hr>>>0,!Qr){var on=Math.pow(2,8*Hr)-1;_r(this,Ir,Mr,Hr,on,0)}var nn=Hr-1,fn=1;for(this[Mr+nn]=Ir&255;--nn>=0&&(fn*=256);)this[Mr+nn]=Ir/fn&255;return Mr+Hr},Lt.prototype.writeUint8=Lt.prototype.writeUInt8=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,1,255,0),this[Mr]=Ir&255,Mr+1},Lt.prototype.writeUint16LE=Lt.prototype.writeUInt16LE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,2,65535,0),this[Mr]=Ir&255,this[Mr+1]=Ir>>>8,Mr+2},Lt.prototype.writeUint16BE=Lt.prototype.writeUInt16BE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,2,65535,0),this[Mr]=Ir>>>8,this[Mr+1]=Ir&255,Mr+2},Lt.prototype.writeUint32LE=Lt.prototype.writeUInt32LE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,4,4294967295,0),this[Mr+3]=Ir>>>24,this[Mr+2]=Ir>>>16,this[Mr+1]=Ir>>>8,this[Mr]=Ir&255,Mr+4},Lt.prototype.writeUint32BE=Lt.prototype.writeUInt32BE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,4,4294967295,0),this[Mr]=Ir>>>24,this[Mr+1]=Ir>>>16,this[Mr+2]=Ir>>>8,this[Mr+3]=Ir&255,Mr+4},Lt.prototype.writeIntLE=function(Ir,Mr,Hr,Qr){if(Ir=+Ir,Mr=Mr>>>0,!Qr){var on=Math.pow(2,8*Hr-1);_r(this,Ir,Mr,Hr,on-1,-on)}var nn=0,fn=1,hn=0;for(this[Mr]=Ir&255;++nn<Hr&&(fn*=256);)Ir<0&&hn===0&&this[Mr+nn-1]!==0&&(hn=1),this[Mr+nn]=(Ir/fn>>0)-hn&255;return Mr+Hr},Lt.prototype.writeIntBE=function(Ir,Mr,Hr,Qr){if(Ir=+Ir,Mr=Mr>>>0,!Qr){var on=Math.pow(2,8*Hr-1);_r(this,Ir,Mr,Hr,on-1,-on)}var nn=Hr-1,fn=1,hn=0;for(this[Mr+nn]=Ir&255;--nn>=0&&(fn*=256);)Ir<0&&hn===0&&this[Mr+nn+1]!==0&&(hn=1),this[Mr+nn]=(Ir/fn>>0)-hn&255;return Mr+Hr},Lt.prototype.writeInt8=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,1,127,-128),Ir<0&&(Ir=255+Ir+1),this[Mr]=Ir&255,Mr+1},Lt.prototype.writeInt16LE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,2,32767,-32768),this[Mr]=Ir&255,this[Mr+1]=Ir>>>8,Mr+2},Lt.prototype.writeInt16BE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,2,32767,-32768),this[Mr]=Ir>>>8,this[Mr+1]=Ir&255,Mr+2},Lt.prototype.writeInt32LE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,4,2147483647,-2147483648),this[Mr]=Ir&255,this[Mr+1]=Ir>>>8,this[Mr+2]=Ir>>>16,this[Mr+3]=Ir>>>24,Mr+4},Lt.prototype.writeInt32BE=function(Ir,Mr,Hr){return Ir=+Ir,Mr=Mr>>>0,Hr||_r(this,Ir,Mr,4,2147483647,-2147483648),Ir<0&&(Ir=4294967295+Ir+1),this[Mr]=Ir>>>24,this[Mr+1]=Ir>>>16,this[Mr+2]=Ir>>>8,this[Mr+3]=Ir&255,Mr+4};function Tr(jr,Ir,Mr,Hr,Qr,on){if(Mr+Hr>jr.length)throw new RangeError("Index out of range");if(Mr<0)throw new RangeError("Index out of range")}function Pr(jr,Ir,Mr,Hr,Qr){return Ir=+Ir,Mr=Mr>>>0,Qr||Tr(jr,Ir,Mr,4),xt.write(jr,Ir,Mr,Hr,23,4),Mr+4}Lt.prototype.writeFloatLE=function(Ir,Mr,Hr){return Pr(this,Ir,Mr,!0,Hr)},Lt.prototype.writeFloatBE=function(Ir,Mr,Hr){return Pr(this,Ir,Mr,!1,Hr)};function Nr(jr,Ir,Mr,Hr,Qr){return Ir=+Ir,Mr=Mr>>>0,Qr||Tr(jr,Ir,Mr,8),xt.write(jr,Ir,Mr,Hr,52,8),Mr+8}Lt.prototype.writeDoubleLE=function(Ir,Mr,Hr){return Nr(this,Ir,Mr,!0,Hr)},Lt.prototype.writeDoubleBE=function(Ir,Mr,Hr){return Nr(this,Ir,Mr,!1,Hr)},Lt.prototype.copy=function(Ir,Mr,Hr,Qr){if(!Lt.isBuffer(Ir))throw new TypeError("argument should be a Buffer");if(Hr||(Hr=0),!Qr&&Qr!==0&&(Qr=this.length),Mr>=Ir.length&&(Mr=Ir.length),Mr||(Mr=0),Qr>0&&Qr<Hr&&(Qr=Hr),Qr===Hr||Ir.length===0||this.length===0)return 0;if(Mr<0)throw new RangeError("targetStart out of bounds");if(Hr<0||Hr>=this.length)throw new RangeError("Index out of range");if(Qr<0)throw new RangeError("sourceEnd out of bounds");Qr>this.length&&(Qr=this.length),Ir.length-Mr<Qr-Hr&&(Qr=Ir.length-Mr+Hr);var on=Qr-Hr;return this===Ir&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Mr,Hr,Qr):Uint8Array.prototype.set.call(Ir,this.subarray(Hr,Qr),Mr),on},Lt.prototype.fill=function(Ir,Mr,Hr,Qr){if(typeof Ir=="string"){if(typeof Mr=="string"?(Qr=Mr,Mr=0,Hr=this.length):typeof Hr=="string"&&(Qr=Hr,Hr=this.length),Qr!==void 0&&typeof Qr!="string")throw new TypeError("encoding must be a string");if(typeof Qr=="string"&&!Lt.isEncoding(Qr))throw new TypeError("Unknown encoding: "+Qr);if(Ir.length===1){var on=Ir.charCodeAt(0);(Qr==="utf8"&&on<128||Qr==="latin1")&&(Ir=on)}}else typeof Ir=="number"?Ir=Ir&255:typeof Ir=="boolean"&&(Ir=Number(Ir));if(Mr<0||this.length<Mr||this.length<Hr)throw new RangeError("Out of range index");if(Hr<=Mr)return this;Mr=Mr>>>0,Hr=Hr===void 0?this.length:Hr>>>0,Ir||(Ir=0);var nn;if(typeof Ir=="number")for(nn=Mr;nn<Hr;++nn)this[nn]=Ir;else{var fn=Lt.isBuffer(Ir)?Ir:Lt.from(Ir,Qr),hn=fn.length;if(hn===0)throw new TypeError('The value "'+Ir+'" is invalid for argument "value"');for(nn=0;nn<Hr-Mr;++nn)this[nn+Mr]=fn[nn%hn]}return this};var Cr=/[^+/0-9A-Za-z-_]/g;function xr(jr){if(jr=jr.split("=")[0],jr=jr.trim().replace(Cr,""),jr.length<2)return"";for(;jr.length%4!==0;)jr=jr+"=";return jr}function Rr(jr,Ir){Ir=Ir||1/0;for(var Mr,Hr=jr.length,Qr=null,on=[],nn=0;nn<Hr;++nn){if(Mr=jr.charCodeAt(nn),Mr>55295&&Mr<57344){if(!Qr){if(Mr>56319){(Ir-=3)>-1&&on.push(239,191,189);continue}else if(nn+1===Hr){(Ir-=3)>-1&&on.push(239,191,189);continue}Qr=Mr;continue}if(Mr<56320){(Ir-=3)>-1&&on.push(239,191,189),Qr=Mr;continue}Mr=(Qr-55296<<10|Mr-56320)+65536}else Qr&&(Ir-=3)>-1&&on.push(239,191,189);if(Qr=null,Mr<128){if((Ir-=1)<0)break;on.push(Mr)}else if(Mr<2048){if((Ir-=2)<0)break;on.push(Mr>>6|192,Mr&63|128)}else if(Mr<65536){if((Ir-=3)<0)break;on.push(Mr>>12|224,Mr>>6&63|128,Mr&63|128)}else if(Mr<1114112){if((Ir-=4)<0)break;on.push(Mr>>18|240,Mr>>12&63|128,Mr>>6&63|128,Mr&63|128)}else throw new Error("Invalid code point")}return on}function qr(jr){for(var Ir=[],Mr=0;Mr<jr.length;++Mr)Ir.push(jr.charCodeAt(Mr)&255);return Ir}function Vr(jr,Ir){for(var Mr,Hr,Qr,on=[],nn=0;nn<jr.length&&!((Ir-=2)<0);++nn)Mr=jr.charCodeAt(nn),Hr=Mr>>8,Qr=Mr%256,on.push(Qr),on.push(Hr);return on}function Gr(jr){return At.toByteArray(xr(jr))}function Ur(jr,Ir,Mr,Hr){for(var Qr=0;Qr<Hr&&!(Qr+Mr>=Ir.length||Qr>=jr.length);++Qr)Ir[Qr+Mr]=jr[Qr];return Qr}function kr(jr,Ir){return jr instanceof Ir||jr!=null&&jr.constructor!=null&&jr.constructor.name!=null&&jr.constructor.name===Ir.name}function Fr(jr){return jr!==jr}var Wr=function(){for(var jr="0123456789abcdef",Ir=new Array(256),Mr=0;Mr<16;++Mr)for(var Hr=Mr*16,Qr=0;Qr<16;++Qr)Ir[Hr+Qr]=jr[Mr]+jr[Qr];return Ir}()})(buffer$2);var browser$f={exports:{}},process$8=browser$f.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cachedSetTimeout=setTimeout:cachedSetTimeout=defaultSetTimout}catch{cachedSetTimeout=defaultSetTimout}try{typeof clearTimeout=="function"?cachedClearTimeout=clearTimeout:cachedClearTimeout=defaultClearTimeout}catch{cachedClearTimeout=defaultClearTimeout}})();function runTimeout(kt){if(cachedSetTimeout===setTimeout)return setTimeout(kt,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(kt,0);try{return cachedSetTimeout(kt,0)}catch{try{return cachedSetTimeout.call(null,kt,0)}catch{return cachedSetTimeout.call(this,kt,0)}}}function runClearTimeout(kt){if(cachedClearTimeout===clearTimeout)return clearTimeout(kt);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(kt);try{return cachedClearTimeout(kt)}catch{try{return cachedClearTimeout.call(null,kt)}catch{return cachedClearTimeout.call(this,kt)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var kt=runTimeout(cleanUpNextTick);draining=!0;for(var At=queue.length;At;){for(currentQueue=queue,queue=[];++queueIndex<At;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,At=queue.length}currentQueue=null,draining=!1,runClearTimeout(kt)}}process$8.nextTick=function(kt){var At=new Array(arguments.length-1);if(arguments.length>1)for(var xt=1;xt<arguments.length;xt++)At[xt-1]=arguments[xt];queue.push(new Item(kt,At)),queue.length===1&&!draining&&runTimeout(drainQueue)};function Item(kt,At){this.fun=kt,this.array=At}Item.prototype.run=function(){this.fun.apply(null,this.array)};process$8.title="browser";process$8.browser=!0;process$8.env={};process$8.argv=[];process$8.version="";process$8.versions={};function noop$5(){}process$8.on=noop$5;process$8.addListener=noop$5;process$8.once=noop$5;process$8.off=noop$5;process$8.removeListener=noop$5;process$8.removeAllListeners=noop$5;process$8.emit=noop$5;process$8.prependListener=noop$5;process$8.prependOnceListener=noop$5;process$8.listeners=function(kt){return[]};process$8.binding=function(kt){throw new Error("process.binding is not supported")};process$8.cwd=function(){return"/"};process$8.chdir=function(kt){throw new Error("process.chdir is not supported")};process$8.umask=function(){return 0};var browserExports$3=browser$f.exports;const process$9=getDefaultExportFromCjs(browserExports$3);(function(kt){function At(){var Bt=this||self;return delete kt.prototype.__magic__,Bt}if(typeof globalThis=="object")return globalThis;if(this)return At();kt.defineProperty(kt.prototype,"__magic__",{configurable:!0,get:At});var xt=__magic__;return xt})(Object);const perf$1=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,warned=new Set,PROCESS=typeof process$9=="object"&&process$9?process$9:{},emitWarning=(kt,At,xt,Bt)=>{typeof PROCESS.emitWarning=="function"?PROCESS.emitWarning(kt,At,xt,Bt):console.error(`[${xt}] ${At}: ${kt}`)};let AC=globalThis.AbortController,AS=globalThis.AbortSignal;var ns;if(typeof AC>"u"){AS=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(Bt,Nt){this._onabort.push(Nt)}},AC=class{constructor(){At()}signal=new AS;abort(Bt){var Nt,jt;if(!this.signal.aborted){this.signal.reason=Bt,this.signal.aborted=!0;for(const Ut of this.signal._onabort)Ut(Bt);(jt=(Nt=this.signal).onabort)==null||jt.call(Nt,Bt)}}};let kt=((ns=PROCESS.env)==null?void 0:ns.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const At=()=>{kt&&(kt=!1,emitWarning("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",At))}}const shouldWarn=kt=>!warned.has(kt),isPosInt$1=kt=>kt&&kt===Math.floor(kt)&&kt>0&&isFinite(kt),getUintArray=kt=>isPosInt$1(kt)?kt<=Math.pow(2,8)?Uint8Array:kt<=Math.pow(2,16)?Uint16Array:kt<=Math.pow(2,32)?Uint32Array:kt<=Number.MAX_SAFE_INTEGER?ZeroArray:null:null;class ZeroArray extends Array{constructor(At){super(At),this.fill(0)}}var go;const ao=class ao{heap;length;static create(At){const xt=getUintArray(At);if(!xt)return[];Pn(ao,go,!0);const Bt=new ao(At,xt);return Pn(ao,go,!1),Bt}constructor(At,xt){if(!rn(ao,go))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new xt(At),this.length=0}push(At){this.heap[this.length++]=At}pop(){return this.heap[--this.length]}};go=new WeakMap,Fn(ao,go,!1);let Stack=ao;var Di,Ai,Ui,ki,vo,si,Ci,ai,ri,jn,wi,xi,gi,ui,Ri,hi,Gi,zi,Oi,Li,Xi,Ei,Sn,zo,lo,qi,Io,Ii,as,co,bo,Do,Vi,Wi,qo,No,jo,ni,Ho,_o;const Qo=class Qo{constructor(At){Fn(this,Sn);Fn(this,Di);Fn(this,Ai);Fn(this,Ui);Fn(this,ki);Fn(this,vo);ti(this,"ttl");ti(this,"ttlResolution");ti(this,"ttlAutopurge");ti(this,"updateAgeOnGet");ti(this,"updateAgeOnHas");ti(this,"allowStale");ti(this,"noDisposeOnSet");ti(this,"noUpdateTTL");ti(this,"maxEntrySize");ti(this,"sizeCalculation");ti(this,"noDeleteOnFetchRejection");ti(this,"noDeleteOnStaleGet");ti(this,"allowStaleOnFetchAbort");ti(this,"allowStaleOnFetchRejection");ti(this,"ignoreFetchAbort");Fn(this,si);Fn(this,Ci);Fn(this,ai);Fn(this,ri);Fn(this,jn);Fn(this,wi);Fn(this,xi);Fn(this,gi);Fn(this,ui);Fn(this,Ri);Fn(this,hi);Fn(this,Gi);Fn(this,zi);Fn(this,Oi);Fn(this,Li);Fn(this,Xi);Fn(this,Ei);Fn(this,lo,()=>{});Fn(this,qi,()=>{});Fn(this,Io,()=>{});Fn(this,Ii,()=>!1);Fn(this,co,At=>{});Fn(this,bo,(At,xt,Bt)=>{});Fn(this,Do,(At,xt,Bt,Nt)=>{if(Bt||Nt)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});const{max:xt=0,ttl:Bt,ttlResolution:Nt=1,ttlAutopurge:jt,updateAgeOnGet:Ut,updateAgeOnHas:Lt,allowStale:Ht,dispose:Vt,disposeAfter:zt,noDisposeOnSet:Wt,noUpdateTTL:Jt,maxSize:Qt=0,maxEntrySize:Xt=0,sizeCalculation:tr,fetchMethod:rr,noDeleteOnFetchRejection:nr,noDeleteOnStaleGet:ar,allowStaleOnFetchRejection:ir,allowStaleOnFetchAbort:lr,ignoreFetchAbort:yr}=At;if(xt!==0&&!isPosInt$1(xt))throw new TypeError("max option must be a nonnegative integer");const Sr=xt?getUintArray(xt):Array;if(!Sr)throw new Error("invalid max value: "+xt);if(Pn(this,Di,xt),Pn(this,Ai,Qt),this.maxEntrySize=Xt||rn(this,Ai),this.sizeCalculation=tr,this.sizeCalculation){if(!rn(this,Ai)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(rr!==void 0&&typeof rr!="function")throw new TypeError("fetchMethod must be a function if specified");if(Pn(this,vo,rr),Pn(this,Xi,!!rr),Pn(this,ai,new Map),Pn(this,ri,new Array(xt).fill(void 0)),Pn(this,jn,new Array(xt).fill(void 0)),Pn(this,wi,new Sr(xt)),Pn(this,xi,new Sr(xt)),Pn(this,gi,0),Pn(this,ui,0),Pn(this,Ri,Stack.create(xt)),Pn(this,si,0),Pn(this,Ci,0),typeof Vt=="function"&&Pn(this,Ui,Vt),typeof zt=="function"?(Pn(this,ki,zt),Pn(this,hi,[])):(Pn(this,ki,void 0),Pn(this,hi,void 0)),Pn(this,Li,!!rn(this,Ui)),Pn(this,Ei,!!rn(this,ki)),this.noDisposeOnSet=!!Wt,this.noUpdateTTL=!!Jt,this.noDeleteOnFetchRejection=!!nr,this.allowStaleOnFetchRejection=!!ir,this.allowStaleOnFetchAbort=!!lr,this.ignoreFetchAbort=!!yr,this.maxEntrySize!==0){if(rn(this,Ai)!==0&&!isPosInt$1(rn(this,Ai)))throw new TypeError("maxSize must be a positive integer if specified");if(!isPosInt$1(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");An(this,Sn,as).call(this)}if(this.allowStale=!!Ht,this.noDeleteOnStaleGet=!!ar,this.updateAgeOnGet=!!Ut,this.updateAgeOnHas=!!Lt,this.ttlResolution=isPosInt$1(Nt)||Nt===0?Nt:1,this.ttlAutopurge=!!jt,this.ttl=Bt||0,this.ttl){if(!isPosInt$1(this.ttl))throw new TypeError("ttl must be a positive integer if specified");An(this,Sn,zo).call(this)}if(rn(this,Di)===0&&this.ttl===0&&rn(this,Ai)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!rn(this,Di)&&!rn(this,Ai)){const Ar="LRU_CACHE_UNBOUNDED";shouldWarn(Ar)&&(warned.add(Ar),emitWarning("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",Ar,Qo))}}static unsafeExposeInternals(At){return{starts:rn(At,zi),ttls:rn(At,Oi),sizes:rn(At,Gi),keyMap:rn(At,ai),keyList:rn(At,ri),valList:rn(At,jn),next:rn(At,wi),prev:rn(At,xi),get head(){return rn(At,gi)},get tail(){return rn(At,ui)},free:rn(At,Ri),isBackgroundFetch:xt=>{var Bt;return An(Bt=At,Sn,ni).call(Bt,xt)},backgroundFetch:(xt,Bt,Nt,jt)=>{var Ut;return An(Ut=At,Sn,jo).call(Ut,xt,Bt,Nt,jt)},moveToTail:xt=>{var Bt;return An(Bt=At,Sn,_o).call(Bt,xt)},indexes:xt=>{var Bt;return An(Bt=At,Sn,Vi).call(Bt,xt)},rindexes:xt=>{var Bt;return An(Bt=At,Sn,Wi).call(Bt,xt)},isStale:xt=>{var Bt;return rn(Bt=At,Ii).call(Bt,xt)}}}get max(){return rn(this,Di)}get maxSize(){return rn(this,Ai)}get calculatedSize(){return rn(this,Ci)}get size(){return rn(this,si)}get fetchMethod(){return rn(this,vo)}get dispose(){return rn(this,Ui)}get disposeAfter(){return rn(this,ki)}getRemainingTTL(At){return rn(this,ai).has(At)?1/0:0}*entries(){for(const At of An(this,Sn,Vi).call(this))rn(this,jn)[At]!==void 0&&rn(this,ri)[At]!==void 0&&!An(this,Sn,ni).call(this,rn(this,jn)[At])&&(yield[rn(this,ri)[At],rn(this,jn)[At]])}*rentries(){for(const At of An(this,Sn,Wi).call(this))rn(this,jn)[At]!==void 0&&rn(this,ri)[At]!==void 0&&!An(this,Sn,ni).call(this,rn(this,jn)[At])&&(yield[rn(this,ri)[At],rn(this,jn)[At]])}*keys(){for(const At of An(this,Sn,Vi).call(this)){const xt=rn(this,ri)[At];xt!==void 0&&!An(this,Sn,ni).call(this,rn(this,jn)[At])&&(yield xt)}}*rkeys(){for(const At of An(this,Sn,Wi).call(this)){const xt=rn(this,ri)[At];xt!==void 0&&!An(this,Sn,ni).call(this,rn(this,jn)[At])&&(yield xt)}}*values(){for(const At of An(this,Sn,Vi).call(this))rn(this,jn)[At]!==void 0&&!An(this,Sn,ni).call(this,rn(this,jn)[At])&&(yield rn(this,jn)[At])}*rvalues(){for(const At of An(this,Sn,Wi).call(this))rn(this,jn)[At]!==void 0&&!An(this,Sn,ni).call(this,rn(this,jn)[At])&&(yield rn(this,jn)[At])}[Symbol.iterator](){return this.entries()}find(At,xt={}){for(const Bt of An(this,Sn,Vi).call(this)){const Nt=rn(this,jn)[Bt],jt=An(this,Sn,ni).call(this,Nt)?Nt.__staleWhileFetching:Nt;if(jt!==void 0&&At(jt,rn(this,ri)[Bt],this))return this.get(rn(this,ri)[Bt],xt)}}forEach(At,xt=this){for(const Bt of An(this,Sn,Vi).call(this)){const Nt=rn(this,jn)[Bt],jt=An(this,Sn,ni).call(this,Nt)?Nt.__staleWhileFetching:Nt;jt!==void 0&&At.call(xt,jt,rn(this,ri)[Bt],this)}}rforEach(At,xt=this){for(const Bt of An(this,Sn,Wi).call(this)){const Nt=rn(this,jn)[Bt],jt=An(this,Sn,ni).call(this,Nt)?Nt.__staleWhileFetching:Nt;jt!==void 0&&At.call(xt,jt,rn(this,ri)[Bt],this)}}purgeStale(){let At=!1;for(const xt of An(this,Sn,Wi).call(this,{allowStale:!0}))rn(this,Ii).call(this,xt)&&(this.delete(rn(this,ri)[xt]),At=!0);return At}dump(){const At=[];for(const xt of An(this,Sn,Vi).call(this,{allowStale:!0})){const Bt=rn(this,ri)[xt],Nt=rn(this,jn)[xt],jt=An(this,Sn,ni).call(this,Nt)?Nt.__staleWhileFetching:Nt;if(jt===void 0||Bt===void 0)continue;const Ut={value:jt};if(rn(this,Oi)&&rn(this,zi)){Ut.ttl=rn(this,Oi)[xt];const Lt=perf$1.now()-rn(this,zi)[xt];Ut.start=Math.floor(Date.now()-Lt)}rn(this,Gi)&&(Ut.size=rn(this,Gi)[xt]),At.unshift([Bt,Ut])}return At}load(At){this.clear();for(const[xt,Bt]of At){if(Bt.start){const Nt=Date.now()-Bt.start;Bt.start=perf$1.now()-Nt}this.set(xt,Bt.value,Bt)}}set(At,xt,Bt={}){var Jt,Qt,Xt;if(xt===void 0)return this.delete(At),this;const{ttl:Nt=this.ttl,start:jt,noDisposeOnSet:Ut=this.noDisposeOnSet,sizeCalculation:Lt=this.sizeCalculation,status:Ht}=Bt;let{noUpdateTTL:Vt=this.noUpdateTTL}=Bt;const zt=rn(this,Do).call(this,At,xt,Bt.size||0,Lt);if(this.maxEntrySize&&zt>this.maxEntrySize)return Ht&&(Ht.set="miss",Ht.maxEntrySizeExceeded=!0),this.delete(At),this;let Wt=rn(this,si)===0?void 0:rn(this,ai).get(At);if(Wt===void 0)Wt=rn(this,si)===0?rn(this,ui):rn(this,Ri).length!==0?rn(this,Ri).pop():rn(this,si)===rn(this,Di)?An(this,Sn,No).call(this,!1):rn(this,si),rn(this,ri)[Wt]=At,rn(this,jn)[Wt]=xt,rn(this,ai).set(At,Wt),rn(this,wi)[rn(this,ui)]=Wt,rn(this,xi)[Wt]=rn(this,ui),Pn(this,ui,Wt),Mo(this,si)._++,rn(this,bo).call(this,Wt,zt,Ht),Ht&&(Ht.set="add"),Vt=!1;else{An(this,Sn,_o).call(this,Wt);const tr=rn(this,jn)[Wt];if(xt!==tr){if(rn(this,Xi)&&An(this,Sn,ni).call(this,tr)?tr.__abortController.abort(new Error("replaced")):Ut||(rn(this,Li)&&((Jt=rn(this,Ui))==null||Jt.call(this,tr,At,"set")),rn(this,Ei)&&((Qt=rn(this,hi))==null||Qt.push([tr,At,"set"]))),rn(this,co).call(this,Wt),rn(this,bo).call(this,Wt,zt,Ht),rn(this,jn)[Wt]=xt,Ht){Ht.set="replace";const rr=tr&&An(this,Sn,ni).call(this,tr)?tr.__staleWhileFetching:tr;rr!==void 0&&(Ht.oldValue=rr)}}else Ht&&(Ht.set="update")}if(Nt!==0&&!rn(this,Oi)&&An(this,Sn,zo).call(this),rn(this,Oi)&&(Vt||rn(this,Io).call(this,Wt,Nt,jt),Ht&&rn(this,qi).call(this,Ht,Wt)),!Ut&&rn(this,Ei)&&rn(this,hi)){const tr=rn(this,hi);let rr;for(;rr=tr==null?void 0:tr.shift();)(Xt=rn(this,ki))==null||Xt.call(this,...rr)}return this}pop(){var At;try{for(;rn(this,si);){const xt=rn(this,jn)[rn(this,gi)];if(An(this,Sn,No).call(this,!0),An(this,Sn,ni).call(this,xt)){if(xt.__staleWhileFetching)return xt.__staleWhileFetching}else if(xt!==void 0)return xt}}finally{if(rn(this,Ei)&&rn(this,hi)){const xt=rn(this,hi);let Bt;for(;Bt=xt==null?void 0:xt.shift();)(At=rn(this,ki))==null||At.call(this,...Bt)}}}has(At,xt={}){const{updateAgeOnHas:Bt=this.updateAgeOnHas,status:Nt}=xt,jt=rn(this,ai).get(At);if(jt!==void 0){const Ut=rn(this,jn)[jt];if(An(this,Sn,ni).call(this,Ut)&&Ut.__staleWhileFetching===void 0)return!1;if(rn(this,Ii).call(this,jt))Nt&&(Nt.has="stale",rn(this,qi).call(this,Nt,jt));else return Bt&&rn(this,lo).call(this,jt),Nt&&(Nt.has="hit",rn(this,qi).call(this,Nt,jt)),!0}else Nt&&(Nt.has="miss");return!1}peek(At,xt={}){const{allowStale:Bt=this.allowStale}=xt,Nt=rn(this,ai).get(At);if(Nt!==void 0&&(Bt||!rn(this,Ii).call(this,Nt))){const jt=rn(this,jn)[Nt];return An(this,Sn,ni).call(this,jt)?jt.__staleWhileFetching:jt}}async fetch(At,xt={}){const{allowStale:Bt=this.allowStale,updateAgeOnGet:Nt=this.updateAgeOnGet,noDeleteOnStaleGet:jt=this.noDeleteOnStaleGet,ttl:Ut=this.ttl,noDisposeOnSet:Lt=this.noDisposeOnSet,size:Ht=0,sizeCalculation:Vt=this.sizeCalculation,noUpdateTTL:zt=this.noUpdateTTL,noDeleteOnFetchRejection:Wt=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:Jt=this.allowStaleOnFetchRejection,ignoreFetchAbort:Qt=this.ignoreFetchAbort,allowStaleOnFetchAbort:Xt=this.allowStaleOnFetchAbort,context:tr,forceRefresh:rr=!1,status:nr,signal:ar}=xt;if(!rn(this,Xi))return nr&&(nr.fetch="get"),this.get(At,{allowStale:Bt,updateAgeOnGet:Nt,noDeleteOnStaleGet:jt,status:nr});const ir={allowStale:Bt,updateAgeOnGet:Nt,noDeleteOnStaleGet:jt,ttl:Ut,noDisposeOnSet:Lt,size:Ht,sizeCalculation:Vt,noUpdateTTL:zt,noDeleteOnFetchRejection:Wt,allowStaleOnFetchRejection:Jt,allowStaleOnFetchAbort:Xt,ignoreFetchAbort:Qt,status:nr,signal:ar};let lr=rn(this,ai).get(At);if(lr===void 0){nr&&(nr.fetch="miss");const yr=An(this,Sn,jo).call(this,At,lr,ir,tr);return yr.__returned=yr}else{const yr=rn(this,jn)[lr];if(An(this,Sn,ni).call(this,yr)){const Lr=Bt&&yr.__staleWhileFetching!==void 0;return nr&&(nr.fetch="inflight",Lr&&(nr.returnedStale=!0)),Lr?yr.__staleWhileFetching:yr.__returned=yr}const Sr=rn(this,Ii).call(this,lr);if(!rr&&!Sr)return nr&&(nr.fetch="hit"),An(this,Sn,_o).call(this,lr),Nt&&rn(this,lo).call(this,lr),nr&&rn(this,qi).call(this,nr,lr),yr;const Ar=An(this,Sn,jo).call(this,At,lr,ir,tr),Br=Ar.__staleWhileFetching!==void 0&&Bt;return nr&&(nr.fetch=Sr?"stale":"refresh",Br&&Sr&&(nr.returnedStale=!0)),Br?Ar.__staleWhileFetching:Ar.__returned=Ar}}get(At,xt={}){const{allowStale:Bt=this.allowStale,updateAgeOnGet:Nt=this.updateAgeOnGet,noDeleteOnStaleGet:jt=this.noDeleteOnStaleGet,status:Ut}=xt,Lt=rn(this,ai).get(At);if(Lt!==void 0){const Ht=rn(this,jn)[Lt],Vt=An(this,Sn,ni).call(this,Ht);return Ut&&rn(this,qi).call(this,Ut,Lt),rn(this,Ii).call(this,Lt)?(Ut&&(Ut.get="stale"),Vt?(Ut&&Bt&&Ht.__staleWhileFetching!==void 0&&(Ut.returnedStale=!0),Bt?Ht.__staleWhileFetching:void 0):(jt||this.delete(At),Ut&&Bt&&(Ut.returnedStale=!0),Bt?Ht:void 0)):(Ut&&(Ut.get="hit"),Vt?Ht.__staleWhileFetching:(An(this,Sn,_o).call(this,Lt),Nt&&rn(this,lo).call(this,Lt),Ht))}else Ut&&(Ut.get="miss")}delete(At){var Bt,Nt,jt,Ut;let xt=!1;if(rn(this,si)!==0){const Lt=rn(this,ai).get(At);if(Lt!==void 0)if(xt=!0,rn(this,si)===1)this.clear();else{rn(this,co).call(this,Lt);const Ht=rn(this,jn)[Lt];An(this,Sn,ni).call(this,Ht)?Ht.__abortController.abort(new Error("deleted")):(rn(this,Li)||rn(this,Ei))&&(rn(this,Li)&&((Bt=rn(this,Ui))==null||Bt.call(this,Ht,At,"delete")),rn(this,Ei)&&((Nt=rn(this,hi))==null||Nt.push([Ht,At,"delete"]))),rn(this,ai).delete(At),rn(this,ri)[Lt]=void 0,rn(this,jn)[Lt]=void 0,Lt===rn(this,ui)?Pn(this,ui,rn(this,xi)[Lt]):Lt===rn(this,gi)?Pn(this,gi,rn(this,wi)[Lt]):(rn(this,wi)[rn(this,xi)[Lt]]=rn(this,wi)[Lt],rn(this,xi)[rn(this,wi)[Lt]]=rn(this,xi)[Lt]),Mo(this,si)._--,rn(this,Ri).push(Lt)}}if(rn(this,Ei)&&((jt=rn(this,hi))!=null&&jt.length)){const Lt=rn(this,hi);let Ht;for(;Ht=Lt==null?void 0:Lt.shift();)(Ut=rn(this,ki))==null||Ut.call(this,...Ht)}return xt}clear(){var At,xt,Bt;for(const Nt of An(this,Sn,Wi).call(this,{allowStale:!0})){const jt=rn(this,jn)[Nt];if(An(this,Sn,ni).call(this,jt))jt.__abortController.abort(new Error("deleted"));else{const Ut=rn(this,ri)[Nt];rn(this,Li)&&((At=rn(this,Ui))==null||At.call(this,jt,Ut,"delete")),rn(this,Ei)&&((xt=rn(this,hi))==null||xt.push([jt,Ut,"delete"]))}}if(rn(this,ai).clear(),rn(this,jn).fill(void 0),rn(this,ri).fill(void 0),rn(this,Oi)&&rn(this,zi)&&(rn(this,Oi).fill(0),rn(this,zi).fill(0)),rn(this,Gi)&&rn(this,Gi).fill(0),Pn(this,gi,0),Pn(this,ui,0),rn(this,Ri).length=0,Pn(this,Ci,0),Pn(this,si,0),rn(this,Ei)&&rn(this,hi)){const Nt=rn(this,hi);let jt;for(;jt=Nt==null?void 0:Nt.shift();)(Bt=rn(this,ki))==null||Bt.call(this,...jt)}}};Di=new WeakMap,Ai=new WeakMap,Ui=new WeakMap,ki=new WeakMap,vo=new WeakMap,si=new WeakMap,Ci=new WeakMap,ai=new WeakMap,ri=new WeakMap,jn=new WeakMap,wi=new WeakMap,xi=new WeakMap,gi=new WeakMap,ui=new WeakMap,Ri=new WeakMap,hi=new WeakMap,Gi=new WeakMap,zi=new WeakMap,Oi=new WeakMap,Li=new WeakMap,Xi=new WeakMap,Ei=new WeakMap,Sn=new WeakSet,zo=function(){const At=new ZeroArray(rn(this,Di)),xt=new ZeroArray(rn(this,Di));Pn(this,Oi,At),Pn(this,zi,xt),Pn(this,Io,(jt,Ut,Lt=perf$1.now())=>{if(xt[jt]=Ut!==0?Lt:0,At[jt]=Ut,Ut!==0&&this.ttlAutopurge){const Ht=setTimeout(()=>{rn(this,Ii).call(this,jt)&&this.delete(rn(this,ri)[jt])},Ut+1);Ht.unref&&Ht.unref()}}),Pn(this,lo,jt=>{xt[jt]=At[jt]!==0?perf$1.now():0}),Pn(this,qi,(jt,Ut)=>{if(At[Ut]){const Lt=At[Ut],Ht=xt[Ut];jt.ttl=Lt,jt.start=Ht,jt.now=Bt||Nt();const Vt=jt.now-Ht;jt.remainingTTL=Lt-Vt}});let Bt=0;const Nt=()=>{const jt=perf$1.now();if(this.ttlResolution>0){Bt=jt;const Ut=setTimeout(()=>Bt=0,this.ttlResolution);Ut.unref&&Ut.unref()}return jt};this.getRemainingTTL=jt=>{const Ut=rn(this,ai).get(jt);if(Ut===void 0)return 0;const Lt=At[Ut],Ht=xt[Ut];if(Lt===0||Ht===0)return 1/0;const Vt=(Bt||Nt())-Ht;return Lt-Vt},Pn(this,Ii,jt=>At[jt]!==0&&xt[jt]!==0&&(Bt||Nt())-xt[jt]>At[jt])},lo=new WeakMap,qi=new WeakMap,Io=new WeakMap,Ii=new WeakMap,as=function(){const At=new ZeroArray(rn(this,Di));Pn(this,Ci,0),Pn(this,Gi,At),Pn(this,co,xt=>{Pn(this,Ci,rn(this,Ci)-At[xt]),At[xt]=0}),Pn(this,Do,(xt,Bt,Nt,jt)=>{if(An(this,Sn,ni).call(this,Bt))return 0;if(!isPosInt$1(Nt))if(jt){if(typeof jt!="function")throw new TypeError("sizeCalculation must be a function");if(Nt=jt(Bt,xt),!isPosInt$1(Nt))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return Nt}),Pn(this,bo,(xt,Bt,Nt)=>{if(At[xt]=Bt,rn(this,Ai)){const jt=rn(this,Ai)-At[xt];for(;rn(this,Ci)>jt;)An(this,Sn,No).call(this,!0)}Pn(this,Ci,rn(this,Ci)+At[xt]),Nt&&(Nt.entrySize=Bt,Nt.totalCalculatedSize=rn(this,Ci))})},co=new WeakMap,bo=new WeakMap,Do=new WeakMap,Vi=function*({allowStale:At=this.allowStale}={}){if(rn(this,si))for(let xt=rn(this,ui);!(!An(this,Sn,qo).call(this,xt)||((At||!rn(this,Ii).call(this,xt))&&(yield xt),xt===rn(this,gi)));)xt=rn(this,xi)[xt]},Wi=function*({allowStale:At=this.allowStale}={}){if(rn(this,si))for(let xt=rn(this,gi);!(!An(this,Sn,qo).call(this,xt)||((At||!rn(this,Ii).call(this,xt))&&(yield xt),xt===rn(this,ui)));)xt=rn(this,wi)[xt]},qo=function(At){return At!==void 0&&rn(this,ai).get(rn(this,ri)[At])===At},No=function(At){var jt,Ut;const xt=rn(this,gi),Bt=rn(this,ri)[xt],Nt=rn(this,jn)[xt];return rn(this,Xi)&&An(this,Sn,ni).call(this,Nt)?Nt.__abortController.abort(new Error("evicted")):(rn(this,Li)||rn(this,Ei))&&(rn(this,Li)&&((jt=rn(this,Ui))==null||jt.call(this,Nt,Bt,"evict")),rn(this,Ei)&&((Ut=rn(this,hi))==null||Ut.push([Nt,Bt,"evict"]))),rn(this,co).call(this,xt),At&&(rn(this,ri)[xt]=void 0,rn(this,jn)[xt]=void 0,rn(this,Ri).push(xt)),rn(this,si)===1?(Pn(this,gi,Pn(this,ui,0)),rn(this,Ri).length=0):Pn(this,gi,rn(this,wi)[xt]),rn(this,ai).delete(Bt),Mo(this,si)._--,xt},jo=function(At,xt,Bt,Nt){const jt=xt===void 0?void 0:rn(this,jn)[xt];if(An(this,Sn,ni).call(this,jt))return jt;const Ut=new AC,{signal:Lt}=Bt;Lt==null||Lt.addEventListener("abort",()=>Ut.abort(Lt.reason),{signal:Ut.signal});const Ht={signal:Ut.signal,options:Bt,context:Nt},Vt=(tr,rr=!1)=>{const{aborted:nr}=Ut.signal,ar=Bt.ignoreFetchAbort&&tr!==void 0;if(Bt.status&&(nr&&!rr?(Bt.status.fetchAborted=!0,Bt.status.fetchError=Ut.signal.reason,ar&&(Bt.status.fetchAbortIgnored=!0)):Bt.status.fetchResolved=!0),nr&&!ar&&!rr)return Wt(Ut.signal.reason);const ir=Qt;return rn(this,jn)[xt]===Qt&&(tr===void 0?ir.__staleWhileFetching?rn(this,jn)[xt]=ir.__staleWhileFetching:this.delete(At):(Bt.status&&(Bt.status.fetchUpdated=!0),this.set(At,tr,Ht.options))),tr},zt=tr=>(Bt.status&&(Bt.status.fetchRejected=!0,Bt.status.fetchError=tr),Wt(tr)),Wt=tr=>{const{aborted:rr}=Ut.signal,nr=rr&&Bt.allowStaleOnFetchAbort,ar=nr||Bt.allowStaleOnFetchRejection,ir=ar||Bt.noDeleteOnFetchRejection,lr=Qt;if(rn(this,jn)[xt]===Qt&&(!ir||lr.__staleWhileFetching===void 0?this.delete(At):nr||(rn(this,jn)[xt]=lr.__staleWhileFetching)),ar)return Bt.status&&lr.__staleWhileFetching!==void 0&&(Bt.status.returnedStale=!0),lr.__staleWhileFetching;if(lr.__returned===lr)throw tr},Jt=(tr,rr)=>{var ar;const nr=(ar=rn(this,vo))==null?void 0:ar.call(this,At,jt,Ht);nr&&nr instanceof Promise&&nr.then(ir=>tr(ir),rr),Ut.signal.addEventListener("abort",()=>{(!Bt.ignoreFetchAbort||Bt.allowStaleOnFetchAbort)&&(tr(),Bt.allowStaleOnFetchAbort&&(tr=ir=>Vt(ir,!0)))})};Bt.status&&(Bt.status.fetchDispatched=!0);const Qt=new Promise(Jt).then(Vt,zt),Xt=Object.assign(Qt,{__abortController:Ut,__staleWhileFetching:jt,__returned:void 0});return xt===void 0?(this.set(At,Xt,{...Ht.options,status:void 0}),xt=rn(this,ai).get(At)):rn(this,jn)[xt]=Xt,Xt},ni=function(At){if(!rn(this,Xi))return!1;const xt=At;return!!xt&&xt instanceof Promise&&xt.hasOwnProperty("__staleWhileFetching")&&xt.__abortController instanceof AC},Ho=function(At,xt){rn(this,xi)[xt]=At,rn(this,wi)[At]=xt},_o=function(At){At!==rn(this,ui)&&(At===rn(this,gi)?Pn(this,gi,rn(this,wi)[At]):An(this,Sn,Ho).call(this,rn(this,xi)[At],rn(this,wi)[At]),An(this,Sn,Ho).call(this,rn(this,ui),At),Pn(this,ui,At))};let LRUCache=Qo;var __awaiter$2E=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MemoryCache{constructor(At){this.timeToLiveInSeconds=At,this.cache=new LRUCache({max:1e5,ttl:At*1e3})}set(At,xt){return __awaiter$2E(this,void 0,void 0,function*(){try{this.cache.set(At,xt)}catch{}})}get(At){return __awaiter$2E(this,void 0,void 0,function*(){return this.cache.get(At)})}}const Authorization=validate20,pattern4=new RegExp("^[A-Za-z0-9_-]+$","u");function validate21(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate21.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)){for(const Jt in kt)if(!(Jt==="payload"||Jt==="signatures"))return validate21.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Jt},message:"must NOT have additional properties"}],!1;{if(kt.payload!==void 0){let Jt=kt.payload;const Qt=Lt;if(typeof Jt=="string"){if(!pattern4.test(Jt))return validate21.errors=[{instancePath:At+"/payload",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate21.errors=[{instancePath:At+"/payload",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.signatures!==void 0){let Jt=kt.signatures;const Qt=Lt;if(Array.isArray(Jt)){if(Jt.length<1)return validate21.errors=[{instancePath:At+"/signatures",schemaPath:"#/properties/signatures/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var zt=!0;const tr=Jt.length;for(let rr=0;rr<tr;rr++){let nr=Jt[rr];const ar=Lt;if(nr&&typeof nr=="object"&&!Array.isArray(nr)){if(nr.protected!==void 0){let lr=nr.protected;const yr=Lt;if(typeof lr=="string"){if(!pattern4.test(lr))return validate21.errors=[{instancePath:At+"/signatures/"+rr+"/protected",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate21.errors=[{instancePath:At+"/signatures/"+rr+"/protected",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Wt=yr===Lt}else var Wt=!0;if(Wt)if(nr.signature!==void 0){let lr=nr.signature;const yr=Lt;if(typeof lr=="string"){if(!pattern4.test(lr))return validate21.errors=[{instancePath:At+"/signatures/"+rr+"/signature",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate21.errors=[{instancePath:At+"/signatures/"+rr+"/signature",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Wt=yr===Lt}else var Wt=!0}else return validate21.errors=[{instancePath:At+"/signatures/"+rr,schemaPath:"#/properties/signatures/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=ar===Lt;if(!zt)break}}}else return validate21.errors=[{instancePath:At+"/signatures",schemaPath:"#/properties/signatures/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var Vt=Qt===Lt}else var Vt=!0}}else return validate21.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate21.errors=Ut,Lt===0}validate21.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function validate20(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate20.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){const Vt=Lt;for(const zt in kt)if(zt!=="signature")return validate20.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:zt},message:"must NOT have additional properties"}],!1;Vt===Lt&&kt.signature!==void 0&&(validate21(kt.signature,{instancePath:At+"/signature",parentData:kt,parentDataProperty:"signature",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate21.errors:Ut.concat(validate21.errors),Lt=Ut.length))}else return validate20.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate20.errors=Ut,Lt===0}validate20.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const AuthorizationDelegatedGrant=validate24,schema39={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-write-unidentified.json",type:"object",required:["descriptor"],properties:{recordId:{type:"string"},contextId:{type:"string",pattern:"^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$"},attestation:{$ref:"https://identity.foundation/dwn/json-schemas/general-jws.json"},authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-owner.json"},encryption:{type:"object",properties:{algorithm:{type:"string",enum:["A256CTR"]},initializationVector:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"},keyEncryption:{type:"array",minItems:1,items:{type:"object",properties:{rootKeyId:{type:"string"},derivationScheme:{type:"string",enum:["dataFormats","protocolContext","protocolPath","schemas"]},derivedPublicKey:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"},algorithm:{type:"string",enum:["ECIES-ES256K"]},encryptedKey:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"},initializationVector:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"},ephemeralPublicKey:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"},messageAuthenticationCode:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"}},additionalProperties:!1,required:["rootKeyId","derivationScheme","algorithm","encryptedKey","initializationVector","ephemeralPublicKey","messageAuthenticationCode"]}}},additionalProperties:!1,required:["algorithm","initializationVector","keyEncryption"]},descriptor:{type:"object",properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Write"],type:"string"},recipient:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},protocol:{type:"string"},protocolPath:{type:"string",pattern:"^[a-zA-Z]+(/[a-zA-Z]+)*$"},schema:{type:"string"},tags:{type:"object",minProperties:1,maxProperties:10,additionalProperties:{oneOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array",minItems:1,maxItems:10,items:{type:"string"}},{type:"array",minItems:1,maxItems:10,items:{type:"number"}}]}},parentId:{type:"string"},dataCid:{type:"string"},dataSize:{type:"number"},dateCreated:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},published:{type:"boolean"},datePublished:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},dataFormat:{type:"string"}},additionalProperties:!1,required:["interface","method","dataCid","dataSize","dateCreated","messageTimestamp","dataFormat"],dependencies:{parentId:["protocol"]},allOf:[{$comment:"rule defining `published` and `datePublished` relationship",anyOf:[{properties:{published:{type:"boolean",enum:[!0]}},required:["published","datePublished"]},{properties:{published:{type:"boolean",enum:[!1]}},not:{required:["datePublished"]}},{allOf:[{not:{required:["published"]}},{not:{required:["datePublished"]}}]}]}]}},$comment:"rule defining `protocol` and `contextId` relationship",anyOf:[{properties:{descriptor:{type:"object",required:["protocol","protocolPath"]}},required:["contextId"]},{allOf:[{not:{required:["contextId"]}},{properties:{descriptor:{type:"object",not:{required:["protocol"]}}}},{properties:{descriptor:{type:"object",not:{required:["protocolPath"]}}}}]}]},pattern7=new RegExp("^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$","u"),pattern12=new RegExp("^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$","u"),pattern13=new RegExp("^[a-zA-Z]+(/[a-zA-Z]+)*$","u"),pattern14=new RegExp("^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$","u"),wrapper0={validate:validate26};function validate29(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate29.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){const zt=Lt;for(const Wt in kt)if(!(Wt==="signature"||Wt==="authorDelegatedGrant"||Wt==="ownerSignature"||Wt==="ownerDelegatedGrant"))return validate29.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wt},message:"must NOT have additional properties"}],!1;if(zt===Lt){let Wt;if(kt.ownerSignature!==void 0&&kt.signature===void 0&&(Wt="signature"))return validate29.errors=[{instancePath:At,schemaPath:"#/dependencies",keyword:"dependencies",params:{property:"ownerSignature",missingProperty:Wt,depsCount:1,deps:"signature"},message:"must have property signature when property ownerSignature is present"}],!1;if(kt.signature!==void 0){const Jt=Lt;validate21(kt.signature,{instancePath:At+"/signature",parentData:kt,parentDataProperty:"signature",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate21.errors:Ut.concat(validate21.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.authorDelegatedGrant!==void 0){const Jt=Lt;wrapper0.validate(kt.authorDelegatedGrant,{instancePath:At+"/authorDelegatedGrant",parentData:kt,parentDataProperty:"authorDelegatedGrant",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?wrapper0.validate.errors:Ut.concat(wrapper0.validate.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.ownerSignature!==void 0){const Jt=Lt;validate21(kt.ownerSignature,{instancePath:At+"/ownerSignature",parentData:kt,parentDataProperty:"ownerSignature",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate21.errors:Ut.concat(validate21.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0;if(Vt)if(kt.ownerDelegatedGrant!==void 0){const Jt=Lt;wrapper0.validate(kt.ownerDelegatedGrant,{instancePath:At+"/ownerDelegatedGrant",parentData:kt,parentDataProperty:"ownerDelegatedGrant",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?wrapper0.validate.errors:Ut.concat(wrapper0.validate.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0}}}}else return validate29.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate29.errors=Ut,Lt===0}validate29.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const schema43={$id:"https://identity.foundation/dwn/json-schemas/general-jwk.json",$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",required:["kty"],properties:{alg:{type:"string"},kid:{type:"string"},kty:{enum:["EC","RSA","oct","OKP"]},crv:{type:"string"},use:{type:"string"},key_ops:{type:"string"},x5u:{type:"string"},x5c:{type:"string"},x5t:{type:"string"},"x5t#S256":{type:"string"}},oneOf:[{properties:{kty:{const:"EC"},crv:{type:"string"},x:{type:"string"},y:{type:"string"},d:{type:"string"}},required:["crv","x"]},{properties:{kty:{const:"OKP"},crv:{type:"string"},x:{type:"string"},d:{type:"string"}},required:["crv","x"]},{properties:{kty:{const:"RSA"},n:{type:"string"},e:{type:"string"},d:{type:"string"},p:{type:"string"},q:{type:"string"},dp:{type:"string"},dq:{type:"string"},qi:{type:"string"},oth:{type:"object"}},required:["n","e"]},{properties:{kty:{const:"oct"},k:{type:"string"}},required:["k"]}]};function validate33(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate33.evaluated;Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0);const Vt=Lt,zt=Lt;let Wt=!1,Jt=null;const Qt=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let dr;if(kt.crv===void 0&&(dr="crv")||kt.x===void 0&&(dr="x")){const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/required",keyword:"required",params:{missingProperty:dr},message:"must have required property '"+dr+"'"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}else{if(kt.kty!==void 0){const ur=Lt;if(kt.kty!=="EC"){const $r={instancePath:At+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/kty/const",keyword:"const",params:{allowedValue:"EC"},message:"must be equal to constant"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var Xt=ur===Lt}else var Xt=!0;if(Xt){if(kt.crv!==void 0){const ur=Lt;if(typeof kt.crv!="string"){const wr={instancePath:At+"/crv",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var Xt=ur===Lt}else var Xt=!0;if(Xt){if(kt.x!==void 0){const ur=Lt;if(typeof kt.x!="string"){const wr={instancePath:At+"/x",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var Xt=ur===Lt}else var Xt=!0;if(Xt){if(kt.y!==void 0){const ur=Lt;if(typeof kt.y!="string"){const wr={instancePath:At+"/y",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/y/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var Xt=ur===Lt}else var Xt=!0;if(Xt)if(kt.d!==void 0){const ur=Lt;if(typeof kt.d!="string"){const wr={instancePath:At+"/d",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var Xt=ur===Lt}else var Xt=!0}}}}}var ar=Qt===Lt;if(ar){Wt=!0,Jt=0;var tr={};tr.kty=!0,tr.crv=!0,tr.x=!0,tr.y=!0,tr.d=!0}const rr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let dr;if(kt.crv===void 0&&(dr="crv")||kt.x===void 0&&(dr="x")){const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/required",keyword:"required",params:{missingProperty:dr},message:"must have required property '"+dr+"'"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}else{if(kt.kty!==void 0){const ur=Lt;if(kt.kty!=="OKP"){const $r={instancePath:At+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/kty/const",keyword:"const",params:{allowedValue:"OKP"},message:"must be equal to constant"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var nr=ur===Lt}else var nr=!0;if(nr){if(kt.crv!==void 0){const ur=Lt;if(typeof kt.crv!="string"){const wr={instancePath:At+"/crv",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var nr=ur===Lt}else var nr=!0;if(nr){if(kt.x!==void 0){const ur=Lt;if(typeof kt.x!="string"){const wr={instancePath:At+"/x",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var nr=ur===Lt}else var nr=!0;if(nr)if(kt.d!==void 0){const ur=Lt;if(typeof kt.d!="string"){const wr={instancePath:At+"/d",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}var nr=ur===Lt}else var nr=!0}}}}var ar=rr===Lt;if(ar&&Wt)Wt=!1,Jt=[Jt,1];else{ar&&(Wt=!0,Jt=1,tr!==!0&&(tr=tr||{},tr.kty=!0,tr.crv=!0,tr.x=!0,tr.d=!0));const dr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let $r;if(kt.n===void 0&&($r="n")||kt.e===void 0&&($r="e")){const wr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/required",keyword:"required",params:{missingProperty:$r},message:"must have required property '"+$r+"'"};Ut===null?Ut=[wr]:Ut.push(wr),Lt++}else{if(kt.kty!==void 0){const wr=Lt;if(kt.kty!=="RSA"){const Er={instancePath:At+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/kty/const",keyword:"const",params:{allowedValue:"RSA"},message:"must be equal to constant"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.n!==void 0){const wr=Lt;if(typeof kt.n!="string"){const gr={instancePath:At+"/n",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/n/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.e!==void 0){const wr=Lt;if(typeof kt.e!="string"){const gr={instancePath:At+"/e",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/e/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.d!==void 0){const wr=Lt;if(typeof kt.d!="string"){const gr={instancePath:At+"/d",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.p!==void 0){const wr=Lt;if(typeof kt.p!="string"){const gr={instancePath:At+"/p",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/p/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.q!==void 0){const wr=Lt;if(typeof kt.q!="string"){const gr={instancePath:At+"/q",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/q/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.dp!==void 0){const wr=Lt;if(typeof kt.dp!="string"){const gr={instancePath:At+"/dp",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/dp/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.dq!==void 0){const wr=Lt;if(typeof kt.dq!="string"){const gr={instancePath:At+"/dq",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/dq/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir){if(kt.qi!==void 0){const wr=Lt;if(typeof kt.qi!="string"){const gr={instancePath:At+"/qi",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/qi/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var ir=wr===Lt}else var ir=!0;if(ir)if(kt.oth!==void 0){let wr=kt.oth;const Er=Lt;if(!(wr&&typeof wr=="object"&&!Array.isArray(wr))){const fr={instancePath:At+"/oth",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/oth/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[fr]:Ut.push(fr),Lt++}var ir=Er===Lt}else var ir=!0}}}}}}}}}}var ar=dr===Lt;if(ar&&Wt)Wt=!1,Jt=[Jt,2];else{ar&&(Wt=!0,Jt=2,tr!==!0&&(tr=tr||{},tr.kty=!0,tr.n=!0,tr.e=!0,tr.d=!0,tr.p=!0,tr.q=!0,tr.dp=!0,tr.dq=!0,tr.qi=!0,tr.oth=!0));const $r=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Er;if(kt.k===void 0&&(Er="k")){const gr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/3/required",keyword:"required",params:{missingProperty:Er},message:"must have required property '"+Er+"'"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}else{if(kt.kty!==void 0){const gr=Lt;if(kt.kty!=="oct"){const fr={instancePath:At+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/3/properties/kty/const",keyword:"const",params:{allowedValue:"oct"},message:"must be equal to constant"};Ut===null?Ut=[fr]:Ut.push(fr),Lt++}var lr=gr===Lt}else var lr=!0;if(lr)if(kt.k!==void 0){const gr=Lt;if(typeof kt.k!="string"){const br={instancePath:At+"/k",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/3/properties/k/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[br]:Ut.push(br),Lt++}var lr=gr===Lt}else var lr=!0}}var ar=$r===Lt;ar&&Wt?(Wt=!1,Jt=[Jt,3]):ar&&(Wt=!0,Jt=3,tr!==!0&&(tr=tr||{},tr.kty=!0,tr.k=!0))}}if(Wt)Lt=zt,Ut!==null&&(zt?Ut.length=zt:Ut=null);else{const dr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf",keyword:"oneOf",params:{passingSchemas:Jt},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[dr]:Ut.push(dr),Lt++,validate33.errors=Ut,!1}if(Lt===Vt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let dr;if(kt.kty===void 0&&(dr="kty"))return validate33.errors=[{instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/required",keyword:"required",params:{missingProperty:dr},message:"must have required property '"+dr+"'"}],!1;if(tr!==!0&&(tr=tr||{},tr.alg=!0,tr.kid=!0,tr.kty=!0,tr.crv=!0,tr.use=!0,tr.key_ops=!0,tr.x5u=!0,tr.x5c=!0,tr.x5t=!0,tr["x5t#S256"]=!0),kt.alg!==void 0){const ur=Lt;if(typeof kt.alg!="string")return validate33.errors=[{instancePath:At+"/alg",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/alg/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.kid!==void 0){const ur=Lt;if(typeof kt.kid!="string")return validate33.errors=[{instancePath:At+"/kid",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/kid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.kty!==void 0){let ur=kt.kty;const $r=Lt;if(!(ur==="EC"||ur==="RSA"||ur==="oct"||ur==="OKP"))return validate33.errors=[{instancePath:At+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/kty/enum",keyword:"enum",params:{allowedValues:schema43.properties.kty.enum},message:"must be equal to one of the allowed values"}],!1;var yr=$r===Lt}else var yr=!0;if(yr){if(kt.crv!==void 0){const ur=Lt;if(typeof kt.crv!="string")return validate33.errors=[{instancePath:At+"/crv",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.use!==void 0){const ur=Lt;if(typeof kt.use!="string")return validate33.errors=[{instancePath:At+"/use",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/use/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.key_ops!==void 0){const ur=Lt;if(typeof kt.key_ops!="string")return validate33.errors=[{instancePath:At+"/key_ops",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/key_ops/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.x5u!==void 0){const ur=Lt;if(typeof kt.x5u!="string")return validate33.errors=[{instancePath:At+"/x5u",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5u/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.x5c!==void 0){const ur=Lt;if(typeof kt.x5c!="string")return validate33.errors=[{instancePath:At+"/x5c",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5c/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr){if(kt.x5t!==void 0){const ur=Lt;if(typeof kt.x5t!="string")return validate33.errors=[{instancePath:At+"/x5t",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5t/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0;if(yr)if(kt["x5t#S256"]!==void 0){const ur=Lt;if(typeof kt["x5t#S256"]!="string")return validate33.errors=[{instancePath:At+"/x5t#S256",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5t%23S256/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var yr=ur===Lt}else var yr=!0}}}}}}}}}else return validate33.errors=[{instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Sr=Vt===Lt;if(Sr){const dr=Lt,ur=Lt,$r=Lt;let wr=!1;const Er=Lt,gr=Lt;let fr=!1;const br=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.d===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Ar=br===Lt;if(fr=fr||Ar,fr)Lt=gr,Ut!==null&&(gr?Ut.length=gr:Ut=null);else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}if(Lt===Er)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){if(kt.kty!==void 0&&kt.kty!=="EC"){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}}else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var vr=Er===Lt;if(wr=wr||vr,vr){var Dr={};Dr.kty=!0}const _r=Lt,Tr=Lt;let Pr=!1;const Nr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.d===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Br=Nr===Lt;if(Pr=Pr||Br,Pr)Lt=Tr,Ut!==null&&(Tr?Ut.length=Tr:Ut=null);else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}if(Lt===_r)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){if(kt.kty!==void 0&&kt.kty!=="OKP"){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}}else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var vr=_r===Lt;wr=wr||vr,vr&&Dr!==!0&&(Dr=Dr||{},Dr.kty=!0);const Cr=Lt,xr=Lt;let Rr=!1;const qr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.d===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=qr===Lt;Rr=Rr||Lr;const Vr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.p===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Vr===Lt;Rr=Rr||Lr;const Gr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.q===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Gr===Lt;Rr=Rr||Lr;const Ur=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.dp===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Ur===Lt;Rr=Rr||Lr;const kr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.dq===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=kr===Lt;Rr=Rr||Lr;const Fr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.qi===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Fr===Lt;Rr=Rr||Lr;const Wr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.oth===void 0){const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Wr===Lt;if(Rr=Rr||Lr,Rr)Lt=xr,Ut!==null&&(xr?Ut.length=xr:Ut=null);else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}if(Lt===Cr)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){if(kt.kty!==void 0){const jr=Lt;if(kt.kty!=="RSA"){const Ir={};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Or=jr===Lt}else var Or=!0;if(Or)if(kt.oth!==void 0){let jr=kt.oth;const Ir=Lt;if(!(jr&&typeof jr=="object"&&!Array.isArray(jr))){const Hr={};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++}var Or=Ir===Lt}else var Or=!0}else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var vr=Cr===Lt;if(wr=wr||vr,vr&&Dr!==!0&&(Dr=Dr||{},Dr.kty=!0,Dr.d=!0,Dr.p=!0,Dr.q=!0,Dr.dp=!0,Dr.dq=!0,Dr.qi=!0,Dr.oth=!0),wr)Lt=$r,Ut!==null&&($r?Ut.length=$r:Ut=null);else{const jr={};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var pr=ur===Lt;if(pr)return validate33.errors=[{instancePath:At,schemaPath:"#/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=dr,Ut!==null&&(dr?Ut.length=dr:Ut=null)}return validate33.errors=Ut,Ht.props=tr,Lt===0}validate33.evaluated={dynamicProps:!0,dynamicItems:!1};const func1=Object.prototype.hasOwnProperty;function validate27(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate27.evaluated;Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0);const Vt=Lt;let zt=!1;const Wt=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let br;if(kt.contextId===void 0&&(br="contextId")){const _r={instancePath:At,schemaPath:"#/anyOf/0/required",keyword:"required",params:{missingProperty:br},message:"must have required property '"+br+"'"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}else if(kt.descriptor!==void 0){let _r=kt.descriptor;if(Lt===Lt)if(_r&&typeof _r=="object"&&!Array.isArray(_r)){let Pr;if(_r.protocol===void 0&&(Pr="protocol")||_r.protocolPath===void 0&&(Pr="protocolPath")){const Nr={instancePath:At+"/descriptor",schemaPath:"#/anyOf/0/properties/descriptor/required",keyword:"required",params:{missingProperty:Pr},message:"must have required property '"+Pr+"'"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}}else{const Pr={instancePath:At+"/descriptor",schemaPath:"#/anyOf/0/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++}}}var yr=Wt===Lt;if(zt=zt||yr,yr){var Jt={};Jt.descriptor=!0}const Qt=Lt,Xt=Lt,tr=Lt,rr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.contextId===void 0){const br={};Ut===null?Ut=[br]:Ut.push(br),Lt++}var nr=rr===Lt;if(nr){const br={instancePath:At,schemaPath:"#/anyOf/1/allOf/0/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[br]:Ut.push(br),Lt++}else Lt=tr,Ut!==null&&(tr?Ut.length=tr:Ut=null);var ar=Xt===Lt;if(ar){const br=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.descriptor!==void 0){let Tr=kt.descriptor;if(!(Tr&&typeof Tr=="object"&&!Array.isArray(Tr))){const Cr={instancePath:At+"/descriptor",schemaPath:"#/anyOf/1/allOf/1/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Cr]:Ut.push(Cr),Lt++}const Pr=Lt,Nr=Lt;if(Tr&&typeof Tr=="object"&&!Array.isArray(Tr)&&Tr.protocol===void 0){const Cr={};Ut===null?Ut=[Cr]:Ut.push(Cr),Lt++}var ir=Nr===Lt;if(ir){const Cr={instancePath:At+"/descriptor",schemaPath:"#/anyOf/1/allOf/1/properties/descriptor/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Cr]:Ut.push(Cr),Lt++}else Lt=Pr,Ut!==null&&(Pr?Ut.length=Pr:Ut=null)}var ar=br===Lt;if(ar){const Tr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.descriptor!==void 0){let Nr=kt.descriptor;if(!(Nr&&typeof Nr=="object"&&!Array.isArray(Nr))){const Rr={instancePath:At+"/descriptor",schemaPath:"#/anyOf/1/allOf/2/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}const Cr=Lt,xr=Lt;if(Nr&&typeof Nr=="object"&&!Array.isArray(Nr)&&Nr.protocolPath===void 0){const Rr={};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var lr=xr===Lt;if(lr){const Rr={instancePath:At+"/descriptor",schemaPath:"#/anyOf/1/allOf/2/properties/descriptor/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}else Lt=Cr,Ut!==null&&(Cr?Ut.length=Cr:Ut=null)}var ar=Tr===Lt}}var yr=Qt===Lt;if(zt=zt||yr,yr&&Jt!==!0&&(Jt=Jt||{},Jt.descriptor=!0),zt)Lt=Vt,Ut!==null&&(Vt?Ut.length=Vt:Ut=null);else{const br={instancePath:At,schemaPath:"#/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return Ut===null?Ut=[br]:Ut.push(br),Lt++,validate27.errors=Ut,!1}if(Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let br;if(kt.descriptor===void 0&&(br="descriptor"))return validate27.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:br},message:"must have required property '"+br+"'"}],!1;if(Jt!==!0&&(Jt=Jt||{},Jt.recordId=!0,Jt.contextId=!0,Jt.attestation=!0,Jt.authorization=!0,Jt.encryption=!0,Jt.descriptor=!0),kt.recordId!==void 0){const _r=Lt;if(typeof kt.recordId!="string")return validate27.errors=[{instancePath:At+"/recordId",schemaPath:"#/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Sr=_r===Lt}else var Sr=!0;if(Sr){if(kt.contextId!==void 0){let _r=kt.contextId;const Tr=Lt;if(Lt===Tr)if(typeof _r=="string"){if(!pattern7.test(_r))return validate27.errors=[{instancePath:At+"/contextId",schemaPath:"#/properties/contextId/pattern",keyword:"pattern",params:{pattern:"^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$"},message:'must match pattern "^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$"'}],!1}else return validate27.errors=[{instancePath:At+"/contextId",schemaPath:"#/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Sr=Tr===Lt}else var Sr=!0;if(Sr){if(kt.attestation!==void 0){const _r=Lt;validate21(kt.attestation,{instancePath:At+"/attestation",parentData:kt,parentDataProperty:"attestation",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate21.errors:Ut.concat(validate21.errors),Lt=Ut.length);var Sr=_r===Lt}else var Sr=!0;if(Sr){if(kt.authorization!==void 0){const _r=Lt;validate29(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate29.errors:Ut.concat(validate29.errors),Lt=Ut.length);var Sr=_r===Lt}else var Sr=!0;if(Sr){if(kt.encryption!==void 0){let _r=kt.encryption;const Tr=Lt;if(Lt===Tr)if(_r&&typeof _r=="object"&&!Array.isArray(_r)){let Nr;if(_r.algorithm===void 0&&(Nr="algorithm")||_r.initializationVector===void 0&&(Nr="initializationVector")||_r.keyEncryption===void 0&&(Nr="keyEncryption"))return validate27.errors=[{instancePath:At+"/encryption",schemaPath:"#/properties/encryption/required",keyword:"required",params:{missingProperty:Nr},message:"must have required property '"+Nr+"'"}],!1;{const Cr=Lt;for(const xr in _r)if(!(xr==="algorithm"||xr==="initializationVector"||xr==="keyEncryption"))return validate27.errors=[{instancePath:At+"/encryption",schemaPath:"#/properties/encryption/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:xr},message:"must NOT have additional properties"}],!1;if(Cr===Lt){if(_r.algorithm!==void 0){let xr=_r.algorithm;const Rr=Lt;if(typeof xr!="string")return validate27.errors=[{instancePath:At+"/encryption/algorithm",schemaPath:"#/properties/encryption/properties/algorithm/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(xr!=="A256CTR")return validate27.errors=[{instancePath:At+"/encryption/algorithm",schemaPath:"#/properties/encryption/properties/algorithm/enum",keyword:"enum",params:{allowedValues:schema39.properties.encryption.properties.algorithm.enum},message:"must be equal to one of the allowed values"}],!1;var Ar=Rr===Lt}else var Ar=!0;if(Ar){if(_r.initializationVector!==void 0){let xr=_r.initializationVector;const Rr=Lt;if(Lt===Lt)if(typeof xr=="string"){if(!pattern4.test(xr))return validate27.errors=[{instancePath:At+"/encryption/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate27.errors=[{instancePath:At+"/encryption/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Ar=Rr===Lt}else var Ar=!0;if(Ar)if(_r.keyEncryption!==void 0){let xr=_r.keyEncryption;const Rr=Lt;if(Lt===Rr)if(Array.isArray(xr)){if(xr.length<1)return validate27.errors=[{instancePath:At+"/encryption/keyEncryption",schemaPath:"#/properties/encryption/properties/keyEncryption/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var Dr=!0;const Vr=xr.length;for(let Gr=0;Gr<Vr;Gr++){let Ur=xr[Gr];const kr=Lt;if(Lt===kr)if(Ur&&typeof Ur=="object"&&!Array.isArray(Ur)){let Wr;if(Ur.rootKeyId===void 0&&(Wr="rootKeyId")||Ur.derivationScheme===void 0&&(Wr="derivationScheme")||Ur.algorithm===void 0&&(Wr="algorithm")||Ur.encryptedKey===void 0&&(Wr="encryptedKey")||Ur.initializationVector===void 0&&(Wr="initializationVector")||Ur.ephemeralPublicKey===void 0&&(Wr="ephemeralPublicKey")||Ur.messageAuthenticationCode===void 0&&(Wr="messageAuthenticationCode"))return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr,schemaPath:"#/properties/encryption/properties/keyEncryption/items/required",keyword:"required",params:{missingProperty:Wr},message:"must have required property '"+Wr+"'"}],!1;{const jr=Lt;for(const Ir in Ur)if(!(Ir==="rootKeyId"||Ir==="derivationScheme"||Ir==="derivedPublicKey"||Ir==="algorithm"||Ir==="encryptedKey"||Ir==="initializationVector"||Ir==="ephemeralPublicKey"||Ir==="messageAuthenticationCode"))return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr,schemaPath:"#/properties/encryption/properties/keyEncryption/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Ir},message:"must NOT have additional properties"}],!1;if(jr===Lt){if(Ur.rootKeyId!==void 0){const Ir=Lt;if(typeof Ur.rootKeyId!="string")return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/rootKeyId",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/rootKeyId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Br=Ir===Lt}else var Br=!0;if(Br){if(Ur.derivationScheme!==void 0){let Ir=Ur.derivationScheme;const Mr=Lt;if(typeof Ir!="string")return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/derivationScheme",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/derivationScheme/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(Ir==="dataFormats"||Ir==="protocolContext"||Ir==="protocolPath"||Ir==="schemas"))return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/derivationScheme",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/derivationScheme/enum",keyword:"enum",params:{allowedValues:schema39.properties.encryption.properties.keyEncryption.items.properties.derivationScheme.enum},message:"must be equal to one of the allowed values"}],!1;var Br=Mr===Lt}else var Br=!0;if(Br){if(Ur.derivedPublicKey!==void 0){const Ir=Lt;validate33(Ur.derivedPublicKey,{instancePath:At+"/encryption/keyEncryption/"+Gr+"/derivedPublicKey",parentData:Ur,parentDataProperty:"derivedPublicKey",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate33.errors:Ut.concat(validate33.errors),Lt=Ut.length);var Br=Ir===Lt}else var Br=!0;if(Br){if(Ur.algorithm!==void 0){let Ir=Ur.algorithm;const Mr=Lt;if(typeof Ir!="string")return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/algorithm",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/algorithm/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(Ir!=="ECIES-ES256K")return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/algorithm",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/algorithm/enum",keyword:"enum",params:{allowedValues:schema39.properties.encryption.properties.keyEncryption.items.properties.algorithm.enum},message:"must be equal to one of the allowed values"}],!1;var Br=Mr===Lt}else var Br=!0;if(Br){if(Ur.encryptedKey!==void 0){let Ir=Ur.encryptedKey;const Mr=Lt;if(Lt===Lt)if(typeof Ir=="string"){if(!pattern4.test(Ir))return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/encryptedKey",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/encryptedKey",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Br=Mr===Lt}else var Br=!0;if(Br){if(Ur.initializationVector!==void 0){let Ir=Ur.initializationVector;const Mr=Lt;if(Lt===Lt)if(typeof Ir=="string"){if(!pattern4.test(Ir))return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Br=Mr===Lt}else var Br=!0;if(Br){if(Ur.ephemeralPublicKey!==void 0){const Ir=Lt;validate33(Ur.ephemeralPublicKey,{instancePath:At+"/encryption/keyEncryption/"+Gr+"/ephemeralPublicKey",parentData:Ur,parentDataProperty:"ephemeralPublicKey",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate33.errors:Ut.concat(validate33.errors),Lt=Ut.length);var Br=Ir===Lt}else var Br=!0;if(Br)if(Ur.messageAuthenticationCode!==void 0){let Ir=Ur.messageAuthenticationCode;const Mr=Lt;if(Lt===Lt)if(typeof Ir=="string"){if(!pattern4.test(Ir))return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/messageAuthenticationCode",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr+"/messageAuthenticationCode",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Br=Mr===Lt}else var Br=!0}}}}}}}}}else return validate27.errors=[{instancePath:At+"/encryption/keyEncryption/"+Gr,schemaPath:"#/properties/encryption/properties/keyEncryption/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Dr=kr===Lt;if(!Dr)break}}}else return validate27.errors=[{instancePath:At+"/encryption/keyEncryption",schemaPath:"#/properties/encryption/properties/keyEncryption/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var Ar=Rr===Lt}else var Ar=!0}}}}else return validate27.errors=[{instancePath:At+"/encryption",schemaPath:"#/properties/encryption/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Sr=Tr===Lt}else var Sr=!0;if(Sr)if(kt.descriptor!==void 0){let _r=kt.descriptor;const Tr=Lt,Pr=Lt;let Nr=!1;const Cr=Lt;if(_r&&typeof _r=="object"&&!Array.isArray(_r)){let Wr;if(_r.published===void 0&&(Wr="published")||_r.datePublished===void 0&&(Wr="datePublished")){const jr={instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/0/required",keyword:"required",params:{missingProperty:Wr},message:"must have required property '"+Wr+"'"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}else if(_r.published!==void 0){let jr=_r.published;if(typeof jr!="boolean"){const Ir={instancePath:At+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/0/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}if(jr!==!0){const Ir={instancePath:At+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/0/properties/published/enum",keyword:"enum",params:{allowedValues:schema39.properties.descriptor.allOf[0].anyOf[0].properties.published.enum},message:"must be equal to one of the allowed values"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}}}var ur=Cr===Lt;if(Nr=Nr||ur,ur){var Lr={};Lr.published=!0}const xr=Lt,Rr=Lt,qr=Lt;if(_r&&typeof _r=="object"&&!Array.isArray(_r)&&_r.datePublished===void 0){const Wr={};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var Or=qr===Lt;if(Or){const Wr={instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/1/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}else Lt=Rr,Ut!==null&&(Rr?Ut.length=Rr:Ut=null);if(Lt===xr&&_r&&typeof _r=="object"&&!Array.isArray(_r)&&_r.published!==void 0){let Wr=_r.published;if(typeof Wr!="boolean"){const jr={instancePath:At+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/1/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}if(Wr!==!1){const jr={instancePath:At+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/1/properties/published/enum",keyword:"enum",params:{allowedValues:schema39.properties.descriptor.allOf[0].anyOf[1].properties.published.enum},message:"must be equal to one of the allowed values"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}}var ur=xr===Lt;Nr=Nr||ur,ur&&Lr!==!0&&(Lr=Lr||{},Lr.published=!0);const Vr=Lt,Gr=Lt,Ur=Lt,kr=Lt;if(_r&&typeof _r=="object"&&!Array.isArray(_r)&&_r.published===void 0){const Wr={};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var vr=kr===Lt;if(vr){const Wr={instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/2/allOf/0/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}else Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);var pr=Gr===Lt;if(pr){const Wr=Lt,jr=Lt,Ir=Lt;if(_r&&typeof _r=="object"&&!Array.isArray(_r)&&_r.datePublished===void 0){const Hr={};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++}var dr=Ir===Lt;if(dr){const Hr={instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/2/allOf/1/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++}else Lt=jr,Ut!==null&&(jr?Ut.length=jr:Ut=null);var pr=Wr===Lt}var ur=Vr===Lt;if(Nr=Nr||ur,Nr)Lt=Pr,Ut!==null&&(Pr?Ut.length=Pr:Ut=null);else{const Wr={instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++,validate27.errors=Ut,!1}if(Lt===Tr)if(_r&&typeof _r=="object"&&!Array.isArray(_r)){let Wr;if(_r.interface===void 0&&(Wr="interface")||_r.method===void 0&&(Wr="method")||_r.dataCid===void 0&&(Wr="dataCid")||_r.dataSize===void 0&&(Wr="dataSize")||_r.dateCreated===void 0&&(Wr="dateCreated")||_r.messageTimestamp===void 0&&(Wr="messageTimestamp")||_r.dataFormat===void 0&&(Wr="dataFormat"))return validate27.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:Wr},message:"must have required property '"+Wr+"'"}],!1;{const jr=Lt;for(const Ir in _r)if(!func1.call(schema39.properties.descriptor.properties,Ir))return validate27.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Ir},message:"must NOT have additional properties"}],!1;if(jr===Lt){let Ir;if(_r.parentId!==void 0&&_r.protocol===void 0&&(Ir="protocol"))return validate27.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/dependencies",keyword:"dependencies",params:{property:"parentId",missingProperty:Ir,depsCount:1,deps:"protocol"},message:"must have property protocol when property parentId is present"}],!1;if(_r.interface!==void 0){let Mr=_r.interface;const Hr=Lt;if(typeof Mr!="string")return validate27.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(Mr!=="Records")return validate27.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema39.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.method!==void 0){let Mr=_r.method;const Hr=Lt;if(typeof Mr!="string")return validate27.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(Mr!=="Write")return validate27.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema39.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.recipient!==void 0){let Mr=_r.recipient;const Hr=Lt;if(Lt===Lt)if(typeof Mr=="string"){if(!pattern12.test(Mr))return validate27.errors=[{instancePath:At+"/descriptor/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return validate27.errors=[{instancePath:At+"/descriptor/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.protocol!==void 0){const Mr=Lt;if(typeof _r.protocol!="string")return validate27.errors=[{instancePath:At+"/descriptor/protocol",schemaPath:"#/properties/descriptor/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Mr===Lt}else var $r=!0;if($r){if(_r.protocolPath!==void 0){let Mr=_r.protocolPath;const Hr=Lt;if(Lt===Hr)if(typeof Mr=="string"){if(!pattern13.test(Mr))return validate27.errors=[{instancePath:At+"/descriptor/protocolPath",schemaPath:"#/properties/descriptor/properties/protocolPath/pattern",keyword:"pattern",params:{pattern:"^[a-zA-Z]+(/[a-zA-Z]+)*$"},message:'must match pattern "^[a-zA-Z]+(/[a-zA-Z]+)*$"'}],!1}else return validate27.errors=[{instancePath:At+"/descriptor/protocolPath",schemaPath:"#/properties/descriptor/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.schema!==void 0){const Mr=Lt;if(typeof _r.schema!="string")return validate27.errors=[{instancePath:At+"/descriptor/schema",schemaPath:"#/properties/descriptor/properties/schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Mr===Lt}else var $r=!0;if($r){if(_r.tags!==void 0){let Mr=_r.tags;const Hr=Lt;if(Lt===Hr)if(Mr&&typeof Mr=="object"&&!Array.isArray(Mr)){if(Object.keys(Mr).length>10)return validate27.errors=[{instancePath:At+"/descriptor/tags",schemaPath:"#/properties/descriptor/properties/tags/maxProperties",keyword:"maxProperties",params:{limit:10},message:"must NOT have more than 10 properties"}],!1;if(Object.keys(Mr).length<1)return validate27.errors=[{instancePath:At+"/descriptor/tags",schemaPath:"#/properties/descriptor/properties/tags/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;for(const on in Mr){let nn=Mr[on];const fn=Lt,hn=Lt;let Jr=!1,Yr=null;const an=Lt;if(typeof nn!="string"){const cn={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}var wr=an===Lt;wr&&(Jr=!0,Yr=0);const dn=Lt;if(!(typeof nn=="number"&&isFinite(nn))){const cn={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/1/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}var wr=dn===Lt;if(wr&&Jr)Jr=!1,Yr=[Yr,1];else{wr&&(Jr=!0,Yr=1);const cn=Lt;if(typeof nn!="boolean"){const _n={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};Ut===null?Ut=[_n]:Ut.push(_n),Lt++}var wr=cn===Lt;if(wr&&Jr)Jr=!1,Yr=[Yr,2];else{wr&&(Jr=!0,Yr=2);const _n=Lt;if(Lt===_n)if(Array.isArray(nn))if(nn.length>10){const $n={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/maxItems",keyword:"maxItems",params:{limit:10},message:"must NOT have more than 10 items"};Ut===null?Ut=[$n]:Ut.push($n),Lt++}else if(nn.length<1){const $n={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};Ut===null?Ut=[$n]:Ut.push($n),Lt++}else{var Er=!0;const $n=nn.length;for(let Kn=0;Kn<$n;Kn++){const Un=Lt;if(typeof nn[Kn]!="string"){const Mn={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+Kn,schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/items/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Mn]:Ut.push(Mn),Lt++}var Er=Un===Lt;if(!Er)break}}else{const $n={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/type",keyword:"type",params:{type:"array"},message:"must be array"};Ut===null?Ut=[$n]:Ut.push($n),Lt++}var wr=_n===Lt;if(wr&&Jr)Jr=!1,Yr=[Yr,3];else{wr&&(Jr=!0,Yr=3);const $n=Lt;if(Lt===$n)if(Array.isArray(nn))if(nn.length>10){const Un={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/maxItems",keyword:"maxItems",params:{limit:10},message:"must NOT have more than 10 items"};Ut===null?Ut=[Un]:Ut.push(Un),Lt++}else if(nn.length<1){const Un={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};Ut===null?Ut=[Un]:Ut.push(Un),Lt++}else{var gr=!0;const Un=nn.length;for(let In=0;In<Un;In++){let Mn=nn[In];const qn=Lt;if(!(typeof Mn=="number"&&isFinite(Mn))){const Hn={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+In,schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/items/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[Hn]:Ut.push(Hn),Lt++}var gr=qn===Lt;if(!gr)break}}else{const Un={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/type",keyword:"type",params:{type:"array"},message:"must be array"};Ut===null?Ut=[Un]:Ut.push(Un),Lt++}var wr=$n===Lt;wr&&Jr?(Jr=!1,Yr=[Yr,4]):wr&&(Jr=!0,Yr=4)}}}if(Jr)Lt=hn,Ut!==null&&(hn?Ut.length=hn:Ut=null);else{const cn={instancePath:At+"/descriptor/tags/"+on.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf",keyword:"oneOf",params:{passingSchemas:Yr},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[cn]:Ut.push(cn),Lt++,validate27.errors=Ut,!1}var fr=fn===Lt;if(!fr)break}}else return validate27.errors=[{instancePath:At+"/descriptor/tags",schemaPath:"#/properties/descriptor/properties/tags/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.parentId!==void 0){const Mr=Lt;if(typeof _r.parentId!="string")return validate27.errors=[{instancePath:At+"/descriptor/parentId",schemaPath:"#/properties/descriptor/properties/parentId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Mr===Lt}else var $r=!0;if($r){if(_r.dataCid!==void 0){const Mr=Lt;if(typeof _r.dataCid!="string")return validate27.errors=[{instancePath:At+"/descriptor/dataCid",schemaPath:"#/properties/descriptor/properties/dataCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Mr===Lt}else var $r=!0;if($r){if(_r.dataSize!==void 0){let Mr=_r.dataSize;const Hr=Lt;if(!(typeof Mr=="number"&&isFinite(Mr)))return validate27.errors=[{instancePath:At+"/descriptor/dataSize",schemaPath:"#/properties/descriptor/properties/dataSize/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.dateCreated!==void 0){let Mr=_r.dateCreated;const Hr=Lt;if(Lt===Lt)if(typeof Mr=="string"){if(!pattern14.test(Mr))return validate27.errors=[{instancePath:At+"/descriptor/dateCreated",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate27.errors=[{instancePath:At+"/descriptor/dateCreated",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.messageTimestamp!==void 0){let Mr=_r.messageTimestamp;const Hr=Lt;if(Lt===Lt)if(typeof Mr=="string"){if(!pattern14.test(Mr))return validate27.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate27.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Hr===Lt}else var $r=!0;if($r){if(_r.published!==void 0){const Mr=Lt;if(typeof _r.published!="boolean")return validate27.errors=[{instancePath:At+"/descriptor/published",schemaPath:"#/properties/descriptor/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var $r=Mr===Lt}else var $r=!0;if($r){if(_r.datePublished!==void 0){let Mr=_r.datePublished;const Hr=Lt;if(Lt===Lt)if(typeof Mr=="string"){if(!pattern14.test(Mr))return validate27.errors=[{instancePath:At+"/descriptor/datePublished",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate27.errors=[{instancePath:At+"/descriptor/datePublished",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Hr===Lt}else var $r=!0;if($r)if(_r.dataFormat!==void 0){const Mr=Lt;if(typeof _r.dataFormat!="string")return validate27.errors=[{instancePath:At+"/descriptor/dataFormat",schemaPath:"#/properties/descriptor/properties/dataFormat/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $r=Mr===Lt}else var $r=!0}}}}}}}}}}}}}}}}else return validate27.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Sr=Tr===Lt}else var Sr=!0}}}}}else return validate27.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate27.errors=Ut,Ht.props=Jt,Lt===0}validate27.evaluated={dynamicProps:!0,dynamicItems:!1};function validate26(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate26.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),!validate27(kt,{instancePath:At,parentData:xt,parentDataProperty:Bt,rootData:Nt,dynamicAnchors:jt}))Ut=Ut===null?validate27.errors:Ut.concat(validate27.errors),Lt=Ut.length;else var Vt=validate27.evaluated.props;if(Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Wt;if(kt.recordId===void 0&&(Wt="recordId")||kt.authorization===void 0&&(Wt="authorization")||kt.encodedData===void 0&&(Wt="encodedData"))return validate26.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Wt},message:"must have required property '"+Wt+"'"}],!1;if(Vt!==!0&&(Vt=Vt||{},Vt.encodedData=!0),kt.encodedData!==void 0){const Jt=Lt;if(typeof kt.encodedData!="string")return validate26.errors=[{instancePath:At+"/encodedData",schemaPath:"#/properties/encodedData/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=Jt===Lt}else var zt=!0;if(zt&&Vt!==!0){for(const Jt in kt)if(!Vt||!Vt[Jt])return validate26.errors=[{instancePath:At,schemaPath:"#/unevaluatedProperties",keyword:"unevaluatedProperties",params:{unevaluatedProperty:Jt},message:"must NOT have unevaluated properties"}],!1}}else return validate26.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate26.errors=Ut,Lt===0}validate26.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function validate24(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate24.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){const zt=Lt;for(const Wt in kt)if(!(Wt==="signature"||Wt==="authorDelegatedGrant"))return validate24.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wt},message:"must NOT have additional properties"}],!1;if(zt===Lt){if(kt.signature!==void 0){const Wt=Lt;validate21(kt.signature,{instancePath:At+"/signature",parentData:kt,parentDataProperty:"signature",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate21.errors:Ut.concat(validate21.errors),Lt=Ut.length);var Vt=Wt===Lt}else var Vt=!0;if(Vt)if(kt.authorDelegatedGrant!==void 0){const Wt=Lt;validate26(kt.authorDelegatedGrant,{instancePath:At+"/authorDelegatedGrant",parentData:kt,parentDataProperty:"authorDelegatedGrant",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate26.errors:Ut.concat(validate26.errors),Lt=Ut.length);var Vt=Wt===Lt}else var Vt=!0}}else return validate24.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate24.errors=Ut,Lt===0}validate24.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const AuthorizationOwner=validate29,RecordsDelete$1=validate38,schema51={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-delete.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","recordId","prune"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Delete"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},recordId:{type:"string"},prune:{type:"boolean"}}}}};function validate38(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate38.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Wt;if(kt.authorization===void 0&&(Wt="authorization")||kt.descriptor===void 0&&(Wt="descriptor"))return validate38.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Wt},message:"must have required property '"+Wt+"'"}],!1;{const Jt=Lt;for(const Qt in kt)if(!(Qt==="authorization"||Qt==="descriptor"))return validate38.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Qt},message:"must NOT have additional properties"}],!1;if(Jt===Lt){if(kt.authorization!==void 0){const Qt=Lt;validate24(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate24.errors:Ut.concat(validate24.errors),Lt=Ut.length);var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Qt=kt.descriptor;const Xt=Lt;if(Lt===Xt)if(Qt&&typeof Qt=="object"&&!Array.isArray(Qt)){let rr;if(Qt.interface===void 0&&(rr="interface")||Qt.method===void 0&&(rr="method")||Qt.messageTimestamp===void 0&&(rr="messageTimestamp")||Qt.recordId===void 0&&(rr="recordId")||Qt.prune===void 0&&(rr="prune"))return validate38.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:rr},message:"must have required property '"+rr+"'"}],!1;{const nr=Lt;for(const ar in Qt)if(!(ar==="interface"||ar==="method"||ar==="messageTimestamp"||ar==="recordId"||ar==="prune"))return validate38.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ar},message:"must NOT have additional properties"}],!1;if(nr===Lt){if(Qt.interface!==void 0){let ar=Qt.interface;const ir=Lt;if(typeof ar!="string")return validate38.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Records")return validate38.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema51.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.method!==void 0){let ar=Qt.method;const ir=Lt;if(typeof ar!="string")return validate38.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Delete")return validate38.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema51.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.messageTimestamp!==void 0){let ar=Qt.messageTimestamp;const ir=Lt;if(Lt===Lt)if(typeof ar=="string"){if(!pattern14.test(ar))return validate38.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate38.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.recordId!==void 0){const ar=Lt;if(typeof Qt.recordId!="string")return validate38.errors=[{instancePath:At+"/descriptor/recordId",schemaPath:"#/properties/descriptor/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ar===Lt}else var zt=!0;if(zt)if(Qt.prune!==void 0){const ar=Lt;if(typeof Qt.prune!="boolean")return validate38.errors=[{instancePath:At+"/descriptor/prune",schemaPath:"#/properties/descriptor/properties/prune/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var zt=ar===Lt}else var zt=!0}}}}}}else return validate38.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Xt===Lt}else var Vt=!0}}}else return validate38.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate38.errors=Ut,Lt===0}validate38.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsQuery$1=validate40,schema53={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-query.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filter"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Query"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{$ref:"https://identity.foundation/dwn/json-schemas/records-filter.json"},pagination:{type:"object",additionalProperties:!1,properties:{limit:{type:"number",minimum:1},cursor:{$ref:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json"}}},dateSort:{enum:["createdAscending","createdDescending","publishedAscending","publishedDescending"],type:"string"}}}}},schema70={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json",type:"object",minProperties:1,additionalProperties:!1,required:["messageCid","value"],properties:{messageCid:{type:"string"},value:{type:["string","number"]}}},schema55={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-filter.json",type:"object",minProperties:1,additionalProperties:!1,properties:{protocol:{type:"string"},protocolPath:{type:"string"},author:{oneOf:[{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"}}]},attester:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},recipient:{oneOf:[{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"}}]},contextId:{type:"string"},schema:{type:"string"},tags:{type:"object",minProperties:1,additionalProperties:{oneOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"object",minProperties:1,additionalProperties:!1,properties:{startsWith:{type:"string"}}},{$ref:"https://identity.foundation/dwn/json-schemas/string-range-filter.json"},{$ref:"https://identity.foundation/dwn/json-schemas/number-range-filter.json"}]}},recordId:{type:"string"},parentId:{type:"string"},published:{type:"boolean"},dataFormat:{type:"string"},dataSize:{$ref:"https://identity.foundation/dwn/json-schemas/number-range-filter.json"},dataCid:{type:"string"},dateCreated:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}},datePublished:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}},dateUpdated:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}}},dependencies:{datePublished:{oneOf:[{properties:{published:{enum:[!0]}},required:["published"]},{not:{required:["published"]}}]}}};function validate42(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate42.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){if(Object.keys(kt).length<1)return validate42.errors=[{instancePath:At,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const Nr=Lt;for(const Cr in kt)if(!func1.call(schema55.properties,Cr))return validate42.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Cr},message:"must NOT have additional properties"}],!1;if(Nr===Lt){if(kt.datePublished!==void 0){const Cr=Lt,xr=Lt;let Rr=!1,qr=null;const Vr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Fr;if(kt.published===void 0&&(Fr="published")){const Wr={instancePath:At,schemaPath:"#/dependencies/datePublished/oneOf/0/required",keyword:"required",params:{missingProperty:Fr},message:"must have required property '"+Fr+"'"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}else if(kt.published!==void 0&&kt.published!==!0){const Wr={instancePath:At+"/published",schemaPath:"#/dependencies/datePublished/oneOf/0/properties/published/enum",keyword:"enum",params:{allowedValues:schema55.dependencies.datePublished.oneOf[0].properties.published.enum},message:"must be equal to one of the allowed values"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}}var Wt=Vr===Lt;if(Wt){Rr=!0,qr=0;var Vt={};Vt.published=!0}const Gr=Lt,Ur=Lt,kr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.published===void 0){const Fr={};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var zt=kr===Lt;if(zt){const Fr={instancePath:At,schemaPath:"#/dependencies/datePublished/oneOf/1/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}else Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);var Wt=Gr===Lt;if(Wt&&Rr?(Rr=!1,qr=[qr,1]):Wt&&(Rr=!0,qr=1),Rr)Lt=xr,Ut!==null&&(xr?Ut.length=xr:Ut=null);else{const Fr={instancePath:At,schemaPath:"#/dependencies/datePublished/oneOf",keyword:"oneOf",params:{passingSchemas:qr},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++,validate42.errors=Ut,!1}var Jt=Cr===Lt}else var Jt=!0;if(Jt){if(kt.protocol!==void 0){const Cr=Lt;if(typeof kt.protocol!="string")return validate42.errors=[{instancePath:At+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.protocolPath!==void 0){const Cr=Lt;if(typeof kt.protocolPath!="string")return validate42.errors=[{instancePath:At+"/protocolPath",schemaPath:"#/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.author!==void 0){let Cr=kt.author;const xr=Lt,Rr=Lt;let qr=!1,Vr=null;const Gr=Lt;if(Lt===Lt)if(typeof Cr=="string"){if(!pattern12.test(Cr)){const Wr={instancePath:At+"/author",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}}else{const Wr={instancePath:At+"/author",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var tr=Gr===Lt;tr&&(qr=!0,Vr=0);const kr=Lt;if(Lt===kr)if(Array.isArray(Cr)){var Xt=!0;const Wr=Cr.length;for(let jr=0;jr<Wr;jr++){let Ir=Cr[jr];const Mr=Lt;if(Lt===Lt)if(typeof Ir=="string"){if(!pattern12.test(Ir)){const on={instancePath:At+"/author/"+jr,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};Ut===null?Ut=[on]:Ut.push(on),Lt++}}else{const on={instancePath:At+"/author/"+jr,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[on]:Ut.push(on),Lt++}var Xt=Mr===Lt;if(!Xt)break}}else{const Wr={instancePath:At+"/author",schemaPath:"#/properties/author/oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var tr=kr===Lt;if(tr&&qr?(qr=!1,Vr=[Vr,1]):tr&&(qr=!0,Vr=1),qr)Lt=Rr,Ut!==null&&(Rr?Ut.length=Rr:Ut=null);else{const Wr={instancePath:At+"/author",schemaPath:"#/properties/author/oneOf",keyword:"oneOf",params:{passingSchemas:Vr},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++,validate42.errors=Ut,!1}var Qt=xr===Lt}else var Qt=!0;if(Qt){if(kt.attester!==void 0){let Cr=kt.attester;const xr=Lt;if(Lt===Lt)if(typeof Cr=="string"){if(!pattern12.test(Cr))return validate42.errors=[{instancePath:At+"/attester",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return validate42.errors=[{instancePath:At+"/attester",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=xr===Lt}else var Qt=!0;if(Qt){if(kt.recipient!==void 0){let Cr=kt.recipient;const xr=Lt,Rr=Lt;let qr=!1,Vr=null;const Gr=Lt;if(Lt===Lt)if(typeof Cr=="string"){if(!pattern12.test(Cr)){const Wr={instancePath:At+"/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}}else{const Wr={instancePath:At+"/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var nr=Gr===Lt;nr&&(qr=!0,Vr=0);const kr=Lt;if(Lt===kr)if(Array.isArray(Cr)){var rr=!0;const Wr=Cr.length;for(let jr=0;jr<Wr;jr++){let Ir=Cr[jr];const Mr=Lt;if(Lt===Lt)if(typeof Ir=="string"){if(!pattern12.test(Ir)){const on={instancePath:At+"/recipient/"+jr,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};Ut===null?Ut=[on]:Ut.push(on),Lt++}}else{const on={instancePath:At+"/recipient/"+jr,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[on]:Ut.push(on),Lt++}var rr=Mr===Lt;if(!rr)break}}else{const Wr={instancePath:At+"/recipient",schemaPath:"#/properties/recipient/oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var nr=kr===Lt;if(nr&&qr?(qr=!1,Vr=[Vr,1]):nr&&(qr=!0,Vr=1),qr)Lt=Rr,Ut!==null&&(Rr?Ut.length=Rr:Ut=null);else{const Wr={instancePath:At+"/recipient",schemaPath:"#/properties/recipient/oneOf",keyword:"oneOf",params:{passingSchemas:Vr},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++,validate42.errors=Ut,!1}var Qt=xr===Lt}else var Qt=!0;if(Qt){if(kt.contextId!==void 0){const Cr=Lt;if(typeof kt.contextId!="string")return validate42.errors=[{instancePath:At+"/contextId",schemaPath:"#/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.schema!==void 0){const Cr=Lt;if(typeof kt.schema!="string")return validate42.errors=[{instancePath:At+"/schema",schemaPath:"#/properties/schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.tags!==void 0){let Cr=kt.tags;const xr=Lt;if(Lt===xr)if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)){if(Object.keys(Cr).length<1)return validate42.errors=[{instancePath:At+"/tags",schemaPath:"#/properties/tags/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;for(const qr in Cr){let Vr=Cr[qr];const Gr=Lt,Ur=Lt;let kr=!1,Fr=null;const Wr=Lt;if(typeof Vr!="string"){const Ir={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var ar=Wr===Lt;ar&&(kr=!0,Fr=0);const jr=Lt;if(!(typeof Vr=="number"&&isFinite(Vr))){const Ir={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/1/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var ar=jr===Lt;if(ar&&kr)kr=!1,Fr=[Fr,1];else{ar&&(kr=!0,Fr=1);const Ir=Lt;if(typeof Vr!="boolean"){const Hr={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++}var ar=Ir===Lt;if(ar&&kr)kr=!1,Fr=[Fr,2];else{ar&&(kr=!0,Fr=2);const Hr=Lt;if(Lt===Hr)if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr))if(Object.keys(Vr).length<1){const on={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/3/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};Ut===null?Ut=[on]:Ut.push(on),Lt++}else{const on=Lt;for(const nn in Vr)if(nn!=="startsWith"){const fn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/3/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:nn},message:"must NOT have additional properties"};Ut===null?Ut=[fn]:Ut.push(fn),Lt++;break}if(on===Lt&&Vr.startsWith!==void 0&&typeof Vr.startsWith!="string"){const nn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/startsWith",schemaPath:"#/properties/tags/additionalProperties/oneOf/3/properties/startsWith/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[nn]:Ut.push(nn),Lt++}}else{const on={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/3/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[on]:Ut.push(on),Lt++}var ar=Hr===Lt;if(ar&&kr)kr=!1,Fr=[Fr,3];else{ar&&(kr=!0,Fr=3);const on=Lt;if(Lt===Lt)if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr))if(Object.keys(Vr).length<1){const hn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};Ut===null?Ut=[hn]:Ut.push(hn),Lt++}else{const hn=Lt;for(const Jr in Vr)if(!(Jr==="gt"||Jr==="gte"||Jr==="lt"||Jr==="lte")){const Yr={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Jr},message:"must NOT have additional properties"};Ut===null?Ut=[Yr]:Ut.push(Yr),Lt++;break}if(hn===Lt){if(Vr.gt!==void 0){const Jr=Lt,Yr=Lt,an=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.gte===void 0){const dn={};Ut===null?Ut=[dn]:Ut.push(dn),Lt++}var ir=an===Lt;if(ir){const dn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[dn]:Ut.push(dn),Lt++}else Lt=Yr,Ut!==null&&(Yr?Ut.length=Yr:Ut=null);var lr=Jr===Lt}else var lr=!0;if(lr){if(Vr.gte!==void 0){const Jr=Lt,Yr=Lt,an=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.gt===void 0){const cn={};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}var yr=an===Lt;if(yr){const cn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}else Lt=Yr,Ut!==null&&(Yr?Ut.length=Yr:Ut=null);var lr=Jr===Lt}else var lr=!0;if(lr){if(Vr.lt!==void 0){const Jr=Lt,Yr=Lt,an=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.lte===void 0){const cn={};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}var Sr=an===Lt;if(Sr){const cn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}else Lt=Yr,Ut!==null&&(Yr?Ut.length=Yr:Ut=null);var lr=Jr===Lt}else var lr=!0;if(lr){if(Vr.lte!==void 0){const Jr=Lt,Yr=Lt,an=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.lt===void 0){const cn={};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}var Ar=an===Lt;if(Ar){const cn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[cn]:Ut.push(cn),Lt++}else Lt=Yr,Ut!==null&&(Yr?Ut.length=Yr:Ut=null);var lr=Jr===Lt}else var lr=!0;if(lr){if(Vr.gt!==void 0){const Jr=Lt;if(typeof Vr.gt!="string"){const Yr={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/gt",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/gt/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Yr]:Ut.push(Yr),Lt++}var Dr=Jr===Lt}else var Dr=!0;if(Dr){if(Vr.gte!==void 0){const Jr=Lt;if(typeof Vr.gte!="string"){const an={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/gte",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/gte/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[an]:Ut.push(an),Lt++}var Dr=Jr===Lt}else var Dr=!0;if(Dr){if(Vr.lt!==void 0){const Jr=Lt;if(typeof Vr.lt!="string"){const an={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/lt",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/lt/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[an]:Ut.push(an),Lt++}var Dr=Jr===Lt}else var Dr=!0;if(Dr)if(Vr.lte!==void 0){const Jr=Lt;if(typeof Vr.lte!="string"){const an={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/lte",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/lte/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[an]:Ut.push(an),Lt++}var Dr=Jr===Lt}else var Dr=!0}}}}}}}}else{const hn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[hn]:Ut.push(hn),Lt++}var ar=on===Lt;if(ar&&kr)kr=!1,Fr=[Fr,4];else{ar&&(kr=!0,Fr=4);const hn=Lt;if(Lt===Lt)if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr))if(Object.keys(Vr).length<1){const an={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};Ut===null?Ut=[an]:Ut.push(an),Lt++}else{const an=Lt;for(const dn in Vr)if(!(dn==="gt"||dn==="gte"||dn==="lt"||dn==="lte")){const cn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:dn},message:"must NOT have additional properties"};Ut===null?Ut=[cn]:Ut.push(cn),Lt++;break}if(an===Lt){if(Vr.gt!==void 0){const dn=Lt,cn=Lt,vn=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.gte===void 0){const _n={};Ut===null?Ut=[_n]:Ut.push(_n),Lt++}var Br=vn===Lt;if(Br){const _n={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[_n]:Ut.push(_n),Lt++}else Lt=cn,Ut!==null&&(cn?Ut.length=cn:Ut=null);var Lr=dn===Lt}else var Lr=!0;if(Lr){if(Vr.gte!==void 0){const dn=Lt,cn=Lt,vn=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.gt===void 0){const Tn={};Ut===null?Ut=[Tn]:Ut.push(Tn),Lt++}var Or=vn===Lt;if(Or){const Tn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Tn]:Ut.push(Tn),Lt++}else Lt=cn,Ut!==null&&(cn?Ut.length=cn:Ut=null);var Lr=dn===Lt}else var Lr=!0;if(Lr){if(Vr.lt!==void 0){const dn=Lt,cn=Lt,vn=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.lte===void 0){const Tn={};Ut===null?Ut=[Tn]:Ut.push(Tn),Lt++}var vr=vn===Lt;if(vr){const Tn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Tn]:Ut.push(Tn),Lt++}else Lt=cn,Ut!==null&&(cn?Ut.length=cn:Ut=null);var Lr=dn===Lt}else var Lr=!0;if(Lr){if(Vr.lte!==void 0){const dn=Lt,cn=Lt,vn=Lt;if(Vr&&typeof Vr=="object"&&!Array.isArray(Vr)&&Vr.lt===void 0){const Tn={};Ut===null?Ut=[Tn]:Ut.push(Tn),Lt++}var pr=vn===Lt;if(pr){const Tn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"};Ut===null?Ut=[Tn]:Ut.push(Tn),Lt++}else Lt=cn,Ut!==null&&(cn?Ut.length=cn:Ut=null);var Lr=dn===Lt}else var Lr=!0;if(Lr){if(Vr.gt!==void 0){let dn=Vr.gt;const cn=Lt;if(!(typeof dn=="number"&&isFinite(dn))){const vn={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/gt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gt/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[vn]:Ut.push(vn),Lt++}var dr=cn===Lt}else var dr=!0;if(dr){if(Vr.gte!==void 0){let dn=Vr.gte;const cn=Lt;if(!(typeof dn=="number"&&isFinite(dn))){const _n={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/gte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gte/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[_n]:Ut.push(_n),Lt++}var dr=cn===Lt}else var dr=!0;if(dr){if(Vr.lt!==void 0){let dn=Vr.lt;const cn=Lt;if(!(typeof dn=="number"&&isFinite(dn))){const _n={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/lt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lt/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[_n]:Ut.push(_n),Lt++}var dr=cn===Lt}else var dr=!0;if(dr)if(Vr.lte!==void 0){let dn=Vr.lte;const cn=Lt;if(!(typeof dn=="number"&&isFinite(dn))){const _n={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/lte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lte/type",keyword:"type",params:{type:"number"},message:"must be number"};Ut===null?Ut=[_n]:Ut.push(_n),Lt++}var dr=cn===Lt}else var dr=!0}}}}}}}}else{const an={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[an]:Ut.push(an),Lt++}var ar=hn===Lt;ar&&kr?(kr=!1,Fr=[Fr,5]):ar&&(kr=!0,Fr=5)}}}}if(kr)Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);else{const Ir={instancePath:At+"/tags/"+qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf",keyword:"oneOf",params:{passingSchemas:Fr},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++,validate42.errors=Ut,!1}var ur=Gr===Lt;if(!ur)break}}else return validate42.errors=[{instancePath:At+"/tags",schemaPath:"#/properties/tags/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Qt=xr===Lt}else var Qt=!0;if(Qt){if(kt.recordId!==void 0){const Cr=Lt;if(typeof kt.recordId!="string")return validate42.errors=[{instancePath:At+"/recordId",schemaPath:"#/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.parentId!==void 0){const Cr=Lt;if(typeof kt.parentId!="string")return validate42.errors=[{instancePath:At+"/parentId",schemaPath:"#/properties/parentId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.published!==void 0){const Cr=Lt;if(typeof kt.published!="boolean")return validate42.errors=[{instancePath:At+"/published",schemaPath:"#/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.dataFormat!==void 0){const Cr=Lt;if(typeof kt.dataFormat!="string")return validate42.errors=[{instancePath:At+"/dataFormat",schemaPath:"#/properties/dataFormat/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.dataSize!==void 0){let Cr=kt.dataSize;const xr=Lt;if(Lt===Lt)if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)){if(Object.keys(Cr).length<1)return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const Vr=Lt;for(const Gr in Cr)if(!(Gr==="gt"||Gr==="gte"||Gr==="lt"||Gr==="lte"))return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Gr},message:"must NOT have additional properties"}],!1;if(Vr===Lt){if(Cr.gt!==void 0){const Gr=Lt,Ur=Lt,kr=Lt;if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)&&Cr.gte===void 0){const Fr={};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var $r=kr===Lt;if($r)return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);var wr=Gr===Lt}else var wr=!0;if(wr){if(Cr.gte!==void 0){const Gr=Lt,Ur=Lt,kr=Lt;if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)&&Cr.gt===void 0){const Wr={};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var Er=kr===Lt;if(Er)return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);var wr=Gr===Lt}else var wr=!0;if(wr){if(Cr.lt!==void 0){const Gr=Lt,Ur=Lt,kr=Lt;if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)&&Cr.lte===void 0){const Wr={};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var gr=kr===Lt;if(gr)return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);var wr=Gr===Lt}else var wr=!0;if(wr){if(Cr.lte!==void 0){const Gr=Lt,Ur=Lt,kr=Lt;if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)&&Cr.lt===void 0){const Wr={};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var fr=kr===Lt;if(fr)return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=Ur,Ut!==null&&(Ur?Ut.length=Ur:Ut=null);var wr=Gr===Lt}else var wr=!0;if(wr){if(Cr.gt!==void 0){let Gr=Cr.gt;const Ur=Lt;if(!(typeof Gr=="number"&&isFinite(Gr)))return validate42.errors=[{instancePath:At+"/dataSize/gt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var br=Ur===Lt}else var br=!0;if(br){if(Cr.gte!==void 0){let Gr=Cr.gte;const Ur=Lt;if(!(typeof Gr=="number"&&isFinite(Gr)))return validate42.errors=[{instancePath:At+"/dataSize/gte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var br=Ur===Lt}else var br=!0;if(br){if(Cr.lt!==void 0){let Gr=Cr.lt;const Ur=Lt;if(!(typeof Gr=="number"&&isFinite(Gr)))return validate42.errors=[{instancePath:At+"/dataSize/lt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var br=Ur===Lt}else var br=!0;if(br)if(Cr.lte!==void 0){let Gr=Cr.lte;const Ur=Lt;if(!(typeof Gr=="number"&&isFinite(Gr)))return validate42.errors=[{instancePath:At+"/dataSize/lte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var br=Ur===Lt}else var br=!0}}}}}}}}}else return validate42.errors=[{instancePath:At+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Qt=xr===Lt}else var Qt=!0;if(Qt){if(kt.dataCid!==void 0){const Cr=Lt;if(typeof kt.dataCid!="string")return validate42.errors=[{instancePath:At+"/dataCid",schemaPath:"#/properties/dataCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Qt=Cr===Lt}else var Qt=!0;if(Qt){if(kt.dateCreated!==void 0){let Cr=kt.dateCreated;const xr=Lt;if(Lt===xr)if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)){if(Object.keys(Cr).length<1)return validate42.errors=[{instancePath:At+"/dateCreated",schemaPath:"#/properties/dateCreated/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const qr=Lt;for(const Vr in Cr)if(!(Vr==="from"||Vr==="to"))return validate42.errors=[{instancePath:At+"/dateCreated",schemaPath:"#/properties/dateCreated/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Vr},message:"must NOT have additional properties"}],!1;if(qr===Lt){if(Cr.from!==void 0){let Vr=Cr.from;const Gr=Lt;if(Lt===Lt)if(typeof Vr=="string"){if(!pattern14.test(Vr))return validate42.errors=[{instancePath:At+"/dateCreated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate42.errors=[{instancePath:At+"/dateCreated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var _r=Gr===Lt}else var _r=!0;if(_r)if(Cr.to!==void 0){let Vr=Cr.to;const Gr=Lt;if(Lt===Lt)if(typeof Vr=="string"){if(!pattern14.test(Vr))return validate42.errors=[{instancePath:At+"/dateCreated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate42.errors=[{instancePath:At+"/dateCreated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var _r=Gr===Lt}else var _r=!0}}}else return validate42.errors=[{instancePath:At+"/dateCreated",schemaPath:"#/properties/dateCreated/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Qt=xr===Lt}else var Qt=!0;if(Qt){if(kt.datePublished!==void 0){let Cr=kt.datePublished;const xr=Lt;if(Lt===xr)if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)){if(Object.keys(Cr).length<1)return validate42.errors=[{instancePath:At+"/datePublished",schemaPath:"#/properties/datePublished/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const qr=Lt;for(const Vr in Cr)if(!(Vr==="from"||Vr==="to"))return validate42.errors=[{instancePath:At+"/datePublished",schemaPath:"#/properties/datePublished/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Vr},message:"must NOT have additional properties"}],!1;if(qr===Lt){if(Cr.from!==void 0){let Vr=Cr.from;const Gr=Lt;if(Lt===Lt)if(typeof Vr=="string"){if(!pattern14.test(Vr))return validate42.errors=[{instancePath:At+"/datePublished/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate42.errors=[{instancePath:At+"/datePublished/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Tr=Gr===Lt}else var Tr=!0;if(Tr)if(Cr.to!==void 0){let Vr=Cr.to;const Gr=Lt;if(Lt===Lt)if(typeof Vr=="string"){if(!pattern14.test(Vr))return validate42.errors=[{instancePath:At+"/datePublished/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate42.errors=[{instancePath:At+"/datePublished/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Tr=Gr===Lt}else var Tr=!0}}}else return validate42.errors=[{instancePath:At+"/datePublished",schemaPath:"#/properties/datePublished/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Qt=xr===Lt}else var Qt=!0;if(Qt)if(kt.dateUpdated!==void 0){let Cr=kt.dateUpdated;const xr=Lt;if(Lt===xr)if(Cr&&typeof Cr=="object"&&!Array.isArray(Cr)){if(Object.keys(Cr).length<1)return validate42.errors=[{instancePath:At+"/dateUpdated",schemaPath:"#/properties/dateUpdated/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const qr=Lt;for(const Vr in Cr)if(!(Vr==="from"||Vr==="to"))return validate42.errors=[{instancePath:At+"/dateUpdated",schemaPath:"#/properties/dateUpdated/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Vr},message:"must NOT have additional properties"}],!1;if(qr===Lt){if(Cr.from!==void 0){let Vr=Cr.from;const Gr=Lt;if(Lt===Lt)if(typeof Vr=="string"){if(!pattern14.test(Vr))return validate42.errors=[{instancePath:At+"/dateUpdated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate42.errors=[{instancePath:At+"/dateUpdated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Pr=Gr===Lt}else var Pr=!0;if(Pr)if(Cr.to!==void 0){let Vr=Cr.to;const Gr=Lt;if(Lt===Lt)if(typeof Vr=="string"){if(!pattern14.test(Vr))return validate42.errors=[{instancePath:At+"/dateUpdated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate42.errors=[{instancePath:At+"/dateUpdated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Pr=Gr===Lt}else var Pr=!0}}}else return validate42.errors=[{instancePath:At+"/dateUpdated",schemaPath:"#/properties/dateUpdated/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Qt=xr===Lt}else var Qt=!0}}}}}}}}}}}}}}}}}}}else return validate42.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate42.errors=Ut,Lt===0}validate42.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function validate40(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate40.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Qt;if(kt.descriptor===void 0&&(Qt="descriptor"))return validate40.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Qt},message:"must have required property '"+Qt+"'"}],!1;{const Xt=Lt;for(const tr in kt)if(!(tr==="authorization"||tr==="descriptor"))return validate40.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:tr},message:"must NOT have additional properties"}],!1;if(Xt===Lt){if(kt.authorization!==void 0){const tr=Lt;validate24(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate24.errors:Ut.concat(validate24.errors),Lt=Ut.length);var Vt=tr===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let tr=kt.descriptor;const rr=Lt;if(Lt===rr)if(tr&&typeof tr=="object"&&!Array.isArray(tr)){let ar;if(tr.interface===void 0&&(ar="interface")||tr.method===void 0&&(ar="method")||tr.messageTimestamp===void 0&&(ar="messageTimestamp")||tr.filter===void 0&&(ar="filter"))return validate40.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:ar},message:"must have required property '"+ar+"'"}],!1;{const ir=Lt;for(const lr in tr)if(!(lr==="interface"||lr==="method"||lr==="messageTimestamp"||lr==="filter"||lr==="pagination"||lr==="dateSort"))return validate40.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:lr},message:"must NOT have additional properties"}],!1;if(ir===Lt){if(tr.interface!==void 0){let lr=tr.interface;const yr=Lt;if(typeof lr!="string")return validate40.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(lr!=="Records")return validate40.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema53.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=yr===Lt}else var zt=!0;if(zt){if(tr.method!==void 0){let lr=tr.method;const yr=Lt;if(typeof lr!="string")return validate40.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(lr!=="Query")return validate40.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema53.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=yr===Lt}else var zt=!0;if(zt){if(tr.messageTimestamp!==void 0){let lr=tr.messageTimestamp;const yr=Lt;if(Lt===Lt)if(typeof lr=="string"){if(!pattern14.test(lr))return validate40.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate40.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=yr===Lt}else var zt=!0;if(zt){if(tr.filter!==void 0){const lr=Lt;validate42(tr.filter,{instancePath:At+"/descriptor/filter",parentData:tr,parentDataProperty:"filter",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate42.errors:Ut.concat(validate42.errors),Lt=Ut.length);var zt=lr===Lt}else var zt=!0;if(zt){if(tr.pagination!==void 0){let lr=tr.pagination;const yr=Lt;if(Lt===yr)if(lr&&typeof lr=="object"&&!Array.isArray(lr)){const Ar=Lt;for(const Dr in lr)if(!(Dr==="limit"||Dr==="cursor"))return validate40.errors=[{instancePath:At+"/descriptor/pagination",schemaPath:"#/properties/descriptor/properties/pagination/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Dr},message:"must NOT have additional properties"}],!1;if(Ar===Lt){if(lr.limit!==void 0){let Dr=lr.limit;const Br=Lt;if(Lt===Br)if(typeof Dr=="number"&&isFinite(Dr)){if(Dr<1||isNaN(Dr))return validate40.errors=[{instancePath:At+"/descriptor/pagination/limit",schemaPath:"#/properties/descriptor/properties/pagination/properties/limit/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"}],!1}else return validate40.errors=[{instancePath:At+"/descriptor/pagination/limit",schemaPath:"#/properties/descriptor/properties/pagination/properties/limit/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var Wt=Br===Lt}else var Wt=!0;if(Wt)if(lr.cursor!==void 0){let Dr=lr.cursor;const Br=Lt;if(Lt===Lt)if(Dr&&typeof Dr=="object"&&!Array.isArray(Dr)){if(Object.keys(Dr).length<1)return validate40.errors=[{instancePath:At+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let vr;if(Dr.messageCid===void 0&&(vr="messageCid")||Dr.value===void 0&&(vr="value"))return validate40.errors=[{instancePath:At+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/required",keyword:"required",params:{missingProperty:vr},message:"must have required property '"+vr+"'"}],!1;{const pr=Lt;for(const dr in Dr)if(!(dr==="messageCid"||dr==="value"))return validate40.errors=[{instancePath:At+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:dr},message:"must NOT have additional properties"}],!1;if(pr===Lt){if(Dr.messageCid!==void 0){const dr=Lt;if(typeof Dr.messageCid!="string")return validate40.errors=[{instancePath:At+"/descriptor/pagination/cursor/messageCid",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Jt=dr===Lt}else var Jt=!0;if(Jt)if(Dr.value!==void 0){let dr=Dr.value;const ur=Lt;if(typeof dr!="string"&&!(typeof dr=="number"&&isFinite(dr)))return validate40.errors=[{instancePath:At+"/descriptor/pagination/cursor/value",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/value/type",keyword:"type",params:{type:schema70.properties.value.type},message:"must be string,number"}],!1;var Jt=ur===Lt}else var Jt=!0}}}}else return validate40.errors=[{instancePath:At+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Wt=Br===Lt}else var Wt=!0}}else return validate40.errors=[{instancePath:At+"/descriptor/pagination",schemaPath:"#/properties/descriptor/properties/pagination/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=yr===Lt}else var zt=!0;if(zt)if(tr.dateSort!==void 0){let lr=tr.dateSort;const yr=Lt;if(typeof lr!="string")return validate40.errors=[{instancePath:At+"/descriptor/dateSort",schemaPath:"#/properties/descriptor/properties/dateSort/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(lr==="createdAscending"||lr==="createdDescending"||lr==="publishedAscending"||lr==="publishedDescending"))return validate40.errors=[{instancePath:At+"/descriptor/dateSort",schemaPath:"#/properties/descriptor/properties/dateSort/enum",keyword:"enum",params:{allowedValues:schema53.properties.descriptor.properties.dateSort.enum},message:"must be equal to one of the allowed values"}],!1;var zt=yr===Lt}else var zt=!0}}}}}}}else return validate40.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=rr===Lt}else var Vt=!0}}}else return validate40.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate40.errors=Ut,Lt===0}validate40.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsSubscribe$1=validate44,schema71={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-subscribe.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filter"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Subscribe"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{$ref:"https://identity.foundation/dwn/json-schemas/records-filter.json"}}}}};function validate44(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate44.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Wt;if(kt.descriptor===void 0&&(Wt="descriptor"))return validate44.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Wt},message:"must have required property '"+Wt+"'"}],!1;{const Jt=Lt;for(const Qt in kt)if(!(Qt==="authorization"||Qt==="descriptor"))return validate44.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Qt},message:"must NOT have additional properties"}],!1;if(Jt===Lt){if(kt.authorization!==void 0){const Qt=Lt;validate24(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate24.errors:Ut.concat(validate24.errors),Lt=Ut.length);var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Qt=kt.descriptor;const Xt=Lt;if(Lt===Xt)if(Qt&&typeof Qt=="object"&&!Array.isArray(Qt)){let rr;if(Qt.interface===void 0&&(rr="interface")||Qt.method===void 0&&(rr="method")||Qt.messageTimestamp===void 0&&(rr="messageTimestamp")||Qt.filter===void 0&&(rr="filter"))return validate44.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:rr},message:"must have required property '"+rr+"'"}],!1;{const nr=Lt;for(const ar in Qt)if(!(ar==="interface"||ar==="method"||ar==="messageTimestamp"||ar==="filter"))return validate44.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ar},message:"must NOT have additional properties"}],!1;if(nr===Lt){if(Qt.interface!==void 0){let ar=Qt.interface;const ir=Lt;if(typeof ar!="string")return validate44.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Records")return validate44.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema71.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.method!==void 0){let ar=Qt.method;const ir=Lt;if(typeof ar!="string")return validate44.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Subscribe")return validate44.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema71.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.messageTimestamp!==void 0){let ar=Qt.messageTimestamp;const ir=Lt;if(Lt===Lt)if(typeof ar=="string"){if(!pattern14.test(ar))return validate44.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate44.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ir===Lt}else var zt=!0;if(zt)if(Qt.filter!==void 0){const ar=Lt;validate42(Qt.filter,{instancePath:At+"/descriptor/filter",parentData:Qt,parentDataProperty:"filter",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate42.errors:Ut.concat(validate42.errors),Lt=Ut.length);var zt=ar===Lt}else var zt=!0}}}}}else return validate44.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Xt===Lt}else var Vt=!0}}}else return validate44.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate44.errors=Ut,Lt===0}validate44.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsWrite$1=validate47;function validate47(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate47.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),!validate27(kt,{instancePath:At,parentData:xt,parentDataProperty:Bt,rootData:Nt,dynamicAnchors:jt}))Ut=Ut===null?validate27.errors:Ut.concat(validate27.errors),Lt=Ut.length;else var Vt=validate27.evaluated.props;if(Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let zt;if(kt.recordId===void 0&&(zt="recordId")||kt.authorization===void 0&&(zt="authorization"))return validate47.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;if(Vt!==!0){for(const Wt in kt)if(!Vt||!Vt[Wt])return validate47.errors=[{instancePath:At,schemaPath:"#/unevaluatedProperties",keyword:"unevaluatedProperties",params:{unevaluatedProperty:Wt},message:"must NOT have unevaluated properties"}],!1}}else return validate47.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate47.errors=Ut,Lt===0}validate47.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsWriteDataEncoded=validate26,RecordsWriteUnidentified=validate27,Definitions=validate22;function validate22(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate22.evaluated;return Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)?(validate22.errors=Ut,Lt===0):(validate22.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}validate22.evaluated={dynamicProps:!1,dynamicItems:!1};const GeneralJwk=validate49;function validate49(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate49.evaluated;Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0);const Vt=Lt;let zt=!1,Wt=null;const Jt=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let yr;if(kt.crv===void 0&&(yr="crv")||kt.x===void 0&&(yr="x")){const Sr={instancePath:At,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:yr},message:"must have required property '"+yr+"'"};Ut===null?Ut=[Sr]:Ut.push(Sr),Lt++}else{if(kt.kty!==void 0){const Sr=Lt;if(kt.kty!=="EC"){const Ar={instancePath:At+"/kty",schemaPath:"#/oneOf/0/properties/kty/const",keyword:"const",params:{allowedValue:"EC"},message:"must be equal to constant"};Ut===null?Ut=[Ar]:Ut.push(Ar),Lt++}var Qt=Sr===Lt}else var Qt=!0;if(Qt){if(kt.crv!==void 0){const Sr=Lt;if(typeof kt.crv!="string"){const Dr={instancePath:At+"/crv",schemaPath:"#/oneOf/0/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var Qt=Sr===Lt}else var Qt=!0;if(Qt){if(kt.x!==void 0){const Sr=Lt;if(typeof kt.x!="string"){const Dr={instancePath:At+"/x",schemaPath:"#/oneOf/0/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var Qt=Sr===Lt}else var Qt=!0;if(Qt){if(kt.y!==void 0){const Sr=Lt;if(typeof kt.y!="string"){const Dr={instancePath:At+"/y",schemaPath:"#/oneOf/0/properties/y/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var Qt=Sr===Lt}else var Qt=!0;if(Qt)if(kt.d!==void 0){const Sr=Lt;if(typeof kt.d!="string"){const Dr={instancePath:At+"/d",schemaPath:"#/oneOf/0/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var Qt=Sr===Lt}else var Qt=!0}}}}}var nr=Jt===Lt;if(nr){zt=!0,Wt=0;var Xt={};Xt.kty=!0,Xt.crv=!0,Xt.x=!0,Xt.y=!0,Xt.d=!0}const tr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let yr;if(kt.crv===void 0&&(yr="crv")||kt.x===void 0&&(yr="x")){const Sr={instancePath:At,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:yr},message:"must have required property '"+yr+"'"};Ut===null?Ut=[Sr]:Ut.push(Sr),Lt++}else{if(kt.kty!==void 0){const Sr=Lt;if(kt.kty!=="OKP"){const Ar={instancePath:At+"/kty",schemaPath:"#/oneOf/1/properties/kty/const",keyword:"const",params:{allowedValue:"OKP"},message:"must be equal to constant"};Ut===null?Ut=[Ar]:Ut.push(Ar),Lt++}var rr=Sr===Lt}else var rr=!0;if(rr){if(kt.crv!==void 0){const Sr=Lt;if(typeof kt.crv!="string"){const Dr={instancePath:At+"/crv",schemaPath:"#/oneOf/1/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var rr=Sr===Lt}else var rr=!0;if(rr){if(kt.x!==void 0){const Sr=Lt;if(typeof kt.x!="string"){const Dr={instancePath:At+"/x",schemaPath:"#/oneOf/1/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var rr=Sr===Lt}else var rr=!0;if(rr)if(kt.d!==void 0){const Sr=Lt;if(typeof kt.d!="string"){const Dr={instancePath:At+"/d",schemaPath:"#/oneOf/1/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}var rr=Sr===Lt}else var rr=!0}}}}var nr=tr===Lt;if(nr&&zt)zt=!1,Wt=[Wt,1];else{nr&&(zt=!0,Wt=1,Xt!==!0&&(Xt=Xt||{},Xt.kty=!0,Xt.crv=!0,Xt.x=!0,Xt.d=!0));const yr=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Ar;if(kt.n===void 0&&(Ar="n")||kt.e===void 0&&(Ar="e")){const Dr={instancePath:At,schemaPath:"#/oneOf/2/required",keyword:"required",params:{missingProperty:Ar},message:"must have required property '"+Ar+"'"};Ut===null?Ut=[Dr]:Ut.push(Dr),Lt++}else{if(kt.kty!==void 0){const Dr=Lt;if(kt.kty!=="RSA"){const Br={instancePath:At+"/kty",schemaPath:"#/oneOf/2/properties/kty/const",keyword:"const",params:{allowedValue:"RSA"},message:"must be equal to constant"};Ut===null?Ut=[Br]:Ut.push(Br),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.n!==void 0){const Dr=Lt;if(typeof kt.n!="string"){const Lr={instancePath:At+"/n",schemaPath:"#/oneOf/2/properties/n/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.e!==void 0){const Dr=Lt;if(typeof kt.e!="string"){const Lr={instancePath:At+"/e",schemaPath:"#/oneOf/2/properties/e/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.d!==void 0){const Dr=Lt;if(typeof kt.d!="string"){const Lr={instancePath:At+"/d",schemaPath:"#/oneOf/2/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.p!==void 0){const Dr=Lt;if(typeof kt.p!="string"){const Lr={instancePath:At+"/p",schemaPath:"#/oneOf/2/properties/p/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.q!==void 0){const Dr=Lt;if(typeof kt.q!="string"){const Lr={instancePath:At+"/q",schemaPath:"#/oneOf/2/properties/q/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.dp!==void 0){const Dr=Lt;if(typeof kt.dp!="string"){const Lr={instancePath:At+"/dp",schemaPath:"#/oneOf/2/properties/dp/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.dq!==void 0){const Dr=Lt;if(typeof kt.dq!="string"){const Lr={instancePath:At+"/dq",schemaPath:"#/oneOf/2/properties/dq/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar){if(kt.qi!==void 0){const Dr=Lt;if(typeof kt.qi!="string"){const Lr={instancePath:At+"/qi",schemaPath:"#/oneOf/2/properties/qi/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}var ar=Dr===Lt}else var ar=!0;if(ar)if(kt.oth!==void 0){let Dr=kt.oth;const Br=Lt;if(!(Dr&&typeof Dr=="object"&&!Array.isArray(Dr))){const Or={instancePath:At+"/oth",schemaPath:"#/oneOf/2/properties/oth/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Or]:Ut.push(Or),Lt++}var ar=Br===Lt}else var ar=!0}}}}}}}}}}var nr=yr===Lt;if(nr&&zt)zt=!1,Wt=[Wt,2];else{nr&&(zt=!0,Wt=2,Xt!==!0&&(Xt=Xt||{},Xt.kty=!0,Xt.n=!0,Xt.e=!0,Xt.d=!0,Xt.p=!0,Xt.q=!0,Xt.dp=!0,Xt.dq=!0,Xt.qi=!0,Xt.oth=!0));const Ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Br;if(kt.k===void 0&&(Br="k")){const Lr={instancePath:At,schemaPath:"#/oneOf/3/required",keyword:"required",params:{missingProperty:Br},message:"must have required property '"+Br+"'"};Ut===null?Ut=[Lr]:Ut.push(Lr),Lt++}else{if(kt.kty!==void 0){const Lr=Lt;if(kt.kty!=="oct"){const Or={instancePath:At+"/kty",schemaPath:"#/oneOf/3/properties/kty/const",keyword:"const",params:{allowedValue:"oct"},message:"must be equal to constant"};Ut===null?Ut=[Or]:Ut.push(Or),Lt++}var ir=Lr===Lt}else var ir=!0;if(ir)if(kt.k!==void 0){const Lr=Lt;if(typeof kt.k!="string"){const vr={instancePath:At+"/k",schemaPath:"#/oneOf/3/properties/k/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[vr]:Ut.push(vr),Lt++}var ir=Lr===Lt}else var ir=!0}}var nr=Ar===Lt;nr&&zt?(zt=!1,Wt=[Wt,3]):nr&&(zt=!0,Wt=3,Xt!==!0&&(Xt=Xt||{},Xt.kty=!0,Xt.k=!0))}}if(zt)Lt=Vt,Ut!==null&&(Vt?Ut.length=Vt:Ut=null);else{const yr={instancePath:At,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:Wt},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[yr]:Ut.push(yr),Lt++,validate49.errors=Ut,!1}if(Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let yr;if(kt.kty===void 0&&(yr="kty"))return validate49.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:yr},message:"must have required property '"+yr+"'"}],!1;if(Xt!==!0&&(Xt=Xt||{},Xt.alg=!0,Xt.kid=!0,Xt.kty=!0,Xt.crv=!0,Xt.use=!0,Xt.key_ops=!0,Xt.x5u=!0,Xt.x5c=!0,Xt.x5t=!0,Xt["x5t#S256"]=!0),kt.alg!==void 0){const Sr=Lt;if(typeof kt.alg!="string")return validate49.errors=[{instancePath:At+"/alg",schemaPath:"#/properties/alg/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.kid!==void 0){const Sr=Lt;if(typeof kt.kid!="string")return validate49.errors=[{instancePath:At+"/kid",schemaPath:"#/properties/kid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.kty!==void 0){let Sr=kt.kty;const Ar=Lt;if(!(Sr==="EC"||Sr==="RSA"||Sr==="oct"||Sr==="OKP"))return validate49.errors=[{instancePath:At+"/kty",schemaPath:"#/properties/kty/enum",keyword:"enum",params:{allowedValues:schema43.properties.kty.enum},message:"must be equal to one of the allowed values"}],!1;var lr=Ar===Lt}else var lr=!0;if(lr){if(kt.crv!==void 0){const Sr=Lt;if(typeof kt.crv!="string")return validate49.errors=[{instancePath:At+"/crv",schemaPath:"#/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.use!==void 0){const Sr=Lt;if(typeof kt.use!="string")return validate49.errors=[{instancePath:At+"/use",schemaPath:"#/properties/use/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.key_ops!==void 0){const Sr=Lt;if(typeof kt.key_ops!="string")return validate49.errors=[{instancePath:At+"/key_ops",schemaPath:"#/properties/key_ops/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.x5u!==void 0){const Sr=Lt;if(typeof kt.x5u!="string")return validate49.errors=[{instancePath:At+"/x5u",schemaPath:"#/properties/x5u/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.x5c!==void 0){const Sr=Lt;if(typeof kt.x5c!="string")return validate49.errors=[{instancePath:At+"/x5c",schemaPath:"#/properties/x5c/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr){if(kt.x5t!==void 0){const Sr=Lt;if(typeof kt.x5t!="string")return validate49.errors=[{instancePath:At+"/x5t",schemaPath:"#/properties/x5t/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0;if(lr)if(kt["x5t#S256"]!==void 0){const Sr=Lt;if(typeof kt["x5t#S256"]!="string")return validate49.errors=[{instancePath:At+"/x5t#S256",schemaPath:"#/properties/x5t%23S256/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var lr=Sr===Lt}else var lr=!0}}}}}}}}}else return validate49.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate49.errors=Ut,Ht.props=Xt,Lt===0}validate49.evaluated={dynamicProps:!0,dynamicItems:!1};const GeneralJws=validate21,JwkVerificationMethod=validate50,schema75={$id:"https://identity.foundation/dwn/json-schemas/jwk-verification-method.json",$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",additionalProperties:!1,required:["id","type","controller","publicKeyJwk"],properties:{id:{type:"string"},type:{enum:["JsonWebKey","JsonWebKey2020"]},controller:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},publicKeyJwk:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"}}};function validate50(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate50.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let zt;if(kt.id===void 0&&(zt="id")||kt.type===void 0&&(zt="type")||kt.controller===void 0&&(zt="controller")||kt.publicKeyJwk===void 0&&(zt="publicKeyJwk"))return validate50.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;{const Wt=Lt;for(const Jt in kt)if(!(Jt==="id"||Jt==="type"||Jt==="controller"||Jt==="publicKeyJwk"))return validate50.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Jt},message:"must NOT have additional properties"}],!1;if(Wt===Lt){if(kt.id!==void 0){const Jt=Lt;if(typeof kt.id!="string")return validate50.errors=[{instancePath:At+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.type!==void 0){let Jt=kt.type;const Qt=Lt;if(!(Jt==="JsonWebKey"||Jt==="JsonWebKey2020"))return validate50.errors=[{instancePath:At+"/type",schemaPath:"#/properties/type/enum",keyword:"enum",params:{allowedValues:schema75.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var Vt=Qt===Lt}else var Vt=!0;if(Vt){if(kt.controller!==void 0){let Jt=kt.controller;const Qt=Lt;if(Lt===Lt)if(typeof Jt=="string"){if(!pattern12.test(Jt))return validate50.errors=[{instancePath:At+"/controller",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return validate50.errors=[{instancePath:At+"/controller",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.publicKeyJwk!==void 0){const Jt=Lt;validate33(kt.publicKeyJwk,{instancePath:At+"/publicKeyJwk",parentData:kt,parentDataProperty:"publicKeyJwk",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate33.errors:Ut.concat(validate33.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0}}}}}else return validate50.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate50.errors=Ut,Lt===0}validate50.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const MessagesFilter=validate52,schema77={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-filter.json",type:"object",additionalProperties:!1,minProperties:1,properties:{interface:{enum:["Protocols","Records"],type:"string"},method:{enum:["Configure","Delete","Write"],type:"string"},protocol:{type:"string"},messageTimestamp:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}}}};function validate52(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate52.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)){if(Object.keys(kt).length<1)return validate52.errors=[{instancePath:At,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;for(const Wt in kt)if(!(Wt==="interface"||Wt==="method"||Wt==="protocol"||Wt==="messageTimestamp"))return validate52.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wt},message:"must NOT have additional properties"}],!1;{if(kt.interface!==void 0){let Wt=kt.interface;const Jt=Lt;if(typeof Wt!="string")return validate52.errors=[{instancePath:At+"/interface",schemaPath:"#/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(Wt==="Protocols"||Wt==="Records"))return validate52.errors=[{instancePath:At+"/interface",schemaPath:"#/properties/interface/enum",keyword:"enum",params:{allowedValues:schema77.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.method!==void 0){let Wt=kt.method;const Jt=Lt;if(typeof Wt!="string")return validate52.errors=[{instancePath:At+"/method",schemaPath:"#/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(Wt==="Configure"||Wt==="Delete"||Wt==="Write"))return validate52.errors=[{instancePath:At+"/method",schemaPath:"#/properties/method/enum",keyword:"enum",params:{allowedValues:schema77.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.protocol!==void 0){const Wt=Lt;if(typeof kt.protocol!="string")return validate52.errors=[{instancePath:At+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt)if(kt.messageTimestamp!==void 0){let Wt=kt.messageTimestamp;const Jt=Lt;if(Wt&&typeof Wt=="object"&&!Array.isArray(Wt)){if(Object.keys(Wt).length<1)return validate52.errors=[{instancePath:At+"/messageTimestamp",schemaPath:"#/properties/messageTimestamp/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;for(const Xt in Wt)if(!(Xt==="from"||Xt==="to"))return validate52.errors=[{instancePath:At+"/messageTimestamp",schemaPath:"#/properties/messageTimestamp/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Xt},message:"must NOT have additional properties"}],!1;{if(Wt.from!==void 0){let Xt=Wt.from;const tr=Lt;if(typeof Xt=="string"){if(!pattern14.test(Xt))return validate52.errors=[{instancePath:At+"/messageTimestamp/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate52.errors=[{instancePath:At+"/messageTimestamp/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=tr===Lt}else var zt=!0;if(zt)if(Wt.to!==void 0){let Xt=Wt.to;const tr=Lt;if(typeof Xt=="string"){if(!pattern14.test(Xt))return validate52.errors=[{instancePath:At+"/messageTimestamp/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate52.errors=[{instancePath:At+"/messageTimestamp/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=tr===Lt}else var zt=!0}}else return validate52.errors=[{instancePath:At+"/messageTimestamp",schemaPath:"#/properties/messageTimestamp/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Jt===Lt}else var Vt=!0}}}}else return validate52.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate52.errors=Ut,Lt===0}validate52.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const MessagesQuery$1=validate53,schema80={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-query.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filters"],properties:{interface:{enum:["Messages"],type:"string"},method:{enum:["Query"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filters:{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/messages-filter.json"}},cursor:{$ref:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json"}}}}};function validate53(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate53.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Qt;if(kt.authorization===void 0&&(Qt="authorization")||kt.descriptor===void 0&&(Qt="descriptor"))return validate53.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Qt},message:"must have required property '"+Qt+"'"}],!1;{const Xt=Lt;for(const tr in kt)if(!(tr==="authorization"||tr==="descriptor"))return validate53.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:tr},message:"must NOT have additional properties"}],!1;if(Xt===Lt){if(kt.authorization!==void 0){const tr=Lt;validate20(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate20.errors:Ut.concat(validate20.errors),Lt=Ut.length);var Vt=tr===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let tr=kt.descriptor;const rr=Lt;if(Lt===rr)if(tr&&typeof tr=="object"&&!Array.isArray(tr)){let ar;if(tr.interface===void 0&&(ar="interface")||tr.method===void 0&&(ar="method")||tr.messageTimestamp===void 0&&(ar="messageTimestamp")||tr.filters===void 0&&(ar="filters"))return validate53.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:ar},message:"must have required property '"+ar+"'"}],!1;{const ir=Lt;for(const lr in tr)if(!(lr==="interface"||lr==="method"||lr==="messageTimestamp"||lr==="filters"||lr==="cursor"))return validate53.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:lr},message:"must NOT have additional properties"}],!1;if(ir===Lt){if(tr.interface!==void 0){let lr=tr.interface;const yr=Lt;if(typeof lr!="string")return validate53.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(lr!=="Messages")return validate53.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema80.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=yr===Lt}else var zt=!0;if(zt){if(tr.method!==void 0){let lr=tr.method;const yr=Lt;if(typeof lr!="string")return validate53.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(lr!=="Query")return validate53.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema80.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=yr===Lt}else var zt=!0;if(zt){if(tr.messageTimestamp!==void 0){let lr=tr.messageTimestamp;const yr=Lt;if(Lt===Lt)if(typeof lr=="string"){if(!pattern14.test(lr))return validate53.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate53.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=yr===Lt}else var zt=!0;if(zt){if(tr.filters!==void 0){let lr=tr.filters;const yr=Lt;if(Lt===yr)if(Array.isArray(lr)){var Wt=!0;const Ar=lr.length;for(let Dr=0;Dr<Ar;Dr++){const Br=Lt;validate52(lr[Dr],{instancePath:At+"/descriptor/filters/"+Dr,parentData:lr,parentDataProperty:Dr,rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate52.errors:Ut.concat(validate52.errors),Lt=Ut.length);var Wt=Br===Lt;if(!Wt)break}}else return validate53.errors=[{instancePath:At+"/descriptor/filters",schemaPath:"#/properties/descriptor/properties/filters/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var zt=yr===Lt}else var zt=!0;if(zt)if(tr.cursor!==void 0){let lr=tr.cursor;const yr=Lt;if(Lt===Lt)if(lr&&typeof lr=="object"&&!Array.isArray(lr)){if(Object.keys(lr).length<1)return validate53.errors=[{instancePath:At+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let Dr;if(lr.messageCid===void 0&&(Dr="messageCid")||lr.value===void 0&&(Dr="value"))return validate53.errors=[{instancePath:At+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/required",keyword:"required",params:{missingProperty:Dr},message:"must have required property '"+Dr+"'"}],!1;{const Br=Lt;for(const Lr in lr)if(!(Lr==="messageCid"||Lr==="value"))return validate53.errors=[{instancePath:At+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Lr},message:"must NOT have additional properties"}],!1;if(Br===Lt){if(lr.messageCid!==void 0){const Lr=Lt;if(typeof lr.messageCid!="string")return validate53.errors=[{instancePath:At+"/descriptor/cursor/messageCid",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Jt=Lr===Lt}else var Jt=!0;if(Jt)if(lr.value!==void 0){let Lr=lr.value;const Or=Lt;if(typeof Lr!="string"&&!(typeof Lr=="number"&&isFinite(Lr)))return validate53.errors=[{instancePath:At+"/descriptor/cursor/value",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/value/type",keyword:"type",params:{type:schema70.properties.value.type},message:"must be string,number"}],!1;var Jt=Or===Lt}else var Jt=!0}}}}else return validate53.errors=[{instancePath:At+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=yr===Lt}else var zt=!0}}}}}}else return validate53.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=rr===Lt}else var Vt=!0}}}else return validate53.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate53.errors=Ut,Lt===0}validate53.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const MessagesRead$1=validate56,schema83={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-read.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp"],properties:{interface:{enum:["Messages"],type:"string"},method:{enum:["Read"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},messageCid:{type:"string"}}}}};function validate56(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate56.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Wt;if(kt.authorization===void 0&&(Wt="authorization")||kt.descriptor===void 0&&(Wt="descriptor"))return validate56.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Wt},message:"must have required property '"+Wt+"'"}],!1;{const Jt=Lt;for(const Qt in kt)if(!(Qt==="authorization"||Qt==="descriptor"))return validate56.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Qt},message:"must NOT have additional properties"}],!1;if(Jt===Lt){if(kt.authorization!==void 0){const Qt=Lt;validate20(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate20.errors:Ut.concat(validate20.errors),Lt=Ut.length);var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Qt=kt.descriptor;const Xt=Lt;if(Lt===Xt)if(Qt&&typeof Qt=="object"&&!Array.isArray(Qt)){let rr;if(Qt.interface===void 0&&(rr="interface")||Qt.method===void 0&&(rr="method")||Qt.messageTimestamp===void 0&&(rr="messageTimestamp"))return validate56.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:rr},message:"must have required property '"+rr+"'"}],!1;{const nr=Lt;for(const ar in Qt)if(!(ar==="interface"||ar==="method"||ar==="messageTimestamp"||ar==="messageCid"))return validate56.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ar},message:"must NOT have additional properties"}],!1;if(nr===Lt){if(Qt.interface!==void 0){let ar=Qt.interface;const ir=Lt;if(typeof ar!="string")return validate56.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Messages")return validate56.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema83.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.method!==void 0){let ar=Qt.method;const ir=Lt;if(typeof ar!="string")return validate56.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Read")return validate56.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema83.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.messageTimestamp!==void 0){let ar=Qt.messageTimestamp;const ir=Lt;if(Lt===Lt)if(typeof ar=="string"){if(!pattern14.test(ar))return validate56.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate56.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ir===Lt}else var zt=!0;if(zt)if(Qt.messageCid!==void 0){const ar=Lt;if(typeof Qt.messageCid!="string")return validate56.errors=[{instancePath:At+"/descriptor/messageCid",schemaPath:"#/properties/descriptor/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ar===Lt}else var zt=!0}}}}}else return validate56.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Xt===Lt}else var Vt=!0}}}else return validate56.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate56.errors=Ut,Lt===0}validate56.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const MessagesSubscribe$1=validate58,schema85={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-subscribe.json",type:"object",additionalProperties:!1,required:["descriptor","authorization"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filters"],properties:{interface:{enum:["Messages"],type:"string"},method:{enum:["Subscribe"],type:"string"},messageTimestamp:{type:"string"},filters:{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/messages-filter.json"}}}}}};function validate58(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate58.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Jt;if(kt.descriptor===void 0&&(Jt="descriptor")||kt.authorization===void 0&&(Jt="authorization"))return validate58.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Jt},message:"must have required property '"+Jt+"'"}],!1;{const Qt=Lt;for(const Xt in kt)if(!(Xt==="authorization"||Xt==="descriptor"))return validate58.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Xt},message:"must NOT have additional properties"}],!1;if(Qt===Lt){if(kt.authorization!==void 0){const Xt=Lt;validate20(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate20.errors:Ut.concat(validate20.errors),Lt=Ut.length);var Vt=Xt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Xt=kt.descriptor;const tr=Lt;if(Lt===tr)if(Xt&&typeof Xt=="object"&&!Array.isArray(Xt)){let nr;if(Xt.interface===void 0&&(nr="interface")||Xt.method===void 0&&(nr="method")||Xt.messageTimestamp===void 0&&(nr="messageTimestamp")||Xt.filters===void 0&&(nr="filters"))return validate58.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:nr},message:"must have required property '"+nr+"'"}],!1;{const ar=Lt;for(const ir in Xt)if(!(ir==="interface"||ir==="method"||ir==="messageTimestamp"||ir==="filters"))return validate58.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ir},message:"must NOT have additional properties"}],!1;if(ar===Lt){if(Xt.interface!==void 0){let ir=Xt.interface;const lr=Lt;if(typeof ir!="string")return validate58.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ir!=="Messages")return validate58.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema85.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=lr===Lt}else var zt=!0;if(zt){if(Xt.method!==void 0){let ir=Xt.method;const lr=Lt;if(typeof ir!="string")return validate58.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ir!=="Subscribe")return validate58.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema85.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=lr===Lt}else var zt=!0;if(zt){if(Xt.messageTimestamp!==void 0){const ir=Lt;if(typeof Xt.messageTimestamp!="string")return validate58.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"#/properties/descriptor/properties/messageTimestamp/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ir===Lt}else var zt=!0;if(zt)if(Xt.filters!==void 0){let ir=Xt.filters;const lr=Lt;if(Lt===lr)if(Array.isArray(ir)){var Wt=!0;const Sr=ir.length;for(let Ar=0;Ar<Sr;Ar++){const Dr=Lt;validate52(ir[Ar],{instancePath:At+"/descriptor/filters/"+Ar,parentData:ir,parentDataProperty:Ar,rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate52.errors:Ut.concat(validate52.errors),Lt=Ut.length);var Wt=Dr===Lt;if(!Wt)break}}else return validate58.errors=[{instancePath:At+"/descriptor/filters",schemaPath:"#/properties/descriptor/properties/filters/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var zt=lr===Lt}else var zt=!0}}}}}else return validate58.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=tr===Lt}else var Vt=!0}}}else return validate58.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate58.errors=Ut,Lt===0}validate58.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const NumberRangeFilter=validate61;function validate61(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate61.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){if(Object.keys(kt).length<1)return validate61.errors=[{instancePath:At,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const tr=Lt;for(const rr in kt)if(!(rr==="gt"||rr==="gte"||rr==="lt"||rr==="lte"))return validate61.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:rr},message:"must NOT have additional properties"}],!1;if(tr===Lt){if(kt.gt!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.gte===void 0){const ir={};Ut===null?Ut=[ir]:Ut.push(ir),Lt++}var Vt=ar===Lt;if(Vt)return validate61.errors=[{instancePath:At,schemaPath:"#/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.gte!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.gt===void 0){const lr={};Ut===null?Ut=[lr]:Ut.push(lr),Lt++}var Wt=ar===Lt;if(Wt)return validate61.errors=[{instancePath:At,schemaPath:"#/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.lt!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.lte===void 0){const lr={};Ut===null?Ut=[lr]:Ut.push(lr),Lt++}var Jt=ar===Lt;if(Jt)return validate61.errors=[{instancePath:At,schemaPath:"#/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.lte!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.lt===void 0){const lr={};Ut===null?Ut=[lr]:Ut.push(lr),Lt++}var Qt=ar===Lt;if(Qt)return validate61.errors=[{instancePath:At,schemaPath:"#/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.gt!==void 0){let rr=kt.gt;const nr=Lt;if(!(typeof rr=="number"&&isFinite(rr)))return validate61.errors=[{instancePath:At+"/gt",schemaPath:"#/properties/gt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var Xt=nr===Lt}else var Xt=!0;if(Xt){if(kt.gte!==void 0){let rr=kt.gte;const nr=Lt;if(!(typeof rr=="number"&&isFinite(rr)))return validate61.errors=[{instancePath:At+"/gte",schemaPath:"#/properties/gte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var Xt=nr===Lt}else var Xt=!0;if(Xt){if(kt.lt!==void 0){let rr=kt.lt;const nr=Lt;if(!(typeof rr=="number"&&isFinite(rr)))return validate61.errors=[{instancePath:At+"/lt",schemaPath:"#/properties/lt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var Xt=nr===Lt}else var Xt=!0;if(Xt)if(kt.lte!==void 0){let rr=kt.lte;const nr=Lt;if(!(typeof rr=="number"&&isFinite(rr)))return validate61.errors=[{instancePath:At+"/lte",schemaPath:"#/properties/lte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var Xt=nr===Lt}else var Xt=!0}}}}}}}}}else return validate61.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate61.errors=Ut,Lt===0}validate61.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const PaginationCursor=validate62;function validate62(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate62.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)){if(Object.keys(kt).length<1)return validate62.errors=[{instancePath:At,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let zt;if(kt.messageCid===void 0&&(zt="messageCid")||kt.value===void 0&&(zt="value"))return validate62.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;for(const Wt in kt)if(!(Wt==="messageCid"||Wt==="value"))return validate62.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wt},message:"must NOT have additional properties"}],!1;{if(kt.messageCid!==void 0){const Wt=Lt;if(typeof kt.messageCid!="string")return validate62.errors=[{instancePath:At+"/messageCid",schemaPath:"#/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt)if(kt.value!==void 0){let Wt=kt.value;const Jt=Lt;if(typeof Wt!="string"&&!(typeof Wt=="number"&&isFinite(Wt)))return validate62.errors=[{instancePath:At+"/value",schemaPath:"#/properties/value/type",keyword:"type",params:{type:schema70.properties.value.type},message:"must be string,number"}],!1;var Vt=Jt===Lt}else var Vt=!0}}}else return validate62.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate62.errors=Ut,Lt===0}validate62.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const PermissionGrantData=validate63,schema103={type:"object",additionalProperties:!1,properties:{publication:{enum:["Required","Prohibited"],type:"string"}}};function validate65(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate65.evaluated;Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0);const Vt=Lt;let zt=!1,Wt=null;const Jt=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let vr;if(kt.interface===void 0&&(vr="interface")||kt.method===void 0&&(vr="method")){const pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/required",keyword:"required",params:{missingProperty:vr},message:"must have required property '"+vr+"'"};Ut===null?Ut=[pr]:Ut.push(pr),Lt++}else{const pr=Lt;for(const dr in kt)if(!(dr==="interface"||dr==="method"||dr==="protocol")){const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:dr},message:"must NOT have additional properties"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++;break}if(pr===Lt){if(kt.interface!==void 0){const dr=Lt;if(kt.interface!=="Messages"){const ur={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}var Xt=dr===Lt}else var Xt=!0;if(Xt){if(kt.method!==void 0){const dr=Lt;if(kt.method!=="Query"){const $r={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var Xt=dr===Lt}else var Xt=!0;if(Xt)if(kt.protocol!==void 0){const dr=Lt;if(typeof kt.protocol!="string"){const $r={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var Xt=dr===Lt}else var Xt=!0}}}}else{const vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[vr]:Ut.push(vr),Lt++}var ir=Jt===Lt;if(ir){zt=!0,Wt=0;var tr=!0}const rr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let vr;if(kt.interface===void 0&&(vr="interface")||kt.method===void 0&&(vr="method")){const pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/required",keyword:"required",params:{missingProperty:vr},message:"must have required property '"+vr+"'"};Ut===null?Ut=[pr]:Ut.push(pr),Lt++}else{const pr=Lt;for(const dr in kt)if(!(dr==="interface"||dr==="method"||dr==="protocol")){const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:dr},message:"must NOT have additional properties"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++;break}if(pr===Lt){if(kt.interface!==void 0){const dr=Lt;if(kt.interface!=="Messages"){const ur={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}var ar=dr===Lt}else var ar=!0;if(ar){if(kt.method!==void 0){const dr=Lt;if(kt.method!=="Read"){const $r={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var ar=dr===Lt}else var ar=!0;if(ar)if(kt.protocol!==void 0){const dr=Lt;if(typeof kt.protocol!="string"){const $r={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var ar=dr===Lt}else var ar=!0}}}}else{const vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[vr]:Ut.push(vr),Lt++}var ir=rr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,1];else{ir&&(zt=!0,Wt=1,tr!==!0&&(tr=!0));const vr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let ur;if(kt.interface===void 0&&(ur="interface")||kt.method===void 0&&(ur="method")){const $r={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/required",keyword:"required",params:{missingProperty:ur},message:"must have required property '"+ur+"'"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}else{const $r=Lt;for(const wr in kt)if(!(wr==="interface"||wr==="method"||wr==="protocol")){const Er={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:wr},message:"must NOT have additional properties"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++;break}if($r===Lt){if(kt.interface!==void 0){const wr=Lt;if(kt.interface!=="Messages"){const Er={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++}var lr=wr===Lt}else var lr=!0;if(lr){if(kt.method!==void 0){const wr=Lt;if(kt.method!=="Subscribe"){const gr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var lr=wr===Lt}else var lr=!0;if(lr)if(kt.protocol!==void 0){const wr=Lt;if(typeof kt.protocol!="string"){const gr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var lr=wr===Lt}else var lr=!0}}}}else{const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}var ir=vr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,2];else{ir&&(zt=!0,Wt=2,tr!==!0&&(tr=!0));const ur=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Er;if(kt.interface===void 0&&(Er="interface")||kt.method===void 0&&(Er="method")){const gr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/required",keyword:"required",params:{missingProperty:Er},message:"must have required property '"+Er+"'"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}else{const gr=Lt;for(const fr in kt)if(!(fr==="interface"||fr==="method"||fr==="protocol")){const br={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:fr},message:"must NOT have additional properties"};Ut===null?Ut=[br]:Ut.push(br),Lt++;break}if(gr===Lt){if(kt.interface!==void 0){const fr=Lt;if(kt.interface!=="Protocols"){const br={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Protocols"},message:"must be equal to constant"};Ut===null?Ut=[br]:Ut.push(br),Lt++}var yr=fr===Lt}else var yr=!0;if(yr){if(kt.method!==void 0){const fr=Lt;if(kt.method!=="Configure"){const _r={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/properties/method/const",keyword:"const",params:{allowedValue:"Configure"},message:"must be equal to constant"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}var yr=fr===Lt}else var yr=!0;if(yr)if(kt.protocol!==void 0){const fr=Lt;if(typeof kt.protocol!="string"){const _r={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}var yr=fr===Lt}else var yr=!0}}}}else{const Er={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++}var ir=ur===Lt;if(ir&&zt)zt=!1,Wt=[Wt,3];else{ir&&(zt=!0,Wt=3,tr!==!0&&(tr=!0));const Er=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let br;if(kt.interface===void 0&&(br="interface")||kt.method===void 0&&(br="method")){const _r={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/required",keyword:"required",params:{missingProperty:br},message:"must have required property '"+br+"'"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}else{const _r=Lt;for(const Tr in kt)if(!(Tr==="interface"||Tr==="method"||Tr==="protocol")){const Pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Tr},message:"must NOT have additional properties"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++;break}if(_r===Lt){if(kt.interface!==void 0){const Tr=Lt;if(kt.interface!=="Protocols"){const Pr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Protocols"},message:"must be equal to constant"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++}var Sr=Tr===Lt}else var Sr=!0;if(Sr){if(kt.method!==void 0){const Tr=Lt;if(kt.method!=="Query"){const Nr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}var Sr=Tr===Lt}else var Sr=!0;if(Sr)if(kt.protocol!==void 0){const Tr=Lt;if(typeof kt.protocol!="string"){const Nr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}var Sr=Tr===Lt}else var Sr=!0}}}}else{const br={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[br]:Ut.push(br),Lt++}var ir=Er===Lt;if(ir&&zt)zt=!1,Wt=[Wt,4];else{ir&&(zt=!0,Wt=4,tr!==!0&&(tr=!0));const br=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Pr;if(kt.interface===void 0&&(Pr="interface")||kt.method===void 0&&(Pr="method")){const Nr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/required",keyword:"required",params:{missingProperty:Pr},message:"must have required property '"+Pr+"'"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}else{const Nr=Lt;for(const Cr in kt)if(!(Cr==="interface"||Cr==="method"||Cr==="protocol"||Cr==="contextId"||Cr==="protocolPath")){const xr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Cr},message:"must NOT have additional properties"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++;break}if(Nr===Lt){if(kt.interface!==void 0){const Cr=Lt;if(kt.interface!=="Records"){const xr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar){if(kt.method!==void 0){const Cr=Lt;if(kt.method!=="Read"){const Rr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar){if(kt.protocol!==void 0){const Cr=Lt;if(typeof kt.protocol!="string"){const Rr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar){if(kt.contextId!==void 0){const Cr=Lt;if(typeof kt.contextId!="string"){const Rr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar)if(kt.protocolPath!==void 0){const Cr=Lt;if(typeof kt.protocolPath!="string"){const Rr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0}}}}}}else{const Pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++}var ir=br===Lt;if(ir&&zt)zt=!1,Wt=[Wt,5];else{ir&&(zt=!0,Wt=5,tr!==!0&&(tr=!0));const Pr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let xr;if(kt.interface===void 0&&(xr="interface")||kt.method===void 0&&(xr="method")){const Rr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/required",keyword:"required",params:{missingProperty:xr},message:"must have required property '"+xr+"'"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}else{const Rr=Lt;for(const qr in kt)if(!(qr==="interface"||qr==="method"||qr==="protocol"||qr==="contextId"||qr==="protocolPath")){const Vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:qr},message:"must NOT have additional properties"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++;break}if(Rr===Lt){if(kt.interface!==void 0){const qr=Lt;if(kt.interface!=="Records"){const Vr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr){if(kt.method!==void 0){const qr=Lt;if(kt.method!=="Delete"){const Gr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/method/const",keyword:"const",params:{allowedValue:"Delete"},message:"must be equal to constant"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr){if(kt.protocol!==void 0){const qr=Lt;if(typeof kt.protocol!="string"){const Gr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr){if(kt.contextId!==void 0){const qr=Lt;if(typeof kt.contextId!="string"){const Gr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr)if(kt.protocolPath!==void 0){const qr=Lt;if(typeof kt.protocolPath!="string"){const Gr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0}}}}}}else{const xr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++}var ir=Pr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,6];else{ir&&(zt=!0,Wt=6,tr!==!0&&(tr=!0));const xr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Vr;if(kt.interface===void 0&&(Vr="interface")||kt.method===void 0&&(Vr="method")){const Gr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/required",keyword:"required",params:{missingProperty:Vr},message:"must have required property '"+Vr+"'"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}else{const Gr=Lt;for(const Ur in kt)if(!(Ur==="interface"||Ur==="method"||Ur==="protocol"||Ur==="contextId"||Ur==="protocolPath")){const kr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Ur},message:"must NOT have additional properties"};Ut===null?Ut=[kr]:Ut.push(kr),Lt++;break}if(Gr===Lt){if(kt.interface!==void 0){const Ur=Lt;if(kt.interface!=="Records"){const kr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[kr]:Ut.push(kr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br){if(kt.method!==void 0){const Ur=Lt;if(kt.method!=="Write"){const Fr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/method/const",keyword:"const",params:{allowedValue:"Write"},message:"must be equal to constant"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br){if(kt.protocol!==void 0){const Ur=Lt;if(typeof kt.protocol!="string"){const Fr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br){if(kt.contextId!==void 0){const Ur=Lt;if(typeof kt.contextId!="string"){const Fr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br)if(kt.protocolPath!==void 0){const Ur=Lt;if(typeof kt.protocolPath!="string"){const Fr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0}}}}}}else{const Vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var ir=xr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,7];else{ir&&(zt=!0,Wt=7,tr!==!0&&(tr=!0));const Vr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let kr;if(kt.interface===void 0&&(kr="interface")||kt.method===void 0&&(kr="method")){const Fr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/required",keyword:"required",params:{missingProperty:kr},message:"must have required property '"+kr+"'"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}else{const Fr=Lt;for(const Wr in kt)if(!(Wr==="interface"||Wr==="method"||Wr==="protocol"||Wr==="contextId"||Wr==="protocolPath")){const jr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wr},message:"must NOT have additional properties"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++;break}if(Fr===Lt){if(kt.interface!==void 0){const Wr=Lt;if(kt.interface!=="Records"){const jr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr){if(kt.method!==void 0){const Wr=Lt;if(kt.method!=="Query"){const Ir={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr){if(kt.protocol!==void 0){const Wr=Lt;if(typeof kt.protocol!="string"){const Ir={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr){if(kt.contextId!==void 0){const Wr=Lt;if(typeof kt.contextId!="string"){const Ir={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr)if(kt.protocolPath!==void 0){const Wr=Lt;if(typeof kt.protocolPath!="string"){const Ir={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0}}}}}}else{const kr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[kr]:Ut.push(kr),Lt++}var ir=Vr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,8];else{ir&&(zt=!0,Wt=8,tr!==!0&&(tr=!0));const kr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let jr;if(kt.interface===void 0&&(jr="interface")||kt.method===void 0&&(jr="method")){const Ir={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/required",keyword:"required",params:{missingProperty:jr},message:"must have required property '"+jr+"'"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}else{const Ir=Lt;for(const Mr in kt)if(!(Mr==="interface"||Mr==="method"||Mr==="protocol"||Mr==="contextId"||Mr==="protocolPath")){const Hr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Mr},message:"must NOT have additional properties"};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++;break}if(Ir===Lt){if(kt.interface!==void 0){const Mr=Lt;if(kt.interface!=="Records"){const Hr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or){if(kt.method!==void 0){const Mr=Lt;if(kt.method!=="Subscribe"){const Qr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or){if(kt.protocol!==void 0){const Mr=Lt;if(typeof kt.protocol!="string"){const Qr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or){if(kt.contextId!==void 0){const Mr=Lt;if(typeof kt.contextId!="string"){const Qr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or)if(kt.protocolPath!==void 0){const Mr=Lt;if(typeof kt.protocolPath!="string"){const Qr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0}}}}}}else{const jr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var ir=kr===Lt;ir&&zt?(zt=!1,Wt=[Wt,9]):ir&&(zt=!0,Wt=9,tr!==!0&&(tr=!0))}}}}}}}}if(zt)Lt=Vt,Ut!==null&&(Vt?Ut.length=Vt:Ut=null);else{const vr={instancePath:At,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:Wt},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[vr]:Ut.push(vr),Lt++,validate65.errors=Ut,!1}return validate65.errors=Ut,Ht.props=tr,Lt===0}validate65.evaluated={dynamicProps:!0,dynamicItems:!1};function validate63(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate63.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let zt;if(kt.dateExpires===void 0&&(zt="dateExpires")||kt.scope===void 0&&(zt="scope"))return validate63.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;{const Wt=Lt;for(const Jt in kt)if(!(Jt==="description"||Jt==="dateExpires"||Jt==="requestId"||Jt==="delegated"||Jt==="scope"||Jt==="conditions"))return validate63.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Jt},message:"must NOT have additional properties"}],!1;if(Wt===Lt){if(kt.description!==void 0){const Jt=Lt;if(typeof kt.description!="string")return validate63.errors=[{instancePath:At+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.dateExpires!==void 0){let Jt=kt.dateExpires;const Qt=Lt;if(Lt===Lt)if(typeof Jt=="string"){if(!pattern14.test(Jt))return validate63.errors=[{instancePath:At+"/dateExpires",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate63.errors=[{instancePath:At+"/dateExpires",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Qt===Lt}else var Vt=!0;if(Vt){if(kt.requestId!==void 0){const Jt=Lt;if(typeof kt.requestId!="string")return validate63.errors=[{instancePath:At+"/requestId",schemaPath:"#/properties/requestId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.delegated!==void 0){const Jt=Lt;if(typeof kt.delegated!="boolean")return validate63.errors=[{instancePath:At+"/delegated",schemaPath:"#/properties/delegated/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.scope!==void 0){const Jt=Lt;validate65(kt.scope,{instancePath:At+"/scope",parentData:kt,parentDataProperty:"scope",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate65.errors:Ut.concat(validate65.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0;if(Vt)if(kt.conditions!==void 0){let Jt=kt.conditions;const Qt=Lt;if(Lt===Lt)if(Jt&&typeof Jt=="object"&&!Array.isArray(Jt)){const rr=Lt;for(const nr in Jt)if(nr!=="publication")return validate63.errors=[{instancePath:At+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:nr},message:"must NOT have additional properties"}],!1;if(rr===Lt&&Jt.publication!==void 0){let nr=Jt.publication;if(typeof nr!="string")return validate63.errors=[{instancePath:At+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(nr==="Required"||nr==="Prohibited"))return validate63.errors=[{instancePath:At+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/enum",keyword:"enum",params:{allowedValues:schema103.properties.publication.enum},message:"must be equal to one of the allowed values"}],!1}}else return validate63.errors=[{instancePath:At+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Qt===Lt}else var Vt=!0}}}}}}}else return validate63.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate63.errors=Ut,Lt===0}validate63.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const PermissionRequestData=validate68;function validate69(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate69.evaluated;Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0);const Vt=Lt;let zt=!1,Wt=null;const Jt=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let vr;if(kt.interface===void 0&&(vr="interface")||kt.method===void 0&&(vr="method")){const pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/required",keyword:"required",params:{missingProperty:vr},message:"must have required property '"+vr+"'"};Ut===null?Ut=[pr]:Ut.push(pr),Lt++}else{const pr=Lt;for(const dr in kt)if(!(dr==="interface"||dr==="method"||dr==="protocol")){const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:dr},message:"must NOT have additional properties"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++;break}if(pr===Lt){if(kt.interface!==void 0){const dr=Lt;if(kt.interface!=="Messages"){const ur={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}var Xt=dr===Lt}else var Xt=!0;if(Xt){if(kt.method!==void 0){const dr=Lt;if(kt.method!=="Query"){const $r={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var Xt=dr===Lt}else var Xt=!0;if(Xt)if(kt.protocol!==void 0){const dr=Lt;if(typeof kt.protocol!="string"){const $r={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var Xt=dr===Lt}else var Xt=!0}}}}else{const vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[vr]:Ut.push(vr),Lt++}var ir=Jt===Lt;if(ir){zt=!0,Wt=0;var tr=!0}const rr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let vr;if(kt.interface===void 0&&(vr="interface")||kt.method===void 0&&(vr="method")){const pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/required",keyword:"required",params:{missingProperty:vr},message:"must have required property '"+vr+"'"};Ut===null?Ut=[pr]:Ut.push(pr),Lt++}else{const pr=Lt;for(const dr in kt)if(!(dr==="interface"||dr==="method"||dr==="protocol")){const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:dr},message:"must NOT have additional properties"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++;break}if(pr===Lt){if(kt.interface!==void 0){const dr=Lt;if(kt.interface!=="Messages"){const ur={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}var ar=dr===Lt}else var ar=!0;if(ar){if(kt.method!==void 0){const dr=Lt;if(kt.method!=="Read"){const $r={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var ar=dr===Lt}else var ar=!0;if(ar)if(kt.protocol!==void 0){const dr=Lt;if(typeof kt.protocol!="string"){const $r={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}var ar=dr===Lt}else var ar=!0}}}}else{const vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[vr]:Ut.push(vr),Lt++}var ir=rr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,1];else{ir&&(zt=!0,Wt=1,tr!==!0&&(tr=!0));const vr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let ur;if(kt.interface===void 0&&(ur="interface")||kt.method===void 0&&(ur="method")){const $r={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/required",keyword:"required",params:{missingProperty:ur},message:"must have required property '"+ur+"'"};Ut===null?Ut=[$r]:Ut.push($r),Lt++}else{const $r=Lt;for(const wr in kt)if(!(wr==="interface"||wr==="method"||wr==="protocol")){const Er={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:wr},message:"must NOT have additional properties"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++;break}if($r===Lt){if(kt.interface!==void 0){const wr=Lt;if(kt.interface!=="Messages"){const Er={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++}var lr=wr===Lt}else var lr=!0;if(lr){if(kt.method!==void 0){const wr=Lt;if(kt.method!=="Subscribe"){const gr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var lr=wr===Lt}else var lr=!0;if(lr)if(kt.protocol!==void 0){const wr=Lt;if(typeof kt.protocol!="string"){const gr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}var lr=wr===Lt}else var lr=!0}}}}else{const ur={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[ur]:Ut.push(ur),Lt++}var ir=vr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,2];else{ir&&(zt=!0,Wt=2,tr!==!0&&(tr=!0));const ur=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Er;if(kt.interface===void 0&&(Er="interface")||kt.method===void 0&&(Er="method")){const gr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/required",keyword:"required",params:{missingProperty:Er},message:"must have required property '"+Er+"'"};Ut===null?Ut=[gr]:Ut.push(gr),Lt++}else{const gr=Lt;for(const fr in kt)if(!(fr==="interface"||fr==="method"||fr==="protocol")){const br={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:fr},message:"must NOT have additional properties"};Ut===null?Ut=[br]:Ut.push(br),Lt++;break}if(gr===Lt){if(kt.interface!==void 0){const fr=Lt;if(kt.interface!=="Protocols"){const br={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Protocols"},message:"must be equal to constant"};Ut===null?Ut=[br]:Ut.push(br),Lt++}var yr=fr===Lt}else var yr=!0;if(yr){if(kt.method!==void 0){const fr=Lt;if(kt.method!=="Configure"){const _r={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/properties/method/const",keyword:"const",params:{allowedValue:"Configure"},message:"must be equal to constant"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}var yr=fr===Lt}else var yr=!0;if(yr)if(kt.protocol!==void 0){const fr=Lt;if(typeof kt.protocol!="string"){const _r={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}var yr=fr===Lt}else var yr=!0}}}}else{const Er={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-configure-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Er]:Ut.push(Er),Lt++}var ir=ur===Lt;if(ir&&zt)zt=!1,Wt=[Wt,3];else{ir&&(zt=!0,Wt=3,tr!==!0&&(tr=!0));const Er=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let br;if(kt.interface===void 0&&(br="interface")||kt.method===void 0&&(br="method")){const _r={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/required",keyword:"required",params:{missingProperty:br},message:"must have required property '"+br+"'"};Ut===null?Ut=[_r]:Ut.push(_r),Lt++}else{const _r=Lt;for(const Tr in kt)if(!(Tr==="interface"||Tr==="method"||Tr==="protocol")){const Pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Tr},message:"must NOT have additional properties"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++;break}if(_r===Lt){if(kt.interface!==void 0){const Tr=Lt;if(kt.interface!=="Protocols"){const Pr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Protocols"},message:"must be equal to constant"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++}var Sr=Tr===Lt}else var Sr=!0;if(Sr){if(kt.method!==void 0){const Tr=Lt;if(kt.method!=="Query"){const Nr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}var Sr=Tr===Lt}else var Sr=!0;if(Sr)if(kt.protocol!==void 0){const Tr=Lt;if(typeof kt.protocol!="string"){const Nr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}var Sr=Tr===Lt}else var Sr=!0}}}}else{const br={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[br]:Ut.push(br),Lt++}var ir=Er===Lt;if(ir&&zt)zt=!1,Wt=[Wt,4];else{ir&&(zt=!0,Wt=4,tr!==!0&&(tr=!0));const br=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Pr;if(kt.interface===void 0&&(Pr="interface")||kt.method===void 0&&(Pr="method")){const Nr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/required",keyword:"required",params:{missingProperty:Pr},message:"must have required property '"+Pr+"'"};Ut===null?Ut=[Nr]:Ut.push(Nr),Lt++}else{const Nr=Lt;for(const Cr in kt)if(!(Cr==="interface"||Cr==="method"||Cr==="protocol"||Cr==="contextId"||Cr==="protocolPath")){const xr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Cr},message:"must NOT have additional properties"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++;break}if(Nr===Lt){if(kt.interface!==void 0){const Cr=Lt;if(kt.interface!=="Records"){const xr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar){if(kt.method!==void 0){const Cr=Lt;if(kt.method!=="Read"){const Rr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar){if(kt.protocol!==void 0){const Cr=Lt;if(typeof kt.protocol!="string"){const Rr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar){if(kt.contextId!==void 0){const Cr=Lt;if(typeof kt.contextId!="string"){const Rr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0;if(Ar)if(kt.protocolPath!==void 0){const Cr=Lt;if(typeof kt.protocolPath!="string"){const Rr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var Ar=Cr===Lt}else var Ar=!0}}}}}}else{const Pr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Pr]:Ut.push(Pr),Lt++}var ir=br===Lt;if(ir&&zt)zt=!1,Wt=[Wt,5];else{ir&&(zt=!0,Wt=5,tr!==!0&&(tr=!0));const Pr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let xr;if(kt.interface===void 0&&(xr="interface")||kt.method===void 0&&(xr="method")){const Rr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/required",keyword:"required",params:{missingProperty:xr},message:"must have required property '"+xr+"'"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}else{const Rr=Lt;for(const qr in kt)if(!(qr==="interface"||qr==="method"||qr==="protocol"||qr==="contextId"||qr==="protocolPath")){const Vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:qr},message:"must NOT have additional properties"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++;break}if(Rr===Lt){if(kt.interface!==void 0){const qr=Lt;if(kt.interface!=="Records"){const Vr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr){if(kt.method!==void 0){const qr=Lt;if(kt.method!=="Delete"){const Gr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/method/const",keyword:"const",params:{allowedValue:"Delete"},message:"must be equal to constant"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr){if(kt.protocol!==void 0){const qr=Lt;if(typeof kt.protocol!="string"){const Gr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr){if(kt.contextId!==void 0){const qr=Lt;if(typeof kt.contextId!="string"){const Gr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0;if(Dr)if(kt.protocolPath!==void 0){const qr=Lt;if(typeof kt.protocolPath!="string"){const Gr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Dr=qr===Lt}else var Dr=!0}}}}}}else{const xr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++}var ir=Pr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,6];else{ir&&(zt=!0,Wt=6,tr!==!0&&(tr=!0));const xr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Vr;if(kt.interface===void 0&&(Vr="interface")||kt.method===void 0&&(Vr="method")){const Gr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/required",keyword:"required",params:{missingProperty:Vr},message:"must have required property '"+Vr+"'"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}else{const Gr=Lt;for(const Ur in kt)if(!(Ur==="interface"||Ur==="method"||Ur==="protocol"||Ur==="contextId"||Ur==="protocolPath")){const kr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Ur},message:"must NOT have additional properties"};Ut===null?Ut=[kr]:Ut.push(kr),Lt++;break}if(Gr===Lt){if(kt.interface!==void 0){const Ur=Lt;if(kt.interface!=="Records"){const kr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[kr]:Ut.push(kr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br){if(kt.method!==void 0){const Ur=Lt;if(kt.method!=="Write"){const Fr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/method/const",keyword:"const",params:{allowedValue:"Write"},message:"must be equal to constant"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br){if(kt.protocol!==void 0){const Ur=Lt;if(typeof kt.protocol!="string"){const Fr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br){if(kt.contextId!==void 0){const Ur=Lt;if(typeof kt.contextId!="string"){const Fr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0;if(Br)if(kt.protocolPath!==void 0){const Ur=Lt;if(typeof kt.protocolPath!="string"){const Fr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}var Br=Ur===Lt}else var Br=!0}}}}}}else{const Vr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var ir=xr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,7];else{ir&&(zt=!0,Wt=7,tr!==!0&&(tr=!0));const Vr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let kr;if(kt.interface===void 0&&(kr="interface")||kt.method===void 0&&(kr="method")){const Fr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/required",keyword:"required",params:{missingProperty:kr},message:"must have required property '"+kr+"'"};Ut===null?Ut=[Fr]:Ut.push(Fr),Lt++}else{const Fr=Lt;for(const Wr in kt)if(!(Wr==="interface"||Wr==="method"||Wr==="protocol"||Wr==="contextId"||Wr==="protocolPath")){const jr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wr},message:"must NOT have additional properties"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++;break}if(Fr===Lt){if(kt.interface!==void 0){const Wr=Lt;if(kt.interface!=="Records"){const jr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr){if(kt.method!==void 0){const Wr=Lt;if(kt.method!=="Query"){const Ir={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr){if(kt.protocol!==void 0){const Wr=Lt;if(typeof kt.protocol!="string"){const Ir={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr){if(kt.contextId!==void 0){const Wr=Lt;if(typeof kt.contextId!="string"){const Ir={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0;if(Lr)if(kt.protocolPath!==void 0){const Wr=Lt;if(typeof kt.protocolPath!="string"){const Ir={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}var Lr=Wr===Lt}else var Lr=!0}}}}}}else{const kr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[kr]:Ut.push(kr),Lt++}var ir=Vr===Lt;if(ir&&zt)zt=!1,Wt=[Wt,8];else{ir&&(zt=!0,Wt=8,tr!==!0&&(tr=!0));const kr=Lt;if(Lt===Lt)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let jr;if(kt.interface===void 0&&(jr="interface")||kt.method===void 0&&(jr="method")){const Ir={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/required",keyword:"required",params:{missingProperty:jr},message:"must have required property '"+jr+"'"};Ut===null?Ut=[Ir]:Ut.push(Ir),Lt++}else{const Ir=Lt;for(const Mr in kt)if(!(Mr==="interface"||Mr==="method"||Mr==="protocol"||Mr==="contextId"||Mr==="protocolPath")){const Hr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Mr},message:"must NOT have additional properties"};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++;break}if(Ir===Lt){if(kt.interface!==void 0){const Mr=Lt;if(kt.interface!=="Records"){const Hr={instancePath:At+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};Ut===null?Ut=[Hr]:Ut.push(Hr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or){if(kt.method!==void 0){const Mr=Lt;if(kt.method!=="Subscribe"){const Qr={instancePath:At+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or){if(kt.protocol!==void 0){const Mr=Lt;if(typeof kt.protocol!="string"){const Qr={instancePath:At+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or){if(kt.contextId!==void 0){const Mr=Lt;if(typeof kt.contextId!="string"){const Qr={instancePath:At+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0;if(Or)if(kt.protocolPath!==void 0){const Mr=Lt;if(typeof kt.protocolPath!="string"){const Qr={instancePath:At+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Qr]:Ut.push(Qr),Lt++}var Or=Mr===Lt}else var Or=!0}}}}}}else{const jr={instancePath:At,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var ir=kr===Lt;ir&&zt?(zt=!1,Wt=[Wt,9]):ir&&(zt=!0,Wt=9,tr!==!0&&(tr=!0))}}}}}}}}if(zt)Lt=Vt,Ut!==null&&(Vt?Ut.length=Vt:Ut=null);else{const vr={instancePath:At,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:Wt},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[vr]:Ut.push(vr),Lt++,validate69.errors=Ut,!1}return validate69.errors=Ut,Ht.props=tr,Lt===0}validate69.evaluated={dynamicProps:!0,dynamicItems:!1};function validate68(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate68.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let zt;if(kt.delegated===void 0&&(zt="delegated")||kt.scope===void 0&&(zt="scope"))return validate68.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;{const Wt=Lt;for(const Jt in kt)if(!(Jt==="description"||Jt==="delegated"||Jt==="scope"||Jt==="conditions"))return validate68.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Jt},message:"must NOT have additional properties"}],!1;if(Wt===Lt){if(kt.description!==void 0){const Jt=Lt;if(typeof kt.description!="string")return validate68.errors=[{instancePath:At+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.delegated!==void 0){const Jt=Lt;if(typeof kt.delegated!="boolean")return validate68.errors=[{instancePath:At+"/delegated",schemaPath:"#/properties/delegated/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var Vt=Jt===Lt}else var Vt=!0;if(Vt){if(kt.scope!==void 0){const Jt=Lt;validate69(kt.scope,{instancePath:At+"/scope",parentData:kt,parentDataProperty:"scope",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate69.errors:Ut.concat(validate69.errors),Lt=Ut.length);var Vt=Jt===Lt}else var Vt=!0;if(Vt)if(kt.conditions!==void 0){let Jt=kt.conditions;const Qt=Lt;if(Lt===Lt)if(Jt&&typeof Jt=="object"&&!Array.isArray(Jt)){const rr=Lt;for(const nr in Jt)if(nr!=="publication")return validate68.errors=[{instancePath:At+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:nr},message:"must NOT have additional properties"}],!1;if(rr===Lt&&Jt.publication!==void 0){let nr=Jt.publication;if(typeof nr!="string")return validate68.errors=[{instancePath:At+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(nr==="Required"||nr==="Prohibited"))return validate68.errors=[{instancePath:At+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/enum",keyword:"enum",params:{allowedValues:schema103.properties.publication.enum},message:"must be equal to one of the allowed values"}],!1}}else return validate68.errors=[{instancePath:At+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Qt===Lt}else var Vt=!0}}}}}else return validate68.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate68.errors=Ut,Lt===0}validate68.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const PermissionRevocationData=validate71;function validate71(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate71.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)){for(const Vt in kt)if(Vt!=="description")return validate71.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Vt},message:"must NOT have additional properties"}],!1;if(kt.description!==void 0&&typeof kt.description!="string")return validate71.errors=[{instancePath:At+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1}else return validate71.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate71.errors=Ut,Lt===0}validate71.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const PermissionsDefinitions=validate64;function validate64(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate64.evaluated;return Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)?(validate64.errors=Ut,Lt===0):(validate64.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}validate64.evaluated={dynamicProps:!1,dynamicItems:!1};const PermissionsScopes=validate66;function validate66(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate66.evaluated;return Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)?(validate66.errors=Ut,Lt===0):(validate66.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}validate66.evaluated={dynamicProps:!1,dynamicItems:!1};const ProtocolDefinition=validate72,pattern37=new RegExp(".*","u"),schema119={$id:"https://identity.foundation/dwn/json-schemas/protocol-rule-set.json",$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",additionalProperties:!1,properties:{$encryption:{type:"object",additionalProperties:!1,properties:{rootKeyId:{type:"string"},publicKeyJwk:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"}},required:["rootKeyId","publicKeyJwk"]},$actions:{type:"array",minItems:1,items:{type:"object",oneOf:[{required:["who","can"],additionalProperties:!1,properties:{who:{type:"string",enum:["anyone","author","recipient"]},of:{type:"string"},can:{type:"array",minItems:1,items:{type:"string",enum:["co-delete","co-prune","co-update","create","delete","prune","read","update"]}}}},{required:["role","can"],properties:{role:{$comment:"Must be the protocol path of a role record type",type:"string"},can:{type:"array",minItems:1,items:{type:"string",enum:["co-delete","co-update","create","delete","query","subscribe","read","update"]}}}}]}},$role:{$comment:"When `true`, this turns a record into `role` that may be used within a context/sub-context",type:"boolean"},$size:{type:"object",additionalProperties:!1,properties:{min:{type:"number",minimum:0},max:{type:"number",minimum:0}}},$tags:{type:"object",minProperties:1,properties:{$requiredTags:{type:"array",items:{type:"string"}},$allowUndefinedTags:{type:"boolean"}},patternProperties:{"^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$":{type:"object",additionalProperties:!1,properties:{type:{enum:["string","number","integer","boolean","array"]},items:{type:"object",properties:{type:{enum:["string","number","integer"]}},patternProperties:{"^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength)$":{}}},contains:{type:"object",properties:{type:{enum:["string","number","integer"]}},patternProperties:{"^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength)$":{}}}},patternProperties:{"^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength|minItems|maxItems|uniqueItems|minContains|maxContains)$":{}}}}}},patternProperties:{"^[^$].*$":{$ref:"https://identity.foundation/dwn/json-schemas/protocol-rule-set.json"}}},pattern39=new RegExp("^[^$].*$","u"),pattern40=new RegExp("^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$","u"),pattern41=new RegExp("^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength|minItems|maxItems|uniqueItems|minContains|maxContains)$","u"),pattern42=new RegExp("^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength)$","u"),wrapper2={validate:validate73};function validate73(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate73.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){const vr=Lt;for(const pr in kt)if(!(pr==="$encryption"||pr==="$actions"||pr==="$role"||pr==="$size"||pr==="$tags"||pattern39.test(pr)))return validate73.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:pr},message:"must NOT have additional properties"}],!1;if(vr===Lt){if(kt.$encryption!==void 0){let pr=kt.$encryption;const dr=Lt;if(Lt===dr)if(pr&&typeof pr=="object"&&!Array.isArray(pr)){let ur;if(pr.rootKeyId===void 0&&(ur="rootKeyId")||pr.publicKeyJwk===void 0&&(ur="publicKeyJwk"))return validate73.errors=[{instancePath:At+"/$encryption",schemaPath:"#/properties/%24encryption/required",keyword:"required",params:{missingProperty:ur},message:"must have required property '"+ur+"'"}],!1;{const $r=Lt;for(const wr in pr)if(!(wr==="rootKeyId"||wr==="publicKeyJwk"))return validate73.errors=[{instancePath:At+"/$encryption",schemaPath:"#/properties/%24encryption/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:wr},message:"must NOT have additional properties"}],!1;if($r===Lt){if(pr.rootKeyId!==void 0){const wr=Lt;if(typeof pr.rootKeyId!="string")return validate73.errors=[{instancePath:At+"/$encryption/rootKeyId",schemaPath:"#/properties/%24encryption/properties/rootKeyId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=wr===Lt}else var Vt=!0;if(Vt)if(pr.publicKeyJwk!==void 0){const wr=Lt;validate33(pr.publicKeyJwk,{instancePath:At+"/$encryption/publicKeyJwk",parentData:pr,parentDataProperty:"publicKeyJwk",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate33.errors:Ut.concat(validate33.errors),Lt=Ut.length);var Vt=wr===Lt}else var Vt=!0}}}else return validate73.errors=[{instancePath:At+"/$encryption",schemaPath:"#/properties/%24encryption/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=dr===Lt}else var zt=!0;if(zt){if(kt.$actions!==void 0){let pr=kt.$actions;const dr=Lt;if(Lt===dr)if(Array.isArray(pr)){if(pr.length<1)return validate73.errors=[{instancePath:At+"/$actions",schemaPath:"#/properties/%24actions/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var Wt=!0;const $r=pr.length;for(let wr=0;wr<$r;wr++){let Er=pr[wr];const gr=Lt;if(!(Er&&typeof Er=="object"&&!Array.isArray(Er)))return validate73.errors=[{instancePath:At+"/$actions/"+wr,schemaPath:"#/properties/%24actions/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;const fr=Lt;let br=!1,_r=null;const Tr=Lt;if(Er&&typeof Er=="object"&&!Array.isArray(Er)){let Cr;if(Er.who===void 0&&(Cr="who")||Er.can===void 0&&(Cr="can")){const xr={instancePath:At+"/$actions/"+wr,schemaPath:"#/properties/%24actions/items/oneOf/0/required",keyword:"required",params:{missingProperty:Cr},message:"must have required property '"+Cr+"'"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++}else{const xr=Lt;for(const Rr in Er)if(!(Rr==="who"||Rr==="of"||Rr==="can")){const qr={instancePath:At+"/$actions/"+wr,schemaPath:"#/properties/%24actions/items/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Rr},message:"must NOT have additional properties"};Ut===null?Ut=[qr]:Ut.push(qr),Lt++;break}if(xr===Lt){if(Er.who!==void 0){let Rr=Er.who;const qr=Lt;if(typeof Rr!="string"){const Vr={instancePath:At+"/$actions/"+wr+"/who",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/who/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}if(!(Rr==="anyone"||Rr==="author"||Rr==="recipient")){const Vr={instancePath:At+"/$actions/"+wr+"/who",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/who/enum",keyword:"enum",params:{allowedValues:schema119.properties.$actions.items.oneOf[0].properties.who.enum},message:"must be equal to one of the allowed values"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var Jt=qr===Lt}else var Jt=!0;if(Jt){if(Er.of!==void 0){const Rr=Lt;if(typeof Er.of!="string"){const Vr={instancePath:At+"/$actions/"+wr+"/of",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/of/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var Jt=Rr===Lt}else var Jt=!0;if(Jt)if(Er.can!==void 0){let Rr=Er.can;const qr=Lt;if(Lt===qr)if(Array.isArray(Rr))if(Rr.length<1){const Gr={instancePath:At+"/$actions/"+wr+"/can",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}else{var Qt=!0;const Gr=Rr.length;for(let Ur=0;Ur<Gr;Ur++){let kr=Rr[Ur];const Fr=Lt;if(typeof kr!="string"){const jr={instancePath:At+"/$actions/"+wr+"/can/"+Ur,schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/items/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}if(!(kr==="co-delete"||kr==="co-prune"||kr==="co-update"||kr==="create"||kr==="delete"||kr==="prune"||kr==="read"||kr==="update")){const jr={instancePath:At+"/$actions/"+wr+"/can/"+Ur,schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/items/enum",keyword:"enum",params:{allowedValues:schema119.properties.$actions.items.oneOf[0].properties.can.items.enum},message:"must be equal to one of the allowed values"};Ut===null?Ut=[jr]:Ut.push(jr),Lt++}var Qt=Fr===Lt;if(!Qt)break}}else{const Gr={instancePath:At+"/$actions/"+wr+"/can",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/type",keyword:"type",params:{type:"array"},message:"must be array"};Ut===null?Ut=[Gr]:Ut.push(Gr),Lt++}var Jt=qr===Lt}else var Jt=!0}}}}var nr=Tr===Lt;if(nr){br=!0,_r=0;var Xt=!0}const Pr=Lt;if(Er&&typeof Er=="object"&&!Array.isArray(Er)){let Cr;if(Er.role===void 0&&(Cr="role")||Er.can===void 0&&(Cr="can")){const xr={instancePath:At+"/$actions/"+wr,schemaPath:"#/properties/%24actions/items/oneOf/1/required",keyword:"required",params:{missingProperty:Cr},message:"must have required property '"+Cr+"'"};Ut===null?Ut=[xr]:Ut.push(xr),Lt++}else{if(Er.role!==void 0){const xr=Lt;if(typeof Er.role!="string"){const Rr={instancePath:At+"/$actions/"+wr+"/role",schemaPath:"#/properties/%24actions/items/oneOf/1/properties/role/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Rr]:Ut.push(Rr),Lt++}var tr=xr===Lt}else var tr=!0;if(tr)if(Er.can!==void 0){let xr=Er.can;const Rr=Lt;if(Lt===Rr)if(Array.isArray(xr))if(xr.length<1){const Vr={instancePath:At+"/$actions/"+wr+"/can",schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}else{var rr=!0;const Vr=xr.length;for(let Gr=0;Gr<Vr;Gr++){let Ur=xr[Gr];const kr=Lt;if(typeof Ur!="string"){const Wr={instancePath:At+"/$actions/"+wr+"/can/"+Gr,schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/items/type",keyword:"type",params:{type:"string"},message:"must be string"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}if(!(Ur==="co-delete"||Ur==="co-update"||Ur==="create"||Ur==="delete"||Ur==="query"||Ur==="subscribe"||Ur==="read"||Ur==="update")){const Wr={instancePath:At+"/$actions/"+wr+"/can/"+Gr,schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/items/enum",keyword:"enum",params:{allowedValues:schema119.properties.$actions.items.oneOf[1].properties.can.items.enum},message:"must be equal to one of the allowed values"};Ut===null?Ut=[Wr]:Ut.push(Wr),Lt++}var rr=kr===Lt;if(!rr)break}}else{const Vr={instancePath:At+"/$actions/"+wr+"/can",schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/type",keyword:"type",params:{type:"array"},message:"must be array"};Ut===null?Ut=[Vr]:Ut.push(Vr),Lt++}var tr=Rr===Lt}else var tr=!0}}var nr=Pr===Lt;if(nr&&br?(br=!1,_r=[_r,1]):nr&&(br=!0,_r=1,Xt!==!0&&(Xt=Xt||{},Xt.role=!0,Xt.can=!0)),br)Lt=fr,Ut!==null&&(fr?Ut.length=fr:Ut=null);else{const Cr={instancePath:At+"/$actions/"+wr,schemaPath:"#/properties/%24actions/items/oneOf",keyword:"oneOf",params:{passingSchemas:_r},message:"must match exactly one schema in oneOf"};return Ut===null?Ut=[Cr]:Ut.push(Cr),Lt++,validate73.errors=Ut,!1}var Wt=gr===Lt;if(!Wt)break}}}else return validate73.errors=[{instancePath:At+"/$actions",schemaPath:"#/properties/%24actions/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var zt=dr===Lt}else var zt=!0;if(zt){if(kt.$role!==void 0){const pr=Lt;if(typeof kt.$role!="boolean")return validate73.errors=[{instancePath:At+"/$role",schemaPath:"#/properties/%24role/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var zt=pr===Lt}else var zt=!0;if(zt){if(kt.$size!==void 0){let pr=kt.$size;const dr=Lt;if(Lt===dr)if(pr&&typeof pr=="object"&&!Array.isArray(pr)){const $r=Lt;for(const wr in pr)if(!(wr==="min"||wr==="max"))return validate73.errors=[{instancePath:At+"/$size",schemaPath:"#/properties/%24size/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:wr},message:"must NOT have additional properties"}],!1;if($r===Lt){if(pr.min!==void 0){let wr=pr.min;const Er=Lt;if(Lt===Er)if(typeof wr=="number"&&isFinite(wr)){if(wr<0||isNaN(wr))return validate73.errors=[{instancePath:At+"/$size/min",schemaPath:"#/properties/%24size/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1}else return validate73.errors=[{instancePath:At+"/$size/min",schemaPath:"#/properties/%24size/properties/min/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var ar=Er===Lt}else var ar=!0;if(ar)if(pr.max!==void 0){let wr=pr.max;const Er=Lt;if(Lt===Er)if(typeof wr=="number"&&isFinite(wr)){if(wr<0||isNaN(wr))return validate73.errors=[{instancePath:At+"/$size/max",schemaPath:"#/properties/%24size/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1}else return validate73.errors=[{instancePath:At+"/$size/max",schemaPath:"#/properties/%24size/properties/max/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var ar=Er===Lt}else var ar=!0}}else return validate73.errors=[{instancePath:At+"/$size",schemaPath:"#/properties/%24size/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=dr===Lt}else var zt=!0;if(zt){if(kt.$tags!==void 0){let pr=kt.$tags;const dr=Lt;if(Lt===dr)if(pr&&typeof pr=="object"&&!Array.isArray(pr)){if(Object.keys(pr).length<1)return validate73.errors=[{instancePath:At+"/$tags",schemaPath:"#/properties/%24tags/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;if(pr.$requiredTags!==void 0){let $r=pr.$requiredTags;const wr=Lt;if(Lt===wr)if(Array.isArray($r)){var ir=!0;const Er=$r.length;for(let gr=0;gr<Er;gr++){const fr=Lt;if(typeof $r[gr]!="string")return validate73.errors=[{instancePath:At+"/$tags/$requiredTags/"+gr,schemaPath:"#/properties/%24tags/properties/%24requiredTags/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var ir=fr===Lt;if(!ir)break}}else return validate73.errors=[{instancePath:At+"/$tags/$requiredTags",schemaPath:"#/properties/%24tags/properties/%24requiredTags/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var lr=wr===Lt}else var lr=!0;if(lr){if(pr.$allowUndefinedTags!==void 0){const $r=Lt;if(typeof pr.$allowUndefinedTags!="boolean")return validate73.errors=[{instancePath:At+"/$tags/$allowUndefinedTags",schemaPath:"#/properties/%24tags/properties/%24allowUndefinedTags/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var lr=$r===Lt}else var lr=!0;if(lr){var yr={};yr.$requiredTags=!0,yr.$allowUndefinedTags=!0;for(const $r in pr)if(pattern40.test($r)){let wr=pr[$r];if(Lt===Lt)if(wr&&typeof wr=="object"&&!Array.isArray(wr)){const gr=Lt;for(const fr in wr)if(!(fr==="type"||fr==="items"||fr==="contains"||pattern41.test(fr)))return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:fr},message:"must NOT have additional properties"}],!1;if(gr===Lt){if(wr.type!==void 0){let fr=wr.type;const br=Lt;if(!(fr==="string"||fr==="number"||fr==="integer"||fr==="boolean"||fr==="array"))return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/type/enum",keyword:"enum",params:{allowedValues:schema119.properties.$tags.patternProperties["^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$"].properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var Sr=br===Lt}else var Sr=!0;if(Sr){if(wr.items!==void 0){let fr=wr.items;const br=Lt;if(Lt===br)if(fr&&typeof fr=="object"&&!Array.isArray(fr)){if(fr.type!==void 0){let Tr=fr.type;const Pr=Lt;if(!(Tr==="string"||Tr==="number"||Tr==="integer"))return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1")+"/items/type",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/items/properties/type/enum",keyword:"enum",params:{allowedValues:schema119.properties.$tags.patternProperties["^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$"].properties.items.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var Ar=Pr===Lt}else var Ar=!0;if(Ar){var Dr={};Dr.type=!0;for(const Tr in fr)pattern42.test(Tr)&&(Dr[Tr]=!0)}}else return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1")+"/items",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Sr=br===Lt}else var Sr=!0;if(Sr)if(wr.contains!==void 0){let fr=wr.contains;const br=Lt;if(Lt===br)if(fr&&typeof fr=="object"&&!Array.isArray(fr)){if(fr.type!==void 0){let Tr=fr.type;const Pr=Lt;if(!(Tr==="string"||Tr==="number"||Tr==="integer"))return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1")+"/contains/type",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/contains/properties/type/enum",keyword:"enum",params:{allowedValues:schema119.properties.$tags.patternProperties["^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$"].properties.contains.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var Br=Pr===Lt}else var Br=!0;if(Br){var Lr={};Lr.type=!0;for(const Tr in fr)pattern42.test(Tr)&&(Lr[Tr]=!0)}}else return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1")+"/contains",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/contains/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Sr=br===Lt}else var Sr=!0}}}else return validate73.errors=[{instancePath:At+"/$tags/"+$r.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;yr[$r]=!0}}}}else return validate73.errors=[{instancePath:At+"/$tags",schemaPath:"#/properties/%24tags/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=dr===Lt}else var zt=!0;if(zt){var Or=!0;for(const pr in kt)if(pattern39.test(pr)){const dr=Lt;wrapper2.validate(kt[pr],{instancePath:At+"/"+pr.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:kt,parentDataProperty:pr,rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?wrapper2.validate.errors:Ut.concat(wrapper2.validate.errors),Lt=Ut.length);var Or=dr===Lt;if(!Or)break}}}}}}}}else return validate73.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate73.errors=Ut,Lt===0}validate73.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function validate72(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate72.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Xt;if(kt.protocol===void 0&&(Xt="protocol")||kt.published===void 0&&(Xt="published")||kt.types===void 0&&(Xt="types")||kt.structure===void 0&&(Xt="structure"))return validate72.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Xt},message:"must have required property '"+Xt+"'"}],!1;{const tr=Lt;for(const rr in kt)if(!(rr==="protocol"||rr==="published"||rr==="types"||rr==="structure"))return validate72.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:rr},message:"must NOT have additional properties"}],!1;if(tr===Lt){if(kt.protocol!==void 0){const rr=Lt;if(typeof kt.protocol!="string")return validate72.errors=[{instancePath:At+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=rr===Lt}else var Vt=!0;if(Vt){if(kt.published!==void 0){const rr=Lt;if(typeof kt.published!="boolean")return validate72.errors=[{instancePath:At+"/published",schemaPath:"#/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var Vt=rr===Lt}else var Vt=!0;if(Vt){if(kt.types!==void 0){let rr=kt.types;const nr=Lt;if(Lt===nr)if(rr&&typeof rr=="object"&&!Array.isArray(rr)){var zt={};for(const ir in rr)if(pattern37.test(ir)){let lr=rr[ir];if(Lt===Lt)if(lr&&typeof lr=="object"&&!Array.isArray(lr)){const Sr=Lt;for(const Ar in lr)if(!(Ar==="schema"||Ar==="dataFormats"))return validate72.errors=[{instancePath:At+"/types/"+ir.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/types/patternProperties/.*/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Ar},message:"must NOT have additional properties"}],!1;if(Sr===Lt){if(lr.schema!==void 0){const Ar=Lt;if(typeof lr.schema!="string")return validate72.errors=[{instancePath:At+"/types/"+ir.replace(/~/g,"~0").replace(/\//g,"~1")+"/schema",schemaPath:"#/properties/types/patternProperties/.*/properties/schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Wt=Ar===Lt}else var Wt=!0;if(Wt)if(lr.dataFormats!==void 0){let Ar=lr.dataFormats;const Dr=Lt;if(Lt===Dr)if(Array.isArray(Ar)){if(Ar.length<1)return validate72.errors=[{instancePath:At+"/types/"+ir.replace(/~/g,"~0").replace(/\//g,"~1")+"/dataFormats",schemaPath:"#/properties/types/patternProperties/.*/properties/dataFormats/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var Jt=!0;const Lr=Ar.length;for(let Or=0;Or<Lr;Or++){const vr=Lt;if(typeof Ar[Or]!="string")return validate72.errors=[{instancePath:At+"/types/"+ir.replace(/~/g,"~0").replace(/\//g,"~1")+"/dataFormats/"+Or,schemaPath:"#/properties/types/patternProperties/.*/properties/dataFormats/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Jt=vr===Lt;if(!Jt)break}}}else return validate72.errors=[{instancePath:At+"/types/"+ir.replace(/~/g,"~0").replace(/\//g,"~1")+"/dataFormats",schemaPath:"#/properties/types/patternProperties/.*/properties/dataFormats/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var Wt=Dr===Lt}else var Wt=!0}}else return validate72.errors=[{instancePath:At+"/types/"+ir.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/types/patternProperties/.*/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;zt[ir]=!0}}else return validate72.errors=[{instancePath:At+"/types",schemaPath:"#/properties/types/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=nr===Lt}else var Vt=!0;if(Vt)if(kt.structure!==void 0){let rr=kt.structure;const nr=Lt;if(Lt===nr)if(rr&&typeof rr=="object"&&!Array.isArray(rr)){var Qt={};for(const ir in rr)pattern37.test(ir)&&(validate73(rr[ir],{instancePath:At+"/structure/"+ir.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:rr,parentDataProperty:ir,rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate73.errors:Ut.concat(validate73.errors),Lt=Ut.length),Qt[ir]=!0)}else return validate72.errors=[{instancePath:At+"/structure",schemaPath:"#/properties/structure/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=nr===Lt}else var Vt=!0}}}}}else return validate72.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate72.errors=Ut,Lt===0}validate72.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const ProtocolRuleSet=validate73,ProtocolsConfigure$1=validate76,schema120={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/protocols-configure.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","definition"],properties:{interface:{enum:["Protocols"],type:"string"},method:{enum:["Configure"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},definition:{$ref:"https://identity.foundation/dwn/json-schemas/protocol-definition.json"}}}}};function validate76(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate76.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Wt;if(kt.authorization===void 0&&(Wt="authorization")||kt.descriptor===void 0&&(Wt="descriptor"))return validate76.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Wt},message:"must have required property '"+Wt+"'"}],!1;{const Jt=Lt;for(const Qt in kt)if(!(Qt==="authorization"||Qt==="descriptor"))return validate76.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Qt},message:"must NOT have additional properties"}],!1;if(Jt===Lt){if(kt.authorization!==void 0){const Qt=Lt;validate24(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate24.errors:Ut.concat(validate24.errors),Lt=Ut.length);var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Qt=kt.descriptor;const Xt=Lt;if(Lt===Xt)if(Qt&&typeof Qt=="object"&&!Array.isArray(Qt)){let rr;if(Qt.interface===void 0&&(rr="interface")||Qt.method===void 0&&(rr="method")||Qt.messageTimestamp===void 0&&(rr="messageTimestamp")||Qt.definition===void 0&&(rr="definition"))return validate76.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:rr},message:"must have required property '"+rr+"'"}],!1;{const nr=Lt;for(const ar in Qt)if(!(ar==="interface"||ar==="method"||ar==="messageTimestamp"||ar==="definition"))return validate76.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ar},message:"must NOT have additional properties"}],!1;if(nr===Lt){if(Qt.interface!==void 0){let ar=Qt.interface;const ir=Lt;if(typeof ar!="string")return validate76.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Protocols")return validate76.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema120.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.method!==void 0){let ar=Qt.method;const ir=Lt;if(typeof ar!="string")return validate76.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Configure")return validate76.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema120.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.messageTimestamp!==void 0){let ar=Qt.messageTimestamp;const ir=Lt;if(Lt===Lt)if(typeof ar=="string"){if(!pattern14.test(ar))return validate76.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate76.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ir===Lt}else var zt=!0;if(zt)if(Qt.definition!==void 0){const ar=Lt;validate72(Qt.definition,{instancePath:At+"/descriptor/definition",parentData:Qt,parentDataProperty:"definition",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate72.errors:Ut.concat(validate72.errors),Lt=Ut.length);var zt=ar===Lt}else var zt=!0}}}}}else return validate76.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Xt===Lt}else var Vt=!0}}}else return validate76.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate76.errors=Ut,Lt===0}validate76.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const ProtocolsQuery$1=validate79,schema122={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/protocols-query.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp"],properties:{interface:{enum:["Protocols"],type:"string"},method:{enum:["Query"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{type:"object",minProperties:1,additionalProperties:!1,properties:{protocol:{type:"string"},recipient:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"}}}}}}};function validate79(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate79.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Jt;if(kt.descriptor===void 0&&(Jt="descriptor"))return validate79.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Jt},message:"must have required property '"+Jt+"'"}],!1;{const Qt=Lt;for(const Xt in kt)if(!(Xt==="authorization"||Xt==="descriptor"))return validate79.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Xt},message:"must NOT have additional properties"}],!1;if(Qt===Lt){if(kt.authorization!==void 0){const Xt=Lt;validate20(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate20.errors:Ut.concat(validate20.errors),Lt=Ut.length);var Vt=Xt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Xt=kt.descriptor;const tr=Lt;if(Lt===tr)if(Xt&&typeof Xt=="object"&&!Array.isArray(Xt)){let nr;if(Xt.interface===void 0&&(nr="interface")||Xt.method===void 0&&(nr="method")||Xt.messageTimestamp===void 0&&(nr="messageTimestamp"))return validate79.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:nr},message:"must have required property '"+nr+"'"}],!1;{const ar=Lt;for(const ir in Xt)if(!(ir==="interface"||ir==="method"||ir==="messageTimestamp"||ir==="filter"))return validate79.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ir},message:"must NOT have additional properties"}],!1;if(ar===Lt){if(Xt.interface!==void 0){let ir=Xt.interface;const lr=Lt;if(typeof ir!="string")return validate79.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ir!=="Protocols")return validate79.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema122.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=lr===Lt}else var zt=!0;if(zt){if(Xt.method!==void 0){let ir=Xt.method;const lr=Lt;if(typeof ir!="string")return validate79.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ir!=="Query")return validate79.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema122.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=lr===Lt}else var zt=!0;if(zt){if(Xt.messageTimestamp!==void 0){let ir=Xt.messageTimestamp;const lr=Lt;if(Lt===Lt)if(typeof ir=="string"){if(!pattern14.test(ir))return validate79.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate79.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=lr===Lt}else var zt=!0;if(zt)if(Xt.filter!==void 0){let ir=Xt.filter;const lr=Lt;if(Lt===lr)if(ir&&typeof ir=="object"&&!Array.isArray(ir)){if(Object.keys(ir).length<1)return validate79.errors=[{instancePath:At+"/descriptor/filter",schemaPath:"#/properties/descriptor/properties/filter/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const Sr=Lt;for(const Ar in ir)if(!(Ar==="protocol"||Ar==="recipient"))return validate79.errors=[{instancePath:At+"/descriptor/filter",schemaPath:"#/properties/descriptor/properties/filter/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Ar},message:"must NOT have additional properties"}],!1;if(Sr===Lt){if(ir.protocol!==void 0){const Ar=Lt;if(typeof ir.protocol!="string")return validate79.errors=[{instancePath:At+"/descriptor/filter/protocol",schemaPath:"#/properties/descriptor/properties/filter/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Wt=Ar===Lt}else var Wt=!0;if(Wt)if(ir.recipient!==void 0){let Ar=ir.recipient;const Dr=Lt;if(Lt===Lt)if(typeof Ar=="string"){if(!pattern12.test(Ar))return validate79.errors=[{instancePath:At+"/descriptor/filter/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return validate79.errors=[{instancePath:At+"/descriptor/filter/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Wt=Dr===Lt}else var Wt=!0}}}else return validate79.errors=[{instancePath:At+"/descriptor/filter",schemaPath:"#/properties/descriptor/properties/filter/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var zt=lr===Lt}else var zt=!0}}}}}else return validate79.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=tr===Lt}else var Vt=!0}}}else return validate79.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate79.errors=Ut,Lt===0}validate79.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsRead$1=validate81,schema125={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-read.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filter"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Read"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{$ref:"https://identity.foundation/dwn/json-schemas/records-filter.json"}}}}};function validate81(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate81.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){let Wt;if(kt.descriptor===void 0&&(Wt="descriptor"))return validate81.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:Wt},message:"must have required property '"+Wt+"'"}],!1;{const Jt=Lt;for(const Qt in kt)if(!(Qt==="authorization"||Qt==="descriptor"))return validate81.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Qt},message:"must NOT have additional properties"}],!1;if(Jt===Lt){if(kt.authorization!==void 0){const Qt=Lt;validate24(kt.authorization,{instancePath:At+"/authorization",parentData:kt,parentDataProperty:"authorization",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate24.errors:Ut.concat(validate24.errors),Lt=Ut.length);var Vt=Qt===Lt}else var Vt=!0;if(Vt)if(kt.descriptor!==void 0){let Qt=kt.descriptor;const Xt=Lt;if(Lt===Xt)if(Qt&&typeof Qt=="object"&&!Array.isArray(Qt)){let rr;if(Qt.interface===void 0&&(rr="interface")||Qt.method===void 0&&(rr="method")||Qt.messageTimestamp===void 0&&(rr="messageTimestamp")||Qt.filter===void 0&&(rr="filter"))return validate81.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:rr},message:"must have required property '"+rr+"'"}],!1;{const nr=Lt;for(const ar in Qt)if(!(ar==="interface"||ar==="method"||ar==="messageTimestamp"||ar==="filter"))return validate81.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:ar},message:"must NOT have additional properties"}],!1;if(nr===Lt){if(Qt.interface!==void 0){let ar=Qt.interface;const ir=Lt;if(typeof ar!="string")return validate81.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Records")return validate81.errors=[{instancePath:At+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:schema125.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.method!==void 0){let ar=Qt.method;const ir=Lt;if(typeof ar!="string")return validate81.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(ar!=="Read")return validate81.errors=[{instancePath:At+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:schema125.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var zt=ir===Lt}else var zt=!0;if(zt){if(Qt.messageTimestamp!==void 0){let ar=Qt.messageTimestamp;const ir=Lt;if(Lt===Lt)if(typeof ar=="string"){if(!pattern14.test(ar))return validate81.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return validate81.errors=[{instancePath:At+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var zt=ir===Lt}else var zt=!0;if(zt)if(Qt.filter!==void 0){const ar=Lt;validate42(Qt.filter,{instancePath:At+"/descriptor/filter",parentData:Qt,parentDataProperty:"filter",rootData:Nt,dynamicAnchors:jt})||(Ut=Ut===null?validate42.errors:Ut.concat(validate42.errors),Lt=Ut.length);var zt=ar===Lt}else var zt=!0}}}}}else return validate81.errors=[{instancePath:At+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var Vt=Xt===Lt}else var Vt=!0}}}else return validate81.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate81.errors=Ut,Lt===0}validate81.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsFilter=validate42,PublicJwk=validate33,GenericSignaturePayload=validate84;function validate84(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate84.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)){let zt;if(kt.descriptorCid===void 0&&(zt="descriptorCid"))return validate84.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;for(const Wt in kt)if(!(Wt==="descriptorCid"||Wt==="delegatedGrantId"||Wt==="permissionGrantId"||Wt==="protocolRole"))return validate84.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wt},message:"must NOT have additional properties"}],!1;{if(kt.descriptorCid!==void 0){const Wt=Lt;if(typeof kt.descriptorCid!="string")return validate84.errors=[{instancePath:At+"/descriptorCid",schemaPath:"#/properties/descriptorCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.delegatedGrantId!==void 0){const Wt=Lt;if(typeof kt.delegatedGrantId!="string")return validate84.errors=[{instancePath:At+"/delegatedGrantId",schemaPath:"#/properties/delegatedGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.permissionGrantId!==void 0){const Wt=Lt;if(typeof kt.permissionGrantId!="string")return validate84.errors=[{instancePath:At+"/permissionGrantId",schemaPath:"#/properties/permissionGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt)if(kt.protocolRole!==void 0){const Wt=Lt;if(typeof kt.protocolRole!="string")return validate84.errors=[{instancePath:At+"/protocolRole",schemaPath:"#/properties/protocolRole/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0}}}}else return validate84.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate84.errors=Ut,Lt===0}validate84.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const RecordsWriteSignaturePayload=validate85;function validate85(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate85.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),kt&&typeof kt=="object"&&!Array.isArray(kt)){let zt;if(kt.descriptorCid===void 0&&(zt="descriptorCid")||kt.recordId===void 0&&(zt="recordId"))return validate85.errors=[{instancePath:At,schemaPath:"#/required",keyword:"required",params:{missingProperty:zt},message:"must have required property '"+zt+"'"}],!1;for(const Wt in kt)if(!(Wt==="descriptorCid"||Wt==="recordId"||Wt==="contextId"||Wt==="attestationCid"||Wt==="encryptionCid"||Wt==="delegatedGrantId"||Wt==="permissionGrantId"||Wt==="protocolRole"))return validate85.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Wt},message:"must NOT have additional properties"}],!1;{if(kt.descriptorCid!==void 0){const Wt=Lt;if(typeof kt.descriptorCid!="string")return validate85.errors=[{instancePath:At+"/descriptorCid",schemaPath:"#/properties/descriptorCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.recordId!==void 0){const Wt=Lt;if(typeof kt.recordId!="string")return validate85.errors=[{instancePath:At+"/recordId",schemaPath:"#/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.contextId!==void 0){const Wt=Lt;if(typeof kt.contextId!="string")return validate85.errors=[{instancePath:At+"/contextId",schemaPath:"#/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.attestationCid!==void 0){const Wt=Lt;if(typeof kt.attestationCid!="string")return validate85.errors=[{instancePath:At+"/attestationCid",schemaPath:"#/properties/attestationCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.encryptionCid!==void 0){const Wt=Lt;if(typeof kt.encryptionCid!="string")return validate85.errors=[{instancePath:At+"/encryptionCid",schemaPath:"#/properties/encryptionCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.delegatedGrantId!==void 0){const Wt=Lt;if(typeof kt.delegatedGrantId!="string")return validate85.errors=[{instancePath:At+"/delegatedGrantId",schemaPath:"#/properties/delegatedGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt){if(kt.permissionGrantId!==void 0){const Wt=Lt;if(typeof kt.permissionGrantId!="string")return validate85.errors=[{instancePath:At+"/permissionGrantId",schemaPath:"#/properties/permissionGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0;if(Vt)if(kt.protocolRole!==void 0){const Wt=Lt;if(typeof kt.protocolRole!="string")return validate85.errors=[{instancePath:At+"/protocolRole",schemaPath:"#/properties/protocolRole/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Vt=Wt===Lt}else var Vt=!0}}}}}}}}else return validate85.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate85.errors=Ut,Lt===0}validate85.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const StringRangeFilter=validate86;function validate86(kt,{instancePath:At="",parentData:xt,parentDataProperty:Bt,rootData:Nt=kt,dynamicAnchors:jt={}}={}){let Ut=null,Lt=0;const Ht=validate86.evaluated;if(Ht.dynamicProps&&(Ht.props=void 0),Ht.dynamicItems&&(Ht.items=void 0),Lt===0)if(kt&&typeof kt=="object"&&!Array.isArray(kt)){if(Object.keys(kt).length<1)return validate86.errors=[{instancePath:At,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{const tr=Lt;for(const rr in kt)if(!(rr==="gt"||rr==="gte"||rr==="lt"||rr==="lte"))return validate86.errors=[{instancePath:At,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:rr},message:"must NOT have additional properties"}],!1;if(tr===Lt){if(kt.gt!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.gte===void 0){const ir={};Ut===null?Ut=[ir]:Ut.push(ir),Lt++}var Vt=ar===Lt;if(Vt)return validate86.errors=[{instancePath:At,schemaPath:"#/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.gte!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.gt===void 0){const lr={};Ut===null?Ut=[lr]:Ut.push(lr),Lt++}var Wt=ar===Lt;if(Wt)return validate86.errors=[{instancePath:At,schemaPath:"#/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.lt!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.lte===void 0){const lr={};Ut===null?Ut=[lr]:Ut.push(lr),Lt++}var Jt=ar===Lt;if(Jt)return validate86.errors=[{instancePath:At,schemaPath:"#/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.lte!==void 0){const rr=Lt,nr=Lt,ar=Lt;if(kt&&typeof kt=="object"&&!Array.isArray(kt)&&kt.lt===void 0){const lr={};Ut===null?Ut=[lr]:Ut.push(lr),Lt++}var Qt=ar===Lt;if(Qt)return validate86.errors=[{instancePath:At,schemaPath:"#/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;Lt=nr,Ut!==null&&(nr?Ut.length=nr:Ut=null);var zt=rr===Lt}else var zt=!0;if(zt){if(kt.gt!==void 0){const rr=Lt;if(typeof kt.gt!="string")return validate86.errors=[{instancePath:At+"/gt",schemaPath:"#/properties/gt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Xt=rr===Lt}else var Xt=!0;if(Xt){if(kt.gte!==void 0){const rr=Lt;if(typeof kt.gte!="string")return validate86.errors=[{instancePath:At+"/gte",schemaPath:"#/properties/gte/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Xt=rr===Lt}else var Xt=!0;if(Xt){if(kt.lt!==void 0){const rr=Lt;if(typeof kt.lt!="string")return validate86.errors=[{instancePath:At+"/lt",schemaPath:"#/properties/lt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Xt=rr===Lt}else var Xt=!0;if(Xt)if(kt.lte!==void 0){const rr=Lt;if(typeof kt.lte!="string")return validate86.errors=[{instancePath:At+"/lte",schemaPath:"#/properties/lte/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Xt=rr===Lt}else var Xt=!0}}}}}}}}}else return validate86.errors=[{instancePath:At,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return validate86.errors=Ut,Lt===0}validate86.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};const precompiledValidators=Object.freeze(Object.defineProperty({__proto__:null,Authorization,AuthorizationDelegatedGrant,AuthorizationOwner,Definitions,GeneralJwk,GeneralJws,GenericSignaturePayload,JwkVerificationMethod,MessagesFilter,MessagesQuery:MessagesQuery$1,MessagesRead:MessagesRead$1,MessagesSubscribe:MessagesSubscribe$1,NumberRangeFilter,PaginationCursor,PermissionGrantData,PermissionRequestData,PermissionRevocationData,PermissionsDefinitions,PermissionsScopes,ProtocolDefinition,ProtocolRuleSet,ProtocolsConfigure:ProtocolsConfigure$1,ProtocolsQuery:ProtocolsQuery$1,PublicJwk,RecordsDelete:RecordsDelete$1,RecordsFilter,RecordsQuery:RecordsQuery$1,RecordsRead:RecordsRead$1,RecordsSubscribe:RecordsSubscribe$1,RecordsWrite:RecordsWrite$1,RecordsWriteDataEncoded,RecordsWriteSignaturePayload,RecordsWriteUnidentified,StringRangeFilter},Symbol.toStringTag,{value:"Module"}));function validateJsonSchema(kt,At){const xt=precompiledValidators[kt];if(!xt)throw new DwnError(DwnErrorCode.SchemaValidatorSchemaNotFound,`schema for ${kt} not found.`);if(xt(At),!xt.errors)return;const[Bt]=xt.errors;let{instancePath:Nt,message:jt,keyword:Ut}=Bt;if(Nt||(Nt=kt),Ut==="additionalProperties"){const Lt=Bt.params.additionalProperty;throw new DwnError(DwnErrorCode.SchemaValidatorAdditionalPropertyNotAllowed,`${jt}: ${Nt}: ${Lt}`)}if(Ut==="unevaluatedProperties"){const Lt=Bt.params.unevaluatedProperty;throw new DwnError(DwnErrorCode.SchemaValidatorUnevaluatedPropertyNotAllowed,`${jt}: ${Nt}: ${Lt}`)}throw new DwnError(DwnErrorCode.SchemaValidatorFailure,`${Nt}: ${jt}`)}var __awaiter$2D=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class GeneralJwsVerifier{constructor(At){this.cache=At||new MemoryCache(600)}static get singleton(){return GeneralJwsVerifier._singleton===void 0&&(GeneralJwsVerifier._singleton=new GeneralJwsVerifier),GeneralJwsVerifier._singleton}static verifySignatures(At,xt){return __awaiter$2D(this,void 0,void 0,function*(){return yield GeneralJwsVerifier.singleton.verifySignatures(At,xt)})}verifySignatures(At,xt){return __awaiter$2D(this,void 0,void 0,function*(){const Bt=[];for(const Nt of At.signatures){let jt;const Ut=Jws.getKid(Nt),Lt=`${Nt.protected}.${At.payload}.${Nt.signature}`,Ht=yield this.cache.get(Lt);if(Ht===void 0){const zt=yield GeneralJwsVerifier.getPublicKey(Ut,xt);jt=yield Jws.verifySignature(At.payload,Nt,zt),yield this.cache.set(Lt,jt)}else jt=Ht;const Vt=Jws.extractDid(Ut);if(jt)Bt.push(Vt);else throw new DwnError(DwnErrorCode.GeneralJwsVerifierInvalidSignature,`Signature verification failed for ${Vt}`)}return{signers:Bt}})}static getPublicKey(At,xt){return __awaiter$2D(this,void 0,void 0,function*(){const Bt=Jws.extractDid(At),{didDocument:Nt}=yield xt.resolve(Bt),{verificationMethod:jt=[]}=Nt||{};let Ut;for(const Ht of jt)if(At.endsWith(Ht.id)){Ut=Ht;break}if(!Ut)throw new DwnError(DwnErrorCode.GeneralJwsVerifierGetPublicKeyNotFound,"public key needed to verify signature not found in DID Document");validateJsonSchema("JwkVerificationMethod",Ut);const{publicKeyJwk:Lt}=Ut;return Lt})}}const typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(kt){if(kt===null)return"null";if(kt===void 0)return"undefined";if(kt===!0||kt===!1)return"boolean";const At=typeof kt;if(typeofs.includes(At))return At;if(At==="function")return"Function";if(Array.isArray(kt))return"Array";if(isBuffer$1(kt))return"Buffer";const xt=getObjectType(kt);return xt||"Object"}function isBuffer$1(kt){return kt&&kt.constructor&&kt.constructor.isBuffer&&kt.constructor.isBuffer.call(null,kt)}function getObjectType(kt){const At=Object.prototype.toString.call(kt).slice(8,-1);if(objectTypeNames.includes(At))return At}class Type{constructor(At,xt,Bt){this.major=At,this.majorEncoded=At<<5,this.name=xt,this.terminal=Bt}toString(){return`Type[${this.major}].${this.name}`}compare(At){return this.major<At.major?-1:this.major>At.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(At,xt,Bt){this.type=At,this.value=xt,this.encodedLength=Bt,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$5=new TextDecoder,textEncoder$7=new TextEncoder;function isBuffer(kt){return useBuffer&&globalThis.Buffer.isBuffer(kt)}function asU8A(kt){return kt instanceof Uint8Array?isBuffer(kt)?new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength):kt:Uint8Array.from(kt)}const toString$7=useBuffer?(kt,At,xt)=>xt-At>64?globalThis.Buffer.from(kt.subarray(At,xt)).toString("utf8"):utf8Slice(kt,At,xt):(kt,At,xt)=>xt-At>64?textDecoder$5.decode(kt.subarray(At,xt)):utf8Slice(kt,At,xt),fromString$2=useBuffer?kt=>kt.length>64?globalThis.Buffer.from(kt):utf8ToBytes$5(kt):kt=>kt.length>64?textEncoder$7.encode(kt):utf8ToBytes$5(kt),fromArray$1=kt=>Uint8Array.from(kt),slice=useBuffer?(kt,At,xt)=>isBuffer(kt)?new Uint8Array(kt.subarray(At,xt)):kt.slice(At,xt):(kt,At,xt)=>kt.slice(At,xt),concat$1=useBuffer?(kt,At)=>(kt=kt.map(xt=>xt instanceof Uint8Array?xt:globalThis.Buffer.from(xt)),asU8A(globalThis.Buffer.concat(kt,At))):(kt,At)=>{const xt=new Uint8Array(At);let Bt=0;for(let Nt of kt)Bt+Nt.length>xt.length&&(Nt=Nt.subarray(0,xt.length-Bt)),xt.set(Nt,Bt),Bt+=Nt.length;return xt},alloc$2=useBuffer?kt=>globalThis.Buffer.allocUnsafe(kt):kt=>new Uint8Array(kt);function compare$1(kt,At){if(isBuffer(kt)&&isBuffer(At))return kt.compare(At);for(let xt=0;xt<kt.length;xt++)if(kt[xt]!==At[xt])return kt[xt]<At[xt]?-1:1;return 0}function utf8ToBytes$5(kt,At=1/0){let xt;const Bt=kt.length;let Nt=null;const jt=[];for(let Ut=0;Ut<Bt;++Ut){if(xt=kt.charCodeAt(Ut),xt>55295&&xt<57344){if(!Nt){if(xt>56319){(At-=3)>-1&&jt.push(239,191,189);continue}else if(Ut+1===Bt){(At-=3)>-1&&jt.push(239,191,189);continue}Nt=xt;continue}if(xt<56320){(At-=3)>-1&&jt.push(239,191,189),Nt=xt;continue}xt=(Nt-55296<<10|xt-56320)+65536}else Nt&&(At-=3)>-1&&jt.push(239,191,189);if(Nt=null,xt<128){if((At-=1)<0)break;jt.push(xt)}else if(xt<2048){if((At-=2)<0)break;jt.push(xt>>6|192,xt&63|128)}else if(xt<65536){if((At-=3)<0)break;jt.push(xt>>12|224,xt>>6&63|128,xt&63|128)}else if(xt<1114112){if((At-=4)<0)break;jt.push(xt>>18|240,xt>>12&63|128,xt>>6&63|128,xt&63|128)}else throw new Error("Invalid code point")}return jt}function utf8Slice(kt,At,xt){const Bt=[];for(;At<xt;){const Nt=kt[At];let jt=null,Ut=Nt>239?4:Nt>223?3:Nt>191?2:1;if(At+Ut<=xt){let Lt,Ht,Vt,zt;switch(Ut){case 1:Nt<128&&(jt=Nt);break;case 2:Lt=kt[At+1],(Lt&192)===128&&(zt=(Nt&31)<<6|Lt&63,zt>127&&(jt=zt));break;case 3:Lt=kt[At+1],Ht=kt[At+2],(Lt&192)===128&&(Ht&192)===128&&(zt=(Nt&15)<<12|(Lt&63)<<6|Ht&63,zt>2047&&(zt<55296||zt>57343)&&(jt=zt));break;case 4:Lt=kt[At+1],Ht=kt[At+2],Vt=kt[At+3],(Lt&192)===128&&(Ht&192)===128&&(Vt&192)===128&&(zt=(Nt&15)<<18|(Lt&63)<<12|(Ht&63)<<6|Vt&63,zt>65535&&zt<1114112&&(jt=zt))}}jt===null?(jt=65533,Ut=1):jt>65535&&(jt-=65536,Bt.push(jt>>>10&1023|55296),jt=56320|jt&1023),Bt.push(jt),At+=Ut}return decodeCodePointsArray(Bt)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(kt){const At=kt.length;if(At<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,kt);let xt="",Bt=0;for(;Bt<At;)xt+=String.fromCharCode.apply(String,kt.slice(Bt,Bt+=MAX_ARGUMENTS_LENGTH));return xt}const defaultChunkSize=256;class Bl{constructor(At=defaultChunkSize){this.chunkSize=At,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(At){let xt=this.chunks[this.chunks.length-1];if(this.cursor+At.length<=this.maxCursor+1){const Nt=xt.length-(this.maxCursor-this.cursor)-1;xt.set(At,Nt)}else{if(xt){const Nt=xt.length-(this.maxCursor-this.cursor)-1;Nt<xt.length&&(this.chunks[this.chunks.length-1]=xt.subarray(0,Nt),this.maxCursor=this.cursor-1)}At.length<64&&At.length<this.chunkSize?(xt=alloc$2(this.chunkSize),this.chunks.push(xt),this.maxCursor+=xt.length,this._initReuseChunk===null&&(this._initReuseChunk=xt),xt.set(At,0)):(this.chunks.push(At),this.maxCursor+=At.length)}this.cursor+=At.length}toBytes(At=!1){let xt;if(this.chunks.length===1){const Bt=this.chunks[0];At&&this.cursor>Bt.length/2?(xt=this.cursor===Bt.length?Bt:Bt.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):xt=slice(Bt,0,this.cursor)}else xt=concat$1(this.chunks,this.cursor);return At&&this.reset(),xt}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(kt,At,xt){if(kt.length-At<xt)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(kt,At,xt){assertEnoughData(kt,At,1);const Bt=kt[At];if(xt.strict===!0&&Bt<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return Bt}function readUint16(kt,At,xt){assertEnoughData(kt,At,2);const Bt=kt[At]<<8|kt[At+1];if(xt.strict===!0&&Bt<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return Bt}function readUint32(kt,At,xt){assertEnoughData(kt,At,4);const Bt=kt[At]*16777216+(kt[At+1]<<16)+(kt[At+2]<<8)+kt[At+3];if(xt.strict===!0&&Bt<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return Bt}function readUint64(kt,At,xt){assertEnoughData(kt,At,8);const Bt=kt[At]*16777216+(kt[At+1]<<16)+(kt[At+2]<<8)+kt[At+3],Nt=kt[At+4]*16777216+(kt[At+5]<<16)+(kt[At+6]<<8)+kt[At+7],jt=(BigInt(Bt)<<BigInt(32))+BigInt(Nt);if(xt.strict===!0&&jt<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(jt<=Number.MAX_SAFE_INTEGER)return Number(jt);if(xt.allowBigInt===!0)return jt;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(kt,At,xt,Bt){return new Token(Type.uint,readUint8(kt,At+1,Bt),2)}function decodeUint16(kt,At,xt,Bt){return new Token(Type.uint,readUint16(kt,At+1,Bt),3)}function decodeUint32(kt,At,xt,Bt){return new Token(Type.uint,readUint32(kt,At+1,Bt),5)}function decodeUint64(kt,At,xt,Bt){return new Token(Type.uint,readUint64(kt,At+1,Bt),9)}function encodeUint(kt,At){return encodeUintValue(kt,0,At.value)}function encodeUintValue(kt,At,xt){if(xt<uintBoundaries[0]){const Bt=Number(xt);kt.push([At|Bt])}else if(xt<uintBoundaries[1]){const Bt=Number(xt);kt.push([At|24,Bt])}else if(xt<uintBoundaries[2]){const Bt=Number(xt);kt.push([At|25,Bt>>>8,Bt&255])}else if(xt<uintBoundaries[3]){const Bt=Number(xt);kt.push([At|26,Bt>>>24&255,Bt>>>16&255,Bt>>>8&255,Bt&255])}else{const Bt=BigInt(xt);if(Bt<uintBoundaries[4]){const Nt=[At|27,0,0,0,0,0,0,0];let jt=Number(Bt&BigInt(4294967295)),Ut=Number(Bt>>BigInt(32)&BigInt(4294967295));Nt[8]=jt&255,jt=jt>>8,Nt[7]=jt&255,jt=jt>>8,Nt[6]=jt&255,jt=jt>>8,Nt[5]=jt&255,Nt[4]=Ut&255,Ut=Ut>>8,Nt[3]=Ut&255,Ut=Ut>>8,Nt[2]=Ut&255,Ut=Ut>>8,Nt[1]=Ut&255,kt.push(Nt)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function(At){return encodeUintValue.encodedSize(At.value)};encodeUintValue.encodedSize=function(At){return At<uintBoundaries[0]?1:At<uintBoundaries[1]?2:At<uintBoundaries[2]?3:At<uintBoundaries[3]?5:9};encodeUint.compareTokens=function(At,xt){return At.value<xt.value?-1:At.value>xt.value?1:0};function decodeNegint8(kt,At,xt,Bt){return new Token(Type.negint,-1-readUint8(kt,At+1,Bt),2)}function decodeNegint16(kt,At,xt,Bt){return new Token(Type.negint,-1-readUint16(kt,At+1,Bt),3)}function decodeNegint32(kt,At,xt,Bt){return new Token(Type.negint,-1-readUint32(kt,At+1,Bt),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(kt,At,xt,Bt){const Nt=readUint64(kt,At+1,Bt);if(typeof Nt!="bigint"){const jt=-1-Nt;if(jt>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,jt,9)}if(Bt.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(Nt),9)}function encodeNegint(kt,At){const xt=At.value,Bt=typeof xt=="bigint"?xt*neg1b-pos1b:xt*-1-1;encodeUintValue(kt,At.type.majorEncoded,Bt)}encodeNegint.encodedSize=function(At){const xt=At.value,Bt=typeof xt=="bigint"?xt*neg1b-pos1b:xt*-1-1;return Bt<uintBoundaries[0]?1:Bt<uintBoundaries[1]?2:Bt<uintBoundaries[2]?3:Bt<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function(At,xt){return At.value<xt.value?1:At.value>xt.value?-1:0};function toToken$3(kt,At,xt,Bt){assertEnoughData(kt,At,xt+Bt);const Nt=slice(kt,At+xt,At+xt+Bt);return new Token(Type.bytes,Nt,xt+Bt)}function decodeBytesCompact(kt,At,xt,Bt){return toToken$3(kt,At,1,xt)}function decodeBytes8(kt,At,xt,Bt){return toToken$3(kt,At,2,readUint8(kt,At+1,Bt))}function decodeBytes16(kt,At,xt,Bt){return toToken$3(kt,At,3,readUint16(kt,At+1,Bt))}function decodeBytes32(kt,At,xt,Bt){return toToken$3(kt,At,5,readUint32(kt,At+1,Bt))}function decodeBytes64(kt,At,xt,Bt){const Nt=readUint64(kt,At+1,Bt);if(typeof Nt=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(kt,At,9,Nt)}function tokenBytes(kt){return kt.encodedBytes===void 0&&(kt.encodedBytes=kt.type===Type.string?fromString$2(kt.value):kt.value),kt.encodedBytes}function encodeBytes(kt,At){const xt=tokenBytes(At);encodeUintValue(kt,At.type.majorEncoded,xt.length),kt.push(xt)}encodeBytes.encodedSize=function(At){const xt=tokenBytes(At);return encodeUintValue.encodedSize(xt.length)+xt.length};encodeBytes.compareTokens=function(At,xt){return compareBytes(tokenBytes(At),tokenBytes(xt))};function compareBytes(kt,At){return kt.length<At.length?-1:kt.length>At.length?1:compare$1(kt,At)}function toToken$2(kt,At,xt,Bt,Nt){const jt=xt+Bt;assertEnoughData(kt,At,jt);const Ut=new Token(Type.string,toString$7(kt,At+xt,At+jt),jt);return Nt.retainStringBytes===!0&&(Ut.byteValue=slice(kt,At+xt,At+jt)),Ut}function decodeStringCompact(kt,At,xt,Bt){return toToken$2(kt,At,1,xt,Bt)}function decodeString8(kt,At,xt,Bt){return toToken$2(kt,At,2,readUint8(kt,At+1,Bt),Bt)}function decodeString16(kt,At,xt,Bt){return toToken$2(kt,At,3,readUint16(kt,At+1,Bt),Bt)}function decodeString32(kt,At,xt,Bt){return toToken$2(kt,At,5,readUint32(kt,At+1,Bt),Bt)}function decodeString64(kt,At,xt,Bt){const Nt=readUint64(kt,At+1,Bt);if(typeof Nt=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(kt,At,9,Nt,Bt)}const encodeString=encodeBytes;function toToken$1(kt,At,xt,Bt){return new Token(Type.array,Bt,xt)}function decodeArrayCompact(kt,At,xt,Bt){return toToken$1(kt,At,1,xt)}function decodeArray8(kt,At,xt,Bt){return toToken$1(kt,At,2,readUint8(kt,At+1,Bt))}function decodeArray16(kt,At,xt,Bt){return toToken$1(kt,At,3,readUint16(kt,At+1,Bt))}function decodeArray32(kt,At,xt,Bt){return toToken$1(kt,At,5,readUint32(kt,At+1,Bt))}function decodeArray64(kt,At,xt,Bt){const Nt=readUint64(kt,At+1,Bt);if(typeof Nt=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(kt,At,9,Nt)}function decodeArrayIndefinite(kt,At,xt,Bt){if(Bt.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(kt,At,1,1/0)}function encodeArray(kt,At){encodeUintValue(kt,Type.array.majorEncoded,At.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function(At){return encodeUintValue.encodedSize(At.value)};function toToken(kt,At,xt,Bt){return new Token(Type.map,Bt,xt)}function decodeMapCompact(kt,At,xt,Bt){return toToken(kt,At,1,xt)}function decodeMap8(kt,At,xt,Bt){return toToken(kt,At,2,readUint8(kt,At+1,Bt))}function decodeMap16(kt,At,xt,Bt){return toToken(kt,At,3,readUint16(kt,At+1,Bt))}function decodeMap32(kt,At,xt,Bt){return toToken(kt,At,5,readUint32(kt,At+1,Bt))}function decodeMap64(kt,At,xt,Bt){const Nt=readUint64(kt,At+1,Bt);if(typeof Nt=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(kt,At,9,Nt)}function decodeMapIndefinite(kt,At,xt,Bt){if(Bt.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(kt,At,1,1/0)}function encodeMap(kt,At){encodeUintValue(kt,Type.map.majorEncoded,At.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function(At){return encodeUintValue.encodedSize(At.value)};function decodeTagCompact(kt,At,xt,Bt){return new Token(Type.tag,xt,1)}function decodeTag8(kt,At,xt,Bt){return new Token(Type.tag,readUint8(kt,At+1,Bt),2)}function decodeTag16(kt,At,xt,Bt){return new Token(Type.tag,readUint16(kt,At+1,Bt),3)}function decodeTag32(kt,At,xt,Bt){return new Token(Type.tag,readUint32(kt,At+1,Bt),5)}function decodeTag64(kt,At,xt,Bt){return new Token(Type.tag,readUint64(kt,At+1,Bt),9)}function encodeTag(kt,At){encodeUintValue(kt,Type.tag.majorEncoded,At.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function(At){return encodeUintValue.encodedSize(At.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(kt,At,xt,Bt){if(Bt.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return Bt.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(kt,At,xt,Bt){if(Bt.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(kt,At,xt){if(xt){if(xt.allowNaN===!1&&Number.isNaN(kt))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(xt.allowInfinity===!1&&(kt===1/0||kt===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,kt,At)}function decodeFloat16(kt,At,xt,Bt){return createToken(readFloat16(kt,At+1),3,Bt)}function decodeFloat32(kt,At,xt,Bt){return createToken(readFloat32(kt,At+1),5,Bt)}function decodeFloat64(kt,At,xt,Bt){return createToken(readFloat64(kt,At+1),9,Bt)}function encodeFloat(kt,At,xt){const Bt=At.value;if(Bt===!1)kt.push([Type.float.majorEncoded|MINOR_FALSE]);else if(Bt===!0)kt.push([Type.float.majorEncoded|MINOR_TRUE]);else if(Bt===null)kt.push([Type.float.majorEncoded|MINOR_NULL]);else if(Bt===void 0)kt.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let Nt,jt=!1;(!xt||xt.float64!==!0)&&(encodeFloat16(Bt),Nt=readFloat16(ui8a,1),Bt===Nt||Number.isNaN(Bt)?(ui8a[0]=249,kt.push(ui8a.slice(0,3)),jt=!0):(encodeFloat32(Bt),Nt=readFloat32(ui8a,1),Bt===Nt&&(ui8a[0]=250,kt.push(ui8a.slice(0,5)),jt=!0))),jt||(encodeFloat64(Bt),Nt=readFloat64(ui8a,1),ui8a[0]=251,kt.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(At,xt){const Bt=At.value;if(Bt===!1||Bt===!0||Bt===null||Bt===void 0)return 1;if(!xt||xt.float64!==!0){encodeFloat16(Bt);let Nt=readFloat16(ui8a,1);if(Bt===Nt||Number.isNaN(Bt))return 3;if(encodeFloat32(Bt),Nt=readFloat32(ui8a,1),Bt===Nt)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(kt){if(kt===1/0)dataView.setUint16(0,31744,!1);else if(kt===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(kt))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,kt);const At=dataView.getUint32(0),xt=(At&2139095040)>>23,Bt=At&8388607;if(xt===255)dataView.setUint16(0,31744,!1);else if(xt===0)dataView.setUint16(0,(kt&2147483648)>>16|Bt>>13,!1);else{const Nt=xt-127;Nt<-24?dataView.setUint16(0,0):Nt<-14?dataView.setUint16(0,(At&2147483648)>>16|1<<24+Nt,!1):dataView.setUint16(0,(At&2147483648)>>16|Nt+15<<10|Bt>>13,!1)}}}function readFloat16(kt,At){if(kt.length-At<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const xt=(kt[At]<<8)+kt[At+1];if(xt===31744)return 1/0;if(xt===64512)return-1/0;if(xt===32256)return NaN;const Bt=xt>>10&31,Nt=xt&1023;let jt;return Bt===0?jt=Nt*2**-24:Bt!==31?jt=(Nt+1024)*2**(Bt-25):jt=Nt===0?1/0:NaN,xt&32768?-jt:jt}function encodeFloat32(kt){dataView.setFloat32(0,kt,!1)}function readFloat32(kt,At){if(kt.length-At<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const xt=(kt.byteOffset||0)+At;return new DataView(kt.buffer,xt,4).getFloat32(0,!1)}function encodeFloat64(kt){dataView.setFloat64(0,kt,!1)}function readFloat64(kt,At){if(kt.length-At<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const xt=(kt.byteOffset||0)+At;return new DataView(kt.buffer,xt,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(kt,At,xt){throw new Error(`${decodeErrPrefix} encountered invalid minor (${xt}) for major ${kt[At]>>>5}`)}function errorer(kt){return()=>{throw new Error(`${decodeErrPrefix} ${kt}`)}}const jump=[];for(let kt=0;kt<=23;kt++)jump[kt]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let kt=32;kt<=55;kt++)jump[kt]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let kt=64;kt<=87;kt++)jump[kt]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let kt=96;kt<=119;kt++)jump[kt]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let kt=128;kt<=151;kt++)jump[kt]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let kt=160;kt<=183;kt++)jump[kt]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let kt=192;kt<=215;kt++)jump[kt]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let kt=224;kt<=243;kt++)jump[kt]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let kt=0;kt<24;kt++)quick[kt]=new Token(Type.uint,kt,1);for(let kt=-1;kt>=-24;kt--)quick[31-kt]=new Token(Type.negint,kt,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(kt){switch(kt.type){case Type.false:return fromArray$1([244]);case Type.true:return fromArray$1([245]);case Type.null:return fromArray$1([246]);case Type.bytes:return kt.value.length?void 0:fromArray$1([64]);case Type.string:return kt.value===""?fromArray$1([96]):void 0;case Type.array:return kt.value===0?fromArray$1([128]):void 0;case Type.map:return kt.value===0?fromArray$1([160]):void 0;case Type.uint:return kt.value<24?fromArray$1([Number(kt.value)]):void 0;case Type.negint:if(kt.value>=-24)return fromArray$1([31-Number(kt.value)])}}const defaultEncodeOptions={float64:!1,mapSorter,quickEncodeToken};function makeCborEncoders(){const kt=[];return kt[Type.uint.major]=encodeUint,kt[Type.negint.major]=encodeNegint,kt[Type.bytes.major]=encodeBytes,kt[Type.string.major]=encodeString,kt[Type.array.major]=encodeArray,kt[Type.map.major]=encodeMap,kt[Type.tag.major]=encodeTag,kt[Type.float.major]=encodeFloat,kt}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(At,xt){this.obj=At,this.parent=xt}includes(At){let xt=this;do if(xt.obj===At)return!0;while(xt=xt.parent);return!1}static createCheck(At,xt){if(At&&At.includes(xt))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(xt,At)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(kt,At,xt,Bt){return!Number.isInteger(kt)||!Number.isSafeInteger(kt)?new Token(Type.float,kt):kt>=0?new Token(Type.uint,kt):new Token(Type.negint,kt)},bigint(kt,At,xt,Bt){return kt>=BigInt(0)?new Token(Type.uint,kt):new Token(Type.negint,kt)},Uint8Array(kt,At,xt,Bt){return new Token(Type.bytes,kt)},string(kt,At,xt,Bt){return new Token(Type.string,kt)},boolean(kt,At,xt,Bt){return kt?simpleTokens.true:simpleTokens.false},null(kt,At,xt,Bt){return simpleTokens.null},undefined(kt,At,xt,Bt){return simpleTokens.undefined},ArrayBuffer(kt,At,xt,Bt){return new Token(Type.bytes,new Uint8Array(kt))},DataView(kt,At,xt,Bt){return new Token(Type.bytes,new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength))},Array(kt,At,xt,Bt){if(!kt.length)return xt.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;Bt=Ref.createCheck(Bt,kt);const Nt=[];let jt=0;for(const Ut of kt)Nt[jt++]=objectToTokens(Ut,xt,Bt);return xt.addBreakTokens?[new Token(Type.array,kt.length),Nt,new Token(Type.break)]:[new Token(Type.array,kt.length),Nt]},Object(kt,At,xt,Bt){const Nt=At!=="Object",jt=Nt?kt.keys():Object.keys(kt),Ut=Nt?kt.size:jt.length;if(!Ut)return xt.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;Bt=Ref.createCheck(Bt,kt);const Lt=[];let Ht=0;for(const Vt of jt)Lt[Ht++]=[objectToTokens(Vt,xt,Bt),objectToTokens(Nt?kt.get(Vt):kt[Vt],xt,Bt)];return sortMapEntries(Lt,xt),xt.addBreakTokens?[new Token(Type.map,Ut),Lt,new Token(Type.break)]:[new Token(Type.map,Ut),Lt]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const kt of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${kt}Array`]=typeEncoders.DataView;function objectToTokens(kt,At={},xt){const Bt=is(kt),Nt=At&&At.typeEncoders&&At.typeEncoders[Bt]||typeEncoders[Bt];if(typeof Nt=="function"){const Ut=Nt(kt,Bt,At,xt);if(Ut!=null)return Ut}const jt=typeEncoders[Bt];if(!jt)throw new Error(`${encodeErrPrefix} unsupported type: ${Bt}`);return jt(kt,Bt,At,xt)}function sortMapEntries(kt,At){At.mapSorter&&kt.sort(At.mapSorter)}function mapSorter(kt,At){const xt=Array.isArray(kt[0])?kt[0][0]:kt[0],Bt=Array.isArray(At[0])?At[0][0]:At[0];if(xt.type!==Bt.type)return xt.type.compare(Bt.type);const Nt=xt.type.major,jt=cborEncoders[Nt].compareTokens(xt,Bt);return jt===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),jt}function tokensToEncoded(kt,At,xt,Bt){if(Array.isArray(At))for(const Nt of At)tokensToEncoded(kt,Nt,xt,Bt);else xt[At.type.major](kt,At,Bt)}function encodeCustom(kt,At,xt){const Bt=objectToTokens(kt,xt);if(!Array.isArray(Bt)&&xt.quickEncodeToken){const Nt=xt.quickEncodeToken(Bt);if(Nt)return Nt;const jt=At[Bt.type.major];if(jt.encodedSize){const Ut=jt.encodedSize(Bt,xt),Lt=new Bl(Ut);if(jt(Lt,Bt,xt),Lt.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${Bt} was wrong`);return asU8A(Lt.chunks[0])}}return buf.reset(),tokensToEncoded(buf,Bt,At,xt),buf.toBytes(!0)}function encode$e(kt,At){return At=Object.assign({},defaultEncodeOptions,At),encodeCustom(kt,cborEncoders,At)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(At,xt={}){this.pos=0,this.data=At,this.options=xt}done(){return this.pos>=this.data.length}next(){const At=this.data[this.pos];let xt=quick[At];if(xt===void 0){const Bt=jump[At];if(!Bt)throw new Error(`${decodeErrPrefix} no decoder for major type ${At>>>5} (byte 0x${At.toString(16).padStart(2,"0")})`);const Nt=At&31;xt=Bt(this.data,this.pos,Nt,this.options)}return this.pos+=xt.encodedLength,xt}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(kt,At,xt){const Bt=[];for(let Nt=0;Nt<kt.value;Nt++){const jt=tokensToObject(At,xt);if(jt===BREAK){if(kt.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(jt===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${Nt}, expected ${kt.value})`);Bt[Nt]=jt}return Bt}function tokenToMap(kt,At,xt){const Bt=xt.useMaps===!0,Nt=Bt?void 0:{},jt=Bt?new Map:void 0;for(let Ut=0;Ut<kt.value;Ut++){const Lt=tokensToObject(At,xt);if(Lt===BREAK){if(kt.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(Lt===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${Ut} [no key], expected ${kt.value})`);if(Bt!==!0&&typeof Lt!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof Lt})`);if(xt.rejectDuplicateMapKeys===!0&&(Bt&&jt.has(Lt)||!Bt&&Lt in Nt))throw new Error(`${decodeErrPrefix} found repeat map key "${Lt}"`);const Ht=tokensToObject(At,xt);if(Ht===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${Ut} [no value], expected ${kt.value})`);Bt?jt.set(Lt,Ht):Nt[Lt]=Ht}return Bt?jt:Nt}function tokensToObject(kt,At){if(kt.done())return DONE;const xt=kt.next();if(xt.type===Type.break)return BREAK;if(xt.type.terminal)return xt.value;if(xt.type===Type.array)return tokenToArray(xt,kt,At);if(xt.type===Type.map)return tokenToMap(xt,kt,At);if(xt.type===Type.tag){if(At.tags&&typeof At.tags[xt.value]=="function"){const Bt=tokensToObject(kt,At);return At.tags[xt.value](Bt)}throw new Error(`${decodeErrPrefix} tag not supported (${xt.value})`)}throw new Error("unsupported")}function decode$g(kt,At){if(!(kt instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);At=Object.assign({},defaultDecodeOptions,At);const xt=At.tokenizer||new Tokeniser(kt,At),Bt=tokensToObject(xt,At);if(Bt===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(Bt===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);if(!xt.done())throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return Bt}function base$3(kt,At){if(kt.length>=255)throw new TypeError("Alphabet too long");for(var xt=new Uint8Array(256),Bt=0;Bt<xt.length;Bt++)xt[Bt]=255;for(var Nt=0;Nt<kt.length;Nt++){var jt=kt.charAt(Nt),Ut=jt.charCodeAt(0);if(xt[Ut]!==255)throw new TypeError(jt+" is ambiguous");xt[Ut]=Nt}var Lt=kt.length,Ht=kt.charAt(0),Vt=Math.log(Lt)/Math.log(256),zt=Math.log(256)/Math.log(Lt);function Wt(Xt){if(Xt instanceof Uint8Array||(ArrayBuffer.isView(Xt)?Xt=new Uint8Array(Xt.buffer,Xt.byteOffset,Xt.byteLength):Array.isArray(Xt)&&(Xt=Uint8Array.from(Xt))),!(Xt instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Xt.length===0)return"";for(var tr=0,rr=0,nr=0,ar=Xt.length;nr!==ar&&Xt[nr]===0;)nr++,tr++;for(var ir=(ar-nr)*zt+1>>>0,lr=new Uint8Array(ir);nr!==ar;){for(var yr=Xt[nr],Sr=0,Ar=ir-1;(yr!==0||Sr<rr)&&Ar!==-1;Ar--,Sr++)yr+=256*lr[Ar]>>>0,lr[Ar]=yr%Lt>>>0,yr=yr/Lt>>>0;if(yr!==0)throw new Error("Non-zero carry");rr=Sr,nr++}for(var Dr=ir-rr;Dr!==ir&&lr[Dr]===0;)Dr++;for(var Br=Ht.repeat(tr);Dr<ir;++Dr)Br+=kt.charAt(lr[Dr]);return Br}function Jt(Xt){if(typeof Xt!="string")throw new TypeError("Expected String");if(Xt.length===0)return new Uint8Array;var tr=0;if(Xt[tr]!==" "){for(var rr=0,nr=0;Xt[tr]===Ht;)rr++,tr++;for(var ar=(Xt.length-tr)*Vt+1>>>0,ir=new Uint8Array(ar);Xt[tr];){var lr=xt[Xt.charCodeAt(tr)];if(lr===255)return;for(var yr=0,Sr=ar-1;(lr!==0||yr<nr)&&Sr!==-1;Sr--,yr++)lr+=Lt*ir[Sr]>>>0,ir[Sr]=lr%256>>>0,lr=lr/256>>>0;if(lr!==0)throw new Error("Non-zero carry");nr=yr,tr++}if(Xt[tr]!==" "){for(var Ar=ar-nr;Ar!==ar&&ir[Ar]===0;)Ar++;for(var Dr=new Uint8Array(rr+(ar-Ar)),Br=rr;Ar!==ar;)Dr[Br++]=ir[Ar++];return Dr}}}function Qt(Xt){var tr=Jt(Xt);if(tr)return tr;throw new Error(`Non-${At} character`)}return{encode:Wt,decodeUnsafe:Jt,decode:Qt}}var src$1=base$3,_brrp__multiformats_scope_baseX$1=src$1;const equals$1=(kt,At)=>{if(kt===At)return!0;if(kt.byteLength!==At.byteLength)return!1;for(let xt=0;xt<kt.byteLength;xt++)if(kt[xt]!==At[xt])return!1;return!0},coerce$1=kt=>{if(kt instanceof Uint8Array&&kt.constructor.name==="Uint8Array")return kt;if(kt instanceof ArrayBuffer)return new Uint8Array(kt);if(ArrayBuffer.isView(kt))return new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength);throw new Error("Unknown type, must be binary type")},fromString$1=kt=>new TextEncoder().encode(kt),toString$6=kt=>new TextDecoder().decode(kt);let Encoder$2=class{constructor(At,xt,Bt){this.name=At,this.prefix=xt,this.baseEncode=Bt}encode(At){if(At instanceof Uint8Array)return`${this.prefix}${this.baseEncode(At)}`;throw Error("Unknown type, must be binary type")}},Decoder$1=class{constructor(At,xt,Bt){if(this.name=At,this.prefix=xt,xt.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=xt.codePointAt(0),this.baseDecode=Bt}decode(At){if(typeof At=="string"){if(At.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(At)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(At.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(At){return or$1(this,At)}},ComposedDecoder$1=class{constructor(At){this.decoders=At}or(At){return or$1(this,At)}decode(At){const xt=At[0],Bt=this.decoders[xt];if(Bt)return Bt.decode(At);throw RangeError(`Unable to decode multibase string ${JSON.stringify(At)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$1=(kt,At)=>new ComposedDecoder$1({...kt.decoders||{[kt.prefix]:kt},...At.decoders||{[At.prefix]:At}});let Codec$1=class{constructor(At,xt,Bt,Nt){this.name=At,this.prefix=xt,this.baseEncode=Bt,this.baseDecode=Nt,this.encoder=new Encoder$2(At,xt,Bt),this.decoder=new Decoder$1(At,xt,Nt)}encode(At){return this.encoder.encode(At)}decode(At){return this.decoder.decode(At)}};const from$6=({name:kt,prefix:At,encode:xt,decode:Bt})=>new Codec$1(kt,At,xt,Bt),baseX$1=({prefix:kt,name:At,alphabet:xt})=>{const{encode:Bt,decode:Nt}=_brrp__multiformats_scope_baseX$1(xt,At);return from$6({prefix:kt,name:At,encode:Bt,decode:jt=>coerce$1(Nt(jt))})},decode$f=(kt,At,xt,Bt)=>{const Nt={};for(let zt=0;zt<At.length;++zt)Nt[At[zt]]=zt;let jt=kt.length;for(;kt[jt-1]==="=";)--jt;const Ut=new Uint8Array(jt*xt/8|0);let Lt=0,Ht=0,Vt=0;for(let zt=0;zt<jt;++zt){const Wt=Nt[kt[zt]];if(Wt===void 0)throw new SyntaxError(`Non-${Bt} character`);Ht=Ht<<xt|Wt,Lt+=xt,Lt>=8&&(Lt-=8,Ut[Vt++]=255&Ht>>Lt)}if(Lt>=xt||255&Ht<<8-Lt)throw new SyntaxError("Unexpected end of data");return Ut},encode$d=(kt,At,xt)=>{const Bt=At[At.length-1]==="=",Nt=(1<<xt)-1;let jt="",Ut=0,Lt=0;for(let Ht=0;Ht<kt.length;++Ht)for(Lt=Lt<<8|kt[Ht],Ut+=8;Ut>xt;)Ut-=xt,jt+=At[Nt&Lt>>Ut];if(Ut&&(jt+=At[Nt&Lt<<xt-Ut]),Bt)for(;jt.length*xt&7;)jt+="=";return jt},rfc4648$1=({name:kt,prefix:At,bitsPerChar:xt,alphabet:Bt})=>from$6({prefix:At,name:kt,encode(Nt){return encode$d(Nt,Bt,xt)},decode(Nt){return decode$f(Nt,Bt,xt,kt)}}),base32$1=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$2=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$1,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),base58btc$2=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr},Symbol.toStringTag,{value:"Module"}));var encode_1$1=encode$c,MSB$3=128,REST$3=127,MSBALL$1=~REST$3,INT$1=Math.pow(2,31);function encode$c(kt,At,xt){At=At||[],xt=xt||0;for(var Bt=xt;kt>=INT$1;)At[xt++]=kt&255|MSB$3,kt/=128;for(;kt&MSBALL$1;)At[xt++]=kt&255|MSB$3,kt>>>=7;return At[xt]=kt|0,encode$c.bytes=xt-Bt+1,At}var decode$e=read$2,MSB$1$1=128,REST$1$1=127;function read$2(kt,Bt){var xt=0,Bt=Bt||0,Nt=0,jt=Bt,Ut,Lt=kt.length;do{if(jt>=Lt)throw read$2.bytes=0,new RangeError("Could not decode varint");Ut=kt[jt++],xt+=Nt<28?(Ut&REST$1$1)<<Nt:(Ut&REST$1$1)*Math.pow(2,Nt),Nt+=7}while(Ut>=MSB$1$1);return read$2.bytes=jt-Bt,xt}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(kt){return kt<N1$2?1:kt<N2$2?2:kt<N3$2?3:kt<N4$2?4:kt<N5$2?5:kt<N6$2?6:kt<N7$2?7:kt<N8$1?8:kt<N9$1?9:10},varint$1={encode:encode_1$1,decode:decode$e,encodingLength:length$2},_brrp_varint$1=varint$1;const decode$d=(kt,At=0)=>[_brrp_varint$1.decode(kt,At),_brrp_varint$1.decode.bytes],encodeTo$1=(kt,At,xt=0)=>(_brrp_varint$1.encode(kt,At,xt),At),encodingLength$6=kt=>_brrp_varint$1.encodingLength(kt),create=(kt,At)=>{const xt=At.byteLength,Bt=encodingLength$6(kt),Nt=Bt+encodingLength$6(xt),jt=new Uint8Array(Nt+xt);return encodeTo$1(kt,jt,0),encodeTo$1(xt,jt,Bt),jt.set(At,Nt),new Digest(kt,xt,At,jt)},decode$c=kt=>{const At=coerce$1(kt),[xt,Bt]=decode$d(At),[Nt,jt]=decode$d(At.subarray(Bt)),Ut=At.subarray(Bt+jt);if(Ut.byteLength!==Nt)throw new Error("Incorrect length");return new Digest(xt,Nt,Ut,At)},equals=(kt,At)=>{if(kt===At)return!0;{const xt=At;return kt.code===xt.code&&kt.size===xt.size&&xt.bytes instanceof Uint8Array&&equals$1(kt.bytes,xt.bytes)}};class Digest{constructor(At,xt,Bt,Nt){this.code=At,this.size=xt,this.digest=Bt,this.bytes=Nt}}const format$8=(kt,At)=>{const{bytes:xt,version:Bt}=kt;switch(Bt){case 0:return toStringV0$1(xt,baseCache$1(kt),At||base58btc$2.encoder);default:return toStringV1$1(xt,baseCache$1(kt),At||base32$1.encoder)}},cache$2=new WeakMap,baseCache$1=kt=>{const At=cache$2.get(kt);if(At==null){const xt=new Map;return cache$2.set(kt,xt),xt}return At};let CID$1=class yi{constructor(At,xt,Bt,Nt){this.code=xt,this.version=At,this.multihash=Bt,this.bytes=Nt,this["/"]=Nt}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:At,multihash:xt}=this;if(At!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(xt.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return yi.createV0(xt)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:At,digest:xt}=this.multihash,Bt=create(At,xt);return yi.createV1(this.code,Bt)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(At){return yi.equals(this,At)}static equals(At,xt){const Bt=xt;return Bt&&At.code===Bt.code&&At.version===Bt.version&&equals(At.multihash,Bt.multihash)}toString(At){return format$8(this,At)}toJSON(){return{"/":format$8(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(At){if(At==null)return null;const xt=At;if(xt instanceof yi)return xt;if(xt["/"]!=null&&xt["/"]===xt.bytes||xt.asCID===xt){const{version:Bt,code:Nt,multihash:jt,bytes:Ut}=xt;return new yi(Bt,Nt,jt,Ut||encodeCID$1(Bt,Nt,jt.bytes))}else if(xt[cidSymbol$1]===!0){const{version:Bt,multihash:Nt,code:jt}=xt,Ut=decode$c(Nt);return yi.create(Bt,jt,Ut)}else return null}static create(At,xt,Bt){if(typeof xt!="number")throw new Error("String codecs are no longer supported");if(!(Bt.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(At){case 0:{if(xt!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new yi(At,xt,Bt,Bt.bytes)}case 1:{const Nt=encodeCID$1(At,xt,Bt.bytes);return new yi(At,xt,Bt,Nt)}default:throw new Error("Invalid version")}}static createV0(At){return yi.create(0,DAG_PB_CODE$1,At)}static createV1(At,xt){return yi.create(1,At,xt)}static decode(At){const[xt,Bt]=yi.decodeFirst(At);if(Bt.length)throw new Error("Incorrect length");return xt}static decodeFirst(At){const xt=yi.inspectBytes(At),Bt=xt.size-xt.multihashSize,Nt=coerce$1(At.subarray(Bt,Bt+xt.multihashSize));if(Nt.byteLength!==xt.multihashSize)throw new Error("Incorrect length");const jt=Nt.subarray(xt.multihashSize-xt.digestSize),Ut=new Digest(xt.multihashCode,xt.digestSize,jt,Nt);return[xt.version===0?yi.createV0(Ut):yi.createV1(xt.codec,Ut),At.subarray(xt.size)]}static inspectBytes(At){let xt=0;const Bt=()=>{const[Wt,Jt]=decode$d(At.subarray(xt));return xt+=Jt,Wt};let Nt=Bt(),jt=DAG_PB_CODE$1;if(Nt===18?(Nt=0,xt=0):jt=Bt(),Nt!==0&&Nt!==1)throw new RangeError(`Invalid CID version ${Nt}`);const Ut=xt,Lt=Bt(),Ht=Bt(),Vt=xt+Ht,zt=Vt-Ut;return{version:Nt,codec:jt,multihashCode:Lt,digestSize:Ht,multihashSize:zt,size:Vt}}static parse(At,xt){const[Bt,Nt]=parseCIDtoBytes$1(At,xt),jt=yi.decode(Nt);if(jt.version===0&&At[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$1(jt).set(Bt,At),jt}};const parseCIDtoBytes$1=(kt,At)=>{switch(kt[0]){case"Q":{const xt=At||base58btc$2;return[base58btc$2.prefix,xt.decode(`${base58btc$2.prefix}${kt}`)]}case base58btc$2.prefix:{const xt=At||base58btc$2;return[base58btc$2.prefix,xt.decode(kt)]}case base32$1.prefix:{const xt=At||base32$1;return[base32$1.prefix,xt.decode(kt)]}default:{if(At==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[kt[0],At.decode(kt)]}}},toStringV0$1=(kt,At,xt)=>{const{prefix:Bt}=xt;if(Bt!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${xt.name} encoding`);const Nt=At.get(Bt);if(Nt==null){const jt=xt.encode(kt).slice(1);return At.set(Bt,jt),jt}else return Nt},toStringV1$1=(kt,At,xt)=>{const{prefix:Bt}=xt,Nt=At.get(Bt);if(Nt==null){const jt=xt.encode(kt);return At.set(Bt,jt),jt}else return Nt},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$1=(kt,At,xt)=>{const Bt=encodingLength$6(kt),Nt=Bt+encodingLength$6(At),jt=new Uint8Array(Nt+xt.byteLength);return encodeTo$1(kt,jt,0),encodeTo$1(At,jt,Bt),jt.set(xt,Nt),jt},cidSymbol$1=Symbol.for("@ipld/js-cid/CID"),CID_CBOR_TAG=42;function cidEncoder(kt){if(kt.asCID!==kt&&kt["/"]!==kt.bytes)return null;const At=CID$1.asCID(kt);if(!At)return null;const xt=new Uint8Array(At.bytes.byteLength+1);return xt.set(At.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,xt)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(kt){if(Number.isNaN(kt))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(kt===1/0||kt===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder,undefined:undefinedEncoder,number:numberEncoder}};function cidDecoder(kt){if(kt[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$1.decode(kt.subarray(1))}const decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const name$5="dag-cbor",code$5=113,encode$b=kt=>encode$e(kt,encodeOptions),decode$b=kt=>decode$g(kt,decodeOptions),cbor=Object.freeze(Object.defineProperty({__proto__:null,code:code$5,decode:decode$b,encode:encode$b,name:name$5},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});const base32=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const base32z$1=rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),format$7=(kt,At)=>{const{bytes:xt,version:Bt}=kt;switch(Bt){case 0:return toStringV0(xt,baseCache(kt),At||base58btc$1.encoder);default:return toStringV1(xt,baseCache(kt),At||base32.encoder)}},cache$1=new WeakMap,baseCache=kt=>{const At=cache$1.get(kt);if(At==null){const xt=new Map;return cache$1.set(kt,xt),xt}return At};class CID{constructor(At,xt,Bt,Nt){this.code=xt,this.version=At,this.multihash=Bt,this.bytes=Nt,this["/"]=Nt}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:At,multihash:xt}=this;if(At!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(xt.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(xt)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:At,digest:xt}=this.multihash,Bt=create$2(At,xt);return CID.createV1(this.code,Bt)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(At){return CID.equals(this,At)}static equals(At,xt){const Bt=xt;return Bt&&At.code===Bt.code&&At.version===Bt.version&&equals$5(At.multihash,Bt.multihash)}toString(At){return format$7(this,At)}toJSON(){return{"/":format$7(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(At){if(At==null)return null;const xt=At;if(xt instanceof CID)return xt;if(xt["/"]!=null&&xt["/"]===xt.bytes||xt.asCID===xt){const{version:Bt,code:Nt,multihash:jt,bytes:Ut}=xt;return new CID(Bt,Nt,jt,Ut||encodeCID(Bt,Nt,jt.bytes))}else if(xt[cidSymbol]===!0){const{version:Bt,multihash:Nt,code:jt}=xt,Ut=decode$m(Nt);return CID.create(Bt,jt,Ut)}else return null}static create(At,xt,Bt){if(typeof xt!="number")throw new Error("String codecs are no longer supported");if(!(Bt.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(At){case 0:{if(xt!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(At,xt,Bt,Bt.bytes)}case 1:{const Nt=encodeCID(At,xt,Bt.bytes);return new CID(At,xt,Bt,Nt)}default:throw new Error("Invalid version")}}static createV0(At){return CID.create(0,DAG_PB_CODE,At)}static createV1(At,xt){return CID.create(1,At,xt)}static decode(At){const[xt,Bt]=CID.decodeFirst(At);if(Bt.length)throw new Error("Incorrect length");return xt}static decodeFirst(At){const xt=CID.inspectBytes(At),Bt=xt.size-xt.multihashSize,Nt=coerce$3(At.subarray(Bt,Bt+xt.multihashSize));if(Nt.byteLength!==xt.multihashSize)throw new Error("Incorrect length");const jt=Nt.subarray(xt.multihashSize-xt.digestSize),Ut=new Digest$2(xt.multihashCode,xt.digestSize,jt,Nt);return[xt.version===0?CID.createV0(Ut):CID.createV1(xt.codec,Ut),At.subarray(xt.size)]}static inspectBytes(At){let xt=0;const Bt=()=>{const[Wt,Jt]=decode$n(At.subarray(xt));return xt+=Jt,Wt};let Nt=Bt(),jt=DAG_PB_CODE;if(Nt===18?(Nt=0,xt=0):jt=Bt(),Nt!==0&&Nt!==1)throw new RangeError(`Invalid CID version ${Nt}`);const Ut=xt,Lt=Bt(),Ht=Bt(),Vt=xt+Ht,zt=Vt-Ut;return{version:Nt,codec:jt,multihashCode:Lt,digestSize:Ht,multihashSize:zt,size:Vt}}static parse(At,xt){const[Bt,Nt]=parseCIDtoBytes(At,xt),jt=CID.decode(Nt);if(jt.version===0&&At[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache(jt).set(Bt,At),jt}}const parseCIDtoBytes=(kt,At)=>{switch(kt[0]){case"Q":{const xt=At||base58btc$1;return[base58btc$1.prefix,xt.decode(`${base58btc$1.prefix}${kt}`)]}case base58btc$1.prefix:{const xt=At||base58btc$1;return[base58btc$1.prefix,xt.decode(kt)]}case base32.prefix:{const xt=At||base32;return[base32.prefix,xt.decode(kt)]}default:{if(At==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[kt[0],At.decode(kt)]}}},toStringV0=(kt,At,xt)=>{const{prefix:Bt}=xt;if(Bt!==base58btc$1.prefix)throw Error(`Cannot string encode V0 in ${xt.name} encoding`);const Nt=At.get(Bt);if(Nt==null){const jt=xt.encode(kt).slice(1);return At.set(Bt,jt),jt}else return Nt},toStringV1=(kt,At,xt)=>{const{prefix:Bt}=xt,Nt=At.get(Bt);if(Nt==null){const jt=xt.encode(kt);return At.set(Bt,jt),jt}else return Nt},DAG_PB_CODE=112,SHA_256_CODE=18,encodeCID=(kt,At,xt)=>{const Bt=encodingLength$8(kt),Nt=Bt+encodingLength$8(At),jt=new Uint8Array(Nt+xt.byteLength);return encodeTo$3(kt,jt,0),encodeTo$3(At,jt,Bt),jt.set(xt,Nt),jt},cidSymbol=Symbol.for("@ipld/js-cid/CID");var __awaiter$2C=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$a=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}},__await$6=function(kt){return this instanceof __await$6?(this.v=kt,this):new __await$6(kt)},__asyncGenerator$4=function(kt,At,xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Bt=xt.apply(kt,At||[]),Nt,jt=[];return Nt={},Ut("next"),Ut("throw"),Ut("return"),Nt[Symbol.asyncIterator]=function(){return this},Nt;function Ut(Jt){Bt[Jt]&&(Nt[Jt]=function(Qt){return new Promise(function(Xt,tr){jt.push([Jt,Qt,Xt,tr])>1||Lt(Jt,Qt)})})}function Lt(Jt,Qt){try{Ht(Bt[Jt](Qt))}catch(Xt){Wt(jt[0][3],Xt)}}function Ht(Jt){Jt.value instanceof __await$6?Promise.resolve(Jt.value.v).then(Vt,zt):Wt(jt[0][2],Jt)}function Vt(Jt){Lt("next",Jt)}function zt(Jt){Lt("throw",Jt)}function Wt(Jt,Qt){Jt(Qt),jt.shift(),jt.length&&Lt(jt[0][0],jt[0][1])}};class BlockstoreMock{open(){return __awaiter$2C(this,void 0,void 0,function*(){})}close(){return __awaiter$2C(this,void 0,void 0,function*(){})}put(At,xt,Bt){return __awaiter$2C(this,void 0,void 0,function*(){return At})}get(At,xt){return __awaiter$2C(this,void 0,void 0,function*(){return new Uint8Array})}has(At,xt){return __awaiter$2C(this,void 0,void 0,function*(){return!1})}delete(At,xt){return __awaiter$2C(this,void 0,void 0,function*(){})}isEmpty(At){return __awaiter$2C(this,void 0,void 0,function*(){return!0})}putMany(At,xt){return __asyncGenerator$4(this,arguments,function*(){var Nt,jt,Ut,Lt;try{for(var Ht=!0,Vt=__asyncValues$a(At),zt;zt=yield __await$6(Vt.next()),Nt=zt.done,!Nt;Ht=!0){Lt=zt.value,Ht=!1;const Wt=Lt;yield __await$6(this.put(Wt.cid,Wt.block,xt)),yield yield __await$6(Wt.cid)}}catch(Wt){jt={error:Wt}}finally{try{!Ht&&!Nt&&(Ut=Vt.return)&&(yield __await$6(Ut.call(Vt)))}finally{if(jt)throw jt.error}}})}getMany(At,xt){return __asyncGenerator$4(this,arguments,function*(){var Nt,jt,Ut,Lt;try{for(var Ht=!0,Vt=__asyncValues$a(At),zt;zt=yield __await$6(Vt.next()),Nt=zt.done,!Nt;Ht=!0){Lt=zt.value,Ht=!1;const Wt=Lt;yield yield __await$6({cid:Wt,block:yield __await$6(this.get(Wt,xt))})}}catch(Wt){jt={error:Wt}}finally{try{!Ht&&!Nt&&(Ut=Vt.return)&&(yield __await$6(Ut.call(Vt)))}finally{if(jt)throw jt.error}}})}getAll(At){return __asyncGenerator$4(this,arguments,function*(){var Bt,Nt,jt,Ut;const Lt=this.db.iterator({keys:!0,keyEncoding:"buffer"},At);try{for(var Ht=!0,Vt=__asyncValues$a(Lt),zt;zt=yield __await$6(Vt.next()),Bt=zt.done,!Bt;Ht=!0){Ut=zt.value,Ht=!1;const[Wt,Jt]=Ut;yield yield __await$6({cid:CID.decode(Wt),block:Jt})}}catch(Wt){Nt={error:Wt}}finally{try{!Ht&&!Bt&&(jt=Vt.return)&&(yield __await$6(jt.call(Vt)))}finally{if(Nt)throw Nt.error}}})}deleteMany(At,xt){return __asyncGenerator$4(this,arguments,function*(){var Nt,jt,Ut,Lt;try{for(var Ht=!0,Vt=__asyncValues$a(At),zt;zt=yield __await$6(Vt.next()),Nt=zt.done,!Nt;Ht=!0){Lt=zt.value,Ht=!1;const Wt=Lt;yield __await$6(this.delete(Wt,xt)),yield yield __await$6(Wt)}}catch(Wt){jt={error:Wt}}finally{try{!Ht&&!Nt&&(Ut=Vt.return)&&(yield __await$6(Ut.call(Vt)))}finally{if(jt)throw jt.error}}})}clear(){return __awaiter$2C(this,void 0,void 0,function*(){})}}function assign(kt,At){for(const xt in At)Object.defineProperty(kt,xt,{value:At[xt],enumerable:!0,configurable:!0});return kt}function createError(kt,At,xt){if(!kt||typeof kt=="string")throw new TypeError("Please pass an Error to err-code");xt||(xt={}),typeof At=="object"&&(xt=At,At=""),At&&(xt.code=At);try{return assign(kt,xt)}catch{xt.message=kt.message,xt.stack=kt.stack;const Nt=function(){};return Nt.prototype=Object.create(Object.getPrototypeOf(kt)),assign(new Nt,xt)}}var errCode=createError;const errCode$1=getDefaultExportFromCjs(errCode);function isAsyncIterable$9(kt){return kt[Symbol.asyncIterator]!=null}function batch(kt,At=1){return At=Number(At),isAsyncIterable$9(kt)?async function*(){let xt=[];if(At<1&&(At=1),At!==Math.round(At))throw new Error("Batch size must be an integer");for await(const Bt of kt)for(xt.push(Bt);xt.length>=At;)yield xt.slice(0,At),xt=xt.slice(At);for(;xt.length>0;)yield xt.slice(0,At),xt=xt.slice(At)}():function*(){let xt=[];if(At<1&&(At=1),At!==Math.round(At))throw new Error("Batch size must be an integer");for(const Bt of kt)for(xt.push(Bt);xt.length>=At;)yield xt.slice(0,At),xt=xt.slice(At);for(;xt.length>0;)yield xt.slice(0,At),xt=xt.slice(At)}()}async function*parallelBatch(kt,At=1){for await(const xt of batch(kt,At)){const Bt=xt.map(async Nt=>Nt().then(jt=>({ok:!0,value:jt}),jt=>({ok:!1,err:jt})));for(let Nt=0;Nt<Bt.length;Nt++){const jt=await Bt[Nt];if(jt.ok)yield jt.value;else throw jt.err}}}const symbol=Symbol.for("@achingbrain/uint8arraylist");function findBufAndOffset(kt,At){if(At==null||At<0)throw new RangeError("index is out of bounds");let xt=0;for(const Bt of kt){const Nt=xt+Bt.byteLength;if(At<Nt)return{buf:Bt,index:At-xt};xt=Nt}throw new RangeError("index is out of bounds")}function isUint8ArrayList(kt){return!!(kt!=null&&kt[symbol])}class Uint8ArrayList{bufs;length;[symbol]=!0;constructor(...At){this.bufs=[],this.length=0,At.length>0&&this.appendAll(At)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...At){this.appendAll(At)}appendAll(At){let xt=0;for(const Bt of At)if(Bt instanceof Uint8Array)xt+=Bt.byteLength,this.bufs.push(Bt);else if(isUint8ArrayList(Bt))xt+=Bt.byteLength,this.bufs.push(...Bt.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=xt}prepend(...At){this.prependAll(At)}prependAll(At){let xt=0;for(const Bt of At.reverse())if(Bt instanceof Uint8Array)xt+=Bt.byteLength,this.bufs.unshift(Bt);else if(isUint8ArrayList(Bt))xt+=Bt.byteLength,this.bufs.unshift(...Bt.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=xt}get(At){const xt=findBufAndOffset(this.bufs,At);return xt.buf[xt.index]}set(At,xt){const Bt=findBufAndOffset(this.bufs,At);Bt.buf[Bt.index]=xt}write(At,xt=0){if(At instanceof Uint8Array)for(let Bt=0;Bt<At.length;Bt++)this.set(xt+Bt,At[Bt]);else if(isUint8ArrayList(At))for(let Bt=0;Bt<At.length;Bt++)this.set(xt+Bt,At.get(Bt));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(At){if(At=Math.trunc(At),!(Number.isNaN(At)||At<=0)){if(At===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(At>=this.bufs[0].byteLength)At-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(At),this.length-=At;break}}}slice(At,xt){const{bufs:Bt,length:Nt}=this._subList(At,xt);return concat$2(Bt,Nt)}subarray(At,xt){const{bufs:Bt,length:Nt}=this._subList(At,xt);return Bt.length===1?Bt[0]:concat$2(Bt,Nt)}sublist(At,xt){const{bufs:Bt,length:Nt}=this._subList(At,xt),jt=new Uint8ArrayList;return jt.length=Nt,jt.bufs=[...Bt],jt}_subList(At,xt){if(At=At??0,xt=xt??this.length,At<0&&(At=this.length+At),xt<0&&(xt=this.length+xt),At<0||xt>this.length)throw new RangeError("index is out of bounds");if(At===xt)return{bufs:[],length:0};if(At===0&&xt===this.length)return{bufs:this.bufs,length:this.length};const Bt=[];let Nt=0;for(let jt=0;jt<this.bufs.length;jt++){const Ut=this.bufs[jt],Lt=Nt,Ht=Lt+Ut.byteLength;if(Nt=Ht,At>=Ht)continue;const Vt=At>=Lt&&At<Ht,zt=xt>Lt&&xt<=Ht;if(Vt&&zt){if(At===Lt&&xt===Ht){Bt.push(Ut);break}const Wt=At-Lt;Bt.push(Ut.subarray(Wt,Wt+(xt-At)));break}if(Vt){if(At===0){Bt.push(Ut);continue}Bt.push(Ut.subarray(At-Lt));continue}if(zt){if(xt===Ht){Bt.push(Ut);break}Bt.push(Ut.subarray(0,xt-Lt));break}Bt.push(Ut)}return{bufs:Bt,length:xt-At}}indexOf(At,xt=0){if(!isUint8ArrayList(At)&&!(At instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const Bt=At instanceof Uint8Array?At:At.subarray();if(xt=Number(xt??0),isNaN(xt)&&(xt=0),xt<0&&(xt=this.length+xt),xt<0&&(xt=0),At.length===0)return xt>this.length?this.length:xt;const Nt=Bt.byteLength;if(Nt===0)throw new TypeError("search must be at least 1 byte long");const jt=256,Ut=new Int32Array(jt);for(let Wt=0;Wt<jt;Wt++)Ut[Wt]=-1;for(let Wt=0;Wt<Nt;Wt++)Ut[Bt[Wt]]=Wt;const Lt=Ut,Ht=this.byteLength-Bt.byteLength,Vt=Bt.byteLength-1;let zt;for(let Wt=xt;Wt<=Ht;Wt+=zt){zt=0;for(let Jt=Vt;Jt>=0;Jt--){const Qt=this.get(Wt+Jt);if(Bt[Jt]!==Qt){zt=Math.max(1,Jt-Lt[Qt]);break}}if(zt===0)return Wt}return-1}getInt8(At){const xt=this.subarray(At,At+1);return new DataView(xt.buffer,xt.byteOffset,xt.byteLength).getInt8(0)}setInt8(At,xt){const Bt=allocUnsafe$1(1);new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).setInt8(0,xt),this.write(Bt,At)}getInt16(At,xt){const Bt=this.subarray(At,At+2);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getInt16(0,xt)}setInt16(At,xt,Bt){const Nt=alloc$3(2);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setInt16(0,xt,Bt),this.write(Nt,At)}getInt32(At,xt){const Bt=this.subarray(At,At+4);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getInt32(0,xt)}setInt32(At,xt,Bt){const Nt=alloc$3(4);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setInt32(0,xt,Bt),this.write(Nt,At)}getBigInt64(At,xt){const Bt=this.subarray(At,At+8);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getBigInt64(0,xt)}setBigInt64(At,xt,Bt){const Nt=alloc$3(8);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setBigInt64(0,xt,Bt),this.write(Nt,At)}getUint8(At){const xt=this.subarray(At,At+1);return new DataView(xt.buffer,xt.byteOffset,xt.byteLength).getUint8(0)}setUint8(At,xt){const Bt=allocUnsafe$1(1);new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).setUint8(0,xt),this.write(Bt,At)}getUint16(At,xt){const Bt=this.subarray(At,At+2);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getUint16(0,xt)}setUint16(At,xt,Bt){const Nt=alloc$3(2);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setUint16(0,xt,Bt),this.write(Nt,At)}getUint32(At,xt){const Bt=this.subarray(At,At+4);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getUint32(0,xt)}setUint32(At,xt,Bt){const Nt=alloc$3(4);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setUint32(0,xt,Bt),this.write(Nt,At)}getBigUint64(At,xt){const Bt=this.subarray(At,At+8);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getBigUint64(0,xt)}setBigUint64(At,xt,Bt){const Nt=alloc$3(8);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setBigUint64(0,xt,Bt),this.write(Nt,At)}getFloat32(At,xt){const Bt=this.subarray(At,At+4);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getFloat32(0,xt)}setFloat32(At,xt,Bt){const Nt=alloc$3(4);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setFloat32(0,xt,Bt),this.write(Nt,At)}getFloat64(At,xt){const Bt=this.subarray(At,At+8);return new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength).getFloat64(0,xt)}setFloat64(At,xt,Bt){const Nt=alloc$3(8);new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength).setFloat64(0,xt,Bt),this.write(Nt,At)}equals(At){if(At==null||!(At instanceof Uint8ArrayList)||At.bufs.length!==this.bufs.length)return!1;for(let xt=0;xt<this.bufs.length;xt++)if(!equals$4(this.bufs[xt],At.bufs[xt]))return!1;return!0}static fromUint8Arrays(At,xt){const Bt=new Uint8ArrayList;return Bt.bufs=At,xt==null&&(xt=At.reduce((Nt,jt)=>Nt+jt.byteLength,0)),Bt.length=xt,Bt}}const DEFAULT_CHUNK_SIZE=262144,fixedSize=(kt={})=>{const At=kt.chunkSize??DEFAULT_CHUNK_SIZE;return async function*(Bt){let Nt=new Uint8ArrayList,jt=0,Ut=!1;for await(const Lt of Bt)for(Nt.append(Lt),jt+=Lt.length;jt>=At;)if(yield Nt.slice(0,At),Ut=!0,At===Nt.length)Nt=new Uint8ArrayList,jt=0;else{const Ht=new Uint8ArrayList;Ht.append(Nt.sublist(At)),Nt=Ht,jt-=At}(!Ut||jt>0)&&(yield Nt.subarray(0,jt))}},textDecoder$4=new TextDecoder;function decodeVarint(kt,At){let xt=0;for(let Bt=0;;Bt+=7){if(Bt>=64)throw new Error("protobuf: varint overflow");if(At>=kt.length)throw new Error("protobuf: unexpected end of data");const Nt=kt[At++];if(xt+=Bt<28?(Nt&127)<<Bt:(Nt&127)*2**Bt,Nt<128)break}return[xt,At]}function decodeBytes(kt,At){let xt;[xt,At]=decodeVarint(kt,At);const Bt=At+xt;if(xt<0||Bt<0)throw new Error("protobuf: invalid length");if(Bt>kt.length)throw new Error("protobuf: unexpected end of data");return[kt.subarray(At,Bt),Bt]}function decodeKey(kt,At){let xt;return[xt,At]=decodeVarint(kt,At),[xt&7,xt>>3,At]}function decodeLink(kt){const At={},xt=kt.length;let Bt=0;for(;Bt<xt;){let Nt,jt;if([Nt,jt,Bt]=decodeKey(kt,Bt),jt===1){if(At.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(Nt!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${Nt}) for Hash`);if(At.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(At.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[At.Hash,Bt]=decodeBytes(kt,Bt)}else if(jt===2){if(At.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(Nt!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${Nt}) for Name`);if(At.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let Ut;[Ut,Bt]=decodeBytes(kt,Bt),At.Name=textDecoder$4.decode(Ut)}else if(jt===3){if(At.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(Nt!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${Nt}) for Tsize`);[At.Tsize,Bt]=decodeVarint(kt,Bt)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${jt}`)}if(Bt>xt)throw new Error("protobuf: (PBLink) unexpected end of data");return At}function decodeNode(kt){const At=kt.length;let xt=0,Bt,Nt=!1,jt;for(;xt<At;){let Lt,Ht;if([Lt,Ht,xt]=decodeKey(kt,xt),Lt!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${Lt}`);if(Ht===1){if(jt)throw new Error("protobuf: (PBNode) duplicate Data section");[jt,xt]=decodeBytes(kt,xt),Bt&&(Nt=!0)}else if(Ht===2){if(Nt)throw new Error("protobuf: (PBNode) duplicate Links section");Bt||(Bt=[]);let Vt;[Vt,xt]=decodeBytes(kt,xt),Bt.push(decodeLink(Vt))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${Ht}`)}if(xt>At)throw new Error("protobuf: (PBNode) unexpected end of data");const Ut={};return jt&&(Ut.Data=jt),Ut.Links=Bt||[],Ut}const textEncoder$6=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(kt,At){let xt=At.length;if(typeof kt.Tsize=="number"){if(kt.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(kt.Tsize))throw new Error("Tsize too large for encoding");xt=encodeVarint(At,xt,kt.Tsize)-1,At[xt]=24}if(typeof kt.Name=="string"){const Bt=textEncoder$6.encode(kt.Name);xt-=Bt.length,At.set(Bt,xt),xt=encodeVarint(At,xt,Bt.length)-1,At[xt]=18}return kt.Hash&&(xt-=kt.Hash.length,At.set(kt.Hash,xt),xt=encodeVarint(At,xt,kt.Hash.length)-1,At[xt]=10),At.length-xt}function encodeNode(kt){const At=sizeNode(kt),xt=new Uint8Array(At);let Bt=At;if(kt.Data&&(Bt-=kt.Data.length,xt.set(kt.Data,Bt),Bt=encodeVarint(xt,Bt,kt.Data.length)-1,xt[Bt]=10),kt.Links)for(let Nt=kt.Links.length-1;Nt>=0;Nt--){const jt=encodeLink(kt.Links[Nt],xt.subarray(0,Bt));Bt-=jt,Bt=encodeVarint(xt,Bt,jt)-1,xt[Bt]=18}return xt}function sizeLink(kt){let At=0;if(kt.Hash){const xt=kt.Hash.length;At+=1+xt+sov(xt)}if(typeof kt.Name=="string"){const xt=textEncoder$6.encode(kt.Name).length;At+=1+xt+sov(xt)}return typeof kt.Tsize=="number"&&(At+=1+sov(kt.Tsize)),At}function sizeNode(kt){let At=0;if(kt.Data){const xt=kt.Data.length;At+=1+xt+sov(xt)}if(kt.Links)for(const xt of kt.Links){const Bt=sizeLink(xt);At+=1+Bt+sov(Bt)}return At}function encodeVarint(kt,At,xt){At-=sov(xt);const Bt=At;for(;xt>=maxUInt32;)kt[At++]=xt&127|128,xt/=128;for(;xt>=128;)kt[At++]=xt&127|128,xt>>>=7;return kt[At]=xt,Bt}function sov(kt){return kt%2===0&&kt++,Math.floor((len64(kt)+6)/7)}function len64(kt){let At=0;return kt>=maxInt32&&(kt=Math.floor(kt/maxInt32),At=32),kt>=65536&&(kt>>>=16,At+=16),kt>=256&&(kt>>>=8,At+=8),At+len8tab[kt]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$5=new TextEncoder;function linkComparator(kt,At){if(kt===At)return 0;const xt=kt.Name?textEncoder$5.encode(kt.Name):[],Bt=At.Name?textEncoder$5.encode(At.Name):[];let Nt=xt.length,jt=Bt.length;for(let Ut=0,Lt=Math.min(Nt,jt);Ut<Lt;++Ut)if(xt[Ut]!==Bt[Ut]){Nt=xt[Ut],jt=Bt[Ut];break}return Nt<jt?-1:jt<Nt?1:0}function hasOnlyProperties(kt,At){return!Object.keys(kt).some(xt=>!At.includes(xt))}function asLink(kt){if(typeof kt.asCID=="object"){const xt=CID$2.asCID(kt);if(!xt)throw new TypeError("Invalid DAG-PB form");return{Hash:xt}}if(typeof kt!="object"||Array.isArray(kt))throw new TypeError("Invalid DAG-PB form");const At={};if(kt.Hash){let xt=CID$2.asCID(kt.Hash);try{xt||(typeof kt.Hash=="string"?xt=CID$2.parse(kt.Hash):kt.Hash instanceof Uint8Array&&(xt=CID$2.decode(kt.Hash)))}catch(Bt){throw new TypeError(`Invalid DAG-PB form: ${Bt.message}`)}xt&&(At.Hash=xt)}if(!At.Hash)throw new TypeError("Invalid DAG-PB form");return typeof kt.Name=="string"&&(At.Name=kt.Name),typeof kt.Tsize=="number"&&(At.Tsize=kt.Tsize),At}function prepare(kt){if((kt instanceof Uint8Array||typeof kt=="string")&&(kt={Data:kt}),typeof kt!="object"||Array.isArray(kt))throw new TypeError("Invalid DAG-PB form");const At={};if(kt.Data!==void 0)if(typeof kt.Data=="string")At.Data=textEncoder$5.encode(kt.Data);else if(kt.Data instanceof Uint8Array)At.Data=kt.Data;else throw new TypeError("Invalid DAG-PB form");if(kt.Links!==void 0)if(Array.isArray(kt.Links))At.Links=kt.Links.map(asLink),At.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else At.Links=[];return At}function validate$1(kt){if(!kt||typeof kt!="object"||Array.isArray(kt)||kt instanceof Uint8Array||kt["/"]&&kt["/"]===kt.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(kt,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(kt.Data!==void 0&&!(kt.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(kt.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let At=0;At<kt.Links.length;At++){const xt=kt.Links[At];if(!xt||typeof xt!="object"||Array.isArray(xt)||xt instanceof Uint8Array||xt["/"]&&xt["/"]===xt.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(xt,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(xt.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(xt.Hash==null||!xt.Hash["/"]||xt.Hash["/"]!==xt.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(xt.Name!==void 0&&typeof xt.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(xt.Tsize!==void 0){if(typeof xt.Tsize!="number"||xt.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(xt.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(At>0&&linkComparator(xt,kt.Links[At-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode(kt,At=[]){return prepare({Data:kt,Links:At})}function createLink(kt,At,xt){return asLink({Hash:xt,Name:kt,Tsize:At})}function toByteView(kt){return kt instanceof ArrayBuffer?new Uint8Array(kt,0,kt.byteLength):kt}const name$4="dag-pb",code$4=112;function encode$a(kt){validate$1(kt);const At={};return kt.Links&&(At.Links=kt.Links.map(xt=>{const Bt={};return xt.Hash&&(Bt.Hash=xt.Hash.bytes),xt.Name!==void 0&&(Bt.Name=xt.Name),xt.Tsize!==void 0&&(Bt.Tsize=xt.Tsize),Bt})),kt.Data&&(At.Data=kt.Data),encodeNode(At)}function decode$a(kt){const At=toByteView(kt),xt=decodeNode(At),Bt={};return xt.Data&&(Bt.Data=xt.Data),xt.Links&&(Bt.Links=xt.Links.map(Nt=>{const jt={};try{jt.Hash=CID$2.decode(Nt.Hash)}catch{}if(!jt.Hash)throw new Error("Invalid Hash field found in link, expected CID");return Nt.Name!==void 0&&(jt.Name=Nt.Name),Nt.Tsize!==void 0&&(jt.Tsize=Nt.Tsize),jt})),Bt}const dagPb=Object.freeze(Object.defineProperty({__proto__:null,code:code$4,createLink,createNode,decode:decode$a,encode:encode$a,name:name$4,prepare,validate:validate$1},Symbol.toStringTag,{value:"Module"})),N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),MSB$2=128,REST$2=127;function encodingLength$5(kt){if(kt<N1$1)return 1;if(kt<N2$1)return 2;if(kt<N3$1)return 3;if(kt<N4$1)return 4;if(kt<N5$1)return 5;if(kt<N6$1)return 6;if(kt<N7$1)return 7;if(Number.MAX_SAFE_INTEGER!=null&&kt>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function encodeUint8Array(kt,At,xt=0){switch(encodingLength$5(kt)){case 8:At[xt++]=kt&255|MSB$2,kt/=128;case 7:At[xt++]=kt&255|MSB$2,kt/=128;case 6:At[xt++]=kt&255|MSB$2,kt/=128;case 5:At[xt++]=kt&255|MSB$2,kt/=128;case 4:At[xt++]=kt&255|MSB$2,kt>>>=7;case 3:At[xt++]=kt&255|MSB$2,kt>>>=7;case 2:At[xt++]=kt&255|MSB$2,kt>>>=7;case 1:{At[xt++]=kt&255,kt>>>=7;break}default:throw new Error("unreachable")}return At}function decodeUint8Array(kt,At){let xt=kt[At],Bt=0;if(Bt+=xt&REST$2,xt<MSB$2||(xt=kt[At+1],Bt+=(xt&REST$2)<<7,xt<MSB$2)||(xt=kt[At+2],Bt+=(xt&REST$2)<<14,xt<MSB$2)||(xt=kt[At+3],Bt+=(xt&REST$2)<<21,xt<MSB$2)||(xt=kt[At+4],Bt+=(xt&REST$2)*N4$1,xt<MSB$2)||(xt=kt[At+5],Bt+=(xt&REST$2)*N5$1,xt<MSB$2)||(xt=kt[At+6],Bt+=(xt&REST$2)*N6$1,xt<MSB$2)||(xt=kt[At+7],Bt+=(xt&REST$2)*N7$1,xt<MSB$2))return Bt;throw new RangeError("Could not decode varint")}const f32=new Float32Array([-0]),f8b=new Uint8Array(f32.buffer);function writeFloatLE(kt,At,xt){f32[0]=kt,At[xt]=f8b[0],At[xt+1]=f8b[1],At[xt+2]=f8b[2],At[xt+3]=f8b[3]}function readFloatLE(kt,At){return f8b[0]=kt[At],f8b[1]=kt[At+1],f8b[2]=kt[At+2],f8b[3]=kt[At+3],f32[0]}const f64=new Float64Array([-0]),d8b=new Uint8Array(f64.buffer);function writeDoubleLE(kt,At,xt){f64[0]=kt,At[xt]=d8b[0],At[xt+1]=d8b[1],At[xt+2]=d8b[2],At[xt+3]=d8b[3],At[xt+4]=d8b[4],At[xt+5]=d8b[5],At[xt+6]=d8b[6],At[xt+7]=d8b[7]}function readDoubleLE(kt,At){return d8b[0]=kt[At],d8b[1]=kt[At+1],d8b[2]=kt[At+2],d8b[3]=kt[At+3],d8b[4]=kt[At+4],d8b[5]=kt[At+5],d8b[6]=kt[At+6],d8b[7]=kt[At+7],f64[0]}const MAX_SAFE_NUMBER_INTEGER=BigInt(Number.MAX_SAFE_INTEGER),MIN_SAFE_NUMBER_INTEGER=BigInt(Number.MIN_SAFE_INTEGER);class LongBits{lo;hi;constructor(At,xt){this.lo=At|0,this.hi=xt|0}toNumber(At=!1){if(!At&&this.hi>>>31>0){const xt=~this.lo+1>>>0;let Bt=~this.hi>>>0;return xt===0&&(Bt=Bt+1>>>0),-(xt+Bt*4294967296)}return this.lo+this.hi*4294967296}toBigInt(At=!1){if(At)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){const xt=~this.lo+1>>>0;let Bt=~this.hi>>>0;return xt===0&&(Bt=Bt+1>>>0),-(BigInt(xt)+(BigInt(Bt)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(At=!1){return this.toBigInt(At).toString()}zzEncode(){const At=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^At)>>>0,this.lo=(this.lo<<1^At)>>>0,this}zzDecode(){const At=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^At)>>>0,this.hi=(this.hi>>>1^At)>>>0,this}length(){const At=this.lo,xt=(this.lo>>>28|this.hi<<4)>>>0,Bt=this.hi>>>24;return Bt===0?xt===0?At<16384?At<128?1:2:At<2097152?3:4:xt<16384?xt<128?5:6:xt<2097152?7:8:Bt<128?9:10}static fromBigInt(At){if(At===0n)return zero;if(At<MAX_SAFE_NUMBER_INTEGER&&At>MIN_SAFE_NUMBER_INTEGER)return this.fromNumber(Number(At));const xt=At<0n;xt&&(At=-At);let Bt=At>>32n,Nt=At-(Bt<<32n);return xt&&(Bt=~Bt|0n,Nt=~Nt|0n,++Nt>TWO_32&&(Nt=0n,++Bt>TWO_32&&(Bt=0n))),new LongBits(Number(Nt),Number(Bt))}static fromNumber(At){if(At===0)return zero;const xt=At<0;xt&&(At=-At);let Bt=At>>>0,Nt=(At-Bt)/4294967296>>>0;return xt&&(Nt=~Nt>>>0,Bt=~Bt>>>0,++Bt>4294967295&&(Bt=0,++Nt>4294967295&&(Nt=0))),new LongBits(Bt,Nt)}static from(At){return typeof At=="number"?LongBits.fromNumber(At):typeof At=="bigint"?LongBits.fromBigInt(At):typeof At=="string"?LongBits.fromBigInt(BigInt(At)):At.low!=null||At.high!=null?new LongBits(At.low>>>0,At.high>>>0):zero}}const zero=new LongBits(0,0);zero.toBigInt=function(){return 0n};zero.zzEncode=zero.zzDecode=function(){return this};zero.length=function(){return 1};const TWO_32=4294967296n;function length$1(kt){let At=0,xt=0;for(let Bt=0;Bt<kt.length;++Bt)xt=kt.charCodeAt(Bt),xt<128?At+=1:xt<2048?At+=2:(xt&64512)===55296&&(kt.charCodeAt(Bt+1)&64512)===56320?(++Bt,At+=4):At+=3;return At}function read$1(kt,At,xt){if(xt-At<1)return"";let Nt;const jt=[];let Ut=0,Lt;for(;At<xt;)Lt=kt[At++],Lt<128?jt[Ut++]=Lt:Lt>191&&Lt<224?jt[Ut++]=(Lt&31)<<6|kt[At++]&63:Lt>239&&Lt<365?(Lt=((Lt&7)<<18|(kt[At++]&63)<<12|(kt[At++]&63)<<6|kt[At++]&63)-65536,jt[Ut++]=55296+(Lt>>10),jt[Ut++]=56320+(Lt&1023)):jt[Ut++]=(Lt&15)<<12|(kt[At++]&63)<<6|kt[At++]&63,Ut>8191&&((Nt??(Nt=[])).push(String.fromCharCode.apply(String,jt)),Ut=0);return Nt!=null?(Ut>0&&Nt.push(String.fromCharCode.apply(String,jt.slice(0,Ut))),Nt.join("")):String.fromCharCode.apply(String,jt.slice(0,Ut))}function write$1(kt,At,xt){const Bt=xt;let Nt,jt;for(let Ut=0;Ut<kt.length;++Ut)Nt=kt.charCodeAt(Ut),Nt<128?At[xt++]=Nt:Nt<2048?(At[xt++]=Nt>>6|192,At[xt++]=Nt&63|128):(Nt&64512)===55296&&((jt=kt.charCodeAt(Ut+1))&64512)===56320?(Nt=65536+((Nt&1023)<<10)+(jt&1023),++Ut,At[xt++]=Nt>>18|240,At[xt++]=Nt>>12&63|128,At[xt++]=Nt>>6&63|128,At[xt++]=Nt&63|128):(At[xt++]=Nt>>12|224,At[xt++]=Nt>>6&63|128,At[xt++]=Nt&63|128);return xt-Bt}function indexOutOfRange(kt,At){return RangeError(`index out of range: ${kt.pos} + ${At??1} > ${kt.len}`)}function readFixed32End(kt,At){return(kt[At-4]|kt[At-3]<<8|kt[At-2]<<16|kt[At-1]<<24)>>>0}class Uint8ArrayReader{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(At){this.buf=At,this.pos=0,this.len=At.length}uint32(){let At=4294967295;if(At=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(At=(At|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(At=(At|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(At=(At|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(At=(At|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return At;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return At}int32(){return this.uint32()|0}sint32(){const At=this.uint32();return At>>>1^-(At&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32End(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32End(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);const At=readFloatLE(this.buf,this.pos);return this.pos+=4,At}double(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);const At=readDoubleLE(this.buf,this.pos);return this.pos+=8,At}bytes(){const At=this.uint32(),xt=this.pos,Bt=this.pos+At;if(Bt>this.len)throw indexOutOfRange(this,At);return this.pos+=At,xt===Bt?new Uint8Array(0):this.buf.subarray(xt,Bt)}string(){const At=this.bytes();return read$1(At,0,At.length)}skip(At){if(typeof At=="number"){if(this.pos+At>this.len)throw indexOutOfRange(this,At);this.pos+=At}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this}skipType(At){switch(At){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(At=this.uint32()&7)!==4;)this.skipType(At);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${At} at offset ${this.pos}`)}return this}readLongVarint(){const At=new LongBits(0,0);let xt=0;if(this.len-this.pos>4){for(;xt<4;++xt)if(At.lo=(At.lo|(this.buf[this.pos]&127)<<xt*7)>>>0,this.buf[this.pos++]<128)return At;if(At.lo=(At.lo|(this.buf[this.pos]&127)<<28)>>>0,At.hi=(At.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return At;xt=0}else{for(;xt<3;++xt){if(this.pos>=this.len)throw indexOutOfRange(this);if(At.lo=(At.lo|(this.buf[this.pos]&127)<<xt*7)>>>0,this.buf[this.pos++]<128)return At}return At.lo=(At.lo|(this.buf[this.pos++]&127)<<xt*7)>>>0,At}if(this.len-this.pos>4){for(;xt<5;++xt)if(At.hi=(At.hi|(this.buf[this.pos]&127)<<xt*7+3)>>>0,this.buf[this.pos++]<128)return At}else for(;xt<5;++xt){if(this.pos>=this.len)throw indexOutOfRange(this);if(At.hi=(At.hi|(this.buf[this.pos]&127)<<xt*7+3)>>>0,this.buf[this.pos++]<128)return At}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);const At=readFixed32End(this.buf,this.pos+=4),xt=readFixed32End(this.buf,this.pos+=4);return new LongBits(At,xt)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const At=decodeUint8Array(this.buf,this.pos);return this.pos+=encodingLength$5(At),At}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function createReader(kt){return new Uint8ArrayReader(kt instanceof Uint8Array?kt:kt.subarray())}function decodeMessage(kt,At,xt){const Bt=createReader(kt);return At.decode(Bt,void 0,xt)}function pool(kt){let Bt,Nt=8192;return function(Ut){if(Ut<1||Ut>4096)return allocUnsafe$1(Ut);Nt+Ut>8192&&(Bt=allocUnsafe$1(8192),Nt=0);const Lt=Bt.subarray(Nt,Nt+=Ut);return Nt&7&&(Nt=(Nt|7)+1),Lt}}class Op{fn;len;next;val;constructor(At,xt,Bt){this.fn=At,this.len=xt,this.next=void 0,this.val=Bt}}function noop$4(){}let State$1=class{head;tail;len;next;constructor(At){this.head=At.head,this.tail=At.tail,this.len=At.len,this.next=At.states}};const bufferPool=pool();function alloc$1(kt){return globalThis.Buffer!=null?allocUnsafe$1(kt):bufferPool(kt)}class Uint8ArrayWriter{len;head;tail;states;constructor(){this.len=0,this.head=new Op(noop$4,0,0),this.tail=this.head,this.states=null}_push(At,xt,Bt){return this.tail=this.tail.next=new Op(At,xt,Bt),this.len+=xt,this}uint32(At){return this.len+=(this.tail=this.tail.next=new VarintOp((At=At>>>0)<128?1:At<16384?2:At<2097152?3:At<268435456?4:5,At)).len,this}int32(At){return At<0?this._push(writeVarint64,10,LongBits.fromNumber(At)):this.uint32(At)}sint32(At){return this.uint32((At<<1^At>>31)>>>0)}uint64(At){const xt=LongBits.fromBigInt(At);return this._push(writeVarint64,xt.length(),xt)}uint64Number(At){return this._push(encodeUint8Array,encodingLength$5(At),At)}uint64String(At){return this.uint64(BigInt(At))}int64(At){return this.uint64(At)}int64Number(At){return this.uint64Number(At)}int64String(At){return this.uint64String(At)}sint64(At){const xt=LongBits.fromBigInt(At).zzEncode();return this._push(writeVarint64,xt.length(),xt)}sint64Number(At){const xt=LongBits.fromNumber(At).zzEncode();return this._push(writeVarint64,xt.length(),xt)}sint64String(At){return this.sint64(BigInt(At))}bool(At){return this._push(writeByte,1,At?1:0)}fixed32(At){return this._push(writeFixed32,4,At>>>0)}sfixed32(At){return this.fixed32(At)}fixed64(At){const xt=LongBits.fromBigInt(At);return this._push(writeFixed32,4,xt.lo)._push(writeFixed32,4,xt.hi)}fixed64Number(At){const xt=LongBits.fromNumber(At);return this._push(writeFixed32,4,xt.lo)._push(writeFixed32,4,xt.hi)}fixed64String(At){return this.fixed64(BigInt(At))}sfixed64(At){return this.fixed64(At)}sfixed64Number(At){return this.fixed64Number(At)}sfixed64String(At){return this.fixed64String(At)}float(At){return this._push(writeFloatLE,4,At)}double(At){return this._push(writeDoubleLE,8,At)}bytes(At){const xt=At.length>>>0;return xt===0?this._push(writeByte,1,0):this.uint32(xt)._push(writeBytes,xt,At)}string(At){const xt=length$1(At);return xt!==0?this.uint32(xt)._push(write$1,xt,At):this._push(writeByte,1,0)}fork(){return this.states=new State$1(this),this.head=this.tail=new Op(noop$4,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$4,0,0),this.len=0),this}ldelim(){const At=this.head,xt=this.tail,Bt=this.len;return this.reset().uint32(Bt),Bt!==0&&(this.tail.next=At.next,this.tail=xt,this.len+=Bt),this}finish(){let At=this.head.next;const xt=alloc$1(this.len);let Bt=0;for(;At!=null;)At.fn(At.val,xt,Bt),Bt+=At.len,At=At.next;return xt}}function writeByte(kt,At,xt){At[xt]=kt&255}function writeVarint32(kt,At,xt){for(;kt>127;)At[xt++]=kt&127|128,kt>>>=7;At[xt]=kt}class VarintOp extends Op{next;constructor(At,xt){super(writeVarint32,At,xt),this.next=void 0}}function writeVarint64(kt,At,xt){for(;kt.hi!==0;)At[xt++]=kt.lo&127|128,kt.lo=(kt.lo>>>7|kt.hi<<25)>>>0,kt.hi>>>=7;for(;kt.lo>127;)At[xt++]=kt.lo&127|128,kt.lo=kt.lo>>>7;At[xt++]=kt.lo}function writeFixed32(kt,At,xt){At[xt]=kt&255,At[xt+1]=kt>>>8&255,At[xt+2]=kt>>>16&255,At[xt+3]=kt>>>24}function writeBytes(kt,At,xt){At.set(kt,xt)}globalThis.Buffer!=null&&(Uint8ArrayWriter.prototype.bytes=function(kt){const At=kt.length>>>0;return this.uint32(At),At>0&&this._push(writeBytesBuffer,At,kt),this},Uint8ArrayWriter.prototype.string=function(kt){const At=globalThis.Buffer.byteLength(kt);return this.uint32(At),At>0&&this._push(writeStringBuffer,At,kt),this});function writeBytesBuffer(kt,At,xt){At.set(kt,xt)}function writeStringBuffer(kt,At,xt){kt.length<40?write$1(kt,At,xt):At.utf8Write!=null?At.utf8Write(kt,xt):At.set(fromString$3(kt),xt)}function createWriter(){return new Uint8ArrayWriter}function encodeMessage(kt,At){const xt=createWriter();return At.encode(kt,xt,{lengthDelimited:!1}),xt.finish()}var CODEC_TYPES;(function(kt){kt[kt.VARINT=0]="VARINT",kt[kt.BIT64=1]="BIT64",kt[kt.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",kt[kt.START_GROUP=3]="START_GROUP",kt[kt.END_GROUP=4]="END_GROUP",kt[kt.BIT32=5]="BIT32"})(CODEC_TYPES||(CODEC_TYPES={}));function createCodec$1(kt,At,xt,Bt){return{name:kt,type:At,encode:xt,decode:Bt}}function enumeration(kt){function At(Nt){if(kt[Nt.toString()]==null)throw new Error("Invalid enum value");return kt[Nt]}const xt=function(jt,Ut){const Lt=At(jt);Ut.int32(Lt)},Bt=function(jt){const Ut=jt.int32();return At(Ut)};return createCodec$1("enum",CODEC_TYPES.VARINT,xt,Bt)}function message(kt,At){return createCodec$1("message",CODEC_TYPES.LENGTH_DELIMITED,kt,At)}var Data;(function(kt){(function(Bt){Bt.Raw="Raw",Bt.Directory="Directory",Bt.File="File",Bt.Metadata="Metadata",Bt.Symlink="Symlink",Bt.HAMTShard="HAMTShard"})(kt.DataType||(kt.DataType={}));let At;(function(Bt){Bt[Bt.Raw=0]="Raw",Bt[Bt.Directory=1]="Directory",Bt[Bt.File=2]="File",Bt[Bt.Metadata=3]="Metadata",Bt[Bt.Symlink=4]="Symlink",Bt[Bt.HAMTShard=5]="HAMTShard"})(At||(At={})),function(Bt){Bt.codec=()=>enumeration(At)}(kt.DataType||(kt.DataType={}));let xt;kt.codec=()=>(xt==null&&(xt=message((Bt,Nt,jt={})=>{if(jt.lengthDelimited!==!1&&Nt.fork(),Bt.Type!=null&&(Nt.uint32(8),kt.DataType.codec().encode(Bt.Type,Nt)),Bt.Data!=null&&(Nt.uint32(18),Nt.bytes(Bt.Data)),Bt.filesize!=null&&(Nt.uint32(24),Nt.uint64(Bt.filesize)),Bt.blocksizes!=null)for(const Ut of Bt.blocksizes)Nt.uint32(32),Nt.uint64(Ut);Bt.hashType!=null&&(Nt.uint32(40),Nt.uint64(Bt.hashType)),Bt.fanout!=null&&(Nt.uint32(48),Nt.uint64(Bt.fanout)),Bt.mode!=null&&(Nt.uint32(56),Nt.uint32(Bt.mode)),Bt.mtime!=null&&(Nt.uint32(66),UnixTime.codec().encode(Bt.mtime,Nt)),jt.lengthDelimited!==!1&&Nt.ldelim()},(Bt,Nt)=>{const jt={blocksizes:[]},Ut=Nt==null?Bt.len:Bt.pos+Nt;for(;Bt.pos<Ut;){const Lt=Bt.uint32();switch(Lt>>>3){case 1:jt.Type=kt.DataType.codec().decode(Bt);break;case 2:jt.Data=Bt.bytes();break;case 3:jt.filesize=Bt.uint64();break;case 4:jt.blocksizes.push(Bt.uint64());break;case 5:jt.hashType=Bt.uint64();break;case 6:jt.fanout=Bt.uint64();break;case 7:jt.mode=Bt.uint32();break;case 8:jt.mtime=UnixTime.codec().decode(Bt,Bt.uint32());break;default:Bt.skipType(Lt&7);break}}return jt})),xt),kt.encode=Bt=>encodeMessage(Bt,kt.codec()),kt.decode=Bt=>decodeMessage(Bt,kt.codec())})(Data||(Data={}));var UnixTime;(function(kt){let At;kt.codec=()=>(At==null&&(At=message((xt,Bt,Nt={})=>{Nt.lengthDelimited!==!1&&Bt.fork(),xt.Seconds!=null&&(Bt.uint32(8),Bt.int64(xt.Seconds)),xt.FractionalNanoseconds!=null&&(Bt.uint32(21),Bt.fixed32(xt.FractionalNanoseconds)),Nt.lengthDelimited!==!1&&Bt.ldelim()},(xt,Bt)=>{const Nt={},jt=Bt==null?xt.len:xt.pos+Bt;for(;xt.pos<jt;){const Ut=xt.uint32();switch(Ut>>>3){case 1:Nt.Seconds=xt.int64();break;case 2:Nt.FractionalNanoseconds=xt.fixed32();break;default:xt.skipType(Ut&7);break}}return Nt})),At),kt.encode=xt=>encodeMessage(xt,kt.codec()),kt.decode=xt=>decodeMessage(xt,kt.codec())})(UnixTime||(UnixTime={}));var Metadata;(function(kt){let At;kt.codec=()=>(At==null&&(At=message((xt,Bt,Nt={})=>{Nt.lengthDelimited!==!1&&Bt.fork(),xt.MimeType!=null&&(Bt.uint32(10),Bt.string(xt.MimeType)),Nt.lengthDelimited!==!1&&Bt.ldelim()},(xt,Bt)=>{const Nt={},jt=Bt==null?xt.len:xt.pos+Bt;for(;xt.pos<jt;){const Ut=xt.uint32();switch(Ut>>>3){case 1:Nt.MimeType=xt.string();break;default:xt.skipType(Ut&7);break}}return Nt})),At),kt.encode=xt=>encodeMessage(xt,kt.codec()),kt.decode=xt=>decodeMessage(xt,kt.codec())})(Metadata||(Metadata={}));const types$2={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},dirTypes=["directory","hamt-sharded-directory"],DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8);class UnixFS{static unmarshal(At){const xt=Data.decode(At),Bt=new UnixFS({type:types$2[xt.Type!=null?xt.Type.toString():"File"],data:xt.Data,blockSizes:xt.blocksizes,mode:xt.mode,mtime:xt.mtime!=null?{secs:xt.mtime.Seconds??0n,nsecs:xt.mtime.FractionalNanoseconds}:void 0,fanout:xt.fanout});return Bt._originalMode=xt.mode??0,Bt}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(At={type:"file"}){const{type:xt,data:Bt,blockSizes:Nt,hashType:jt,fanout:Ut,mtime:Lt,mode:Ht}=At;if(xt!=null&&!Object.values(types$2).includes(xt))throw errCode$1(new Error("Type: "+xt+" is not valid"),"ERR_INVALID_TYPE");this.type=xt??"file",this.data=Bt,this.hashType=jt,this.fanout=Ut,this.blockSizes=Nt??[],this._originalMode=0,this.mode=Ht,this.mtime=Lt}set mode(At){At==null?this._mode=this.isDirectory()?DEFAULT_DIRECTORY_MODE:DEFAULT_FILE_MODE:this._mode=At&4095}get mode(){return this._mode}isDirectory(){return dirTypes.includes(this.type)}addBlockSize(At){this.blockSizes.push(At)}removeBlockSize(At){this.blockSizes.splice(At,1)}fileSize(){if(this.isDirectory())return 0n;let At=0n;return this.blockSizes.forEach(xt=>{At+=xt}),this.data!=null&&(At+=BigInt(this.data.length)),At}marshal(){let At;switch(this.type){case"raw":At=Data.DataType.Raw;break;case"directory":At=Data.DataType.Directory;break;case"file":At=Data.DataType.File;break;case"metadata":At=Data.DataType.Metadata;break;case"symlink":At=Data.DataType.Symlink;break;case"hamt-sharded-directory":At=Data.DataType.HAMTShard;break;default:throw errCode$1(new Error(`Type: ${At} is not valid`),"ERR_INVALID_TYPE")}let xt=this.data;(this.data==null||this.data.length===0)&&(xt=void 0);let Bt;this.mode!=null&&(Bt=this._originalMode&4294963200|(this.mode??0),Bt===DEFAULT_FILE_MODE&&!this.isDirectory()&&(Bt=void 0),Bt===DEFAULT_DIRECTORY_MODE&&this.isDirectory()&&(Bt=void 0));let Nt;return this.mtime!=null&&(Nt={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),Data.encode({Type:At,Data:xt,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:Bt,mtime:Nt})}}const name$3="raw",code$3=85,encode$9=kt=>coerce$3(kt),decode$9=kt=>coerce$3(kt),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$9,encode:encode$9,name:name$3},Symbol.toStringTag,{value:"Module"}));class CustomProgressEvent extends Event{type;detail;constructor(At,xt){super(At),this.type=At,this.detail=xt}}const persist=async(kt,At,xt)=>{xt.codec==null&&(xt.codec=dagPb);const Bt=await sha256$7.digest(kt),Nt=CID.create(xt.cidVersion,xt.codec.code,Bt);return await At.put(Nt,kt,xt),Nt};function defaultBufferImporter(kt){return async function*(xt,Bt){let Nt=0n;for await(let jt of xt.content)yield async()=>{var Vt;let Ut;const Lt={codec:dagPb,cidVersion:kt.cidVersion,onProgress:kt.onProgress};kt.rawLeaves?(Lt.codec=raw,Lt.cidVersion=1):(Ut=new UnixFS({type:kt.leafType,data:jt}),jt=encode$a({Data:Ut.marshal(),Links:[]}));const Ht=await persist(jt,Bt,Lt);return Nt+=BigInt(jt.byteLength),(Vt=kt.onProgress)==null||Vt.call(kt,new CustomProgressEvent("unixfs:importer:progress:file:write",{bytesWritten:Nt,cid:Ht,path:xt.path})),{cid:Ht,unixfs:Ut,size:BigInt(jt.length),block:jt}}}}const dirBuilder=async(kt,At,xt)=>{const Bt=new UnixFS({type:"directory",mtime:kt.mtime,mode:kt.mode}),Nt=encode$a(prepare({Data:Bt.marshal()})),jt=await persist(Nt,At,xt),Ut=kt.path;return{cid:jt,path:Ut,unixfs:Bt,size:BigInt(Nt.length),originalPath:kt.originalPath,block:Nt}};async function*buildFileBatch(kt,At,xt){let Bt=-1,Nt;for await(const jt of parallelBatch(xt.bufferImporter(kt,At),xt.blockWriteConcurrency)){if(Bt++,Bt===0){Nt={...jt,single:!0};continue}else Bt===1&&Nt!=null&&(yield{...Nt,block:void 0,single:void 0},Nt=void 0);yield{...jt,block:void 0}}Nt!=null&&(yield Nt)}function isSingleBlockImport(kt){return kt.single===!0}const reduce$2=(kt,At,xt)=>async function(Nt){var zt,Wt;if(Nt.length===1&&isSingleBlockImport(Nt[0])&&xt.reduceSingleLeafToSelf){const Jt=Nt[0];let Qt=Jt.block;return isSingleBlockImport(Jt)&&(kt.mtime!==void 0||kt.mode!==void 0)&&(Jt.unixfs=new UnixFS({type:"file",mtime:kt.mtime,mode:kt.mode,data:Jt.block}),Qt={Data:Jt.unixfs.marshal(),Links:[]},Jt.block=encode$a(prepare(Qt)),Jt.cid=await persist(Jt.block,At,{...xt,cidVersion:xt.cidVersion}),Jt.size=BigInt(Jt.block.length)),(zt=xt.onProgress)==null||zt.call(xt,new CustomProgressEvent("unixfs:importer:progress:file:layout",{cid:Jt.cid,path:Jt.originalPath})),{cid:Jt.cid,path:kt.path,unixfs:Jt.unixfs,size:Jt.size,originalPath:Jt.originalPath}}const jt=new UnixFS({type:"file",mtime:kt.mtime,mode:kt.mode}),Ut=Nt.filter(Jt=>{var Qt,Xt;return Jt.cid.code===code$3&&Jt.size>0||Jt.unixfs!=null&&Jt.unixfs.data==null&&Jt.unixfs.fileSize()>0n?!0:!!((Xt=(Qt=Jt.unixfs)==null?void 0:Qt.data)!=null&&Xt.length)}).map(Jt=>{var Qt;return Jt.cid.code===code$3?(jt.addBlockSize(Jt.size),{Name:"",Tsize:Number(Jt.size),Hash:Jt.cid}):(Jt.unixfs==null||Jt.unixfs.data==null?jt.addBlockSize(((Qt=Jt.unixfs)==null?void 0:Qt.fileSize())??0n):jt.addBlockSize(BigInt(Jt.unixfs.data.length)),{Name:"",Tsize:Number(Jt.size),Hash:Jt.cid})}),Lt={Data:jt.marshal(),Links:Ut},Ht=encode$a(prepare(Lt)),Vt=await persist(Ht,At,xt);return(Wt=xt.onProgress)==null||Wt.call(xt,new CustomProgressEvent("unixfs:importer:progress:file:layout",{cid:Vt,path:kt.originalPath})),{cid:Vt,path:kt.path,unixfs:jt,size:BigInt(Ht.length+Lt.Links.reduce((Jt,Qt)=>Jt+(Qt.Tsize??0),0)),originalPath:kt.originalPath,block:Ht}},fileBuilder=async(kt,At,xt)=>xt.layout(buildFileBatch(kt,At,xt),reduce$2(kt,At,xt));function isIterable$5(kt){return Symbol.iterator in kt}function isAsyncIterable$8(kt){return Symbol.asyncIterator in kt}function contentAsAsyncIterable(kt){try{if(kt instanceof Uint8Array)return async function*(){yield kt}();if(isIterable$5(kt))return async function*(){yield*kt}();if(isAsyncIterable$8(kt))return kt}catch{throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function defaultDagBuilder(kt){return async function*(xt,Bt){for await(const Nt of xt){let jt;if(Nt.path!=null&&(jt=Nt.path,Nt.path=Nt.path.split("/").filter(Ut=>Ut!=null&&Ut!==".").join("/")),isFileCandidate(Nt)){const Ut={path:Nt.path,mtime:Nt.mtime,mode:Nt.mode,content:async function*(){var Ht;let Lt=0n;for await(const Vt of kt.chunker(kt.chunkValidator(contentAsAsyncIterable(Nt.content)))){const zt=BigInt(Vt.byteLength);Lt+=zt,(Ht=kt.onProgress)==null||Ht.call(kt,new CustomProgressEvent("unixfs:importer:progress:file:read",{bytesRead:Lt,chunkSize:zt,path:Nt.path})),yield Vt}}(),originalPath:jt};yield async()=>fileBuilder(Ut,Bt,kt)}else if(Nt.path!=null){const Ut={path:Nt.path,mtime:Nt.mtime,mode:Nt.mode,originalPath:jt};yield async()=>dirBuilder(Ut,Bt,kt)}else throw new Error("Import candidate must have content or path or both")}}}function isFileCandidate(kt){return kt.content!=null}function asUint8Array(kt){return globalThis.Buffer!=null?new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength):kt}const base10=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from(""),alphabetBytesToChars=alphabet$2.reduce((kt,At,xt)=>(kt[xt]=At,kt),[]),alphabetCharsToBytes=alphabet$2.reduce((kt,At,xt)=>(kt[At.codePointAt(0)]=xt,kt),[]);function encode$8(kt){return kt.reduce((At,xt)=>(At+=alphabetBytesToChars[xt],At),"")}function decode$8(kt){const At=[];for(const xt of kt){const Bt=alphabetCharsToBytes[xt.codePointAt(0)];if(Bt===void 0)throw new Error(`Non-base256emoji character: ${xt}`);At.push(Bt)}return new Uint8Array(At)}const base256emoji=from$6({prefix:"",name:"base256emoji",encode:encode$8,decode:decode$8}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"})),base36=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base64=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$1=Object.freeze(Object.defineProperty({__proto__:null,base64,base64pad,base64url:base64url$1,base64urlpad},Symbol.toStringTag,{value:"Module"})),base8=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),identity$2=from$6({prefix:"\0",name:"identity",encode:kt=>toString$6(kt),decode:kt=>fromString$1(kt)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const from$5=({name:kt,code:At,encode:xt})=>new Hasher(kt,At,xt);class Hasher{constructor(At,xt,Bt){this.name=At,this.code=xt,this.encode=Bt}digest(At){if(At instanceof Uint8Array){const xt=this.encode(At);return xt instanceof Uint8Array?create(this.code,xt):xt.then(Bt=>create(this.code,Bt))}else throw Error("Unknown type, must be binary type")}}const sha$5=kt=>async At=>new Uint8Array(await crypto.subtle.digest(kt,At)),sha256$4=from$5({name:"sha2-256",code:18,encode:sha$5("SHA-256")}),bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$2,...base36$1,...base58,...base64$1,...base256emoji$1};function allocUnsafe(kt=0){var At;return((At=globalThis.Buffer)==null?void 0:At.allocUnsafe)!=null?asUint8Array(globalThis.Buffer.allocUnsafe(kt)):new Uint8Array(kt)}function createCodec(kt,At,xt,Bt){return{name:kt,prefix:At,encoder:{name:kt,prefix:At,encode:xt},decoder:{decode:Bt}}}const string$1=createCodec("utf8","u",kt=>"u"+new TextDecoder("utf8").decode(kt),kt=>new TextEncoder().encode(kt.substring(1))),ascii=createCodec("ascii","a",kt=>{let At="a";for(let xt=0;xt<kt.length;xt++)At+=String.fromCharCode(kt[xt]);return At},kt=>{kt=kt.substring(1);const At=allocUnsafe(kt.length);for(let xt=0;xt<kt.length;xt++)At[xt]=kt.charCodeAt(xt);return At}),BASES={utf8:string$1,"utf-8":string$1,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function fromString(kt,At="utf8"){const xt=BASES[At];if(xt==null)throw new Error(`Unsupported encoding "${At}"`);return(At==="utf8"||At==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(kt,"utf-8")):xt.decoder.decode(`${xt.prefix}${kt}`)}const defaultChunkValidator=()=>async function*(At){for await(const xt of At){if(xt.length===void 0)throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof xt=="string"||xt instanceof String)yield fromString(xt.toString());else if(Array.isArray(xt))yield Uint8Array.from(xt);else if(xt instanceof Uint8Array)yield xt;else throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}},DEFAULT_MAX_CHILDREN_PER_NODE=174;function balanced(kt){const At=DEFAULT_MAX_CHILDREN_PER_NODE;return async function xt(Bt,Nt){const jt=[];for await(const Ut of batch(Bt,At))jt.push(await Nt(Ut));return jt.length>1?xt(jt,Nt):jt[0]}}class Dir{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(At,xt){this.options=xt??{},this.root=At.root,this.dir=At.dir,this.path=At.path,this.dirty=At.dirty,this.flat=At.flat,this.parent=At.parent,this.parentKey=At.parentKey,this.unixfs=At.unixfs,this.mode=At.mode,this.mtime=At.mtime}}const CID_V0=CID.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),CID_V1=CID.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");class DirFlat extends Dir{_children;constructor(At,xt){super(At,xt),this._children=new Map}async put(At,xt){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(At,xt)}async get(At){return Promise.resolve(this._children.get(At))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(const[At,xt]of this._children.entries())yield{key:At,child:xt}}estimateNodeSize(){if(this.nodeSize!==void 0)return this.nodeSize;this.nodeSize=0;for(const[At,xt]of this._children.entries())xt.size!=null&&xt.cid!=null&&(this.nodeSize+=At.length+(this.options.cidVersion===1?CID_V1.bytes.byteLength:CID_V0.bytes.byteLength));return this.nodeSize}async*flush(At){const xt=[];for(const[Ht,Vt]of this._children.entries()){let zt=Vt;if(Vt instanceof Dir)for await(const Wt of Vt.flush(At))zt=Wt,yield Wt;zt.size!=null&&zt.cid!=null&&xt.push({Name:Ht,Tsize:Number(zt.size),Hash:zt.cid})}const Bt=new UnixFS({type:"directory",mtime:this.mtime,mode:this.mode}),Nt={Data:Bt.marshal(),Links:xt},jt=encode$a(prepare(Nt)),Ut=await persist(jt,At,this.options),Lt=jt.length+Nt.Links.reduce((Ht,Vt)=>Ht+(Vt.Tsize==null?0:Vt.Tsize),0);this.cid=Ut,this.size=Lt,yield{cid:Ut,unixfs:Bt,path:this.path,size:BigInt(Lt)}}}var murmurHash3js={exports:{}};(function(kt,At){(function(xt,Bt){var Nt={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function jt(tr){if(!Array.isArray(tr)&&!ArrayBuffer.isView(tr))return!1;for(var rr=0;rr<tr.length;rr++)if(!Number.isInteger(tr[rr])||tr[rr]<0||tr[rr]>255)return!1;return!0}function Ut(tr,rr){return(tr&65535)*rr+(((tr>>>16)*rr&65535)<<16)}function Lt(tr,rr){return tr<<rr|tr>>>32-rr}function Ht(tr){return tr^=tr>>>16,tr=Ut(tr,2246822507),tr^=tr>>>13,tr=Ut(tr,3266489909),tr^=tr>>>16,tr}function Vt(tr,rr){tr=[tr[0]>>>16,tr[0]&65535,tr[1]>>>16,tr[1]&65535],rr=[rr[0]>>>16,rr[0]&65535,rr[1]>>>16,rr[1]&65535];var nr=[0,0,0,0];return nr[3]+=tr[3]+rr[3],nr[2]+=nr[3]>>>16,nr[3]&=65535,nr[2]+=tr[2]+rr[2],nr[1]+=nr[2]>>>16,nr[2]&=65535,nr[1]+=tr[1]+rr[1],nr[0]+=nr[1]>>>16,nr[1]&=65535,nr[0]+=tr[0]+rr[0],nr[0]&=65535,[nr[0]<<16|nr[1],nr[2]<<16|nr[3]]}function zt(tr,rr){tr=[tr[0]>>>16,tr[0]&65535,tr[1]>>>16,tr[1]&65535],rr=[rr[0]>>>16,rr[0]&65535,rr[1]>>>16,rr[1]&65535];var nr=[0,0,0,0];return nr[3]+=tr[3]*rr[3],nr[2]+=nr[3]>>>16,nr[3]&=65535,nr[2]+=tr[2]*rr[3],nr[1]+=nr[2]>>>16,nr[2]&=65535,nr[2]+=tr[3]*rr[2],nr[1]+=nr[2]>>>16,nr[2]&=65535,nr[1]+=tr[1]*rr[3],nr[0]+=nr[1]>>>16,nr[1]&=65535,nr[1]+=tr[2]*rr[2],nr[0]+=nr[1]>>>16,nr[1]&=65535,nr[1]+=tr[3]*rr[1],nr[0]+=nr[1]>>>16,nr[1]&=65535,nr[0]+=tr[0]*rr[3]+tr[1]*rr[2]+tr[2]*rr[1]+tr[3]*rr[0],nr[0]&=65535,[nr[0]<<16|nr[1],nr[2]<<16|nr[3]]}function Wt(tr,rr){return rr%=64,rr===32?[tr[1],tr[0]]:rr<32?[tr[0]<<rr|tr[1]>>>32-rr,tr[1]<<rr|tr[0]>>>32-rr]:(rr-=32,[tr[1]<<rr|tr[0]>>>32-rr,tr[0]<<rr|tr[1]>>>32-rr])}function Jt(tr,rr){return rr%=64,rr===0?tr:rr<32?[tr[0]<<rr|tr[1]>>>32-rr,tr[1]<<rr]:[tr[1]<<rr-32,0]}function Qt(tr,rr){return[tr[0]^rr[0],tr[1]^rr[1]]}function Xt(tr){return tr=Qt(tr,[0,tr[0]>>>1]),tr=zt(tr,[4283543511,3981806797]),tr=Qt(tr,[0,tr[0]>>>1]),tr=zt(tr,[3301882366,444984403]),tr=Qt(tr,[0,tr[0]>>>1]),tr}Nt.x86.hash32=function(tr,rr){if(Nt.inputValidation&&!jt(tr))return Bt;rr=rr||0;for(var nr=tr.length%4,ar=tr.length-nr,ir=rr,lr=0,yr=3432918353,Sr=461845907,Ar=0;Ar<ar;Ar=Ar+4)lr=tr[Ar]|tr[Ar+1]<<8|tr[Ar+2]<<16|tr[Ar+3]<<24,lr=Ut(lr,yr),lr=Lt(lr,15),lr=Ut(lr,Sr),ir^=lr,ir=Lt(ir,13),ir=Ut(ir,5)+3864292196;switch(lr=0,nr){case 3:lr^=tr[Ar+2]<<16;case 2:lr^=tr[Ar+1]<<8;case 1:lr^=tr[Ar],lr=Ut(lr,yr),lr=Lt(lr,15),lr=Ut(lr,Sr),ir^=lr}return ir^=tr.length,ir=Ht(ir),ir>>>0},Nt.x86.hash128=function(tr,rr){if(Nt.inputValidation&&!jt(tr))return Bt;rr=rr||0;for(var nr=tr.length%16,ar=tr.length-nr,ir=rr,lr=rr,yr=rr,Sr=rr,Ar=0,Dr=0,Br=0,Lr=0,Or=597399067,vr=2869860233,pr=951274213,dr=2716044179,ur=0;ur<ar;ur=ur+16)Ar=tr[ur]|tr[ur+1]<<8|tr[ur+2]<<16|tr[ur+3]<<24,Dr=tr[ur+4]|tr[ur+5]<<8|tr[ur+6]<<16|tr[ur+7]<<24,Br=tr[ur+8]|tr[ur+9]<<8|tr[ur+10]<<16|tr[ur+11]<<24,Lr=tr[ur+12]|tr[ur+13]<<8|tr[ur+14]<<16|tr[ur+15]<<24,Ar=Ut(Ar,Or),Ar=Lt(Ar,15),Ar=Ut(Ar,vr),ir^=Ar,ir=Lt(ir,19),ir+=lr,ir=Ut(ir,5)+1444728091,Dr=Ut(Dr,vr),Dr=Lt(Dr,16),Dr=Ut(Dr,pr),lr^=Dr,lr=Lt(lr,17),lr+=yr,lr=Ut(lr,5)+197830471,Br=Ut(Br,pr),Br=Lt(Br,17),Br=Ut(Br,dr),yr^=Br,yr=Lt(yr,15),yr+=Sr,yr=Ut(yr,5)+2530024501,Lr=Ut(Lr,dr),Lr=Lt(Lr,18),Lr=Ut(Lr,Or),Sr^=Lr,Sr=Lt(Sr,13),Sr+=ir,Sr=Ut(Sr,5)+850148119;switch(Ar=0,Dr=0,Br=0,Lr=0,nr){case 15:Lr^=tr[ur+14]<<16;case 14:Lr^=tr[ur+13]<<8;case 13:Lr^=tr[ur+12],Lr=Ut(Lr,dr),Lr=Lt(Lr,18),Lr=Ut(Lr,Or),Sr^=Lr;case 12:Br^=tr[ur+11]<<24;case 11:Br^=tr[ur+10]<<16;case 10:Br^=tr[ur+9]<<8;case 9:Br^=tr[ur+8],Br=Ut(Br,pr),Br=Lt(Br,17),Br=Ut(Br,dr),yr^=Br;case 8:Dr^=tr[ur+7]<<24;case 7:Dr^=tr[ur+6]<<16;case 6:Dr^=tr[ur+5]<<8;case 5:Dr^=tr[ur+4],Dr=Ut(Dr,vr),Dr=Lt(Dr,16),Dr=Ut(Dr,pr),lr^=Dr;case 4:Ar^=tr[ur+3]<<24;case 3:Ar^=tr[ur+2]<<16;case 2:Ar^=tr[ur+1]<<8;case 1:Ar^=tr[ur],Ar=Ut(Ar,Or),Ar=Lt(Ar,15),Ar=Ut(Ar,vr),ir^=Ar}return ir^=tr.length,lr^=tr.length,yr^=tr.length,Sr^=tr.length,ir+=lr,ir+=yr,ir+=Sr,lr+=ir,yr+=ir,Sr+=ir,ir=Ht(ir),lr=Ht(lr),yr=Ht(yr),Sr=Ht(Sr),ir+=lr,ir+=yr,ir+=Sr,lr+=ir,yr+=ir,Sr+=ir,("00000000"+(ir>>>0).toString(16)).slice(-8)+("00000000"+(lr>>>0).toString(16)).slice(-8)+("00000000"+(yr>>>0).toString(16)).slice(-8)+("00000000"+(Sr>>>0).toString(16)).slice(-8)},Nt.x64.hash128=function(tr,rr){if(Nt.inputValidation&&!jt(tr))return Bt;rr=rr||0;for(var nr=tr.length%16,ar=tr.length-nr,ir=[0,rr],lr=[0,rr],yr=[0,0],Sr=[0,0],Ar=[2277735313,289559509],Dr=[1291169091,658871167],Br=0;Br<ar;Br=Br+16)yr=[tr[Br+4]|tr[Br+5]<<8|tr[Br+6]<<16|tr[Br+7]<<24,tr[Br]|tr[Br+1]<<8|tr[Br+2]<<16|tr[Br+3]<<24],Sr=[tr[Br+12]|tr[Br+13]<<8|tr[Br+14]<<16|tr[Br+15]<<24,tr[Br+8]|tr[Br+9]<<8|tr[Br+10]<<16|tr[Br+11]<<24],yr=zt(yr,Ar),yr=Wt(yr,31),yr=zt(yr,Dr),ir=Qt(ir,yr),ir=Wt(ir,27),ir=Vt(ir,lr),ir=Vt(zt(ir,[0,5]),[0,1390208809]),Sr=zt(Sr,Dr),Sr=Wt(Sr,33),Sr=zt(Sr,Ar),lr=Qt(lr,Sr),lr=Wt(lr,31),lr=Vt(lr,ir),lr=Vt(zt(lr,[0,5]),[0,944331445]);switch(yr=[0,0],Sr=[0,0],nr){case 15:Sr=Qt(Sr,Jt([0,tr[Br+14]],48));case 14:Sr=Qt(Sr,Jt([0,tr[Br+13]],40));case 13:Sr=Qt(Sr,Jt([0,tr[Br+12]],32));case 12:Sr=Qt(Sr,Jt([0,tr[Br+11]],24));case 11:Sr=Qt(Sr,Jt([0,tr[Br+10]],16));case 10:Sr=Qt(Sr,Jt([0,tr[Br+9]],8));case 9:Sr=Qt(Sr,[0,tr[Br+8]]),Sr=zt(Sr,Dr),Sr=Wt(Sr,33),Sr=zt(Sr,Ar),lr=Qt(lr,Sr);case 8:yr=Qt(yr,Jt([0,tr[Br+7]],56));case 7:yr=Qt(yr,Jt([0,tr[Br+6]],48));case 6:yr=Qt(yr,Jt([0,tr[Br+5]],40));case 5:yr=Qt(yr,Jt([0,tr[Br+4]],32));case 4:yr=Qt(yr,Jt([0,tr[Br+3]],24));case 3:yr=Qt(yr,Jt([0,tr[Br+2]],16));case 2:yr=Qt(yr,Jt([0,tr[Br+1]],8));case 1:yr=Qt(yr,[0,tr[Br]]),yr=zt(yr,Ar),yr=Wt(yr,31),yr=zt(yr,Dr),ir=Qt(ir,yr)}return ir=Qt(ir,[0,tr.length]),lr=Qt(lr,[0,tr.length]),ir=Vt(ir,lr),lr=Vt(lr,ir),ir=Xt(ir),lr=Xt(lr),ir=Vt(ir,lr),lr=Vt(lr,ir),("00000000"+(ir[0]>>>0).toString(16)).slice(-8)+("00000000"+(ir[1]>>>0).toString(16)).slice(-8)+("00000000"+(lr[0]>>>0).toString(16)).slice(-8)+("00000000"+(lr[1]>>>0).toString(16)).slice(-8)},kt.exports&&(At=kt.exports=Nt),At.murmurHash3=Nt})()})(murmurHash3js,murmurHash3js.exports);var murmurHash3jsExports=murmurHash3js.exports,murmurhash3jsRevisited=murmurHash3jsExports;const mur=getDefaultExportFromCjs(murmurhash3jsRevisited),murmur3128=from$7({name:"murmur3-128",code:34,encode:kt=>fromHex(mur.x64.hash128(kt))}),BITS_PER_BYTE=7;var sparseArray=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(At,xt){let Bt=this._internalPositionFor(At,!1);if(xt===void 0)Bt!==-1&&(this._unsetInternalPos(Bt),this._unsetBit(At),this._changedLength=!0,this._changedData=!0);else{let Nt=!1;Bt===-1?(Bt=this._data.length,this._setBit(At),this._changedData=!0):Nt=!0,this._setInternalPos(Bt,At,xt,Nt),this._changedLength=!0}}unset(At){this.set(At,void 0)}get(At){this._sortData();const xt=this._internalPositionFor(At,!0);if(xt!==-1)return this._data[xt][1]}push(At){return this.set(this.length,At),this.length}get length(){if(this._sortData(),this._changedLength){const At=this._data[this._data.length-1];this._length=At?At[0]+1:0,this._changedLength=!1}return this._length}forEach(At){let xt=0;for(;xt<this.length;)At(this.get(xt),xt,this),xt++}map(At){let xt=0,Bt=new Array(this.length);for(;xt<this.length;)Bt[xt]=At(this.get(xt),xt,this),xt++;return Bt}reduce(At,xt){let Bt=0,Nt=xt;for(;Bt<this.length;){const jt=this.get(Bt);Nt=At(Nt,jt,Bt),Bt++}return Nt}find(At){let xt=0,Bt,Nt;for(;xt<this.length&&!Bt;)Nt=this.get(xt),Bt=At(Nt),xt++;return Bt?Nt:void 0}_internalPositionFor(At,xt){const Bt=this._bytePosFor(At,xt);if(Bt>=this._bitArrays.length)return-1;const Nt=this._bitArrays[Bt],jt=At-Bt*BITS_PER_BYTE;if(!((Nt&1<<jt)>0))return-1;const Lt=this._bitArrays.slice(0,Bt).reduce(popCountReduce,0),Ht=~(4294967295<<jt+1),Vt=popCount(Nt&Ht);return Lt+Vt-1}_bytePosFor(At,xt){const Bt=Math.floor(At/BITS_PER_BYTE),Nt=Bt+1;for(;!xt&&this._bitArrays.length<Nt;)this._bitArrays.push(0);return Bt}_setBit(At){const xt=this._bytePosFor(At,!1);this._bitArrays[xt]|=1<<At-xt*BITS_PER_BYTE}_unsetBit(At){const xt=this._bytePosFor(At,!1);this._bitArrays[xt]&=~(1<<At-xt*BITS_PER_BYTE)}_setInternalPos(At,xt,Bt,Nt){const jt=this._data,Ut=[xt,Bt];if(Nt)this._sortData(),jt[At]=Ut;else{if(jt.length)if(jt[jt.length-1][0]>=xt)jt.push(Ut);else if(jt[0][0]<=xt)jt.unshift(Ut);else{const Lt=Math.round(jt.length/2);this._data=jt.slice(0,Lt).concat(Ut).concat(jt.slice(Lt))}else this._data.push(Ut);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(At){this._data.splice(At,1)}_sortData(){this._changedData&&this._data.sort(sortInternal),this._changedData=!1}bitField(){const At=[];let xt=8,Bt=0,Nt=0,jt;const Ut=this._bitArrays.slice();for(;Ut.length||Bt;){Bt===0&&(jt=Ut.shift(),Bt=7);const Ht=Math.min(Bt,xt),Vt=~(255<<Ht),zt=jt&Vt;Nt|=zt<<8-xt,jt=jt>>>Ht,Bt-=Ht,xt-=Ht,(!xt||!Bt&&!Ut.length)&&(At.push(Nt),Nt=0,xt=8)}for(var Lt=At.length-1;Lt>0&&At[Lt]===0;Lt--)At.pop();return At}compactArray(){return this._sortData(),this._data.map(valueOnly)}};function popCountReduce(kt,At){return kt+popCount(At)}function popCount(kt){let At=kt;return At=At-(At>>1&1431655765),At=(At&858993459)+(At>>2&858993459),(At+(At>>4)&252645135)*16843009>>24}function sortInternal(kt,At){return kt[0]-At[0]}function valueOnly(kt){return kt[1]}const SparseArray=getDefaultExportFromCjs(sparseArray);class Bucket{_options;_popCount;_parent;_posAtParent;_children;key;constructor(At,xt,Bt=0){this._options=At,this._popCount=0,this._parent=xt,this._posAtParent=Bt,this._children=new SparseArray,this.key=null}async put(At,xt){const Bt=await this._findNewBucketAndPos(At);Bt.bucket._putAt(Bt,At,xt)}async get(At){const xt=await this._findChild(At);if(xt!=null)return xt.value}async del(At){const xt=await this._findPlace(At),Bt=xt.bucket._at(xt.pos);Bt!=null&&Bt.key===At&&xt.bucket._delAt(xt.pos)}leafCount(){return this._children.compactArray().reduce((xt,Bt)=>Bt instanceof Bucket?xt+Bt.leafCount():xt+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const At=this._children.compactArray();for(const xt of At)xt instanceof Bucket?yield*xt.eachLeafSeries():yield xt}serialize(At,xt){const Bt=[];return xt(this._children.reduce((Nt,jt,Ut)=>(jt!=null&&(jt instanceof Bucket?Nt.push(jt.serialize(At,xt)):Nt.push(At(jt,Ut))),Nt),Bt))}async asyncTransform(At,xt){return asyncTransformBucket(this,At,xt)}toJSON(){return this.serialize(mapNode,reduceNodes)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(At){const xt=await this._findPlace(At),Bt=xt.bucket._at(xt.pos);if(!(Bt instanceof Bucket)&&Bt!=null&&Bt.key===At)return Bt}async _findPlace(At){const xt=this._options.hash(typeof At=="string"?fromString$3(At):At),Bt=await xt.take(this._options.bits),Nt=this._children.get(Bt);return Nt instanceof Bucket?Nt._findPlace(xt):{bucket:this,pos:Bt,hash:xt,existingChild:Nt}}async _findNewBucketAndPos(At){const xt=await this._findPlace(At);if(xt.existingChild!=null&&xt.existingChild.key!==At){const Bt=new Bucket(this._options,xt.bucket,xt.pos);xt.bucket._putObjectAt(xt.pos,Bt);const Nt=await Bt._findPlace(xt.existingChild.hash);return Nt.bucket._putAt(Nt,xt.existingChild.key,xt.existingChild.value),Bt._findNewBucketAndPos(xt.hash)}return xt}_putAt(At,xt,Bt){this._putObjectAt(At.pos,{key:xt,value:Bt,hash:At.hash})}_putObjectAt(At,xt){this._children.get(At)==null&&this._popCount++,this._children.set(At,xt)}_delAt(At){if(At===-1)throw new Error("Invalid position");this._children.get(At)!=null&&this._popCount--,this._children.unset(At),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){const At=this._children.find(exists$5);if(At!=null&&!(At instanceof Bucket)){const xt=At.hash;xt.untake(this._options.bits);const Bt={pos:this._posAtParent,hash:xt,bucket:this._parent};this._parent._putAt(Bt,At.key,At.value)}}else this._parent._delAt(this._posAtParent)}_at(At){return this._children.get(At)}}function exists$5(kt){return!!kt}function mapNode(kt,At){return kt.key}function reduceNodes(kt){return kt}async function asyncTransformBucket(kt,At,xt){const Bt=[];for(const Nt of kt._children.compactArray())if(Nt instanceof Bucket)await asyncTransformBucket(Nt,At,xt);else{const jt=await At(Nt);Bt.push({bitField:kt._children.bitField(),children:jt})}return xt(Bt)}const START_MASKS=[255,254,252,248,240,224,192,128],STOP_MASKS=[1,3,7,15,31,63,127,255];class ConsumableBuffer{_value;_currentBytePos;_currentBitPos;constructor(At){this._value=At,this._currentBytePos=At.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(At){let xt=At,Bt=0;for(;xt>0&&this._haveBits();){const Nt=this._value[this._currentBytePos],jt=this._currentBitPos+1,Ut=Math.min(jt,xt),Lt=byteBitsToInt(Nt,jt-Ut,Ut);Bt=(Bt<<Ut)+Lt,xt-=Ut,this._currentBitPos-=Ut,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return Bt}untake(At){for(this._currentBitPos+=At;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function byteBitsToInt(kt,At,xt){const Bt=maskFor(At,xt);return(kt&Bt)>>>At}function maskFor(kt,At){return START_MASKS[kt]&STOP_MASKS[Math.min(At+kt-1,7)]}function wrapHash(kt){function At(xt){return xt instanceof InfiniteHash?xt:new InfiniteHash(xt,kt)}return At}class InfiniteHash{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(At,xt){if(!(At instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=At,this._hashFn=xt,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(At){let xt=At;for(;this._availableBits<xt;)await this._produceMoreBits();let Bt=0;for(;xt>0;){const Nt=this._buffers[this._currentBufferIndex],jt=Math.min(Nt.availableBits(),xt),Ut=Nt.take(jt);Bt=(Bt<<jt)+Ut,xt-=jt,this._availableBits-=jt,Nt.availableBits()===0&&this._currentBufferIndex++}return Bt}untake(At){let xt=At;for(;xt>0;){const Bt=this._buffers[this._currentBufferIndex],Nt=Math.min(Bt.totalBits()-Bt.availableBits(),xt);Bt.untake(Nt),xt-=Nt,this._availableBits+=Nt,this._currentBufferIndex>0&&Bt.totalBits()===Bt.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const At=this._depth>0?concat$2([this._value,Uint8Array.from([this._depth])]):this._value,xt=await this._hashFn(At),Bt=new ConsumableBuffer(xt);this._buffers.push(Bt),this._availableBits+=Bt.availableBits()}}function createHAMT(kt){if(kt==null||kt.hashFn==null)throw new Error("please define an options.hashFn");const At={bits:kt.bits??8,hash:wrapHash(kt.hashFn)};return new Bucket(At)}async function hamtHashFn(kt){return(await murmur3128.encode(kt)).slice(0,8).reverse()}const HAMT_HASH_CODE=BigInt(34);class DirSharded extends Dir{_bucket;constructor(At,xt){super(At,xt),this._bucket=createHAMT({hashFn:hamtHashFn,bits:8})}async put(At,xt){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(At,xt)}async get(At){return this._bucket.get(At)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:At,value:xt}of this._bucket.eachLeafSeries())yield{key:At,child:xt}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=calculateSize(this._bucket,this,this.options),this.nodeSize)}async*flush(At){for await(const xt of flush(this._bucket,At,this,this.options))yield{...xt,path:this.path}}}async function*flush(kt,At,xt,Bt){const Nt=kt._children,jt=[];let Ut=0n;for(let Qt=0;Qt<Nt.length;Qt++){const Xt=Nt.get(Qt);if(Xt==null)continue;const tr=Qt.toString(16).toUpperCase().padStart(2,"0");if(Xt instanceof Bucket){let rr;for await(const nr of flush(Xt,At,null,Bt))rr=nr;if(rr==null)throw new Error("Could not flush sharded directory, no subshard found");jt.push({Name:tr,Tsize:Number(rr.size),Hash:rr.cid}),Ut+=rr.size}else if(isDir(Xt.value)){const rr=Xt.value;let nr;for await(const ir of rr.flush(At))nr=ir,yield nr;if(nr==null)throw new Error("Did not flush dir");const ar=tr+Xt.key;jt.push({Name:ar,Tsize:Number(nr.size),Hash:nr.cid}),Ut+=nr.size}else{const rr=Xt.value;if(rr.cid==null)continue;const nr=tr+Xt.key,ar=rr.size;jt.push({Name:nr,Tsize:Number(ar),Hash:rr.cid}),Ut+=BigInt(ar??0)}}const Lt=Uint8Array.from(Nt.bitField().reverse()),Ht=new UnixFS({type:"hamt-sharded-directory",data:Lt,fanout:BigInt(kt.tableSize()),hashType:HAMT_HASH_CODE,mtime:xt==null?void 0:xt.mtime,mode:xt==null?void 0:xt.mode}),Vt={Data:Ht.marshal(),Links:jt},zt=encode$a(prepare(Vt)),Wt=await persist(zt,At,Bt),Jt=BigInt(zt.byteLength)+Ut;yield{cid:Wt,unixfs:Ht,size:Jt}}function isDir(kt){return typeof kt.flush=="function"}function calculateSize(kt,At,xt){const Bt=kt._children,Nt=[];for(let Ht=0;Ht<Bt.length;Ht++){const Vt=Bt.get(Ht);if(Vt==null)continue;const zt=Ht.toString(16).toUpperCase().padStart(2,"0");if(Vt instanceof Bucket){const Wt=calculateSize(Vt,null,xt);Nt.push({Name:zt,Tsize:Number(Wt),Hash:xt.cidVersion===0?CID_V0:CID_V1})}else if(typeof Vt.value.flush=="function"){const Jt=Vt.value.nodeSize();Nt.push({Name:zt+Vt.key,Tsize:Number(Jt),Hash:xt.cidVersion===0?CID_V0:CID_V1})}else{const Wt=Vt.value;if(Wt.cid==null)continue;const Jt=zt+Vt.key,Qt=Wt.size;Nt.push({Name:Jt,Tsize:Number(Qt),Hash:Wt.cid})}}const jt=Uint8Array.from(Bt.bitField().reverse()),Ut=new UnixFS({type:"hamt-sharded-directory",data:jt,fanout:BigInt(kt.tableSize()),hashType:HAMT_HASH_CODE,mtime:At==null?void 0:At.mtime,mode:At==null?void 0:At.mode});return encode$a(prepare({Data:Ut.marshal(),Links:Nt})).length}async function flatToShard(kt,At,xt,Bt){let Nt=At;At instanceof DirFlat&&At.estimateNodeSize()>xt&&(Nt=await convertToShard(At,Bt));const jt=Nt.parent;if(jt!=null){if(Nt!==At){if(kt!=null&&(kt.parent=Nt),Nt.parentKey==null)throw new Error("No parent key found");await jt.put(Nt.parentKey,Nt)}return flatToShard(Nt,jt,xt,Bt)}return Nt}async function convertToShard(kt,At){const xt=new DirSharded({root:kt.root,dir:!0,parent:kt.parent,parentKey:kt.parentKey,path:kt.path,dirty:kt.dirty,flat:!1,mtime:kt.mtime,mode:kt.mode},At);for await(const{key:Bt,child:Nt}of kt.eachChildSeries())await xt.put(Bt,Nt);return xt}const toPathComponents$1=(kt="")=>(kt.trim().match(/([^\\/]|\\\/)+/g)??[]).filter(Boolean);async function addToTree(kt,At,xt){var Lt,Ht;const Bt=toPathComponents$1(kt.path??""),Nt=Bt.length-1;let jt=At,Ut="";for(let Vt=0;Vt<Bt.length;Vt++){const zt=Bt[Vt];Ut+=`${Ut!==""?"/":""}${zt}`;const Wt=Vt===Nt;if(jt.dirty=!0,jt.cid=void 0,jt.size=void 0,Wt)await jt.put(zt,kt),At=await flatToShard(null,jt,xt.shardSplitThresholdBytes,xt);else{let Jt=await jt.get(zt);(Jt==null||!(Jt instanceof Dir))&&(Jt=new DirFlat({root:!1,dir:!0,parent:jt,parentKey:zt,path:Ut,dirty:!0,flat:!0,mtime:(Lt=Jt==null?void 0:Jt.unixfs)==null?void 0:Lt.mtime,mode:(Ht=Jt==null?void 0:Jt.unixfs)==null?void 0:Ht.mode},xt)),await jt.put(zt,Jt),jt=Jt}}return At}async function*flushAndYield(kt,At){var xt;if(!(kt instanceof Dir)){((xt=kt.unixfs)==null?void 0:xt.isDirectory())===!0&&(yield kt);return}yield*kt.flush(At)}function defaultTreeBuilder(kt){return async function*(xt,Bt){let Nt=new DirFlat({root:!0,dir:!0,path:"",dirty:!0,flat:!0},kt),jt,Ut=!1;for await(const Lt of xt){if(Lt==null)continue;const Ht=`${Lt.originalPath??""}`.split("/")[0];Ht!=null&&Ht!==""&&(jt==null?(jt=Ht,Ut=!0):jt!==Ht&&(Ut=!1)),Nt=await addToTree(Lt,Nt,kt),(Lt.unixfs==null||!Lt.unixfs.isDirectory())&&(yield Lt)}if(kt.wrapWithDirectory||Ut&&Nt.childCount()>1)yield*flushAndYield(Nt,Bt);else for await(const Lt of Nt.eachChildSeries())Lt!=null&&(yield*flushAndYield(Lt.child,Bt))}}async function*importer(kt,At,xt={}){let Bt;Symbol.asyncIterator in kt||Symbol.iterator in kt?Bt=kt:Bt=[kt];const Nt=xt.wrapWithDirectory??!1,jt=xt.shardSplitThresholdBytes??262144,Ut=xt.cidVersion??1,Lt=xt.rawLeaves??!0,Ht=xt.leafType??"file",Vt=xt.fileImportConcurrency??50,zt=xt.blockWriteConcurrency??10,Wt=xt.reduceSingleLeafToSelf??!0,Jt=xt.chunker??fixedSize(),Qt=xt.chunkValidator??defaultChunkValidator(),Xt=xt.dagBuilder??defaultDagBuilder({chunker:Jt,chunkValidator:Qt,wrapWithDirectory:Nt,layout:xt.layout??balanced(),bufferImporter:xt.bufferImporter??defaultBufferImporter({cidVersion:Ut,rawLeaves:Lt,leafType:Ht,onProgress:xt.onProgress}),blockWriteConcurrency:zt,reduceSingleLeafToSelf:Wt,cidVersion:Ut,onProgress:xt.onProgress}),tr=xt.treeBuilder??defaultTreeBuilder({wrapWithDirectory:Nt,shardSplitThresholdBytes:jt,cidVersion:Ut,onProgress:xt.onProgress});for await(const rr of tr(parallelBatch(Xt(Bt,At),Vt),At))yield{cid:rr.cid,path:rr.path,unixfs:rr.unixfs,size:rr.size}}var __awaiter$2B=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$9=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};const hashers={[sha256$7.code]:sha256$7},codecs={[code$5]:cbor};class Cid{static computeCid(At,xt=code$5,Bt=sha256$7.code){return __awaiter$2B(this,void 0,void 0,function*(){const Nt=codecs[xt];if(!Nt)throw new DwnError(DwnErrorCode.ComputeCidCodecNotSupported,`codec [${xt}] not supported`);const jt=hashers[Bt];if(!jt)throw new DwnError(DwnErrorCode.ComputeCidMultihashNotSupported,`multihash code [${Bt}] not supported`);const Ut=Nt.encode(At),Lt=yield jt.digest(Ut);return(yield CID.createV1(Nt.code,Lt)).toString()})}static parseCid(At){const xt=CID.parse(At).toV1();if(!codecs[xt.code])throw new DwnError(DwnErrorCode.ParseCidCodecNotSupported,`codec [${xt.code}] not supported`);if(!hashers[xt.multihash.code])throw new DwnError(DwnErrorCode.ParseCidMultihashNotSupported,`multihash code [${xt.multihash.code}] not supported`);return xt}static computeDagPbCidFromBytes(At){var xt,Bt,Nt,jt;return __awaiter$2B(this,void 0,void 0,function*(){const Ut=importer([{content:At}],new BlockstoreMock,{cidVersion:1});let Lt;try{for(var Ht=!0,Vt=__asyncValues$9(Ut),zt;zt=yield Vt.next(),xt=zt.done,!xt;Ht=!0)jt=zt.value,Ht=!1,Lt=jt}catch(Wt){Bt={error:Wt}}finally{try{!Ht&&!xt&&(Nt=Vt.return)&&(yield Nt.call(Vt))}finally{if(Bt)throw Bt.error}}return Lt?Lt.cid.toString():""})}static computeDagPbCidFromStream(At){var xt,Bt,Nt,jt;return __awaiter$2B(this,void 0,void 0,function*(){const Ut=importer([{content:At}],new BlockstoreMock,{cidVersion:1});let Lt;try{for(var Ht=!0,Vt=__asyncValues$9(Ut),zt;zt=yield Vt.next(),xt=zt.done,!xt;Ht=!0)jt=zt.value,Ht=!1,Lt=jt}catch(Wt){Bt={error:Wt}}finally{try{!Ht&&!xt&&(Nt=Vt.return)&&(yield Nt.call(Vt))}finally{if(Bt)throw Bt.error}}return Lt?Lt.cid.toString():""})}}var cryptoBrowserify={},browser$e={exports:{}},safeBuffer$2={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(kt,At){var xt=buffer$2,Bt=xt.Buffer;function Nt(Ut,Lt){for(var Ht in Ut)Lt[Ht]=Ut[Ht]}Bt.from&&Bt.alloc&&Bt.allocUnsafe&&Bt.allocUnsafeSlow?kt.exports=xt:(Nt(xt,At),At.Buffer=jt);function jt(Ut,Lt,Ht){return Bt(Ut,Lt,Ht)}jt.prototype=Object.create(Bt.prototype),Nt(Bt,jt),jt.from=function(Ut,Lt,Ht){if(typeof Ut=="number")throw new TypeError("Argument must not be a number");return Bt(Ut,Lt,Ht)},jt.alloc=function(Ut,Lt,Ht){if(typeof Ut!="number")throw new TypeError("Argument must be a number");var Vt=Bt(Ut);return Lt!==void 0?typeof Ht=="string"?Vt.fill(Lt,Ht):Vt.fill(Lt):Vt.fill(0),Vt},jt.allocUnsafe=function(Ut){if(typeof Ut!="number")throw new TypeError("Argument must be a number");return Bt(Ut)},jt.allocUnsafeSlow=function(Ut){if(typeof Ut!="number")throw new TypeError("Argument must be a number");return xt.SlowBuffer(Ut)}})(safeBuffer$2,safeBuffer$2.exports);var safeBufferExports$1=safeBuffer$2.exports,MAX_BYTES=65536,MAX_UINT32=4294967295;function oldBrowser$1(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Buffer$F=safeBufferExports$1.Buffer,crypto$6=globalThis.crypto||globalThis.msCrypto;crypto$6&&crypto$6.getRandomValues?browser$e.exports=randomBytes$6:browser$e.exports=oldBrowser$1;function randomBytes$6(kt,At){if(kt>MAX_UINT32)throw new RangeError("requested too many random bytes");var xt=Buffer$F.allocUnsafe(kt);if(kt>0)if(kt>MAX_BYTES)for(var Bt=0;Bt<kt;Bt+=MAX_BYTES)crypto$6.getRandomValues(xt.slice(Bt,Bt+MAX_BYTES));else crypto$6.getRandomValues(xt);return typeof At=="function"?process$9.nextTick(function(){At(null,xt)}):xt}var browserExports$2=browser$e.exports,inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(At,xt){xt&&(At.super_=xt,At.prototype=Object.create(xt.prototype,{constructor:{value:At,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(At,xt){if(xt){At.super_=xt;var Bt=function(){};Bt.prototype=xt.prototype,At.prototype=new Bt,At.prototype.constructor=At}};var inherits_browserExports=inherits_browser.exports,readableBrowser$1={exports:{}},events={exports:{}},R$1=typeof Reflect=="object"?Reflect:null,ReflectApply=R$1&&typeof R$1.apply=="function"?R$1.apply:function(At,xt,Bt){return Function.prototype.apply.call(At,xt,Bt)},ReflectOwnKeys;R$1&&typeof R$1.ownKeys=="function"?ReflectOwnKeys=R$1.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(At){return Object.getOwnPropertyNames(At).concat(Object.getOwnPropertySymbols(At))}:ReflectOwnKeys=function(At){return Object.getOwnPropertyNames(At)};function ProcessEmitWarning(kt){console&&console.warn&&console.warn(kt)}var NumberIsNaN$4=Number.isNaN||function(At){return At!==At};function EventEmitter$2(){EventEmitter$2.init.call(this)}events.exports=EventEmitter$2;events.exports.once=once$6;EventEmitter$2.EventEmitter=EventEmitter$2;EventEmitter$2.prototype._events=void 0;EventEmitter$2.prototype._eventsCount=0;EventEmitter$2.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(kt){if(typeof kt!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof kt)}Object.defineProperty(EventEmitter$2,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(kt){if(typeof kt!="number"||kt<0||NumberIsNaN$4(kt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+kt+".");defaultMaxListeners=kt}});EventEmitter$2.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$2.prototype.setMaxListeners=function(At){if(typeof At!="number"||At<0||NumberIsNaN$4(At))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+At+".");return this._maxListeners=At,this};function _getMaxListeners(kt){return kt._maxListeners===void 0?EventEmitter$2.defaultMaxListeners:kt._maxListeners}EventEmitter$2.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter$2.prototype.emit=function(At){for(var xt=[],Bt=1;Bt<arguments.length;Bt++)xt.push(arguments[Bt]);var Nt=At==="error",jt=this._events;if(jt!==void 0)Nt=Nt&&jt.error===void 0;else if(!Nt)return!1;if(Nt){var Ut;if(xt.length>0&&(Ut=xt[0]),Ut instanceof Error)throw Ut;var Lt=new Error("Unhandled error."+(Ut?" ("+Ut.message+")":""));throw Lt.context=Ut,Lt}var Ht=jt[At];if(Ht===void 0)return!1;if(typeof Ht=="function")ReflectApply(Ht,this,xt);else for(var Vt=Ht.length,zt=arrayClone(Ht,Vt),Bt=0;Bt<Vt;++Bt)ReflectApply(zt[Bt],this,xt);return!0};function _addListener(kt,At,xt,Bt){var Nt,jt,Ut;if(checkListener(xt),jt=kt._events,jt===void 0?(jt=kt._events=Object.create(null),kt._eventsCount=0):(jt.newListener!==void 0&&(kt.emit("newListener",At,xt.listener?xt.listener:xt),jt=kt._events),Ut=jt[At]),Ut===void 0)Ut=jt[At]=xt,++kt._eventsCount;else if(typeof Ut=="function"?Ut=jt[At]=Bt?[xt,Ut]:[Ut,xt]:Bt?Ut.unshift(xt):Ut.push(xt),Nt=_getMaxListeners(kt),Nt>0&&Ut.length>Nt&&!Ut.warned){Ut.warned=!0;var Lt=new Error("Possible EventEmitter memory leak detected. "+Ut.length+" "+String(At)+" listeners added. Use emitter.setMaxListeners() to increase limit");Lt.name="MaxListenersExceededWarning",Lt.emitter=kt,Lt.type=At,Lt.count=Ut.length,ProcessEmitWarning(Lt)}return kt}EventEmitter$2.prototype.addListener=function(At,xt){return _addListener(this,At,xt,!1)};EventEmitter$2.prototype.on=EventEmitter$2.prototype.addListener;EventEmitter$2.prototype.prependListener=function(At,xt){return _addListener(this,At,xt,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(kt,At,xt){var Bt={fired:!1,wrapFn:void 0,target:kt,type:At,listener:xt},Nt=onceWrapper.bind(Bt);return Nt.listener=xt,Bt.wrapFn=Nt,Nt}EventEmitter$2.prototype.once=function(At,xt){return checkListener(xt),this.on(At,_onceWrap(this,At,xt)),this};EventEmitter$2.prototype.prependOnceListener=function(At,xt){return checkListener(xt),this.prependListener(At,_onceWrap(this,At,xt)),this};EventEmitter$2.prototype.removeListener=function(At,xt){var Bt,Nt,jt,Ut,Lt;if(checkListener(xt),Nt=this._events,Nt===void 0)return this;if(Bt=Nt[At],Bt===void 0)return this;if(Bt===xt||Bt.listener===xt)--this._eventsCount===0?this._events=Object.create(null):(delete Nt[At],Nt.removeListener&&this.emit("removeListener",At,Bt.listener||xt));else if(typeof Bt!="function"){for(jt=-1,Ut=Bt.length-1;Ut>=0;Ut--)if(Bt[Ut]===xt||Bt[Ut].listener===xt){Lt=Bt[Ut].listener,jt=Ut;break}if(jt<0)return this;jt===0?Bt.shift():spliceOne(Bt,jt),Bt.length===1&&(Nt[At]=Bt[0]),Nt.removeListener!==void 0&&this.emit("removeListener",At,Lt||xt)}return this};EventEmitter$2.prototype.off=EventEmitter$2.prototype.removeListener;EventEmitter$2.prototype.removeAllListeners=function(At){var xt,Bt,Nt;if(Bt=this._events,Bt===void 0)return this;if(Bt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Bt[At]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Bt[At]),this;if(arguments.length===0){var jt=Object.keys(Bt),Ut;for(Nt=0;Nt<jt.length;++Nt)Ut=jt[Nt],Ut!=="removeListener"&&this.removeAllListeners(Ut);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(xt=Bt[At],typeof xt=="function")this.removeListener(At,xt);else if(xt!==void 0)for(Nt=xt.length-1;Nt>=0;Nt--)this.removeListener(At,xt[Nt]);return this};function _listeners(kt,At,xt){var Bt=kt._events;if(Bt===void 0)return[];var Nt=Bt[At];return Nt===void 0?[]:typeof Nt=="function"?xt?[Nt.listener||Nt]:[Nt]:xt?unwrapListeners(Nt):arrayClone(Nt,Nt.length)}EventEmitter$2.prototype.listeners=function(At){return _listeners(this,At,!0)};EventEmitter$2.prototype.rawListeners=function(At){return _listeners(this,At,!1)};EventEmitter$2.listenerCount=function(kt,At){return typeof kt.listenerCount=="function"?kt.listenerCount(At):listenerCount.call(kt,At)};EventEmitter$2.prototype.listenerCount=listenerCount;function listenerCount(kt){var At=this._events;if(At!==void 0){var xt=At[kt];if(typeof xt=="function")return 1;if(xt!==void 0)return xt.length}return 0}EventEmitter$2.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(kt,At){for(var xt=new Array(At),Bt=0;Bt<At;++Bt)xt[Bt]=kt[Bt];return xt}function spliceOne(kt,At){for(;At+1<kt.length;At++)kt[At]=kt[At+1];kt.pop()}function unwrapListeners(kt){for(var At=new Array(kt.length),xt=0;xt<At.length;++xt)At[xt]=kt[xt].listener||kt[xt];return At}function once$6(kt,At){return new Promise(function(xt,Bt){function Nt(Ut){kt.removeListener(At,jt),Bt(Ut)}function jt(){typeof kt.removeListener=="function"&&kt.removeListener("error",Nt),xt([].slice.call(arguments))}eventTargetAgnosticAddListener(kt,At,jt,{once:!0}),At!=="error"&&addErrorHandlerIfEventEmitter(kt,Nt,{once:!0})})}function addErrorHandlerIfEventEmitter(kt,At,xt){typeof kt.on=="function"&&eventTargetAgnosticAddListener(kt,"error",At,xt)}function eventTargetAgnosticAddListener(kt,At,xt,Bt){if(typeof kt.on=="function")Bt.once?kt.once(At,xt):kt.on(At,xt);else if(typeof kt.addEventListener=="function")kt.addEventListener(At,function Nt(jt){Bt.once&&kt.removeEventListener(At,Nt),xt(jt)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof kt)}var eventsExports=events.exports,streamBrowser$1=eventsExports.EventEmitter,util$6={},types$1={},shams$1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var At={},xt=Symbol("test"),Bt=Object(xt);if(typeof xt=="string"||Object.prototype.toString.call(xt)!=="[object Symbol]"||Object.prototype.toString.call(Bt)!=="[object Symbol]")return!1;var Nt=42;At[xt]=Nt;for(xt in At)return!1;if(typeof Object.keys=="function"&&Object.keys(At).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(At).length!==0)return!1;var jt=Object.getOwnPropertySymbols(At);if(jt.length!==1||jt[0]!==xt||!Object.prototype.propertyIsEnumerable.call(At,xt))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var Ut=Object.getOwnPropertyDescriptor(At,xt);if(Ut.value!==Nt||Ut.enumerable!==!0)return!1}return!0},hasSymbols$2=shams$1,shams=function(){return hasSymbols$2()&&!!Symbol.toStringTag},esErrors=Error,_eval=EvalError,range=RangeError,ref$1=ReferenceError,syntax=SyntaxError,type$9=TypeError,uri$2=URIError,origSymbol=typeof Symbol<"u"&&Symbol,hasSymbolSham=shams$1,hasSymbols$1=function(){return typeof origSymbol!="function"||typeof Symbol!="function"||typeof origSymbol("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:hasSymbolSham()},test={__proto__:null,foo:{}},$Object=Object,hasProto$1=function(){return{__proto__:test}.foo===test.foo&&!(test instanceof $Object)},ERROR_MESSAGE="Function.prototype.bind called on incompatible ",toStr$4=Object.prototype.toString,max=Math.max,funcType="[object Function]",concatty=function(At,xt){for(var Bt=[],Nt=0;Nt<At.length;Nt+=1)Bt[Nt]=At[Nt];for(var jt=0;jt<xt.length;jt+=1)Bt[jt+At.length]=xt[jt];return Bt},slicy=function(At,xt){for(var Bt=[],Nt=xt,jt=0;Nt<At.length;Nt+=1,jt+=1)Bt[jt]=At[Nt];return Bt},joiny=function(kt,At){for(var xt="",Bt=0;Bt<kt.length;Bt+=1)xt+=kt[Bt],Bt+1<kt.length&&(xt+=At);return xt},implementation$1=function(At){var xt=this;if(typeof xt!="function"||toStr$4.apply(xt)!==funcType)throw new TypeError(ERROR_MESSAGE+xt);for(var Bt=slicy(arguments,1),Nt,jt=function(){if(this instanceof Nt){var zt=xt.apply(this,concatty(Bt,arguments));return Object(zt)===zt?zt:this}return xt.apply(At,concatty(Bt,arguments))},Ut=max(0,xt.length-Bt.length),Lt=[],Ht=0;Ht<Ut;Ht++)Lt[Ht]="$"+Ht;if(Nt=Function("binder","return function ("+joiny(Lt,",")+"){ return binder.apply(this,arguments); }")(jt),xt.prototype){var Vt=function(){};Vt.prototype=xt.prototype,Nt.prototype=new Vt,Vt.prototype=null}return Nt},implementation=implementation$1,functionBind=Function.prototype.bind||implementation,call$1=Function.prototype.call,$hasOwn=Object.prototype.hasOwnProperty,bind$1=functionBind,hasown=bind$1.call(call$1,$hasOwn),undefined$1,$Error=esErrors,$EvalError=_eval,$RangeError=range,$ReferenceError=ref$1,$SyntaxError$1=syntax,$TypeError$2=type$9,$URIError=uri$2,$Function=Function,getEvalledConstructor=function(kt){try{return $Function('"use strict"; return ('+kt+").constructor;")()}catch{}},$gOPD$1=Object.getOwnPropertyDescriptor;if($gOPD$1)try{$gOPD$1({},"")}catch{$gOPD$1=null}var throwTypeError=function(){throw new $TypeError$2},ThrowTypeError=$gOPD$1?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD$1(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols=hasSymbols$1(),hasProto=hasProto$1(),getProto$1=Object.getPrototypeOf||(hasProto?function(kt){return kt.__proto__}:null),needsEval={},TypedArray=typeof Uint8Array>"u"||!getProto$1?undefined$1:getProto$1(Uint8Array),INTRINSICS={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto$1?getProto$1([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":$Error,"%eval%":eval,"%EvalError%":$EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto$1?getProto$1(getProto$1([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols||!getProto$1?undefined$1:getProto$1(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":$RangeError,"%ReferenceError%":$ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols||!getProto$1?undefined$1:getProto$1(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto$1?getProto$1(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols?Symbol:undefined$1,"%SyntaxError%":$SyntaxError$1,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError$2,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":$URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet};if(getProto$1)try{null.error}catch(kt){var errorProto=getProto$1(getProto$1(kt));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function kt(At){var xt;if(At==="%AsyncFunction%")xt=getEvalledConstructor("async function () {}");else if(At==="%GeneratorFunction%")xt=getEvalledConstructor("function* () {}");else if(At==="%AsyncGeneratorFunction%")xt=getEvalledConstructor("async function* () {}");else if(At==="%AsyncGenerator%"){var Bt=kt("%AsyncGeneratorFunction%");Bt&&(xt=Bt.prototype)}else if(At==="%AsyncIteratorPrototype%"){var Nt=kt("%AsyncGenerator%");Nt&&getProto$1&&(xt=getProto$1(Nt.prototype))}return INTRINSICS[At]=xt,xt},LEGACY_ALIASES={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=functionBind,hasOwn=hasown,$concat=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),$exec=bind.call(Function.call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function(At){var xt=$strSlice(At,0,1),Bt=$strSlice(At,-1);if(xt==="%"&&Bt!=="%")throw new $SyntaxError$1("invalid intrinsic syntax, expected closing `%`");if(Bt==="%"&&xt!=="%")throw new $SyntaxError$1("invalid intrinsic syntax, expected opening `%`");var Nt=[];return $replace(At,rePropName,function(jt,Ut,Lt,Ht){Nt[Nt.length]=Lt?$replace(Ht,reEscapeChar,"$1"):Ut||jt}),Nt},getBaseIntrinsic=function(At,xt){var Bt=At,Nt;if(hasOwn(LEGACY_ALIASES,Bt)&&(Nt=LEGACY_ALIASES[Bt],Bt="%"+Nt[0]+"%"),hasOwn(INTRINSICS,Bt)){var jt=INTRINSICS[Bt];if(jt===needsEval&&(jt=doEval(Bt)),typeof jt>"u"&&!xt)throw new $TypeError$2("intrinsic "+At+" exists, but is not available. Please file an issue!");return{alias:Nt,name:Bt,value:jt}}throw new $SyntaxError$1("intrinsic "+At+" does not exist!")},getIntrinsic=function(At,xt){if(typeof At!="string"||At.length===0)throw new $TypeError$2("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof xt!="boolean")throw new $TypeError$2('"allowMissing" argument must be a boolean');if($exec(/^%?[^%]*%?$/,At)===null)throw new $SyntaxError$1("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Bt=stringToPath(At),Nt=Bt.length>0?Bt[0]:"",jt=getBaseIntrinsic("%"+Nt+"%",xt),Ut=jt.name,Lt=jt.value,Ht=!1,Vt=jt.alias;Vt&&(Nt=Vt[0],$spliceApply(Bt,$concat([0,1],Vt)));for(var zt=1,Wt=!0;zt<Bt.length;zt+=1){var Jt=Bt[zt],Qt=$strSlice(Jt,0,1),Xt=$strSlice(Jt,-1);if((Qt==='"'||Qt==="'"||Qt==="`"||Xt==='"'||Xt==="'"||Xt==="`")&&Qt!==Xt)throw new $SyntaxError$1("property names with quotes must have matching quotes");if((Jt==="constructor"||!Wt)&&(Ht=!0),Nt+="."+Jt,Ut="%"+Nt+"%",hasOwn(INTRINSICS,Ut))Lt=INTRINSICS[Ut];else if(Lt!=null){if(!(Jt in Lt)){if(!xt)throw new $TypeError$2("base intrinsic for "+At+" exists, but the property is not available.");return}if($gOPD$1&&zt+1>=Bt.length){var tr=$gOPD$1(Lt,Jt);Wt=!!tr,Wt&&"get"in tr&&!("originalValue"in tr.get)?Lt=tr.get:Lt=Lt[Jt]}else Wt=hasOwn(Lt,Jt),Lt=Lt[Jt];Wt&&!Ht&&(INTRINSICS[Ut]=Lt)}}return Lt},callBind$2={exports:{}},esDefineProperty,hasRequiredEsDefineProperty;function requireEsDefineProperty(){if(hasRequiredEsDefineProperty)return esDefineProperty;hasRequiredEsDefineProperty=1;var kt=getIntrinsic,At=kt("%Object.defineProperty%",!0)||!1;if(At)try{At({},"a",{value:1})}catch{At=!1}return esDefineProperty=At,esDefineProperty}var GetIntrinsic$3=getIntrinsic,$gOPD=GetIntrinsic$3("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch{$gOPD=null}var gopd$1=$gOPD,$defineProperty$1=requireEsDefineProperty(),$SyntaxError=syntax,$TypeError$1=type$9,gopd=gopd$1,defineDataProperty=function(At,xt,Bt){if(!At||typeof At!="object"&&typeof At!="function")throw new $TypeError$1("`obj` must be an object or a function`");if(typeof xt!="string"&&typeof xt!="symbol")throw new $TypeError$1("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new $TypeError$1("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new $TypeError$1("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new $TypeError$1("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new $TypeError$1("`loose`, if provided, must be a boolean");var Nt=arguments.length>3?arguments[3]:null,jt=arguments.length>4?arguments[4]:null,Ut=arguments.length>5?arguments[5]:null,Lt=arguments.length>6?arguments[6]:!1,Ht=!!gopd&&gopd(At,xt);if($defineProperty$1)$defineProperty$1(At,xt,{configurable:Ut===null&&Ht?Ht.configurable:!Ut,enumerable:Nt===null&&Ht?Ht.enumerable:!Nt,value:Bt,writable:jt===null&&Ht?Ht.writable:!jt});else if(Lt||!Nt&&!jt&&!Ut)At[xt]=Bt;else throw new $SyntaxError("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},$defineProperty=requireEsDefineProperty(),hasPropertyDescriptors=function(){return!!$defineProperty};hasPropertyDescriptors.hasArrayLengthDefineBug=function(){if(!$defineProperty)return null;try{return $defineProperty([],"length",{value:1}).length!==1}catch{return!0}};var hasPropertyDescriptors_1=hasPropertyDescriptors,GetIntrinsic$2=getIntrinsic,define=defineDataProperty,hasDescriptors=hasPropertyDescriptors_1(),gOPD$1=gopd$1,$TypeError=type$9,$floor=GetIntrinsic$2("%Math.floor%"),setFunctionLength=function(At,xt){if(typeof At!="function")throw new $TypeError("`fn` is not a function");if(typeof xt!="number"||xt<0||xt>4294967295||$floor(xt)!==xt)throw new $TypeError("`length` must be a positive 32-bit integer");var Bt=arguments.length>2&&!!arguments[2],Nt=!0,jt=!0;if("length"in At&&gOPD$1){var Ut=gOPD$1(At,"length");Ut&&!Ut.configurable&&(Nt=!1),Ut&&!Ut.writable&&(jt=!1)}return(Nt||jt||!Bt)&&(hasDescriptors?define(At,"length",xt,!0,!0):define(At,"length",xt)),At};(function(kt){var At=functionBind,xt=getIntrinsic,Bt=setFunctionLength,Nt=type$9,jt=xt("%Function.prototype.apply%"),Ut=xt("%Function.prototype.call%"),Lt=xt("%Reflect.apply%",!0)||At.call(Ut,jt),Ht=requireEsDefineProperty(),Vt=xt("%Math.max%");kt.exports=function(Jt){if(typeof Jt!="function")throw new Nt("a function is required");var Qt=Lt(At,Ut,arguments);return Bt(Qt,1+Vt(0,Jt.length-(arguments.length-1)),!0)};var zt=function(){return Lt(At,jt,arguments)};Ht?Ht(kt.exports,"apply",{value:zt}):kt.exports.apply=zt})(callBind$2);var callBindExports=callBind$2.exports,GetIntrinsic$1=getIntrinsic,callBind$1=callBindExports,$indexOf$1=callBind$1(GetIntrinsic$1("String.prototype.indexOf")),callBound$2=function(At,xt){var Bt=GetIntrinsic$1(At,!!xt);return typeof Bt=="function"&&$indexOf$1(At,".prototype.")>-1?callBind$1(Bt):Bt},hasToStringTag$3=shams(),callBound$1=callBound$2,$toString$1=callBound$1("Object.prototype.toString"),isStandardArguments=function(At){return hasToStringTag$3&&At&&typeof At=="object"&&Symbol.toStringTag in At?!1:$toString$1(At)==="[object Arguments]"},isLegacyArguments=function(At){return isStandardArguments(At)?!0:At!==null&&typeof At=="object"&&typeof At.length=="number"&&At.length>=0&&$toString$1(At)!=="[object Array]"&&$toString$1(At.callee)==="[object Function]"},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;var isArguments=supportsStandardArguments?isStandardArguments:isLegacyArguments,toStr$3=Object.prototype.toString,fnToStr$1=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag$2=shams(),getProto=Object.getPrototypeOf,getGeneratorFunc=function(){if(!hasToStringTag$2)return!1;try{return Function("return function*() {}")()}catch{}},GeneratorFunction,isGeneratorFunction=function(At){if(typeof At!="function")return!1;if(isFnRegex.test(fnToStr$1.call(At)))return!0;if(!hasToStringTag$2){var xt=toStr$3.call(At);return xt==="[object GeneratorFunction]"}if(!getProto)return!1;if(typeof GeneratorFunction>"u"){var Bt=getGeneratorFunc();GeneratorFunction=Bt?getProto(Bt):!1}return getProto(At)===GeneratorFunction},fnToStr=Function.prototype.toString,reflectApply=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,badArrayLike,isCallableMarker;if(typeof reflectApply=="function"&&typeof Object.defineProperty=="function")try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch(kt){kt!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;var constructorRegex=/^\s*class\b/,isES6ClassFn=function(At){try{var xt=fnToStr.call(At);return constructorRegex.test(xt)}catch{return!1}},tryFunctionObject=function(At){try{return isES6ClassFn(At)?!1:(fnToStr.call(At),!0)}catch{return!1}},toStr$2=Object.prototype.toString,objectClass="[object Object]",fnClass="[object Function]",genClass="[object GeneratorFunction]",ddaClass="[object HTMLAllCollection]",ddaClass2="[object HTML document.all class]",ddaClass3="[object HTMLCollection]",hasToStringTag$1=typeof Symbol=="function"&&!!Symbol.toStringTag,isIE68=!(0 in[,]),isDDA=function(){return!1};if(typeof document=="object"){var all=document.all;toStr$2.call(all)===toStr$2.call(document.all)&&(isDDA=function(At){if((isIE68||!At)&&(typeof At>"u"||typeof At=="object"))try{var xt=toStr$2.call(At);return(xt===ddaClass||xt===ddaClass2||xt===ddaClass3||xt===objectClass)&&At("")==null}catch{}return!1})}var isCallable$1=reflectApply?function(At){if(isDDA(At))return!0;if(!At||typeof At!="function"&&typeof At!="object")return!1;try{reflectApply(At,null,badArrayLike)}catch(xt){if(xt!==isCallableMarker)return!1}return!isES6ClassFn(At)&&tryFunctionObject(At)}:function(At){if(isDDA(At))return!0;if(!At||typeof At!="function"&&typeof At!="object")return!1;if(hasToStringTag$1)return tryFunctionObject(At);if(isES6ClassFn(At))return!1;var xt=toStr$2.call(At);return xt!==fnClass&&xt!==genClass&&!/^\[object HTML/.test(xt)?!1:tryFunctionObject(At)},isCallable=isCallable$1,toStr$1=Object.prototype.toString,hasOwnProperty$1=Object.prototype.hasOwnProperty,forEachArray=function(At,xt,Bt){for(var Nt=0,jt=At.length;Nt<jt;Nt++)hasOwnProperty$1.call(At,Nt)&&(Bt==null?xt(At[Nt],Nt,At):xt.call(Bt,At[Nt],Nt,At))},forEachString=function(At,xt,Bt){for(var Nt=0,jt=At.length;Nt<jt;Nt++)Bt==null?xt(At.charAt(Nt),Nt,At):xt.call(Bt,At.charAt(Nt),Nt,At)},forEachObject=function(At,xt,Bt){for(var Nt in At)hasOwnProperty$1.call(At,Nt)&&(Bt==null?xt(At[Nt],Nt,At):xt.call(Bt,At[Nt],Nt,At))},forEach$3=function(At,xt,Bt){if(!isCallable(xt))throw new TypeError("iterator must be a function");var Nt;arguments.length>=3&&(Nt=Bt),toStr$1.call(At)==="[object Array]"?forEachArray(At,xt,Nt):typeof At=="string"?forEachString(At,xt,Nt):forEachObject(At,xt,Nt)},forEach_1=forEach$3,possibleTypedArrayNames=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],possibleNames=possibleTypedArrayNames,g$2=globalThis,availableTypedArrays$1=function(){for(var At=[],xt=0;xt<possibleNames.length;xt++)typeof g$2[possibleNames[xt]]=="function"&&(At[At.length]=possibleNames[xt]);return At},forEach$2=forEach_1,availableTypedArrays=availableTypedArrays$1,callBind=callBindExports,callBound=callBound$2,gOPD=gopd$1,$toString=callBound("Object.prototype.toString"),hasToStringTag=shams(),g$1=globalThis,typedArrays=availableTypedArrays(),$slice=callBound("String.prototype.slice"),getPrototypeOf=Object.getPrototypeOf,$indexOf=callBound("Array.prototype.indexOf",!0)||function(At,xt){for(var Bt=0;Bt<At.length;Bt+=1)if(At[Bt]===xt)return Bt;return-1},cache={__proto__:null};hasToStringTag&&gOPD&&getPrototypeOf?forEach$2(typedArrays,function(kt){var At=new g$1[kt];if(Symbol.toStringTag in At){var xt=getPrototypeOf(At),Bt=gOPD(xt,Symbol.toStringTag);if(!Bt){var Nt=getPrototypeOf(xt);Bt=gOPD(Nt,Symbol.toStringTag)}cache["$"+kt]=callBind(Bt.get)}}):forEach$2(typedArrays,function(kt){var At=new g$1[kt],xt=At.slice||At.set;xt&&(cache["$"+kt]=callBind(xt))});var tryTypedArrays=function(At){var xt=!1;return forEach$2(cache,function(Bt,Nt){if(!xt)try{"$"+Bt(At)===Nt&&(xt=$slice(Nt,1))}catch{}}),xt},trySlices=function(At){var xt=!1;return forEach$2(cache,function(Bt,Nt){if(!xt)try{Bt(At),xt=$slice(Nt,1)}catch{}}),xt},whichTypedArray$1=function(At){if(!At||typeof At!="object")return!1;if(!hasToStringTag){var xt=$slice($toString(At),8,-1);return $indexOf(typedArrays,xt)>-1?xt:xt!=="Object"?!1:trySlices(At)}return gOPD?tryTypedArrays(At):null},whichTypedArray=whichTypedArray$1,isTypedArray=function(At){return!!whichTypedArray(At)};(function(kt){var At=isArguments,xt=isGeneratorFunction,Bt=whichTypedArray$1,Nt=isTypedArray;function jt(Hr){return Hr.call.bind(Hr)}var Ut=typeof BigInt<"u",Lt=typeof Symbol<"u",Ht=jt(Object.prototype.toString),Vt=jt(Number.prototype.valueOf),zt=jt(String.prototype.valueOf),Wt=jt(Boolean.prototype.valueOf);if(Ut)var Jt=jt(BigInt.prototype.valueOf);if(Lt)var Qt=jt(Symbol.prototype.valueOf);function Xt(Hr,Qr){if(typeof Hr!="object")return!1;try{return Qr(Hr),!0}catch{return!1}}kt.isArgumentsObject=At,kt.isGeneratorFunction=xt,kt.isTypedArray=Nt;function tr(Hr){return typeof Promise<"u"&&Hr instanceof Promise||Hr!==null&&typeof Hr=="object"&&typeof Hr.then=="function"&&typeof Hr.catch=="function"}kt.isPromise=tr;function rr(Hr){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Hr):Nt(Hr)||Tr(Hr)}kt.isArrayBufferView=rr;function nr(Hr){return Bt(Hr)==="Uint8Array"}kt.isUint8Array=nr;function ar(Hr){return Bt(Hr)==="Uint8ClampedArray"}kt.isUint8ClampedArray=ar;function ir(Hr){return Bt(Hr)==="Uint16Array"}kt.isUint16Array=ir;function lr(Hr){return Bt(Hr)==="Uint32Array"}kt.isUint32Array=lr;function yr(Hr){return Bt(Hr)==="Int8Array"}kt.isInt8Array=yr;function Sr(Hr){return Bt(Hr)==="Int16Array"}kt.isInt16Array=Sr;function Ar(Hr){return Bt(Hr)==="Int32Array"}kt.isInt32Array=Ar;function Dr(Hr){return Bt(Hr)==="Float32Array"}kt.isFloat32Array=Dr;function Br(Hr){return Bt(Hr)==="Float64Array"}kt.isFloat64Array=Br;function Lr(Hr){return Bt(Hr)==="BigInt64Array"}kt.isBigInt64Array=Lr;function Or(Hr){return Bt(Hr)==="BigUint64Array"}kt.isBigUint64Array=Or;function vr(Hr){return Ht(Hr)==="[object Map]"}vr.working=typeof Map<"u"&&vr(new Map);function pr(Hr){return typeof Map>"u"?!1:vr.working?vr(Hr):Hr instanceof Map}kt.isMap=pr;function dr(Hr){return Ht(Hr)==="[object Set]"}dr.working=typeof Set<"u"&&dr(new Set);function ur(Hr){return typeof Set>"u"?!1:dr.working?dr(Hr):Hr instanceof Set}kt.isSet=ur;function $r(Hr){return Ht(Hr)==="[object WeakMap]"}$r.working=typeof WeakMap<"u"&&$r(new WeakMap);function wr(Hr){return typeof WeakMap>"u"?!1:$r.working?$r(Hr):Hr instanceof WeakMap}kt.isWeakMap=wr;function Er(Hr){return Ht(Hr)==="[object WeakSet]"}Er.working=typeof WeakSet<"u"&&Er(new WeakSet);function gr(Hr){return Er(Hr)}kt.isWeakSet=gr;function fr(Hr){return Ht(Hr)==="[object ArrayBuffer]"}fr.working=typeof ArrayBuffer<"u"&&fr(new ArrayBuffer);function br(Hr){return typeof ArrayBuffer>"u"?!1:fr.working?fr(Hr):Hr instanceof ArrayBuffer}kt.isArrayBuffer=br;function _r(Hr){return Ht(Hr)==="[object DataView]"}_r.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&_r(new DataView(new ArrayBuffer(1),0,1));function Tr(Hr){return typeof DataView>"u"?!1:_r.working?_r(Hr):Hr instanceof DataView}kt.isDataView=Tr;var Pr=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Nr(Hr){return Ht(Hr)==="[object SharedArrayBuffer]"}function Cr(Hr){return typeof Pr>"u"?!1:(typeof Nr.working>"u"&&(Nr.working=Nr(new Pr)),Nr.working?Nr(Hr):Hr instanceof Pr)}kt.isSharedArrayBuffer=Cr;function xr(Hr){return Ht(Hr)==="[object AsyncFunction]"}kt.isAsyncFunction=xr;function Rr(Hr){return Ht(Hr)==="[object Map Iterator]"}kt.isMapIterator=Rr;function qr(Hr){return Ht(Hr)==="[object Set Iterator]"}kt.isSetIterator=qr;function Vr(Hr){return Ht(Hr)==="[object Generator]"}kt.isGeneratorObject=Vr;function Gr(Hr){return Ht(Hr)==="[object WebAssembly.Module]"}kt.isWebAssemblyCompiledModule=Gr;function Ur(Hr){return Xt(Hr,Vt)}kt.isNumberObject=Ur;function kr(Hr){return Xt(Hr,zt)}kt.isStringObject=kr;function Fr(Hr){return Xt(Hr,Wt)}kt.isBooleanObject=Fr;function Wr(Hr){return Ut&&Xt(Hr,Jt)}kt.isBigIntObject=Wr;function jr(Hr){return Lt&&Xt(Hr,Qt)}kt.isSymbolObject=jr;function Ir(Hr){return Ur(Hr)||kr(Hr)||Fr(Hr)||Wr(Hr)||jr(Hr)}kt.isBoxedPrimitive=Ir;function Mr(Hr){return typeof Uint8Array<"u"&&(br(Hr)||Cr(Hr))}kt.isAnyArrayBuffer=Mr,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Hr){Object.defineProperty(kt,Hr,{enumerable:!1,value:function(){throw new Error(Hr+" is not supported in userland")}})})})(types$1);var isBufferBrowser=function(At){return At&&typeof At=="object"&&typeof At.copy=="function"&&typeof At.fill=="function"&&typeof At.readUInt8=="function"};(function(kt){var At={},xt=Object.getOwnPropertyDescriptors||function(Pr){for(var Nr=Object.keys(Pr),Cr={},xr=0;xr<Nr.length;xr++)Cr[Nr[xr]]=Object.getOwnPropertyDescriptor(Pr,Nr[xr]);return Cr},Bt=/%[sdj%]/g;kt.format=function(Tr){if(!Sr(Tr)){for(var Pr=[],Nr=0;Nr<arguments.length;Nr++)Pr.push(Lt(arguments[Nr]));return Pr.join(" ")}for(var Nr=1,Cr=arguments,xr=Cr.length,Rr=String(Tr).replace(Bt,function(Vr){if(Vr==="%%")return"%";if(Nr>=xr)return Vr;switch(Vr){case"%s":return String(Cr[Nr++]);case"%d":return Number(Cr[Nr++]);case"%j":try{return JSON.stringify(Cr[Nr++])}catch{return"[Circular]"}default:return Vr}}),qr=Cr[Nr];Nr<xr;qr=Cr[++Nr])ir(qr)||!Lr(qr)?Rr+=" "+qr:Rr+=" "+Lt(qr);return Rr},kt.deprecate=function(Tr,Pr){if(typeof process$9<"u"&&process$9.noDeprecation===!0)return Tr;if(typeof process$9>"u")return function(){return kt.deprecate(Tr,Pr).apply(this,arguments)};var Nr=!1;function Cr(){if(!Nr){if(process$9.throwDeprecation)throw new Error(Pr);process$9.traceDeprecation?console.trace(Pr):console.error(Pr),Nr=!0}return Tr.apply(this,arguments)}return Cr};var Nt={},jt=/^$/;if(At.NODE_DEBUG){var Ut=At.NODE_DEBUG;Ut=Ut.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),jt=new RegExp("^"+Ut+"$","i")}kt.debuglog=function(Tr){if(Tr=Tr.toUpperCase(),!Nt[Tr])if(jt.test(Tr)){var Pr=process$9.pid;Nt[Tr]=function(){var Nr=kt.format.apply(kt,arguments);console.error("%s %d: %s",Tr,Pr,Nr)}}else Nt[Tr]=function(){};return Nt[Tr]};function Lt(Tr,Pr){var Nr={seen:[],stylize:Vt};return arguments.length>=3&&(Nr.depth=arguments[2]),arguments.length>=4&&(Nr.colors=arguments[3]),ar(Pr)?Nr.showHidden=Pr:Pr&&kt._extend(Nr,Pr),Dr(Nr.showHidden)&&(Nr.showHidden=!1),Dr(Nr.depth)&&(Nr.depth=2),Dr(Nr.colors)&&(Nr.colors=!1),Dr(Nr.customInspect)&&(Nr.customInspect=!0),Nr.colors&&(Nr.stylize=Ht),Wt(Nr,Tr,Nr.depth)}kt.inspect=Lt,Lt.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Lt.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Ht(Tr,Pr){var Nr=Lt.styles[Pr];return Nr?"\x1B["+Lt.colors[Nr][0]+"m"+Tr+"\x1B["+Lt.colors[Nr][1]+"m":Tr}function Vt(Tr,Pr){return Tr}function zt(Tr){var Pr={};return Tr.forEach(function(Nr,Cr){Pr[Nr]=!0}),Pr}function Wt(Tr,Pr,Nr){if(Tr.customInspect&&Pr&&pr(Pr.inspect)&&Pr.inspect!==kt.inspect&&!(Pr.constructor&&Pr.constructor.prototype===Pr)){var Cr=Pr.inspect(Nr,Tr);return Sr(Cr)||(Cr=Wt(Tr,Cr,Nr)),Cr}var xr=Jt(Tr,Pr);if(xr)return xr;var Rr=Object.keys(Pr),qr=zt(Rr);if(Tr.showHidden&&(Rr=Object.getOwnPropertyNames(Pr)),vr(Pr)&&(Rr.indexOf("message")>=0||Rr.indexOf("description")>=0))return Qt(Pr);if(Rr.length===0){if(pr(Pr)){var Vr=Pr.name?": "+Pr.name:"";return Tr.stylize("[Function"+Vr+"]","special")}if(Br(Pr))return Tr.stylize(RegExp.prototype.toString.call(Pr),"regexp");if(Or(Pr))return Tr.stylize(Date.prototype.toString.call(Pr),"date");if(vr(Pr))return Qt(Pr)}var Gr="",Ur=!1,kr=["{","}"];if(nr(Pr)&&(Ur=!0,kr=["[","]"]),pr(Pr)){var Fr=Pr.name?": "+Pr.name:"";Gr=" [Function"+Fr+"]"}if(Br(Pr)&&(Gr=" "+RegExp.prototype.toString.call(Pr)),Or(Pr)&&(Gr=" "+Date.prototype.toUTCString.call(Pr)),vr(Pr)&&(Gr=" "+Qt(Pr)),Rr.length===0&&(!Ur||Pr.length==0))return kr[0]+Gr+kr[1];if(Nr<0)return Br(Pr)?Tr.stylize(RegExp.prototype.toString.call(Pr),"regexp"):Tr.stylize("[Object]","special");Tr.seen.push(Pr);var Wr;return Ur?Wr=Xt(Tr,Pr,Nr,qr,Rr):Wr=Rr.map(function(jr){return tr(Tr,Pr,Nr,qr,jr,Ur)}),Tr.seen.pop(),rr(Wr,Gr,kr)}function Jt(Tr,Pr){if(Dr(Pr))return Tr.stylize("undefined","undefined");if(Sr(Pr)){var Nr="'"+JSON.stringify(Pr).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Tr.stylize(Nr,"string")}if(yr(Pr))return Tr.stylize(""+Pr,"number");if(ar(Pr))return Tr.stylize(""+Pr,"boolean");if(ir(Pr))return Tr.stylize("null","null")}function Qt(Tr){return"["+Error.prototype.toString.call(Tr)+"]"}function Xt(Tr,Pr,Nr,Cr,xr){for(var Rr=[],qr=0,Vr=Pr.length;qr<Vr;++qr)gr(Pr,String(qr))?Rr.push(tr(Tr,Pr,Nr,Cr,String(qr),!0)):Rr.push("");return xr.forEach(function(Gr){Gr.match(/^\d+$/)||Rr.push(tr(Tr,Pr,Nr,Cr,Gr,!0))}),Rr}function tr(Tr,Pr,Nr,Cr,xr,Rr){var qr,Vr,Gr;if(Gr=Object.getOwnPropertyDescriptor(Pr,xr)||{value:Pr[xr]},Gr.get?Gr.set?Vr=Tr.stylize("[Getter/Setter]","special"):Vr=Tr.stylize("[Getter]","special"):Gr.set&&(Vr=Tr.stylize("[Setter]","special")),gr(Cr,xr)||(qr="["+xr+"]"),Vr||(Tr.seen.indexOf(Gr.value)<0?(ir(Nr)?Vr=Wt(Tr,Gr.value,null):Vr=Wt(Tr,Gr.value,Nr-1),Vr.indexOf(`
`)>-1&&(Rr?Vr=Vr.split(`
`).map(function(Ur){return"  "+Ur}).join(`
`).slice(2):Vr=`
`+Vr.split(`
`).map(function(Ur){return"   "+Ur}).join(`
`))):Vr=Tr.stylize("[Circular]","special")),Dr(qr)){if(Rr&&xr.match(/^\d+$/))return Vr;qr=JSON.stringify(""+xr),qr.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(qr=qr.slice(1,-1),qr=Tr.stylize(qr,"name")):(qr=qr.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),qr=Tr.stylize(qr,"string"))}return qr+": "+Vr}function rr(Tr,Pr,Nr){var Cr=Tr.reduce(function(xr,Rr){return Rr.indexOf(`
`)>=0,xr+Rr.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Cr>60?Nr[0]+(Pr===""?"":Pr+`
 `)+" "+Tr.join(`,
  `)+" "+Nr[1]:Nr[0]+Pr+" "+Tr.join(", ")+" "+Nr[1]}kt.types=types$1;function nr(Tr){return Array.isArray(Tr)}kt.isArray=nr;function ar(Tr){return typeof Tr=="boolean"}kt.isBoolean=ar;function ir(Tr){return Tr===null}kt.isNull=ir;function lr(Tr){return Tr==null}kt.isNullOrUndefined=lr;function yr(Tr){return typeof Tr=="number"}kt.isNumber=yr;function Sr(Tr){return typeof Tr=="string"}kt.isString=Sr;function Ar(Tr){return typeof Tr=="symbol"}kt.isSymbol=Ar;function Dr(Tr){return Tr===void 0}kt.isUndefined=Dr;function Br(Tr){return Lr(Tr)&&ur(Tr)==="[object RegExp]"}kt.isRegExp=Br,kt.types.isRegExp=Br;function Lr(Tr){return typeof Tr=="object"&&Tr!==null}kt.isObject=Lr;function Or(Tr){return Lr(Tr)&&ur(Tr)==="[object Date]"}kt.isDate=Or,kt.types.isDate=Or;function vr(Tr){return Lr(Tr)&&(ur(Tr)==="[object Error]"||Tr instanceof Error)}kt.isError=vr,kt.types.isNativeError=vr;function pr(Tr){return typeof Tr=="function"}kt.isFunction=pr;function dr(Tr){return Tr===null||typeof Tr=="boolean"||typeof Tr=="number"||typeof Tr=="string"||typeof Tr=="symbol"||typeof Tr>"u"}kt.isPrimitive=dr,kt.isBuffer=isBufferBrowser;function ur(Tr){return Object.prototype.toString.call(Tr)}function $r(Tr){return Tr<10?"0"+Tr.toString(10):Tr.toString(10)}var wr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Er(){var Tr=new Date,Pr=[$r(Tr.getHours()),$r(Tr.getMinutes()),$r(Tr.getSeconds())].join(":");return[Tr.getDate(),wr[Tr.getMonth()],Pr].join(" ")}kt.log=function(){console.log("%s - %s",Er(),kt.format.apply(kt,arguments))},kt.inherits=inherits_browserExports,kt._extend=function(Tr,Pr){if(!Pr||!Lr(Pr))return Tr;for(var Nr=Object.keys(Pr),Cr=Nr.length;Cr--;)Tr[Nr[Cr]]=Pr[Nr[Cr]];return Tr};function gr(Tr,Pr){return Object.prototype.hasOwnProperty.call(Tr,Pr)}var fr=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;kt.promisify=function(Pr){if(typeof Pr!="function")throw new TypeError('The "original" argument must be of type Function');if(fr&&Pr[fr]){var Nr=Pr[fr];if(typeof Nr!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Nr,fr,{value:Nr,enumerable:!1,writable:!1,configurable:!0}),Nr}function Nr(){for(var Cr,xr,Rr=new Promise(function(Gr,Ur){Cr=Gr,xr=Ur}),qr=[],Vr=0;Vr<arguments.length;Vr++)qr.push(arguments[Vr]);qr.push(function(Gr,Ur){Gr?xr(Gr):Cr(Ur)});try{Pr.apply(this,qr)}catch(Gr){xr(Gr)}return Rr}return Object.setPrototypeOf(Nr,Object.getPrototypeOf(Pr)),fr&&Object.defineProperty(Nr,fr,{value:Nr,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Nr,xt(Pr))},kt.promisify.custom=fr;function br(Tr,Pr){if(!Tr){var Nr=new Error("Promise was rejected with a falsy value");Nr.reason=Tr,Tr=Nr}return Pr(Tr)}function _r(Tr){if(typeof Tr!="function")throw new TypeError('The "original" argument must be of type Function');function Pr(){for(var Nr=[],Cr=0;Cr<arguments.length;Cr++)Nr.push(arguments[Cr]);var xr=Nr.pop();if(typeof xr!="function")throw new TypeError("The last argument must be of type Function");var Rr=this,qr=function(){return xr.apply(Rr,arguments)};Tr.apply(this,Nr).then(function(Vr){process$9.nextTick(qr.bind(null,null,Vr))},function(Vr){process$9.nextTick(br.bind(null,Vr,qr))})}return Object.setPrototypeOf(Pr,Object.getPrototypeOf(Tr)),Object.defineProperties(Pr,xt(Tr)),Pr}kt.callbackify=_r})(util$6);var buffer_list$2,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list$2;hasRequiredBuffer_list=1;function kt(Xt,tr){var rr=Object.keys(Xt);if(Object.getOwnPropertySymbols){var nr=Object.getOwnPropertySymbols(Xt);tr&&(nr=nr.filter(function(ar){return Object.getOwnPropertyDescriptor(Xt,ar).enumerable})),rr.push.apply(rr,nr)}return rr}function At(Xt){for(var tr=1;tr<arguments.length;tr++){var rr=arguments[tr]!=null?arguments[tr]:{};tr%2?kt(Object(rr),!0).forEach(function(nr){xt(Xt,nr,rr[nr])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Xt,Object.getOwnPropertyDescriptors(rr)):kt(Object(rr)).forEach(function(nr){Object.defineProperty(Xt,nr,Object.getOwnPropertyDescriptor(rr,nr))})}return Xt}function xt(Xt,tr,rr){return tr=Ut(tr),tr in Xt?Object.defineProperty(Xt,tr,{value:rr,enumerable:!0,configurable:!0,writable:!0}):Xt[tr]=rr,Xt}function Bt(Xt,tr){if(!(Xt instanceof tr))throw new TypeError("Cannot call a class as a function")}function Nt(Xt,tr){for(var rr=0;rr<tr.length;rr++){var nr=tr[rr];nr.enumerable=nr.enumerable||!1,nr.configurable=!0,"value"in nr&&(nr.writable=!0),Object.defineProperty(Xt,Ut(nr.key),nr)}}function jt(Xt,tr,rr){return tr&&Nt(Xt.prototype,tr),Object.defineProperty(Xt,"prototype",{writable:!1}),Xt}function Ut(Xt){var tr=Lt(Xt,"string");return typeof tr=="symbol"?tr:String(tr)}function Lt(Xt,tr){if(typeof Xt!="object"||Xt===null)return Xt;var rr=Xt[Symbol.toPrimitive];if(rr!==void 0){var nr=rr.call(Xt,tr||"default");if(typeof nr!="object")return nr;throw new TypeError("@@toPrimitive must return a primitive value.")}return(tr==="string"?String:Number)(Xt)}var Ht=buffer$2,Vt=Ht.Buffer,zt=util$6,Wt=zt.inspect,Jt=Wt&&Wt.custom||"inspect";function Qt(Xt,tr,rr){Vt.prototype.copy.call(Xt,tr,rr)}return buffer_list$2=function(){function Xt(){Bt(this,Xt),this.head=null,this.tail=null,this.length=0}return jt(Xt,[{key:"push",value:function(rr){var nr={data:rr,next:null};this.length>0?this.tail.next=nr:this.head=nr,this.tail=nr,++this.length}},{key:"unshift",value:function(rr){var nr={data:rr,next:this.head};this.length===0&&(this.tail=nr),this.head=nr,++this.length}},{key:"shift",value:function(){if(this.length!==0){var rr=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,rr}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(rr){if(this.length===0)return"";for(var nr=this.head,ar=""+nr.data;nr=nr.next;)ar+=rr+nr.data;return ar}},{key:"concat",value:function(rr){if(this.length===0)return Vt.alloc(0);for(var nr=Vt.allocUnsafe(rr>>>0),ar=this.head,ir=0;ar;)Qt(ar.data,nr,ir),ir+=ar.data.length,ar=ar.next;return nr}},{key:"consume",value:function(rr,nr){var ar;return rr<this.head.data.length?(ar=this.head.data.slice(0,rr),this.head.data=this.head.data.slice(rr)):rr===this.head.data.length?ar=this.shift():ar=nr?this._getString(rr):this._getBuffer(rr),ar}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(rr){var nr=this.head,ar=1,ir=nr.data;for(rr-=ir.length;nr=nr.next;){var lr=nr.data,yr=rr>lr.length?lr.length:rr;if(yr===lr.length?ir+=lr:ir+=lr.slice(0,rr),rr-=yr,rr===0){yr===lr.length?(++ar,nr.next?this.head=nr.next:this.head=this.tail=null):(this.head=nr,nr.data=lr.slice(yr));break}++ar}return this.length-=ar,ir}},{key:"_getBuffer",value:function(rr){var nr=Vt.allocUnsafe(rr),ar=this.head,ir=1;for(ar.data.copy(nr),rr-=ar.data.length;ar=ar.next;){var lr=ar.data,yr=rr>lr.length?lr.length:rr;if(lr.copy(nr,nr.length-rr,0,yr),rr-=yr,rr===0){yr===lr.length?(++ir,ar.next?this.head=ar.next:this.head=this.tail=null):(this.head=ar,ar.data=lr.slice(yr));break}++ir}return this.length-=ir,nr}},{key:Jt,value:function(rr,nr){return Wt(this,At(At({},nr),{},{depth:0,customInspect:!1}))}}]),Xt}(),buffer_list$2}function destroy$3(kt,At){var xt=this,Bt=this._readableState&&this._readableState.destroyed,Nt=this._writableState&&this._writableState.destroyed;return Bt||Nt?(At?At(kt):kt&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process$9.nextTick(emitErrorNT$3,this,kt)):process$9.nextTick(emitErrorNT$3,this,kt)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(kt||null,function(jt){!At&&jt?xt._writableState?xt._writableState.errorEmitted?process$9.nextTick(emitCloseNT$2,xt):(xt._writableState.errorEmitted=!0,process$9.nextTick(emitErrorAndCloseNT,xt,jt)):process$9.nextTick(emitErrorAndCloseNT,xt,jt):At?(process$9.nextTick(emitCloseNT$2,xt),At(jt)):process$9.nextTick(emitCloseNT$2,xt)}),this)}function emitErrorAndCloseNT(kt,At){emitErrorNT$3(kt,At),emitCloseNT$2(kt)}function emitCloseNT$2(kt){kt._writableState&&!kt._writableState.emitClose||kt._readableState&&!kt._readableState.emitClose||kt.emit("close")}function undestroy$3(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT$3(kt,At){kt.emit("error",At)}function errorOrDestroy$2(kt,At){var xt=kt._readableState,Bt=kt._writableState;xt&&xt.autoDestroy||Bt&&Bt.autoDestroy?kt.destroy(At):kt.emit("error",At)}var destroy_1$3={destroy:destroy$3,undestroy:undestroy$3,errorOrDestroy:errorOrDestroy$2},errorsBrowser={};function _inheritsLoose(kt,At){kt.prototype=Object.create(At.prototype),kt.prototype.constructor=kt,kt.__proto__=At}var codes$4={};function createErrorType(kt,At,xt){xt||(xt=Error);function Bt(jt,Ut,Lt){return typeof At=="string"?At:At(jt,Ut,Lt)}var Nt=function(jt){_inheritsLoose(Ut,jt);function Ut(Lt,Ht,Vt){return jt.call(this,Bt(Lt,Ht,Vt))||this}return Ut}(xt);Nt.prototype.name=xt.name,Nt.prototype.code=kt,codes$4[kt]=Nt}function oneOf$1(kt,At){if(Array.isArray(kt)){var xt=kt.length;return kt=kt.map(function(Bt){return String(Bt)}),xt>2?"one of ".concat(At," ").concat(kt.slice(0,xt-1).join(", "),", or ")+kt[xt-1]:xt===2?"one of ".concat(At," ").concat(kt[0]," or ").concat(kt[1]):"of ".concat(At," ").concat(kt[0])}else return"of ".concat(At," ").concat(String(kt))}function startsWith(kt,At,xt){return kt.substr(0,At.length)===At}function endsWith(kt,At,xt){return(xt===void 0||xt>kt.length)&&(xt=kt.length),kt.substring(xt-At.length,xt)===At}function includes(kt,At,xt){return typeof xt!="number"&&(xt=0),xt+At.length>kt.length?!1:kt.indexOf(At,xt)!==-1}createErrorType("ERR_INVALID_OPT_VALUE",function(kt,At){return'The value "'+At+'" is invalid for option "'+kt+'"'},TypeError);createErrorType("ERR_INVALID_ARG_TYPE",function(kt,At,xt){var Bt;typeof At=="string"&&startsWith(At,"not ")?(Bt="must not be",At=At.replace(/^not /,"")):Bt="must be";var Nt;if(endsWith(kt," argument"))Nt="The ".concat(kt," ").concat(Bt," ").concat(oneOf$1(At,"type"));else{var jt=includes(kt,".")?"property":"argument";Nt='The "'.concat(kt,'" ').concat(jt," ").concat(Bt," ").concat(oneOf$1(At,"type"))}return Nt+=". Received type ".concat(typeof xt),Nt},TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",function(kt){return"The "+kt+" method is not implemented"});createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",function(kt){return"Cannot call "+kt+" after a stream was destroyed"});createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",function(kt){return"Unknown encoding: "+kt},TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");errorsBrowser.codes=codes$4;var ERR_INVALID_OPT_VALUE=errorsBrowser.codes.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom$2(kt,At,xt){return kt.highWaterMark!=null?kt.highWaterMark:At?kt[xt]:null}function getHighWaterMark$4(kt,At,xt,Bt){var Nt=highWaterMarkFrom$2(At,Bt,xt);if(Nt!=null){if(!(isFinite(Nt)&&Math.floor(Nt)===Nt)||Nt<0){var jt=Bt?xt:"highWaterMark";throw new ERR_INVALID_OPT_VALUE(jt,Nt)}return Math.floor(Nt)}return kt.objectMode?16:16*1024}var state$2={getHighWaterMark:getHighWaterMark$4},browser$d=deprecate$1;function deprecate$1(kt,At){if(config$1("noDeprecation"))return kt;var xt=!1;function Bt(){if(!xt){if(config$1("throwDeprecation"))throw new Error(At);config$1("traceDeprecation")?console.trace(At):console.warn(At),xt=!0}return kt.apply(this,arguments)}return Bt}function config$1(kt){try{if(!globalThis.localStorage)return!1}catch{return!1}var At=globalThis.localStorage[kt];return At==null?!1:String(At).toLowerCase()==="true"}var _stream_writable$1,hasRequired_stream_writable$1;function require_stream_writable$1(){if(hasRequired_stream_writable$1)return _stream_writable$1;hasRequired_stream_writable$1=1,_stream_writable$1=Dr;function kt(Cr){var xr=this;this.next=null,this.entry=null,this.finish=function(){Nr(xr,Cr)}}var At;Dr.WritableState=Sr;var xt={deprecate:browser$d},Bt=streamBrowser$1,Nt=buffer$2.Buffer,jt=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Ut(Cr){return Nt.from(Cr)}function Lt(Cr){return Nt.isBuffer(Cr)||Cr instanceof jt}var Ht=destroy_1$3,Vt=state$2,zt=Vt.getHighWaterMark,Wt=errorsBrowser.codes,Jt=Wt.ERR_INVALID_ARG_TYPE,Qt=Wt.ERR_METHOD_NOT_IMPLEMENTED,Xt=Wt.ERR_MULTIPLE_CALLBACK,tr=Wt.ERR_STREAM_CANNOT_PIPE,rr=Wt.ERR_STREAM_DESTROYED,nr=Wt.ERR_STREAM_NULL_VALUES,ar=Wt.ERR_STREAM_WRITE_AFTER_END,ir=Wt.ERR_UNKNOWN_ENCODING,lr=Ht.errorOrDestroy;inherits_browserExports(Dr,Bt);function yr(){}function Sr(Cr,xr,Rr){At=At||require_stream_duplex$1(),Cr=Cr||{},typeof Rr!="boolean"&&(Rr=xr instanceof At),this.objectMode=!!Cr.objectMode,Rr&&(this.objectMode=this.objectMode||!!Cr.writableObjectMode),this.highWaterMark=zt(this,Cr,"writableHighWaterMark",Rr),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var qr=Cr.decodeStrings===!1;this.decodeStrings=!qr,this.defaultEncoding=Cr.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Vr){$r(xr,Vr)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Cr.emitClose!==!1,this.autoDestroy=!!Cr.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new kt(this)}Sr.prototype.getBuffer=function(){for(var xr=this.bufferedRequest,Rr=[];xr;)Rr.push(xr),xr=xr.next;return Rr},function(){try{Object.defineProperty(Sr.prototype,"buffer",{get:xt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Ar;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Ar=Function.prototype[Symbol.hasInstance],Object.defineProperty(Dr,Symbol.hasInstance,{value:function(xr){return Ar.call(this,xr)?!0:this!==Dr?!1:xr&&xr._writableState instanceof Sr}})):Ar=function(xr){return xr instanceof this};function Dr(Cr){At=At||require_stream_duplex$1();var xr=this instanceof At;if(!xr&&!Ar.call(Dr,this))return new Dr(Cr);this._writableState=new Sr(Cr,this,xr),this.writable=!0,Cr&&(typeof Cr.write=="function"&&(this._write=Cr.write),typeof Cr.writev=="function"&&(this._writev=Cr.writev),typeof Cr.destroy=="function"&&(this._destroy=Cr.destroy),typeof Cr.final=="function"&&(this._final=Cr.final)),Bt.call(this)}Dr.prototype.pipe=function(){lr(this,new tr)};function Br(Cr,xr){var Rr=new ar;lr(Cr,Rr),process$9.nextTick(xr,Rr)}function Lr(Cr,xr,Rr,qr){var Vr;return Rr===null?Vr=new nr:typeof Rr!="string"&&!xr.objectMode&&(Vr=new Jt("chunk",["string","Buffer"],Rr)),Vr?(lr(Cr,Vr),process$9.nextTick(qr,Vr),!1):!0}Dr.prototype.write=function(Cr,xr,Rr){var qr=this._writableState,Vr=!1,Gr=!qr.objectMode&&Lt(Cr);return Gr&&!Nt.isBuffer(Cr)&&(Cr=Ut(Cr)),typeof xr=="function"&&(Rr=xr,xr=null),Gr?xr="buffer":xr||(xr=qr.defaultEncoding),typeof Rr!="function"&&(Rr=yr),qr.ending?Br(this,Rr):(Gr||Lr(this,qr,Cr,Rr))&&(qr.pendingcb++,Vr=vr(this,qr,Gr,Cr,xr,Rr)),Vr},Dr.prototype.cork=function(){this._writableState.corked++},Dr.prototype.uncork=function(){var Cr=this._writableState;Cr.corked&&(Cr.corked--,!Cr.writing&&!Cr.corked&&!Cr.bufferProcessing&&Cr.bufferedRequest&&gr(this,Cr))},Dr.prototype.setDefaultEncoding=function(xr){if(typeof xr=="string"&&(xr=xr.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((xr+"").toLowerCase())>-1))throw new ir(xr);return this._writableState.defaultEncoding=xr,this},Object.defineProperty(Dr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Or(Cr,xr,Rr){return!Cr.objectMode&&Cr.decodeStrings!==!1&&typeof xr=="string"&&(xr=Nt.from(xr,Rr)),xr}Object.defineProperty(Dr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function vr(Cr,xr,Rr,qr,Vr,Gr){if(!Rr){var Ur=Or(xr,qr,Vr);qr!==Ur&&(Rr=!0,Vr="buffer",qr=Ur)}var kr=xr.objectMode?1:qr.length;xr.length+=kr;var Fr=xr.length<xr.highWaterMark;if(Fr||(xr.needDrain=!0),xr.writing||xr.corked){var Wr=xr.lastBufferedRequest;xr.lastBufferedRequest={chunk:qr,encoding:Vr,isBuf:Rr,callback:Gr,next:null},Wr?Wr.next=xr.lastBufferedRequest:xr.bufferedRequest=xr.lastBufferedRequest,xr.bufferedRequestCount+=1}else pr(Cr,xr,!1,kr,qr,Vr,Gr);return Fr}function pr(Cr,xr,Rr,qr,Vr,Gr,Ur){xr.writelen=qr,xr.writecb=Ur,xr.writing=!0,xr.sync=!0,xr.destroyed?xr.onwrite(new rr("write")):Rr?Cr._writev(Vr,xr.onwrite):Cr._write(Vr,Gr,xr.onwrite),xr.sync=!1}function dr(Cr,xr,Rr,qr,Vr){--xr.pendingcb,Rr?(process$9.nextTick(Vr,qr),process$9.nextTick(Tr,Cr,xr),Cr._writableState.errorEmitted=!0,lr(Cr,qr)):(Vr(qr),Cr._writableState.errorEmitted=!0,lr(Cr,qr),Tr(Cr,xr))}function ur(Cr){Cr.writing=!1,Cr.writecb=null,Cr.length-=Cr.writelen,Cr.writelen=0}function $r(Cr,xr){var Rr=Cr._writableState,qr=Rr.sync,Vr=Rr.writecb;if(typeof Vr!="function")throw new Xt;if(ur(Rr),xr)dr(Cr,Rr,qr,xr,Vr);else{var Gr=fr(Rr)||Cr.destroyed;!Gr&&!Rr.corked&&!Rr.bufferProcessing&&Rr.bufferedRequest&&gr(Cr,Rr),qr?process$9.nextTick(wr,Cr,Rr,Gr,Vr):wr(Cr,Rr,Gr,Vr)}}function wr(Cr,xr,Rr,qr){Rr||Er(Cr,xr),xr.pendingcb--,qr(),Tr(Cr,xr)}function Er(Cr,xr){xr.length===0&&xr.needDrain&&(xr.needDrain=!1,Cr.emit("drain"))}function gr(Cr,xr){xr.bufferProcessing=!0;var Rr=xr.bufferedRequest;if(Cr._writev&&Rr&&Rr.next){var qr=xr.bufferedRequestCount,Vr=new Array(qr),Gr=xr.corkedRequestsFree;Gr.entry=Rr;for(var Ur=0,kr=!0;Rr;)Vr[Ur]=Rr,Rr.isBuf||(kr=!1),Rr=Rr.next,Ur+=1;Vr.allBuffers=kr,pr(Cr,xr,!0,xr.length,Vr,"",Gr.finish),xr.pendingcb++,xr.lastBufferedRequest=null,Gr.next?(xr.corkedRequestsFree=Gr.next,Gr.next=null):xr.corkedRequestsFree=new kt(xr),xr.bufferedRequestCount=0}else{for(;Rr;){var Fr=Rr.chunk,Wr=Rr.encoding,jr=Rr.callback,Ir=xr.objectMode?1:Fr.length;if(pr(Cr,xr,!1,Ir,Fr,Wr,jr),Rr=Rr.next,xr.bufferedRequestCount--,xr.writing)break}Rr===null&&(xr.lastBufferedRequest=null)}xr.bufferedRequest=Rr,xr.bufferProcessing=!1}Dr.prototype._write=function(Cr,xr,Rr){Rr(new Qt("_write()"))},Dr.prototype._writev=null,Dr.prototype.end=function(Cr,xr,Rr){var qr=this._writableState;return typeof Cr=="function"?(Rr=Cr,Cr=null,xr=null):typeof xr=="function"&&(Rr=xr,xr=null),Cr!=null&&this.write(Cr,xr),qr.corked&&(qr.corked=1,this.uncork()),qr.ending||Pr(this,qr,Rr),this},Object.defineProperty(Dr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function fr(Cr){return Cr.ending&&Cr.length===0&&Cr.bufferedRequest===null&&!Cr.finished&&!Cr.writing}function br(Cr,xr){Cr._final(function(Rr){xr.pendingcb--,Rr&&lr(Cr,Rr),xr.prefinished=!0,Cr.emit("prefinish"),Tr(Cr,xr)})}function _r(Cr,xr){!xr.prefinished&&!xr.finalCalled&&(typeof Cr._final=="function"&&!xr.destroyed?(xr.pendingcb++,xr.finalCalled=!0,process$9.nextTick(br,Cr,xr)):(xr.prefinished=!0,Cr.emit("prefinish")))}function Tr(Cr,xr){var Rr=fr(xr);if(Rr&&(_r(Cr,xr),xr.pendingcb===0&&(xr.finished=!0,Cr.emit("finish"),xr.autoDestroy))){var qr=Cr._readableState;(!qr||qr.autoDestroy&&qr.endEmitted)&&Cr.destroy()}return Rr}function Pr(Cr,xr,Rr){xr.ending=!0,Tr(Cr,xr),Rr&&(xr.finished?process$9.nextTick(Rr):Cr.once("finish",Rr)),xr.ended=!0,Cr.writable=!1}function Nr(Cr,xr,Rr){var qr=Cr.entry;for(Cr.entry=null;qr;){var Vr=qr.callback;xr.pendingcb--,Vr(Rr),qr=qr.next}xr.corkedRequestsFree.next=Cr}return Object.defineProperty(Dr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(xr){this._writableState&&(this._writableState.destroyed=xr)}}),Dr.prototype.destroy=Ht.destroy,Dr.prototype._undestroy=Ht.undestroy,Dr.prototype._destroy=function(Cr,xr){xr(Cr)},_stream_writable$1}var _stream_duplex$1,hasRequired_stream_duplex$1;function require_stream_duplex$1(){if(hasRequired_stream_duplex$1)return _stream_duplex$1;hasRequired_stream_duplex$1=1;var kt=Object.keys||function(Vt){var zt=[];for(var Wt in Vt)zt.push(Wt);return zt};_stream_duplex$1=Ut;var At=require_stream_readable$1(),xt=require_stream_writable$1();inherits_browserExports(Ut,At);for(var Bt=kt(xt.prototype),Nt=0;Nt<Bt.length;Nt++){var jt=Bt[Nt];Ut.prototype[jt]||(Ut.prototype[jt]=xt.prototype[jt])}function Ut(Vt){if(!(this instanceof Ut))return new Ut(Vt);At.call(this,Vt),xt.call(this,Vt),this.allowHalfOpen=!0,Vt&&(Vt.readable===!1&&(this.readable=!1),Vt.writable===!1&&(this.writable=!1),Vt.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Lt)))}Object.defineProperty(Ut.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Ut.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Ut.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Lt(){this._writableState.ended||process$9.nextTick(Ht,this)}function Ht(Vt){Vt.end()}return Object.defineProperty(Ut.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(zt){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=zt,this._writableState.destroyed=zt)}}),_stream_duplex$1}var string_decoder={},hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var kt=safeBufferExports$1.Buffer,At=kt.isEncoding||function(nr){switch(nr=""+nr,nr&&nr.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function xt(nr){if(!nr)return"utf8";for(var ar;;)switch(nr){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return nr;default:if(ar)return;nr=(""+nr).toLowerCase(),ar=!0}}function Bt(nr){var ar=xt(nr);if(typeof ar!="string"&&(kt.isEncoding===At||!At(nr)))throw new Error("Unknown encoding: "+nr);return ar||nr}string_decoder.StringDecoder=Nt;function Nt(nr){this.encoding=Bt(nr);var ar;switch(this.encoding){case"utf16le":this.text=Wt,this.end=Jt,ar=4;break;case"utf8":this.fillLast=Ht,ar=4;break;case"base64":this.text=Qt,this.end=Xt,ar=3;break;default:this.write=tr,this.end=rr;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=kt.allocUnsafe(ar)}Nt.prototype.write=function(nr){if(nr.length===0)return"";var ar,ir;if(this.lastNeed){if(ar=this.fillLast(nr),ar===void 0)return"";ir=this.lastNeed,this.lastNeed=0}else ir=0;return ir<nr.length?ar?ar+this.text(nr,ir):this.text(nr,ir):ar||""},Nt.prototype.end=zt,Nt.prototype.text=Vt,Nt.prototype.fillLast=function(nr){if(this.lastNeed<=nr.length)return nr.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);nr.copy(this.lastChar,this.lastTotal-this.lastNeed,0,nr.length),this.lastNeed-=nr.length};function jt(nr){return nr<=127?0:nr>>5===6?2:nr>>4===14?3:nr>>3===30?4:nr>>6===2?-1:-2}function Ut(nr,ar,ir){var lr=ar.length-1;if(lr<ir)return 0;var yr=jt(ar[lr]);return yr>=0?(yr>0&&(nr.lastNeed=yr-1),yr):--lr<ir||yr===-2?0:(yr=jt(ar[lr]),yr>=0?(yr>0&&(nr.lastNeed=yr-2),yr):--lr<ir||yr===-2?0:(yr=jt(ar[lr]),yr>=0?(yr>0&&(yr===2?yr=0:nr.lastNeed=yr-3),yr):0))}function Lt(nr,ar,ir){if((ar[0]&192)!==128)return nr.lastNeed=0,"";if(nr.lastNeed>1&&ar.length>1){if((ar[1]&192)!==128)return nr.lastNeed=1,"";if(nr.lastNeed>2&&ar.length>2&&(ar[2]&192)!==128)return nr.lastNeed=2,""}}function Ht(nr){var ar=this.lastTotal-this.lastNeed,ir=Lt(this,nr);if(ir!==void 0)return ir;if(this.lastNeed<=nr.length)return nr.copy(this.lastChar,ar,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);nr.copy(this.lastChar,ar,0,nr.length),this.lastNeed-=nr.length}function Vt(nr,ar){var ir=Ut(this,nr,ar);if(!this.lastNeed)return nr.toString("utf8",ar);this.lastTotal=ir;var lr=nr.length-(ir-this.lastNeed);return nr.copy(this.lastChar,0,lr),nr.toString("utf8",ar,lr)}function zt(nr){var ar=nr&&nr.length?this.write(nr):"";return this.lastNeed?ar+"":ar}function Wt(nr,ar){if((nr.length-ar)%2===0){var ir=nr.toString("utf16le",ar);if(ir){var lr=ir.charCodeAt(ir.length-1);if(lr>=55296&&lr<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=nr[nr.length-2],this.lastChar[1]=nr[nr.length-1],ir.slice(0,-1)}return ir}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=nr[nr.length-1],nr.toString("utf16le",ar,nr.length-1)}function Jt(nr){var ar=nr&&nr.length?this.write(nr):"";if(this.lastNeed){var ir=this.lastTotal-this.lastNeed;return ar+this.lastChar.toString("utf16le",0,ir)}return ar}function Qt(nr,ar){var ir=(nr.length-ar)%3;return ir===0?nr.toString("base64",ar):(this.lastNeed=3-ir,this.lastTotal=3,ir===1?this.lastChar[0]=nr[nr.length-1]:(this.lastChar[0]=nr[nr.length-2],this.lastChar[1]=nr[nr.length-1]),nr.toString("base64",ar,nr.length-ir))}function Xt(nr){var ar=nr&&nr.length?this.write(nr):"";return this.lastNeed?ar+this.lastChar.toString("base64",0,3-this.lastNeed):ar}function tr(nr){return nr.toString(this.encoding)}function rr(nr){return nr&&nr.length?this.write(nr):""}return string_decoder}var ERR_STREAM_PREMATURE_CLOSE$4=errorsBrowser.codes.ERR_STREAM_PREMATURE_CLOSE;function once$5(kt){var At=!1;return function(){if(!At){At=!0;for(var xt=arguments.length,Bt=new Array(xt),Nt=0;Nt<xt;Nt++)Bt[Nt]=arguments[Nt];kt.apply(this,Bt)}}}function noop$3(){}function isRequest$5(kt){return kt.setHeader&&typeof kt.abort=="function"}function eos$7(kt,At,xt){if(typeof At=="function")return eos$7(kt,null,At);At||(At={}),xt=once$5(xt||noop$3);var Bt=At.readable||At.readable!==!1&&kt.readable,Nt=At.writable||At.writable!==!1&&kt.writable,jt=function(){kt.writable||Lt()},Ut=kt._writableState&&kt._writableState.finished,Lt=function(){Nt=!1,Ut=!0,Bt||xt.call(kt)},Ht=kt._readableState&&kt._readableState.endEmitted,Vt=function(){Bt=!1,Ht=!0,Nt||xt.call(kt)},zt=function(Xt){xt.call(kt,Xt)},Wt=function(){var Xt;if(Bt&&!Ht)return(!kt._readableState||!kt._readableState.ended)&&(Xt=new ERR_STREAM_PREMATURE_CLOSE$4),xt.call(kt,Xt);if(Nt&&!Ut)return(!kt._writableState||!kt._writableState.ended)&&(Xt=new ERR_STREAM_PREMATURE_CLOSE$4),xt.call(kt,Xt)},Jt=function(){kt.req.on("finish",Lt)};return isRequest$5(kt)?(kt.on("complete",Lt),kt.on("abort",Wt),kt.req?Jt():kt.on("request",Jt)):Nt&&!kt._writableState&&(kt.on("end",jt),kt.on("close",jt)),kt.on("end",Vt),kt.on("finish",Lt),At.error!==!1&&kt.on("error",zt),kt.on("close",Wt),function(){kt.removeListener("complete",Lt),kt.removeListener("abort",Wt),kt.removeListener("request",Jt),kt.req&&kt.req.removeListener("finish",Lt),kt.removeListener("end",jt),kt.removeListener("close",jt),kt.removeListener("finish",Lt),kt.removeListener("end",Vt),kt.removeListener("error",zt),kt.removeListener("close",Wt)}}var endOfStream$2=eos$7,async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var kt;function At(ir,lr,yr){return lr=xt(lr),lr in ir?Object.defineProperty(ir,lr,{value:yr,enumerable:!0,configurable:!0,writable:!0}):ir[lr]=yr,ir}function xt(ir){var lr=Bt(ir,"string");return typeof lr=="symbol"?lr:String(lr)}function Bt(ir,lr){if(typeof ir!="object"||ir===null)return ir;var yr=ir[Symbol.toPrimitive];if(yr!==void 0){var Sr=yr.call(ir,lr||"default");if(typeof Sr!="object")return Sr;throw new TypeError("@@toPrimitive must return a primitive value.")}return(lr==="string"?String:Number)(ir)}var Nt=endOfStream$2,jt=Symbol("lastResolve"),Ut=Symbol("lastReject"),Lt=Symbol("error"),Ht=Symbol("ended"),Vt=Symbol("lastPromise"),zt=Symbol("handlePromise"),Wt=Symbol("stream");function Jt(ir,lr){return{value:ir,done:lr}}function Qt(ir){var lr=ir[jt];if(lr!==null){var yr=ir[Wt].read();yr!==null&&(ir[Vt]=null,ir[jt]=null,ir[Ut]=null,lr(Jt(yr,!1)))}}function Xt(ir){process$9.nextTick(Qt,ir)}function tr(ir,lr){return function(yr,Sr){ir.then(function(){if(lr[Ht]){yr(Jt(void 0,!0));return}lr[zt](yr,Sr)},Sr)}}var rr=Object.getPrototypeOf(function(){}),nr=Object.setPrototypeOf((kt={get stream(){return this[Wt]},next:function(){var lr=this,yr=this[Lt];if(yr!==null)return Promise.reject(yr);if(this[Ht])return Promise.resolve(Jt(void 0,!0));if(this[Wt].destroyed)return new Promise(function(Br,Lr){process$9.nextTick(function(){lr[Lt]?Lr(lr[Lt]):Br(Jt(void 0,!0))})});var Sr=this[Vt],Ar;if(Sr)Ar=new Promise(tr(Sr,this));else{var Dr=this[Wt].read();if(Dr!==null)return Promise.resolve(Jt(Dr,!1));Ar=new Promise(this[zt])}return this[Vt]=Ar,Ar}},At(kt,Symbol.asyncIterator,function(){return this}),At(kt,"return",function(){var lr=this;return new Promise(function(yr,Sr){lr[Wt].destroy(null,function(Ar){if(Ar){Sr(Ar);return}yr(Jt(void 0,!0))})})}),kt),rr),ar=function(lr){var yr,Sr=Object.create(nr,(yr={},At(yr,Wt,{value:lr,writable:!0}),At(yr,jt,{value:null,writable:!0}),At(yr,Ut,{value:null,writable:!0}),At(yr,Lt,{value:null,writable:!0}),At(yr,Ht,{value:lr._readableState.endEmitted,writable:!0}),At(yr,zt,{value:function(Dr,Br){var Lr=Sr[Wt].read();Lr?(Sr[Vt]=null,Sr[jt]=null,Sr[Ut]=null,Dr(Jt(Lr,!1))):(Sr[jt]=Dr,Sr[Ut]=Br)},writable:!0}),yr));return Sr[Vt]=null,Nt(lr,function(Ar){if(Ar&&Ar.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Dr=Sr[Ut];Dr!==null&&(Sr[Vt]=null,Sr[jt]=null,Sr[Ut]=null,Dr(Ar)),Sr[Lt]=Ar;return}var Br=Sr[jt];Br!==null&&(Sr[Vt]=null,Sr[jt]=null,Sr[Ut]=null,Br(Jt(void 0,!0))),Sr[Ht]=!0}),lr.on("readable",Xt.bind(null,Sr)),Sr};return async_iterator=ar,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable$1,hasRequired_stream_readable$1;function require_stream_readable$1(){if(hasRequired_stream_readable$1)return _stream_readable$1;hasRequired_stream_readable$1=1,_stream_readable$1=Br;var kt;Br.ReadableState=Dr,eventsExports.EventEmitter;var At=function(Ur,kr){return Ur.listeners(kr).length},xt=streamBrowser$1,Bt=buffer$2.Buffer,Nt=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function jt(Gr){return Bt.from(Gr)}function Ut(Gr){return Bt.isBuffer(Gr)||Gr instanceof Nt}var Lt=util$6,Ht;Lt&&Lt.debuglog?Ht=Lt.debuglog("stream"):Ht=function(){};var Vt=requireBuffer_list(),zt=destroy_1$3,Wt=state$2,Jt=Wt.getHighWaterMark,Qt=errorsBrowser.codes,Xt=Qt.ERR_INVALID_ARG_TYPE,tr=Qt.ERR_STREAM_PUSH_AFTER_EOF,rr=Qt.ERR_METHOD_NOT_IMPLEMENTED,nr=Qt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,ar,ir,lr;inherits_browserExports(Br,xt);var yr=zt.errorOrDestroy,Sr=["error","close","destroy","pause","resume"];function Ar(Gr,Ur,kr){if(typeof Gr.prependListener=="function")return Gr.prependListener(Ur,kr);!Gr._events||!Gr._events[Ur]?Gr.on(Ur,kr):Array.isArray(Gr._events[Ur])?Gr._events[Ur].unshift(kr):Gr._events[Ur]=[kr,Gr._events[Ur]]}function Dr(Gr,Ur,kr){kt=kt||require_stream_duplex$1(),Gr=Gr||{},typeof kr!="boolean"&&(kr=Ur instanceof kt),this.objectMode=!!Gr.objectMode,kr&&(this.objectMode=this.objectMode||!!Gr.readableObjectMode),this.highWaterMark=Jt(this,Gr,"readableHighWaterMark",kr),this.buffer=new Vt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Gr.emitClose!==!1,this.autoDestroy=!!Gr.autoDestroy,this.destroyed=!1,this.defaultEncoding=Gr.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Gr.encoding&&(ar||(ar=requireString_decoder().StringDecoder),this.decoder=new ar(Gr.encoding),this.encoding=Gr.encoding)}function Br(Gr){if(kt=kt||require_stream_duplex$1(),!(this instanceof Br))return new Br(Gr);var Ur=this instanceof kt;this._readableState=new Dr(Gr,this,Ur),this.readable=!0,Gr&&(typeof Gr.read=="function"&&(this._read=Gr.read),typeof Gr.destroy=="function"&&(this._destroy=Gr.destroy)),xt.call(this)}Object.defineProperty(Br.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Ur){this._readableState&&(this._readableState.destroyed=Ur)}}),Br.prototype.destroy=zt.destroy,Br.prototype._undestroy=zt.undestroy,Br.prototype._destroy=function(Gr,Ur){Ur(Gr)},Br.prototype.push=function(Gr,Ur){var kr=this._readableState,Fr;return kr.objectMode?Fr=!0:typeof Gr=="string"&&(Ur=Ur||kr.defaultEncoding,Ur!==kr.encoding&&(Gr=Bt.from(Gr,Ur),Ur=""),Fr=!0),Lr(this,Gr,Ur,!1,Fr)},Br.prototype.unshift=function(Gr){return Lr(this,Gr,null,!0,!1)};function Lr(Gr,Ur,kr,Fr,Wr){Ht("readableAddChunk",Ur);var jr=Gr._readableState;if(Ur===null)jr.reading=!1,$r(Gr,jr);else{var Ir;if(Wr||(Ir=vr(jr,Ur)),Ir)yr(Gr,Ir);else if(jr.objectMode||Ur&&Ur.length>0)if(typeof Ur!="string"&&!jr.objectMode&&Object.getPrototypeOf(Ur)!==Bt.prototype&&(Ur=jt(Ur)),Fr)jr.endEmitted?yr(Gr,new nr):Or(Gr,jr,Ur,!0);else if(jr.ended)yr(Gr,new tr);else{if(jr.destroyed)return!1;jr.reading=!1,jr.decoder&&!kr?(Ur=jr.decoder.write(Ur),jr.objectMode||Ur.length!==0?Or(Gr,jr,Ur,!1):gr(Gr,jr)):Or(Gr,jr,Ur,!1)}else Fr||(jr.reading=!1,gr(Gr,jr))}return!jr.ended&&(jr.length<jr.highWaterMark||jr.length===0)}function Or(Gr,Ur,kr,Fr){Ur.flowing&&Ur.length===0&&!Ur.sync?(Ur.awaitDrain=0,Gr.emit("data",kr)):(Ur.length+=Ur.objectMode?1:kr.length,Fr?Ur.buffer.unshift(kr):Ur.buffer.push(kr),Ur.needReadable&&wr(Gr)),gr(Gr,Ur)}function vr(Gr,Ur){var kr;return!Ut(Ur)&&typeof Ur!="string"&&Ur!==void 0&&!Gr.objectMode&&(kr=new Xt("chunk",["string","Buffer","Uint8Array"],Ur)),kr}Br.prototype.isPaused=function(){return this._readableState.flowing===!1},Br.prototype.setEncoding=function(Gr){ar||(ar=requireString_decoder().StringDecoder);var Ur=new ar(Gr);this._readableState.decoder=Ur,this._readableState.encoding=this._readableState.decoder.encoding;for(var kr=this._readableState.buffer.head,Fr="";kr!==null;)Fr+=Ur.write(kr.data),kr=kr.next;return this._readableState.buffer.clear(),Fr!==""&&this._readableState.buffer.push(Fr),this._readableState.length=Fr.length,this};var pr=1073741824;function dr(Gr){return Gr>=pr?Gr=pr:(Gr--,Gr|=Gr>>>1,Gr|=Gr>>>2,Gr|=Gr>>>4,Gr|=Gr>>>8,Gr|=Gr>>>16,Gr++),Gr}function ur(Gr,Ur){return Gr<=0||Ur.length===0&&Ur.ended?0:Ur.objectMode?1:Gr!==Gr?Ur.flowing&&Ur.length?Ur.buffer.head.data.length:Ur.length:(Gr>Ur.highWaterMark&&(Ur.highWaterMark=dr(Gr)),Gr<=Ur.length?Gr:Ur.ended?Ur.length:(Ur.needReadable=!0,0))}Br.prototype.read=function(Gr){Ht("read",Gr),Gr=parseInt(Gr,10);var Ur=this._readableState,kr=Gr;if(Gr!==0&&(Ur.emittedReadable=!1),Gr===0&&Ur.needReadable&&((Ur.highWaterMark!==0?Ur.length>=Ur.highWaterMark:Ur.length>0)||Ur.ended))return Ht("read: emitReadable",Ur.length,Ur.ended),Ur.length===0&&Ur.ended?Rr(this):wr(this),null;if(Gr=ur(Gr,Ur),Gr===0&&Ur.ended)return Ur.length===0&&Rr(this),null;var Fr=Ur.needReadable;Ht("need readable",Fr),(Ur.length===0||Ur.length-Gr<Ur.highWaterMark)&&(Fr=!0,Ht("length less than watermark",Fr)),Ur.ended||Ur.reading?(Fr=!1,Ht("reading or ended",Fr)):Fr&&(Ht("do read"),Ur.reading=!0,Ur.sync=!0,Ur.length===0&&(Ur.needReadable=!0),this._read(Ur.highWaterMark),Ur.sync=!1,Ur.reading||(Gr=ur(kr,Ur)));var Wr;return Gr>0?Wr=xr(Gr,Ur):Wr=null,Wr===null?(Ur.needReadable=Ur.length<=Ur.highWaterMark,Gr=0):(Ur.length-=Gr,Ur.awaitDrain=0),Ur.length===0&&(Ur.ended||(Ur.needReadable=!0),kr!==Gr&&Ur.ended&&Rr(this)),Wr!==null&&this.emit("data",Wr),Wr};function $r(Gr,Ur){if(Ht("onEofChunk"),!Ur.ended){if(Ur.decoder){var kr=Ur.decoder.end();kr&&kr.length&&(Ur.buffer.push(kr),Ur.length+=Ur.objectMode?1:kr.length)}Ur.ended=!0,Ur.sync?wr(Gr):(Ur.needReadable=!1,Ur.emittedReadable||(Ur.emittedReadable=!0,Er(Gr)))}}function wr(Gr){var Ur=Gr._readableState;Ht("emitReadable",Ur.needReadable,Ur.emittedReadable),Ur.needReadable=!1,Ur.emittedReadable||(Ht("emitReadable",Ur.flowing),Ur.emittedReadable=!0,process$9.nextTick(Er,Gr))}function Er(Gr){var Ur=Gr._readableState;Ht("emitReadable_",Ur.destroyed,Ur.length,Ur.ended),!Ur.destroyed&&(Ur.length||Ur.ended)&&(Gr.emit("readable"),Ur.emittedReadable=!1),Ur.needReadable=!Ur.flowing&&!Ur.ended&&Ur.length<=Ur.highWaterMark,Cr(Gr)}function gr(Gr,Ur){Ur.readingMore||(Ur.readingMore=!0,process$9.nextTick(fr,Gr,Ur))}function fr(Gr,Ur){for(;!Ur.reading&&!Ur.ended&&(Ur.length<Ur.highWaterMark||Ur.flowing&&Ur.length===0);){var kr=Ur.length;if(Ht("maybeReadMore read 0"),Gr.read(0),kr===Ur.length)break}Ur.readingMore=!1}Br.prototype._read=function(Gr){yr(this,new rr("_read()"))},Br.prototype.pipe=function(Gr,Ur){var kr=this,Fr=this._readableState;switch(Fr.pipesCount){case 0:Fr.pipes=Gr;break;case 1:Fr.pipes=[Fr.pipes,Gr];break;default:Fr.pipes.push(Gr);break}Fr.pipesCount+=1,Ht("pipe count=%d opts=%j",Fr.pipesCount,Ur);var Wr=(!Ur||Ur.end!==!1)&&Gr!==process$9.stdout&&Gr!==process$9.stderr,jr=Wr?Mr:Yr;Fr.endEmitted?process$9.nextTick(jr):kr.once("end",jr),Gr.on("unpipe",Ir);function Ir(an,dn){Ht("onunpipe"),an===kr&&dn&&dn.hasUnpiped===!1&&(dn.hasUnpiped=!0,on())}function Mr(){Ht("onend"),Gr.end()}var Hr=br(kr);Gr.on("drain",Hr);var Qr=!1;function on(){Ht("cleanup"),Gr.removeListener("close",hn),Gr.removeListener("finish",Jr),Gr.removeListener("drain",Hr),Gr.removeListener("error",fn),Gr.removeListener("unpipe",Ir),kr.removeListener("end",Mr),kr.removeListener("end",Yr),kr.removeListener("data",nn),Qr=!0,Fr.awaitDrain&&(!Gr._writableState||Gr._writableState.needDrain)&&Hr()}kr.on("data",nn);function nn(an){Ht("ondata");var dn=Gr.write(an);Ht("dest.write",dn),dn===!1&&((Fr.pipesCount===1&&Fr.pipes===Gr||Fr.pipesCount>1&&Vr(Fr.pipes,Gr)!==-1)&&!Qr&&(Ht("false write response, pause",Fr.awaitDrain),Fr.awaitDrain++),kr.pause())}function fn(an){Ht("onerror",an),Yr(),Gr.removeListener("error",fn),At(Gr,"error")===0&&yr(Gr,an)}Ar(Gr,"error",fn);function hn(){Gr.removeListener("finish",Jr),Yr()}Gr.once("close",hn);function Jr(){Ht("onfinish"),Gr.removeListener("close",hn),Yr()}Gr.once("finish",Jr);function Yr(){Ht("unpipe"),kr.unpipe(Gr)}return Gr.emit("pipe",kr),Fr.flowing||(Ht("pipe resume"),kr.resume()),Gr};function br(Gr){return function(){var kr=Gr._readableState;Ht("pipeOnDrain",kr.awaitDrain),kr.awaitDrain&&kr.awaitDrain--,kr.awaitDrain===0&&At(Gr,"data")&&(kr.flowing=!0,Cr(Gr))}}Br.prototype.unpipe=function(Gr){var Ur=this._readableState,kr={hasUnpiped:!1};if(Ur.pipesCount===0)return this;if(Ur.pipesCount===1)return Gr&&Gr!==Ur.pipes?this:(Gr||(Gr=Ur.pipes),Ur.pipes=null,Ur.pipesCount=0,Ur.flowing=!1,Gr&&Gr.emit("unpipe",this,kr),this);if(!Gr){var Fr=Ur.pipes,Wr=Ur.pipesCount;Ur.pipes=null,Ur.pipesCount=0,Ur.flowing=!1;for(var jr=0;jr<Wr;jr++)Fr[jr].emit("unpipe",this,{hasUnpiped:!1});return this}var Ir=Vr(Ur.pipes,Gr);return Ir===-1?this:(Ur.pipes.splice(Ir,1),Ur.pipesCount-=1,Ur.pipesCount===1&&(Ur.pipes=Ur.pipes[0]),Gr.emit("unpipe",this,kr),this)},Br.prototype.on=function(Gr,Ur){var kr=xt.prototype.on.call(this,Gr,Ur),Fr=this._readableState;return Gr==="data"?(Fr.readableListening=this.listenerCount("readable")>0,Fr.flowing!==!1&&this.resume()):Gr==="readable"&&!Fr.endEmitted&&!Fr.readableListening&&(Fr.readableListening=Fr.needReadable=!0,Fr.flowing=!1,Fr.emittedReadable=!1,Ht("on readable",Fr.length,Fr.reading),Fr.length?wr(this):Fr.reading||process$9.nextTick(Tr,this)),kr},Br.prototype.addListener=Br.prototype.on,Br.prototype.removeListener=function(Gr,Ur){var kr=xt.prototype.removeListener.call(this,Gr,Ur);return Gr==="readable"&&process$9.nextTick(_r,this),kr},Br.prototype.removeAllListeners=function(Gr){var Ur=xt.prototype.removeAllListeners.apply(this,arguments);return(Gr==="readable"||Gr===void 0)&&process$9.nextTick(_r,this),Ur};function _r(Gr){var Ur=Gr._readableState;Ur.readableListening=Gr.listenerCount("readable")>0,Ur.resumeScheduled&&!Ur.paused?Ur.flowing=!0:Gr.listenerCount("data")>0&&Gr.resume()}function Tr(Gr){Ht("readable nexttick read 0"),Gr.read(0)}Br.prototype.resume=function(){var Gr=this._readableState;return Gr.flowing||(Ht("resume"),Gr.flowing=!Gr.readableListening,Pr(this,Gr)),Gr.paused=!1,this};function Pr(Gr,Ur){Ur.resumeScheduled||(Ur.resumeScheduled=!0,process$9.nextTick(Nr,Gr,Ur))}function Nr(Gr,Ur){Ht("resume",Ur.reading),Ur.reading||Gr.read(0),Ur.resumeScheduled=!1,Gr.emit("resume"),Cr(Gr),Ur.flowing&&!Ur.reading&&Gr.read(0)}Br.prototype.pause=function(){return Ht("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Ht("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Cr(Gr){var Ur=Gr._readableState;for(Ht("flow",Ur.flowing);Ur.flowing&&Gr.read()!==null;);}Br.prototype.wrap=function(Gr){var Ur=this,kr=this._readableState,Fr=!1;Gr.on("end",function(){if(Ht("wrapped end"),kr.decoder&&!kr.ended){var Ir=kr.decoder.end();Ir&&Ir.length&&Ur.push(Ir)}Ur.push(null)}),Gr.on("data",function(Ir){if(Ht("wrapped data"),kr.decoder&&(Ir=kr.decoder.write(Ir)),!(kr.objectMode&&Ir==null)&&!(!kr.objectMode&&(!Ir||!Ir.length))){var Mr=Ur.push(Ir);Mr||(Fr=!0,Gr.pause())}});for(var Wr in Gr)this[Wr]===void 0&&typeof Gr[Wr]=="function"&&(this[Wr]=function(Mr){return function(){return Gr[Mr].apply(Gr,arguments)}}(Wr));for(var jr=0;jr<Sr.length;jr++)Gr.on(Sr[jr],this.emit.bind(this,Sr[jr]));return this._read=function(Ir){Ht("wrapped _read",Ir),Fr&&(Fr=!1,Gr.resume())},this},typeof Symbol=="function"&&(Br.prototype[Symbol.asyncIterator]=function(){return ir===void 0&&(ir=requireAsync_iterator()),ir(this)}),Object.defineProperty(Br.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Br.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Br.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Ur){this._readableState&&(this._readableState.flowing=Ur)}}),Br._fromList=xr,Object.defineProperty(Br.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function xr(Gr,Ur){if(Ur.length===0)return null;var kr;return Ur.objectMode?kr=Ur.buffer.shift():!Gr||Gr>=Ur.length?(Ur.decoder?kr=Ur.buffer.join(""):Ur.buffer.length===1?kr=Ur.buffer.first():kr=Ur.buffer.concat(Ur.length),Ur.buffer.clear()):kr=Ur.buffer.consume(Gr,Ur.decoder),kr}function Rr(Gr){var Ur=Gr._readableState;Ht("endReadable",Ur.endEmitted),Ur.endEmitted||(Ur.ended=!0,process$9.nextTick(qr,Ur,Gr))}function qr(Gr,Ur){if(Ht("endReadableNT",Gr.endEmitted,Gr.length),!Gr.endEmitted&&Gr.length===0&&(Gr.endEmitted=!0,Ur.readable=!1,Ur.emit("end"),Gr.autoDestroy)){var kr=Ur._writableState;(!kr||kr.autoDestroy&&kr.finished)&&Ur.destroy()}}typeof Symbol=="function"&&(Br.from=function(Gr,Ur){return lr===void 0&&(lr=requireFromBrowser()),lr(Br,Gr,Ur)});function Vr(Gr,Ur){for(var kr=0,Fr=Gr.length;kr<Fr;kr++)if(Gr[kr]===Ur)return kr;return-1}return _stream_readable$1}var _stream_transform$1=Transform$d,_require$codes$1=errorsBrowser.codes,ERR_METHOD_NOT_IMPLEMENTED$2=_require$codes$1.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK$2=_require$codes$1.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=_require$codes$1.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=_require$codes$1.ERR_TRANSFORM_WITH_LENGTH_0,Duplex$7=require_stream_duplex$1();inherits_browserExports(Transform$d,Duplex$7);function afterTransform$1(kt,At){var xt=this._transformState;xt.transforming=!1;var Bt=xt.writecb;if(Bt===null)return this.emit("error",new ERR_MULTIPLE_CALLBACK$2);xt.writechunk=null,xt.writecb=null,At!=null&&this.push(At),Bt(kt);var Nt=this._readableState;Nt.reading=!1,(Nt.needReadable||Nt.length<Nt.highWaterMark)&&this._read(Nt.highWaterMark)}function Transform$d(kt){if(!(this instanceof Transform$d))return new Transform$d(kt);Duplex$7.call(this,kt),this._transformState={afterTransform:afterTransform$1.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,kt&&(typeof kt.transform=="function"&&(this._transform=kt.transform),typeof kt.flush=="function"&&(this._flush=kt.flush)),this.on("prefinish",prefinish$3)}function prefinish$3(){var kt=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(At,xt){done$1(kt,At,xt)}):done$1(this,null,null)}Transform$d.prototype.push=function(kt,At){return this._transformState.needTransform=!1,Duplex$7.prototype.push.call(this,kt,At)};Transform$d.prototype._transform=function(kt,At,xt){xt(new ERR_METHOD_NOT_IMPLEMENTED$2("_transform()"))};Transform$d.prototype._write=function(kt,At,xt){var Bt=this._transformState;if(Bt.writecb=xt,Bt.writechunk=kt,Bt.writeencoding=At,!Bt.transforming){var Nt=this._readableState;(Bt.needTransform||Nt.needReadable||Nt.length<Nt.highWaterMark)&&this._read(Nt.highWaterMark)}};Transform$d.prototype._read=function(kt){var At=this._transformState;At.writechunk!==null&&!At.transforming?(At.transforming=!0,this._transform(At.writechunk,At.writeencoding,At.afterTransform)):At.needTransform=!0};Transform$d.prototype._destroy=function(kt,At){Duplex$7.prototype._destroy.call(this,kt,function(xt){At(xt)})};function done$1(kt,At,xt){if(At)return kt.emit("error",At);if(xt!=null&&kt.push(xt),kt._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(kt._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return kt.push(null)}var _stream_passthrough$1=PassThrough$5,Transform$c=_stream_transform$1;inherits_browserExports(PassThrough$5,Transform$c);function PassThrough$5(kt){if(!(this instanceof PassThrough$5))return new PassThrough$5(kt);Transform$c.call(this,kt)}PassThrough$5.prototype._transform=function(kt,At,xt){xt(null,kt)};var eos$6;function once$4(kt){var At=!1;return function(){At||(At=!0,kt.apply(void 0,arguments))}}var _require$codes=errorsBrowser.codes,ERR_MISSING_ARGS$6=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED$2=_require$codes.ERR_STREAM_DESTROYED;function noop$2(kt){if(kt)throw kt}function isRequest$4(kt){return kt.setHeader&&typeof kt.abort=="function"}function destroyer$6(kt,At,xt,Bt){Bt=once$4(Bt);var Nt=!1;kt.on("close",function(){Nt=!0}),eos$6===void 0&&(eos$6=endOfStream$2),eos$6(kt,{readable:At,writable:xt},function(Ut){if(Ut)return Bt(Ut);Nt=!0,Bt()});var jt=!1;return function(Ut){if(!Nt&&!jt){if(jt=!0,isRequest$4(kt))return kt.abort();if(typeof kt.destroy=="function")return kt.destroy();Bt(Ut||new ERR_STREAM_DESTROYED$2("pipe"))}}}function call(kt){kt()}function pipe$3(kt,At){return kt.pipe(At)}function popCallback$2(kt){return!kt.length||typeof kt[kt.length-1]!="function"?noop$2:kt.pop()}function pipeline$4(){for(var kt=arguments.length,At=new Array(kt),xt=0;xt<kt;xt++)At[xt]=arguments[xt];var Bt=popCallback$2(At);if(Array.isArray(At[0])&&(At=At[0]),At.length<2)throw new ERR_MISSING_ARGS$6("streams");var Nt,jt=At.map(function(Ut,Lt){var Ht=Lt<At.length-1,Vt=Lt>0;return destroyer$6(Ut,Ht,Vt,function(zt){Nt||(Nt=zt),zt&&jt.forEach(call),!Ht&&(jt.forEach(call),Bt(Nt))})});return At.reduce(pipe$3)}var pipeline_1$2=pipeline$4;(function(kt,At){At=kt.exports=require_stream_readable$1(),At.Stream=At,At.Readable=At,At.Writable=require_stream_writable$1(),At.Duplex=require_stream_duplex$1(),At.Transform=_stream_transform$1,At.PassThrough=_stream_passthrough$1,At.finished=endOfStream$2,At.pipeline=pipeline_1$2})(readableBrowser$1,readableBrowser$1.exports);var readableBrowserExports$1=readableBrowser$1.exports,Buffer$E=safeBufferExports$1.Buffer,Transform$b=readableBrowserExports$1.Transform,inherits$q=inherits_browserExports;function throwIfNotStringOrBuffer(kt,At){if(!Buffer$E.isBuffer(kt)&&typeof kt!="string")throw new TypeError(At+" must be a string or a buffer")}function HashBase$2(kt){Transform$b.call(this),this._block=Buffer$E.allocUnsafe(kt),this._blockSize=kt,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}inherits$q(HashBase$2,Transform$b);HashBase$2.prototype._transform=function(kt,At,xt){var Bt=null;try{this.update(kt,At)}catch(Nt){Bt=Nt}xt(Bt)};HashBase$2.prototype._flush=function(kt){var At=null;try{this.push(this.digest())}catch(xt){At=xt}kt(At)};HashBase$2.prototype.update=function(kt,At){if(throwIfNotStringOrBuffer(kt,"Data"),this._finalized)throw new Error("Digest already called");Buffer$E.isBuffer(kt)||(kt=Buffer$E.from(kt,At));for(var xt=this._block,Bt=0;this._blockOffset+kt.length-Bt>=this._blockSize;){for(var Nt=this._blockOffset;Nt<this._blockSize;)xt[Nt++]=kt[Bt++];this._update(),this._blockOffset=0}for(;Bt<kt.length;)xt[this._blockOffset++]=kt[Bt++];for(var jt=0,Ut=kt.length*8;Ut>0;++jt)this._length[jt]+=Ut,Ut=this._length[jt]/4294967296|0,Ut>0&&(this._length[jt]-=4294967296*Ut);return this};HashBase$2.prototype._update=function(){throw new Error("_update is not implemented")};HashBase$2.prototype.digest=function(kt){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var At=this._digest();kt!==void 0&&(At=At.toString(kt)),this._block.fill(0),this._blockOffset=0;for(var xt=0;xt<4;++xt)this._length[xt]=0;return At};HashBase$2.prototype._digest=function(){throw new Error("_digest is not implemented")};var hashBase=HashBase$2,inherits$p=inherits_browserExports,HashBase$1=hashBase,Buffer$D=safeBufferExports$1.Buffer,ARRAY16$1=new Array(16);function MD5$3(){HashBase$1.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}inherits$p(MD5$3,HashBase$1);MD5$3.prototype._update=function(){for(var kt=ARRAY16$1,At=0;At<16;++At)kt[At]=this._block.readInt32LE(At*4);var xt=this._a,Bt=this._b,Nt=this._c,jt=this._d;xt=fnF(xt,Bt,Nt,jt,kt[0],3614090360,7),jt=fnF(jt,xt,Bt,Nt,kt[1],3905402710,12),Nt=fnF(Nt,jt,xt,Bt,kt[2],606105819,17),Bt=fnF(Bt,Nt,jt,xt,kt[3],3250441966,22),xt=fnF(xt,Bt,Nt,jt,kt[4],4118548399,7),jt=fnF(jt,xt,Bt,Nt,kt[5],1200080426,12),Nt=fnF(Nt,jt,xt,Bt,kt[6],2821735955,17),Bt=fnF(Bt,Nt,jt,xt,kt[7],4249261313,22),xt=fnF(xt,Bt,Nt,jt,kt[8],1770035416,7),jt=fnF(jt,xt,Bt,Nt,kt[9],2336552879,12),Nt=fnF(Nt,jt,xt,Bt,kt[10],4294925233,17),Bt=fnF(Bt,Nt,jt,xt,kt[11],2304563134,22),xt=fnF(xt,Bt,Nt,jt,kt[12],1804603682,7),jt=fnF(jt,xt,Bt,Nt,kt[13],4254626195,12),Nt=fnF(Nt,jt,xt,Bt,kt[14],2792965006,17),Bt=fnF(Bt,Nt,jt,xt,kt[15],1236535329,22),xt=fnG(xt,Bt,Nt,jt,kt[1],4129170786,5),jt=fnG(jt,xt,Bt,Nt,kt[6],3225465664,9),Nt=fnG(Nt,jt,xt,Bt,kt[11],643717713,14),Bt=fnG(Bt,Nt,jt,xt,kt[0],3921069994,20),xt=fnG(xt,Bt,Nt,jt,kt[5],3593408605,5),jt=fnG(jt,xt,Bt,Nt,kt[10],38016083,9),Nt=fnG(Nt,jt,xt,Bt,kt[15],3634488961,14),Bt=fnG(Bt,Nt,jt,xt,kt[4],3889429448,20),xt=fnG(xt,Bt,Nt,jt,kt[9],568446438,5),jt=fnG(jt,xt,Bt,Nt,kt[14],3275163606,9),Nt=fnG(Nt,jt,xt,Bt,kt[3],4107603335,14),Bt=fnG(Bt,Nt,jt,xt,kt[8],1163531501,20),xt=fnG(xt,Bt,Nt,jt,kt[13],2850285829,5),jt=fnG(jt,xt,Bt,Nt,kt[2],4243563512,9),Nt=fnG(Nt,jt,xt,Bt,kt[7],1735328473,14),Bt=fnG(Bt,Nt,jt,xt,kt[12],2368359562,20),xt=fnH(xt,Bt,Nt,jt,kt[5],4294588738,4),jt=fnH(jt,xt,Bt,Nt,kt[8],2272392833,11),Nt=fnH(Nt,jt,xt,Bt,kt[11],1839030562,16),Bt=fnH(Bt,Nt,jt,xt,kt[14],4259657740,23),xt=fnH(xt,Bt,Nt,jt,kt[1],2763975236,4),jt=fnH(jt,xt,Bt,Nt,kt[4],1272893353,11),Nt=fnH(Nt,jt,xt,Bt,kt[7],4139469664,16),Bt=fnH(Bt,Nt,jt,xt,kt[10],3200236656,23),xt=fnH(xt,Bt,Nt,jt,kt[13],681279174,4),jt=fnH(jt,xt,Bt,Nt,kt[0],3936430074,11),Nt=fnH(Nt,jt,xt,Bt,kt[3],3572445317,16),Bt=fnH(Bt,Nt,jt,xt,kt[6],76029189,23),xt=fnH(xt,Bt,Nt,jt,kt[9],3654602809,4),jt=fnH(jt,xt,Bt,Nt,kt[12],3873151461,11),Nt=fnH(Nt,jt,xt,Bt,kt[15],530742520,16),Bt=fnH(Bt,Nt,jt,xt,kt[2],3299628645,23),xt=fnI(xt,Bt,Nt,jt,kt[0],4096336452,6),jt=fnI(jt,xt,Bt,Nt,kt[7],1126891415,10),Nt=fnI(Nt,jt,xt,Bt,kt[14],2878612391,15),Bt=fnI(Bt,Nt,jt,xt,kt[5],4237533241,21),xt=fnI(xt,Bt,Nt,jt,kt[12],1700485571,6),jt=fnI(jt,xt,Bt,Nt,kt[3],2399980690,10),Nt=fnI(Nt,jt,xt,Bt,kt[10],4293915773,15),Bt=fnI(Bt,Nt,jt,xt,kt[1],2240044497,21),xt=fnI(xt,Bt,Nt,jt,kt[8],1873313359,6),jt=fnI(jt,xt,Bt,Nt,kt[15],4264355552,10),Nt=fnI(Nt,jt,xt,Bt,kt[6],2734768916,15),Bt=fnI(Bt,Nt,jt,xt,kt[13],1309151649,21),xt=fnI(xt,Bt,Nt,jt,kt[4],4149444226,6),jt=fnI(jt,xt,Bt,Nt,kt[11],3174756917,10),Nt=fnI(Nt,jt,xt,Bt,kt[2],718787259,15),Bt=fnI(Bt,Nt,jt,xt,kt[9],3951481745,21),this._a=this._a+xt|0,this._b=this._b+Bt|0,this._c=this._c+Nt|0,this._d=this._d+jt|0};MD5$3.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var kt=Buffer$D.allocUnsafe(16);return kt.writeInt32LE(this._a,0),kt.writeInt32LE(this._b,4),kt.writeInt32LE(this._c,8),kt.writeInt32LE(this._d,12),kt};function rotl$3(kt,At){return kt<<At|kt>>>32-At}function fnF(kt,At,xt,Bt,Nt,jt,Ut){return rotl$3(kt+(At&xt|~At&Bt)+Nt+jt|0,Ut)+At|0}function fnG(kt,At,xt,Bt,Nt,jt,Ut){return rotl$3(kt+(At&Bt|xt&~Bt)+Nt+jt|0,Ut)+At|0}function fnH(kt,At,xt,Bt,Nt,jt,Ut){return rotl$3(kt+(At^xt^Bt)+Nt+jt|0,Ut)+At|0}function fnI(kt,At,xt,Bt,Nt,jt,Ut){return rotl$3(kt+(xt^(At|~Bt))+Nt+jt|0,Ut)+At|0}var md5_js=MD5$3,Buffer$C=buffer$2.Buffer,inherits$o=inherits_browserExports,HashBase=hashBase,ARRAY16=new Array(16),zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],hl=[0,1518500249,1859775393,2400959708,2840853838],hr=[1352829926,1548603684,1836072691,2053994217,0];function RIPEMD160$5(){HashBase.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}inherits$o(RIPEMD160$5,HashBase);RIPEMD160$5.prototype._update=function(){for(var kt=ARRAY16,At=0;At<16;++At)kt[At]=this._block.readInt32LE(At*4);for(var xt=this._a|0,Bt=this._b|0,Nt=this._c|0,jt=this._d|0,Ut=this._e|0,Lt=this._a|0,Ht=this._b|0,Vt=this._c|0,zt=this._d|0,Wt=this._e|0,Jt=0;Jt<80;Jt+=1){var Qt,Xt;Jt<16?(Qt=fn1(xt,Bt,Nt,jt,Ut,kt[zl[Jt]],hl[0],sl[Jt]),Xt=fn5(Lt,Ht,Vt,zt,Wt,kt[zr[Jt]],hr[0],sr[Jt])):Jt<32?(Qt=fn2(xt,Bt,Nt,jt,Ut,kt[zl[Jt]],hl[1],sl[Jt]),Xt=fn4(Lt,Ht,Vt,zt,Wt,kt[zr[Jt]],hr[1],sr[Jt])):Jt<48?(Qt=fn3(xt,Bt,Nt,jt,Ut,kt[zl[Jt]],hl[2],sl[Jt]),Xt=fn3(Lt,Ht,Vt,zt,Wt,kt[zr[Jt]],hr[2],sr[Jt])):Jt<64?(Qt=fn4(xt,Bt,Nt,jt,Ut,kt[zl[Jt]],hl[3],sl[Jt]),Xt=fn2(Lt,Ht,Vt,zt,Wt,kt[zr[Jt]],hr[3],sr[Jt])):(Qt=fn5(xt,Bt,Nt,jt,Ut,kt[zl[Jt]],hl[4],sl[Jt]),Xt=fn1(Lt,Ht,Vt,zt,Wt,kt[zr[Jt]],hr[4],sr[Jt])),xt=Ut,Ut=jt,jt=rotl$2(Nt,10),Nt=Bt,Bt=Qt,Lt=Wt,Wt=zt,zt=rotl$2(Vt,10),Vt=Ht,Ht=Xt}var tr=this._b+Nt+zt|0;this._b=this._c+jt+Wt|0,this._c=this._d+Ut+Lt|0,this._d=this._e+xt+Ht|0,this._e=this._a+Bt+Vt|0,this._a=tr};RIPEMD160$5.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var kt=Buffer$C.alloc?Buffer$C.alloc(20):new Buffer$C(20);return kt.writeInt32LE(this._a,0),kt.writeInt32LE(this._b,4),kt.writeInt32LE(this._c,8),kt.writeInt32LE(this._d,12),kt.writeInt32LE(this._e,16),kt};function rotl$2(kt,At){return kt<<At|kt>>>32-At}function fn1(kt,At,xt,Bt,Nt,jt,Ut,Lt){return rotl$2(kt+(At^xt^Bt)+jt+Ut|0,Lt)+Nt|0}function fn2(kt,At,xt,Bt,Nt,jt,Ut,Lt){return rotl$2(kt+(At&xt|~At&Bt)+jt+Ut|0,Lt)+Nt|0}function fn3(kt,At,xt,Bt,Nt,jt,Ut,Lt){return rotl$2(kt+((At|~xt)^Bt)+jt+Ut|0,Lt)+Nt|0}function fn4(kt,At,xt,Bt,Nt,jt,Ut,Lt){return rotl$2(kt+(At&Bt|xt&~Bt)+jt+Ut|0,Lt)+Nt|0}function fn5(kt,At,xt,Bt,Nt,jt,Ut,Lt){return rotl$2(kt+(At^(xt|~Bt))+jt+Ut|0,Lt)+Nt|0}var ripemd160$1=RIPEMD160$5,sha_js={exports:{}},Buffer$B=safeBufferExports$1.Buffer;function Hash$8(kt,At){this._block=Buffer$B.alloc(kt),this._finalSize=At,this._blockSize=kt,this._len=0}Hash$8.prototype.update=function(kt,At){typeof kt=="string"&&(At=At||"utf8",kt=Buffer$B.from(kt,At));for(var xt=this._block,Bt=this._blockSize,Nt=kt.length,jt=this._len,Ut=0;Ut<Nt;){for(var Lt=jt%Bt,Ht=Math.min(Nt-Ut,Bt-Lt),Vt=0;Vt<Ht;Vt++)xt[Lt+Vt]=kt[Ut+Vt];jt+=Ht,Ut+=Ht,jt%Bt===0&&this._update(xt)}return this._len+=Nt,this};Hash$8.prototype.digest=function(kt){var At=this._len%this._blockSize;this._block[At]=128,this._block.fill(0,At+1),At>=this._finalSize&&(this._update(this._block),this._block.fill(0));var xt=this._len*8;if(xt<=4294967295)this._block.writeUInt32BE(xt,this._blockSize-4);else{var Bt=(xt&4294967295)>>>0,Nt=(xt-Bt)/4294967296;this._block.writeUInt32BE(Nt,this._blockSize-8),this._block.writeUInt32BE(Bt,this._blockSize-4)}this._update(this._block);var jt=this._hash();return kt?jt.toString(kt):jt};Hash$8.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var hash$6=Hash$8,inherits$n=inherits_browserExports,Hash$7=hash$6,Buffer$A=safeBufferExports$1.Buffer,K$5=[1518500249,1859775393,-1894007588,-899497514],W$6=new Array(80);function Sha(){this.init(),this._w=W$6,Hash$7.call(this,64,56)}inherits$n(Sha,Hash$7);Sha.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function rotl5$1(kt){return kt<<5|kt>>>27}function rotl30$1(kt){return kt<<30|kt>>>2}function ft$2(kt,At,xt,Bt){return kt===0?At&xt|~At&Bt:kt===2?At&xt|At&Bt|xt&Bt:At^xt^Bt}Sha.prototype._update=function(kt){for(var At=this._w,xt=this._a|0,Bt=this._b|0,Nt=this._c|0,jt=this._d|0,Ut=this._e|0,Lt=0;Lt<16;++Lt)At[Lt]=kt.readInt32BE(Lt*4);for(;Lt<80;++Lt)At[Lt]=At[Lt-3]^At[Lt-8]^At[Lt-14]^At[Lt-16];for(var Ht=0;Ht<80;++Ht){var Vt=~~(Ht/20),zt=rotl5$1(xt)+ft$2(Vt,Bt,Nt,jt)+Ut+At[Ht]+K$5[Vt]|0;Ut=jt,jt=Nt,Nt=rotl30$1(Bt),Bt=xt,xt=zt}this._a=xt+this._a|0,this._b=Bt+this._b|0,this._c=Nt+this._c|0,this._d=jt+this._d|0,this._e=Ut+this._e|0};Sha.prototype._hash=function(){var kt=Buffer$A.allocUnsafe(20);return kt.writeInt32BE(this._a|0,0),kt.writeInt32BE(this._b|0,4),kt.writeInt32BE(this._c|0,8),kt.writeInt32BE(this._d|0,12),kt.writeInt32BE(this._e|0,16),kt};var sha$4=Sha,inherits$m=inherits_browserExports,Hash$6=hash$6,Buffer$z=safeBufferExports$1.Buffer,K$4=[1518500249,1859775393,-1894007588,-899497514],W$5=new Array(80);function Sha1(){this.init(),this._w=W$5,Hash$6.call(this,64,56)}inherits$m(Sha1,Hash$6);Sha1.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function rotl1(kt){return kt<<1|kt>>>31}function rotl5(kt){return kt<<5|kt>>>27}function rotl30(kt){return kt<<30|kt>>>2}function ft$1(kt,At,xt,Bt){return kt===0?At&xt|~At&Bt:kt===2?At&xt|At&Bt|xt&Bt:At^xt^Bt}Sha1.prototype._update=function(kt){for(var At=this._w,xt=this._a|0,Bt=this._b|0,Nt=this._c|0,jt=this._d|0,Ut=this._e|0,Lt=0;Lt<16;++Lt)At[Lt]=kt.readInt32BE(Lt*4);for(;Lt<80;++Lt)At[Lt]=rotl1(At[Lt-3]^At[Lt-8]^At[Lt-14]^At[Lt-16]);for(var Ht=0;Ht<80;++Ht){var Vt=~~(Ht/20),zt=rotl5(xt)+ft$1(Vt,Bt,Nt,jt)+Ut+At[Ht]+K$4[Vt]|0;Ut=jt,jt=Nt,Nt=rotl30(Bt),Bt=xt,xt=zt}this._a=xt+this._a|0,this._b=Bt+this._b|0,this._c=Nt+this._c|0,this._d=jt+this._d|0,this._e=Ut+this._e|0};Sha1.prototype._hash=function(){var kt=Buffer$z.allocUnsafe(20);return kt.writeInt32BE(this._a|0,0),kt.writeInt32BE(this._b|0,4),kt.writeInt32BE(this._c|0,8),kt.writeInt32BE(this._d|0,12),kt.writeInt32BE(this._e|0,16),kt};var sha1=Sha1,inherits$l=inherits_browserExports,Hash$5=hash$6,Buffer$y=safeBufferExports$1.Buffer,K$3=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],W$4=new Array(64);function Sha256$4(){this.init(),this._w=W$4,Hash$5.call(this,64,56)}inherits$l(Sha256$4,Hash$5);Sha256$4.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function ch(kt,At,xt){return xt^kt&(At^xt)}function maj$1(kt,At,xt){return kt&At|xt&(kt|At)}function sigma0$1(kt){return(kt>>>2|kt<<30)^(kt>>>13|kt<<19)^(kt>>>22|kt<<10)}function sigma1$1(kt){return(kt>>>6|kt<<26)^(kt>>>11|kt<<21)^(kt>>>25|kt<<7)}function gamma0(kt){return(kt>>>7|kt<<25)^(kt>>>18|kt<<14)^kt>>>3}function gamma1(kt){return(kt>>>17|kt<<15)^(kt>>>19|kt<<13)^kt>>>10}Sha256$4.prototype._update=function(kt){for(var At=this._w,xt=this._a|0,Bt=this._b|0,Nt=this._c|0,jt=this._d|0,Ut=this._e|0,Lt=this._f|0,Ht=this._g|0,Vt=this._h|0,zt=0;zt<16;++zt)At[zt]=kt.readInt32BE(zt*4);for(;zt<64;++zt)At[zt]=gamma1(At[zt-2])+At[zt-7]+gamma0(At[zt-15])+At[zt-16]|0;for(var Wt=0;Wt<64;++Wt){var Jt=Vt+sigma1$1(Ut)+ch(Ut,Lt,Ht)+K$3[Wt]+At[Wt]|0,Qt=sigma0$1(xt)+maj$1(xt,Bt,Nt)|0;Vt=Ht,Ht=Lt,Lt=Ut,Ut=jt+Jt|0,jt=Nt,Nt=Bt,Bt=xt,xt=Jt+Qt|0}this._a=xt+this._a|0,this._b=Bt+this._b|0,this._c=Nt+this._c|0,this._d=jt+this._d|0,this._e=Ut+this._e|0,this._f=Lt+this._f|0,this._g=Ht+this._g|0,this._h=Vt+this._h|0};Sha256$4.prototype._hash=function(){var kt=Buffer$y.allocUnsafe(32);return kt.writeInt32BE(this._a,0),kt.writeInt32BE(this._b,4),kt.writeInt32BE(this._c,8),kt.writeInt32BE(this._d,12),kt.writeInt32BE(this._e,16),kt.writeInt32BE(this._f,20),kt.writeInt32BE(this._g,24),kt.writeInt32BE(this._h,28),kt};var sha256$3=Sha256$4,inherits$k=inherits_browserExports,Sha256$3=sha256$3,Hash$4=hash$6,Buffer$x=safeBufferExports$1.Buffer,W$3=new Array(64);function Sha224(){this.init(),this._w=W$3,Hash$4.call(this,64,56)}inherits$k(Sha224,Sha256$3);Sha224.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this};Sha224.prototype._hash=function(){var kt=Buffer$x.allocUnsafe(28);return kt.writeInt32BE(this._a,0),kt.writeInt32BE(this._b,4),kt.writeInt32BE(this._c,8),kt.writeInt32BE(this._d,12),kt.writeInt32BE(this._e,16),kt.writeInt32BE(this._f,20),kt.writeInt32BE(this._g,24),kt};var sha224$1=Sha224,inherits$j=inherits_browserExports,Hash$3=hash$6,Buffer$w=safeBufferExports$1.Buffer,K$2=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],W$2=new Array(160);function Sha512(){this.init(),this._w=W$2,Hash$3.call(this,128,112)}inherits$j(Sha512,Hash$3);Sha512.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function Ch(kt,At,xt){return xt^kt&(At^xt)}function maj(kt,At,xt){return kt&At|xt&(kt|At)}function sigma0(kt,At){return(kt>>>28|At<<4)^(At>>>2|kt<<30)^(At>>>7|kt<<25)}function sigma1(kt,At){return(kt>>>14|At<<18)^(kt>>>18|At<<14)^(At>>>9|kt<<23)}function Gamma0(kt,At){return(kt>>>1|At<<31)^(kt>>>8|At<<24)^kt>>>7}function Gamma0l(kt,At){return(kt>>>1|At<<31)^(kt>>>8|At<<24)^(kt>>>7|At<<25)}function Gamma1(kt,At){return(kt>>>19|At<<13)^(At>>>29|kt<<3)^kt>>>6}function Gamma1l(kt,At){return(kt>>>19|At<<13)^(At>>>29|kt<<3)^(kt>>>6|At<<26)}function getCarry(kt,At){return kt>>>0<At>>>0?1:0}Sha512.prototype._update=function(kt){for(var At=this._w,xt=this._ah|0,Bt=this._bh|0,Nt=this._ch|0,jt=this._dh|0,Ut=this._eh|0,Lt=this._fh|0,Ht=this._gh|0,Vt=this._hh|0,zt=this._al|0,Wt=this._bl|0,Jt=this._cl|0,Qt=this._dl|0,Xt=this._el|0,tr=this._fl|0,rr=this._gl|0,nr=this._hl|0,ar=0;ar<32;ar+=2)At[ar]=kt.readInt32BE(ar*4),At[ar+1]=kt.readInt32BE(ar*4+4);for(;ar<160;ar+=2){var ir=At[ar-30],lr=At[ar-15*2+1],yr=Gamma0(ir,lr),Sr=Gamma0l(lr,ir);ir=At[ar-2*2],lr=At[ar-2*2+1];var Ar=Gamma1(ir,lr),Dr=Gamma1l(lr,ir),Br=At[ar-7*2],Lr=At[ar-7*2+1],Or=At[ar-16*2],vr=At[ar-16*2+1],pr=Sr+Lr|0,dr=yr+Br+getCarry(pr,Sr)|0;pr=pr+Dr|0,dr=dr+Ar+getCarry(pr,Dr)|0,pr=pr+vr|0,dr=dr+Or+getCarry(pr,vr)|0,At[ar]=dr,At[ar+1]=pr}for(var ur=0;ur<160;ur+=2){dr=At[ur],pr=At[ur+1];var $r=maj(xt,Bt,Nt),wr=maj(zt,Wt,Jt),Er=sigma0(xt,zt),gr=sigma0(zt,xt),fr=sigma1(Ut,Xt),br=sigma1(Xt,Ut),_r=K$2[ur],Tr=K$2[ur+1],Pr=Ch(Ut,Lt,Ht),Nr=Ch(Xt,tr,rr),Cr=nr+br|0,xr=Vt+fr+getCarry(Cr,nr)|0;Cr=Cr+Nr|0,xr=xr+Pr+getCarry(Cr,Nr)|0,Cr=Cr+Tr|0,xr=xr+_r+getCarry(Cr,Tr)|0,Cr=Cr+pr|0,xr=xr+dr+getCarry(Cr,pr)|0;var Rr=gr+wr|0,qr=Er+$r+getCarry(Rr,gr)|0;Vt=Ht,nr=rr,Ht=Lt,rr=tr,Lt=Ut,tr=Xt,Xt=Qt+Cr|0,Ut=jt+xr+getCarry(Xt,Qt)|0,jt=Nt,Qt=Jt,Nt=Bt,Jt=Wt,Bt=xt,Wt=zt,zt=Cr+Rr|0,xt=xr+qr+getCarry(zt,Cr)|0}this._al=this._al+zt|0,this._bl=this._bl+Wt|0,this._cl=this._cl+Jt|0,this._dl=this._dl+Qt|0,this._el=this._el+Xt|0,this._fl=this._fl+tr|0,this._gl=this._gl+rr|0,this._hl=this._hl+nr|0,this._ah=this._ah+xt+getCarry(this._al,zt)|0,this._bh=this._bh+Bt+getCarry(this._bl,Wt)|0,this._ch=this._ch+Nt+getCarry(this._cl,Jt)|0,this._dh=this._dh+jt+getCarry(this._dl,Qt)|0,this._eh=this._eh+Ut+getCarry(this._el,Xt)|0,this._fh=this._fh+Lt+getCarry(this._fl,tr)|0,this._gh=this._gh+Ht+getCarry(this._gl,rr)|0,this._hh=this._hh+Vt+getCarry(this._hl,nr)|0};Sha512.prototype._hash=function(){var kt=Buffer$w.allocUnsafe(64);function At(xt,Bt,Nt){kt.writeInt32BE(xt,Nt),kt.writeInt32BE(Bt,Nt+4)}return At(this._ah,this._al,0),At(this._bh,this._bl,8),At(this._ch,this._cl,16),At(this._dh,this._dl,24),At(this._eh,this._el,32),At(this._fh,this._fl,40),At(this._gh,this._gl,48),At(this._hh,this._hl,56),kt};var sha512$3=Sha512,inherits$i=inherits_browserExports,SHA512$4=sha512$3,Hash$2=hash$6,Buffer$v=safeBufferExports$1.Buffer,W$1=new Array(160);function Sha384(){this.init(),this._w=W$1,Hash$2.call(this,128,112)}inherits$i(Sha384,SHA512$4);Sha384.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this};Sha384.prototype._hash=function(){var kt=Buffer$v.allocUnsafe(48);function At(xt,Bt,Nt){kt.writeInt32BE(xt,Nt),kt.writeInt32BE(Bt,Nt+4)}return At(this._ah,this._al,0),At(this._bh,this._bl,8),At(this._ch,this._cl,16),At(this._dh,this._dl,24),At(this._eh,this._el,32),At(this._fh,this._fl,40),kt};var sha384$1=Sha384,exports=sha_js.exports=function(At){At=At.toLowerCase();var xt=exports[At];if(!xt)throw new Error(At+" is not supported (we accept pull requests)");return new xt};exports.sha=sha$4;exports.sha1=sha1;exports.sha224=sha224$1;exports.sha256=sha256$3;exports.sha384=sha384$1;exports.sha512=sha512$3;var sha_jsExports=sha_js.exports,streamBrowserify=Stream$3,EE$2=eventsExports.EventEmitter,inherits$h=inherits_browserExports;inherits$h(Stream$3,EE$2);Stream$3.Readable=require_stream_readable$1();Stream$3.Writable=require_stream_writable$1();Stream$3.Duplex=require_stream_duplex$1();Stream$3.Transform=_stream_transform$1;Stream$3.PassThrough=_stream_passthrough$1;Stream$3.finished=endOfStream$2;Stream$3.pipeline=pipeline_1$2;Stream$3.Stream=Stream$3;function Stream$3(){EE$2.call(this)}Stream$3.prototype.pipe=function(kt,At){var xt=this;function Bt(zt){kt.writable&&kt.write(zt)===!1&&xt.pause&&xt.pause()}xt.on("data",Bt);function Nt(){xt.readable&&xt.resume&&xt.resume()}kt.on("drain",Nt),!kt._isStdio&&(!At||At.end!==!1)&&(xt.on("end",Ut),xt.on("close",Lt));var jt=!1;function Ut(){jt||(jt=!0,kt.end())}function Lt(){jt||(jt=!0,typeof kt.destroy=="function"&&kt.destroy())}function Ht(zt){if(Vt(),EE$2.listenerCount(this,"error")===0)throw zt}xt.on("error",Ht),kt.on("error",Ht);function Vt(){xt.removeListener("data",Bt),kt.removeListener("drain",Nt),xt.removeListener("end",Ut),xt.removeListener("close",Lt),xt.removeListener("error",Ht),kt.removeListener("error",Ht),xt.removeListener("end",Vt),xt.removeListener("close",Vt),kt.removeListener("close",Vt)}return xt.on("end",Vt),xt.on("close",Vt),kt.on("close",Vt),kt.emit("pipe",xt),kt};var Buffer$u=safeBufferExports$1.Buffer,Transform$a=streamBrowserify.Transform,StringDecoder=requireString_decoder().StringDecoder,inherits$g=inherits_browserExports;function CipherBase$1(kt){Transform$a.call(this),this.hashMode=typeof kt=="string",this.hashMode?this[kt]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}inherits$g(CipherBase$1,Transform$a);CipherBase$1.prototype.update=function(kt,At,xt){typeof kt=="string"&&(kt=Buffer$u.from(kt,At));var Bt=this._update(kt);return this.hashMode?this:(xt&&(Bt=this._toString(Bt,xt)),Bt)};CipherBase$1.prototype.setAutoPadding=function(){};CipherBase$1.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")};CipherBase$1.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")};CipherBase$1.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")};CipherBase$1.prototype._transform=function(kt,At,xt){var Bt;try{this.hashMode?this._update(kt):this.push(this._update(kt))}catch(Nt){Bt=Nt}finally{xt(Bt)}};CipherBase$1.prototype._flush=function(kt){var At;try{this.push(this.__final())}catch(xt){At=xt}kt(At)};CipherBase$1.prototype._finalOrDigest=function(kt){var At=this.__final()||Buffer$u.alloc(0);return kt&&(At=this._toString(At,kt,!0)),At};CipherBase$1.prototype._toString=function(kt,At,xt){if(this._decoder||(this._decoder=new StringDecoder(At),this._encoding=At),this._encoding!==At)throw new Error("can't switch encodings");var Bt=this._decoder.write(kt);return xt&&(Bt+=this._decoder.end()),Bt};var cipherBase=CipherBase$1,inherits$f=inherits_browserExports,MD5$2=md5_js,RIPEMD160$4=ripemd160$1,sha$3=sha_jsExports,Base$5=cipherBase;function Hash$1(kt){Base$5.call(this,"digest"),this._hash=kt}inherits$f(Hash$1,Base$5);Hash$1.prototype._update=function(kt){this._hash.update(kt)};Hash$1.prototype._final=function(){return this._hash.digest()};var browser$c=function(At){return At=At.toLowerCase(),At==="md5"?new MD5$2:At==="rmd160"||At==="ripemd160"?new RIPEMD160$4:new Hash$1(sha$3(At))},inherits$e=inherits_browserExports,Buffer$t=safeBufferExports$1.Buffer,Base$4=cipherBase,ZEROS$2=Buffer$t.alloc(128),blocksize=64;function Hmac$3(kt,At){Base$4.call(this,"digest"),typeof At=="string"&&(At=Buffer$t.from(At)),this._alg=kt,this._key=At,At.length>blocksize?At=kt(At):At.length<blocksize&&(At=Buffer$t.concat([At,ZEROS$2],blocksize));for(var xt=this._ipad=Buffer$t.allocUnsafe(blocksize),Bt=this._opad=Buffer$t.allocUnsafe(blocksize),Nt=0;Nt<blocksize;Nt++)xt[Nt]=At[Nt]^54,Bt[Nt]=At[Nt]^92;this._hash=[xt]}inherits$e(Hmac$3,Base$4);Hmac$3.prototype._update=function(kt){this._hash.push(kt)};Hmac$3.prototype._final=function(){var kt=this._alg(Buffer$t.concat(this._hash));return this._alg(Buffer$t.concat([this._opad,kt]))};var legacy$2=Hmac$3,MD5$1=md5_js,md5$2=function(kt){return new MD5$1().update(kt).digest()},inherits$d=inherits_browserExports,Legacy=legacy$2,Base$3=cipherBase,Buffer$s=safeBufferExports$1.Buffer,md5$1=md5$2,RIPEMD160$3=ripemd160$1,sha$2=sha_jsExports,ZEROS$1=Buffer$s.alloc(128);function Hmac$2(kt,At){Base$3.call(this,"digest"),typeof At=="string"&&(At=Buffer$s.from(At));var xt=kt==="sha512"||kt==="sha384"?128:64;if(this._alg=kt,this._key=At,At.length>xt){var Bt=kt==="rmd160"?new RIPEMD160$3:sha$2(kt);At=Bt.update(At).digest()}else At.length<xt&&(At=Buffer$s.concat([At,ZEROS$1],xt));for(var Nt=this._ipad=Buffer$s.allocUnsafe(xt),jt=this._opad=Buffer$s.allocUnsafe(xt),Ut=0;Ut<xt;Ut++)Nt[Ut]=At[Ut]^54,jt[Ut]=At[Ut]^92;this._hash=kt==="rmd160"?new RIPEMD160$3:sha$2(kt),this._hash.update(Nt)}inherits$d(Hmac$2,Base$3);Hmac$2.prototype._update=function(kt){this._hash.update(kt)};Hmac$2.prototype._final=function(){var kt=this._hash.digest(),At=this._alg==="rmd160"?new RIPEMD160$3:sha$2(this._alg);return At.update(this._opad).update(kt).digest()};var browser$b=function(At,xt){return At=At.toLowerCase(),At==="rmd160"||At==="ripemd160"?new Hmac$2("rmd160",xt):At==="md5"?new Legacy(md5$1,xt):new Hmac$2(At,xt)};const sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},sha256$2={sign:"ecdsa",hash:"sha256",id:""},sha224={sign:"ecdsa",hash:"sha224",id:""},sha384={sign:"ecdsa",hash:"sha384",id:""},sha512$2={sign:"ecdsa",hash:"sha512",id:""},DSA={sign:"dsa",hash:"sha1",id:""},ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},require$$6$1={sha224WithRSAEncryption,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:sha256$2,sha224,sha384,sha512:sha512$2,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var algos=require$$6$1,browser$a={},MAX_ALLOC=Math.pow(2,30)-1,precondition=function(kt,At){if(typeof kt!="number")throw new TypeError("Iterations not a number");if(kt<0)throw new TypeError("Bad iterations");if(typeof At!="number")throw new TypeError("Key length not a number");if(At<0||At>MAX_ALLOC||At!==At)throw new TypeError("Bad key length")},defaultEncoding$2;if(globalThis.process&&globalThis.process.browser)defaultEncoding$2="utf-8";else if(globalThis.process&&globalThis.process.version){var pVersionMajor=parseInt(process$9.version.split(".")[0].slice(1),10);defaultEncoding$2=pVersionMajor>=6?"utf-8":"binary"}else defaultEncoding$2="utf-8";var defaultEncoding_1=defaultEncoding$2,Buffer$r=safeBufferExports$1.Buffer,toBuffer$2=function(kt,At,xt){if(Buffer$r.isBuffer(kt))return kt;if(typeof kt=="string")return Buffer$r.from(kt,At);if(ArrayBuffer.isView(kt))return Buffer$r.from(kt.buffer);throw new TypeError(xt+" must be a string, a Buffer, a typed array or a DataView")},md5=md5$2,RIPEMD160$2=ripemd160$1,sha$1=sha_jsExports,Buffer$q=safeBufferExports$1.Buffer,checkParameters$1=precondition,defaultEncoding$1=defaultEncoding_1,toBuffer$1=toBuffer$2,ZEROS=Buffer$q.alloc(128),sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function Hmac$1(kt,At,xt){var Bt=getDigest(kt),Nt=kt==="sha512"||kt==="sha384"?128:64;At.length>Nt?At=Bt(At):At.length<Nt&&(At=Buffer$q.concat([At,ZEROS],Nt));for(var jt=Buffer$q.allocUnsafe(Nt+sizes[kt]),Ut=Buffer$q.allocUnsafe(Nt+sizes[kt]),Lt=0;Lt<Nt;Lt++)jt[Lt]=At[Lt]^54,Ut[Lt]=At[Lt]^92;var Ht=Buffer$q.allocUnsafe(Nt+xt+4);jt.copy(Ht,0,0,Nt),this.ipad1=Ht,this.ipad2=jt,this.opad=Ut,this.alg=kt,this.blocksize=Nt,this.hash=Bt,this.size=sizes[kt]}Hmac$1.prototype.run=function(kt,At){kt.copy(At,this.blocksize);var xt=this.hash(At);return xt.copy(this.opad,this.blocksize),this.hash(this.opad)};function getDigest(kt){function At(Bt){return sha$1(kt).update(Bt).digest()}function xt(Bt){return new RIPEMD160$2().update(Bt).digest()}return kt==="rmd160"||kt==="ripemd160"?xt:kt==="md5"?md5:At}function pbkdf2(kt,At,xt,Bt,Nt){checkParameters$1(xt,Bt),kt=toBuffer$1(kt,defaultEncoding$1,"Password"),At=toBuffer$1(At,defaultEncoding$1,"Salt"),Nt=Nt||"sha1";var jt=new Hmac$1(Nt,kt,At.length),Ut=Buffer$q.allocUnsafe(Bt),Lt=Buffer$q.allocUnsafe(At.length+4);At.copy(Lt,0,0,At.length);for(var Ht=0,Vt=sizes[Nt],zt=Math.ceil(Bt/Vt),Wt=1;Wt<=zt;Wt++){Lt.writeUInt32BE(Wt,At.length);for(var Jt=jt.run(Lt,jt.ipad1),Qt=Jt,Xt=1;Xt<xt;Xt++){Qt=jt.run(Qt,jt.ipad2);for(var tr=0;tr<Vt;tr++)Jt[tr]^=Qt[tr]}Jt.copy(Ut,Ht),Ht+=Vt}return Ut}var syncBrowser=pbkdf2,Buffer$p=safeBufferExports$1.Buffer,checkParameters=precondition,defaultEncoding=defaultEncoding_1,sync=syncBrowser,toBuffer=toBuffer$2,ZERO_BUF,subtle=globalThis.crypto&&globalThis.crypto.subtle,toBrowser={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},checks=[];function checkNative(kt){if(globalThis.process&&!globalThis.process.browser||!subtle||!subtle.importKey||!subtle.deriveBits)return Promise.resolve(!1);if(checks[kt]!==void 0)return checks[kt];ZERO_BUF=ZERO_BUF||Buffer$p.alloc(8);var At=browserPbkdf2(ZERO_BUF,ZERO_BUF,10,128,kt).then(function(){return!0}).catch(function(){return!1});return checks[kt]=At,At}var nextTick$3;function getNextTick(){return nextTick$3||(globalThis.process&&globalThis.process.nextTick?nextTick$3=globalThis.process.nextTick:globalThis.queueMicrotask?nextTick$3=globalThis.queueMicrotask:globalThis.setImmediate?nextTick$3=globalThis.setImmediate:nextTick$3=globalThis.setTimeout,nextTick$3)}function browserPbkdf2(kt,At,xt,Bt,Nt){return subtle.importKey("raw",kt,{name:"PBKDF2"},!1,["deriveBits"]).then(function(jt){return subtle.deriveBits({name:"PBKDF2",salt:At,iterations:xt,hash:{name:Nt}},jt,Bt<<3)}).then(function(jt){return Buffer$p.from(jt)})}function resolvePromise(kt,At){kt.then(function(xt){getNextTick()(function(){At(null,xt)})},function(xt){getNextTick()(function(){At(xt)})})}var async=function(kt,At,xt,Bt,Nt,jt){typeof Nt=="function"&&(jt=Nt,Nt=void 0),Nt=Nt||"sha1";var Ut=toBrowser[Nt.toLowerCase()];if(!Ut||typeof globalThis.Promise!="function"){getNextTick()(function(){var Lt;try{Lt=sync(kt,At,xt,Bt,Nt)}catch(Ht){return jt(Ht)}jt(null,Lt)});return}if(checkParameters(xt,Bt),kt=toBuffer(kt,defaultEncoding,"Password"),At=toBuffer(At,defaultEncoding,"Salt"),typeof jt!="function")throw new Error("No callback provided to pbkdf2");resolvePromise(checkNative(Ut).then(function(Lt){return Lt?browserPbkdf2(kt,At,xt,Bt,Ut):sync(kt,At,xt,Bt,Nt)}),jt)};browser$a.pbkdf2=async;browser$a.pbkdf2Sync=syncBrowser;var browser$9={},des$2={},utils$v={};utils$v.readUInt32BE=function(At,xt){var Bt=At[0+xt]<<24|At[1+xt]<<16|At[2+xt]<<8|At[3+xt];return Bt>>>0};utils$v.writeUInt32BE=function(At,xt,Bt){At[0+Bt]=xt>>>24,At[1+Bt]=xt>>>16&255,At[2+Bt]=xt>>>8&255,At[3+Bt]=xt&255};utils$v.ip=function(At,xt,Bt,Nt){for(var jt=0,Ut=0,Lt=6;Lt>=0;Lt-=2){for(var Ht=0;Ht<=24;Ht+=8)jt<<=1,jt|=xt>>>Ht+Lt&1;for(var Ht=0;Ht<=24;Ht+=8)jt<<=1,jt|=At>>>Ht+Lt&1}for(var Lt=6;Lt>=0;Lt-=2){for(var Ht=1;Ht<=25;Ht+=8)Ut<<=1,Ut|=xt>>>Ht+Lt&1;for(var Ht=1;Ht<=25;Ht+=8)Ut<<=1,Ut|=At>>>Ht+Lt&1}Bt[Nt+0]=jt>>>0,Bt[Nt+1]=Ut>>>0};utils$v.rip=function(At,xt,Bt,Nt){for(var jt=0,Ut=0,Lt=0;Lt<4;Lt++)for(var Ht=24;Ht>=0;Ht-=8)jt<<=1,jt|=xt>>>Ht+Lt&1,jt<<=1,jt|=At>>>Ht+Lt&1;for(var Lt=4;Lt<8;Lt++)for(var Ht=24;Ht>=0;Ht-=8)Ut<<=1,Ut|=xt>>>Ht+Lt&1,Ut<<=1,Ut|=At>>>Ht+Lt&1;Bt[Nt+0]=jt>>>0,Bt[Nt+1]=Ut>>>0};utils$v.pc1=function(At,xt,Bt,Nt){for(var jt=0,Ut=0,Lt=7;Lt>=5;Lt--){for(var Ht=0;Ht<=24;Ht+=8)jt<<=1,jt|=xt>>Ht+Lt&1;for(var Ht=0;Ht<=24;Ht+=8)jt<<=1,jt|=At>>Ht+Lt&1}for(var Ht=0;Ht<=24;Ht+=8)jt<<=1,jt|=xt>>Ht+Lt&1;for(var Lt=1;Lt<=3;Lt++){for(var Ht=0;Ht<=24;Ht+=8)Ut<<=1,Ut|=xt>>Ht+Lt&1;for(var Ht=0;Ht<=24;Ht+=8)Ut<<=1,Ut|=At>>Ht+Lt&1}for(var Ht=0;Ht<=24;Ht+=8)Ut<<=1,Ut|=At>>Ht+Lt&1;Bt[Nt+0]=jt>>>0,Bt[Nt+1]=Ut>>>0};utils$v.r28shl=function(At,xt){return At<<xt&268435455|At>>>28-xt};var pc2table=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];utils$v.pc2=function(At,xt,Bt,Nt){for(var jt=0,Ut=0,Lt=pc2table.length>>>1,Ht=0;Ht<Lt;Ht++)jt<<=1,jt|=At>>>pc2table[Ht]&1;for(var Ht=Lt;Ht<pc2table.length;Ht++)Ut<<=1,Ut|=xt>>>pc2table[Ht]&1;Bt[Nt+0]=jt>>>0,Bt[Nt+1]=Ut>>>0};utils$v.expand=function(At,xt,Bt){var Nt=0,jt=0;Nt=(At&1)<<5|At>>>27;for(var Ut=23;Ut>=15;Ut-=4)Nt<<=6,Nt|=At>>>Ut&63;for(var Ut=11;Ut>=3;Ut-=4)jt|=At>>>Ut&63,jt<<=6;jt|=(At&31)<<1|At>>>31,xt[Bt+0]=Nt>>>0,xt[Bt+1]=jt>>>0};var sTable=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];utils$v.substitute=function(At,xt){for(var Bt=0,Nt=0;Nt<4;Nt++){var jt=At>>>18-Nt*6&63,Ut=sTable[Nt*64+jt];Bt<<=4,Bt|=Ut}for(var Nt=0;Nt<4;Nt++){var jt=xt>>>18-Nt*6&63,Ut=sTable[4*64+Nt*64+jt];Bt<<=4,Bt|=Ut}return Bt>>>0};var permuteTable=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];utils$v.permute=function(At){for(var xt=0,Bt=0;Bt<permuteTable.length;Bt++)xt<<=1,xt|=At>>>permuteTable[Bt]&1;return xt>>>0};utils$v.padSplit=function(At,xt,Bt){for(var Nt=At.toString(2);Nt.length<xt;)Nt="0"+Nt;for(var jt=[],Ut=0;Ut<xt;Ut+=Bt)jt.push(Nt.slice(Ut,Ut+Bt));return jt.join(" ")};var minimalisticAssert=assert$m;function assert$m(kt,At){if(!kt)throw new Error(At||"Assertion failed")}assert$m.equal=function(At,xt,Bt){if(At!=xt)throw new Error(Bt||"Assertion failed: "+At+" != "+xt)};var assert$l=minimalisticAssert;function Cipher$3(kt){this.options=kt,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=kt.padding!==!1}var cipher=Cipher$3;Cipher$3.prototype._init=function(){};Cipher$3.prototype.update=function(At){return At.length===0?[]:this.type==="decrypt"?this._updateDecrypt(At):this._updateEncrypt(At)};Cipher$3.prototype._buffer=function(At,xt){for(var Bt=Math.min(this.buffer.length-this.bufferOff,At.length-xt),Nt=0;Nt<Bt;Nt++)this.buffer[this.bufferOff+Nt]=At[xt+Nt];return this.bufferOff+=Bt,Bt};Cipher$3.prototype._flushBuffer=function(At,xt){return this._update(this.buffer,0,At,xt),this.bufferOff=0,this.blockSize};Cipher$3.prototype._updateEncrypt=function(At){var xt=0,Bt=0,Nt=(this.bufferOff+At.length)/this.blockSize|0,jt=new Array(Nt*this.blockSize);this.bufferOff!==0&&(xt+=this._buffer(At,xt),this.bufferOff===this.buffer.length&&(Bt+=this._flushBuffer(jt,Bt)));for(var Ut=At.length-(At.length-xt)%this.blockSize;xt<Ut;xt+=this.blockSize)this._update(At,xt,jt,Bt),Bt+=this.blockSize;for(;xt<At.length;xt++,this.bufferOff++)this.buffer[this.bufferOff]=At[xt];return jt};Cipher$3.prototype._updateDecrypt=function(At){for(var xt=0,Bt=0,Nt=Math.ceil((this.bufferOff+At.length)/this.blockSize)-1,jt=new Array(Nt*this.blockSize);Nt>0;Nt--)xt+=this._buffer(At,xt),Bt+=this._flushBuffer(jt,Bt);return xt+=this._buffer(At,xt),jt};Cipher$3.prototype.final=function(At){var xt;At&&(xt=this.update(At));var Bt;return this.type==="encrypt"?Bt=this._finalEncrypt():Bt=this._finalDecrypt(),xt?xt.concat(Bt):Bt};Cipher$3.prototype._pad=function(At,xt){if(xt===0)return!1;for(;xt<At.length;)At[xt++]=0;return!0};Cipher$3.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var At=new Array(this.blockSize);return this._update(this.buffer,0,At,0),At};Cipher$3.prototype._unpad=function(At){return At};Cipher$3.prototype._finalDecrypt=function(){assert$l.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var At=new Array(this.blockSize);return this._flushBuffer(At,0),this._unpad(At)};var assert$k=minimalisticAssert,inherits$c=inherits_browserExports,utils$u=utils$v,Cipher$2=cipher;function DESState(){this.tmp=new Array(2),this.keys=null}function DES$3(kt){Cipher$2.call(this,kt);var At=new DESState;this._desState=At,this.deriveKeys(At,kt.key)}inherits$c(DES$3,Cipher$2);var des$1=DES$3;DES$3.create=function(At){return new DES$3(At)};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES$3.prototype.deriveKeys=function(At,xt){At.keys=new Array(16*2),assert$k.equal(xt.length,this.blockSize,"Invalid key length");var Bt=utils$u.readUInt32BE(xt,0),Nt=utils$u.readUInt32BE(xt,4);utils$u.pc1(Bt,Nt,At.tmp,0),Bt=At.tmp[0],Nt=At.tmp[1];for(var jt=0;jt<At.keys.length;jt+=2){var Ut=shiftTable[jt>>>1];Bt=utils$u.r28shl(Bt,Ut),Nt=utils$u.r28shl(Nt,Ut),utils$u.pc2(Bt,Nt,At.keys,jt)}};DES$3.prototype._update=function(At,xt,Bt,Nt){var jt=this._desState,Ut=utils$u.readUInt32BE(At,xt),Lt=utils$u.readUInt32BE(At,xt+4);utils$u.ip(Ut,Lt,jt.tmp,0),Ut=jt.tmp[0],Lt=jt.tmp[1],this.type==="encrypt"?this._encrypt(jt,Ut,Lt,jt.tmp,0):this._decrypt(jt,Ut,Lt,jt.tmp,0),Ut=jt.tmp[0],Lt=jt.tmp[1],utils$u.writeUInt32BE(Bt,Ut,Nt),utils$u.writeUInt32BE(Bt,Lt,Nt+4)};DES$3.prototype._pad=function(At,xt){if(this.padding===!1)return!1;for(var Bt=At.length-xt,Nt=xt;Nt<At.length;Nt++)At[Nt]=Bt;return!0};DES$3.prototype._unpad=function(At){if(this.padding===!1)return At;for(var xt=At[At.length-1],Bt=At.length-xt;Bt<At.length;Bt++)assert$k.equal(At[Bt],xt);return At.slice(0,At.length-xt)};DES$3.prototype._encrypt=function(At,xt,Bt,Nt,jt){for(var Ut=xt,Lt=Bt,Ht=0;Ht<At.keys.length;Ht+=2){var Vt=At.keys[Ht],zt=At.keys[Ht+1];utils$u.expand(Lt,At.tmp,0),Vt^=At.tmp[0],zt^=At.tmp[1];var Wt=utils$u.substitute(Vt,zt),Jt=utils$u.permute(Wt),Qt=Lt;Lt=(Ut^Jt)>>>0,Ut=Qt}utils$u.rip(Lt,Ut,Nt,jt)};DES$3.prototype._decrypt=function(At,xt,Bt,Nt,jt){for(var Ut=Bt,Lt=xt,Ht=At.keys.length-2;Ht>=0;Ht-=2){var Vt=At.keys[Ht],zt=At.keys[Ht+1];utils$u.expand(Ut,At.tmp,0),Vt^=At.tmp[0],zt^=At.tmp[1];var Wt=utils$u.substitute(Vt,zt),Jt=utils$u.permute(Wt),Qt=Ut;Ut=(Lt^Jt)>>>0,Lt=Qt}utils$u.rip(Ut,Lt,Nt,jt)};var cbc$1={},assert$j=minimalisticAssert,inherits$b=inherits_browserExports,proto={};function CBCState(kt){assert$j.equal(kt.length,8,"Invalid IV length"),this.iv=new Array(8);for(var At=0;At<this.iv.length;At++)this.iv[At]=kt[At]}function instantiate(kt){function At(jt){kt.call(this,jt),this._cbcInit()}inherits$b(At,kt);for(var xt=Object.keys(proto),Bt=0;Bt<xt.length;Bt++){var Nt=xt[Bt];At.prototype[Nt]=proto[Nt]}return At.create=function(Ut){return new At(Ut)},At}cbc$1.instantiate=instantiate;proto._cbcInit=function(){var At=new CBCState(this.options.iv);this._cbcState=At};proto._update=function(At,xt,Bt,Nt){var jt=this._cbcState,Ut=this.constructor.super_.prototype,Lt=jt.iv;if(this.type==="encrypt"){for(var Ht=0;Ht<this.blockSize;Ht++)Lt[Ht]^=At[xt+Ht];Ut._update.call(this,Lt,0,Bt,Nt);for(var Ht=0;Ht<this.blockSize;Ht++)Lt[Ht]=Bt[Nt+Ht]}else{Ut._update.call(this,At,xt,Bt,Nt);for(var Ht=0;Ht<this.blockSize;Ht++)Bt[Nt+Ht]^=Lt[Ht];for(var Ht=0;Ht<this.blockSize;Ht++)Lt[Ht]=At[xt+Ht]}};var assert$i=minimalisticAssert,inherits$a=inherits_browserExports,Cipher$1=cipher,DES$2=des$1;function EDEState(kt,At){assert$i.equal(At.length,24,"Invalid key length");var xt=At.slice(0,8),Bt=At.slice(8,16),Nt=At.slice(16,24);kt==="encrypt"?this.ciphers=[DES$2.create({type:"encrypt",key:xt}),DES$2.create({type:"decrypt",key:Bt}),DES$2.create({type:"encrypt",key:Nt})]:this.ciphers=[DES$2.create({type:"decrypt",key:Nt}),DES$2.create({type:"encrypt",key:Bt}),DES$2.create({type:"decrypt",key:xt})]}function EDE(kt){Cipher$1.call(this,kt);var At=new EDEState(this.type,this.options.key);this._edeState=At}inherits$a(EDE,Cipher$1);var ede=EDE;EDE.create=function(At){return new EDE(At)};EDE.prototype._update=function(At,xt,Bt,Nt){var jt=this._edeState;jt.ciphers[0]._update(At,xt,Bt,Nt),jt.ciphers[1]._update(Bt,Nt,Bt,Nt),jt.ciphers[2]._update(Bt,Nt,Bt,Nt)};EDE.prototype._pad=DES$2.prototype._pad;EDE.prototype._unpad=DES$2.prototype._unpad;des$2.utils=utils$v;des$2.Cipher=cipher;des$2.DES=des$1;des$2.CBC=cbc$1;des$2.EDE=ede;var CipherBase=cipherBase,des=des$2,inherits$9=inherits_browserExports,Buffer$o=safeBufferExports$1.Buffer,modes$3={"des-ede3-cbc":des.CBC.instantiate(des.EDE),"des-ede3":des.EDE,"des-ede-cbc":des.CBC.instantiate(des.EDE),"des-ede":des.EDE,"des-cbc":des.CBC.instantiate(des.DES),"des-ecb":des.DES};modes$3.des=modes$3["des-cbc"];modes$3.des3=modes$3["des-ede3-cbc"];var browserifyDes=DES$1;inherits$9(DES$1,CipherBase);function DES$1(kt){CipherBase.call(this);var At=kt.mode.toLowerCase(),xt=modes$3[At],Bt;kt.decrypt?Bt="decrypt":Bt="encrypt";var Nt=kt.key;Buffer$o.isBuffer(Nt)||(Nt=Buffer$o.from(Nt)),(At==="des-ede"||At==="des-ede-cbc")&&(Nt=Buffer$o.concat([Nt,Nt.slice(0,8)]));var jt=kt.iv;Buffer$o.isBuffer(jt)||(jt=Buffer$o.from(jt)),this._des=xt.create({key:Nt,iv:jt,type:Bt})}DES$1.prototype._update=function(kt){return Buffer$o.from(this._des.update(kt))};DES$1.prototype._final=function(){return Buffer$o.from(this._des.final())};var browser$8={},encrypter={},ecb={};ecb.encrypt=function(kt,At){return kt._cipher.encryptBlock(At)};ecb.decrypt=function(kt,At){return kt._cipher.decryptBlock(At)};var cbc={},bufferXor=function(At,xt){for(var Bt=Math.min(At.length,xt.length),Nt=new buffer$2.Buffer(Bt),jt=0;jt<Bt;++jt)Nt[jt]=At[jt]^xt[jt];return Nt},xor$7=bufferXor;cbc.encrypt=function(kt,At){var xt=xor$7(At,kt._prev);return kt._prev=kt._cipher.encryptBlock(xt),kt._prev};cbc.decrypt=function(kt,At){var xt=kt._prev;kt._prev=At;var Bt=kt._cipher.decryptBlock(At);return xor$7(Bt,xt)};var cfb={},Buffer$n=safeBufferExports$1.Buffer,xor$6=bufferXor;function encryptStart(kt,At,xt){var Bt=At.length,Nt=xor$6(At,kt._cache);return kt._cache=kt._cache.slice(Bt),kt._prev=Buffer$n.concat([kt._prev,xt?At:Nt]),Nt}cfb.encrypt=function(kt,At,xt){for(var Bt=Buffer$n.allocUnsafe(0),Nt;At.length;)if(kt._cache.length===0&&(kt._cache=kt._cipher.encryptBlock(kt._prev),kt._prev=Buffer$n.allocUnsafe(0)),kt._cache.length<=At.length)Nt=kt._cache.length,Bt=Buffer$n.concat([Bt,encryptStart(kt,At.slice(0,Nt),xt)]),At=At.slice(Nt);else{Bt=Buffer$n.concat([Bt,encryptStart(kt,At,xt)]);break}return Bt};var cfb8={},Buffer$m=safeBufferExports$1.Buffer;function encryptByte$1(kt,At,xt){var Bt=kt._cipher.encryptBlock(kt._prev),Nt=Bt[0]^At;return kt._prev=Buffer$m.concat([kt._prev.slice(1),Buffer$m.from([xt?At:Nt])]),Nt}cfb8.encrypt=function(kt,At,xt){for(var Bt=At.length,Nt=Buffer$m.allocUnsafe(Bt),jt=-1;++jt<Bt;)Nt[jt]=encryptByte$1(kt,At[jt],xt);return Nt};var cfb1={},Buffer$l=safeBufferExports$1.Buffer;function encryptByte(kt,At,xt){for(var Bt,Nt=-1,jt=8,Ut=0,Lt,Ht;++Nt<jt;)Bt=kt._cipher.encryptBlock(kt._prev),Lt=At&1<<7-Nt?128:0,Ht=Bt[0]^Lt,Ut+=(Ht&128)>>Nt%8,kt._prev=shiftIn(kt._prev,xt?Lt:Ht);return Ut}function shiftIn(kt,At){var xt=kt.length,Bt=-1,Nt=Buffer$l.allocUnsafe(kt.length);for(kt=Buffer$l.concat([kt,Buffer$l.from([At])]);++Bt<xt;)Nt[Bt]=kt[Bt]<<1|kt[Bt+1]>>7;return Nt}cfb1.encrypt=function(kt,At,xt){for(var Bt=At.length,Nt=Buffer$l.allocUnsafe(Bt),jt=-1;++jt<Bt;)Nt[jt]=encryptByte(kt,At[jt],xt);return Nt};var ofb={},xor$5=bufferXor;function getBlock$1(kt){return kt._prev=kt._cipher.encryptBlock(kt._prev),kt._prev}ofb.encrypt=function(kt,At){for(;kt._cache.length<At.length;)kt._cache=buffer$2.Buffer.concat([kt._cache,getBlock$1(kt)]);var xt=kt._cache.slice(0,At.length);return kt._cache=kt._cache.slice(At.length),xor$5(At,xt)};var ctr={};function incr32$2(kt){for(var At=kt.length,xt;At--;)if(xt=kt.readUInt8(At),xt===255)kt.writeUInt8(0,At);else{xt++,kt.writeUInt8(xt,At);break}}var incr32_1=incr32$2,xor$4=bufferXor,Buffer$k=safeBufferExports$1.Buffer,incr32$1=incr32_1;function getBlock(kt){var At=kt._cipher.encryptBlockRaw(kt._prev);return incr32$1(kt._prev),At}var blockSize=16;ctr.encrypt=function(kt,At){var xt=Math.ceil(At.length/blockSize),Bt=kt._cache.length;kt._cache=Buffer$k.concat([kt._cache,Buffer$k.allocUnsafe(xt*blockSize)]);for(var Nt=0;Nt<xt;Nt++){var jt=getBlock(kt),Ut=Bt+Nt*blockSize;kt._cache.writeUInt32BE(jt[0],Ut+0),kt._cache.writeUInt32BE(jt[1],Ut+4),kt._cache.writeUInt32BE(jt[2],Ut+8),kt._cache.writeUInt32BE(jt[3],Ut+12)}var Lt=kt._cache.slice(0,At.length);return kt._cache=kt._cache.slice(At.length),xor$4(At,Lt)};const aes128={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},require$$2$1={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128,aes192,aes256,"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}};var modeModules={ECB:ecb,CBC:cbc,CFB:cfb,CFB8:cfb8,CFB1:cfb1,OFB:ofb,CTR:ctr,GCM:ctr},modes$2=require$$2$1;for(var key$2 in modes$2)modes$2[key$2].module=modeModules[modes$2[key$2].mode];var modes_1=modes$2,aes$5={},Buffer$j=safeBufferExports$1.Buffer;function asUInt32Array(kt){Buffer$j.isBuffer(kt)||(kt=Buffer$j.from(kt));for(var At=kt.length/4|0,xt=new Array(At),Bt=0;Bt<At;Bt++)xt[Bt]=kt.readUInt32BE(Bt*4);return xt}function scrubVec(kt){for(var At=0;At<kt.length;kt++)kt[At]=0}function cryptBlock(kt,At,xt,Bt,Nt){for(var jt=xt[0],Ut=xt[1],Lt=xt[2],Ht=xt[3],Vt=kt[0]^At[0],zt=kt[1]^At[1],Wt=kt[2]^At[2],Jt=kt[3]^At[3],Qt,Xt,tr,rr,nr=4,ar=1;ar<Nt;ar++)Qt=jt[Vt>>>24]^Ut[zt>>>16&255]^Lt[Wt>>>8&255]^Ht[Jt&255]^At[nr++],Xt=jt[zt>>>24]^Ut[Wt>>>16&255]^Lt[Jt>>>8&255]^Ht[Vt&255]^At[nr++],tr=jt[Wt>>>24]^Ut[Jt>>>16&255]^Lt[Vt>>>8&255]^Ht[zt&255]^At[nr++],rr=jt[Jt>>>24]^Ut[Vt>>>16&255]^Lt[zt>>>8&255]^Ht[Wt&255]^At[nr++],Vt=Qt,zt=Xt,Wt=tr,Jt=rr;return Qt=(Bt[Vt>>>24]<<24|Bt[zt>>>16&255]<<16|Bt[Wt>>>8&255]<<8|Bt[Jt&255])^At[nr++],Xt=(Bt[zt>>>24]<<24|Bt[Wt>>>16&255]<<16|Bt[Jt>>>8&255]<<8|Bt[Vt&255])^At[nr++],tr=(Bt[Wt>>>24]<<24|Bt[Jt>>>16&255]<<16|Bt[Vt>>>8&255]<<8|Bt[zt&255])^At[nr++],rr=(Bt[Jt>>>24]<<24|Bt[Vt>>>16&255]<<16|Bt[zt>>>8&255]<<8|Bt[Wt&255])^At[nr++],Qt=Qt>>>0,Xt=Xt>>>0,tr=tr>>>0,rr=rr>>>0,[Qt,Xt,tr,rr]}var RCON=[0,1,2,4,8,16,32,64,128,27,54],G$1=function(){for(var kt=new Array(256),At=0;At<256;At++)At<128?kt[At]=At<<1:kt[At]=At<<1^283;for(var xt=[],Bt=[],Nt=[[],[],[],[]],jt=[[],[],[],[]],Ut=0,Lt=0,Ht=0;Ht<256;++Ht){var Vt=Lt^Lt<<1^Lt<<2^Lt<<3^Lt<<4;Vt=Vt>>>8^Vt&255^99,xt[Ut]=Vt,Bt[Vt]=Ut;var zt=kt[Ut],Wt=kt[zt],Jt=kt[Wt],Qt=kt[Vt]*257^Vt*16843008;Nt[0][Ut]=Qt<<24|Qt>>>8,Nt[1][Ut]=Qt<<16|Qt>>>16,Nt[2][Ut]=Qt<<8|Qt>>>24,Nt[3][Ut]=Qt,Qt=Jt*16843009^Wt*65537^zt*257^Ut*16843008,jt[0][Vt]=Qt<<24|Qt>>>8,jt[1][Vt]=Qt<<16|Qt>>>16,jt[2][Vt]=Qt<<8|Qt>>>24,jt[3][Vt]=Qt,Ut===0?Ut=Lt=1:(Ut=zt^kt[kt[kt[Jt^zt]]],Lt^=kt[kt[Lt]])}return{SBOX:xt,INV_SBOX:Bt,SUB_MIX:Nt,INV_SUB_MIX:jt}}();function AES(kt){this._key=asUInt32Array(kt),this._reset()}AES.blockSize=4*4;AES.keySize=256/8;AES.prototype.blockSize=AES.blockSize;AES.prototype.keySize=AES.keySize;AES.prototype._reset=function(){for(var kt=this._key,At=kt.length,xt=At+6,Bt=(xt+1)*4,Nt=[],jt=0;jt<At;jt++)Nt[jt]=kt[jt];for(jt=At;jt<Bt;jt++){var Ut=Nt[jt-1];jt%At===0?(Ut=Ut<<8|Ut>>>24,Ut=G$1.SBOX[Ut>>>24]<<24|G$1.SBOX[Ut>>>16&255]<<16|G$1.SBOX[Ut>>>8&255]<<8|G$1.SBOX[Ut&255],Ut^=RCON[jt/At|0]<<24):At>6&&jt%At===4&&(Ut=G$1.SBOX[Ut>>>24]<<24|G$1.SBOX[Ut>>>16&255]<<16|G$1.SBOX[Ut>>>8&255]<<8|G$1.SBOX[Ut&255]),Nt[jt]=Nt[jt-At]^Ut}for(var Lt=[],Ht=0;Ht<Bt;Ht++){var Vt=Bt-Ht,zt=Nt[Vt-(Ht%4?0:4)];Ht<4||Vt<=4?Lt[Ht]=zt:Lt[Ht]=G$1.INV_SUB_MIX[0][G$1.SBOX[zt>>>24]]^G$1.INV_SUB_MIX[1][G$1.SBOX[zt>>>16&255]]^G$1.INV_SUB_MIX[2][G$1.SBOX[zt>>>8&255]]^G$1.INV_SUB_MIX[3][G$1.SBOX[zt&255]]}this._nRounds=xt,this._keySchedule=Nt,this._invKeySchedule=Lt};AES.prototype.encryptBlockRaw=function(kt){return kt=asUInt32Array(kt),cryptBlock(kt,this._keySchedule,G$1.SUB_MIX,G$1.SBOX,this._nRounds)};AES.prototype.encryptBlock=function(kt){var At=this.encryptBlockRaw(kt),xt=Buffer$j.allocUnsafe(16);return xt.writeUInt32BE(At[0],0),xt.writeUInt32BE(At[1],4),xt.writeUInt32BE(At[2],8),xt.writeUInt32BE(At[3],12),xt};AES.prototype.decryptBlock=function(kt){kt=asUInt32Array(kt);var At=kt[1];kt[1]=kt[3],kt[3]=At;var xt=cryptBlock(kt,this._invKeySchedule,G$1.INV_SUB_MIX,G$1.INV_SBOX,this._nRounds),Bt=Buffer$j.allocUnsafe(16);return Bt.writeUInt32BE(xt[0],0),Bt.writeUInt32BE(xt[3],4),Bt.writeUInt32BE(xt[2],8),Bt.writeUInt32BE(xt[1],12),Bt};AES.prototype.scrub=function(){scrubVec(this._keySchedule),scrubVec(this._invKeySchedule),scrubVec(this._key)};aes$5.AES=AES;var Buffer$i=safeBufferExports$1.Buffer,ZEROES=Buffer$i.alloc(16,0);function toArray$3(kt){return[kt.readUInt32BE(0),kt.readUInt32BE(4),kt.readUInt32BE(8),kt.readUInt32BE(12)]}function fromArray(kt){var At=Buffer$i.allocUnsafe(16);return At.writeUInt32BE(kt[0]>>>0,0),At.writeUInt32BE(kt[1]>>>0,4),At.writeUInt32BE(kt[2]>>>0,8),At.writeUInt32BE(kt[3]>>>0,12),At}function GHASH$1(kt){this.h=kt,this.state=Buffer$i.alloc(16,0),this.cache=Buffer$i.allocUnsafe(0)}GHASH$1.prototype.ghash=function(kt){for(var At=-1;++At<kt.length;)this.state[At]^=kt[At];this._multiply()};GHASH$1.prototype._multiply=function(){for(var kt=toArray$3(this.h),At=[0,0,0,0],xt,Bt,Nt,jt=-1;++jt<128;){for(Bt=(this.state[~~(jt/8)]&1<<7-jt%8)!==0,Bt&&(At[0]^=kt[0],At[1]^=kt[1],At[2]^=kt[2],At[3]^=kt[3]),Nt=(kt[3]&1)!==0,xt=3;xt>0;xt--)kt[xt]=kt[xt]>>>1|(kt[xt-1]&1)<<31;kt[0]=kt[0]>>>1,Nt&&(kt[0]=kt[0]^225<<24)}this.state=fromArray(At)};GHASH$1.prototype.update=function(kt){this.cache=Buffer$i.concat([this.cache,kt]);for(var At;this.cache.length>=16;)At=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(At)};GHASH$1.prototype.final=function(kt,At){return this.cache.length&&this.ghash(Buffer$i.concat([this.cache,ZEROES],16)),this.ghash(fromArray([0,kt,0,At])),this.state};var ghash=GHASH$1,aes$4=aes$5,Buffer$h=safeBufferExports$1.Buffer,Transform$9=cipherBase,inherits$8=inherits_browserExports,GHASH=ghash,xor$3=bufferXor,incr32=incr32_1;function xorTest(kt,At){var xt=0;kt.length!==At.length&&xt++;for(var Bt=Math.min(kt.length,At.length),Nt=0;Nt<Bt;++Nt)xt+=kt[Nt]^At[Nt];return xt}function calcIv(kt,At,xt){if(At.length===12)return kt._finID=Buffer$h.concat([At,Buffer$h.from([0,0,0,1])]),Buffer$h.concat([At,Buffer$h.from([0,0,0,2])]);var Bt=new GHASH(xt),Nt=At.length,jt=Nt%16;Bt.update(At),jt&&(jt=16-jt,Bt.update(Buffer$h.alloc(jt,0))),Bt.update(Buffer$h.alloc(8,0));var Ut=Nt*8,Lt=Buffer$h.alloc(8);Lt.writeUIntBE(Ut,0,8),Bt.update(Lt),kt._finID=Bt.state;var Ht=Buffer$h.from(kt._finID);return incr32(Ht),Ht}function StreamCipher$3(kt,At,xt,Bt){Transform$9.call(this);var Nt=Buffer$h.alloc(4,0);this._cipher=new aes$4.AES(At);var jt=this._cipher.encryptBlock(Nt);this._ghash=new GHASH(jt),xt=calcIv(this,xt,jt),this._prev=Buffer$h.from(xt),this._cache=Buffer$h.allocUnsafe(0),this._secCache=Buffer$h.allocUnsafe(0),this._decrypt=Bt,this._alen=0,this._len=0,this._mode=kt,this._authTag=null,this._called=!1}inherits$8(StreamCipher$3,Transform$9);StreamCipher$3.prototype._update=function(kt){if(!this._called&&this._alen){var At=16-this._alen%16;At<16&&(At=Buffer$h.alloc(At,0),this._ghash.update(At))}this._called=!0;var xt=this._mode.encrypt(this,kt);return this._decrypt?this._ghash.update(kt):this._ghash.update(xt),this._len+=kt.length,xt};StreamCipher$3.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var kt=xor$3(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&xorTest(kt,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=kt,this._cipher.scrub()};StreamCipher$3.prototype.getAuthTag=function(){if(this._decrypt||!Buffer$h.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag};StreamCipher$3.prototype.setAuthTag=function(At){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=At};StreamCipher$3.prototype.setAAD=function(At){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(At),this._alen+=At.length};var authCipher=StreamCipher$3,aes$3=aes$5,Buffer$g=safeBufferExports$1.Buffer,Transform$8=cipherBase,inherits$7=inherits_browserExports;function StreamCipher$2(kt,At,xt,Bt){Transform$8.call(this),this._cipher=new aes$3.AES(At),this._prev=Buffer$g.from(xt),this._cache=Buffer$g.allocUnsafe(0),this._secCache=Buffer$g.allocUnsafe(0),this._decrypt=Bt,this._mode=kt}inherits$7(StreamCipher$2,Transform$8);StreamCipher$2.prototype._update=function(kt){return this._mode.encrypt(this,kt,this._decrypt)};StreamCipher$2.prototype._final=function(){this._cipher.scrub()};var streamCipher=StreamCipher$2,Buffer$f=safeBufferExports$1.Buffer,MD5=md5_js;function EVP_BytesToKey(kt,At,xt,Bt){if(Buffer$f.isBuffer(kt)||(kt=Buffer$f.from(kt,"binary")),At&&(Buffer$f.isBuffer(At)||(At=Buffer$f.from(At,"binary")),At.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var Nt=xt/8,jt=Buffer$f.alloc(Nt),Ut=Buffer$f.alloc(Bt||0),Lt=Buffer$f.alloc(0);Nt>0||Bt>0;){var Ht=new MD5;Ht.update(Lt),Ht.update(kt),At&&Ht.update(At),Lt=Ht.digest();var Vt=0;if(Nt>0){var zt=jt.length-Nt;Vt=Math.min(Nt,Lt.length),Lt.copy(jt,zt,0,Vt),Nt-=Vt}if(Vt<Lt.length&&Bt>0){var Wt=Ut.length-Bt,Jt=Math.min(Bt,Lt.length-Vt);Lt.copy(Ut,Wt,Vt,Vt+Jt),Bt-=Jt}}return Lt.fill(0),{key:jt,iv:Ut}}var evp_bytestokey=EVP_BytesToKey,MODES$1=modes_1,AuthCipher$1=authCipher,Buffer$e=safeBufferExports$1.Buffer,StreamCipher$1=streamCipher,Transform$7=cipherBase,aes$2=aes$5,ebtk$2=evp_bytestokey,inherits$6=inherits_browserExports;function Cipher(kt,At,xt){Transform$7.call(this),this._cache=new Splitter$1,this._cipher=new aes$2.AES(At),this._prev=Buffer$e.from(xt),this._mode=kt,this._autopadding=!0}inherits$6(Cipher,Transform$7);Cipher.prototype._update=function(kt){this._cache.add(kt);for(var At,xt,Bt=[];At=this._cache.get();)xt=this._mode.encrypt(this,At),Bt.push(xt);return Buffer$e.concat(Bt)};var PADDING=Buffer$e.alloc(16,16);Cipher.prototype._final=function(){var kt=this._cache.flush();if(this._autopadding)return kt=this._mode.encrypt(this,kt),this._cipher.scrub(),kt;if(!kt.equals(PADDING))throw this._cipher.scrub(),new Error("data not multiple of block length")};Cipher.prototype.setAutoPadding=function(kt){return this._autopadding=!!kt,this};function Splitter$1(){this.cache=Buffer$e.allocUnsafe(0)}Splitter$1.prototype.add=function(kt){this.cache=Buffer$e.concat([this.cache,kt])};Splitter$1.prototype.get=function(){if(this.cache.length>15){var kt=this.cache.slice(0,16);return this.cache=this.cache.slice(16),kt}return null};Splitter$1.prototype.flush=function(){for(var kt=16-this.cache.length,At=Buffer$e.allocUnsafe(kt),xt=-1;++xt<kt;)At.writeUInt8(kt,xt);return Buffer$e.concat([this.cache,At])};function createCipheriv$1(kt,At,xt){var Bt=MODES$1[kt.toLowerCase()];if(!Bt)throw new TypeError("invalid suite type");if(typeof At=="string"&&(At=Buffer$e.from(At)),At.length!==Bt.key/8)throw new TypeError("invalid key length "+At.length);if(typeof xt=="string"&&(xt=Buffer$e.from(xt)),Bt.mode!=="GCM"&&xt.length!==Bt.iv)throw new TypeError("invalid iv length "+xt.length);return Bt.type==="stream"?new StreamCipher$1(Bt.module,At,xt):Bt.type==="auth"?new AuthCipher$1(Bt.module,At,xt):new Cipher(Bt.module,At,xt)}function createCipher$2(kt,At){var xt=MODES$1[kt.toLowerCase()];if(!xt)throw new TypeError("invalid suite type");var Bt=ebtk$2(At,!1,xt.key,xt.iv);return createCipheriv$1(kt,Bt.key,Bt.iv)}encrypter.createCipheriv=createCipheriv$1;encrypter.createCipher=createCipher$2;var decrypter={},AuthCipher=authCipher,Buffer$d=safeBufferExports$1.Buffer,MODES=modes_1,StreamCipher=streamCipher,Transform$6=cipherBase,aes$1=aes$5,ebtk$1=evp_bytestokey,inherits$5=inherits_browserExports;function Decipher(kt,At,xt){Transform$6.call(this),this._cache=new Splitter,this._last=void 0,this._cipher=new aes$1.AES(At),this._prev=Buffer$d.from(xt),this._mode=kt,this._autopadding=!0}inherits$5(Decipher,Transform$6);Decipher.prototype._update=function(kt){this._cache.add(kt);for(var At,xt,Bt=[];At=this._cache.get(this._autopadding);)xt=this._mode.decrypt(this,At),Bt.push(xt);return Buffer$d.concat(Bt)};Decipher.prototype._final=function(){var kt=this._cache.flush();if(this._autopadding)return unpad(this._mode.decrypt(this,kt));if(kt)throw new Error("data not multiple of block length")};Decipher.prototype.setAutoPadding=function(kt){return this._autopadding=!!kt,this};function Splitter(){this.cache=Buffer$d.allocUnsafe(0)}Splitter.prototype.add=function(kt){this.cache=Buffer$d.concat([this.cache,kt])};Splitter.prototype.get=function(kt){var At;if(kt){if(this.cache.length>16)return At=this.cache.slice(0,16),this.cache=this.cache.slice(16),At}else if(this.cache.length>=16)return At=this.cache.slice(0,16),this.cache=this.cache.slice(16),At;return null};Splitter.prototype.flush=function(){if(this.cache.length)return this.cache};function unpad(kt){var At=kt[15];if(At<1||At>16)throw new Error("unable to decrypt data");for(var xt=-1;++xt<At;)if(kt[xt+(16-At)]!==At)throw new Error("unable to decrypt data");if(At!==16)return kt.slice(0,16-At)}function createDecipheriv$1(kt,At,xt){var Bt=MODES[kt.toLowerCase()];if(!Bt)throw new TypeError("invalid suite type");if(typeof xt=="string"&&(xt=Buffer$d.from(xt)),Bt.mode!=="GCM"&&xt.length!==Bt.iv)throw new TypeError("invalid iv length "+xt.length);if(typeof At=="string"&&(At=Buffer$d.from(At)),At.length!==Bt.key/8)throw new TypeError("invalid key length "+At.length);return Bt.type==="stream"?new StreamCipher(Bt.module,At,xt,!0):Bt.type==="auth"?new AuthCipher(Bt.module,At,xt,!0):new Decipher(Bt.module,At,xt)}function createDecipher$1(kt,At){var xt=MODES[kt.toLowerCase()];if(!xt)throw new TypeError("invalid suite type");var Bt=ebtk$1(At,!1,xt.key,xt.iv);return createDecipheriv$1(kt,Bt.key,Bt.iv)}decrypter.createDecipher=createDecipher$1;decrypter.createDecipheriv=createDecipheriv$1;var ciphers$2=encrypter,deciphers=decrypter,modes$1=require$$2$1;function getCiphers$1(){return Object.keys(modes$1)}browser$8.createCipher=browser$8.Cipher=ciphers$2.createCipher;browser$8.createCipheriv=browser$8.Cipheriv=ciphers$2.createCipheriv;browser$8.createDecipher=browser$8.Decipher=deciphers.createDecipher;browser$8.createDecipheriv=browser$8.Decipheriv=deciphers.createDecipheriv;browser$8.listCiphers=browser$8.getCiphers=getCiphers$1;var modes={};(function(kt){kt["des-ecb"]={key:8,iv:0},kt["des-cbc"]=kt.des={key:8,iv:8},kt["des-ede3-cbc"]=kt.des3={key:24,iv:8},kt["des-ede3"]={key:24,iv:0},kt["des-ede-cbc"]={key:16,iv:8},kt["des-ede"]={key:16,iv:0}})(modes);var DES=browserifyDes,aes=browser$8,aesModes=modes_1,desModes=modes,ebtk=evp_bytestokey;function createCipher$1(kt,At){kt=kt.toLowerCase();var xt,Bt;if(aesModes[kt])xt=aesModes[kt].key,Bt=aesModes[kt].iv;else if(desModes[kt])xt=desModes[kt].key*8,Bt=desModes[kt].iv;else throw new TypeError("invalid suite type");var Nt=ebtk(At,!1,xt,Bt);return createCipheriv(kt,Nt.key,Nt.iv)}function createDecipher(kt,At){kt=kt.toLowerCase();var xt,Bt;if(aesModes[kt])xt=aesModes[kt].key,Bt=aesModes[kt].iv;else if(desModes[kt])xt=desModes[kt].key*8,Bt=desModes[kt].iv;else throw new TypeError("invalid suite type");var Nt=ebtk(At,!1,xt,Bt);return createDecipheriv(kt,Nt.key,Nt.iv)}function createCipheriv(kt,At,xt){if(kt=kt.toLowerCase(),aesModes[kt])return aes.createCipheriv(kt,At,xt);if(desModes[kt])return new DES({key:At,iv:xt,mode:kt});throw new TypeError("invalid suite type")}function createDecipheriv(kt,At,xt){if(kt=kt.toLowerCase(),aesModes[kt])return aes.createDecipheriv(kt,At,xt);if(desModes[kt])return new DES({key:At,iv:xt,mode:kt,decrypt:!0});throw new TypeError("invalid suite type")}function getCiphers(){return Object.keys(desModes).concat(aes.getCiphers())}browser$9.createCipher=browser$9.Cipher=createCipher$1;browser$9.createCipheriv=browser$9.Cipheriv=createCipheriv;browser$9.createDecipher=browser$9.Decipher=createDecipher;browser$9.createDecipheriv=browser$9.Decipheriv=createDecipheriv;browser$9.listCiphers=browser$9.getCiphers=getCiphers;var browser$7={},bn$1={exports:{}};bn$1.exports;(function(kt){(function(At,xt){function Bt(Or,vr){if(!Or)throw new Error(vr||"Assertion failed")}function Nt(Or,vr){Or.super_=vr;var pr=function(){};pr.prototype=vr.prototype,Or.prototype=new pr,Or.prototype.constructor=Or}function jt(Or,vr,pr){if(jt.isBN(Or))return Or;this.negative=0,this.words=null,this.length=0,this.red=null,Or!==null&&((vr==="le"||vr==="be")&&(pr=vr,vr=10),this._init(Or||0,vr||10,pr||"be"))}typeof At=="object"?At.exports=jt:xt.BN=jt,jt.BN=jt,jt.wordSize=26;var Ut;try{typeof window<"u"&&typeof window.Buffer<"u"?Ut=window.Buffer:Ut=buffer$2.Buffer}catch{}jt.isBN=function(vr){return vr instanceof jt?!0:vr!==null&&typeof vr=="object"&&vr.constructor.wordSize===jt.wordSize&&Array.isArray(vr.words)},jt.max=function(vr,pr){return vr.cmp(pr)>0?vr:pr},jt.min=function(vr,pr){return vr.cmp(pr)<0?vr:pr},jt.prototype._init=function(vr,pr,dr){if(typeof vr=="number")return this._initNumber(vr,pr,dr);if(typeof vr=="object")return this._initArray(vr,pr,dr);pr==="hex"&&(pr=16),Bt(pr===(pr|0)&&pr>=2&&pr<=36),vr=vr.toString().replace(/\s+/g,"");var ur=0;vr[0]==="-"&&(ur++,this.negative=1),ur<vr.length&&(pr===16?this._parseHex(vr,ur,dr):(this._parseBase(vr,pr,ur),dr==="le"&&this._initArray(this.toArray(),pr,dr)))},jt.prototype._initNumber=function(vr,pr,dr){vr<0&&(this.negative=1,vr=-vr),vr<67108864?(this.words=[vr&67108863],this.length=1):vr<4503599627370496?(this.words=[vr&67108863,vr/67108864&67108863],this.length=2):(Bt(vr<9007199254740992),this.words=[vr&67108863,vr/67108864&67108863,1],this.length=3),dr==="le"&&this._initArray(this.toArray(),pr,dr)},jt.prototype._initArray=function(vr,pr,dr){if(Bt(typeof vr.length=="number"),vr.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(vr.length/3),this.words=new Array(this.length);for(var ur=0;ur<this.length;ur++)this.words[ur]=0;var $r,wr,Er=0;if(dr==="be")for(ur=vr.length-1,$r=0;ur>=0;ur-=3)wr=vr[ur]|vr[ur-1]<<8|vr[ur-2]<<16,this.words[$r]|=wr<<Er&67108863,this.words[$r+1]=wr>>>26-Er&67108863,Er+=24,Er>=26&&(Er-=26,$r++);else if(dr==="le")for(ur=0,$r=0;ur<vr.length;ur+=3)wr=vr[ur]|vr[ur+1]<<8|vr[ur+2]<<16,this.words[$r]|=wr<<Er&67108863,this.words[$r+1]=wr>>>26-Er&67108863,Er+=24,Er>=26&&(Er-=26,$r++);return this.strip()};function Lt(Or,vr){var pr=Or.charCodeAt(vr);return pr>=65&&pr<=70?pr-55:pr>=97&&pr<=102?pr-87:pr-48&15}function Ht(Or,vr,pr){var dr=Lt(Or,pr);return pr-1>=vr&&(dr|=Lt(Or,pr-1)<<4),dr}jt.prototype._parseHex=function(vr,pr,dr){this.length=Math.ceil((vr.length-pr)/6),this.words=new Array(this.length);for(var ur=0;ur<this.length;ur++)this.words[ur]=0;var $r=0,wr=0,Er;if(dr==="be")for(ur=vr.length-1;ur>=pr;ur-=2)Er=Ht(vr,pr,ur)<<$r,this.words[wr]|=Er&67108863,$r>=18?($r-=18,wr+=1,this.words[wr]|=Er>>>26):$r+=8;else{var gr=vr.length-pr;for(ur=gr%2===0?pr+1:pr;ur<vr.length;ur+=2)Er=Ht(vr,pr,ur)<<$r,this.words[wr]|=Er&67108863,$r>=18?($r-=18,wr+=1,this.words[wr]|=Er>>>26):$r+=8}this.strip()};function Vt(Or,vr,pr,dr){for(var ur=0,$r=Math.min(Or.length,pr),wr=vr;wr<$r;wr++){var Er=Or.charCodeAt(wr)-48;ur*=dr,Er>=49?ur+=Er-49+10:Er>=17?ur+=Er-17+10:ur+=Er}return ur}jt.prototype._parseBase=function(vr,pr,dr){this.words=[0],this.length=1;for(var ur=0,$r=1;$r<=67108863;$r*=pr)ur++;ur--,$r=$r/pr|0;for(var wr=vr.length-dr,Er=wr%ur,gr=Math.min(wr,wr-Er)+dr,fr=0,br=dr;br<gr;br+=ur)fr=Vt(vr,br,br+ur,pr),this.imuln($r),this.words[0]+fr<67108864?this.words[0]+=fr:this._iaddn(fr);if(Er!==0){var _r=1;for(fr=Vt(vr,br,vr.length,pr),br=0;br<Er;br++)_r*=pr;this.imuln(_r),this.words[0]+fr<67108864?this.words[0]+=fr:this._iaddn(fr)}this.strip()},jt.prototype.copy=function(vr){vr.words=new Array(this.length);for(var pr=0;pr<this.length;pr++)vr.words[pr]=this.words[pr];vr.length=this.length,vr.negative=this.negative,vr.red=this.red},jt.prototype.clone=function(){var vr=new jt(null);return this.copy(vr),vr},jt.prototype._expand=function(vr){for(;this.length<vr;)this.words[this.length++]=0;return this},jt.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},jt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},jt.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var zt=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],Wt=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],Jt=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];jt.prototype.toString=function(vr,pr){vr=vr||10,pr=pr|0||1;var dr;if(vr===16||vr==="hex"){dr="";for(var ur=0,$r=0,wr=0;wr<this.length;wr++){var Er=this.words[wr],gr=((Er<<ur|$r)&16777215).toString(16);$r=Er>>>24-ur&16777215,$r!==0||wr!==this.length-1?dr=zt[6-gr.length]+gr+dr:dr=gr+dr,ur+=2,ur>=26&&(ur-=26,wr--)}for($r!==0&&(dr=$r.toString(16)+dr);dr.length%pr!==0;)dr="0"+dr;return this.negative!==0&&(dr="-"+dr),dr}if(vr===(vr|0)&&vr>=2&&vr<=36){var fr=Wt[vr],br=Jt[vr];dr="";var _r=this.clone();for(_r.negative=0;!_r.isZero();){var Tr=_r.modn(br).toString(vr);_r=_r.idivn(br),_r.isZero()?dr=Tr+dr:dr=zt[fr-Tr.length]+Tr+dr}for(this.isZero()&&(dr="0"+dr);dr.length%pr!==0;)dr="0"+dr;return this.negative!==0&&(dr="-"+dr),dr}Bt(!1,"Base should be between 2 and 36")},jt.prototype.toNumber=function(){var vr=this.words[0];return this.length===2?vr+=this.words[1]*67108864:this.length===3&&this.words[2]===1?vr+=4503599627370496+this.words[1]*67108864:this.length>2&&Bt(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-vr:vr},jt.prototype.toJSON=function(){return this.toString(16)},jt.prototype.toBuffer=function(vr,pr){return Bt(typeof Ut<"u"),this.toArrayLike(Ut,vr,pr)},jt.prototype.toArray=function(vr,pr){return this.toArrayLike(Array,vr,pr)},jt.prototype.toArrayLike=function(vr,pr,dr){var ur=this.byteLength(),$r=dr||Math.max(1,ur);Bt(ur<=$r,"byte array longer than desired length"),Bt($r>0,"Requested array length <= 0"),this.strip();var wr=pr==="le",Er=new vr($r),gr,fr,br=this.clone();if(wr){for(fr=0;!br.isZero();fr++)gr=br.andln(255),br.iushrn(8),Er[fr]=gr;for(;fr<$r;fr++)Er[fr]=0}else{for(fr=0;fr<$r-ur;fr++)Er[fr]=0;for(fr=0;!br.isZero();fr++)gr=br.andln(255),br.iushrn(8),Er[$r-fr-1]=gr}return Er},Math.clz32?jt.prototype._countBits=function(vr){return 32-Math.clz32(vr)}:jt.prototype._countBits=function(vr){var pr=vr,dr=0;return pr>=4096&&(dr+=13,pr>>>=13),pr>=64&&(dr+=7,pr>>>=7),pr>=8&&(dr+=4,pr>>>=4),pr>=2&&(dr+=2,pr>>>=2),dr+pr},jt.prototype._zeroBits=function(vr){if(vr===0)return 26;var pr=vr,dr=0;return pr&8191||(dr+=13,pr>>>=13),pr&127||(dr+=7,pr>>>=7),pr&15||(dr+=4,pr>>>=4),pr&3||(dr+=2,pr>>>=2),pr&1||dr++,dr},jt.prototype.bitLength=function(){var vr=this.words[this.length-1],pr=this._countBits(vr);return(this.length-1)*26+pr};function Qt(Or){for(var vr=new Array(Or.bitLength()),pr=0;pr<vr.length;pr++){var dr=pr/26|0,ur=pr%26;vr[pr]=(Or.words[dr]&1<<ur)>>>ur}return vr}jt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var vr=0,pr=0;pr<this.length;pr++){var dr=this._zeroBits(this.words[pr]);if(vr+=dr,dr!==26)break}return vr},jt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},jt.prototype.toTwos=function(vr){return this.negative!==0?this.abs().inotn(vr).iaddn(1):this.clone()},jt.prototype.fromTwos=function(vr){return this.testn(vr-1)?this.notn(vr).iaddn(1).ineg():this.clone()},jt.prototype.isNeg=function(){return this.negative!==0},jt.prototype.neg=function(){return this.clone().ineg()},jt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},jt.prototype.iuor=function(vr){for(;this.length<vr.length;)this.words[this.length++]=0;for(var pr=0;pr<vr.length;pr++)this.words[pr]=this.words[pr]|vr.words[pr];return this.strip()},jt.prototype.ior=function(vr){return Bt((this.negative|vr.negative)===0),this.iuor(vr)},jt.prototype.or=function(vr){return this.length>vr.length?this.clone().ior(vr):vr.clone().ior(this)},jt.prototype.uor=function(vr){return this.length>vr.length?this.clone().iuor(vr):vr.clone().iuor(this)},jt.prototype.iuand=function(vr){var pr;this.length>vr.length?pr=vr:pr=this;for(var dr=0;dr<pr.length;dr++)this.words[dr]=this.words[dr]&vr.words[dr];return this.length=pr.length,this.strip()},jt.prototype.iand=function(vr){return Bt((this.negative|vr.negative)===0),this.iuand(vr)},jt.prototype.and=function(vr){return this.length>vr.length?this.clone().iand(vr):vr.clone().iand(this)},jt.prototype.uand=function(vr){return this.length>vr.length?this.clone().iuand(vr):vr.clone().iuand(this)},jt.prototype.iuxor=function(vr){var pr,dr;this.length>vr.length?(pr=this,dr=vr):(pr=vr,dr=this);for(var ur=0;ur<dr.length;ur++)this.words[ur]=pr.words[ur]^dr.words[ur];if(this!==pr)for(;ur<pr.length;ur++)this.words[ur]=pr.words[ur];return this.length=pr.length,this.strip()},jt.prototype.ixor=function(vr){return Bt((this.negative|vr.negative)===0),this.iuxor(vr)},jt.prototype.xor=function(vr){return this.length>vr.length?this.clone().ixor(vr):vr.clone().ixor(this)},jt.prototype.uxor=function(vr){return this.length>vr.length?this.clone().iuxor(vr):vr.clone().iuxor(this)},jt.prototype.inotn=function(vr){Bt(typeof vr=="number"&&vr>=0);var pr=Math.ceil(vr/26)|0,dr=vr%26;this._expand(pr),dr>0&&pr--;for(var ur=0;ur<pr;ur++)this.words[ur]=~this.words[ur]&67108863;return dr>0&&(this.words[ur]=~this.words[ur]&67108863>>26-dr),this.strip()},jt.prototype.notn=function(vr){return this.clone().inotn(vr)},jt.prototype.setn=function(vr,pr){Bt(typeof vr=="number"&&vr>=0);var dr=vr/26|0,ur=vr%26;return this._expand(dr+1),pr?this.words[dr]=this.words[dr]|1<<ur:this.words[dr]=this.words[dr]&~(1<<ur),this.strip()},jt.prototype.iadd=function(vr){var pr;if(this.negative!==0&&vr.negative===0)return this.negative=0,pr=this.isub(vr),this.negative^=1,this._normSign();if(this.negative===0&&vr.negative!==0)return vr.negative=0,pr=this.isub(vr),vr.negative=1,pr._normSign();var dr,ur;this.length>vr.length?(dr=this,ur=vr):(dr=vr,ur=this);for(var $r=0,wr=0;wr<ur.length;wr++)pr=(dr.words[wr]|0)+(ur.words[wr]|0)+$r,this.words[wr]=pr&67108863,$r=pr>>>26;for(;$r!==0&&wr<dr.length;wr++)pr=(dr.words[wr]|0)+$r,this.words[wr]=pr&67108863,$r=pr>>>26;if(this.length=dr.length,$r!==0)this.words[this.length]=$r,this.length++;else if(dr!==this)for(;wr<dr.length;wr++)this.words[wr]=dr.words[wr];return this},jt.prototype.add=function(vr){var pr;return vr.negative!==0&&this.negative===0?(vr.negative=0,pr=this.sub(vr),vr.negative^=1,pr):vr.negative===0&&this.negative!==0?(this.negative=0,pr=vr.sub(this),this.negative=1,pr):this.length>vr.length?this.clone().iadd(vr):vr.clone().iadd(this)},jt.prototype.isub=function(vr){if(vr.negative!==0){vr.negative=0;var pr=this.iadd(vr);return vr.negative=1,pr._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(vr),this.negative=1,this._normSign();var dr=this.cmp(vr);if(dr===0)return this.negative=0,this.length=1,this.words[0]=0,this;var ur,$r;dr>0?(ur=this,$r=vr):(ur=vr,$r=this);for(var wr=0,Er=0;Er<$r.length;Er++)pr=(ur.words[Er]|0)-($r.words[Er]|0)+wr,wr=pr>>26,this.words[Er]=pr&67108863;for(;wr!==0&&Er<ur.length;Er++)pr=(ur.words[Er]|0)+wr,wr=pr>>26,this.words[Er]=pr&67108863;if(wr===0&&Er<ur.length&&ur!==this)for(;Er<ur.length;Er++)this.words[Er]=ur.words[Er];return this.length=Math.max(this.length,Er),ur!==this&&(this.negative=1),this.strip()},jt.prototype.sub=function(vr){return this.clone().isub(vr)};function Xt(Or,vr,pr){pr.negative=vr.negative^Or.negative;var dr=Or.length+vr.length|0;pr.length=dr,dr=dr-1|0;var ur=Or.words[0]|0,$r=vr.words[0]|0,wr=ur*$r,Er=wr&67108863,gr=wr/67108864|0;pr.words[0]=Er;for(var fr=1;fr<dr;fr++){for(var br=gr>>>26,_r=gr&67108863,Tr=Math.min(fr,vr.length-1),Pr=Math.max(0,fr-Or.length+1);Pr<=Tr;Pr++){var Nr=fr-Pr|0;ur=Or.words[Nr]|0,$r=vr.words[Pr]|0,wr=ur*$r+_r,br+=wr/67108864|0,_r=wr&67108863}pr.words[fr]=_r|0,gr=br|0}return gr!==0?pr.words[fr]=gr|0:pr.length--,pr.strip()}var tr=function(vr,pr,dr){var ur=vr.words,$r=pr.words,wr=dr.words,Er=0,gr,fr,br,_r=ur[0]|0,Tr=_r&8191,Pr=_r>>>13,Nr=ur[1]|0,Cr=Nr&8191,xr=Nr>>>13,Rr=ur[2]|0,qr=Rr&8191,Vr=Rr>>>13,Gr=ur[3]|0,Ur=Gr&8191,kr=Gr>>>13,Fr=ur[4]|0,Wr=Fr&8191,jr=Fr>>>13,Ir=ur[5]|0,Mr=Ir&8191,Hr=Ir>>>13,Qr=ur[6]|0,on=Qr&8191,nn=Qr>>>13,fn=ur[7]|0,hn=fn&8191,Jr=fn>>>13,Yr=ur[8]|0,an=Yr&8191,dn=Yr>>>13,cn=ur[9]|0,vn=cn&8191,_n=cn>>>13,Tn=$r[0]|0,$n=Tn&8191,Kn=Tn>>>13,Un=$r[1]|0,In=Un&8191,Mn=Un>>>13,qn=$r[2]|0,On=qn&8191,Hn=qn>>>13,Vn=$r[3]|0,xn=Vn&8191,zn=Vn>>>13,Jn=$r[4]|0,Bn=Jn&8191,Qn=Jn>>>13,Zr=$r[5]|0,en=Zr&8191,pn=Zr>>>13,mn=$r[6]|0,yn=mn&8191,Ln=mn>>>13,Gn=$r[7]|0,tn=Gn&8191,Xr=Gn>>>13,sn=$r[8]|0,ln=sn&8191,un=sn>>>13,wn=$r[9]|0,gn=wn&8191,En=wn>>>13;dr.negative=vr.negative^pr.negative,dr.length=19,gr=Math.imul(Tr,$n),fr=Math.imul(Tr,Kn),fr=fr+Math.imul(Pr,$n)|0,br=Math.imul(Pr,Kn);var Dn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Dn>>>26)|0,Dn&=67108863,gr=Math.imul(Cr,$n),fr=Math.imul(Cr,Kn),fr=fr+Math.imul(xr,$n)|0,br=Math.imul(xr,Kn),gr=gr+Math.imul(Tr,In)|0,fr=fr+Math.imul(Tr,Mn)|0,fr=fr+Math.imul(Pr,In)|0,br=br+Math.imul(Pr,Mn)|0;var kn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(kn>>>26)|0,kn&=67108863,gr=Math.imul(qr,$n),fr=Math.imul(qr,Kn),fr=fr+Math.imul(Vr,$n)|0,br=Math.imul(Vr,Kn),gr=gr+Math.imul(Cr,In)|0,fr=fr+Math.imul(Cr,Mn)|0,fr=fr+Math.imul(xr,In)|0,br=br+Math.imul(xr,Mn)|0,gr=gr+Math.imul(Tr,On)|0,fr=fr+Math.imul(Tr,Hn)|0,fr=fr+Math.imul(Pr,On)|0,br=br+Math.imul(Pr,Hn)|0;var Cn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,gr=Math.imul(Ur,$n),fr=Math.imul(Ur,Kn),fr=fr+Math.imul(kr,$n)|0,br=Math.imul(kr,Kn),gr=gr+Math.imul(qr,In)|0,fr=fr+Math.imul(qr,Mn)|0,fr=fr+Math.imul(Vr,In)|0,br=br+Math.imul(Vr,Mn)|0,gr=gr+Math.imul(Cr,On)|0,fr=fr+Math.imul(Cr,Hn)|0,fr=fr+Math.imul(xr,On)|0,br=br+Math.imul(xr,Hn)|0,gr=gr+Math.imul(Tr,xn)|0,fr=fr+Math.imul(Tr,zn)|0,fr=fr+Math.imul(Pr,xn)|0,br=br+Math.imul(Pr,zn)|0;var Nn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Nn>>>26)|0,Nn&=67108863,gr=Math.imul(Wr,$n),fr=Math.imul(Wr,Kn),fr=fr+Math.imul(jr,$n)|0,br=Math.imul(jr,Kn),gr=gr+Math.imul(Ur,In)|0,fr=fr+Math.imul(Ur,Mn)|0,fr=fr+Math.imul(kr,In)|0,br=br+Math.imul(kr,Mn)|0,gr=gr+Math.imul(qr,On)|0,fr=fr+Math.imul(qr,Hn)|0,fr=fr+Math.imul(Vr,On)|0,br=br+Math.imul(Vr,Hn)|0,gr=gr+Math.imul(Cr,xn)|0,fr=fr+Math.imul(Cr,zn)|0,fr=fr+Math.imul(xr,xn)|0,br=br+Math.imul(xr,zn)|0,gr=gr+Math.imul(Tr,Bn)|0,fr=fr+Math.imul(Tr,Qn)|0,fr=fr+Math.imul(Pr,Bn)|0,br=br+Math.imul(Pr,Qn)|0;var Xn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Xn>>>26)|0,Xn&=67108863,gr=Math.imul(Mr,$n),fr=Math.imul(Mr,Kn),fr=fr+Math.imul(Hr,$n)|0,br=Math.imul(Hr,Kn),gr=gr+Math.imul(Wr,In)|0,fr=fr+Math.imul(Wr,Mn)|0,fr=fr+Math.imul(jr,In)|0,br=br+Math.imul(jr,Mn)|0,gr=gr+Math.imul(Ur,On)|0,fr=fr+Math.imul(Ur,Hn)|0,fr=fr+Math.imul(kr,On)|0,br=br+Math.imul(kr,Hn)|0,gr=gr+Math.imul(qr,xn)|0,fr=fr+Math.imul(qr,zn)|0,fr=fr+Math.imul(Vr,xn)|0,br=br+Math.imul(Vr,zn)|0,gr=gr+Math.imul(Cr,Bn)|0,fr=fr+Math.imul(Cr,Qn)|0,fr=fr+Math.imul(xr,Bn)|0,br=br+Math.imul(xr,Qn)|0,gr=gr+Math.imul(Tr,en)|0,fr=fr+Math.imul(Tr,pn)|0,fr=fr+Math.imul(Pr,en)|0,br=br+Math.imul(Pr,pn)|0;var Rn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,gr=Math.imul(on,$n),fr=Math.imul(on,Kn),fr=fr+Math.imul(nn,$n)|0,br=Math.imul(nn,Kn),gr=gr+Math.imul(Mr,In)|0,fr=fr+Math.imul(Mr,Mn)|0,fr=fr+Math.imul(Hr,In)|0,br=br+Math.imul(Hr,Mn)|0,gr=gr+Math.imul(Wr,On)|0,fr=fr+Math.imul(Wr,Hn)|0,fr=fr+Math.imul(jr,On)|0,br=br+Math.imul(jr,Hn)|0,gr=gr+Math.imul(Ur,xn)|0,fr=fr+Math.imul(Ur,zn)|0,fr=fr+Math.imul(kr,xn)|0,br=br+Math.imul(kr,zn)|0,gr=gr+Math.imul(qr,Bn)|0,fr=fr+Math.imul(qr,Qn)|0,fr=fr+Math.imul(Vr,Bn)|0,br=br+Math.imul(Vr,Qn)|0,gr=gr+Math.imul(Cr,en)|0,fr=fr+Math.imul(Cr,pn)|0,fr=fr+Math.imul(xr,en)|0,br=br+Math.imul(xr,pn)|0,gr=gr+Math.imul(Tr,yn)|0,fr=fr+Math.imul(Tr,Ln)|0,fr=fr+Math.imul(Pr,yn)|0,br=br+Math.imul(Pr,Ln)|0;var Yn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Yn>>>26)|0,Yn&=67108863,gr=Math.imul(hn,$n),fr=Math.imul(hn,Kn),fr=fr+Math.imul(Jr,$n)|0,br=Math.imul(Jr,Kn),gr=gr+Math.imul(on,In)|0,fr=fr+Math.imul(on,Mn)|0,fr=fr+Math.imul(nn,In)|0,br=br+Math.imul(nn,Mn)|0,gr=gr+Math.imul(Mr,On)|0,fr=fr+Math.imul(Mr,Hn)|0,fr=fr+Math.imul(Hr,On)|0,br=br+Math.imul(Hr,Hn)|0,gr=gr+Math.imul(Wr,xn)|0,fr=fr+Math.imul(Wr,zn)|0,fr=fr+Math.imul(jr,xn)|0,br=br+Math.imul(jr,zn)|0,gr=gr+Math.imul(Ur,Bn)|0,fr=fr+Math.imul(Ur,Qn)|0,fr=fr+Math.imul(kr,Bn)|0,br=br+Math.imul(kr,Qn)|0,gr=gr+Math.imul(qr,en)|0,fr=fr+Math.imul(qr,pn)|0,fr=fr+Math.imul(Vr,en)|0,br=br+Math.imul(Vr,pn)|0,gr=gr+Math.imul(Cr,yn)|0,fr=fr+Math.imul(Cr,Ln)|0,fr=fr+Math.imul(xr,yn)|0,br=br+Math.imul(xr,Ln)|0,gr=gr+Math.imul(Tr,tn)|0,fr=fr+Math.imul(Tr,Xr)|0,fr=fr+Math.imul(Pr,tn)|0,br=br+Math.imul(Pr,Xr)|0;var ei=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(ei>>>26)|0,ei&=67108863,gr=Math.imul(an,$n),fr=Math.imul(an,Kn),fr=fr+Math.imul(dn,$n)|0,br=Math.imul(dn,Kn),gr=gr+Math.imul(hn,In)|0,fr=fr+Math.imul(hn,Mn)|0,fr=fr+Math.imul(Jr,In)|0,br=br+Math.imul(Jr,Mn)|0,gr=gr+Math.imul(on,On)|0,fr=fr+Math.imul(on,Hn)|0,fr=fr+Math.imul(nn,On)|0,br=br+Math.imul(nn,Hn)|0,gr=gr+Math.imul(Mr,xn)|0,fr=fr+Math.imul(Mr,zn)|0,fr=fr+Math.imul(Hr,xn)|0,br=br+Math.imul(Hr,zn)|0,gr=gr+Math.imul(Wr,Bn)|0,fr=fr+Math.imul(Wr,Qn)|0,fr=fr+Math.imul(jr,Bn)|0,br=br+Math.imul(jr,Qn)|0,gr=gr+Math.imul(Ur,en)|0,fr=fr+Math.imul(Ur,pn)|0,fr=fr+Math.imul(kr,en)|0,br=br+Math.imul(kr,pn)|0,gr=gr+Math.imul(qr,yn)|0,fr=fr+Math.imul(qr,Ln)|0,fr=fr+Math.imul(Vr,yn)|0,br=br+Math.imul(Vr,Ln)|0,gr=gr+Math.imul(Cr,tn)|0,fr=fr+Math.imul(Cr,Xr)|0,fr=fr+Math.imul(xr,tn)|0,br=br+Math.imul(xr,Xr)|0,gr=gr+Math.imul(Tr,ln)|0,fr=fr+Math.imul(Tr,un)|0,fr=fr+Math.imul(Pr,ln)|0,br=br+Math.imul(Pr,un)|0;var Zn=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(Zn>>>26)|0,Zn&=67108863,gr=Math.imul(vn,$n),fr=Math.imul(vn,Kn),fr=fr+Math.imul(_n,$n)|0,br=Math.imul(_n,Kn),gr=gr+Math.imul(an,In)|0,fr=fr+Math.imul(an,Mn)|0,fr=fr+Math.imul(dn,In)|0,br=br+Math.imul(dn,Mn)|0,gr=gr+Math.imul(hn,On)|0,fr=fr+Math.imul(hn,Hn)|0,fr=fr+Math.imul(Jr,On)|0,br=br+Math.imul(Jr,Hn)|0,gr=gr+Math.imul(on,xn)|0,fr=fr+Math.imul(on,zn)|0,fr=fr+Math.imul(nn,xn)|0,br=br+Math.imul(nn,zn)|0,gr=gr+Math.imul(Mr,Bn)|0,fr=fr+Math.imul(Mr,Qn)|0,fr=fr+Math.imul(Hr,Bn)|0,br=br+Math.imul(Hr,Qn)|0,gr=gr+Math.imul(Wr,en)|0,fr=fr+Math.imul(Wr,pn)|0,fr=fr+Math.imul(jr,en)|0,br=br+Math.imul(jr,pn)|0,gr=gr+Math.imul(Ur,yn)|0,fr=fr+Math.imul(Ur,Ln)|0,fr=fr+Math.imul(kr,yn)|0,br=br+Math.imul(kr,Ln)|0,gr=gr+Math.imul(qr,tn)|0,fr=fr+Math.imul(qr,Xr)|0,fr=fr+Math.imul(Vr,tn)|0,br=br+Math.imul(Vr,Xr)|0,gr=gr+Math.imul(Cr,ln)|0,fr=fr+Math.imul(Cr,un)|0,fr=fr+Math.imul(xr,ln)|0,br=br+Math.imul(xr,un)|0,gr=gr+Math.imul(Tr,gn)|0,fr=fr+Math.imul(Tr,En)|0,fr=fr+Math.imul(Pr,gn)|0,br=br+Math.imul(Pr,En)|0;var pi=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(pi>>>26)|0,pi&=67108863,gr=Math.imul(vn,In),fr=Math.imul(vn,Mn),fr=fr+Math.imul(_n,In)|0,br=Math.imul(_n,Mn),gr=gr+Math.imul(an,On)|0,fr=fr+Math.imul(an,Hn)|0,fr=fr+Math.imul(dn,On)|0,br=br+Math.imul(dn,Hn)|0,gr=gr+Math.imul(hn,xn)|0,fr=fr+Math.imul(hn,zn)|0,fr=fr+Math.imul(Jr,xn)|0,br=br+Math.imul(Jr,zn)|0,gr=gr+Math.imul(on,Bn)|0,fr=fr+Math.imul(on,Qn)|0,fr=fr+Math.imul(nn,Bn)|0,br=br+Math.imul(nn,Qn)|0,gr=gr+Math.imul(Mr,en)|0,fr=fr+Math.imul(Mr,pn)|0,fr=fr+Math.imul(Hr,en)|0,br=br+Math.imul(Hr,pn)|0,gr=gr+Math.imul(Wr,yn)|0,fr=fr+Math.imul(Wr,Ln)|0,fr=fr+Math.imul(jr,yn)|0,br=br+Math.imul(jr,Ln)|0,gr=gr+Math.imul(Ur,tn)|0,fr=fr+Math.imul(Ur,Xr)|0,fr=fr+Math.imul(kr,tn)|0,br=br+Math.imul(kr,Xr)|0,gr=gr+Math.imul(qr,ln)|0,fr=fr+Math.imul(qr,un)|0,fr=fr+Math.imul(Vr,ln)|0,br=br+Math.imul(Vr,un)|0,gr=gr+Math.imul(Cr,gn)|0,fr=fr+Math.imul(Cr,En)|0,fr=fr+Math.imul(xr,gn)|0,br=br+Math.imul(xr,En)|0;var li=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(li>>>26)|0,li&=67108863,gr=Math.imul(vn,On),fr=Math.imul(vn,Hn),fr=fr+Math.imul(_n,On)|0,br=Math.imul(_n,Hn),gr=gr+Math.imul(an,xn)|0,fr=fr+Math.imul(an,zn)|0,fr=fr+Math.imul(dn,xn)|0,br=br+Math.imul(dn,zn)|0,gr=gr+Math.imul(hn,Bn)|0,fr=fr+Math.imul(hn,Qn)|0,fr=fr+Math.imul(Jr,Bn)|0,br=br+Math.imul(Jr,Qn)|0,gr=gr+Math.imul(on,en)|0,fr=fr+Math.imul(on,pn)|0,fr=fr+Math.imul(nn,en)|0,br=br+Math.imul(nn,pn)|0,gr=gr+Math.imul(Mr,yn)|0,fr=fr+Math.imul(Mr,Ln)|0,fr=fr+Math.imul(Hr,yn)|0,br=br+Math.imul(Hr,Ln)|0,gr=gr+Math.imul(Wr,tn)|0,fr=fr+Math.imul(Wr,Xr)|0,fr=fr+Math.imul(jr,tn)|0,br=br+Math.imul(jr,Xr)|0,gr=gr+Math.imul(Ur,ln)|0,fr=fr+Math.imul(Ur,un)|0,fr=fr+Math.imul(kr,ln)|0,br=br+Math.imul(kr,un)|0,gr=gr+Math.imul(qr,gn)|0,fr=fr+Math.imul(qr,En)|0,fr=fr+Math.imul(Vr,gn)|0,br=br+Math.imul(Vr,En)|0;var ci=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(ci>>>26)|0,ci&=67108863,gr=Math.imul(vn,xn),fr=Math.imul(vn,zn),fr=fr+Math.imul(_n,xn)|0,br=Math.imul(_n,zn),gr=gr+Math.imul(an,Bn)|0,fr=fr+Math.imul(an,Qn)|0,fr=fr+Math.imul(dn,Bn)|0,br=br+Math.imul(dn,Qn)|0,gr=gr+Math.imul(hn,en)|0,fr=fr+Math.imul(hn,pn)|0,fr=fr+Math.imul(Jr,en)|0,br=br+Math.imul(Jr,pn)|0,gr=gr+Math.imul(on,yn)|0,fr=fr+Math.imul(on,Ln)|0,fr=fr+Math.imul(nn,yn)|0,br=br+Math.imul(nn,Ln)|0,gr=gr+Math.imul(Mr,tn)|0,fr=fr+Math.imul(Mr,Xr)|0,fr=fr+Math.imul(Hr,tn)|0,br=br+Math.imul(Hr,Xr)|0,gr=gr+Math.imul(Wr,ln)|0,fr=fr+Math.imul(Wr,un)|0,fr=fr+Math.imul(jr,ln)|0,br=br+Math.imul(jr,un)|0,gr=gr+Math.imul(Ur,gn)|0,fr=fr+Math.imul(Ur,En)|0,fr=fr+Math.imul(kr,gn)|0,br=br+Math.imul(kr,En)|0;var _i=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(_i>>>26)|0,_i&=67108863,gr=Math.imul(vn,Bn),fr=Math.imul(vn,Qn),fr=fr+Math.imul(_n,Bn)|0,br=Math.imul(_n,Qn),gr=gr+Math.imul(an,en)|0,fr=fr+Math.imul(an,pn)|0,fr=fr+Math.imul(dn,en)|0,br=br+Math.imul(dn,pn)|0,gr=gr+Math.imul(hn,yn)|0,fr=fr+Math.imul(hn,Ln)|0,fr=fr+Math.imul(Jr,yn)|0,br=br+Math.imul(Jr,Ln)|0,gr=gr+Math.imul(on,tn)|0,fr=fr+Math.imul(on,Xr)|0,fr=fr+Math.imul(nn,tn)|0,br=br+Math.imul(nn,Xr)|0,gr=gr+Math.imul(Mr,ln)|0,fr=fr+Math.imul(Mr,un)|0,fr=fr+Math.imul(Hr,ln)|0,br=br+Math.imul(Hr,un)|0,gr=gr+Math.imul(Wr,gn)|0,fr=fr+Math.imul(Wr,En)|0,fr=fr+Math.imul(jr,gn)|0,br=br+Math.imul(jr,En)|0;var vi=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(vi>>>26)|0,vi&=67108863,gr=Math.imul(vn,en),fr=Math.imul(vn,pn),fr=fr+Math.imul(_n,en)|0,br=Math.imul(_n,pn),gr=gr+Math.imul(an,yn)|0,fr=fr+Math.imul(an,Ln)|0,fr=fr+Math.imul(dn,yn)|0,br=br+Math.imul(dn,Ln)|0,gr=gr+Math.imul(hn,tn)|0,fr=fr+Math.imul(hn,Xr)|0,fr=fr+Math.imul(Jr,tn)|0,br=br+Math.imul(Jr,Xr)|0,gr=gr+Math.imul(on,ln)|0,fr=fr+Math.imul(on,un)|0,fr=fr+Math.imul(nn,ln)|0,br=br+Math.imul(nn,un)|0,gr=gr+Math.imul(Mr,gn)|0,fr=fr+Math.imul(Mr,En)|0,fr=fr+Math.imul(Hr,gn)|0,br=br+Math.imul(Hr,En)|0;var oi=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(oi>>>26)|0,oi&=67108863,gr=Math.imul(vn,yn),fr=Math.imul(vn,Ln),fr=fr+Math.imul(_n,yn)|0,br=Math.imul(_n,Ln),gr=gr+Math.imul(an,tn)|0,fr=fr+Math.imul(an,Xr)|0,fr=fr+Math.imul(dn,tn)|0,br=br+Math.imul(dn,Xr)|0,gr=gr+Math.imul(hn,ln)|0,fr=fr+Math.imul(hn,un)|0,fr=fr+Math.imul(Jr,ln)|0,br=br+Math.imul(Jr,un)|0,gr=gr+Math.imul(on,gn)|0,fr=fr+Math.imul(on,En)|0,fr=fr+Math.imul(nn,gn)|0,br=br+Math.imul(nn,En)|0;var di=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(di>>>26)|0,di&=67108863,gr=Math.imul(vn,tn),fr=Math.imul(vn,Xr),fr=fr+Math.imul(_n,tn)|0,br=Math.imul(_n,Xr),gr=gr+Math.imul(an,ln)|0,fr=fr+Math.imul(an,un)|0,fr=fr+Math.imul(dn,ln)|0,br=br+Math.imul(dn,un)|0,gr=gr+Math.imul(hn,gn)|0,fr=fr+Math.imul(hn,En)|0,fr=fr+Math.imul(Jr,gn)|0,br=br+Math.imul(Jr,En)|0;var bi=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(bi>>>26)|0,bi&=67108863,gr=Math.imul(vn,ln),fr=Math.imul(vn,un),fr=fr+Math.imul(_n,ln)|0,br=Math.imul(_n,un),gr=gr+Math.imul(an,gn)|0,fr=fr+Math.imul(an,En)|0,fr=fr+Math.imul(dn,gn)|0,br=br+Math.imul(dn,En)|0;var fi=(Er+gr|0)+((fr&8191)<<13)|0;Er=(br+(fr>>>13)|0)+(fi>>>26)|0,fi&=67108863,gr=Math.imul(vn,gn),fr=Math.imul(vn,En),fr=fr+Math.imul(_n,gn)|0,br=Math.imul(_n,En);var Ti=(Er+gr|0)+((fr&8191)<<13)|0;return Er=(br+(fr>>>13)|0)+(Ti>>>26)|0,Ti&=67108863,wr[0]=Dn,wr[1]=kn,wr[2]=Cn,wr[3]=Nn,wr[4]=Xn,wr[5]=Rn,wr[6]=Yn,wr[7]=ei,wr[8]=Zn,wr[9]=pi,wr[10]=li,wr[11]=ci,wr[12]=_i,wr[13]=vi,wr[14]=oi,wr[15]=di,wr[16]=bi,wr[17]=fi,wr[18]=Ti,Er!==0&&(wr[19]=Er,dr.length++),dr};Math.imul||(tr=Xt);function rr(Or,vr,pr){pr.negative=vr.negative^Or.negative,pr.length=Or.length+vr.length;for(var dr=0,ur=0,$r=0;$r<pr.length-1;$r++){var wr=ur;ur=0;for(var Er=dr&67108863,gr=Math.min($r,vr.length-1),fr=Math.max(0,$r-Or.length+1);fr<=gr;fr++){var br=$r-fr,_r=Or.words[br]|0,Tr=vr.words[fr]|0,Pr=_r*Tr,Nr=Pr&67108863;wr=wr+(Pr/67108864|0)|0,Nr=Nr+Er|0,Er=Nr&67108863,wr=wr+(Nr>>>26)|0,ur+=wr>>>26,wr&=67108863}pr.words[$r]=Er,dr=wr,wr=ur}return dr!==0?pr.words[$r]=dr:pr.length--,pr.strip()}function nr(Or,vr,pr){var dr=new ar;return dr.mulp(Or,vr,pr)}jt.prototype.mulTo=function(vr,pr){var dr,ur=this.length+vr.length;return this.length===10&&vr.length===10?dr=tr(this,vr,pr):ur<63?dr=Xt(this,vr,pr):ur<1024?dr=rr(this,vr,pr):dr=nr(this,vr,pr),dr};function ar(Or,vr){this.x=Or,this.y=vr}ar.prototype.makeRBT=function(vr){for(var pr=new Array(vr),dr=jt.prototype._countBits(vr)-1,ur=0;ur<vr;ur++)pr[ur]=this.revBin(ur,dr,vr);return pr},ar.prototype.revBin=function(vr,pr,dr){if(vr===0||vr===dr-1)return vr;for(var ur=0,$r=0;$r<pr;$r++)ur|=(vr&1)<<pr-$r-1,vr>>=1;return ur},ar.prototype.permute=function(vr,pr,dr,ur,$r,wr){for(var Er=0;Er<wr;Er++)ur[Er]=pr[vr[Er]],$r[Er]=dr[vr[Er]]},ar.prototype.transform=function(vr,pr,dr,ur,$r,wr){this.permute(wr,vr,pr,dr,ur,$r);for(var Er=1;Er<$r;Er<<=1)for(var gr=Er<<1,fr=Math.cos(2*Math.PI/gr),br=Math.sin(2*Math.PI/gr),_r=0;_r<$r;_r+=gr)for(var Tr=fr,Pr=br,Nr=0;Nr<Er;Nr++){var Cr=dr[_r+Nr],xr=ur[_r+Nr],Rr=dr[_r+Nr+Er],qr=ur[_r+Nr+Er],Vr=Tr*Rr-Pr*qr;qr=Tr*qr+Pr*Rr,Rr=Vr,dr[_r+Nr]=Cr+Rr,ur[_r+Nr]=xr+qr,dr[_r+Nr+Er]=Cr-Rr,ur[_r+Nr+Er]=xr-qr,Nr!==gr&&(Vr=fr*Tr-br*Pr,Pr=fr*Pr+br*Tr,Tr=Vr)}},ar.prototype.guessLen13b=function(vr,pr){var dr=Math.max(pr,vr)|1,ur=dr&1,$r=0;for(dr=dr/2|0;dr;dr=dr>>>1)$r++;return 1<<$r+1+ur},ar.prototype.conjugate=function(vr,pr,dr){if(!(dr<=1))for(var ur=0;ur<dr/2;ur++){var $r=vr[ur];vr[ur]=vr[dr-ur-1],vr[dr-ur-1]=$r,$r=pr[ur],pr[ur]=-pr[dr-ur-1],pr[dr-ur-1]=-$r}},ar.prototype.normalize13b=function(vr,pr){for(var dr=0,ur=0;ur<pr/2;ur++){var $r=Math.round(vr[2*ur+1]/pr)*8192+Math.round(vr[2*ur]/pr)+dr;vr[ur]=$r&67108863,$r<67108864?dr=0:dr=$r/67108864|0}return vr},ar.prototype.convert13b=function(vr,pr,dr,ur){for(var $r=0,wr=0;wr<pr;wr++)$r=$r+(vr[wr]|0),dr[2*wr]=$r&8191,$r=$r>>>13,dr[2*wr+1]=$r&8191,$r=$r>>>13;for(wr=2*pr;wr<ur;++wr)dr[wr]=0;Bt($r===0),Bt(($r&-8192)===0)},ar.prototype.stub=function(vr){for(var pr=new Array(vr),dr=0;dr<vr;dr++)pr[dr]=0;return pr},ar.prototype.mulp=function(vr,pr,dr){var ur=2*this.guessLen13b(vr.length,pr.length),$r=this.makeRBT(ur),wr=this.stub(ur),Er=new Array(ur),gr=new Array(ur),fr=new Array(ur),br=new Array(ur),_r=new Array(ur),Tr=new Array(ur),Pr=dr.words;Pr.length=ur,this.convert13b(vr.words,vr.length,Er,ur),this.convert13b(pr.words,pr.length,br,ur),this.transform(Er,wr,gr,fr,ur,$r),this.transform(br,wr,_r,Tr,ur,$r);for(var Nr=0;Nr<ur;Nr++){var Cr=gr[Nr]*_r[Nr]-fr[Nr]*Tr[Nr];fr[Nr]=gr[Nr]*Tr[Nr]+fr[Nr]*_r[Nr],gr[Nr]=Cr}return this.conjugate(gr,fr,ur),this.transform(gr,fr,Pr,wr,ur,$r),this.conjugate(Pr,wr,ur),this.normalize13b(Pr,ur),dr.negative=vr.negative^pr.negative,dr.length=vr.length+pr.length,dr.strip()},jt.prototype.mul=function(vr){var pr=new jt(null);return pr.words=new Array(this.length+vr.length),this.mulTo(vr,pr)},jt.prototype.mulf=function(vr){var pr=new jt(null);return pr.words=new Array(this.length+vr.length),nr(this,vr,pr)},jt.prototype.imul=function(vr){return this.clone().mulTo(vr,this)},jt.prototype.imuln=function(vr){Bt(typeof vr=="number"),Bt(vr<67108864);for(var pr=0,dr=0;dr<this.length;dr++){var ur=(this.words[dr]|0)*vr,$r=(ur&67108863)+(pr&67108863);pr>>=26,pr+=ur/67108864|0,pr+=$r>>>26,this.words[dr]=$r&67108863}return pr!==0&&(this.words[dr]=pr,this.length++),this},jt.prototype.muln=function(vr){return this.clone().imuln(vr)},jt.prototype.sqr=function(){return this.mul(this)},jt.prototype.isqr=function(){return this.imul(this.clone())},jt.prototype.pow=function(vr){var pr=Qt(vr);if(pr.length===0)return new jt(1);for(var dr=this,ur=0;ur<pr.length&&pr[ur]===0;ur++,dr=dr.sqr());if(++ur<pr.length)for(var $r=dr.sqr();ur<pr.length;ur++,$r=$r.sqr())pr[ur]!==0&&(dr=dr.mul($r));return dr},jt.prototype.iushln=function(vr){Bt(typeof vr=="number"&&vr>=0);var pr=vr%26,dr=(vr-pr)/26,ur=67108863>>>26-pr<<26-pr,$r;if(pr!==0){var wr=0;for($r=0;$r<this.length;$r++){var Er=this.words[$r]&ur,gr=(this.words[$r]|0)-Er<<pr;this.words[$r]=gr|wr,wr=Er>>>26-pr}wr&&(this.words[$r]=wr,this.length++)}if(dr!==0){for($r=this.length-1;$r>=0;$r--)this.words[$r+dr]=this.words[$r];for($r=0;$r<dr;$r++)this.words[$r]=0;this.length+=dr}return this.strip()},jt.prototype.ishln=function(vr){return Bt(this.negative===0),this.iushln(vr)},jt.prototype.iushrn=function(vr,pr,dr){Bt(typeof vr=="number"&&vr>=0);var ur;pr?ur=(pr-pr%26)/26:ur=0;var $r=vr%26,wr=Math.min((vr-$r)/26,this.length),Er=67108863^67108863>>>$r<<$r,gr=dr;if(ur-=wr,ur=Math.max(0,ur),gr){for(var fr=0;fr<wr;fr++)gr.words[fr]=this.words[fr];gr.length=wr}if(wr!==0)if(this.length>wr)for(this.length-=wr,fr=0;fr<this.length;fr++)this.words[fr]=this.words[fr+wr];else this.words[0]=0,this.length=1;var br=0;for(fr=this.length-1;fr>=0&&(br!==0||fr>=ur);fr--){var _r=this.words[fr]|0;this.words[fr]=br<<26-$r|_r>>>$r,br=_r&Er}return gr&&br!==0&&(gr.words[gr.length++]=br),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},jt.prototype.ishrn=function(vr,pr,dr){return Bt(this.negative===0),this.iushrn(vr,pr,dr)},jt.prototype.shln=function(vr){return this.clone().ishln(vr)},jt.prototype.ushln=function(vr){return this.clone().iushln(vr)},jt.prototype.shrn=function(vr){return this.clone().ishrn(vr)},jt.prototype.ushrn=function(vr){return this.clone().iushrn(vr)},jt.prototype.testn=function(vr){Bt(typeof vr=="number"&&vr>=0);var pr=vr%26,dr=(vr-pr)/26,ur=1<<pr;if(this.length<=dr)return!1;var $r=this.words[dr];return!!($r&ur)},jt.prototype.imaskn=function(vr){Bt(typeof vr=="number"&&vr>=0);var pr=vr%26,dr=(vr-pr)/26;if(Bt(this.negative===0,"imaskn works only with positive numbers"),this.length<=dr)return this;if(pr!==0&&dr++,this.length=Math.min(dr,this.length),pr!==0){var ur=67108863^67108863>>>pr<<pr;this.words[this.length-1]&=ur}return this.strip()},jt.prototype.maskn=function(vr){return this.clone().imaskn(vr)},jt.prototype.iaddn=function(vr){return Bt(typeof vr=="number"),Bt(vr<67108864),vr<0?this.isubn(-vr):this.negative!==0?this.length===1&&(this.words[0]|0)<vr?(this.words[0]=vr-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(vr),this.negative=1,this):this._iaddn(vr)},jt.prototype._iaddn=function(vr){this.words[0]+=vr;for(var pr=0;pr<this.length&&this.words[pr]>=67108864;pr++)this.words[pr]-=67108864,pr===this.length-1?this.words[pr+1]=1:this.words[pr+1]++;return this.length=Math.max(this.length,pr+1),this},jt.prototype.isubn=function(vr){if(Bt(typeof vr=="number"),Bt(vr<67108864),vr<0)return this.iaddn(-vr);if(this.negative!==0)return this.negative=0,this.iaddn(vr),this.negative=1,this;if(this.words[0]-=vr,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var pr=0;pr<this.length&&this.words[pr]<0;pr++)this.words[pr]+=67108864,this.words[pr+1]-=1;return this.strip()},jt.prototype.addn=function(vr){return this.clone().iaddn(vr)},jt.prototype.subn=function(vr){return this.clone().isubn(vr)},jt.prototype.iabs=function(){return this.negative=0,this},jt.prototype.abs=function(){return this.clone().iabs()},jt.prototype._ishlnsubmul=function(vr,pr,dr){var ur=vr.length+dr,$r;this._expand(ur);var wr,Er=0;for($r=0;$r<vr.length;$r++){wr=(this.words[$r+dr]|0)+Er;var gr=(vr.words[$r]|0)*pr;wr-=gr&67108863,Er=(wr>>26)-(gr/67108864|0),this.words[$r+dr]=wr&67108863}for(;$r<this.length-dr;$r++)wr=(this.words[$r+dr]|0)+Er,Er=wr>>26,this.words[$r+dr]=wr&67108863;if(Er===0)return this.strip();for(Bt(Er===-1),Er=0,$r=0;$r<this.length;$r++)wr=-(this.words[$r]|0)+Er,Er=wr>>26,this.words[$r]=wr&67108863;return this.negative=1,this.strip()},jt.prototype._wordDiv=function(vr,pr){var dr=this.length-vr.length,ur=this.clone(),$r=vr,wr=$r.words[$r.length-1]|0,Er=this._countBits(wr);dr=26-Er,dr!==0&&($r=$r.ushln(dr),ur.iushln(dr),wr=$r.words[$r.length-1]|0);var gr=ur.length-$r.length,fr;if(pr!=="mod"){fr=new jt(null),fr.length=gr+1,fr.words=new Array(fr.length);for(var br=0;br<fr.length;br++)fr.words[br]=0}var _r=ur.clone()._ishlnsubmul($r,1,gr);_r.negative===0&&(ur=_r,fr&&(fr.words[gr]=1));for(var Tr=gr-1;Tr>=0;Tr--){var Pr=(ur.words[$r.length+Tr]|0)*67108864+(ur.words[$r.length+Tr-1]|0);for(Pr=Math.min(Pr/wr|0,67108863),ur._ishlnsubmul($r,Pr,Tr);ur.negative!==0;)Pr--,ur.negative=0,ur._ishlnsubmul($r,1,Tr),ur.isZero()||(ur.negative^=1);fr&&(fr.words[Tr]=Pr)}return fr&&fr.strip(),ur.strip(),pr!=="div"&&dr!==0&&ur.iushrn(dr),{div:fr||null,mod:ur}},jt.prototype.divmod=function(vr,pr,dr){if(Bt(!vr.isZero()),this.isZero())return{div:new jt(0),mod:new jt(0)};var ur,$r,wr;return this.negative!==0&&vr.negative===0?(wr=this.neg().divmod(vr,pr),pr!=="mod"&&(ur=wr.div.neg()),pr!=="div"&&($r=wr.mod.neg(),dr&&$r.negative!==0&&$r.iadd(vr)),{div:ur,mod:$r}):this.negative===0&&vr.negative!==0?(wr=this.divmod(vr.neg(),pr),pr!=="mod"&&(ur=wr.div.neg()),{div:ur,mod:wr.mod}):this.negative&vr.negative?(wr=this.neg().divmod(vr.neg(),pr),pr!=="div"&&($r=wr.mod.neg(),dr&&$r.negative!==0&&$r.isub(vr)),{div:wr.div,mod:$r}):vr.length>this.length||this.cmp(vr)<0?{div:new jt(0),mod:this}:vr.length===1?pr==="div"?{div:this.divn(vr.words[0]),mod:null}:pr==="mod"?{div:null,mod:new jt(this.modn(vr.words[0]))}:{div:this.divn(vr.words[0]),mod:new jt(this.modn(vr.words[0]))}:this._wordDiv(vr,pr)},jt.prototype.div=function(vr){return this.divmod(vr,"div",!1).div},jt.prototype.mod=function(vr){return this.divmod(vr,"mod",!1).mod},jt.prototype.umod=function(vr){return this.divmod(vr,"mod",!0).mod},jt.prototype.divRound=function(vr){var pr=this.divmod(vr);if(pr.mod.isZero())return pr.div;var dr=pr.div.negative!==0?pr.mod.isub(vr):pr.mod,ur=vr.ushrn(1),$r=vr.andln(1),wr=dr.cmp(ur);return wr<0||$r===1&&wr===0?pr.div:pr.div.negative!==0?pr.div.isubn(1):pr.div.iaddn(1)},jt.prototype.modn=function(vr){Bt(vr<=67108863);for(var pr=(1<<26)%vr,dr=0,ur=this.length-1;ur>=0;ur--)dr=(pr*dr+(this.words[ur]|0))%vr;return dr},jt.prototype.idivn=function(vr){Bt(vr<=67108863);for(var pr=0,dr=this.length-1;dr>=0;dr--){var ur=(this.words[dr]|0)+pr*67108864;this.words[dr]=ur/vr|0,pr=ur%vr}return this.strip()},jt.prototype.divn=function(vr){return this.clone().idivn(vr)},jt.prototype.egcd=function(vr){Bt(vr.negative===0),Bt(!vr.isZero());var pr=this,dr=vr.clone();pr.negative!==0?pr=pr.umod(vr):pr=pr.clone();for(var ur=new jt(1),$r=new jt(0),wr=new jt(0),Er=new jt(1),gr=0;pr.isEven()&&dr.isEven();)pr.iushrn(1),dr.iushrn(1),++gr;for(var fr=dr.clone(),br=pr.clone();!pr.isZero();){for(var _r=0,Tr=1;!(pr.words[0]&Tr)&&_r<26;++_r,Tr<<=1);if(_r>0)for(pr.iushrn(_r);_r-- >0;)(ur.isOdd()||$r.isOdd())&&(ur.iadd(fr),$r.isub(br)),ur.iushrn(1),$r.iushrn(1);for(var Pr=0,Nr=1;!(dr.words[0]&Nr)&&Pr<26;++Pr,Nr<<=1);if(Pr>0)for(dr.iushrn(Pr);Pr-- >0;)(wr.isOdd()||Er.isOdd())&&(wr.iadd(fr),Er.isub(br)),wr.iushrn(1),Er.iushrn(1);pr.cmp(dr)>=0?(pr.isub(dr),ur.isub(wr),$r.isub(Er)):(dr.isub(pr),wr.isub(ur),Er.isub($r))}return{a:wr,b:Er,gcd:dr.iushln(gr)}},jt.prototype._invmp=function(vr){Bt(vr.negative===0),Bt(!vr.isZero());var pr=this,dr=vr.clone();pr.negative!==0?pr=pr.umod(vr):pr=pr.clone();for(var ur=new jt(1),$r=new jt(0),wr=dr.clone();pr.cmpn(1)>0&&dr.cmpn(1)>0;){for(var Er=0,gr=1;!(pr.words[0]&gr)&&Er<26;++Er,gr<<=1);if(Er>0)for(pr.iushrn(Er);Er-- >0;)ur.isOdd()&&ur.iadd(wr),ur.iushrn(1);for(var fr=0,br=1;!(dr.words[0]&br)&&fr<26;++fr,br<<=1);if(fr>0)for(dr.iushrn(fr);fr-- >0;)$r.isOdd()&&$r.iadd(wr),$r.iushrn(1);pr.cmp(dr)>=0?(pr.isub(dr),ur.isub($r)):(dr.isub(pr),$r.isub(ur))}var _r;return pr.cmpn(1)===0?_r=ur:_r=$r,_r.cmpn(0)<0&&_r.iadd(vr),_r},jt.prototype.gcd=function(vr){if(this.isZero())return vr.abs();if(vr.isZero())return this.abs();var pr=this.clone(),dr=vr.clone();pr.negative=0,dr.negative=0;for(var ur=0;pr.isEven()&&dr.isEven();ur++)pr.iushrn(1),dr.iushrn(1);do{for(;pr.isEven();)pr.iushrn(1);for(;dr.isEven();)dr.iushrn(1);var $r=pr.cmp(dr);if($r<0){var wr=pr;pr=dr,dr=wr}else if($r===0||dr.cmpn(1)===0)break;pr.isub(dr)}while(!0);return dr.iushln(ur)},jt.prototype.invm=function(vr){return this.egcd(vr).a.umod(vr)},jt.prototype.isEven=function(){return(this.words[0]&1)===0},jt.prototype.isOdd=function(){return(this.words[0]&1)===1},jt.prototype.andln=function(vr){return this.words[0]&vr},jt.prototype.bincn=function(vr){Bt(typeof vr=="number");var pr=vr%26,dr=(vr-pr)/26,ur=1<<pr;if(this.length<=dr)return this._expand(dr+1),this.words[dr]|=ur,this;for(var $r=ur,wr=dr;$r!==0&&wr<this.length;wr++){var Er=this.words[wr]|0;Er+=$r,$r=Er>>>26,Er&=67108863,this.words[wr]=Er}return $r!==0&&(this.words[wr]=$r,this.length++),this},jt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},jt.prototype.cmpn=function(vr){var pr=vr<0;if(this.negative!==0&&!pr)return-1;if(this.negative===0&&pr)return 1;this.strip();var dr;if(this.length>1)dr=1;else{pr&&(vr=-vr),Bt(vr<=67108863,"Number is too big");var ur=this.words[0]|0;dr=ur===vr?0:ur<vr?-1:1}return this.negative!==0?-dr|0:dr},jt.prototype.cmp=function(vr){if(this.negative!==0&&vr.negative===0)return-1;if(this.negative===0&&vr.negative!==0)return 1;var pr=this.ucmp(vr);return this.negative!==0?-pr|0:pr},jt.prototype.ucmp=function(vr){if(this.length>vr.length)return 1;if(this.length<vr.length)return-1;for(var pr=0,dr=this.length-1;dr>=0;dr--){var ur=this.words[dr]|0,$r=vr.words[dr]|0;if(ur!==$r){ur<$r?pr=-1:ur>$r&&(pr=1);break}}return pr},jt.prototype.gtn=function(vr){return this.cmpn(vr)===1},jt.prototype.gt=function(vr){return this.cmp(vr)===1},jt.prototype.gten=function(vr){return this.cmpn(vr)>=0},jt.prototype.gte=function(vr){return this.cmp(vr)>=0},jt.prototype.ltn=function(vr){return this.cmpn(vr)===-1},jt.prototype.lt=function(vr){return this.cmp(vr)===-1},jt.prototype.lten=function(vr){return this.cmpn(vr)<=0},jt.prototype.lte=function(vr){return this.cmp(vr)<=0},jt.prototype.eqn=function(vr){return this.cmpn(vr)===0},jt.prototype.eq=function(vr){return this.cmp(vr)===0},jt.red=function(vr){return new Br(vr)},jt.prototype.toRed=function(vr){return Bt(!this.red,"Already a number in reduction context"),Bt(this.negative===0,"red works only with positives"),vr.convertTo(this)._forceRed(vr)},jt.prototype.fromRed=function(){return Bt(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},jt.prototype._forceRed=function(vr){return this.red=vr,this},jt.prototype.forceRed=function(vr){return Bt(!this.red,"Already a number in reduction context"),this._forceRed(vr)},jt.prototype.redAdd=function(vr){return Bt(this.red,"redAdd works only with red numbers"),this.red.add(this,vr)},jt.prototype.redIAdd=function(vr){return Bt(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,vr)},jt.prototype.redSub=function(vr){return Bt(this.red,"redSub works only with red numbers"),this.red.sub(this,vr)},jt.prototype.redISub=function(vr){return Bt(this.red,"redISub works only with red numbers"),this.red.isub(this,vr)},jt.prototype.redShl=function(vr){return Bt(this.red,"redShl works only with red numbers"),this.red.shl(this,vr)},jt.prototype.redMul=function(vr){return Bt(this.red,"redMul works only with red numbers"),this.red._verify2(this,vr),this.red.mul(this,vr)},jt.prototype.redIMul=function(vr){return Bt(this.red,"redMul works only with red numbers"),this.red._verify2(this,vr),this.red.imul(this,vr)},jt.prototype.redSqr=function(){return Bt(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},jt.prototype.redISqr=function(){return Bt(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},jt.prototype.redSqrt=function(){return Bt(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},jt.prototype.redInvm=function(){return Bt(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},jt.prototype.redNeg=function(){return Bt(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},jt.prototype.redPow=function(vr){return Bt(this.red&&!vr.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,vr)};var ir={k256:null,p224:null,p192:null,p25519:null};function lr(Or,vr){this.name=Or,this.p=new jt(vr,16),this.n=this.p.bitLength(),this.k=new jt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}lr.prototype._tmp=function(){var vr=new jt(null);return vr.words=new Array(Math.ceil(this.n/13)),vr},lr.prototype.ireduce=function(vr){var pr=vr,dr;do this.split(pr,this.tmp),pr=this.imulK(pr),pr=pr.iadd(this.tmp),dr=pr.bitLength();while(dr>this.n);var ur=dr<this.n?-1:pr.ucmp(this.p);return ur===0?(pr.words[0]=0,pr.length=1):ur>0?pr.isub(this.p):pr.strip!==void 0?pr.strip():pr._strip(),pr},lr.prototype.split=function(vr,pr){vr.iushrn(this.n,0,pr)},lr.prototype.imulK=function(vr){return vr.imul(this.k)};function yr(){lr.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}Nt(yr,lr),yr.prototype.split=function(vr,pr){for(var dr=4194303,ur=Math.min(vr.length,9),$r=0;$r<ur;$r++)pr.words[$r]=vr.words[$r];if(pr.length=ur,vr.length<=9){vr.words[0]=0,vr.length=1;return}var wr=vr.words[9];for(pr.words[pr.length++]=wr&dr,$r=10;$r<vr.length;$r++){var Er=vr.words[$r]|0;vr.words[$r-10]=(Er&dr)<<4|wr>>>22,wr=Er}wr>>>=22,vr.words[$r-10]=wr,wr===0&&vr.length>10?vr.length-=10:vr.length-=9},yr.prototype.imulK=function(vr){vr.words[vr.length]=0,vr.words[vr.length+1]=0,vr.length+=2;for(var pr=0,dr=0;dr<vr.length;dr++){var ur=vr.words[dr]|0;pr+=ur*977,vr.words[dr]=pr&67108863,pr=ur*64+(pr/67108864|0)}return vr.words[vr.length-1]===0&&(vr.length--,vr.words[vr.length-1]===0&&vr.length--),vr};function Sr(){lr.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}Nt(Sr,lr);function Ar(){lr.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}Nt(Ar,lr);function Dr(){lr.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}Nt(Dr,lr),Dr.prototype.imulK=function(vr){for(var pr=0,dr=0;dr<vr.length;dr++){var ur=(vr.words[dr]|0)*19+pr,$r=ur&67108863;ur>>>=26,vr.words[dr]=$r,pr=ur}return pr!==0&&(vr.words[vr.length++]=pr),vr},jt._prime=function(vr){if(ir[vr])return ir[vr];var pr;if(vr==="k256")pr=new yr;else if(vr==="p224")pr=new Sr;else if(vr==="p192")pr=new Ar;else if(vr==="p25519")pr=new Dr;else throw new Error("Unknown prime "+vr);return ir[vr]=pr,pr};function Br(Or){if(typeof Or=="string"){var vr=jt._prime(Or);this.m=vr.p,this.prime=vr}else Bt(Or.gtn(1),"modulus must be greater than 1"),this.m=Or,this.prime=null}Br.prototype._verify1=function(vr){Bt(vr.negative===0,"red works only with positives"),Bt(vr.red,"red works only with red numbers")},Br.prototype._verify2=function(vr,pr){Bt((vr.negative|pr.negative)===0,"red works only with positives"),Bt(vr.red&&vr.red===pr.red,"red works only with red numbers")},Br.prototype.imod=function(vr){return this.prime?this.prime.ireduce(vr)._forceRed(this):vr.umod(this.m)._forceRed(this)},Br.prototype.neg=function(vr){return vr.isZero()?vr.clone():this.m.sub(vr)._forceRed(this)},Br.prototype.add=function(vr,pr){this._verify2(vr,pr);var dr=vr.add(pr);return dr.cmp(this.m)>=0&&dr.isub(this.m),dr._forceRed(this)},Br.prototype.iadd=function(vr,pr){this._verify2(vr,pr);var dr=vr.iadd(pr);return dr.cmp(this.m)>=0&&dr.isub(this.m),dr},Br.prototype.sub=function(vr,pr){this._verify2(vr,pr);var dr=vr.sub(pr);return dr.cmpn(0)<0&&dr.iadd(this.m),dr._forceRed(this)},Br.prototype.isub=function(vr,pr){this._verify2(vr,pr);var dr=vr.isub(pr);return dr.cmpn(0)<0&&dr.iadd(this.m),dr},Br.prototype.shl=function(vr,pr){return this._verify1(vr),this.imod(vr.ushln(pr))},Br.prototype.imul=function(vr,pr){return this._verify2(vr,pr),this.imod(vr.imul(pr))},Br.prototype.mul=function(vr,pr){return this._verify2(vr,pr),this.imod(vr.mul(pr))},Br.prototype.isqr=function(vr){return this.imul(vr,vr.clone())},Br.prototype.sqr=function(vr){return this.mul(vr,vr)},Br.prototype.sqrt=function(vr){if(vr.isZero())return vr.clone();var pr=this.m.andln(3);if(Bt(pr%2===1),pr===3){var dr=this.m.add(new jt(1)).iushrn(2);return this.pow(vr,dr)}for(var ur=this.m.subn(1),$r=0;!ur.isZero()&&ur.andln(1)===0;)$r++,ur.iushrn(1);Bt(!ur.isZero());var wr=new jt(1).toRed(this),Er=wr.redNeg(),gr=this.m.subn(1).iushrn(1),fr=this.m.bitLength();for(fr=new jt(2*fr*fr).toRed(this);this.pow(fr,gr).cmp(Er)!==0;)fr.redIAdd(Er);for(var br=this.pow(fr,ur),_r=this.pow(vr,ur.addn(1).iushrn(1)),Tr=this.pow(vr,ur),Pr=$r;Tr.cmp(wr)!==0;){for(var Nr=Tr,Cr=0;Nr.cmp(wr)!==0;Cr++)Nr=Nr.redSqr();Bt(Cr<Pr);var xr=this.pow(br,new jt(1).iushln(Pr-Cr-1));_r=_r.redMul(xr),br=xr.redSqr(),Tr=Tr.redMul(br),Pr=Cr}return _r},Br.prototype.invm=function(vr){var pr=vr._invmp(this.m);return pr.negative!==0?(pr.negative=0,this.imod(pr).redNeg()):this.imod(pr)},Br.prototype.pow=function(vr,pr){if(pr.isZero())return new jt(1).toRed(this);if(pr.cmpn(1)===0)return vr.clone();var dr=4,ur=new Array(1<<dr);ur[0]=new jt(1).toRed(this),ur[1]=vr;for(var $r=2;$r<ur.length;$r++)ur[$r]=this.mul(ur[$r-1],vr);var wr=ur[0],Er=0,gr=0,fr=pr.bitLength()%26;for(fr===0&&(fr=26),$r=pr.length-1;$r>=0;$r--){for(var br=pr.words[$r],_r=fr-1;_r>=0;_r--){var Tr=br>>_r&1;if(wr!==ur[0]&&(wr=this.sqr(wr)),Tr===0&&Er===0){gr=0;continue}Er<<=1,Er|=Tr,gr++,!(gr!==dr&&($r!==0||_r!==0))&&(wr=this.mul(wr,ur[Er]),gr=0,Er=0)}fr=26}return wr},Br.prototype.convertTo=function(vr){var pr=vr.umod(this.m);return pr===vr?pr.clone():pr},Br.prototype.convertFrom=function(vr){var pr=vr.clone();return pr.red=null,pr},jt.mont=function(vr){return new Lr(vr)};function Lr(Or){Br.call(this,Or),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new jt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}Nt(Lr,Br),Lr.prototype.convertTo=function(vr){return this.imod(vr.ushln(this.shift))},Lr.prototype.convertFrom=function(vr){var pr=this.imod(vr.mul(this.rinv));return pr.red=null,pr},Lr.prototype.imul=function(vr,pr){if(vr.isZero()||pr.isZero())return vr.words[0]=0,vr.length=1,vr;var dr=vr.imul(pr),ur=dr.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$r=dr.isub(ur).iushrn(this.shift),wr=$r;return $r.cmp(this.m)>=0?wr=$r.isub(this.m):$r.cmpn(0)<0&&(wr=$r.iadd(this.m)),wr._forceRed(this)},Lr.prototype.mul=function(vr,pr){if(vr.isZero()||pr.isZero())return new jt(0)._forceRed(this);var dr=vr.mul(pr),ur=dr.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),$r=dr.isub(ur).iushrn(this.shift),wr=$r;return $r.cmp(this.m)>=0?wr=$r.isub(this.m):$r.cmpn(0)<0&&(wr=$r.iadd(this.m)),wr._forceRed(this)},Lr.prototype.invm=function(vr){var pr=this.imod(vr._invmp(this.m).mul(this.r2));return pr._forceRed(this)}})(kt,commonjsGlobal)})(bn$1);var bnExports$1=bn$1.exports,brorand={exports:{}},hasRequiredBrorand;function requireBrorand(){if(hasRequiredBrorand)return brorand.exports;hasRequiredBrorand=1;var kt;brorand.exports=function(Nt){return kt||(kt=new At(null)),kt.generate(Nt)};function At(Bt){this.rand=Bt}if(brorand.exports.Rand=At,At.prototype.generate=function(Nt){return this._rand(Nt)},At.prototype._rand=function(Nt){if(this.rand.getBytes)return this.rand.getBytes(Nt);for(var jt=new Uint8Array(Nt),Ut=0;Ut<jt.length;Ut++)jt[Ut]=this.rand.getByte();return jt},typeof self=="object")self.crypto&&self.crypto.getRandomValues?At.prototype._rand=function(Nt){var jt=new Uint8Array(Nt);return self.crypto.getRandomValues(jt),jt}:self.msCrypto&&self.msCrypto.getRandomValues?At.prototype._rand=function(Nt){var jt=new Uint8Array(Nt);return self.msCrypto.getRandomValues(jt),jt}:typeof window=="object"&&(At.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var xt=requireCryptoBrowserify();if(typeof xt.randomBytes!="function")throw new Error("Not supported");At.prototype._rand=function(Nt){return xt.randomBytes(Nt)}}catch{}return brorand.exports}var mr,hasRequiredMr;function requireMr(){if(hasRequiredMr)return mr;hasRequiredMr=1;var kt=bnExports$1,At=requireBrorand();function xt(Bt){this.rand=Bt||new At.Rand}return mr=xt,xt.create=function(Nt){return new xt(Nt)},xt.prototype._randbelow=function(Nt){var jt=Nt.bitLength(),Ut=Math.ceil(jt/8);do var Lt=new kt(this.rand.generate(Ut));while(Lt.cmp(Nt)>=0);return Lt},xt.prototype._randrange=function(Nt,jt){var Ut=jt.sub(Nt);return Nt.add(this._randbelow(Ut))},xt.prototype.test=function(Nt,jt,Ut){var Lt=Nt.bitLength(),Ht=kt.mont(Nt),Vt=new kt(1).toRed(Ht);jt||(jt=Math.max(1,Lt/48|0));for(var zt=Nt.subn(1),Wt=0;!zt.testn(Wt);Wt++);for(var Jt=Nt.shrn(Wt),Qt=zt.toRed(Ht),Xt=!0;jt>0;jt--){var tr=this._randrange(new kt(2),zt);Ut&&Ut(tr);var rr=tr.toRed(Ht).redPow(Jt);if(!(rr.cmp(Vt)===0||rr.cmp(Qt)===0)){for(var nr=1;nr<Wt;nr++){if(rr=rr.redSqr(),rr.cmp(Vt)===0)return!1;if(rr.cmp(Qt)===0)break}if(nr===Wt)return!1}}return Xt},xt.prototype.getDivisor=function(Nt,jt){var Ut=Nt.bitLength(),Lt=kt.mont(Nt),Ht=new kt(1).toRed(Lt);jt||(jt=Math.max(1,Ut/48|0));for(var Vt=Nt.subn(1),zt=0;!Vt.testn(zt);zt++);for(var Wt=Nt.shrn(zt),Jt=Vt.toRed(Lt);jt>0;jt--){var Qt=this._randrange(new kt(2),Vt),Xt=Nt.gcd(Qt);if(Xt.cmpn(1)!==0)return Xt;var tr=Qt.toRed(Lt).redPow(Wt);if(!(tr.cmp(Ht)===0||tr.cmp(Jt)===0)){for(var rr=1;rr<zt;rr++){if(tr=tr.redSqr(),tr.cmp(Ht)===0)return tr.fromRed().subn(1).gcd(Nt);if(tr.cmp(Jt)===0)break}if(rr===zt)return tr=tr.redSqr(),tr.fromRed().subn(1).gcd(Nt)}}return!1},mr}var generatePrime,hasRequiredGeneratePrime;function requireGeneratePrime(){if(hasRequiredGeneratePrime)return generatePrime;hasRequiredGeneratePrime=1;var kt=browserExports$2;generatePrime=rr,rr.simpleSieve=Xt,rr.fermatTest=tr;var At=bnExports$1,xt=new At(24),Bt=requireMr(),Nt=new Bt,jt=new At(1),Ut=new At(2),Lt=new At(5);new At(16),new At(8);var Ht=new At(10),Vt=new At(3);new At(7);var zt=new At(11),Wt=new At(4);new At(12);var Jt=null;function Qt(){if(Jt!==null)return Jt;var nr=1048576,ar=[];ar[0]=2;for(var ir=1,lr=3;lr<nr;lr+=2){for(var yr=Math.ceil(Math.sqrt(lr)),Sr=0;Sr<ir&&ar[Sr]<=yr&&lr%ar[Sr]!==0;Sr++);ir!==Sr&&ar[Sr]<=yr||(ar[ir++]=lr)}return Jt=ar,ar}function Xt(nr){for(var ar=Qt(),ir=0;ir<ar.length;ir++)if(nr.modn(ar[ir])===0)return nr.cmpn(ar[ir])===0;return!0}function tr(nr){var ar=At.mont(nr);return Ut.toRed(ar).redPow(nr.subn(1)).fromRed().cmpn(1)===0}function rr(nr,ar){if(nr<16)return ar===2||ar===5?new At([140,123]):new At([140,39]);ar=new At(ar);for(var ir,lr;;){for(ir=new At(kt(Math.ceil(nr/8)));ir.bitLength()>nr;)ir.ishrn(1);if(ir.isEven()&&ir.iadd(jt),ir.testn(1)||ir.iadd(Ut),ar.cmp(Ut)){if(!ar.cmp(Lt))for(;ir.mod(Ht).cmp(Vt);)ir.iadd(Wt)}else for(;ir.mod(xt).cmp(zt);)ir.iadd(Wt);if(lr=ir.shrn(1),Xt(lr)&&Xt(ir)&&tr(lr)&&tr(ir)&&Nt.test(lr)&&Nt.test(ir))return ir}}return generatePrime}const modp1={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"},require$$1$3={modp1,modp2,modp5,modp14,modp15,modp16,modp17,modp18};var dh,hasRequiredDh;function requireDh(){if(hasRequiredDh)return dh;hasRequiredDh=1;var kt=bnExports$1,At=requireMr(),xt=new At,Bt=new kt(24),Nt=new kt(11),jt=new kt(10),Ut=new kt(3),Lt=new kt(7),Ht=requireGeneratePrime(),Vt=browserExports$2;dh=Xt;function zt(rr,nr){return nr=nr||"utf8",buffer$2.Buffer.isBuffer(rr)||(rr=new buffer$2.Buffer(rr,nr)),this._pub=new kt(rr),this}function Wt(rr,nr){return nr=nr||"utf8",buffer$2.Buffer.isBuffer(rr)||(rr=new buffer$2.Buffer(rr,nr)),this._priv=new kt(rr),this}var Jt={};function Qt(rr,nr){var ar=nr.toString("hex"),ir=[ar,rr.toString(16)].join("_");if(ir in Jt)return Jt[ir];var lr=0;if(rr.isEven()||!Ht.simpleSieve||!Ht.fermatTest(rr)||!xt.test(rr))return lr+=1,ar==="02"||ar==="05"?lr+=8:lr+=4,Jt[ir]=lr,lr;xt.test(rr.shrn(1))||(lr+=2);var yr;switch(ar){case"02":rr.mod(Bt).cmp(Nt)&&(lr+=8);break;case"05":yr=rr.mod(jt),yr.cmp(Ut)&&yr.cmp(Lt)&&(lr+=8);break;default:lr+=4}return Jt[ir]=lr,lr}function Xt(rr,nr,ar){this.setGenerator(nr),this.__prime=new kt(rr),this._prime=kt.mont(this.__prime),this._primeLen=rr.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,ar?(this.setPublicKey=zt,this.setPrivateKey=Wt):this._primeCode=8}Object.defineProperty(Xt.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=Qt(this.__prime,this.__gen)),this._primeCode}}),Xt.prototype.generateKeys=function(){return this._priv||(this._priv=new kt(Vt(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},Xt.prototype.computeSecret=function(rr){rr=new kt(rr),rr=rr.toRed(this._prime);var nr=rr.redPow(this._priv).fromRed(),ar=new buffer$2.Buffer(nr.toArray()),ir=this.getPrime();if(ar.length<ir.length){var lr=new buffer$2.Buffer(ir.length-ar.length);lr.fill(0),ar=buffer$2.Buffer.concat([lr,ar])}return ar},Xt.prototype.getPublicKey=function(nr){return tr(this._pub,nr)},Xt.prototype.getPrivateKey=function(nr){return tr(this._priv,nr)},Xt.prototype.getPrime=function(rr){return tr(this.__prime,rr)},Xt.prototype.getGenerator=function(rr){return tr(this._gen,rr)},Xt.prototype.setGenerator=function(rr,nr){return nr=nr||"utf8",buffer$2.Buffer.isBuffer(rr)||(rr=new buffer$2.Buffer(rr,nr)),this.__gen=rr,this._gen=new kt(rr),this};function tr(rr,nr){var ar=new buffer$2.Buffer(rr.toArray());return nr?ar.toString(nr):ar}return dh}var hasRequiredBrowser$3;function requireBrowser$3(){if(hasRequiredBrowser$3)return browser$7;hasRequiredBrowser$3=1;var kt=requireGeneratePrime(),At=require$$1$3,xt=requireDh();function Bt(Ut){var Lt=new buffer$2.Buffer(At[Ut].prime,"hex"),Ht=new buffer$2.Buffer(At[Ut].gen,"hex");return new xt(Lt,Ht)}var Nt={binary:!0,hex:!0,base64:!0};function jt(Ut,Lt,Ht,Vt){return buffer$2.Buffer.isBuffer(Lt)||Nt[Lt]===void 0?jt(Ut,"binary",Lt,Ht):(Lt=Lt||"binary",Vt=Vt||"binary",Ht=Ht||new buffer$2.Buffer([2]),buffer$2.Buffer.isBuffer(Ht)||(Ht=new buffer$2.Buffer(Ht,Vt)),typeof Ut=="number"?new xt(kt(Ut,Ht),Ht,!0):(buffer$2.Buffer.isBuffer(Ut)||(Ut=new buffer$2.Buffer(Ut,Lt)),new xt(Ut,Ht,!0)))}return browser$7.DiffieHellmanGroup=browser$7.createDiffieHellmanGroup=browser$7.getDiffieHellman=Bt,browser$7.createDiffieHellman=browser$7.DiffieHellman=jt,browser$7}var readableBrowser={exports:{}},processNextickArgs={exports:{}};typeof process$9>"u"||!process$9.version||process$9.version.indexOf("v0.")===0||process$9.version.indexOf("v1.")===0&&process$9.version.indexOf("v1.8.")!==0?processNextickArgs.exports={nextTick:nextTick$2}:processNextickArgs.exports=process$9;function nextTick$2(kt,At,xt,Bt){if(typeof kt!="function")throw new TypeError('"callback" argument must be a function');var Nt=arguments.length,jt,Ut;switch(Nt){case 0:case 1:return process$9.nextTick(kt);case 2:return process$9.nextTick(function(){kt.call(null,At)});case 3:return process$9.nextTick(function(){kt.call(null,At,xt)});case 4:return process$9.nextTick(function(){kt.call(null,At,xt,Bt)});default:for(jt=new Array(Nt-1),Ut=0;Ut<jt.length;)jt[Ut++]=arguments[Ut];return process$9.nextTick(function(){kt.apply(null,jt)})}}var processNextickArgsExports=processNextickArgs.exports,toString$5={}.toString,isarray=Array.isArray||function(kt){return toString$5.call(kt)=="[object Array]"},streamBrowser=eventsExports.EventEmitter,safeBuffer$1={exports:{}};(function(kt,At){var xt=buffer$2,Bt=xt.Buffer;function Nt(Ut,Lt){for(var Ht in Ut)Lt[Ht]=Ut[Ht]}Bt.from&&Bt.alloc&&Bt.allocUnsafe&&Bt.allocUnsafeSlow?kt.exports=xt:(Nt(xt,At),At.Buffer=jt);function jt(Ut,Lt,Ht){return Bt(Ut,Lt,Ht)}Nt(Bt,jt),jt.from=function(Ut,Lt,Ht){if(typeof Ut=="number")throw new TypeError("Argument must not be a number");return Bt(Ut,Lt,Ht)},jt.alloc=function(Ut,Lt,Ht){if(typeof Ut!="number")throw new TypeError("Argument must be a number");var Vt=Bt(Ut);return Lt!==void 0?typeof Ht=="string"?Vt.fill(Lt,Ht):Vt.fill(Lt):Vt.fill(0),Vt},jt.allocUnsafe=function(Ut){if(typeof Ut!="number")throw new TypeError("Argument must be a number");return Bt(Ut)},jt.allocUnsafeSlow=function(Ut){if(typeof Ut!="number")throw new TypeError("Argument must be a number");return xt.SlowBuffer(Ut)}})(safeBuffer$1,safeBuffer$1.exports);var safeBufferExports=safeBuffer$1.exports,util$5={};function isArray(kt){return Array.isArray?Array.isArray(kt):objectToString$1(kt)==="[object Array]"}util$5.isArray=isArray;function isBoolean(kt){return typeof kt=="boolean"}util$5.isBoolean=isBoolean;function isNull(kt){return kt===null}util$5.isNull=isNull;function isNullOrUndefined(kt){return kt==null}util$5.isNullOrUndefined=isNullOrUndefined;function isNumber(kt){return typeof kt=="number"}util$5.isNumber=isNumber;function isString(kt){return typeof kt=="string"}util$5.isString=isString;function isSymbol(kt){return typeof kt=="symbol"}util$5.isSymbol=isSymbol;function isUndefined(kt){return kt===void 0}util$5.isUndefined=isUndefined;function isRegExp(kt){return objectToString$1(kt)==="[object RegExp]"}util$5.isRegExp=isRegExp;function isObject(kt){return typeof kt=="object"&&kt!==null}util$5.isObject=isObject;function isDate$1(kt){return objectToString$1(kt)==="[object Date]"}util$5.isDate=isDate$1;function isError$1(kt){return objectToString$1(kt)==="[object Error]"||kt instanceof Error}util$5.isError=isError$1;function isFunction(kt){return typeof kt=="function"}util$5.isFunction=isFunction;function isPrimitive(kt){return kt===null||typeof kt=="boolean"||typeof kt=="number"||typeof kt=="string"||typeof kt=="symbol"||typeof kt>"u"}util$5.isPrimitive=isPrimitive;util$5.isBuffer=buffer$2.Buffer.isBuffer;function objectToString$1(kt){return Object.prototype.toString.call(kt)}var BufferList={exports:{}},hasRequiredBufferList;function requireBufferList(){return hasRequiredBufferList||(hasRequiredBufferList=1,function(kt){function At(jt,Ut){if(!(jt instanceof Ut))throw new TypeError("Cannot call a class as a function")}var xt=safeBufferExports.Buffer,Bt=util$6;function Nt(jt,Ut,Lt){jt.copy(Ut,Lt)}kt.exports=function(){function jt(){At(this,jt),this.head=null,this.tail=null,this.length=0}return jt.prototype.push=function(Lt){var Ht={data:Lt,next:null};this.length>0?this.tail.next=Ht:this.head=Ht,this.tail=Ht,++this.length},jt.prototype.unshift=function(Lt){var Ht={data:Lt,next:this.head};this.length===0&&(this.tail=Ht),this.head=Ht,++this.length},jt.prototype.shift=function(){if(this.length!==0){var Lt=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,Lt}},jt.prototype.clear=function(){this.head=this.tail=null,this.length=0},jt.prototype.join=function(Lt){if(this.length===0)return"";for(var Ht=this.head,Vt=""+Ht.data;Ht=Ht.next;)Vt+=Lt+Ht.data;return Vt},jt.prototype.concat=function(Lt){if(this.length===0)return xt.alloc(0);for(var Ht=xt.allocUnsafe(Lt>>>0),Vt=this.head,zt=0;Vt;)Nt(Vt.data,Ht,zt),zt+=Vt.data.length,Vt=Vt.next;return Ht},jt}(),Bt&&Bt.inspect&&Bt.inspect.custom&&(kt.exports.prototype[Bt.inspect.custom]=function(){var jt=Bt.inspect({length:this.length});return this.constructor.name+" "+jt})}(BufferList)),BufferList.exports}var pna=processNextickArgsExports;function destroy$2(kt,At){var xt=this,Bt=this._readableState&&this._readableState.destroyed,Nt=this._writableState&&this._writableState.destroyed;return Bt||Nt?(At?At(kt):kt&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,pna.nextTick(emitErrorNT$2,this,kt)):pna.nextTick(emitErrorNT$2,this,kt)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(kt||null,function(jt){!At&&jt?xt._writableState?xt._writableState.errorEmitted||(xt._writableState.errorEmitted=!0,pna.nextTick(emitErrorNT$2,xt,jt)):pna.nextTick(emitErrorNT$2,xt,jt):At&&At(jt)}),this)}function undestroy$2(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT$2(kt,At){kt.emit("error",At)}var destroy_1$2={destroy:destroy$2,undestroy:undestroy$2},_stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1;var kt=processNextickArgsExports;_stream_writable=tr;function At(wr){var Er=this;this.next=null,this.entry=null,this.finish=function(){$r(Er,wr)}}var xt=!process$9.browser&&["v0.10","v0.9."].indexOf(process$9.version.slice(0,5))>-1?setImmediate:kt.nextTick,Bt;tr.WritableState=Qt;var Nt=Object.create(util$5);Nt.inherits=inherits_browserExports;var jt={deprecate:browser$d},Ut=streamBrowser,Lt=safeBufferExports.Buffer,Ht=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Vt(wr){return Lt.from(wr)}function zt(wr){return Lt.isBuffer(wr)||wr instanceof Ht}var Wt=destroy_1$2;Nt.inherits(tr,Ut);function Jt(){}function Qt(wr,Er){Bt=Bt||require_stream_duplex(),wr=wr||{};var gr=Er instanceof Bt;this.objectMode=!!wr.objectMode,gr&&(this.objectMode=this.objectMode||!!wr.writableObjectMode);var fr=wr.highWaterMark,br=wr.writableHighWaterMark,_r=this.objectMode?16:16*1024;fr||fr===0?this.highWaterMark=fr:gr&&(br||br===0)?this.highWaterMark=br:this.highWaterMark=_r,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Tr=wr.decodeStrings===!1;this.decodeStrings=!Tr,this.defaultEncoding=wr.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Pr){Ar(Er,Pr)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new At(this)}Qt.prototype.getBuffer=function(){for(var Er=this.bufferedRequest,gr=[];Er;)gr.push(Er),Er=Er.next;return gr},function(){try{Object.defineProperty(Qt.prototype,"buffer",{get:jt.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Xt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Xt=Function.prototype[Symbol.hasInstance],Object.defineProperty(tr,Symbol.hasInstance,{value:function(wr){return Xt.call(this,wr)?!0:this!==tr?!1:wr&&wr._writableState instanceof Qt}})):Xt=function(wr){return wr instanceof this};function tr(wr){if(Bt=Bt||require_stream_duplex(),!Xt.call(tr,this)&&!(this instanceof Bt))return new tr(wr);this._writableState=new Qt(wr,this),this.writable=!0,wr&&(typeof wr.write=="function"&&(this._write=wr.write),typeof wr.writev=="function"&&(this._writev=wr.writev),typeof wr.destroy=="function"&&(this._destroy=wr.destroy),typeof wr.final=="function"&&(this._final=wr.final)),Ut.call(this)}tr.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function rr(wr,Er){var gr=new Error("write after end");wr.emit("error",gr),kt.nextTick(Er,gr)}function nr(wr,Er,gr,fr){var br=!0,_r=!1;return gr===null?_r=new TypeError("May not write null values to stream"):typeof gr!="string"&&gr!==void 0&&!Er.objectMode&&(_r=new TypeError("Invalid non-string/buffer chunk")),_r&&(wr.emit("error",_r),kt.nextTick(fr,_r),br=!1),br}tr.prototype.write=function(wr,Er,gr){var fr=this._writableState,br=!1,_r=!fr.objectMode&&zt(wr);return _r&&!Lt.isBuffer(wr)&&(wr=Vt(wr)),typeof Er=="function"&&(gr=Er,Er=null),_r?Er="buffer":Er||(Er=fr.defaultEncoding),typeof gr!="function"&&(gr=Jt),fr.ended?rr(this,gr):(_r||nr(this,fr,wr,gr))&&(fr.pendingcb++,br=ir(this,fr,_r,wr,Er,gr)),br},tr.prototype.cork=function(){var wr=this._writableState;wr.corked++},tr.prototype.uncork=function(){var wr=this._writableState;wr.corked&&(wr.corked--,!wr.writing&&!wr.corked&&!wr.bufferProcessing&&wr.bufferedRequest&&Lr(this,wr))},tr.prototype.setDefaultEncoding=function(Er){if(typeof Er=="string"&&(Er=Er.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Er+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+Er);return this._writableState.defaultEncoding=Er,this};function ar(wr,Er,gr){return!wr.objectMode&&wr.decodeStrings!==!1&&typeof Er=="string"&&(Er=Lt.from(Er,gr)),Er}Object.defineProperty(tr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ir(wr,Er,gr,fr,br,_r){if(!gr){var Tr=ar(Er,fr,br);fr!==Tr&&(gr=!0,br="buffer",fr=Tr)}var Pr=Er.objectMode?1:fr.length;Er.length+=Pr;var Nr=Er.length<Er.highWaterMark;if(Nr||(Er.needDrain=!0),Er.writing||Er.corked){var Cr=Er.lastBufferedRequest;Er.lastBufferedRequest={chunk:fr,encoding:br,isBuf:gr,callback:_r,next:null},Cr?Cr.next=Er.lastBufferedRequest:Er.bufferedRequest=Er.lastBufferedRequest,Er.bufferedRequestCount+=1}else lr(wr,Er,!1,Pr,fr,br,_r);return Nr}function lr(wr,Er,gr,fr,br,_r,Tr){Er.writelen=fr,Er.writecb=Tr,Er.writing=!0,Er.sync=!0,gr?wr._writev(br,Er.onwrite):wr._write(br,_r,Er.onwrite),Er.sync=!1}function yr(wr,Er,gr,fr,br){--Er.pendingcb,gr?(kt.nextTick(br,fr),kt.nextTick(dr,wr,Er),wr._writableState.errorEmitted=!0,wr.emit("error",fr)):(br(fr),wr._writableState.errorEmitted=!0,wr.emit("error",fr),dr(wr,Er))}function Sr(wr){wr.writing=!1,wr.writecb=null,wr.length-=wr.writelen,wr.writelen=0}function Ar(wr,Er){var gr=wr._writableState,fr=gr.sync,br=gr.writecb;if(Sr(gr),Er)yr(wr,gr,fr,Er,br);else{var _r=Or(gr);!_r&&!gr.corked&&!gr.bufferProcessing&&gr.bufferedRequest&&Lr(wr,gr),fr?xt(Dr,wr,gr,_r,br):Dr(wr,gr,_r,br)}}function Dr(wr,Er,gr,fr){gr||Br(wr,Er),Er.pendingcb--,fr(),dr(wr,Er)}function Br(wr,Er){Er.length===0&&Er.needDrain&&(Er.needDrain=!1,wr.emit("drain"))}function Lr(wr,Er){Er.bufferProcessing=!0;var gr=Er.bufferedRequest;if(wr._writev&&gr&&gr.next){var fr=Er.bufferedRequestCount,br=new Array(fr),_r=Er.corkedRequestsFree;_r.entry=gr;for(var Tr=0,Pr=!0;gr;)br[Tr]=gr,gr.isBuf||(Pr=!1),gr=gr.next,Tr+=1;br.allBuffers=Pr,lr(wr,Er,!0,Er.length,br,"",_r.finish),Er.pendingcb++,Er.lastBufferedRequest=null,_r.next?(Er.corkedRequestsFree=_r.next,_r.next=null):Er.corkedRequestsFree=new At(Er),Er.bufferedRequestCount=0}else{for(;gr;){var Nr=gr.chunk,Cr=gr.encoding,xr=gr.callback,Rr=Er.objectMode?1:Nr.length;if(lr(wr,Er,!1,Rr,Nr,Cr,xr),gr=gr.next,Er.bufferedRequestCount--,Er.writing)break}gr===null&&(Er.lastBufferedRequest=null)}Er.bufferedRequest=gr,Er.bufferProcessing=!1}tr.prototype._write=function(wr,Er,gr){gr(new Error("_write() is not implemented"))},tr.prototype._writev=null,tr.prototype.end=function(wr,Er,gr){var fr=this._writableState;typeof wr=="function"?(gr=wr,wr=null,Er=null):typeof Er=="function"&&(gr=Er,Er=null),wr!=null&&this.write(wr,Er),fr.corked&&(fr.corked=1,this.uncork()),fr.ending||ur(this,fr,gr)};function Or(wr){return wr.ending&&wr.length===0&&wr.bufferedRequest===null&&!wr.finished&&!wr.writing}function vr(wr,Er){wr._final(function(gr){Er.pendingcb--,gr&&wr.emit("error",gr),Er.prefinished=!0,wr.emit("prefinish"),dr(wr,Er)})}function pr(wr,Er){!Er.prefinished&&!Er.finalCalled&&(typeof wr._final=="function"?(Er.pendingcb++,Er.finalCalled=!0,kt.nextTick(vr,wr,Er)):(Er.prefinished=!0,wr.emit("prefinish")))}function dr(wr,Er){var gr=Or(Er);return gr&&(pr(wr,Er),Er.pendingcb===0&&(Er.finished=!0,wr.emit("finish"))),gr}function ur(wr,Er,gr){Er.ending=!0,dr(wr,Er),gr&&(Er.finished?kt.nextTick(gr):wr.once("finish",gr)),Er.ended=!0,wr.writable=!1}function $r(wr,Er,gr){var fr=wr.entry;for(wr.entry=null;fr;){var br=fr.callback;Er.pendingcb--,br(gr),fr=fr.next}Er.corkedRequestsFree.next=wr}return Object.defineProperty(tr.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(wr){this._writableState&&(this._writableState.destroyed=wr)}}),tr.prototype.destroy=Wt.destroy,tr.prototype._undestroy=Wt.undestroy,tr.prototype._destroy=function(wr,Er){this.end(),Er(wr)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var kt=processNextickArgsExports,At=Object.keys||function(Wt){var Jt=[];for(var Qt in Wt)Jt.push(Qt);return Jt};_stream_duplex=Ht;var xt=Object.create(util$5);xt.inherits=inherits_browserExports;var Bt=require_stream_readable(),Nt=require_stream_writable();xt.inherits(Ht,Bt);for(var jt=At(Nt.prototype),Ut=0;Ut<jt.length;Ut++){var Lt=jt[Ut];Ht.prototype[Lt]||(Ht.prototype[Lt]=Nt.prototype[Lt])}function Ht(Wt){if(!(this instanceof Ht))return new Ht(Wt);Bt.call(this,Wt),Nt.call(this,Wt),Wt&&Wt.readable===!1&&(this.readable=!1),Wt&&Wt.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,Wt&&Wt.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",Vt)}Object.defineProperty(Ht.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Vt(){this.allowHalfOpen||this._writableState.ended||kt.nextTick(zt,this)}function zt(Wt){Wt.end()}return Object.defineProperty(Ht.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(Wt){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=Wt,this._writableState.destroyed=Wt)}}),Ht.prototype._destroy=function(Wt,Jt){this.push(null),this.end(),kt.nextTick(Jt,Wt)},_stream_duplex}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1;var kt=processNextickArgsExports;_stream_readable=ar;var At=isarray,xt;ar.ReadableState=nr,eventsExports.EventEmitter;var Bt=function(xr,Rr){return xr.listeners(Rr).length},Nt=streamBrowser,jt=safeBufferExports.Buffer,Ut=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Lt(xr){return jt.from(xr)}function Ht(xr){return jt.isBuffer(xr)||xr instanceof Ut}var Vt=Object.create(util$5);Vt.inherits=inherits_browserExports;var zt=util$6,Wt=void 0;zt&&zt.debuglog?Wt=zt.debuglog("stream"):Wt=function(){};var Jt=requireBufferList(),Qt=destroy_1$2,Xt;Vt.inherits(ar,Nt);var tr=["error","close","destroy","pause","resume"];function rr(xr,Rr,qr){if(typeof xr.prependListener=="function")return xr.prependListener(Rr,qr);!xr._events||!xr._events[Rr]?xr.on(Rr,qr):At(xr._events[Rr])?xr._events[Rr].unshift(qr):xr._events[Rr]=[qr,xr._events[Rr]]}function nr(xr,Rr){xt=xt||require_stream_duplex(),xr=xr||{};var qr=Rr instanceof xt;this.objectMode=!!xr.objectMode,qr&&(this.objectMode=this.objectMode||!!xr.readableObjectMode);var Vr=xr.highWaterMark,Gr=xr.readableHighWaterMark,Ur=this.objectMode?16:16*1024;Vr||Vr===0?this.highWaterMark=Vr:qr&&(Gr||Gr===0)?this.highWaterMark=Gr:this.highWaterMark=Ur,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new Jt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=xr.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,xr.encoding&&(Xt||(Xt=requireString_decoder().StringDecoder),this.decoder=new Xt(xr.encoding),this.encoding=xr.encoding)}function ar(xr){if(xt=xt||require_stream_duplex(),!(this instanceof ar))return new ar(xr);this._readableState=new nr(xr,this),this.readable=!0,xr&&(typeof xr.read=="function"&&(this._read=xr.read),typeof xr.destroy=="function"&&(this._destroy=xr.destroy)),Nt.call(this)}Object.defineProperty(ar.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(xr){this._readableState&&(this._readableState.destroyed=xr)}}),ar.prototype.destroy=Qt.destroy,ar.prototype._undestroy=Qt.undestroy,ar.prototype._destroy=function(xr,Rr){this.push(null),Rr(xr)},ar.prototype.push=function(xr,Rr){var qr=this._readableState,Vr;return qr.objectMode?Vr=!0:typeof xr=="string"&&(Rr=Rr||qr.defaultEncoding,Rr!==qr.encoding&&(xr=jt.from(xr,Rr),Rr=""),Vr=!0),ir(this,xr,Rr,!1,Vr)},ar.prototype.unshift=function(xr){return ir(this,xr,null,!0,!1)};function ir(xr,Rr,qr,Vr,Gr){var Ur=xr._readableState;if(Rr===null)Ur.reading=!1,Lr(xr,Ur);else{var kr;Gr||(kr=yr(Ur,Rr)),kr?xr.emit("error",kr):Ur.objectMode||Rr&&Rr.length>0?(typeof Rr!="string"&&!Ur.objectMode&&Object.getPrototypeOf(Rr)!==jt.prototype&&(Rr=Lt(Rr)),Vr?Ur.endEmitted?xr.emit("error",new Error("stream.unshift() after end event")):lr(xr,Ur,Rr,!0):Ur.ended?xr.emit("error",new Error("stream.push() after EOF")):(Ur.reading=!1,Ur.decoder&&!qr?(Rr=Ur.decoder.write(Rr),Ur.objectMode||Rr.length!==0?lr(xr,Ur,Rr,!1):pr(xr,Ur)):lr(xr,Ur,Rr,!1))):Vr||(Ur.reading=!1)}return Sr(Ur)}function lr(xr,Rr,qr,Vr){Rr.flowing&&Rr.length===0&&!Rr.sync?(xr.emit("data",qr),xr.read(0)):(Rr.length+=Rr.objectMode?1:qr.length,Vr?Rr.buffer.unshift(qr):Rr.buffer.push(qr),Rr.needReadable&&Or(xr)),pr(xr,Rr)}function yr(xr,Rr){var qr;return!Ht(Rr)&&typeof Rr!="string"&&Rr!==void 0&&!xr.objectMode&&(qr=new TypeError("Invalid non-string/buffer chunk")),qr}function Sr(xr){return!xr.ended&&(xr.needReadable||xr.length<xr.highWaterMark||xr.length===0)}ar.prototype.isPaused=function(){return this._readableState.flowing===!1},ar.prototype.setEncoding=function(xr){return Xt||(Xt=requireString_decoder().StringDecoder),this._readableState.decoder=new Xt(xr),this._readableState.encoding=xr,this};var Ar=8388608;function Dr(xr){return xr>=Ar?xr=Ar:(xr--,xr|=xr>>>1,xr|=xr>>>2,xr|=xr>>>4,xr|=xr>>>8,xr|=xr>>>16,xr++),xr}function Br(xr,Rr){return xr<=0||Rr.length===0&&Rr.ended?0:Rr.objectMode?1:xr!==xr?Rr.flowing&&Rr.length?Rr.buffer.head.data.length:Rr.length:(xr>Rr.highWaterMark&&(Rr.highWaterMark=Dr(xr)),xr<=Rr.length?xr:Rr.ended?Rr.length:(Rr.needReadable=!0,0))}ar.prototype.read=function(xr){Wt("read",xr),xr=parseInt(xr,10);var Rr=this._readableState,qr=xr;if(xr!==0&&(Rr.emittedReadable=!1),xr===0&&Rr.needReadable&&(Rr.length>=Rr.highWaterMark||Rr.ended))return Wt("read: emitReadable",Rr.length,Rr.ended),Rr.length===0&&Rr.ended?Pr(this):Or(this),null;if(xr=Br(xr,Rr),xr===0&&Rr.ended)return Rr.length===0&&Pr(this),null;var Vr=Rr.needReadable;Wt("need readable",Vr),(Rr.length===0||Rr.length-xr<Rr.highWaterMark)&&(Vr=!0,Wt("length less than watermark",Vr)),Rr.ended||Rr.reading?(Vr=!1,Wt("reading or ended",Vr)):Vr&&(Wt("do read"),Rr.reading=!0,Rr.sync=!0,Rr.length===0&&(Rr.needReadable=!0),this._read(Rr.highWaterMark),Rr.sync=!1,Rr.reading||(xr=Br(qr,Rr)));var Gr;return xr>0?Gr=fr(xr,Rr):Gr=null,Gr===null?(Rr.needReadable=!0,xr=0):Rr.length-=xr,Rr.length===0&&(Rr.ended||(Rr.needReadable=!0),qr!==xr&&Rr.ended&&Pr(this)),Gr!==null&&this.emit("data",Gr),Gr};function Lr(xr,Rr){if(!Rr.ended){if(Rr.decoder){var qr=Rr.decoder.end();qr&&qr.length&&(Rr.buffer.push(qr),Rr.length+=Rr.objectMode?1:qr.length)}Rr.ended=!0,Or(xr)}}function Or(xr){var Rr=xr._readableState;Rr.needReadable=!1,Rr.emittedReadable||(Wt("emitReadable",Rr.flowing),Rr.emittedReadable=!0,Rr.sync?kt.nextTick(vr,xr):vr(xr))}function vr(xr){Wt("emit readable"),xr.emit("readable"),gr(xr)}function pr(xr,Rr){Rr.readingMore||(Rr.readingMore=!0,kt.nextTick(dr,xr,Rr))}function dr(xr,Rr){for(var qr=Rr.length;!Rr.reading&&!Rr.flowing&&!Rr.ended&&Rr.length<Rr.highWaterMark&&(Wt("maybeReadMore read 0"),xr.read(0),qr!==Rr.length);)qr=Rr.length;Rr.readingMore=!1}ar.prototype._read=function(xr){this.emit("error",new Error("_read() is not implemented"))},ar.prototype.pipe=function(xr,Rr){var qr=this,Vr=this._readableState;switch(Vr.pipesCount){case 0:Vr.pipes=xr;break;case 1:Vr.pipes=[Vr.pipes,xr];break;default:Vr.pipes.push(xr);break}Vr.pipesCount+=1,Wt("pipe count=%d opts=%j",Vr.pipesCount,Rr);var Gr=(!Rr||Rr.end!==!1)&&xr!==process$9.stdout&&xr!==process$9.stderr,Ur=Gr?Fr:fn;Vr.endEmitted?kt.nextTick(Ur):qr.once("end",Ur),xr.on("unpipe",kr);function kr(hn,Jr){Wt("onunpipe"),hn===qr&&Jr&&Jr.hasUnpiped===!1&&(Jr.hasUnpiped=!0,Ir())}function Fr(){Wt("onend"),xr.end()}var Wr=ur(qr);xr.on("drain",Wr);var jr=!1;function Ir(){Wt("cleanup"),xr.removeListener("close",on),xr.removeListener("finish",nn),xr.removeListener("drain",Wr),xr.removeListener("error",Qr),xr.removeListener("unpipe",kr),qr.removeListener("end",Fr),qr.removeListener("end",fn),qr.removeListener("data",Hr),jr=!0,Vr.awaitDrain&&(!xr._writableState||xr._writableState.needDrain)&&Wr()}var Mr=!1;qr.on("data",Hr);function Hr(hn){Wt("ondata"),Mr=!1;var Jr=xr.write(hn);Jr===!1&&!Mr&&((Vr.pipesCount===1&&Vr.pipes===xr||Vr.pipesCount>1&&Cr(Vr.pipes,xr)!==-1)&&!jr&&(Wt("false write response, pause",Vr.awaitDrain),Vr.awaitDrain++,Mr=!0),qr.pause())}function Qr(hn){Wt("onerror",hn),fn(),xr.removeListener("error",Qr),Bt(xr,"error")===0&&xr.emit("error",hn)}rr(xr,"error",Qr);function on(){xr.removeListener("finish",nn),fn()}xr.once("close",on);function nn(){Wt("onfinish"),xr.removeListener("close",on),fn()}xr.once("finish",nn);function fn(){Wt("unpipe"),qr.unpipe(xr)}return xr.emit("pipe",qr),Vr.flowing||(Wt("pipe resume"),qr.resume()),xr};function ur(xr){return function(){var Rr=xr._readableState;Wt("pipeOnDrain",Rr.awaitDrain),Rr.awaitDrain&&Rr.awaitDrain--,Rr.awaitDrain===0&&Bt(xr,"data")&&(Rr.flowing=!0,gr(xr))}}ar.prototype.unpipe=function(xr){var Rr=this._readableState,qr={hasUnpiped:!1};if(Rr.pipesCount===0)return this;if(Rr.pipesCount===1)return xr&&xr!==Rr.pipes?this:(xr||(xr=Rr.pipes),Rr.pipes=null,Rr.pipesCount=0,Rr.flowing=!1,xr&&xr.emit("unpipe",this,qr),this);if(!xr){var Vr=Rr.pipes,Gr=Rr.pipesCount;Rr.pipes=null,Rr.pipesCount=0,Rr.flowing=!1;for(var Ur=0;Ur<Gr;Ur++)Vr[Ur].emit("unpipe",this,{hasUnpiped:!1});return this}var kr=Cr(Rr.pipes,xr);return kr===-1?this:(Rr.pipes.splice(kr,1),Rr.pipesCount-=1,Rr.pipesCount===1&&(Rr.pipes=Rr.pipes[0]),xr.emit("unpipe",this,qr),this)},ar.prototype.on=function(xr,Rr){var qr=Nt.prototype.on.call(this,xr,Rr);if(xr==="data")this._readableState.flowing!==!1&&this.resume();else if(xr==="readable"){var Vr=this._readableState;!Vr.endEmitted&&!Vr.readableListening&&(Vr.readableListening=Vr.needReadable=!0,Vr.emittedReadable=!1,Vr.reading?Vr.length&&Or(this):kt.nextTick($r,this))}return qr},ar.prototype.addListener=ar.prototype.on;function $r(xr){Wt("readable nexttick read 0"),xr.read(0)}ar.prototype.resume=function(){var xr=this._readableState;return xr.flowing||(Wt("resume"),xr.flowing=!0,wr(this,xr)),this};function wr(xr,Rr){Rr.resumeScheduled||(Rr.resumeScheduled=!0,kt.nextTick(Er,xr,Rr))}function Er(xr,Rr){Rr.reading||(Wt("resume read 0"),xr.read(0)),Rr.resumeScheduled=!1,Rr.awaitDrain=0,xr.emit("resume"),gr(xr),Rr.flowing&&!Rr.reading&&xr.read(0)}ar.prototype.pause=function(){return Wt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Wt("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function gr(xr){var Rr=xr._readableState;for(Wt("flow",Rr.flowing);Rr.flowing&&xr.read()!==null;);}ar.prototype.wrap=function(xr){var Rr=this,qr=this._readableState,Vr=!1;xr.on("end",function(){if(Wt("wrapped end"),qr.decoder&&!qr.ended){var kr=qr.decoder.end();kr&&kr.length&&Rr.push(kr)}Rr.push(null)}),xr.on("data",function(kr){if(Wt("wrapped data"),qr.decoder&&(kr=qr.decoder.write(kr)),!(qr.objectMode&&kr==null)&&!(!qr.objectMode&&(!kr||!kr.length))){var Fr=Rr.push(kr);Fr||(Vr=!0,xr.pause())}});for(var Gr in xr)this[Gr]===void 0&&typeof xr[Gr]=="function"&&(this[Gr]=function(kr){return function(){return xr[kr].apply(xr,arguments)}}(Gr));for(var Ur=0;Ur<tr.length;Ur++)xr.on(tr[Ur],this.emit.bind(this,tr[Ur]));return this._read=function(kr){Wt("wrapped _read",kr),Vr&&(Vr=!1,xr.resume())},this},Object.defineProperty(ar.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),ar._fromList=fr;function fr(xr,Rr){if(Rr.length===0)return null;var qr;return Rr.objectMode?qr=Rr.buffer.shift():!xr||xr>=Rr.length?(Rr.decoder?qr=Rr.buffer.join(""):Rr.buffer.length===1?qr=Rr.buffer.head.data:qr=Rr.buffer.concat(Rr.length),Rr.buffer.clear()):qr=br(xr,Rr.buffer,Rr.decoder),qr}function br(xr,Rr,qr){var Vr;return xr<Rr.head.data.length?(Vr=Rr.head.data.slice(0,xr),Rr.head.data=Rr.head.data.slice(xr)):xr===Rr.head.data.length?Vr=Rr.shift():Vr=qr?_r(xr,Rr):Tr(xr,Rr),Vr}function _r(xr,Rr){var qr=Rr.head,Vr=1,Gr=qr.data;for(xr-=Gr.length;qr=qr.next;){var Ur=qr.data,kr=xr>Ur.length?Ur.length:xr;if(kr===Ur.length?Gr+=Ur:Gr+=Ur.slice(0,xr),xr-=kr,xr===0){kr===Ur.length?(++Vr,qr.next?Rr.head=qr.next:Rr.head=Rr.tail=null):(Rr.head=qr,qr.data=Ur.slice(kr));break}++Vr}return Rr.length-=Vr,Gr}function Tr(xr,Rr){var qr=jt.allocUnsafe(xr),Vr=Rr.head,Gr=1;for(Vr.data.copy(qr),xr-=Vr.data.length;Vr=Vr.next;){var Ur=Vr.data,kr=xr>Ur.length?Ur.length:xr;if(Ur.copy(qr,qr.length-xr,0,kr),xr-=kr,xr===0){kr===Ur.length?(++Gr,Vr.next?Rr.head=Vr.next:Rr.head=Rr.tail=null):(Rr.head=Vr,Vr.data=Ur.slice(kr));break}++Gr}return Rr.length-=Gr,qr}function Pr(xr){var Rr=xr._readableState;if(Rr.length>0)throw new Error('"endReadable()" called on non-empty stream');Rr.endEmitted||(Rr.ended=!0,kt.nextTick(Nr,Rr,xr))}function Nr(xr,Rr){!xr.endEmitted&&xr.length===0&&(xr.endEmitted=!0,Rr.readable=!1,Rr.emit("end"))}function Cr(xr,Rr){for(var qr=0,Vr=xr.length;qr<Vr;qr++)if(xr[qr]===Rr)return qr;return-1}return _stream_readable}var _stream_transform=Transform$5,Duplex$6=require_stream_duplex(),util$4=Object.create(util$5);util$4.inherits=inherits_browserExports;util$4.inherits(Transform$5,Duplex$6);function afterTransform(kt,At){var xt=this._transformState;xt.transforming=!1;var Bt=xt.writecb;if(!Bt)return this.emit("error",new Error("write callback called multiple times"));xt.writechunk=null,xt.writecb=null,At!=null&&this.push(At),Bt(kt);var Nt=this._readableState;Nt.reading=!1,(Nt.needReadable||Nt.length<Nt.highWaterMark)&&this._read(Nt.highWaterMark)}function Transform$5(kt){if(!(this instanceof Transform$5))return new Transform$5(kt);Duplex$6.call(this,kt),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,kt&&(typeof kt.transform=="function"&&(this._transform=kt.transform),typeof kt.flush=="function"&&(this._flush=kt.flush)),this.on("prefinish",prefinish$2)}function prefinish$2(){var kt=this;typeof this._flush=="function"?this._flush(function(At,xt){done(kt,At,xt)}):done(this,null,null)}Transform$5.prototype.push=function(kt,At){return this._transformState.needTransform=!1,Duplex$6.prototype.push.call(this,kt,At)};Transform$5.prototype._transform=function(kt,At,xt){throw new Error("_transform() is not implemented")};Transform$5.prototype._write=function(kt,At,xt){var Bt=this._transformState;if(Bt.writecb=xt,Bt.writechunk=kt,Bt.writeencoding=At,!Bt.transforming){var Nt=this._readableState;(Bt.needTransform||Nt.needReadable||Nt.length<Nt.highWaterMark)&&this._read(Nt.highWaterMark)}};Transform$5.prototype._read=function(kt){var At=this._transformState;At.writechunk!==null&&At.writecb&&!At.transforming?(At.transforming=!0,this._transform(At.writechunk,At.writeencoding,At.afterTransform)):At.needTransform=!0};Transform$5.prototype._destroy=function(kt,At){var xt=this;Duplex$6.prototype._destroy.call(this,kt,function(Bt){At(Bt),xt.emit("close")})};function done(kt,At,xt){if(At)return kt.emit("error",At);if(xt!=null&&kt.push(xt),kt._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(kt._transformState.transforming)throw new Error("Calling transform done when still transforming");return kt.push(null)}var _stream_passthrough=PassThrough$4,Transform$4=_stream_transform,util$3=Object.create(util$5);util$3.inherits=inherits_browserExports;util$3.inherits(PassThrough$4,Transform$4);function PassThrough$4(kt){if(!(this instanceof PassThrough$4))return new PassThrough$4(kt);Transform$4.call(this,kt)}PassThrough$4.prototype._transform=function(kt,At,xt){xt(null,kt)};(function(kt,At){At=kt.exports=require_stream_readable(),At.Stream=At,At.Readable=At,At.Writable=require_stream_writable(),At.Duplex=require_stream_duplex(),At.Transform=_stream_transform,At.PassThrough=_stream_passthrough})(readableBrowser,readableBrowser.exports);var readableBrowserExports=readableBrowser.exports,sign={exports:{}},bn={exports:{}};bn.exports;(function(kt){(function(At,xt){function Bt(pr,dr){if(!pr)throw new Error(dr||"Assertion failed")}function Nt(pr,dr){pr.super_=dr;var ur=function(){};ur.prototype=dr.prototype,pr.prototype=new ur,pr.prototype.constructor=pr}function jt(pr,dr,ur){if(jt.isBN(pr))return pr;this.negative=0,this.words=null,this.length=0,this.red=null,pr!==null&&((dr==="le"||dr==="be")&&(ur=dr,dr=10),this._init(pr||0,dr||10,ur||"be"))}typeof At=="object"?At.exports=jt:xt.BN=jt,jt.BN=jt,jt.wordSize=26;var Ut;try{typeof window<"u"&&typeof window.Buffer<"u"?Ut=window.Buffer:Ut=buffer$2.Buffer}catch{}jt.isBN=function(dr){return dr instanceof jt?!0:dr!==null&&typeof dr=="object"&&dr.constructor.wordSize===jt.wordSize&&Array.isArray(dr.words)},jt.max=function(dr,ur){return dr.cmp(ur)>0?dr:ur},jt.min=function(dr,ur){return dr.cmp(ur)<0?dr:ur},jt.prototype._init=function(dr,ur,$r){if(typeof dr=="number")return this._initNumber(dr,ur,$r);if(typeof dr=="object")return this._initArray(dr,ur,$r);ur==="hex"&&(ur=16),Bt(ur===(ur|0)&&ur>=2&&ur<=36),dr=dr.toString().replace(/\s+/g,"");var wr=0;dr[0]==="-"&&(wr++,this.negative=1),wr<dr.length&&(ur===16?this._parseHex(dr,wr,$r):(this._parseBase(dr,ur,wr),$r==="le"&&this._initArray(this.toArray(),ur,$r)))},jt.prototype._initNumber=function(dr,ur,$r){dr<0&&(this.negative=1,dr=-dr),dr<67108864?(this.words=[dr&67108863],this.length=1):dr<4503599627370496?(this.words=[dr&67108863,dr/67108864&67108863],this.length=2):(Bt(dr<9007199254740992),this.words=[dr&67108863,dr/67108864&67108863,1],this.length=3),$r==="le"&&this._initArray(this.toArray(),ur,$r)},jt.prototype._initArray=function(dr,ur,$r){if(Bt(typeof dr.length=="number"),dr.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(dr.length/3),this.words=new Array(this.length);for(var wr=0;wr<this.length;wr++)this.words[wr]=0;var Er,gr,fr=0;if($r==="be")for(wr=dr.length-1,Er=0;wr>=0;wr-=3)gr=dr[wr]|dr[wr-1]<<8|dr[wr-2]<<16,this.words[Er]|=gr<<fr&67108863,this.words[Er+1]=gr>>>26-fr&67108863,fr+=24,fr>=26&&(fr-=26,Er++);else if($r==="le")for(wr=0,Er=0;wr<dr.length;wr+=3)gr=dr[wr]|dr[wr+1]<<8|dr[wr+2]<<16,this.words[Er]|=gr<<fr&67108863,this.words[Er+1]=gr>>>26-fr&67108863,fr+=24,fr>=26&&(fr-=26,Er++);return this._strip()};function Lt(pr,dr){var ur=pr.charCodeAt(dr);if(ur>=48&&ur<=57)return ur-48;if(ur>=65&&ur<=70)return ur-55;if(ur>=97&&ur<=102)return ur-87;Bt(!1,"Invalid character in "+pr)}function Ht(pr,dr,ur){var $r=Lt(pr,ur);return ur-1>=dr&&($r|=Lt(pr,ur-1)<<4),$r}jt.prototype._parseHex=function(dr,ur,$r){this.length=Math.ceil((dr.length-ur)/6),this.words=new Array(this.length);for(var wr=0;wr<this.length;wr++)this.words[wr]=0;var Er=0,gr=0,fr;if($r==="be")for(wr=dr.length-1;wr>=ur;wr-=2)fr=Ht(dr,ur,wr)<<Er,this.words[gr]|=fr&67108863,Er>=18?(Er-=18,gr+=1,this.words[gr]|=fr>>>26):Er+=8;else{var br=dr.length-ur;for(wr=br%2===0?ur+1:ur;wr<dr.length;wr+=2)fr=Ht(dr,ur,wr)<<Er,this.words[gr]|=fr&67108863,Er>=18?(Er-=18,gr+=1,this.words[gr]|=fr>>>26):Er+=8}this._strip()};function Vt(pr,dr,ur,$r){for(var wr=0,Er=0,gr=Math.min(pr.length,ur),fr=dr;fr<gr;fr++){var br=pr.charCodeAt(fr)-48;wr*=$r,br>=49?Er=br-49+10:br>=17?Er=br-17+10:Er=br,Bt(br>=0&&Er<$r,"Invalid character"),wr+=Er}return wr}jt.prototype._parseBase=function(dr,ur,$r){this.words=[0],this.length=1;for(var wr=0,Er=1;Er<=67108863;Er*=ur)wr++;wr--,Er=Er/ur|0;for(var gr=dr.length-$r,fr=gr%wr,br=Math.min(gr,gr-fr)+$r,_r=0,Tr=$r;Tr<br;Tr+=wr)_r=Vt(dr,Tr,Tr+wr,ur),this.imuln(Er),this.words[0]+_r<67108864?this.words[0]+=_r:this._iaddn(_r);if(fr!==0){var Pr=1;for(_r=Vt(dr,Tr,dr.length,ur),Tr=0;Tr<fr;Tr++)Pr*=ur;this.imuln(Pr),this.words[0]+_r<67108864?this.words[0]+=_r:this._iaddn(_r)}this._strip()},jt.prototype.copy=function(dr){dr.words=new Array(this.length);for(var ur=0;ur<this.length;ur++)dr.words[ur]=this.words[ur];dr.length=this.length,dr.negative=this.negative,dr.red=this.red};function zt(pr,dr){pr.words=dr.words,pr.length=dr.length,pr.negative=dr.negative,pr.red=dr.red}if(jt.prototype._move=function(dr){zt(dr,this)},jt.prototype.clone=function(){var dr=new jt(null);return this.copy(dr),dr},jt.prototype._expand=function(dr){for(;this.length<dr;)this.words[this.length++]=0;return this},jt.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},jt.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{jt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Wt}catch{jt.prototype.inspect=Wt}else jt.prototype.inspect=Wt;function Wt(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var Jt=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],Qt=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],Xt=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];jt.prototype.toString=function(dr,ur){dr=dr||10,ur=ur|0||1;var $r;if(dr===16||dr==="hex"){$r="";for(var wr=0,Er=0,gr=0;gr<this.length;gr++){var fr=this.words[gr],br=((fr<<wr|Er)&16777215).toString(16);Er=fr>>>24-wr&16777215,wr+=2,wr>=26&&(wr-=26,gr--),Er!==0||gr!==this.length-1?$r=Jt[6-br.length]+br+$r:$r=br+$r}for(Er!==0&&($r=Er.toString(16)+$r);$r.length%ur!==0;)$r="0"+$r;return this.negative!==0&&($r="-"+$r),$r}if(dr===(dr|0)&&dr>=2&&dr<=36){var _r=Qt[dr],Tr=Xt[dr];$r="";var Pr=this.clone();for(Pr.negative=0;!Pr.isZero();){var Nr=Pr.modrn(Tr).toString(dr);Pr=Pr.idivn(Tr),Pr.isZero()?$r=Nr+$r:$r=Jt[_r-Nr.length]+Nr+$r}for(this.isZero()&&($r="0"+$r);$r.length%ur!==0;)$r="0"+$r;return this.negative!==0&&($r="-"+$r),$r}Bt(!1,"Base should be between 2 and 36")},jt.prototype.toNumber=function(){var dr=this.words[0];return this.length===2?dr+=this.words[1]*67108864:this.length===3&&this.words[2]===1?dr+=4503599627370496+this.words[1]*67108864:this.length>2&&Bt(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-dr:dr},jt.prototype.toJSON=function(){return this.toString(16,2)},Ut&&(jt.prototype.toBuffer=function(dr,ur){return this.toArrayLike(Ut,dr,ur)}),jt.prototype.toArray=function(dr,ur){return this.toArrayLike(Array,dr,ur)};var tr=function(dr,ur){return dr.allocUnsafe?dr.allocUnsafe(ur):new dr(ur)};jt.prototype.toArrayLike=function(dr,ur,$r){this._strip();var wr=this.byteLength(),Er=$r||Math.max(1,wr);Bt(wr<=Er,"byte array longer than desired length"),Bt(Er>0,"Requested array length <= 0");var gr=tr(dr,Er),fr=ur==="le"?"LE":"BE";return this["_toArrayLike"+fr](gr,wr),gr},jt.prototype._toArrayLikeLE=function(dr,ur){for(var $r=0,wr=0,Er=0,gr=0;Er<this.length;Er++){var fr=this.words[Er]<<gr|wr;dr[$r++]=fr&255,$r<dr.length&&(dr[$r++]=fr>>8&255),$r<dr.length&&(dr[$r++]=fr>>16&255),gr===6?($r<dr.length&&(dr[$r++]=fr>>24&255),wr=0,gr=0):(wr=fr>>>24,gr+=2)}if($r<dr.length)for(dr[$r++]=wr;$r<dr.length;)dr[$r++]=0},jt.prototype._toArrayLikeBE=function(dr,ur){for(var $r=dr.length-1,wr=0,Er=0,gr=0;Er<this.length;Er++){var fr=this.words[Er]<<gr|wr;dr[$r--]=fr&255,$r>=0&&(dr[$r--]=fr>>8&255),$r>=0&&(dr[$r--]=fr>>16&255),gr===6?($r>=0&&(dr[$r--]=fr>>24&255),wr=0,gr=0):(wr=fr>>>24,gr+=2)}if($r>=0)for(dr[$r--]=wr;$r>=0;)dr[$r--]=0},Math.clz32?jt.prototype._countBits=function(dr){return 32-Math.clz32(dr)}:jt.prototype._countBits=function(dr){var ur=dr,$r=0;return ur>=4096&&($r+=13,ur>>>=13),ur>=64&&($r+=7,ur>>>=7),ur>=8&&($r+=4,ur>>>=4),ur>=2&&($r+=2,ur>>>=2),$r+ur},jt.prototype._zeroBits=function(dr){if(dr===0)return 26;var ur=dr,$r=0;return ur&8191||($r+=13,ur>>>=13),ur&127||($r+=7,ur>>>=7),ur&15||($r+=4,ur>>>=4),ur&3||($r+=2,ur>>>=2),ur&1||$r++,$r},jt.prototype.bitLength=function(){var dr=this.words[this.length-1],ur=this._countBits(dr);return(this.length-1)*26+ur};function rr(pr){for(var dr=new Array(pr.bitLength()),ur=0;ur<dr.length;ur++){var $r=ur/26|0,wr=ur%26;dr[ur]=pr.words[$r]>>>wr&1}return dr}jt.prototype.zeroBits=function(){if(this.isZero())return 0;for(var dr=0,ur=0;ur<this.length;ur++){var $r=this._zeroBits(this.words[ur]);if(dr+=$r,$r!==26)break}return dr},jt.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},jt.prototype.toTwos=function(dr){return this.negative!==0?this.abs().inotn(dr).iaddn(1):this.clone()},jt.prototype.fromTwos=function(dr){return this.testn(dr-1)?this.notn(dr).iaddn(1).ineg():this.clone()},jt.prototype.isNeg=function(){return this.negative!==0},jt.prototype.neg=function(){return this.clone().ineg()},jt.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},jt.prototype.iuor=function(dr){for(;this.length<dr.length;)this.words[this.length++]=0;for(var ur=0;ur<dr.length;ur++)this.words[ur]=this.words[ur]|dr.words[ur];return this._strip()},jt.prototype.ior=function(dr){return Bt((this.negative|dr.negative)===0),this.iuor(dr)},jt.prototype.or=function(dr){return this.length>dr.length?this.clone().ior(dr):dr.clone().ior(this)},jt.prototype.uor=function(dr){return this.length>dr.length?this.clone().iuor(dr):dr.clone().iuor(this)},jt.prototype.iuand=function(dr){var ur;this.length>dr.length?ur=dr:ur=this;for(var $r=0;$r<ur.length;$r++)this.words[$r]=this.words[$r]&dr.words[$r];return this.length=ur.length,this._strip()},jt.prototype.iand=function(dr){return Bt((this.negative|dr.negative)===0),this.iuand(dr)},jt.prototype.and=function(dr){return this.length>dr.length?this.clone().iand(dr):dr.clone().iand(this)},jt.prototype.uand=function(dr){return this.length>dr.length?this.clone().iuand(dr):dr.clone().iuand(this)},jt.prototype.iuxor=function(dr){var ur,$r;this.length>dr.length?(ur=this,$r=dr):(ur=dr,$r=this);for(var wr=0;wr<$r.length;wr++)this.words[wr]=ur.words[wr]^$r.words[wr];if(this!==ur)for(;wr<ur.length;wr++)this.words[wr]=ur.words[wr];return this.length=ur.length,this._strip()},jt.prototype.ixor=function(dr){return Bt((this.negative|dr.negative)===0),this.iuxor(dr)},jt.prototype.xor=function(dr){return this.length>dr.length?this.clone().ixor(dr):dr.clone().ixor(this)},jt.prototype.uxor=function(dr){return this.length>dr.length?this.clone().iuxor(dr):dr.clone().iuxor(this)},jt.prototype.inotn=function(dr){Bt(typeof dr=="number"&&dr>=0);var ur=Math.ceil(dr/26)|0,$r=dr%26;this._expand(ur),$r>0&&ur--;for(var wr=0;wr<ur;wr++)this.words[wr]=~this.words[wr]&67108863;return $r>0&&(this.words[wr]=~this.words[wr]&67108863>>26-$r),this._strip()},jt.prototype.notn=function(dr){return this.clone().inotn(dr)},jt.prototype.setn=function(dr,ur){Bt(typeof dr=="number"&&dr>=0);var $r=dr/26|0,wr=dr%26;return this._expand($r+1),ur?this.words[$r]=this.words[$r]|1<<wr:this.words[$r]=this.words[$r]&~(1<<wr),this._strip()},jt.prototype.iadd=function(dr){var ur;if(this.negative!==0&&dr.negative===0)return this.negative=0,ur=this.isub(dr),this.negative^=1,this._normSign();if(this.negative===0&&dr.negative!==0)return dr.negative=0,ur=this.isub(dr),dr.negative=1,ur._normSign();var $r,wr;this.length>dr.length?($r=this,wr=dr):($r=dr,wr=this);for(var Er=0,gr=0;gr<wr.length;gr++)ur=($r.words[gr]|0)+(wr.words[gr]|0)+Er,this.words[gr]=ur&67108863,Er=ur>>>26;for(;Er!==0&&gr<$r.length;gr++)ur=($r.words[gr]|0)+Er,this.words[gr]=ur&67108863,Er=ur>>>26;if(this.length=$r.length,Er!==0)this.words[this.length]=Er,this.length++;else if($r!==this)for(;gr<$r.length;gr++)this.words[gr]=$r.words[gr];return this},jt.prototype.add=function(dr){var ur;return dr.negative!==0&&this.negative===0?(dr.negative=0,ur=this.sub(dr),dr.negative^=1,ur):dr.negative===0&&this.negative!==0?(this.negative=0,ur=dr.sub(this),this.negative=1,ur):this.length>dr.length?this.clone().iadd(dr):dr.clone().iadd(this)},jt.prototype.isub=function(dr){if(dr.negative!==0){dr.negative=0;var ur=this.iadd(dr);return dr.negative=1,ur._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(dr),this.negative=1,this._normSign();var $r=this.cmp(dr);if($r===0)return this.negative=0,this.length=1,this.words[0]=0,this;var wr,Er;$r>0?(wr=this,Er=dr):(wr=dr,Er=this);for(var gr=0,fr=0;fr<Er.length;fr++)ur=(wr.words[fr]|0)-(Er.words[fr]|0)+gr,gr=ur>>26,this.words[fr]=ur&67108863;for(;gr!==0&&fr<wr.length;fr++)ur=(wr.words[fr]|0)+gr,gr=ur>>26,this.words[fr]=ur&67108863;if(gr===0&&fr<wr.length&&wr!==this)for(;fr<wr.length;fr++)this.words[fr]=wr.words[fr];return this.length=Math.max(this.length,fr),wr!==this&&(this.negative=1),this._strip()},jt.prototype.sub=function(dr){return this.clone().isub(dr)};function nr(pr,dr,ur){ur.negative=dr.negative^pr.negative;var $r=pr.length+dr.length|0;ur.length=$r,$r=$r-1|0;var wr=pr.words[0]|0,Er=dr.words[0]|0,gr=wr*Er,fr=gr&67108863,br=gr/67108864|0;ur.words[0]=fr;for(var _r=1;_r<$r;_r++){for(var Tr=br>>>26,Pr=br&67108863,Nr=Math.min(_r,dr.length-1),Cr=Math.max(0,_r-pr.length+1);Cr<=Nr;Cr++){var xr=_r-Cr|0;wr=pr.words[xr]|0,Er=dr.words[Cr]|0,gr=wr*Er+Pr,Tr+=gr/67108864|0,Pr=gr&67108863}ur.words[_r]=Pr|0,br=Tr|0}return br!==0?ur.words[_r]=br|0:ur.length--,ur._strip()}var ar=function(dr,ur,$r){var wr=dr.words,Er=ur.words,gr=$r.words,fr=0,br,_r,Tr,Pr=wr[0]|0,Nr=Pr&8191,Cr=Pr>>>13,xr=wr[1]|0,Rr=xr&8191,qr=xr>>>13,Vr=wr[2]|0,Gr=Vr&8191,Ur=Vr>>>13,kr=wr[3]|0,Fr=kr&8191,Wr=kr>>>13,jr=wr[4]|0,Ir=jr&8191,Mr=jr>>>13,Hr=wr[5]|0,Qr=Hr&8191,on=Hr>>>13,nn=wr[6]|0,fn=nn&8191,hn=nn>>>13,Jr=wr[7]|0,Yr=Jr&8191,an=Jr>>>13,dn=wr[8]|0,cn=dn&8191,vn=dn>>>13,_n=wr[9]|0,Tn=_n&8191,$n=_n>>>13,Kn=Er[0]|0,Un=Kn&8191,In=Kn>>>13,Mn=Er[1]|0,qn=Mn&8191,On=Mn>>>13,Hn=Er[2]|0,Vn=Hn&8191,xn=Hn>>>13,zn=Er[3]|0,Jn=zn&8191,Bn=zn>>>13,Qn=Er[4]|0,Zr=Qn&8191,en=Qn>>>13,pn=Er[5]|0,mn=pn&8191,yn=pn>>>13,Ln=Er[6]|0,Gn=Ln&8191,tn=Ln>>>13,Xr=Er[7]|0,sn=Xr&8191,ln=Xr>>>13,un=Er[8]|0,wn=un&8191,gn=un>>>13,En=Er[9]|0,Dn=En&8191,kn=En>>>13;$r.negative=dr.negative^ur.negative,$r.length=19,br=Math.imul(Nr,Un),_r=Math.imul(Nr,In),_r=_r+Math.imul(Cr,Un)|0,Tr=Math.imul(Cr,In);var Cn=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,br=Math.imul(Rr,Un),_r=Math.imul(Rr,In),_r=_r+Math.imul(qr,Un)|0,Tr=Math.imul(qr,In),br=br+Math.imul(Nr,qn)|0,_r=_r+Math.imul(Nr,On)|0,_r=_r+Math.imul(Cr,qn)|0,Tr=Tr+Math.imul(Cr,On)|0;var Nn=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Nn>>>26)|0,Nn&=67108863,br=Math.imul(Gr,Un),_r=Math.imul(Gr,In),_r=_r+Math.imul(Ur,Un)|0,Tr=Math.imul(Ur,In),br=br+Math.imul(Rr,qn)|0,_r=_r+Math.imul(Rr,On)|0,_r=_r+Math.imul(qr,qn)|0,Tr=Tr+Math.imul(qr,On)|0,br=br+Math.imul(Nr,Vn)|0,_r=_r+Math.imul(Nr,xn)|0,_r=_r+Math.imul(Cr,Vn)|0,Tr=Tr+Math.imul(Cr,xn)|0;var Xn=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Xn>>>26)|0,Xn&=67108863,br=Math.imul(Fr,Un),_r=Math.imul(Fr,In),_r=_r+Math.imul(Wr,Un)|0,Tr=Math.imul(Wr,In),br=br+Math.imul(Gr,qn)|0,_r=_r+Math.imul(Gr,On)|0,_r=_r+Math.imul(Ur,qn)|0,Tr=Tr+Math.imul(Ur,On)|0,br=br+Math.imul(Rr,Vn)|0,_r=_r+Math.imul(Rr,xn)|0,_r=_r+Math.imul(qr,Vn)|0,Tr=Tr+Math.imul(qr,xn)|0,br=br+Math.imul(Nr,Jn)|0,_r=_r+Math.imul(Nr,Bn)|0,_r=_r+Math.imul(Cr,Jn)|0,Tr=Tr+Math.imul(Cr,Bn)|0;var Rn=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,br=Math.imul(Ir,Un),_r=Math.imul(Ir,In),_r=_r+Math.imul(Mr,Un)|0,Tr=Math.imul(Mr,In),br=br+Math.imul(Fr,qn)|0,_r=_r+Math.imul(Fr,On)|0,_r=_r+Math.imul(Wr,qn)|0,Tr=Tr+Math.imul(Wr,On)|0,br=br+Math.imul(Gr,Vn)|0,_r=_r+Math.imul(Gr,xn)|0,_r=_r+Math.imul(Ur,Vn)|0,Tr=Tr+Math.imul(Ur,xn)|0,br=br+Math.imul(Rr,Jn)|0,_r=_r+Math.imul(Rr,Bn)|0,_r=_r+Math.imul(qr,Jn)|0,Tr=Tr+Math.imul(qr,Bn)|0,br=br+Math.imul(Nr,Zr)|0,_r=_r+Math.imul(Nr,en)|0,_r=_r+Math.imul(Cr,Zr)|0,Tr=Tr+Math.imul(Cr,en)|0;var Yn=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Yn>>>26)|0,Yn&=67108863,br=Math.imul(Qr,Un),_r=Math.imul(Qr,In),_r=_r+Math.imul(on,Un)|0,Tr=Math.imul(on,In),br=br+Math.imul(Ir,qn)|0,_r=_r+Math.imul(Ir,On)|0,_r=_r+Math.imul(Mr,qn)|0,Tr=Tr+Math.imul(Mr,On)|0,br=br+Math.imul(Fr,Vn)|0,_r=_r+Math.imul(Fr,xn)|0,_r=_r+Math.imul(Wr,Vn)|0,Tr=Tr+Math.imul(Wr,xn)|0,br=br+Math.imul(Gr,Jn)|0,_r=_r+Math.imul(Gr,Bn)|0,_r=_r+Math.imul(Ur,Jn)|0,Tr=Tr+Math.imul(Ur,Bn)|0,br=br+Math.imul(Rr,Zr)|0,_r=_r+Math.imul(Rr,en)|0,_r=_r+Math.imul(qr,Zr)|0,Tr=Tr+Math.imul(qr,en)|0,br=br+Math.imul(Nr,mn)|0,_r=_r+Math.imul(Nr,yn)|0,_r=_r+Math.imul(Cr,mn)|0,Tr=Tr+Math.imul(Cr,yn)|0;var ei=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(ei>>>26)|0,ei&=67108863,br=Math.imul(fn,Un),_r=Math.imul(fn,In),_r=_r+Math.imul(hn,Un)|0,Tr=Math.imul(hn,In),br=br+Math.imul(Qr,qn)|0,_r=_r+Math.imul(Qr,On)|0,_r=_r+Math.imul(on,qn)|0,Tr=Tr+Math.imul(on,On)|0,br=br+Math.imul(Ir,Vn)|0,_r=_r+Math.imul(Ir,xn)|0,_r=_r+Math.imul(Mr,Vn)|0,Tr=Tr+Math.imul(Mr,xn)|0,br=br+Math.imul(Fr,Jn)|0,_r=_r+Math.imul(Fr,Bn)|0,_r=_r+Math.imul(Wr,Jn)|0,Tr=Tr+Math.imul(Wr,Bn)|0,br=br+Math.imul(Gr,Zr)|0,_r=_r+Math.imul(Gr,en)|0,_r=_r+Math.imul(Ur,Zr)|0,Tr=Tr+Math.imul(Ur,en)|0,br=br+Math.imul(Rr,mn)|0,_r=_r+Math.imul(Rr,yn)|0,_r=_r+Math.imul(qr,mn)|0,Tr=Tr+Math.imul(qr,yn)|0,br=br+Math.imul(Nr,Gn)|0,_r=_r+Math.imul(Nr,tn)|0,_r=_r+Math.imul(Cr,Gn)|0,Tr=Tr+Math.imul(Cr,tn)|0;var Zn=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Zn>>>26)|0,Zn&=67108863,br=Math.imul(Yr,Un),_r=Math.imul(Yr,In),_r=_r+Math.imul(an,Un)|0,Tr=Math.imul(an,In),br=br+Math.imul(fn,qn)|0,_r=_r+Math.imul(fn,On)|0,_r=_r+Math.imul(hn,qn)|0,Tr=Tr+Math.imul(hn,On)|0,br=br+Math.imul(Qr,Vn)|0,_r=_r+Math.imul(Qr,xn)|0,_r=_r+Math.imul(on,Vn)|0,Tr=Tr+Math.imul(on,xn)|0,br=br+Math.imul(Ir,Jn)|0,_r=_r+Math.imul(Ir,Bn)|0,_r=_r+Math.imul(Mr,Jn)|0,Tr=Tr+Math.imul(Mr,Bn)|0,br=br+Math.imul(Fr,Zr)|0,_r=_r+Math.imul(Fr,en)|0,_r=_r+Math.imul(Wr,Zr)|0,Tr=Tr+Math.imul(Wr,en)|0,br=br+Math.imul(Gr,mn)|0,_r=_r+Math.imul(Gr,yn)|0,_r=_r+Math.imul(Ur,mn)|0,Tr=Tr+Math.imul(Ur,yn)|0,br=br+Math.imul(Rr,Gn)|0,_r=_r+Math.imul(Rr,tn)|0,_r=_r+Math.imul(qr,Gn)|0,Tr=Tr+Math.imul(qr,tn)|0,br=br+Math.imul(Nr,sn)|0,_r=_r+Math.imul(Nr,ln)|0,_r=_r+Math.imul(Cr,sn)|0,Tr=Tr+Math.imul(Cr,ln)|0;var pi=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(pi>>>26)|0,pi&=67108863,br=Math.imul(cn,Un),_r=Math.imul(cn,In),_r=_r+Math.imul(vn,Un)|0,Tr=Math.imul(vn,In),br=br+Math.imul(Yr,qn)|0,_r=_r+Math.imul(Yr,On)|0,_r=_r+Math.imul(an,qn)|0,Tr=Tr+Math.imul(an,On)|0,br=br+Math.imul(fn,Vn)|0,_r=_r+Math.imul(fn,xn)|0,_r=_r+Math.imul(hn,Vn)|0,Tr=Tr+Math.imul(hn,xn)|0,br=br+Math.imul(Qr,Jn)|0,_r=_r+Math.imul(Qr,Bn)|0,_r=_r+Math.imul(on,Jn)|0,Tr=Tr+Math.imul(on,Bn)|0,br=br+Math.imul(Ir,Zr)|0,_r=_r+Math.imul(Ir,en)|0,_r=_r+Math.imul(Mr,Zr)|0,Tr=Tr+Math.imul(Mr,en)|0,br=br+Math.imul(Fr,mn)|0,_r=_r+Math.imul(Fr,yn)|0,_r=_r+Math.imul(Wr,mn)|0,Tr=Tr+Math.imul(Wr,yn)|0,br=br+Math.imul(Gr,Gn)|0,_r=_r+Math.imul(Gr,tn)|0,_r=_r+Math.imul(Ur,Gn)|0,Tr=Tr+Math.imul(Ur,tn)|0,br=br+Math.imul(Rr,sn)|0,_r=_r+Math.imul(Rr,ln)|0,_r=_r+Math.imul(qr,sn)|0,Tr=Tr+Math.imul(qr,ln)|0,br=br+Math.imul(Nr,wn)|0,_r=_r+Math.imul(Nr,gn)|0,_r=_r+Math.imul(Cr,wn)|0,Tr=Tr+Math.imul(Cr,gn)|0;var li=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(li>>>26)|0,li&=67108863,br=Math.imul(Tn,Un),_r=Math.imul(Tn,In),_r=_r+Math.imul($n,Un)|0,Tr=Math.imul($n,In),br=br+Math.imul(cn,qn)|0,_r=_r+Math.imul(cn,On)|0,_r=_r+Math.imul(vn,qn)|0,Tr=Tr+Math.imul(vn,On)|0,br=br+Math.imul(Yr,Vn)|0,_r=_r+Math.imul(Yr,xn)|0,_r=_r+Math.imul(an,Vn)|0,Tr=Tr+Math.imul(an,xn)|0,br=br+Math.imul(fn,Jn)|0,_r=_r+Math.imul(fn,Bn)|0,_r=_r+Math.imul(hn,Jn)|0,Tr=Tr+Math.imul(hn,Bn)|0,br=br+Math.imul(Qr,Zr)|0,_r=_r+Math.imul(Qr,en)|0,_r=_r+Math.imul(on,Zr)|0,Tr=Tr+Math.imul(on,en)|0,br=br+Math.imul(Ir,mn)|0,_r=_r+Math.imul(Ir,yn)|0,_r=_r+Math.imul(Mr,mn)|0,Tr=Tr+Math.imul(Mr,yn)|0,br=br+Math.imul(Fr,Gn)|0,_r=_r+Math.imul(Fr,tn)|0,_r=_r+Math.imul(Wr,Gn)|0,Tr=Tr+Math.imul(Wr,tn)|0,br=br+Math.imul(Gr,sn)|0,_r=_r+Math.imul(Gr,ln)|0,_r=_r+Math.imul(Ur,sn)|0,Tr=Tr+Math.imul(Ur,ln)|0,br=br+Math.imul(Rr,wn)|0,_r=_r+Math.imul(Rr,gn)|0,_r=_r+Math.imul(qr,wn)|0,Tr=Tr+Math.imul(qr,gn)|0,br=br+Math.imul(Nr,Dn)|0,_r=_r+Math.imul(Nr,kn)|0,_r=_r+Math.imul(Cr,Dn)|0,Tr=Tr+Math.imul(Cr,kn)|0;var ci=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(ci>>>26)|0,ci&=67108863,br=Math.imul(Tn,qn),_r=Math.imul(Tn,On),_r=_r+Math.imul($n,qn)|0,Tr=Math.imul($n,On),br=br+Math.imul(cn,Vn)|0,_r=_r+Math.imul(cn,xn)|0,_r=_r+Math.imul(vn,Vn)|0,Tr=Tr+Math.imul(vn,xn)|0,br=br+Math.imul(Yr,Jn)|0,_r=_r+Math.imul(Yr,Bn)|0,_r=_r+Math.imul(an,Jn)|0,Tr=Tr+Math.imul(an,Bn)|0,br=br+Math.imul(fn,Zr)|0,_r=_r+Math.imul(fn,en)|0,_r=_r+Math.imul(hn,Zr)|0,Tr=Tr+Math.imul(hn,en)|0,br=br+Math.imul(Qr,mn)|0,_r=_r+Math.imul(Qr,yn)|0,_r=_r+Math.imul(on,mn)|0,Tr=Tr+Math.imul(on,yn)|0,br=br+Math.imul(Ir,Gn)|0,_r=_r+Math.imul(Ir,tn)|0,_r=_r+Math.imul(Mr,Gn)|0,Tr=Tr+Math.imul(Mr,tn)|0,br=br+Math.imul(Fr,sn)|0,_r=_r+Math.imul(Fr,ln)|0,_r=_r+Math.imul(Wr,sn)|0,Tr=Tr+Math.imul(Wr,ln)|0,br=br+Math.imul(Gr,wn)|0,_r=_r+Math.imul(Gr,gn)|0,_r=_r+Math.imul(Ur,wn)|0,Tr=Tr+Math.imul(Ur,gn)|0,br=br+Math.imul(Rr,Dn)|0,_r=_r+Math.imul(Rr,kn)|0,_r=_r+Math.imul(qr,Dn)|0,Tr=Tr+Math.imul(qr,kn)|0;var _i=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(_i>>>26)|0,_i&=67108863,br=Math.imul(Tn,Vn),_r=Math.imul(Tn,xn),_r=_r+Math.imul($n,Vn)|0,Tr=Math.imul($n,xn),br=br+Math.imul(cn,Jn)|0,_r=_r+Math.imul(cn,Bn)|0,_r=_r+Math.imul(vn,Jn)|0,Tr=Tr+Math.imul(vn,Bn)|0,br=br+Math.imul(Yr,Zr)|0,_r=_r+Math.imul(Yr,en)|0,_r=_r+Math.imul(an,Zr)|0,Tr=Tr+Math.imul(an,en)|0,br=br+Math.imul(fn,mn)|0,_r=_r+Math.imul(fn,yn)|0,_r=_r+Math.imul(hn,mn)|0,Tr=Tr+Math.imul(hn,yn)|0,br=br+Math.imul(Qr,Gn)|0,_r=_r+Math.imul(Qr,tn)|0,_r=_r+Math.imul(on,Gn)|0,Tr=Tr+Math.imul(on,tn)|0,br=br+Math.imul(Ir,sn)|0,_r=_r+Math.imul(Ir,ln)|0,_r=_r+Math.imul(Mr,sn)|0,Tr=Tr+Math.imul(Mr,ln)|0,br=br+Math.imul(Fr,wn)|0,_r=_r+Math.imul(Fr,gn)|0,_r=_r+Math.imul(Wr,wn)|0,Tr=Tr+Math.imul(Wr,gn)|0,br=br+Math.imul(Gr,Dn)|0,_r=_r+Math.imul(Gr,kn)|0,_r=_r+Math.imul(Ur,Dn)|0,Tr=Tr+Math.imul(Ur,kn)|0;var vi=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(vi>>>26)|0,vi&=67108863,br=Math.imul(Tn,Jn),_r=Math.imul(Tn,Bn),_r=_r+Math.imul($n,Jn)|0,Tr=Math.imul($n,Bn),br=br+Math.imul(cn,Zr)|0,_r=_r+Math.imul(cn,en)|0,_r=_r+Math.imul(vn,Zr)|0,Tr=Tr+Math.imul(vn,en)|0,br=br+Math.imul(Yr,mn)|0,_r=_r+Math.imul(Yr,yn)|0,_r=_r+Math.imul(an,mn)|0,Tr=Tr+Math.imul(an,yn)|0,br=br+Math.imul(fn,Gn)|0,_r=_r+Math.imul(fn,tn)|0,_r=_r+Math.imul(hn,Gn)|0,Tr=Tr+Math.imul(hn,tn)|0,br=br+Math.imul(Qr,sn)|0,_r=_r+Math.imul(Qr,ln)|0,_r=_r+Math.imul(on,sn)|0,Tr=Tr+Math.imul(on,ln)|0,br=br+Math.imul(Ir,wn)|0,_r=_r+Math.imul(Ir,gn)|0,_r=_r+Math.imul(Mr,wn)|0,Tr=Tr+Math.imul(Mr,gn)|0,br=br+Math.imul(Fr,Dn)|0,_r=_r+Math.imul(Fr,kn)|0,_r=_r+Math.imul(Wr,Dn)|0,Tr=Tr+Math.imul(Wr,kn)|0;var oi=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(oi>>>26)|0,oi&=67108863,br=Math.imul(Tn,Zr),_r=Math.imul(Tn,en),_r=_r+Math.imul($n,Zr)|0,Tr=Math.imul($n,en),br=br+Math.imul(cn,mn)|0,_r=_r+Math.imul(cn,yn)|0,_r=_r+Math.imul(vn,mn)|0,Tr=Tr+Math.imul(vn,yn)|0,br=br+Math.imul(Yr,Gn)|0,_r=_r+Math.imul(Yr,tn)|0,_r=_r+Math.imul(an,Gn)|0,Tr=Tr+Math.imul(an,tn)|0,br=br+Math.imul(fn,sn)|0,_r=_r+Math.imul(fn,ln)|0,_r=_r+Math.imul(hn,sn)|0,Tr=Tr+Math.imul(hn,ln)|0,br=br+Math.imul(Qr,wn)|0,_r=_r+Math.imul(Qr,gn)|0,_r=_r+Math.imul(on,wn)|0,Tr=Tr+Math.imul(on,gn)|0,br=br+Math.imul(Ir,Dn)|0,_r=_r+Math.imul(Ir,kn)|0,_r=_r+Math.imul(Mr,Dn)|0,Tr=Tr+Math.imul(Mr,kn)|0;var di=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(di>>>26)|0,di&=67108863,br=Math.imul(Tn,mn),_r=Math.imul(Tn,yn),_r=_r+Math.imul($n,mn)|0,Tr=Math.imul($n,yn),br=br+Math.imul(cn,Gn)|0,_r=_r+Math.imul(cn,tn)|0,_r=_r+Math.imul(vn,Gn)|0,Tr=Tr+Math.imul(vn,tn)|0,br=br+Math.imul(Yr,sn)|0,_r=_r+Math.imul(Yr,ln)|0,_r=_r+Math.imul(an,sn)|0,Tr=Tr+Math.imul(an,ln)|0,br=br+Math.imul(fn,wn)|0,_r=_r+Math.imul(fn,gn)|0,_r=_r+Math.imul(hn,wn)|0,Tr=Tr+Math.imul(hn,gn)|0,br=br+Math.imul(Qr,Dn)|0,_r=_r+Math.imul(Qr,kn)|0,_r=_r+Math.imul(on,Dn)|0,Tr=Tr+Math.imul(on,kn)|0;var bi=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(bi>>>26)|0,bi&=67108863,br=Math.imul(Tn,Gn),_r=Math.imul(Tn,tn),_r=_r+Math.imul($n,Gn)|0,Tr=Math.imul($n,tn),br=br+Math.imul(cn,sn)|0,_r=_r+Math.imul(cn,ln)|0,_r=_r+Math.imul(vn,sn)|0,Tr=Tr+Math.imul(vn,ln)|0,br=br+Math.imul(Yr,wn)|0,_r=_r+Math.imul(Yr,gn)|0,_r=_r+Math.imul(an,wn)|0,Tr=Tr+Math.imul(an,gn)|0,br=br+Math.imul(fn,Dn)|0,_r=_r+Math.imul(fn,kn)|0,_r=_r+Math.imul(hn,Dn)|0,Tr=Tr+Math.imul(hn,kn)|0;var fi=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(fi>>>26)|0,fi&=67108863,br=Math.imul(Tn,sn),_r=Math.imul(Tn,ln),_r=_r+Math.imul($n,sn)|0,Tr=Math.imul($n,ln),br=br+Math.imul(cn,wn)|0,_r=_r+Math.imul(cn,gn)|0,_r=_r+Math.imul(vn,wn)|0,Tr=Tr+Math.imul(vn,gn)|0,br=br+Math.imul(Yr,Dn)|0,_r=_r+Math.imul(Yr,kn)|0,_r=_r+Math.imul(an,Dn)|0,Tr=Tr+Math.imul(an,kn)|0;var Ti=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(Ti>>>26)|0,Ti&=67108863,br=Math.imul(Tn,wn),_r=Math.imul(Tn,gn),_r=_r+Math.imul($n,wn)|0,Tr=Math.imul($n,gn),br=br+Math.imul(cn,Dn)|0,_r=_r+Math.imul(cn,kn)|0,_r=_r+Math.imul(vn,Dn)|0,Tr=Tr+Math.imul(vn,kn)|0;var uo=(fr+br|0)+((_r&8191)<<13)|0;fr=(Tr+(_r>>>13)|0)+(uo>>>26)|0,uo&=67108863,br=Math.imul(Tn,Dn),_r=Math.imul(Tn,kn),_r=_r+Math.imul($n,Dn)|0,Tr=Math.imul($n,kn);var fo=(fr+br|0)+((_r&8191)<<13)|0;return fr=(Tr+(_r>>>13)|0)+(fo>>>26)|0,fo&=67108863,gr[0]=Cn,gr[1]=Nn,gr[2]=Xn,gr[3]=Rn,gr[4]=Yn,gr[5]=ei,gr[6]=Zn,gr[7]=pi,gr[8]=li,gr[9]=ci,gr[10]=_i,gr[11]=vi,gr[12]=oi,gr[13]=di,gr[14]=bi,gr[15]=fi,gr[16]=Ti,gr[17]=uo,gr[18]=fo,fr!==0&&(gr[19]=fr,$r.length++),$r};Math.imul||(ar=nr);function ir(pr,dr,ur){ur.negative=dr.negative^pr.negative,ur.length=pr.length+dr.length;for(var $r=0,wr=0,Er=0;Er<ur.length-1;Er++){var gr=wr;wr=0;for(var fr=$r&67108863,br=Math.min(Er,dr.length-1),_r=Math.max(0,Er-pr.length+1);_r<=br;_r++){var Tr=Er-_r,Pr=pr.words[Tr]|0,Nr=dr.words[_r]|0,Cr=Pr*Nr,xr=Cr&67108863;gr=gr+(Cr/67108864|0)|0,xr=xr+fr|0,fr=xr&67108863,gr=gr+(xr>>>26)|0,wr+=gr>>>26,gr&=67108863}ur.words[Er]=fr,$r=gr,gr=wr}return $r!==0?ur.words[Er]=$r:ur.length--,ur._strip()}function lr(pr,dr,ur){return ir(pr,dr,ur)}jt.prototype.mulTo=function(dr,ur){var $r,wr=this.length+dr.length;return this.length===10&&dr.length===10?$r=ar(this,dr,ur):wr<63?$r=nr(this,dr,ur):wr<1024?$r=ir(this,dr,ur):$r=lr(this,dr,ur),$r},jt.prototype.mul=function(dr){var ur=new jt(null);return ur.words=new Array(this.length+dr.length),this.mulTo(dr,ur)},jt.prototype.mulf=function(dr){var ur=new jt(null);return ur.words=new Array(this.length+dr.length),lr(this,dr,ur)},jt.prototype.imul=function(dr){return this.clone().mulTo(dr,this)},jt.prototype.imuln=function(dr){var ur=dr<0;ur&&(dr=-dr),Bt(typeof dr=="number"),Bt(dr<67108864);for(var $r=0,wr=0;wr<this.length;wr++){var Er=(this.words[wr]|0)*dr,gr=(Er&67108863)+($r&67108863);$r>>=26,$r+=Er/67108864|0,$r+=gr>>>26,this.words[wr]=gr&67108863}return $r!==0&&(this.words[wr]=$r,this.length++),ur?this.ineg():this},jt.prototype.muln=function(dr){return this.clone().imuln(dr)},jt.prototype.sqr=function(){return this.mul(this)},jt.prototype.isqr=function(){return this.imul(this.clone())},jt.prototype.pow=function(dr){var ur=rr(dr);if(ur.length===0)return new jt(1);for(var $r=this,wr=0;wr<ur.length&&ur[wr]===0;wr++,$r=$r.sqr());if(++wr<ur.length)for(var Er=$r.sqr();wr<ur.length;wr++,Er=Er.sqr())ur[wr]!==0&&($r=$r.mul(Er));return $r},jt.prototype.iushln=function(dr){Bt(typeof dr=="number"&&dr>=0);var ur=dr%26,$r=(dr-ur)/26,wr=67108863>>>26-ur<<26-ur,Er;if(ur!==0){var gr=0;for(Er=0;Er<this.length;Er++){var fr=this.words[Er]&wr,br=(this.words[Er]|0)-fr<<ur;this.words[Er]=br|gr,gr=fr>>>26-ur}gr&&(this.words[Er]=gr,this.length++)}if($r!==0){for(Er=this.length-1;Er>=0;Er--)this.words[Er+$r]=this.words[Er];for(Er=0;Er<$r;Er++)this.words[Er]=0;this.length+=$r}return this._strip()},jt.prototype.ishln=function(dr){return Bt(this.negative===0),this.iushln(dr)},jt.prototype.iushrn=function(dr,ur,$r){Bt(typeof dr=="number"&&dr>=0);var wr;ur?wr=(ur-ur%26)/26:wr=0;var Er=dr%26,gr=Math.min((dr-Er)/26,this.length),fr=67108863^67108863>>>Er<<Er,br=$r;if(wr-=gr,wr=Math.max(0,wr),br){for(var _r=0;_r<gr;_r++)br.words[_r]=this.words[_r];br.length=gr}if(gr!==0)if(this.length>gr)for(this.length-=gr,_r=0;_r<this.length;_r++)this.words[_r]=this.words[_r+gr];else this.words[0]=0,this.length=1;var Tr=0;for(_r=this.length-1;_r>=0&&(Tr!==0||_r>=wr);_r--){var Pr=this.words[_r]|0;this.words[_r]=Tr<<26-Er|Pr>>>Er,Tr=Pr&fr}return br&&Tr!==0&&(br.words[br.length++]=Tr),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},jt.prototype.ishrn=function(dr,ur,$r){return Bt(this.negative===0),this.iushrn(dr,ur,$r)},jt.prototype.shln=function(dr){return this.clone().ishln(dr)},jt.prototype.ushln=function(dr){return this.clone().iushln(dr)},jt.prototype.shrn=function(dr){return this.clone().ishrn(dr)},jt.prototype.ushrn=function(dr){return this.clone().iushrn(dr)},jt.prototype.testn=function(dr){Bt(typeof dr=="number"&&dr>=0);var ur=dr%26,$r=(dr-ur)/26,wr=1<<ur;if(this.length<=$r)return!1;var Er=this.words[$r];return!!(Er&wr)},jt.prototype.imaskn=function(dr){Bt(typeof dr=="number"&&dr>=0);var ur=dr%26,$r=(dr-ur)/26;if(Bt(this.negative===0,"imaskn works only with positive numbers"),this.length<=$r)return this;if(ur!==0&&$r++,this.length=Math.min($r,this.length),ur!==0){var wr=67108863^67108863>>>ur<<ur;this.words[this.length-1]&=wr}return this._strip()},jt.prototype.maskn=function(dr){return this.clone().imaskn(dr)},jt.prototype.iaddn=function(dr){return Bt(typeof dr=="number"),Bt(dr<67108864),dr<0?this.isubn(-dr):this.negative!==0?this.length===1&&(this.words[0]|0)<=dr?(this.words[0]=dr-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(dr),this.negative=1,this):this._iaddn(dr)},jt.prototype._iaddn=function(dr){this.words[0]+=dr;for(var ur=0;ur<this.length&&this.words[ur]>=67108864;ur++)this.words[ur]-=67108864,ur===this.length-1?this.words[ur+1]=1:this.words[ur+1]++;return this.length=Math.max(this.length,ur+1),this},jt.prototype.isubn=function(dr){if(Bt(typeof dr=="number"),Bt(dr<67108864),dr<0)return this.iaddn(-dr);if(this.negative!==0)return this.negative=0,this.iaddn(dr),this.negative=1,this;if(this.words[0]-=dr,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var ur=0;ur<this.length&&this.words[ur]<0;ur++)this.words[ur]+=67108864,this.words[ur+1]-=1;return this._strip()},jt.prototype.addn=function(dr){return this.clone().iaddn(dr)},jt.prototype.subn=function(dr){return this.clone().isubn(dr)},jt.prototype.iabs=function(){return this.negative=0,this},jt.prototype.abs=function(){return this.clone().iabs()},jt.prototype._ishlnsubmul=function(dr,ur,$r){var wr=dr.length+$r,Er;this._expand(wr);var gr,fr=0;for(Er=0;Er<dr.length;Er++){gr=(this.words[Er+$r]|0)+fr;var br=(dr.words[Er]|0)*ur;gr-=br&67108863,fr=(gr>>26)-(br/67108864|0),this.words[Er+$r]=gr&67108863}for(;Er<this.length-$r;Er++)gr=(this.words[Er+$r]|0)+fr,fr=gr>>26,this.words[Er+$r]=gr&67108863;if(fr===0)return this._strip();for(Bt(fr===-1),fr=0,Er=0;Er<this.length;Er++)gr=-(this.words[Er]|0)+fr,fr=gr>>26,this.words[Er]=gr&67108863;return this.negative=1,this._strip()},jt.prototype._wordDiv=function(dr,ur){var $r=this.length-dr.length,wr=this.clone(),Er=dr,gr=Er.words[Er.length-1]|0,fr=this._countBits(gr);$r=26-fr,$r!==0&&(Er=Er.ushln($r),wr.iushln($r),gr=Er.words[Er.length-1]|0);var br=wr.length-Er.length,_r;if(ur!=="mod"){_r=new jt(null),_r.length=br+1,_r.words=new Array(_r.length);for(var Tr=0;Tr<_r.length;Tr++)_r.words[Tr]=0}var Pr=wr.clone()._ishlnsubmul(Er,1,br);Pr.negative===0&&(wr=Pr,_r&&(_r.words[br]=1));for(var Nr=br-1;Nr>=0;Nr--){var Cr=(wr.words[Er.length+Nr]|0)*67108864+(wr.words[Er.length+Nr-1]|0);for(Cr=Math.min(Cr/gr|0,67108863),wr._ishlnsubmul(Er,Cr,Nr);wr.negative!==0;)Cr--,wr.negative=0,wr._ishlnsubmul(Er,1,Nr),wr.isZero()||(wr.negative^=1);_r&&(_r.words[Nr]=Cr)}return _r&&_r._strip(),wr._strip(),ur!=="div"&&$r!==0&&wr.iushrn($r),{div:_r||null,mod:wr}},jt.prototype.divmod=function(dr,ur,$r){if(Bt(!dr.isZero()),this.isZero())return{div:new jt(0),mod:new jt(0)};var wr,Er,gr;return this.negative!==0&&dr.negative===0?(gr=this.neg().divmod(dr,ur),ur!=="mod"&&(wr=gr.div.neg()),ur!=="div"&&(Er=gr.mod.neg(),$r&&Er.negative!==0&&Er.iadd(dr)),{div:wr,mod:Er}):this.negative===0&&dr.negative!==0?(gr=this.divmod(dr.neg(),ur),ur!=="mod"&&(wr=gr.div.neg()),{div:wr,mod:gr.mod}):this.negative&dr.negative?(gr=this.neg().divmod(dr.neg(),ur),ur!=="div"&&(Er=gr.mod.neg(),$r&&Er.negative!==0&&Er.isub(dr)),{div:gr.div,mod:Er}):dr.length>this.length||this.cmp(dr)<0?{div:new jt(0),mod:this}:dr.length===1?ur==="div"?{div:this.divn(dr.words[0]),mod:null}:ur==="mod"?{div:null,mod:new jt(this.modrn(dr.words[0]))}:{div:this.divn(dr.words[0]),mod:new jt(this.modrn(dr.words[0]))}:this._wordDiv(dr,ur)},jt.prototype.div=function(dr){return this.divmod(dr,"div",!1).div},jt.prototype.mod=function(dr){return this.divmod(dr,"mod",!1).mod},jt.prototype.umod=function(dr){return this.divmod(dr,"mod",!0).mod},jt.prototype.divRound=function(dr){var ur=this.divmod(dr);if(ur.mod.isZero())return ur.div;var $r=ur.div.negative!==0?ur.mod.isub(dr):ur.mod,wr=dr.ushrn(1),Er=dr.andln(1),gr=$r.cmp(wr);return gr<0||Er===1&&gr===0?ur.div:ur.div.negative!==0?ur.div.isubn(1):ur.div.iaddn(1)},jt.prototype.modrn=function(dr){var ur=dr<0;ur&&(dr=-dr),Bt(dr<=67108863);for(var $r=(1<<26)%dr,wr=0,Er=this.length-1;Er>=0;Er--)wr=($r*wr+(this.words[Er]|0))%dr;return ur?-wr:wr},jt.prototype.modn=function(dr){return this.modrn(dr)},jt.prototype.idivn=function(dr){var ur=dr<0;ur&&(dr=-dr),Bt(dr<=67108863);for(var $r=0,wr=this.length-1;wr>=0;wr--){var Er=(this.words[wr]|0)+$r*67108864;this.words[wr]=Er/dr|0,$r=Er%dr}return this._strip(),ur?this.ineg():this},jt.prototype.divn=function(dr){return this.clone().idivn(dr)},jt.prototype.egcd=function(dr){Bt(dr.negative===0),Bt(!dr.isZero());var ur=this,$r=dr.clone();ur.negative!==0?ur=ur.umod(dr):ur=ur.clone();for(var wr=new jt(1),Er=new jt(0),gr=new jt(0),fr=new jt(1),br=0;ur.isEven()&&$r.isEven();)ur.iushrn(1),$r.iushrn(1),++br;for(var _r=$r.clone(),Tr=ur.clone();!ur.isZero();){for(var Pr=0,Nr=1;!(ur.words[0]&Nr)&&Pr<26;++Pr,Nr<<=1);if(Pr>0)for(ur.iushrn(Pr);Pr-- >0;)(wr.isOdd()||Er.isOdd())&&(wr.iadd(_r),Er.isub(Tr)),wr.iushrn(1),Er.iushrn(1);for(var Cr=0,xr=1;!($r.words[0]&xr)&&Cr<26;++Cr,xr<<=1);if(Cr>0)for($r.iushrn(Cr);Cr-- >0;)(gr.isOdd()||fr.isOdd())&&(gr.iadd(_r),fr.isub(Tr)),gr.iushrn(1),fr.iushrn(1);ur.cmp($r)>=0?(ur.isub($r),wr.isub(gr),Er.isub(fr)):($r.isub(ur),gr.isub(wr),fr.isub(Er))}return{a:gr,b:fr,gcd:$r.iushln(br)}},jt.prototype._invmp=function(dr){Bt(dr.negative===0),Bt(!dr.isZero());var ur=this,$r=dr.clone();ur.negative!==0?ur=ur.umod(dr):ur=ur.clone();for(var wr=new jt(1),Er=new jt(0),gr=$r.clone();ur.cmpn(1)>0&&$r.cmpn(1)>0;){for(var fr=0,br=1;!(ur.words[0]&br)&&fr<26;++fr,br<<=1);if(fr>0)for(ur.iushrn(fr);fr-- >0;)wr.isOdd()&&wr.iadd(gr),wr.iushrn(1);for(var _r=0,Tr=1;!($r.words[0]&Tr)&&_r<26;++_r,Tr<<=1);if(_r>0)for($r.iushrn(_r);_r-- >0;)Er.isOdd()&&Er.iadd(gr),Er.iushrn(1);ur.cmp($r)>=0?(ur.isub($r),wr.isub(Er)):($r.isub(ur),Er.isub(wr))}var Pr;return ur.cmpn(1)===0?Pr=wr:Pr=Er,Pr.cmpn(0)<0&&Pr.iadd(dr),Pr},jt.prototype.gcd=function(dr){if(this.isZero())return dr.abs();if(dr.isZero())return this.abs();var ur=this.clone(),$r=dr.clone();ur.negative=0,$r.negative=0;for(var wr=0;ur.isEven()&&$r.isEven();wr++)ur.iushrn(1),$r.iushrn(1);do{for(;ur.isEven();)ur.iushrn(1);for(;$r.isEven();)$r.iushrn(1);var Er=ur.cmp($r);if(Er<0){var gr=ur;ur=$r,$r=gr}else if(Er===0||$r.cmpn(1)===0)break;ur.isub($r)}while(!0);return $r.iushln(wr)},jt.prototype.invm=function(dr){return this.egcd(dr).a.umod(dr)},jt.prototype.isEven=function(){return(this.words[0]&1)===0},jt.prototype.isOdd=function(){return(this.words[0]&1)===1},jt.prototype.andln=function(dr){return this.words[0]&dr},jt.prototype.bincn=function(dr){Bt(typeof dr=="number");var ur=dr%26,$r=(dr-ur)/26,wr=1<<ur;if(this.length<=$r)return this._expand($r+1),this.words[$r]|=wr,this;for(var Er=wr,gr=$r;Er!==0&&gr<this.length;gr++){var fr=this.words[gr]|0;fr+=Er,Er=fr>>>26,fr&=67108863,this.words[gr]=fr}return Er!==0&&(this.words[gr]=Er,this.length++),this},jt.prototype.isZero=function(){return this.length===1&&this.words[0]===0},jt.prototype.cmpn=function(dr){var ur=dr<0;if(this.negative!==0&&!ur)return-1;if(this.negative===0&&ur)return 1;this._strip();var $r;if(this.length>1)$r=1;else{ur&&(dr=-dr),Bt(dr<=67108863,"Number is too big");var wr=this.words[0]|0;$r=wr===dr?0:wr<dr?-1:1}return this.negative!==0?-$r|0:$r},jt.prototype.cmp=function(dr){if(this.negative!==0&&dr.negative===0)return-1;if(this.negative===0&&dr.negative!==0)return 1;var ur=this.ucmp(dr);return this.negative!==0?-ur|0:ur},jt.prototype.ucmp=function(dr){if(this.length>dr.length)return 1;if(this.length<dr.length)return-1;for(var ur=0,$r=this.length-1;$r>=0;$r--){var wr=this.words[$r]|0,Er=dr.words[$r]|0;if(wr!==Er){wr<Er?ur=-1:wr>Er&&(ur=1);break}}return ur},jt.prototype.gtn=function(dr){return this.cmpn(dr)===1},jt.prototype.gt=function(dr){return this.cmp(dr)===1},jt.prototype.gten=function(dr){return this.cmpn(dr)>=0},jt.prototype.gte=function(dr){return this.cmp(dr)>=0},jt.prototype.ltn=function(dr){return this.cmpn(dr)===-1},jt.prototype.lt=function(dr){return this.cmp(dr)===-1},jt.prototype.lten=function(dr){return this.cmpn(dr)<=0},jt.prototype.lte=function(dr){return this.cmp(dr)<=0},jt.prototype.eqn=function(dr){return this.cmpn(dr)===0},jt.prototype.eq=function(dr){return this.cmp(dr)===0},jt.red=function(dr){return new Or(dr)},jt.prototype.toRed=function(dr){return Bt(!this.red,"Already a number in reduction context"),Bt(this.negative===0,"red works only with positives"),dr.convertTo(this)._forceRed(dr)},jt.prototype.fromRed=function(){return Bt(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},jt.prototype._forceRed=function(dr){return this.red=dr,this},jt.prototype.forceRed=function(dr){return Bt(!this.red,"Already a number in reduction context"),this._forceRed(dr)},jt.prototype.redAdd=function(dr){return Bt(this.red,"redAdd works only with red numbers"),this.red.add(this,dr)},jt.prototype.redIAdd=function(dr){return Bt(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,dr)},jt.prototype.redSub=function(dr){return Bt(this.red,"redSub works only with red numbers"),this.red.sub(this,dr)},jt.prototype.redISub=function(dr){return Bt(this.red,"redISub works only with red numbers"),this.red.isub(this,dr)},jt.prototype.redShl=function(dr){return Bt(this.red,"redShl works only with red numbers"),this.red.shl(this,dr)},jt.prototype.redMul=function(dr){return Bt(this.red,"redMul works only with red numbers"),this.red._verify2(this,dr),this.red.mul(this,dr)},jt.prototype.redIMul=function(dr){return Bt(this.red,"redMul works only with red numbers"),this.red._verify2(this,dr),this.red.imul(this,dr)},jt.prototype.redSqr=function(){return Bt(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},jt.prototype.redISqr=function(){return Bt(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},jt.prototype.redSqrt=function(){return Bt(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},jt.prototype.redInvm=function(){return Bt(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},jt.prototype.redNeg=function(){return Bt(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},jt.prototype.redPow=function(dr){return Bt(this.red&&!dr.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,dr)};var yr={k256:null,p224:null,p192:null,p25519:null};function Sr(pr,dr){this.name=pr,this.p=new jt(dr,16),this.n=this.p.bitLength(),this.k=new jt(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Sr.prototype._tmp=function(){var dr=new jt(null);return dr.words=new Array(Math.ceil(this.n/13)),dr},Sr.prototype.ireduce=function(dr){var ur=dr,$r;do this.split(ur,this.tmp),ur=this.imulK(ur),ur=ur.iadd(this.tmp),$r=ur.bitLength();while($r>this.n);var wr=$r<this.n?-1:ur.ucmp(this.p);return wr===0?(ur.words[0]=0,ur.length=1):wr>0?ur.isub(this.p):ur.strip!==void 0?ur.strip():ur._strip(),ur},Sr.prototype.split=function(dr,ur){dr.iushrn(this.n,0,ur)},Sr.prototype.imulK=function(dr){return dr.imul(this.k)};function Ar(){Sr.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}Nt(Ar,Sr),Ar.prototype.split=function(dr,ur){for(var $r=4194303,wr=Math.min(dr.length,9),Er=0;Er<wr;Er++)ur.words[Er]=dr.words[Er];if(ur.length=wr,dr.length<=9){dr.words[0]=0,dr.length=1;return}var gr=dr.words[9];for(ur.words[ur.length++]=gr&$r,Er=10;Er<dr.length;Er++){var fr=dr.words[Er]|0;dr.words[Er-10]=(fr&$r)<<4|gr>>>22,gr=fr}gr>>>=22,dr.words[Er-10]=gr,gr===0&&dr.length>10?dr.length-=10:dr.length-=9},Ar.prototype.imulK=function(dr){dr.words[dr.length]=0,dr.words[dr.length+1]=0,dr.length+=2;for(var ur=0,$r=0;$r<dr.length;$r++){var wr=dr.words[$r]|0;ur+=wr*977,dr.words[$r]=ur&67108863,ur=wr*64+(ur/67108864|0)}return dr.words[dr.length-1]===0&&(dr.length--,dr.words[dr.length-1]===0&&dr.length--),dr};function Dr(){Sr.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}Nt(Dr,Sr);function Br(){Sr.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}Nt(Br,Sr);function Lr(){Sr.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}Nt(Lr,Sr),Lr.prototype.imulK=function(dr){for(var ur=0,$r=0;$r<dr.length;$r++){var wr=(dr.words[$r]|0)*19+ur,Er=wr&67108863;wr>>>=26,dr.words[$r]=Er,ur=wr}return ur!==0&&(dr.words[dr.length++]=ur),dr},jt._prime=function(dr){if(yr[dr])return yr[dr];var ur;if(dr==="k256")ur=new Ar;else if(dr==="p224")ur=new Dr;else if(dr==="p192")ur=new Br;else if(dr==="p25519")ur=new Lr;else throw new Error("Unknown prime "+dr);return yr[dr]=ur,ur};function Or(pr){if(typeof pr=="string"){var dr=jt._prime(pr);this.m=dr.p,this.prime=dr}else Bt(pr.gtn(1),"modulus must be greater than 1"),this.m=pr,this.prime=null}Or.prototype._verify1=function(dr){Bt(dr.negative===0,"red works only with positives"),Bt(dr.red,"red works only with red numbers")},Or.prototype._verify2=function(dr,ur){Bt((dr.negative|ur.negative)===0,"red works only with positives"),Bt(dr.red&&dr.red===ur.red,"red works only with red numbers")},Or.prototype.imod=function(dr){return this.prime?this.prime.ireduce(dr)._forceRed(this):(zt(dr,dr.umod(this.m)._forceRed(this)),dr)},Or.prototype.neg=function(dr){return dr.isZero()?dr.clone():this.m.sub(dr)._forceRed(this)},Or.prototype.add=function(dr,ur){this._verify2(dr,ur);var $r=dr.add(ur);return $r.cmp(this.m)>=0&&$r.isub(this.m),$r._forceRed(this)},Or.prototype.iadd=function(dr,ur){this._verify2(dr,ur);var $r=dr.iadd(ur);return $r.cmp(this.m)>=0&&$r.isub(this.m),$r},Or.prototype.sub=function(dr,ur){this._verify2(dr,ur);var $r=dr.sub(ur);return $r.cmpn(0)<0&&$r.iadd(this.m),$r._forceRed(this)},Or.prototype.isub=function(dr,ur){this._verify2(dr,ur);var $r=dr.isub(ur);return $r.cmpn(0)<0&&$r.iadd(this.m),$r},Or.prototype.shl=function(dr,ur){return this._verify1(dr),this.imod(dr.ushln(ur))},Or.prototype.imul=function(dr,ur){return this._verify2(dr,ur),this.imod(dr.imul(ur))},Or.prototype.mul=function(dr,ur){return this._verify2(dr,ur),this.imod(dr.mul(ur))},Or.prototype.isqr=function(dr){return this.imul(dr,dr.clone())},Or.prototype.sqr=function(dr){return this.mul(dr,dr)},Or.prototype.sqrt=function(dr){if(dr.isZero())return dr.clone();var ur=this.m.andln(3);if(Bt(ur%2===1),ur===3){var $r=this.m.add(new jt(1)).iushrn(2);return this.pow(dr,$r)}for(var wr=this.m.subn(1),Er=0;!wr.isZero()&&wr.andln(1)===0;)Er++,wr.iushrn(1);Bt(!wr.isZero());var gr=new jt(1).toRed(this),fr=gr.redNeg(),br=this.m.subn(1).iushrn(1),_r=this.m.bitLength();for(_r=new jt(2*_r*_r).toRed(this);this.pow(_r,br).cmp(fr)!==0;)_r.redIAdd(fr);for(var Tr=this.pow(_r,wr),Pr=this.pow(dr,wr.addn(1).iushrn(1)),Nr=this.pow(dr,wr),Cr=Er;Nr.cmp(gr)!==0;){for(var xr=Nr,Rr=0;xr.cmp(gr)!==0;Rr++)xr=xr.redSqr();Bt(Rr<Cr);var qr=this.pow(Tr,new jt(1).iushln(Cr-Rr-1));Pr=Pr.redMul(qr),Tr=qr.redSqr(),Nr=Nr.redMul(Tr),Cr=Rr}return Pr},Or.prototype.invm=function(dr){var ur=dr._invmp(this.m);return ur.negative!==0?(ur.negative=0,this.imod(ur).redNeg()):this.imod(ur)},Or.prototype.pow=function(dr,ur){if(ur.isZero())return new jt(1).toRed(this);if(ur.cmpn(1)===0)return dr.clone();var $r=4,wr=new Array(1<<$r);wr[0]=new jt(1).toRed(this),wr[1]=dr;for(var Er=2;Er<wr.length;Er++)wr[Er]=this.mul(wr[Er-1],dr);var gr=wr[0],fr=0,br=0,_r=ur.bitLength()%26;for(_r===0&&(_r=26),Er=ur.length-1;Er>=0;Er--){for(var Tr=ur.words[Er],Pr=_r-1;Pr>=0;Pr--){var Nr=Tr>>Pr&1;if(gr!==wr[0]&&(gr=this.sqr(gr)),Nr===0&&fr===0){br=0;continue}fr<<=1,fr|=Nr,br++,!(br!==$r&&(Er!==0||Pr!==0))&&(gr=this.mul(gr,wr[fr]),br=0,fr=0)}_r=26}return gr},Or.prototype.convertTo=function(dr){var ur=dr.umod(this.m);return ur===dr?ur.clone():ur},Or.prototype.convertFrom=function(dr){var ur=dr.clone();return ur.red=null,ur},jt.mont=function(dr){return new vr(dr)};function vr(pr){Or.call(this,pr),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new jt(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}Nt(vr,Or),vr.prototype.convertTo=function(dr){return this.imod(dr.ushln(this.shift))},vr.prototype.convertFrom=function(dr){var ur=this.imod(dr.mul(this.rinv));return ur.red=null,ur},vr.prototype.imul=function(dr,ur){if(dr.isZero()||ur.isZero())return dr.words[0]=0,dr.length=1,dr;var $r=dr.imul(ur),wr=$r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Er=$r.isub(wr).iushrn(this.shift),gr=Er;return Er.cmp(this.m)>=0?gr=Er.isub(this.m):Er.cmpn(0)<0&&(gr=Er.iadd(this.m)),gr._forceRed(this)},vr.prototype.mul=function(dr,ur){if(dr.isZero()||ur.isZero())return new jt(0)._forceRed(this);var $r=dr.mul(ur),wr=$r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Er=$r.isub(wr).iushrn(this.shift),gr=Er;return Er.cmp(this.m)>=0?gr=Er.isub(this.m):Er.cmpn(0)<0&&(gr=Er.iadd(this.m)),gr._forceRed(this)},vr.prototype.invm=function(dr){var ur=this.imod(dr._invmp(this.m).mul(this.r2));return ur._forceRed(this)}})(kt,commonjsGlobal)})(bn);var bnExports=bn.exports,BN$a=bnExports,randomBytes$5=browserExports$2;function blind(kt){var At=getr(kt),xt=At.toRed(BN$a.mont(kt.modulus)).redPow(new BN$a(kt.publicExponent)).fromRed();return{blinder:xt,unblinder:At.invm(kt.modulus)}}function getr(kt){var At=kt.modulus.byteLength(),xt;do xt=new BN$a(randomBytes$5(At));while(xt.cmp(kt.modulus)>=0||!xt.umod(kt.prime1)||!xt.umod(kt.prime2));return xt}function crt$2(kt,At){var xt=blind(At),Bt=At.modulus.byteLength(),Nt=new BN$a(kt).mul(xt.blinder).umod(At.modulus),jt=Nt.toRed(BN$a.mont(At.prime1)),Ut=Nt.toRed(BN$a.mont(At.prime2)),Lt=At.coefficient,Ht=At.prime1,Vt=At.prime2,zt=jt.redPow(At.exponent1).fromRed(),Wt=Ut.redPow(At.exponent2).fromRed(),Jt=zt.isub(Wt).imul(Lt).umod(Ht).imul(Vt);return Wt.iadd(Jt).imul(xt.unblinder).umod(At.modulus).toArrayLike(buffer$2.Buffer,"be",Bt)}crt$2.getr=getr;var browserifyRsa=crt$2,elliptic$1={};const name$2="elliptic",version="6.5.7",description$1="EC cryptography",main="lib/elliptic.js",files=["lib"],scripts={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository={type:"git",url:"git@github.com:indutny/elliptic"},keywords=["EC","Elliptic","curve","Cryptography"],author="Fedor Indutny <fedor@indutny.com>",license="MIT",bugs={url:"https://github.com/indutny/elliptic/issues"},homepage="https://github.com/indutny/elliptic",devDependencies={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies$1={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},require$$0$3={name:name$2,version,description:description$1,main,files,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,dependencies:dependencies$1};var utils$t={},utils$s={};(function(kt){var At=kt;function xt(jt,Ut){if(Array.isArray(jt))return jt.slice();if(!jt)return[];var Lt=[];if(typeof jt!="string"){for(var Ht=0;Ht<jt.length;Ht++)Lt[Ht]=jt[Ht]|0;return Lt}if(Ut==="hex"){jt=jt.replace(/[^a-z0-9]+/ig,""),jt.length%2!==0&&(jt="0"+jt);for(var Ht=0;Ht<jt.length;Ht+=2)Lt.push(parseInt(jt[Ht]+jt[Ht+1],16))}else for(var Ht=0;Ht<jt.length;Ht++){var Vt=jt.charCodeAt(Ht),zt=Vt>>8,Wt=Vt&255;zt?Lt.push(zt,Wt):Lt.push(Wt)}return Lt}At.toArray=xt;function Bt(jt){return jt.length===1?"0"+jt:jt}At.zero2=Bt;function Nt(jt){for(var Ut="",Lt=0;Lt<jt.length;Lt++)Ut+=Bt(jt[Lt].toString(16));return Ut}At.toHex=Nt,At.encode=function(Ut,Lt){return Lt==="hex"?Nt(Ut):Ut}})(utils$s);(function(kt){var At=kt,xt=bnExports$1,Bt=minimalisticAssert,Nt=utils$s;At.assert=Bt,At.toArray=Nt.toArray,At.zero2=Nt.zero2,At.toHex=Nt.toHex,At.encode=Nt.encode;function jt(zt,Wt,Jt){var Qt=new Array(Math.max(zt.bitLength(),Jt)+1),Xt;for(Xt=0;Xt<Qt.length;Xt+=1)Qt[Xt]=0;var tr=1<<Wt+1,rr=zt.clone();for(Xt=0;Xt<Qt.length;Xt++){var nr,ar=rr.andln(tr-1);rr.isOdd()?(ar>(tr>>1)-1?nr=(tr>>1)-ar:nr=ar,rr.isubn(nr)):nr=0,Qt[Xt]=nr,rr.iushrn(1)}return Qt}At.getNAF=jt;function Ut(zt,Wt){var Jt=[[],[]];zt=zt.clone(),Wt=Wt.clone();for(var Qt=0,Xt=0,tr;zt.cmpn(-Qt)>0||Wt.cmpn(-Xt)>0;){var rr=zt.andln(3)+Qt&3,nr=Wt.andln(3)+Xt&3;rr===3&&(rr=-1),nr===3&&(nr=-1);var ar;rr&1?(tr=zt.andln(7)+Qt&7,(tr===3||tr===5)&&nr===2?ar=-rr:ar=rr):ar=0,Jt[0].push(ar);var ir;nr&1?(tr=Wt.andln(7)+Xt&7,(tr===3||tr===5)&&rr===2?ir=-nr:ir=nr):ir=0,Jt[1].push(ir),2*Qt===ar+1&&(Qt=1-Qt),2*Xt===ir+1&&(Xt=1-Xt),zt.iushrn(1),Wt.iushrn(1)}return Jt}At.getJSF=Ut;function Lt(zt,Wt,Jt){var Qt="_"+Wt;zt.prototype[Wt]=function(){return this[Qt]!==void 0?this[Qt]:this[Qt]=Jt.call(this)}}At.cachedProperty=Lt;function Ht(zt){return typeof zt=="string"?At.toArray(zt,"hex"):zt}At.parseBytes=Ht;function Vt(zt){return new xt(zt,"hex","le")}At.intFromLE=Vt})(utils$t);var curve$1={},BN$9=bnExports$1,utils$r=utils$t,getNAF=utils$r.getNAF,getJSF=utils$r.getJSF,assert$h=utils$r.assert;function BaseCurve(kt,At){this.type=kt,this.p=new BN$9(At.p,16),this.red=At.prime?BN$9.red(At.prime):BN$9.mont(this.p),this.zero=new BN$9(0).toRed(this.red),this.one=new BN$9(1).toRed(this.red),this.two=new BN$9(2).toRed(this.red),this.n=At.n&&new BN$9(At.n,16),this.g=At.g&&this.pointFromJSON(At.g,At.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var xt=this.n&&this.p.div(this.n);!xt||xt.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var base$2=BaseCurve;BaseCurve.prototype.point=function(){throw new Error("Not implemented")};BaseCurve.prototype.validate=function(){throw new Error("Not implemented")};BaseCurve.prototype._fixedNafMul=function(At,xt){assert$h(At.precomputed);var Bt=At._getDoubles(),Nt=getNAF(xt,1,this._bitLength),jt=(1<<Bt.step+1)-(Bt.step%2===0?2:1);jt/=3;var Ut=[],Lt,Ht;for(Lt=0;Lt<Nt.length;Lt+=Bt.step){Ht=0;for(var Vt=Lt+Bt.step-1;Vt>=Lt;Vt--)Ht=(Ht<<1)+Nt[Vt];Ut.push(Ht)}for(var zt=this.jpoint(null,null,null),Wt=this.jpoint(null,null,null),Jt=jt;Jt>0;Jt--){for(Lt=0;Lt<Ut.length;Lt++)Ht=Ut[Lt],Ht===Jt?Wt=Wt.mixedAdd(Bt.points[Lt]):Ht===-Jt&&(Wt=Wt.mixedAdd(Bt.points[Lt].neg()));zt=zt.add(Wt)}return zt.toP()};BaseCurve.prototype._wnafMul=function(At,xt){var Bt=4,Nt=At._getNAFPoints(Bt);Bt=Nt.wnd;for(var jt=Nt.points,Ut=getNAF(xt,Bt,this._bitLength),Lt=this.jpoint(null,null,null),Ht=Ut.length-1;Ht>=0;Ht--){for(var Vt=0;Ht>=0&&Ut[Ht]===0;Ht--)Vt++;if(Ht>=0&&Vt++,Lt=Lt.dblp(Vt),Ht<0)break;var zt=Ut[Ht];assert$h(zt!==0),At.type==="affine"?zt>0?Lt=Lt.mixedAdd(jt[zt-1>>1]):Lt=Lt.mixedAdd(jt[-zt-1>>1].neg()):zt>0?Lt=Lt.add(jt[zt-1>>1]):Lt=Lt.add(jt[-zt-1>>1].neg())}return At.type==="affine"?Lt.toP():Lt};BaseCurve.prototype._wnafMulAdd=function(At,xt,Bt,Nt,jt){var Ut=this._wnafT1,Lt=this._wnafT2,Ht=this._wnafT3,Vt=0,zt,Wt,Jt;for(zt=0;zt<Nt;zt++){Jt=xt[zt];var Qt=Jt._getNAFPoints(At);Ut[zt]=Qt.wnd,Lt[zt]=Qt.points}for(zt=Nt-1;zt>=1;zt-=2){var Xt=zt-1,tr=zt;if(Ut[Xt]!==1||Ut[tr]!==1){Ht[Xt]=getNAF(Bt[Xt],Ut[Xt],this._bitLength),Ht[tr]=getNAF(Bt[tr],Ut[tr],this._bitLength),Vt=Math.max(Ht[Xt].length,Vt),Vt=Math.max(Ht[tr].length,Vt);continue}var rr=[xt[Xt],null,null,xt[tr]];xt[Xt].y.cmp(xt[tr].y)===0?(rr[1]=xt[Xt].add(xt[tr]),rr[2]=xt[Xt].toJ().mixedAdd(xt[tr].neg())):xt[Xt].y.cmp(xt[tr].y.redNeg())===0?(rr[1]=xt[Xt].toJ().mixedAdd(xt[tr]),rr[2]=xt[Xt].add(xt[tr].neg())):(rr[1]=xt[Xt].toJ().mixedAdd(xt[tr]),rr[2]=xt[Xt].toJ().mixedAdd(xt[tr].neg()));var nr=[-3,-1,-5,-7,0,7,5,1,3],ar=getJSF(Bt[Xt],Bt[tr]);for(Vt=Math.max(ar[0].length,Vt),Ht[Xt]=new Array(Vt),Ht[tr]=new Array(Vt),Wt=0;Wt<Vt;Wt++){var ir=ar[0][Wt]|0,lr=ar[1][Wt]|0;Ht[Xt][Wt]=nr[(ir+1)*3+(lr+1)],Ht[tr][Wt]=0,Lt[Xt]=rr}}var yr=this.jpoint(null,null,null),Sr=this._wnafT4;for(zt=Vt;zt>=0;zt--){for(var Ar=0;zt>=0;){var Dr=!0;for(Wt=0;Wt<Nt;Wt++)Sr[Wt]=Ht[Wt][zt]|0,Sr[Wt]!==0&&(Dr=!1);if(!Dr)break;Ar++,zt--}if(zt>=0&&Ar++,yr=yr.dblp(Ar),zt<0)break;for(Wt=0;Wt<Nt;Wt++){var Br=Sr[Wt];Br!==0&&(Br>0?Jt=Lt[Wt][Br-1>>1]:Br<0&&(Jt=Lt[Wt][-Br-1>>1].neg()),Jt.type==="affine"?yr=yr.mixedAdd(Jt):yr=yr.add(Jt))}}for(zt=0;zt<Nt;zt++)Lt[zt]=null;return jt?yr:yr.toP()};function BasePoint(kt,At){this.curve=kt,this.type=At,this.precomputed=null}BaseCurve.BasePoint=BasePoint;BasePoint.prototype.eq=function(){throw new Error("Not implemented")};BasePoint.prototype.validate=function(){return this.curve.validate(this)};BaseCurve.prototype.decodePoint=function(At,xt){At=utils$r.toArray(At,xt);var Bt=this.p.byteLength();if((At[0]===4||At[0]===6||At[0]===7)&&At.length-1===2*Bt){At[0]===6?assert$h(At[At.length-1]%2===0):At[0]===7&&assert$h(At[At.length-1]%2===1);var Nt=this.point(At.slice(1,1+Bt),At.slice(1+Bt,1+2*Bt));return Nt}else if((At[0]===2||At[0]===3)&&At.length-1===Bt)return this.pointFromX(At.slice(1,1+Bt),At[0]===3);throw new Error("Unknown point format")};BasePoint.prototype.encodeCompressed=function(At){return this.encode(At,!0)};BasePoint.prototype._encode=function(At){var xt=this.curve.p.byteLength(),Bt=this.getX().toArray("be",xt);return At?[this.getY().isEven()?2:3].concat(Bt):[4].concat(Bt,this.getY().toArray("be",xt))};BasePoint.prototype.encode=function(At,xt){return utils$r.encode(this._encode(xt),At)};BasePoint.prototype.precompute=function(At){if(this.precomputed)return this;var xt={doubles:null,naf:null,beta:null};return xt.naf=this._getNAFPoints(8),xt.doubles=this._getDoubles(4,At),xt.beta=this._getBeta(),this.precomputed=xt,this};BasePoint.prototype._hasDoubles=function(At){if(!this.precomputed)return!1;var xt=this.precomputed.doubles;return xt?xt.points.length>=Math.ceil((At.bitLength()+1)/xt.step):!1};BasePoint.prototype._getDoubles=function(At,xt){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var Bt=[this],Nt=this,jt=0;jt<xt;jt+=At){for(var Ut=0;Ut<At;Ut++)Nt=Nt.dbl();Bt.push(Nt)}return{step:At,points:Bt}};BasePoint.prototype._getNAFPoints=function(At){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var xt=[this],Bt=(1<<At)-1,Nt=Bt===1?null:this.dbl(),jt=1;jt<Bt;jt++)xt[jt]=xt[jt-1].add(Nt);return{wnd:At,points:xt}};BasePoint.prototype._getBeta=function(){return null};BasePoint.prototype.dblp=function(At){for(var xt=this,Bt=0;Bt<At;Bt++)xt=xt.dbl();return xt};var utils$q=utils$t,BN$8=bnExports$1,inherits$4=inherits_browserExports,Base$2=base$2,assert$g=utils$q.assert;function ShortCurve(kt){Base$2.call(this,"short",kt),this.a=new BN$8(kt.a,16).toRed(this.red),this.b=new BN$8(kt.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(kt),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}inherits$4(ShortCurve,Base$2);var short=ShortCurve;ShortCurve.prototype._getEndomorphism=function(At){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var xt,Bt;if(At.beta)xt=new BN$8(At.beta,16).toRed(this.red);else{var Nt=this._getEndoRoots(this.p);xt=Nt[0].cmp(Nt[1])<0?Nt[0]:Nt[1],xt=xt.toRed(this.red)}if(At.lambda)Bt=new BN$8(At.lambda,16);else{var jt=this._getEndoRoots(this.n);this.g.mul(jt[0]).x.cmp(this.g.x.redMul(xt))===0?Bt=jt[0]:(Bt=jt[1],assert$g(this.g.mul(Bt).x.cmp(this.g.x.redMul(xt))===0))}var Ut;return At.basis?Ut=At.basis.map(function(Lt){return{a:new BN$8(Lt.a,16),b:new BN$8(Lt.b,16)}}):Ut=this._getEndoBasis(Bt),{beta:xt,lambda:Bt,basis:Ut}}};ShortCurve.prototype._getEndoRoots=function(At){var xt=At===this.p?this.red:BN$8.mont(At),Bt=new BN$8(2).toRed(xt).redInvm(),Nt=Bt.redNeg(),jt=new BN$8(3).toRed(xt).redNeg().redSqrt().redMul(Bt),Ut=Nt.redAdd(jt).fromRed(),Lt=Nt.redSub(jt).fromRed();return[Ut,Lt]};ShortCurve.prototype._getEndoBasis=function(At){for(var xt=this.n.ushrn(Math.floor(this.n.bitLength()/2)),Bt=At,Nt=this.n.clone(),jt=new BN$8(1),Ut=new BN$8(0),Lt=new BN$8(0),Ht=new BN$8(1),Vt,zt,Wt,Jt,Qt,Xt,tr,rr=0,nr,ar;Bt.cmpn(0)!==0;){var ir=Nt.div(Bt);nr=Nt.sub(ir.mul(Bt)),ar=Lt.sub(ir.mul(jt));var lr=Ht.sub(ir.mul(Ut));if(!Wt&&nr.cmp(xt)<0)Vt=tr.neg(),zt=jt,Wt=nr.neg(),Jt=ar;else if(Wt&&++rr===2)break;tr=nr,Nt=Bt,Bt=nr,Lt=jt,jt=ar,Ht=Ut,Ut=lr}Qt=nr.neg(),Xt=ar;var yr=Wt.sqr().add(Jt.sqr()),Sr=Qt.sqr().add(Xt.sqr());return Sr.cmp(yr)>=0&&(Qt=Vt,Xt=zt),Wt.negative&&(Wt=Wt.neg(),Jt=Jt.neg()),Qt.negative&&(Qt=Qt.neg(),Xt=Xt.neg()),[{a:Wt,b:Jt},{a:Qt,b:Xt}]};ShortCurve.prototype._endoSplit=function(At){var xt=this.endo.basis,Bt=xt[0],Nt=xt[1],jt=Nt.b.mul(At).divRound(this.n),Ut=Bt.b.neg().mul(At).divRound(this.n),Lt=jt.mul(Bt.a),Ht=Ut.mul(Nt.a),Vt=jt.mul(Bt.b),zt=Ut.mul(Nt.b),Wt=At.sub(Lt).sub(Ht),Jt=Vt.add(zt).neg();return{k1:Wt,k2:Jt}};ShortCurve.prototype.pointFromX=function(At,xt){At=new BN$8(At,16),At.red||(At=At.toRed(this.red));var Bt=At.redSqr().redMul(At).redIAdd(At.redMul(this.a)).redIAdd(this.b),Nt=Bt.redSqrt();if(Nt.redSqr().redSub(Bt).cmp(this.zero)!==0)throw new Error("invalid point");var jt=Nt.fromRed().isOdd();return(xt&&!jt||!xt&&jt)&&(Nt=Nt.redNeg()),this.point(At,Nt)};ShortCurve.prototype.validate=function(At){if(At.inf)return!0;var xt=At.x,Bt=At.y,Nt=this.a.redMul(xt),jt=xt.redSqr().redMul(xt).redIAdd(Nt).redIAdd(this.b);return Bt.redSqr().redISub(jt).cmpn(0)===0};ShortCurve.prototype._endoWnafMulAdd=function(At,xt,Bt){for(var Nt=this._endoWnafT1,jt=this._endoWnafT2,Ut=0;Ut<At.length;Ut++){var Lt=this._endoSplit(xt[Ut]),Ht=At[Ut],Vt=Ht._getBeta();Lt.k1.negative&&(Lt.k1.ineg(),Ht=Ht.neg(!0)),Lt.k2.negative&&(Lt.k2.ineg(),Vt=Vt.neg(!0)),Nt[Ut*2]=Ht,Nt[Ut*2+1]=Vt,jt[Ut*2]=Lt.k1,jt[Ut*2+1]=Lt.k2}for(var zt=this._wnafMulAdd(1,Nt,jt,Ut*2,Bt),Wt=0;Wt<Ut*2;Wt++)Nt[Wt]=null,jt[Wt]=null;return zt};function Point$2(kt,At,xt,Bt){Base$2.BasePoint.call(this,kt,"affine"),At===null&&xt===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN$8(At,16),this.y=new BN$8(xt,16),Bt&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}inherits$4(Point$2,Base$2.BasePoint);ShortCurve.prototype.point=function(At,xt,Bt){return new Point$2(this,At,xt,Bt)};ShortCurve.prototype.pointFromJSON=function(At,xt){return Point$2.fromJSON(this,At,xt)};Point$2.prototype._getBeta=function(){if(this.curve.endo){var At=this.precomputed;if(At&&At.beta)return At.beta;var xt=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(At){var Bt=this.curve,Nt=function(jt){return Bt.point(jt.x.redMul(Bt.endo.beta),jt.y)};At.beta=xt,xt.precomputed={beta:null,naf:At.naf&&{wnd:At.naf.wnd,points:At.naf.points.map(Nt)},doubles:At.doubles&&{step:At.doubles.step,points:At.doubles.points.map(Nt)}}}return xt}};Point$2.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Point$2.fromJSON=function(At,xt,Bt){typeof xt=="string"&&(xt=JSON.parse(xt));var Nt=At.point(xt[0],xt[1],Bt);if(!xt[2])return Nt;function jt(Lt){return At.point(Lt[0],Lt[1],Bt)}var Ut=xt[2];return Nt.precomputed={beta:null,doubles:Ut.doubles&&{step:Ut.doubles.step,points:[Nt].concat(Ut.doubles.points.map(jt))},naf:Ut.naf&&{wnd:Ut.naf.wnd,points:[Nt].concat(Ut.naf.points.map(jt))}},Nt};Point$2.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Point$2.prototype.isInfinity=function(){return this.inf};Point$2.prototype.add=function(At){if(this.inf)return At;if(At.inf)return this;if(this.eq(At))return this.dbl();if(this.neg().eq(At))return this.curve.point(null,null);if(this.x.cmp(At.x)===0)return this.curve.point(null,null);var xt=this.y.redSub(At.y);xt.cmpn(0)!==0&&(xt=xt.redMul(this.x.redSub(At.x).redInvm()));var Bt=xt.redSqr().redISub(this.x).redISub(At.x),Nt=xt.redMul(this.x.redSub(Bt)).redISub(this.y);return this.curve.point(Bt,Nt)};Point$2.prototype.dbl=function(){if(this.inf)return this;var At=this.y.redAdd(this.y);if(At.cmpn(0)===0)return this.curve.point(null,null);var xt=this.curve.a,Bt=this.x.redSqr(),Nt=At.redInvm(),jt=Bt.redAdd(Bt).redIAdd(Bt).redIAdd(xt).redMul(Nt),Ut=jt.redSqr().redISub(this.x.redAdd(this.x)),Lt=jt.redMul(this.x.redSub(Ut)).redISub(this.y);return this.curve.point(Ut,Lt)};Point$2.prototype.getX=function(){return this.x.fromRed()};Point$2.prototype.getY=function(){return this.y.fromRed()};Point$2.prototype.mul=function(At){return At=new BN$8(At,16),this.isInfinity()?this:this._hasDoubles(At)?this.curve._fixedNafMul(this,At):this.curve.endo?this.curve._endoWnafMulAdd([this],[At]):this.curve._wnafMul(this,At)};Point$2.prototype.mulAdd=function(At,xt,Bt){var Nt=[this,xt],jt=[At,Bt];return this.curve.endo?this.curve._endoWnafMulAdd(Nt,jt):this.curve._wnafMulAdd(1,Nt,jt,2)};Point$2.prototype.jmulAdd=function(At,xt,Bt){var Nt=[this,xt],jt=[At,Bt];return this.curve.endo?this.curve._endoWnafMulAdd(Nt,jt,!0):this.curve._wnafMulAdd(1,Nt,jt,2,!0)};Point$2.prototype.eq=function(At){return this===At||this.inf===At.inf&&(this.inf||this.x.cmp(At.x)===0&&this.y.cmp(At.y)===0)};Point$2.prototype.neg=function(At){if(this.inf)return this;var xt=this.curve.point(this.x,this.y.redNeg());if(At&&this.precomputed){var Bt=this.precomputed,Nt=function(jt){return jt.neg()};xt.precomputed={naf:Bt.naf&&{wnd:Bt.naf.wnd,points:Bt.naf.points.map(Nt)},doubles:Bt.doubles&&{step:Bt.doubles.step,points:Bt.doubles.points.map(Nt)}}}return xt};Point$2.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var At=this.curve.jpoint(this.x,this.y,this.curve.one);return At};function JPoint(kt,At,xt,Bt){Base$2.BasePoint.call(this,kt,"jacobian"),At===null&&xt===null&&Bt===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN$8(0)):(this.x=new BN$8(At,16),this.y=new BN$8(xt,16),this.z=new BN$8(Bt,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}inherits$4(JPoint,Base$2.BasePoint);ShortCurve.prototype.jpoint=function(At,xt,Bt){return new JPoint(this,At,xt,Bt)};JPoint.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var At=this.z.redInvm(),xt=At.redSqr(),Bt=this.x.redMul(xt),Nt=this.y.redMul(xt).redMul(At);return this.curve.point(Bt,Nt)};JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint.prototype.add=function(At){if(this.isInfinity())return At;if(At.isInfinity())return this;var xt=At.z.redSqr(),Bt=this.z.redSqr(),Nt=this.x.redMul(xt),jt=At.x.redMul(Bt),Ut=this.y.redMul(xt.redMul(At.z)),Lt=At.y.redMul(Bt.redMul(this.z)),Ht=Nt.redSub(jt),Vt=Ut.redSub(Lt);if(Ht.cmpn(0)===0)return Vt.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var zt=Ht.redSqr(),Wt=zt.redMul(Ht),Jt=Nt.redMul(zt),Qt=Vt.redSqr().redIAdd(Wt).redISub(Jt).redISub(Jt),Xt=Vt.redMul(Jt.redISub(Qt)).redISub(Ut.redMul(Wt)),tr=this.z.redMul(At.z).redMul(Ht);return this.curve.jpoint(Qt,Xt,tr)};JPoint.prototype.mixedAdd=function(At){if(this.isInfinity())return At.toJ();if(At.isInfinity())return this;var xt=this.z.redSqr(),Bt=this.x,Nt=At.x.redMul(xt),jt=this.y,Ut=At.y.redMul(xt).redMul(this.z),Lt=Bt.redSub(Nt),Ht=jt.redSub(Ut);if(Lt.cmpn(0)===0)return Ht.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var Vt=Lt.redSqr(),zt=Vt.redMul(Lt),Wt=Bt.redMul(Vt),Jt=Ht.redSqr().redIAdd(zt).redISub(Wt).redISub(Wt),Qt=Ht.redMul(Wt.redISub(Jt)).redISub(jt.redMul(zt)),Xt=this.z.redMul(Lt);return this.curve.jpoint(Jt,Qt,Xt)};JPoint.prototype.dblp=function(At){if(At===0)return this;if(this.isInfinity())return this;if(!At)return this.dbl();var xt;if(this.curve.zeroA||this.curve.threeA){var Bt=this;for(xt=0;xt<At;xt++)Bt=Bt.dbl();return Bt}var Nt=this.curve.a,jt=this.curve.tinv,Ut=this.x,Lt=this.y,Ht=this.z,Vt=Ht.redSqr().redSqr(),zt=Lt.redAdd(Lt);for(xt=0;xt<At;xt++){var Wt=Ut.redSqr(),Jt=zt.redSqr(),Qt=Jt.redSqr(),Xt=Wt.redAdd(Wt).redIAdd(Wt).redIAdd(Nt.redMul(Vt)),tr=Ut.redMul(Jt),rr=Xt.redSqr().redISub(tr.redAdd(tr)),nr=tr.redISub(rr),ar=Xt.redMul(nr);ar=ar.redIAdd(ar).redISub(Qt);var ir=zt.redMul(Ht);xt+1<At&&(Vt=Vt.redMul(Qt)),Ut=rr,Ht=ir,zt=ar}return this.curve.jpoint(Ut,zt.redMul(jt),Ht)};JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};JPoint.prototype._zeroDbl=function(){var At,xt,Bt;if(this.zOne){var Nt=this.x.redSqr(),jt=this.y.redSqr(),Ut=jt.redSqr(),Lt=this.x.redAdd(jt).redSqr().redISub(Nt).redISub(Ut);Lt=Lt.redIAdd(Lt);var Ht=Nt.redAdd(Nt).redIAdd(Nt),Vt=Ht.redSqr().redISub(Lt).redISub(Lt),zt=Ut.redIAdd(Ut);zt=zt.redIAdd(zt),zt=zt.redIAdd(zt),At=Vt,xt=Ht.redMul(Lt.redISub(Vt)).redISub(zt),Bt=this.y.redAdd(this.y)}else{var Wt=this.x.redSqr(),Jt=this.y.redSqr(),Qt=Jt.redSqr(),Xt=this.x.redAdd(Jt).redSqr().redISub(Wt).redISub(Qt);Xt=Xt.redIAdd(Xt);var tr=Wt.redAdd(Wt).redIAdd(Wt),rr=tr.redSqr(),nr=Qt.redIAdd(Qt);nr=nr.redIAdd(nr),nr=nr.redIAdd(nr),At=rr.redISub(Xt).redISub(Xt),xt=tr.redMul(Xt.redISub(At)).redISub(nr),Bt=this.y.redMul(this.z),Bt=Bt.redIAdd(Bt)}return this.curve.jpoint(At,xt,Bt)};JPoint.prototype._threeDbl=function(){var At,xt,Bt;if(this.zOne){var Nt=this.x.redSqr(),jt=this.y.redSqr(),Ut=jt.redSqr(),Lt=this.x.redAdd(jt).redSqr().redISub(Nt).redISub(Ut);Lt=Lt.redIAdd(Lt);var Ht=Nt.redAdd(Nt).redIAdd(Nt).redIAdd(this.curve.a),Vt=Ht.redSqr().redISub(Lt).redISub(Lt);At=Vt;var zt=Ut.redIAdd(Ut);zt=zt.redIAdd(zt),zt=zt.redIAdd(zt),xt=Ht.redMul(Lt.redISub(Vt)).redISub(zt),Bt=this.y.redAdd(this.y)}else{var Wt=this.z.redSqr(),Jt=this.y.redSqr(),Qt=this.x.redMul(Jt),Xt=this.x.redSub(Wt).redMul(this.x.redAdd(Wt));Xt=Xt.redAdd(Xt).redIAdd(Xt);var tr=Qt.redIAdd(Qt);tr=tr.redIAdd(tr);var rr=tr.redAdd(tr);At=Xt.redSqr().redISub(rr),Bt=this.y.redAdd(this.z).redSqr().redISub(Jt).redISub(Wt);var nr=Jt.redSqr();nr=nr.redIAdd(nr),nr=nr.redIAdd(nr),nr=nr.redIAdd(nr),xt=Xt.redMul(tr.redISub(At)).redISub(nr)}return this.curve.jpoint(At,xt,Bt)};JPoint.prototype._dbl=function(){var At=this.curve.a,xt=this.x,Bt=this.y,Nt=this.z,jt=Nt.redSqr().redSqr(),Ut=xt.redSqr(),Lt=Bt.redSqr(),Ht=Ut.redAdd(Ut).redIAdd(Ut).redIAdd(At.redMul(jt)),Vt=xt.redAdd(xt);Vt=Vt.redIAdd(Vt);var zt=Vt.redMul(Lt),Wt=Ht.redSqr().redISub(zt.redAdd(zt)),Jt=zt.redISub(Wt),Qt=Lt.redSqr();Qt=Qt.redIAdd(Qt),Qt=Qt.redIAdd(Qt),Qt=Qt.redIAdd(Qt);var Xt=Ht.redMul(Jt).redISub(Qt),tr=Bt.redAdd(Bt).redMul(Nt);return this.curve.jpoint(Wt,Xt,tr)};JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var At=this.x.redSqr(),xt=this.y.redSqr(),Bt=this.z.redSqr(),Nt=xt.redSqr(),jt=At.redAdd(At).redIAdd(At),Ut=jt.redSqr(),Lt=this.x.redAdd(xt).redSqr().redISub(At).redISub(Nt);Lt=Lt.redIAdd(Lt),Lt=Lt.redAdd(Lt).redIAdd(Lt),Lt=Lt.redISub(Ut);var Ht=Lt.redSqr(),Vt=Nt.redIAdd(Nt);Vt=Vt.redIAdd(Vt),Vt=Vt.redIAdd(Vt),Vt=Vt.redIAdd(Vt);var zt=jt.redIAdd(Lt).redSqr().redISub(Ut).redISub(Ht).redISub(Vt),Wt=xt.redMul(zt);Wt=Wt.redIAdd(Wt),Wt=Wt.redIAdd(Wt);var Jt=this.x.redMul(Ht).redISub(Wt);Jt=Jt.redIAdd(Jt),Jt=Jt.redIAdd(Jt);var Qt=this.y.redMul(zt.redMul(Vt.redISub(zt)).redISub(Lt.redMul(Ht)));Qt=Qt.redIAdd(Qt),Qt=Qt.redIAdd(Qt),Qt=Qt.redIAdd(Qt);var Xt=this.z.redAdd(Lt).redSqr().redISub(Bt).redISub(Ht);return this.curve.jpoint(Jt,Qt,Xt)};JPoint.prototype.mul=function(At,xt){return At=new BN$8(At,xt),this.curve._wnafMul(this,At)};JPoint.prototype.eq=function(At){if(At.type==="affine")return this.eq(At.toJ());if(this===At)return!0;var xt=this.z.redSqr(),Bt=At.z.redSqr();if(this.x.redMul(Bt).redISub(At.x.redMul(xt)).cmpn(0)!==0)return!1;var Nt=xt.redMul(this.z),jt=Bt.redMul(At.z);return this.y.redMul(jt).redISub(At.y.redMul(Nt)).cmpn(0)===0};JPoint.prototype.eqXToP=function(At){var xt=this.z.redSqr(),Bt=At.toRed(this.curve.red).redMul(xt);if(this.x.cmp(Bt)===0)return!0;for(var Nt=At.clone(),jt=this.curve.redN.redMul(xt);;){if(Nt.iadd(this.curve.n),Nt.cmp(this.curve.p)>=0)return!1;if(Bt.redIAdd(jt),this.x.cmp(Bt)===0)return!0}};JPoint.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};JPoint.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var BN$7=bnExports$1,inherits$3=inherits_browserExports,Base$1=base$2,utils$p=utils$t;function MontCurve(kt){Base$1.call(this,"mont",kt),this.a=new BN$7(kt.a,16).toRed(this.red),this.b=new BN$7(kt.b,16).toRed(this.red),this.i4=new BN$7(4).toRed(this.red).redInvm(),this.two=new BN$7(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}inherits$3(MontCurve,Base$1);var mont=MontCurve;MontCurve.prototype.validate=function(At){var xt=At.normalize().x,Bt=xt.redSqr(),Nt=Bt.redMul(xt).redAdd(Bt.redMul(this.a)).redAdd(xt),jt=Nt.redSqrt();return jt.redSqr().cmp(Nt)===0};function Point$1(kt,At,xt){Base$1.BasePoint.call(this,kt,"projective"),At===null&&xt===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN$7(At,16),this.z=new BN$7(xt,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}inherits$3(Point$1,Base$1.BasePoint);MontCurve.prototype.decodePoint=function(At,xt){return this.point(utils$p.toArray(At,xt),1)};MontCurve.prototype.point=function(At,xt){return new Point$1(this,At,xt)};MontCurve.prototype.pointFromJSON=function(At){return Point$1.fromJSON(this,At)};Point$1.prototype.precompute=function(){};Point$1.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Point$1.fromJSON=function(At,xt){return new Point$1(At,xt[0],xt[1]||At.one)};Point$1.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point$1.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Point$1.prototype.dbl=function(){var At=this.x.redAdd(this.z),xt=At.redSqr(),Bt=this.x.redSub(this.z),Nt=Bt.redSqr(),jt=xt.redSub(Nt),Ut=xt.redMul(Nt),Lt=jt.redMul(Nt.redAdd(this.curve.a24.redMul(jt)));return this.curve.point(Ut,Lt)};Point$1.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Point$1.prototype.diffAdd=function(At,xt){var Bt=this.x.redAdd(this.z),Nt=this.x.redSub(this.z),jt=At.x.redAdd(At.z),Ut=At.x.redSub(At.z),Lt=Ut.redMul(Bt),Ht=jt.redMul(Nt),Vt=xt.z.redMul(Lt.redAdd(Ht).redSqr()),zt=xt.x.redMul(Lt.redISub(Ht).redSqr());return this.curve.point(Vt,zt)};Point$1.prototype.mul=function(At){for(var xt=At.clone(),Bt=this,Nt=this.curve.point(null,null),jt=this,Ut=[];xt.cmpn(0)!==0;xt.iushrn(1))Ut.push(xt.andln(1));for(var Lt=Ut.length-1;Lt>=0;Lt--)Ut[Lt]===0?(Bt=Bt.diffAdd(Nt,jt),Nt=Nt.dbl()):(Nt=Bt.diffAdd(Nt,jt),Bt=Bt.dbl());return Nt};Point$1.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Point$1.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Point$1.prototype.eq=function(At){return this.getX().cmp(At.getX())===0};Point$1.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Point$1.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var utils$o=utils$t,BN$6=bnExports$1,inherits$2=inherits_browserExports,Base=base$2,assert$f=utils$o.assert;function EdwardsCurve(kt){this.twisted=(kt.a|0)!==1,this.mOneA=this.twisted&&(kt.a|0)===-1,this.extended=this.mOneA,Base.call(this,"edwards",kt),this.a=new BN$6(kt.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN$6(kt.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN$6(kt.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert$f(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(kt.c|0)===1}inherits$2(EdwardsCurve,Base);var edwards$1=EdwardsCurve;EdwardsCurve.prototype._mulA=function(At){return this.mOneA?At.redNeg():this.a.redMul(At)};EdwardsCurve.prototype._mulC=function(At){return this.oneC?At:this.c.redMul(At)};EdwardsCurve.prototype.jpoint=function(At,xt,Bt,Nt){return this.point(At,xt,Bt,Nt)};EdwardsCurve.prototype.pointFromX=function(At,xt){At=new BN$6(At,16),At.red||(At=At.toRed(this.red));var Bt=At.redSqr(),Nt=this.c2.redSub(this.a.redMul(Bt)),jt=this.one.redSub(this.c2.redMul(this.d).redMul(Bt)),Ut=Nt.redMul(jt.redInvm()),Lt=Ut.redSqrt();if(Lt.redSqr().redSub(Ut).cmp(this.zero)!==0)throw new Error("invalid point");var Ht=Lt.fromRed().isOdd();return(xt&&!Ht||!xt&&Ht)&&(Lt=Lt.redNeg()),this.point(At,Lt)};EdwardsCurve.prototype.pointFromY=function(At,xt){At=new BN$6(At,16),At.red||(At=At.toRed(this.red));var Bt=At.redSqr(),Nt=Bt.redSub(this.c2),jt=Bt.redMul(this.d).redMul(this.c2).redSub(this.a),Ut=Nt.redMul(jt.redInvm());if(Ut.cmp(this.zero)===0){if(xt)throw new Error("invalid point");return this.point(this.zero,At)}var Lt=Ut.redSqrt();if(Lt.redSqr().redSub(Ut).cmp(this.zero)!==0)throw new Error("invalid point");return Lt.fromRed().isOdd()!==xt&&(Lt=Lt.redNeg()),this.point(Lt,At)};EdwardsCurve.prototype.validate=function(At){if(At.isInfinity())return!0;At.normalize();var xt=At.x.redSqr(),Bt=At.y.redSqr(),Nt=xt.redMul(this.a).redAdd(Bt),jt=this.c2.redMul(this.one.redAdd(this.d.redMul(xt).redMul(Bt)));return Nt.cmp(jt)===0};function Point(kt,At,xt,Bt,Nt){Base.BasePoint.call(this,kt,"projective"),At===null&&xt===null&&Bt===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN$6(At,16),this.y=new BN$6(xt,16),this.z=Bt?new BN$6(Bt,16):this.curve.one,this.t=Nt&&new BN$6(Nt,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}inherits$2(Point,Base.BasePoint);EdwardsCurve.prototype.pointFromJSON=function(At){return Point.fromJSON(this,At)};EdwardsCurve.prototype.point=function(At,xt,Bt,Nt){return new Point(this,At,xt,Bt,Nt)};Point.fromJSON=function(At,xt){return new Point(At,xt[0],xt[1],xt[2])};Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Point.prototype._extDbl=function(){var At=this.x.redSqr(),xt=this.y.redSqr(),Bt=this.z.redSqr();Bt=Bt.redIAdd(Bt);var Nt=this.curve._mulA(At),jt=this.x.redAdd(this.y).redSqr().redISub(At).redISub(xt),Ut=Nt.redAdd(xt),Lt=Ut.redSub(Bt),Ht=Nt.redSub(xt),Vt=jt.redMul(Lt),zt=Ut.redMul(Ht),Wt=jt.redMul(Ht),Jt=Lt.redMul(Ut);return this.curve.point(Vt,zt,Jt,Wt)};Point.prototype._projDbl=function(){var At=this.x.redAdd(this.y).redSqr(),xt=this.x.redSqr(),Bt=this.y.redSqr(),Nt,jt,Ut,Lt,Ht,Vt;if(this.curve.twisted){Lt=this.curve._mulA(xt);var zt=Lt.redAdd(Bt);this.zOne?(Nt=At.redSub(xt).redSub(Bt).redMul(zt.redSub(this.curve.two)),jt=zt.redMul(Lt.redSub(Bt)),Ut=zt.redSqr().redSub(zt).redSub(zt)):(Ht=this.z.redSqr(),Vt=zt.redSub(Ht).redISub(Ht),Nt=At.redSub(xt).redISub(Bt).redMul(Vt),jt=zt.redMul(Lt.redSub(Bt)),Ut=zt.redMul(Vt))}else Lt=xt.redAdd(Bt),Ht=this.curve._mulC(this.z).redSqr(),Vt=Lt.redSub(Ht).redSub(Ht),Nt=this.curve._mulC(At.redISub(Lt)).redMul(Vt),jt=this.curve._mulC(Lt).redMul(xt.redISub(Bt)),Ut=Lt.redMul(Vt);return this.curve.point(Nt,jt,Ut)};Point.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Point.prototype._extAdd=function(At){var xt=this.y.redSub(this.x).redMul(At.y.redSub(At.x)),Bt=this.y.redAdd(this.x).redMul(At.y.redAdd(At.x)),Nt=this.t.redMul(this.curve.dd).redMul(At.t),jt=this.z.redMul(At.z.redAdd(At.z)),Ut=Bt.redSub(xt),Lt=jt.redSub(Nt),Ht=jt.redAdd(Nt),Vt=Bt.redAdd(xt),zt=Ut.redMul(Lt),Wt=Ht.redMul(Vt),Jt=Ut.redMul(Vt),Qt=Lt.redMul(Ht);return this.curve.point(zt,Wt,Qt,Jt)};Point.prototype._projAdd=function(At){var xt=this.z.redMul(At.z),Bt=xt.redSqr(),Nt=this.x.redMul(At.x),jt=this.y.redMul(At.y),Ut=this.curve.d.redMul(Nt).redMul(jt),Lt=Bt.redSub(Ut),Ht=Bt.redAdd(Ut),Vt=this.x.redAdd(this.y).redMul(At.x.redAdd(At.y)).redISub(Nt).redISub(jt),zt=xt.redMul(Lt).redMul(Vt),Wt,Jt;return this.curve.twisted?(Wt=xt.redMul(Ht).redMul(jt.redSub(this.curve._mulA(Nt))),Jt=Lt.redMul(Ht)):(Wt=xt.redMul(Ht).redMul(jt.redSub(Nt)),Jt=this.curve._mulC(Lt).redMul(Ht)),this.curve.point(zt,Wt,Jt)};Point.prototype.add=function(At){return this.isInfinity()?At:At.isInfinity()?this:this.curve.extended?this._extAdd(At):this._projAdd(At)};Point.prototype.mul=function(At){return this._hasDoubles(At)?this.curve._fixedNafMul(this,At):this.curve._wnafMul(this,At)};Point.prototype.mulAdd=function(At,xt,Bt){return this.curve._wnafMulAdd(1,[this,xt],[At,Bt],2,!1)};Point.prototype.jmulAdd=function(At,xt,Bt){return this.curve._wnafMulAdd(1,[this,xt],[At,Bt],2,!0)};Point.prototype.normalize=function(){if(this.zOne)return this;var At=this.z.redInvm();return this.x=this.x.redMul(At),this.y=this.y.redMul(At),this.t&&(this.t=this.t.redMul(At)),this.z=this.curve.one,this.zOne=!0,this};Point.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Point.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Point.prototype.eq=function(At){return this===At||this.getX().cmp(At.getX())===0&&this.getY().cmp(At.getY())===0};Point.prototype.eqXToP=function(At){var xt=At.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(xt)===0)return!0;for(var Bt=At.clone(),Nt=this.curve.redN.redMul(this.z);;){if(Bt.iadd(this.curve.n),Bt.cmp(this.curve.p)>=0)return!1;if(xt.redIAdd(Nt),this.x.cmp(xt)===0)return!0}};Point.prototype.toP=Point.prototype.normalize;Point.prototype.mixedAdd=Point.prototype.add;(function(kt){var At=kt;At.base=base$2,At.short=short,At.mont=mont,At.edwards=edwards$1})(curve$1);var curves$1={},hash$5={},utils$n={},assert$e=minimalisticAssert,inherits$1=inherits_browserExports;utils$n.inherits=inherits$1;function isSurrogatePair(kt,At){return(kt.charCodeAt(At)&64512)!==55296||At<0||At+1>=kt.length?!1:(kt.charCodeAt(At+1)&64512)===56320}function toArray$2(kt,At){if(Array.isArray(kt))return kt.slice();if(!kt)return[];var xt=[];if(typeof kt=="string")if(At){if(At==="hex")for(kt=kt.replace(/[^a-z0-9]+/ig,""),kt.length%2!==0&&(kt="0"+kt),Nt=0;Nt<kt.length;Nt+=2)xt.push(parseInt(kt[Nt]+kt[Nt+1],16))}else for(var Bt=0,Nt=0;Nt<kt.length;Nt++){var jt=kt.charCodeAt(Nt);jt<128?xt[Bt++]=jt:jt<2048?(xt[Bt++]=jt>>6|192,xt[Bt++]=jt&63|128):isSurrogatePair(kt,Nt)?(jt=65536+((jt&1023)<<10)+(kt.charCodeAt(++Nt)&1023),xt[Bt++]=jt>>18|240,xt[Bt++]=jt>>12&63|128,xt[Bt++]=jt>>6&63|128,xt[Bt++]=jt&63|128):(xt[Bt++]=jt>>12|224,xt[Bt++]=jt>>6&63|128,xt[Bt++]=jt&63|128)}else for(Nt=0;Nt<kt.length;Nt++)xt[Nt]=kt[Nt]|0;return xt}utils$n.toArray=toArray$2;function toHex$1(kt){for(var At="",xt=0;xt<kt.length;xt++)At+=zero2(kt[xt].toString(16));return At}utils$n.toHex=toHex$1;function htonl(kt){var At=kt>>>24|kt>>>8&65280|kt<<8&16711680|(kt&255)<<24;return At>>>0}utils$n.htonl=htonl;function toHex32(kt,At){for(var xt="",Bt=0;Bt<kt.length;Bt++){var Nt=kt[Bt];At==="little"&&(Nt=htonl(Nt)),xt+=zero8(Nt.toString(16))}return xt}utils$n.toHex32=toHex32;function zero2(kt){return kt.length===1?"0"+kt:kt}utils$n.zero2=zero2;function zero8(kt){return kt.length===7?"0"+kt:kt.length===6?"00"+kt:kt.length===5?"000"+kt:kt.length===4?"0000"+kt:kt.length===3?"00000"+kt:kt.length===2?"000000"+kt:kt.length===1?"0000000"+kt:kt}utils$n.zero8=zero8;function join32(kt,At,xt,Bt){var Nt=xt-At;assert$e(Nt%4===0);for(var jt=new Array(Nt/4),Ut=0,Lt=At;Ut<jt.length;Ut++,Lt+=4){var Ht;Bt==="big"?Ht=kt[Lt]<<24|kt[Lt+1]<<16|kt[Lt+2]<<8|kt[Lt+3]:Ht=kt[Lt+3]<<24|kt[Lt+2]<<16|kt[Lt+1]<<8|kt[Lt],jt[Ut]=Ht>>>0}return jt}utils$n.join32=join32;function split32(kt,At){for(var xt=new Array(kt.length*4),Bt=0,Nt=0;Bt<kt.length;Bt++,Nt+=4){var jt=kt[Bt];At==="big"?(xt[Nt]=jt>>>24,xt[Nt+1]=jt>>>16&255,xt[Nt+2]=jt>>>8&255,xt[Nt+3]=jt&255):(xt[Nt+3]=jt>>>24,xt[Nt+2]=jt>>>16&255,xt[Nt+1]=jt>>>8&255,xt[Nt]=jt&255)}return xt}utils$n.split32=split32;function rotr32$1(kt,At){return kt>>>At|kt<<32-At}utils$n.rotr32=rotr32$1;function rotl32$2(kt,At){return kt<<At|kt>>>32-At}utils$n.rotl32=rotl32$2;function sum32$3(kt,At){return kt+At>>>0}utils$n.sum32=sum32$3;function sum32_3$1(kt,At,xt){return kt+At+xt>>>0}utils$n.sum32_3=sum32_3$1;function sum32_4$2(kt,At,xt,Bt){return kt+At+xt+Bt>>>0}utils$n.sum32_4=sum32_4$2;function sum32_5$2(kt,At,xt,Bt,Nt){return kt+At+xt+Bt+Nt>>>0}utils$n.sum32_5=sum32_5$2;function sum64$1(kt,At,xt,Bt){var Nt=kt[At],jt=kt[At+1],Ut=Bt+jt>>>0,Lt=(Ut<Bt?1:0)+xt+Nt;kt[At]=Lt>>>0,kt[At+1]=Ut}utils$n.sum64=sum64$1;function sum64_hi$1(kt,At,xt,Bt){var Nt=At+Bt>>>0,jt=(Nt<At?1:0)+kt+xt;return jt>>>0}utils$n.sum64_hi=sum64_hi$1;function sum64_lo$1(kt,At,xt,Bt){var Nt=At+Bt;return Nt>>>0}utils$n.sum64_lo=sum64_lo$1;function sum64_4_hi$1(kt,At,xt,Bt,Nt,jt,Ut,Lt){var Ht=0,Vt=At;Vt=Vt+Bt>>>0,Ht+=Vt<At?1:0,Vt=Vt+jt>>>0,Ht+=Vt<jt?1:0,Vt=Vt+Lt>>>0,Ht+=Vt<Lt?1:0;var zt=kt+xt+Nt+Ut+Ht;return zt>>>0}utils$n.sum64_4_hi=sum64_4_hi$1;function sum64_4_lo$1(kt,At,xt,Bt,Nt,jt,Ut,Lt){var Ht=At+Bt+jt+Lt;return Ht>>>0}utils$n.sum64_4_lo=sum64_4_lo$1;function sum64_5_hi$1(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt){var zt=0,Wt=At;Wt=Wt+Bt>>>0,zt+=Wt<At?1:0,Wt=Wt+jt>>>0,zt+=Wt<jt?1:0,Wt=Wt+Lt>>>0,zt+=Wt<Lt?1:0,Wt=Wt+Vt>>>0,zt+=Wt<Vt?1:0;var Jt=kt+xt+Nt+Ut+Ht+zt;return Jt>>>0}utils$n.sum64_5_hi=sum64_5_hi$1;function sum64_5_lo$1(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt){var zt=At+Bt+jt+Lt+Vt;return zt>>>0}utils$n.sum64_5_lo=sum64_5_lo$1;function rotr64_hi$1(kt,At,xt){var Bt=At<<32-xt|kt>>>xt;return Bt>>>0}utils$n.rotr64_hi=rotr64_hi$1;function rotr64_lo$1(kt,At,xt){var Bt=kt<<32-xt|At>>>xt;return Bt>>>0}utils$n.rotr64_lo=rotr64_lo$1;function shr64_hi$1(kt,At,xt){return kt>>>xt}utils$n.shr64_hi=shr64_hi$1;function shr64_lo$1(kt,At,xt){var Bt=kt<<32-xt|At>>>xt;return Bt>>>0}utils$n.shr64_lo=shr64_lo$1;var common$6={},utils$m=utils$n,assert$d=minimalisticAssert;function BlockHash$4(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}common$6.BlockHash=BlockHash$4;BlockHash$4.prototype.update=function(At,xt){if(At=utils$m.toArray(At,xt),this.pending?this.pending=this.pending.concat(At):this.pending=At,this.pendingTotal+=At.length,this.pending.length>=this._delta8){At=this.pending;var Bt=At.length%this._delta8;this.pending=At.slice(At.length-Bt,At.length),this.pending.length===0&&(this.pending=null),At=utils$m.join32(At,0,At.length-Bt,this.endian);for(var Nt=0;Nt<At.length;Nt+=this._delta32)this._update(At,Nt,Nt+this._delta32)}return this};BlockHash$4.prototype.digest=function(At){return this.update(this._pad()),assert$d(this.pending===null),this._digest(At)};BlockHash$4.prototype._pad=function(){var At=this.pendingTotal,xt=this._delta8,Bt=xt-(At+this.padLength)%xt,Nt=new Array(Bt+this.padLength);Nt[0]=128;for(var jt=1;jt<Bt;jt++)Nt[jt]=0;if(At<<=3,this.endian==="big"){for(var Ut=8;Ut<this.padLength;Ut++)Nt[jt++]=0;Nt[jt++]=0,Nt[jt++]=0,Nt[jt++]=0,Nt[jt++]=0,Nt[jt++]=At>>>24&255,Nt[jt++]=At>>>16&255,Nt[jt++]=At>>>8&255,Nt[jt++]=At&255}else for(Nt[jt++]=At&255,Nt[jt++]=At>>>8&255,Nt[jt++]=At>>>16&255,Nt[jt++]=At>>>24&255,Nt[jt++]=0,Nt[jt++]=0,Nt[jt++]=0,Nt[jt++]=0,Ut=8;Ut<this.padLength;Ut++)Nt[jt++]=0;return Nt};var sha={},common$5={},utils$l=utils$n,rotr32=utils$l.rotr32;function ft_1$1(kt,At,xt,Bt){if(kt===0)return ch32$1(At,xt,Bt);if(kt===1||kt===3)return p32(At,xt,Bt);if(kt===2)return maj32$1(At,xt,Bt)}common$5.ft_1=ft_1$1;function ch32$1(kt,At,xt){return kt&At^~kt&xt}common$5.ch32=ch32$1;function maj32$1(kt,At,xt){return kt&At^kt&xt^At&xt}common$5.maj32=maj32$1;function p32(kt,At,xt){return kt^At^xt}common$5.p32=p32;function s0_256$1(kt){return rotr32(kt,2)^rotr32(kt,13)^rotr32(kt,22)}common$5.s0_256=s0_256$1;function s1_256$1(kt){return rotr32(kt,6)^rotr32(kt,11)^rotr32(kt,25)}common$5.s1_256=s1_256$1;function g0_256$1(kt){return rotr32(kt,7)^rotr32(kt,18)^kt>>>3}common$5.g0_256=g0_256$1;function g1_256$1(kt){return rotr32(kt,17)^rotr32(kt,19)^kt>>>10}common$5.g1_256=g1_256$1;var utils$k=utils$n,common$4=common$6,shaCommon$1=common$5,rotl32$1=utils$k.rotl32,sum32$2=utils$k.sum32,sum32_5$1=utils$k.sum32_5,ft_1=shaCommon$1.ft_1,BlockHash$3=common$4.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash$3.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}utils$k.inherits(SHA1,BlockHash$3);var _1=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function(At,xt){for(var Bt=this.W,Nt=0;Nt<16;Nt++)Bt[Nt]=At[xt+Nt];for(;Nt<Bt.length;Nt++)Bt[Nt]=rotl32$1(Bt[Nt-3]^Bt[Nt-8]^Bt[Nt-14]^Bt[Nt-16],1);var jt=this.h[0],Ut=this.h[1],Lt=this.h[2],Ht=this.h[3],Vt=this.h[4];for(Nt=0;Nt<Bt.length;Nt++){var zt=~~(Nt/20),Wt=sum32_5$1(rotl32$1(jt,5),ft_1(zt,Ut,Lt,Ht),Vt,Bt[Nt],sha1_K[zt]);Vt=Ht,Ht=Lt,Lt=rotl32$1(Ut,30),Ut=jt,jt=Wt}this.h[0]=sum32$2(this.h[0],jt),this.h[1]=sum32$2(this.h[1],Ut),this.h[2]=sum32$2(this.h[2],Lt),this.h[3]=sum32$2(this.h[3],Ht),this.h[4]=sum32$2(this.h[4],Vt)};SHA1.prototype._digest=function(At){return At==="hex"?utils$k.toHex32(this.h,"big"):utils$k.split32(this.h,"big")};var utils$j=utils$n,common$3=common$6,shaCommon=common$5,assert$c=minimalisticAssert,sum32$1=utils$j.sum32,sum32_4$1=utils$j.sum32_4,sum32_5=utils$j.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash$2=common$3.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256$3(){if(!(this instanceof SHA256$3))return new SHA256$3;BlockHash$2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}utils$j.inherits(SHA256$3,BlockHash$2);var _256=SHA256$3;SHA256$3.blockSize=512;SHA256$3.outSize=256;SHA256$3.hmacStrength=192;SHA256$3.padLength=64;SHA256$3.prototype._update=function(At,xt){for(var Bt=this.W,Nt=0;Nt<16;Nt++)Bt[Nt]=At[xt+Nt];for(;Nt<Bt.length;Nt++)Bt[Nt]=sum32_4$1(g1_256(Bt[Nt-2]),Bt[Nt-7],g0_256(Bt[Nt-15]),Bt[Nt-16]);var jt=this.h[0],Ut=this.h[1],Lt=this.h[2],Ht=this.h[3],Vt=this.h[4],zt=this.h[5],Wt=this.h[6],Jt=this.h[7];for(assert$c(this.k.length===Bt.length),Nt=0;Nt<Bt.length;Nt++){var Qt=sum32_5(Jt,s1_256(Vt),ch32(Vt,zt,Wt),this.k[Nt],Bt[Nt]),Xt=sum32$1(s0_256(jt),maj32(jt,Ut,Lt));Jt=Wt,Wt=zt,zt=Vt,Vt=sum32$1(Ht,Qt),Ht=Lt,Lt=Ut,Ut=jt,jt=sum32$1(Qt,Xt)}this.h[0]=sum32$1(this.h[0],jt),this.h[1]=sum32$1(this.h[1],Ut),this.h[2]=sum32$1(this.h[2],Lt),this.h[3]=sum32$1(this.h[3],Ht),this.h[4]=sum32$1(this.h[4],Vt),this.h[5]=sum32$1(this.h[5],zt),this.h[6]=sum32$1(this.h[6],Wt),this.h[7]=sum32$1(this.h[7],Jt)};SHA256$3.prototype._digest=function(At){return At==="hex"?utils$j.toHex32(this.h,"big"):utils$j.split32(this.h,"big")};var utils$i=utils$n,SHA256$2=_256;function SHA224$1(){if(!(this instanceof SHA224$1))return new SHA224$1;SHA256$2.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils$i.inherits(SHA224$1,SHA256$2);var _224=SHA224$1;SHA224$1.blockSize=512;SHA224$1.outSize=224;SHA224$1.hmacStrength=192;SHA224$1.padLength=64;SHA224$1.prototype._digest=function(At){return At==="hex"?utils$i.toHex32(this.h.slice(0,7),"big"):utils$i.split32(this.h.slice(0,7),"big")};var utils$h=utils$n,common$2=common$6,assert$b=minimalisticAssert,rotr64_hi=utils$h.rotr64_hi,rotr64_lo=utils$h.rotr64_lo,shr64_hi=utils$h.shr64_hi,shr64_lo=utils$h.shr64_lo,sum64=utils$h.sum64,sum64_hi=utils$h.sum64_hi,sum64_lo=utils$h.sum64_lo,sum64_4_hi=utils$h.sum64_4_hi,sum64_4_lo=utils$h.sum64_4_lo,sum64_5_hi=utils$h.sum64_5_hi,sum64_5_lo=utils$h.sum64_5_lo,BlockHash$1=common$2.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512$3(){if(!(this instanceof SHA512$3))return new SHA512$3;BlockHash$1.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}utils$h.inherits(SHA512$3,BlockHash$1);var _512=SHA512$3;SHA512$3.blockSize=1024;SHA512$3.outSize=512;SHA512$3.hmacStrength=192;SHA512$3.padLength=128;SHA512$3.prototype._prepareBlock=function(At,xt){for(var Bt=this.W,Nt=0;Nt<32;Nt++)Bt[Nt]=At[xt+Nt];for(;Nt<Bt.length;Nt+=2){var jt=g1_512_hi(Bt[Nt-4],Bt[Nt-3]),Ut=g1_512_lo(Bt[Nt-4],Bt[Nt-3]),Lt=Bt[Nt-14],Ht=Bt[Nt-13],Vt=g0_512_hi(Bt[Nt-30],Bt[Nt-29]),zt=g0_512_lo(Bt[Nt-30],Bt[Nt-29]),Wt=Bt[Nt-32],Jt=Bt[Nt-31];Bt[Nt]=sum64_4_hi(jt,Ut,Lt,Ht,Vt,zt,Wt,Jt),Bt[Nt+1]=sum64_4_lo(jt,Ut,Lt,Ht,Vt,zt,Wt,Jt)}};SHA512$3.prototype._update=function(At,xt){this._prepareBlock(At,xt);var Bt=this.W,Nt=this.h[0],jt=this.h[1],Ut=this.h[2],Lt=this.h[3],Ht=this.h[4],Vt=this.h[5],zt=this.h[6],Wt=this.h[7],Jt=this.h[8],Qt=this.h[9],Xt=this.h[10],tr=this.h[11],rr=this.h[12],nr=this.h[13],ar=this.h[14],ir=this.h[15];assert$b(this.k.length===Bt.length);for(var lr=0;lr<Bt.length;lr+=2){var yr=ar,Sr=ir,Ar=s1_512_hi(Jt,Qt),Dr=s1_512_lo(Jt,Qt),Br=ch64_hi(Jt,Qt,Xt,tr,rr),Lr=ch64_lo(Jt,Qt,Xt,tr,rr,nr),Or=this.k[lr],vr=this.k[lr+1],pr=Bt[lr],dr=Bt[lr+1],ur=sum64_5_hi(yr,Sr,Ar,Dr,Br,Lr,Or,vr,pr,dr),$r=sum64_5_lo(yr,Sr,Ar,Dr,Br,Lr,Or,vr,pr,dr);yr=s0_512_hi(Nt,jt),Sr=s0_512_lo(Nt,jt),Ar=maj64_hi(Nt,jt,Ut,Lt,Ht),Dr=maj64_lo(Nt,jt,Ut,Lt,Ht,Vt);var wr=sum64_hi(yr,Sr,Ar,Dr),Er=sum64_lo(yr,Sr,Ar,Dr);ar=rr,ir=nr,rr=Xt,nr=tr,Xt=Jt,tr=Qt,Jt=sum64_hi(zt,Wt,ur,$r),Qt=sum64_lo(Wt,Wt,ur,$r),zt=Ht,Wt=Vt,Ht=Ut,Vt=Lt,Ut=Nt,Lt=jt,Nt=sum64_hi(ur,$r,wr,Er),jt=sum64_lo(ur,$r,wr,Er)}sum64(this.h,0,Nt,jt),sum64(this.h,2,Ut,Lt),sum64(this.h,4,Ht,Vt),sum64(this.h,6,zt,Wt),sum64(this.h,8,Jt,Qt),sum64(this.h,10,Xt,tr),sum64(this.h,12,rr,nr),sum64(this.h,14,ar,ir)};SHA512$3.prototype._digest=function(At){return At==="hex"?utils$h.toHex32(this.h,"big"):utils$h.split32(this.h,"big")};function ch64_hi(kt,At,xt,Bt,Nt){var jt=kt&xt^~kt&Nt;return jt<0&&(jt+=4294967296),jt}function ch64_lo(kt,At,xt,Bt,Nt,jt){var Ut=At&Bt^~At&jt;return Ut<0&&(Ut+=4294967296),Ut}function maj64_hi(kt,At,xt,Bt,Nt){var jt=kt&xt^kt&Nt^xt&Nt;return jt<0&&(jt+=4294967296),jt}function maj64_lo(kt,At,xt,Bt,Nt,jt){var Ut=At&Bt^At&jt^Bt&jt;return Ut<0&&(Ut+=4294967296),Ut}function s0_512_hi(kt,At){var xt=rotr64_hi(kt,At,28),Bt=rotr64_hi(At,kt,2),Nt=rotr64_hi(At,kt,7),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function s0_512_lo(kt,At){var xt=rotr64_lo(kt,At,28),Bt=rotr64_lo(At,kt,2),Nt=rotr64_lo(At,kt,7),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function s1_512_hi(kt,At){var xt=rotr64_hi(kt,At,14),Bt=rotr64_hi(kt,At,18),Nt=rotr64_hi(At,kt,9),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function s1_512_lo(kt,At){var xt=rotr64_lo(kt,At,14),Bt=rotr64_lo(kt,At,18),Nt=rotr64_lo(At,kt,9),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function g0_512_hi(kt,At){var xt=rotr64_hi(kt,At,1),Bt=rotr64_hi(kt,At,8),Nt=shr64_hi(kt,At,7),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function g0_512_lo(kt,At){var xt=rotr64_lo(kt,At,1),Bt=rotr64_lo(kt,At,8),Nt=shr64_lo(kt,At,7),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function g1_512_hi(kt,At){var xt=rotr64_hi(kt,At,19),Bt=rotr64_hi(At,kt,29),Nt=shr64_hi(kt,At,6),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}function g1_512_lo(kt,At){var xt=rotr64_lo(kt,At,19),Bt=rotr64_lo(At,kt,29),Nt=shr64_lo(kt,At,6),jt=xt^Bt^Nt;return jt<0&&(jt+=4294967296),jt}var utils$g=utils$n,SHA512$2=_512;function SHA384$1(){if(!(this instanceof SHA384$1))return new SHA384$1;SHA512$2.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils$g.inherits(SHA384$1,SHA512$2);var _384=SHA384$1;SHA384$1.blockSize=1024;SHA384$1.outSize=384;SHA384$1.hmacStrength=192;SHA384$1.padLength=128;SHA384$1.prototype._digest=function(At){return At==="hex"?utils$g.toHex32(this.h.slice(0,12),"big"):utils$g.split32(this.h.slice(0,12),"big")};sha.sha1=_1;sha.sha224=_224;sha.sha256=_256;sha.sha384=_384;sha.sha512=_512;var ripemd={},utils$f=utils$n,common$1=common$6,rotl32=utils$f.rotl32,sum32=utils$f.sum32,sum32_3=utils$f.sum32_3,sum32_4=utils$f.sum32_4,BlockHash=common$1.BlockHash;function RIPEMD160$1(){if(!(this instanceof RIPEMD160$1))return new RIPEMD160$1;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}utils$f.inherits(RIPEMD160$1,BlockHash);ripemd.ripemd160=RIPEMD160$1;RIPEMD160$1.blockSize=512;RIPEMD160$1.outSize=160;RIPEMD160$1.hmacStrength=192;RIPEMD160$1.padLength=64;RIPEMD160$1.prototype._update=function(At,xt){for(var Bt=this.h[0],Nt=this.h[1],jt=this.h[2],Ut=this.h[3],Lt=this.h[4],Ht=Bt,Vt=Nt,zt=jt,Wt=Ut,Jt=Lt,Qt=0;Qt<80;Qt++){var Xt=sum32(rotl32(sum32_4(Bt,f$2(Qt,Nt,jt,Ut),At[r$1[Qt]+xt],K$1(Qt)),s$3[Qt]),Lt);Bt=Lt,Lt=Ut,Ut=rotl32(jt,10),jt=Nt,Nt=Xt,Xt=sum32(rotl32(sum32_4(Ht,f$2(79-Qt,Vt,zt,Wt),At[rh[Qt]+xt],Kh(Qt)),sh[Qt]),Jt),Ht=Jt,Jt=Wt,Wt=rotl32(zt,10),zt=Vt,Vt=Xt}Xt=sum32_3(this.h[1],jt,Wt),this.h[1]=sum32_3(this.h[2],Ut,Jt),this.h[2]=sum32_3(this.h[3],Lt,Ht),this.h[3]=sum32_3(this.h[4],Bt,Vt),this.h[4]=sum32_3(this.h[0],Nt,zt),this.h[0]=Xt};RIPEMD160$1.prototype._digest=function(At){return At==="hex"?utils$f.toHex32(this.h,"little"):utils$f.split32(this.h,"little")};function f$2(kt,At,xt,Bt){return kt<=15?At^xt^Bt:kt<=31?At&xt|~At&Bt:kt<=47?(At|~xt)^Bt:kt<=63?At&Bt|xt&~Bt:At^(xt|~Bt)}function K$1(kt){return kt<=15?0:kt<=31?1518500249:kt<=47?1859775393:kt<=63?2400959708:2840853838}function Kh(kt){return kt<=15?1352829926:kt<=31?1548603684:kt<=47?1836072691:kt<=63?2053994217:0}var r$1=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s$3=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],utils$e=utils$n,assert$a=minimalisticAssert;function Hmac(kt,At,xt){if(!(this instanceof Hmac))return new Hmac(kt,At,xt);this.Hash=kt,this.blockSize=kt.blockSize/8,this.outSize=kt.outSize/8,this.inner=null,this.outer=null,this._init(utils$e.toArray(At,xt))}var hmac$2=Hmac;Hmac.prototype._init=function(At){At.length>this.blockSize&&(At=new this.Hash().update(At).digest()),assert$a(At.length<=this.blockSize);for(var xt=At.length;xt<this.blockSize;xt++)At.push(0);for(xt=0;xt<At.length;xt++)At[xt]^=54;for(this.inner=new this.Hash().update(At),xt=0;xt<At.length;xt++)At[xt]^=106;this.outer=new this.Hash().update(At)};Hmac.prototype.update=function(At,xt){return this.inner.update(At,xt),this};Hmac.prototype.digest=function(At){return this.outer.update(this.inner.digest()),this.outer.digest(At)};(function(kt){var At=kt;At.utils=utils$n,At.common=common$6,At.sha=sha,At.ripemd=ripemd,At.hmac=hmac$2,At.sha1=At.sha.sha1,At.sha256=At.sha.sha256,At.sha224=At.sha.sha224,At.sha384=At.sha.sha384,At.sha512=At.sha.sha512,At.ripemd160=At.ripemd.ripemd160})(hash$5);var secp256k1$2,hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,secp256k1$2={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),secp256k1$2}(function(kt){var At=kt,xt=hash$5,Bt=curve$1,Nt=utils$t,jt=Nt.assert;function Ut(Vt){Vt.type==="short"?this.curve=new Bt.short(Vt):Vt.type==="edwards"?this.curve=new Bt.edwards(Vt):this.curve=new Bt.mont(Vt),this.g=this.curve.g,this.n=this.curve.n,this.hash=Vt.hash,jt(this.g.validate(),"Invalid curve"),jt(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}At.PresetCurve=Ut;function Lt(Vt,zt){Object.defineProperty(At,Vt,{configurable:!0,enumerable:!0,get:function(){var Wt=new Ut(zt);return Object.defineProperty(At,Vt,{configurable:!0,enumerable:!0,value:Wt}),Wt}})}Lt("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:xt.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),Lt("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:xt.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),Lt("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:xt.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),Lt("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:xt.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),Lt("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:xt.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),Lt("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:xt.sha256,gRed:!1,g:["9"]}),Lt("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:xt.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var Ht;try{Ht=requireSecp256k1()}catch{Ht=void 0}Lt("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:xt.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",Ht]})})(curves$1);var hash$4=hash$5,utils$d=utils$s,assert$9=minimalisticAssert;function HmacDRBG(kt){if(!(this instanceof HmacDRBG))return new HmacDRBG(kt);this.hash=kt.hash,this.predResist=!!kt.predResist,this.outLen=this.hash.outSize,this.minEntropy=kt.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var At=utils$d.toArray(kt.entropy,kt.entropyEnc||"hex"),xt=utils$d.toArray(kt.nonce,kt.nonceEnc||"hex"),Bt=utils$d.toArray(kt.pers,kt.persEnc||"hex");assert$9(At.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(At,xt,Bt)}var hmacDrbg=HmacDRBG;HmacDRBG.prototype._init=function(At,xt,Bt){var Nt=At.concat(xt).concat(Bt);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var jt=0;jt<this.V.length;jt++)this.K[jt]=0,this.V[jt]=1;this._update(Nt),this._reseed=1,this.reseedInterval=281474976710656};HmacDRBG.prototype._hmac=function(){return new hash$4.hmac(this.hash,this.K)};HmacDRBG.prototype._update=function(At){var xt=this._hmac().update(this.V).update([0]);At&&(xt=xt.update(At)),this.K=xt.digest(),this.V=this._hmac().update(this.V).digest(),At&&(this.K=this._hmac().update(this.V).update([1]).update(At).digest(),this.V=this._hmac().update(this.V).digest())};HmacDRBG.prototype.reseed=function(At,xt,Bt,Nt){typeof xt!="string"&&(Nt=Bt,Bt=xt,xt=null),At=utils$d.toArray(At,xt),Bt=utils$d.toArray(Bt,Nt),assert$9(At.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(At.concat(Bt||[])),this._reseed=1};HmacDRBG.prototype.generate=function(At,xt,Bt,Nt){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof xt!="string"&&(Nt=Bt,Bt=xt,xt=null),Bt&&(Bt=utils$d.toArray(Bt,Nt||"hex"),this._update(Bt));for(var jt=[];jt.length<At;)this.V=this._hmac().update(this.V).digest(),jt=jt.concat(this.V);var Ut=jt.slice(0,At);return this._update(Bt),this._reseed++,utils$d.encode(Ut,xt)};var BN$5=bnExports$1,utils$c=utils$t,assert$8=utils$c.assert;function KeyPair$2(kt,At){this.ec=kt,this.priv=null,this.pub=null,At.priv&&this._importPrivate(At.priv,At.privEnc),At.pub&&this._importPublic(At.pub,At.pubEnc)}var key$1=KeyPair$2;KeyPair$2.fromPublic=function(At,xt,Bt){return xt instanceof KeyPair$2?xt:new KeyPair$2(At,{pub:xt,pubEnc:Bt})};KeyPair$2.fromPrivate=function(At,xt,Bt){return xt instanceof KeyPair$2?xt:new KeyPair$2(At,{priv:xt,privEnc:Bt})};KeyPair$2.prototype.validate=function(){var At=this.getPublic();return At.isInfinity()?{result:!1,reason:"Invalid public key"}:At.validate()?At.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};KeyPair$2.prototype.getPublic=function(At,xt){return typeof At=="string"&&(xt=At,At=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),xt?this.pub.encode(xt,At):this.pub};KeyPair$2.prototype.getPrivate=function(At){return At==="hex"?this.priv.toString(16,2):this.priv};KeyPair$2.prototype._importPrivate=function(At,xt){this.priv=new BN$5(At,xt||16),this.priv=this.priv.umod(this.ec.curve.n)};KeyPair$2.prototype._importPublic=function(At,xt){if(At.x||At.y){this.ec.curve.type==="mont"?assert$8(At.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&assert$8(At.x&&At.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(At.x,At.y);return}this.pub=this.ec.curve.decodePoint(At,xt)};KeyPair$2.prototype.derive=function(At){return At.validate()||assert$8(At.validate(),"public point not validated"),At.mul(this.priv).getX()};KeyPair$2.prototype.sign=function(At,xt,Bt){return this.ec.sign(At,this,xt,Bt)};KeyPair$2.prototype.verify=function(At,xt){return this.ec.verify(At,xt,this)};KeyPair$2.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var BN$4=bnExports$1,utils$b=utils$t,assert$7=utils$b.assert;function Signature$2(kt,At){if(kt instanceof Signature$2)return kt;this._importDER(kt,At)||(assert$7(kt.r&&kt.s,"Signature without r or s"),this.r=new BN$4(kt.r,16),this.s=new BN$4(kt.s,16),kt.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=kt.recoveryParam)}var signature$1=Signature$2;function Position(){this.place=0}function getLength(kt,At){var xt=kt[At.place++];if(!(xt&128))return xt;var Bt=xt&15;if(Bt===0||Bt>4||kt[At.place]===0)return!1;for(var Nt=0,jt=0,Ut=At.place;jt<Bt;jt++,Ut++)Nt<<=8,Nt|=kt[Ut],Nt>>>=0;return Nt<=127?!1:(At.place=Ut,Nt)}function rmPadding(kt){for(var At=0,xt=kt.length-1;!kt[At]&&!(kt[At+1]&128)&&At<xt;)At++;return At===0?kt:kt.slice(At)}Signature$2.prototype._importDER=function(At,xt){At=utils$b.toArray(At,xt);var Bt=new Position;if(At[Bt.place++]!==48)return!1;var Nt=getLength(At,Bt);if(Nt===!1||Nt+Bt.place!==At.length||At[Bt.place++]!==2)return!1;var jt=getLength(At,Bt);if(jt===!1||At[Bt.place]&128)return!1;var Ut=At.slice(Bt.place,jt+Bt.place);if(Bt.place+=jt,At[Bt.place++]!==2)return!1;var Lt=getLength(At,Bt);if(Lt===!1||At.length!==Lt+Bt.place||At[Bt.place]&128)return!1;var Ht=At.slice(Bt.place,Lt+Bt.place);if(Ut[0]===0)if(Ut[1]&128)Ut=Ut.slice(1);else return!1;if(Ht[0]===0)if(Ht[1]&128)Ht=Ht.slice(1);else return!1;return this.r=new BN$4(Ut),this.s=new BN$4(Ht),this.recoveryParam=null,!0};function constructLength(kt,At){if(At<128){kt.push(At);return}var xt=1+(Math.log(At)/Math.LN2>>>3);for(kt.push(xt|128);--xt;)kt.push(At>>>(xt<<3)&255);kt.push(At)}Signature$2.prototype.toDER=function(At){var xt=this.r.toArray(),Bt=this.s.toArray();for(xt[0]&128&&(xt=[0].concat(xt)),Bt[0]&128&&(Bt=[0].concat(Bt)),xt=rmPadding(xt),Bt=rmPadding(Bt);!Bt[0]&&!(Bt[1]&128);)Bt=Bt.slice(1);var Nt=[2];constructLength(Nt,xt.length),Nt=Nt.concat(xt),Nt.push(2),constructLength(Nt,Bt.length);var jt=Nt.concat(Bt),Ut=[48];return constructLength(Ut,jt.length),Ut=Ut.concat(jt),utils$b.encode(Ut,At)};var ec,hasRequiredEc;function requireEc(){if(hasRequiredEc)return ec;hasRequiredEc=1;var kt=bnExports$1,At=hmacDrbg,xt=utils$t,Bt=curves$1,Nt=requireBrorand(),jt=xt.assert,Ut=key$1,Lt=signature$1;function Ht(Vt){if(!(this instanceof Ht))return new Ht(Vt);typeof Vt=="string"&&(jt(Object.prototype.hasOwnProperty.call(Bt,Vt),"Unknown curve "+Vt),Vt=Bt[Vt]),Vt instanceof Bt.PresetCurve&&(Vt={curve:Vt}),this.curve=Vt.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=Vt.curve.g,this.g.precompute(Vt.curve.n.bitLength()+1),this.hash=Vt.hash||Vt.curve.hash}return ec=Ht,Ht.prototype.keyPair=function(zt){return new Ut(this,zt)},Ht.prototype.keyFromPrivate=function(zt,Wt){return Ut.fromPrivate(this,zt,Wt)},Ht.prototype.keyFromPublic=function(zt,Wt){return Ut.fromPublic(this,zt,Wt)},Ht.prototype.genKeyPair=function(zt){zt||(zt={});for(var Wt=new At({hash:this.hash,pers:zt.pers,persEnc:zt.persEnc||"utf8",entropy:zt.entropy||Nt(this.hash.hmacStrength),entropyEnc:zt.entropy&&zt.entropyEnc||"utf8",nonce:this.n.toArray()}),Jt=this.n.byteLength(),Qt=this.n.sub(new kt(2));;){var Xt=new kt(Wt.generate(Jt));if(!(Xt.cmp(Qt)>0))return Xt.iaddn(1),this.keyFromPrivate(Xt)}},Ht.prototype._truncateToN=function(zt,Wt){var Jt=zt.byteLength()*8-this.n.bitLength();return Jt>0&&(zt=zt.ushrn(Jt)),!Wt&&zt.cmp(this.n)>=0?zt.sub(this.n):zt},Ht.prototype.sign=function(zt,Wt,Jt,Qt){typeof Jt=="object"&&(Qt=Jt,Jt=null),Qt||(Qt={}),Wt=this.keyFromPrivate(Wt,Jt),zt=this._truncateToN(new kt(zt,16));for(var Xt=this.n.byteLength(),tr=Wt.getPrivate().toArray("be",Xt),rr=zt.toArray("be",Xt),nr=new At({hash:this.hash,entropy:tr,nonce:rr,pers:Qt.pers,persEnc:Qt.persEnc||"utf8"}),ar=this.n.sub(new kt(1)),ir=0;;ir++){var lr=Qt.k?Qt.k(ir):new kt(nr.generate(this.n.byteLength()));if(lr=this._truncateToN(lr,!0),!(lr.cmpn(1)<=0||lr.cmp(ar)>=0)){var yr=this.g.mul(lr);if(!yr.isInfinity()){var Sr=yr.getX(),Ar=Sr.umod(this.n);if(Ar.cmpn(0)!==0){var Dr=lr.invm(this.n).mul(Ar.mul(Wt.getPrivate()).iadd(zt));if(Dr=Dr.umod(this.n),Dr.cmpn(0)!==0){var Br=(yr.getY().isOdd()?1:0)|(Sr.cmp(Ar)!==0?2:0);return Qt.canonical&&Dr.cmp(this.nh)>0&&(Dr=this.n.sub(Dr),Br^=1),new Lt({r:Ar,s:Dr,recoveryParam:Br})}}}}}},Ht.prototype.verify=function(zt,Wt,Jt,Qt){zt=this._truncateToN(new kt(zt,16)),Jt=this.keyFromPublic(Jt,Qt),Wt=new Lt(Wt,"hex");var Xt=Wt.r,tr=Wt.s;if(Xt.cmpn(1)<0||Xt.cmp(this.n)>=0||tr.cmpn(1)<0||tr.cmp(this.n)>=0)return!1;var rr=tr.invm(this.n),nr=rr.mul(zt).umod(this.n),ar=rr.mul(Xt).umod(this.n),ir;return this.curve._maxwellTrick?(ir=this.g.jmulAdd(nr,Jt.getPublic(),ar),ir.isInfinity()?!1:ir.eqXToP(Xt)):(ir=this.g.mulAdd(nr,Jt.getPublic(),ar),ir.isInfinity()?!1:ir.getX().umod(this.n).cmp(Xt)===0)},Ht.prototype.recoverPubKey=function(Vt,zt,Wt,Jt){jt((3&Wt)===Wt,"The recovery param is more than two bits"),zt=new Lt(zt,Jt);var Qt=this.n,Xt=new kt(Vt),tr=zt.r,rr=zt.s,nr=Wt&1,ar=Wt>>1;if(tr.cmp(this.curve.p.umod(this.curve.n))>=0&&ar)throw new Error("Unable to find sencond key candinate");ar?tr=this.curve.pointFromX(tr.add(this.curve.n),nr):tr=this.curve.pointFromX(tr,nr);var ir=zt.r.invm(Qt),lr=Qt.sub(Xt).mul(ir).umod(Qt),yr=rr.mul(ir).umod(Qt);return this.g.mulAdd(lr,tr,yr)},Ht.prototype.getKeyRecoveryParam=function(Vt,zt,Wt,Jt){if(zt=new Lt(zt,Jt),zt.recoveryParam!==null)return zt.recoveryParam;for(var Qt=0;Qt<4;Qt++){var Xt;try{Xt=this.recoverPubKey(Vt,zt,Qt)}catch{continue}if(Xt.eq(Wt))return Qt}throw new Error("Unable to find valid recovery factor")},ec}var utils$a=utils$t,assert$6=utils$a.assert,parseBytes$2=utils$a.parseBytes,cachedProperty$1=utils$a.cachedProperty;function KeyPair$1(kt,At){this.eddsa=kt,this._secret=parseBytes$2(At.secret),kt.isPoint(At.pub)?this._pub=At.pub:this._pubBytes=parseBytes$2(At.pub)}KeyPair$1.fromPublic=function(At,xt){return xt instanceof KeyPair$1?xt:new KeyPair$1(At,{pub:xt})};KeyPair$1.fromSecret=function(At,xt){return xt instanceof KeyPair$1?xt:new KeyPair$1(At,{secret:xt})};KeyPair$1.prototype.secret=function(){return this._secret};cachedProperty$1(KeyPair$1,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});cachedProperty$1(KeyPair$1,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});cachedProperty$1(KeyPair$1,"privBytes",function(){var At=this.eddsa,xt=this.hash(),Bt=At.encodingLength-1,Nt=xt.slice(0,At.encodingLength);return Nt[0]&=248,Nt[Bt]&=127,Nt[Bt]|=64,Nt});cachedProperty$1(KeyPair$1,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});cachedProperty$1(KeyPair$1,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});cachedProperty$1(KeyPair$1,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});KeyPair$1.prototype.sign=function(At){return assert$6(this._secret,"KeyPair can only verify"),this.eddsa.sign(At,this)};KeyPair$1.prototype.verify=function(At,xt){return this.eddsa.verify(At,xt,this)};KeyPair$1.prototype.getSecret=function(At){return assert$6(this._secret,"KeyPair is public only"),utils$a.encode(this.secret(),At)};KeyPair$1.prototype.getPublic=function(At){return utils$a.encode(this.pubBytes(),At)};var key=KeyPair$1,BN$3=bnExports$1,utils$9=utils$t,assert$5=utils$9.assert,cachedProperty=utils$9.cachedProperty,parseBytes$1=utils$9.parseBytes;function Signature$1(kt,At){this.eddsa=kt,typeof At!="object"&&(At=parseBytes$1(At)),Array.isArray(At)&&(assert$5(At.length===kt.encodingLength*2,"Signature has invalid size"),At={R:At.slice(0,kt.encodingLength),S:At.slice(kt.encodingLength)}),assert$5(At.R&&At.S,"Signature without R or S"),kt.isPoint(At.R)&&(this._R=At.R),At.S instanceof BN$3&&(this._S=At.S),this._Rencoded=Array.isArray(At.R)?At.R:At.Rencoded,this._Sencoded=Array.isArray(At.S)?At.S:At.Sencoded}cachedProperty(Signature$1,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});cachedProperty(Signature$1,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});cachedProperty(Signature$1,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});cachedProperty(Signature$1,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Signature$1.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Signature$1.prototype.toHex=function(){return utils$9.encode(this.toBytes(),"hex").toUpperCase()};var signature=Signature$1,hash$3=hash$5,curves=curves$1,utils$8=utils$t,assert$4=utils$8.assert,parseBytes=utils$8.parseBytes,KeyPair=key,Signature=signature;function EDDSA(kt){if(assert$4(kt==="ed25519","only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(kt);kt=curves[kt].curve,this.curve=kt,this.g=kt.g,this.g.precompute(kt.n.bitLength()+1),this.pointClass=kt.point().constructor,this.encodingLength=Math.ceil(kt.n.bitLength()/8),this.hash=hash$3.sha512}var eddsa=EDDSA;EDDSA.prototype.sign=function(At,xt){At=parseBytes(At);var Bt=this.keyFromSecret(xt),Nt=this.hashInt(Bt.messagePrefix(),At),jt=this.g.mul(Nt),Ut=this.encodePoint(jt),Lt=this.hashInt(Ut,Bt.pubBytes(),At).mul(Bt.priv()),Ht=Nt.add(Lt).umod(this.curve.n);return this.makeSignature({R:jt,S:Ht,Rencoded:Ut})};EDDSA.prototype.verify=function(At,xt,Bt){if(At=parseBytes(At),xt=this.makeSignature(xt),xt.S().gte(xt.eddsa.curve.n)||xt.S().isNeg())return!1;var Nt=this.keyFromPublic(Bt),jt=this.hashInt(xt.Rencoded(),Nt.pubBytes(),At),Ut=this.g.mul(xt.S()),Lt=xt.R().add(Nt.pub().mul(jt));return Lt.eq(Ut)};EDDSA.prototype.hashInt=function(){for(var At=this.hash(),xt=0;xt<arguments.length;xt++)At.update(arguments[xt]);return utils$8.intFromLE(At.digest()).umod(this.curve.n)};EDDSA.prototype.keyFromPublic=function(At){return KeyPair.fromPublic(this,At)};EDDSA.prototype.keyFromSecret=function(At){return KeyPair.fromSecret(this,At)};EDDSA.prototype.makeSignature=function(At){return At instanceof Signature?At:new Signature(this,At)};EDDSA.prototype.encodePoint=function(At){var xt=At.getY().toArray("le",this.encodingLength);return xt[this.encodingLength-1]|=At.getX().isOdd()?128:0,xt};EDDSA.prototype.decodePoint=function(At){At=utils$8.parseBytes(At);var xt=At.length-1,Bt=At.slice(0,xt).concat(At[xt]&-129),Nt=(At[xt]&128)!==0,jt=utils$8.intFromLE(Bt);return this.curve.pointFromY(jt,Nt)};EDDSA.prototype.encodeInt=function(At){return At.toArray("le",this.encodingLength)};EDDSA.prototype.decodeInt=function(At){return utils$8.intFromLE(At)};EDDSA.prototype.isPoint=function(At){return At instanceof this.pointClass};var hasRequiredElliptic;function requireElliptic(){return hasRequiredElliptic||(hasRequiredElliptic=1,function(kt){var At=kt;At.version=require$$0$3.version,At.utils=utils$t,At.rand=requireBrorand(),At.curve=curve$1,At.curves=curves$1,At.ec=requireEc(),At.eddsa=eddsa}(elliptic$1)),elliptic$1}var asn1$3={},asn1$2={},api={},vmBrowserify={},hasRequiredVmBrowserify;function requireVmBrowserify(){return hasRequiredVmBrowserify||(hasRequiredVmBrowserify=1,function(exports){var indexOf=function(kt,At){if(kt.indexOf)return kt.indexOf(At);for(var xt=0;xt<kt.length;xt++)if(kt[xt]===At)return xt;return-1},Object_keys=function(kt){if(Object.keys)return Object.keys(kt);var At=[];for(var xt in kt)At.push(xt);return At},forEach=function(kt,At){if(kt.forEach)return kt.forEach(At);for(var xt=0;xt<kt.length;xt++)At(kt[xt],xt,kt)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(kt,At,xt){Object.defineProperty(kt,At,{writable:!0,enumerable:!1,configurable:!0,value:xt})}}catch{return function(At,xt,Bt){At[xt]=Bt}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(At){if(!(this instanceof Script))return new Script(At);this.code=At};Script.prototype.runInContext=function(kt){if(!(kt instanceof Context))throw new TypeError("needs a 'context' argument.");var At=document.createElement("iframe");At.style||(At.style={}),At.style.display="none",document.body.appendChild(At);var xt=At.contentWindow,Bt=xt.eval,Nt=xt.execScript;!Bt&&Nt&&(Nt.call(xt,"null"),Bt=xt.eval),forEach(Object_keys(kt),function(Lt){xt[Lt]=kt[Lt]}),forEach(globals,function(Lt){kt[Lt]&&(xt[Lt]=kt[Lt])});var jt=Object_keys(xt),Ut=Bt.call(xt,this.code);return forEach(Object_keys(xt),function(Lt){(Lt in kt||indexOf(jt,Lt)===-1)&&(kt[Lt]=xt[Lt])}),forEach(globals,function(Lt){Lt in kt||defineProp(kt,Lt,xt[Lt])}),document.body.removeChild(At),Ut},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(kt){var At=Script.createContext(kt),xt=this.runInContext(At);return kt&&forEach(Object_keys(At),function(Bt){kt[Bt]=At[Bt]}),xt},forEach(Object_keys(Script.prototype),function(kt){exports[kt]=Script[kt]=function(At){var xt=Script(At);return xt[kt].apply(xt,[].slice.call(arguments,1))}}),exports.isContext=function(kt){return kt instanceof Context},exports.createScript=function(kt){return exports.Script(kt)},exports.createContext=Script.createContext=function(kt){var At=new Context;return typeof kt=="object"&&forEach(Object_keys(kt),function(xt){At[xt]=kt[xt]}),At}}(vmBrowserify)),vmBrowserify}var hasRequiredApi;function requireApi(){return hasRequiredApi||(hasRequiredApi=1,function(kt){var At=requireAsn1(),xt=inherits_browserExports,Bt=kt;Bt.define=function(Ut,Lt){return new Nt(Ut,Lt)};function Nt(jt,Ut){this.name=jt,this.body=Ut,this.decoders={},this.encoders={}}Nt.prototype._createNamed=function(Ut){var Lt;try{Lt=requireVmBrowserify().runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{Lt=function(Vt){this._initNamed(Vt)}}return xt(Lt,Ut),Lt.prototype._initNamed=function(Vt){Ut.call(this,Vt)},new Lt(this)},Nt.prototype._getDecoder=function(Ut){return Ut=Ut||"der",this.decoders.hasOwnProperty(Ut)||(this.decoders[Ut]=this._createNamed(At.decoders[Ut])),this.decoders[Ut]},Nt.prototype.decode=function(Ut,Lt,Ht){return this._getDecoder(Lt).decode(Ut,Ht)},Nt.prototype._getEncoder=function(Ut){return Ut=Ut||"der",this.encoders.hasOwnProperty(Ut)||(this.encoders[Ut]=this._createNamed(At.encoders[Ut])),this.encoders[Ut]},Nt.prototype.encode=function(Ut,Lt,Ht){return this._getEncoder(Lt).encode(Ut,Ht)}}(api)),api}var base$1={},reporter={},inherits=inherits_browserExports;function Reporter(kt){this._reporterState={obj:null,path:[],options:kt||{},errors:[]}}reporter.Reporter=Reporter;Reporter.prototype.isError=function kt(At){return At instanceof ReporterError};Reporter.prototype.save=function kt(){var At=this._reporterState;return{obj:At.obj,pathLen:At.path.length}};Reporter.prototype.restore=function kt(At){var xt=this._reporterState;xt.obj=At.obj,xt.path=xt.path.slice(0,At.pathLen)};Reporter.prototype.enterKey=function kt(At){return this._reporterState.path.push(At)};Reporter.prototype.exitKey=function kt(At){var xt=this._reporterState;xt.path=xt.path.slice(0,At-1)};Reporter.prototype.leaveKey=function kt(At,xt,Bt){var Nt=this._reporterState;this.exitKey(At),Nt.obj!==null&&(Nt.obj[xt]=Bt)};Reporter.prototype.path=function kt(){return this._reporterState.path.join("/")};Reporter.prototype.enterObject=function kt(){var At=this._reporterState,xt=At.obj;return At.obj={},xt};Reporter.prototype.leaveObject=function kt(At){var xt=this._reporterState,Bt=xt.obj;return xt.obj=At,Bt};Reporter.prototype.error=function kt(At){var xt,Bt=this._reporterState,Nt=At instanceof ReporterError;if(Nt?xt=At:xt=new ReporterError(Bt.path.map(function(jt){return"["+JSON.stringify(jt)+"]"}).join(""),At.message||At,At.stack),!Bt.options.partial)throw xt;return Nt||Bt.errors.push(xt),xt};Reporter.prototype.wrapResult=function kt(At){var xt=this._reporterState;return xt.options.partial?{result:this.isError(At)?null:At,errors:xt.errors}:At};function ReporterError(kt,At){this.path=kt,this.rethrow(At)}inherits(ReporterError,Error);ReporterError.prototype.rethrow=function kt(At){if(this.message=At+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,ReporterError),!this.stack)try{throw new Error(this.message)}catch(xt){this.stack=xt.stack}return this};var buffer={},hasRequiredBuffer;function requireBuffer(){if(hasRequiredBuffer)return buffer;hasRequiredBuffer=1;var kt=inherits_browserExports,At=requireBase().Reporter,xt=buffer$2.Buffer;function Bt(jt,Ut){if(At.call(this,Ut),!xt.isBuffer(jt)){this.error("Input not Buffer");return}this.base=jt,this.offset=0,this.length=jt.length}kt(Bt,At),buffer.DecoderBuffer=Bt,Bt.prototype.save=function(){return{offset:this.offset,reporter:At.prototype.save.call(this)}},Bt.prototype.restore=function(Ut){var Lt=new Bt(this.base);return Lt.offset=Ut.offset,Lt.length=this.offset,this.offset=Ut.offset,At.prototype.restore.call(this,Ut.reporter),Lt},Bt.prototype.isEmpty=function(){return this.offset===this.length},Bt.prototype.readUInt8=function(Ut){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(Ut||"DecoderBuffer overrun")},Bt.prototype.skip=function(Ut,Lt){if(!(this.offset+Ut<=this.length))return this.error(Lt||"DecoderBuffer overrun");var Ht=new Bt(this.base);return Ht._reporterState=this._reporterState,Ht.offset=this.offset,Ht.length=this.offset+Ut,this.offset+=Ut,Ht},Bt.prototype.raw=function(Ut){return this.base.slice(Ut?Ut.offset:this.offset,this.length)};function Nt(jt,Ut){if(Array.isArray(jt))this.length=0,this.value=jt.map(function(Lt){return Lt instanceof Nt||(Lt=new Nt(Lt,Ut)),this.length+=Lt.length,Lt},this);else if(typeof jt=="number"){if(!(0<=jt&&jt<=255))return Ut.error("non-byte EncoderBuffer value");this.value=jt,this.length=1}else if(typeof jt=="string")this.value=jt,this.length=xt.byteLength(jt);else if(xt.isBuffer(jt))this.value=jt,this.length=jt.length;else return Ut.error("Unsupported type: "+typeof jt)}return buffer.EncoderBuffer=Nt,Nt.prototype.join=function(Ut,Lt){return Ut||(Ut=new xt(this.length)),Lt||(Lt=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(Ht){Ht.join(Ut,Lt),Lt+=Ht.length}):(typeof this.value=="number"?Ut[Lt]=this.value:typeof this.value=="string"?Ut.write(this.value,Lt):xt.isBuffer(this.value)&&this.value.copy(Ut,Lt),Lt+=this.length)),Ut},buffer}var node,hasRequiredNode;function requireNode(){if(hasRequiredNode)return node;hasRequiredNode=1;var kt=requireBase().Reporter,At=requireBase().EncoderBuffer,xt=requireBase().DecoderBuffer,Bt=minimalisticAssert,Nt=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],jt=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(Nt),Ut=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function Lt(Vt,zt){var Wt={};this._baseState=Wt,Wt.enc=Vt,Wt.parent=zt||null,Wt.children=null,Wt.tag=null,Wt.args=null,Wt.reverseArgs=null,Wt.choice=null,Wt.optional=!1,Wt.any=!1,Wt.obj=!1,Wt.use=null,Wt.useDecoder=null,Wt.key=null,Wt.default=null,Wt.explicit=null,Wt.implicit=null,Wt.contains=null,Wt.parent||(Wt.children=[],this._wrap())}node=Lt;var Ht=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return Lt.prototype.clone=function(){var zt=this._baseState,Wt={};Ht.forEach(function(Qt){Wt[Qt]=zt[Qt]});var Jt=new this.constructor(Wt.parent);return Jt._baseState=Wt,Jt},Lt.prototype._wrap=function(){var zt=this._baseState;jt.forEach(function(Wt){this[Wt]=function(){var Qt=new this.constructor(this);return zt.children.push(Qt),Qt[Wt].apply(Qt,arguments)}},this)},Lt.prototype._init=function(zt){var Wt=this._baseState;Bt(Wt.parent===null),zt.call(this),Wt.children=Wt.children.filter(function(Jt){return Jt._baseState.parent===this},this),Bt.equal(Wt.children.length,1,"Root node can have only one child")},Lt.prototype._useArgs=function(zt){var Wt=this._baseState,Jt=zt.filter(function(Qt){return Qt instanceof this.constructor},this);zt=zt.filter(function(Qt){return!(Qt instanceof this.constructor)},this),Jt.length!==0&&(Bt(Wt.children===null),Wt.children=Jt,Jt.forEach(function(Qt){Qt._baseState.parent=this},this)),zt.length!==0&&(Bt(Wt.args===null),Wt.args=zt,Wt.reverseArgs=zt.map(function(Qt){if(typeof Qt!="object"||Qt.constructor!==Object)return Qt;var Xt={};return Object.keys(Qt).forEach(function(tr){tr==(tr|0)&&(tr|=0);var rr=Qt[tr];Xt[rr]=tr}),Xt}))},Ut.forEach(function(Vt){Lt.prototype[Vt]=function(){var Wt=this._baseState;throw new Error(Vt+" not implemented for encoding: "+Wt.enc)}}),Nt.forEach(function(Vt){Lt.prototype[Vt]=function(){var Wt=this._baseState,Jt=Array.prototype.slice.call(arguments);return Bt(Wt.tag===null),Wt.tag=Vt,this._useArgs(Jt),this}}),Lt.prototype.use=function(zt){Bt(zt);var Wt=this._baseState;return Bt(Wt.use===null),Wt.use=zt,this},Lt.prototype.optional=function(){var zt=this._baseState;return zt.optional=!0,this},Lt.prototype.def=function(zt){var Wt=this._baseState;return Bt(Wt.default===null),Wt.default=zt,Wt.optional=!0,this},Lt.prototype.explicit=function(zt){var Wt=this._baseState;return Bt(Wt.explicit===null&&Wt.implicit===null),Wt.explicit=zt,this},Lt.prototype.implicit=function(zt){var Wt=this._baseState;return Bt(Wt.explicit===null&&Wt.implicit===null),Wt.implicit=zt,this},Lt.prototype.obj=function(){var zt=this._baseState,Wt=Array.prototype.slice.call(arguments);return zt.obj=!0,Wt.length!==0&&this._useArgs(Wt),this},Lt.prototype.key=function(zt){var Wt=this._baseState;return Bt(Wt.key===null),Wt.key=zt,this},Lt.prototype.any=function(){var zt=this._baseState;return zt.any=!0,this},Lt.prototype.choice=function(zt){var Wt=this._baseState;return Bt(Wt.choice===null),Wt.choice=zt,this._useArgs(Object.keys(zt).map(function(Jt){return zt[Jt]})),this},Lt.prototype.contains=function(zt){var Wt=this._baseState;return Bt(Wt.use===null),Wt.contains=zt,this},Lt.prototype._decode=function(zt,Wt){var Jt=this._baseState;if(Jt.parent===null)return zt.wrapResult(Jt.children[0]._decode(zt,Wt));var Qt=Jt.default,Xt=!0,tr=null;if(Jt.key!==null&&(tr=zt.enterKey(Jt.key)),Jt.optional){var rr=null;if(Jt.explicit!==null?rr=Jt.explicit:Jt.implicit!==null?rr=Jt.implicit:Jt.tag!==null&&(rr=Jt.tag),rr===null&&!Jt.any){var nr=zt.save();try{Jt.choice===null?this._decodeGeneric(Jt.tag,zt,Wt):this._decodeChoice(zt,Wt),Xt=!0}catch{Xt=!1}zt.restore(nr)}else if(Xt=this._peekTag(zt,rr,Jt.any),zt.isError(Xt))return Xt}var ar;if(Jt.obj&&Xt&&(ar=zt.enterObject()),Xt){if(Jt.explicit!==null){var ir=this._decodeTag(zt,Jt.explicit);if(zt.isError(ir))return ir;zt=ir}var lr=zt.offset;if(Jt.use===null&&Jt.choice===null){if(Jt.any)var nr=zt.save();var yr=this._decodeTag(zt,Jt.implicit!==null?Jt.implicit:Jt.tag,Jt.any);if(zt.isError(yr))return yr;Jt.any?Qt=zt.raw(nr):zt=yr}if(Wt&&Wt.track&&Jt.tag!==null&&Wt.track(zt.path(),lr,zt.length,"tagged"),Wt&&Wt.track&&Jt.tag!==null&&Wt.track(zt.path(),zt.offset,zt.length,"content"),Jt.any?Qt=Qt:Jt.choice===null?Qt=this._decodeGeneric(Jt.tag,zt,Wt):Qt=this._decodeChoice(zt,Wt),zt.isError(Qt))return Qt;if(!Jt.any&&Jt.choice===null&&Jt.children!==null&&Jt.children.forEach(function(Dr){Dr._decode(zt,Wt)}),Jt.contains&&(Jt.tag==="octstr"||Jt.tag==="bitstr")){var Sr=new xt(Qt);Qt=this._getUse(Jt.contains,zt._reporterState.obj)._decode(Sr,Wt)}}return Jt.obj&&Xt&&(Qt=zt.leaveObject(ar)),Jt.key!==null&&(Qt!==null||Xt===!0)?zt.leaveKey(tr,Jt.key,Qt):tr!==null&&zt.exitKey(tr),Qt},Lt.prototype._decodeGeneric=function(zt,Wt,Jt){var Qt=this._baseState;return zt==="seq"||zt==="set"?null:zt==="seqof"||zt==="setof"?this._decodeList(Wt,zt,Qt.args[0],Jt):/str$/.test(zt)?this._decodeStr(Wt,zt,Jt):zt==="objid"&&Qt.args?this._decodeObjid(Wt,Qt.args[0],Qt.args[1],Jt):zt==="objid"?this._decodeObjid(Wt,null,null,Jt):zt==="gentime"||zt==="utctime"?this._decodeTime(Wt,zt,Jt):zt==="null_"?this._decodeNull(Wt,Jt):zt==="bool"?this._decodeBool(Wt,Jt):zt==="objDesc"?this._decodeStr(Wt,zt,Jt):zt==="int"||zt==="enum"?this._decodeInt(Wt,Qt.args&&Qt.args[0],Jt):Qt.use!==null?this._getUse(Qt.use,Wt._reporterState.obj)._decode(Wt,Jt):Wt.error("unknown tag: "+zt)},Lt.prototype._getUse=function(zt,Wt){var Jt=this._baseState;return Jt.useDecoder=this._use(zt,Wt),Bt(Jt.useDecoder._baseState.parent===null),Jt.useDecoder=Jt.useDecoder._baseState.children[0],Jt.implicit!==Jt.useDecoder._baseState.implicit&&(Jt.useDecoder=Jt.useDecoder.clone(),Jt.useDecoder._baseState.implicit=Jt.implicit),Jt.useDecoder},Lt.prototype._decodeChoice=function(zt,Wt){var Jt=this._baseState,Qt=null,Xt=!1;return Object.keys(Jt.choice).some(function(tr){var rr=zt.save(),nr=Jt.choice[tr];try{var ar=nr._decode(zt,Wt);if(zt.isError(ar))return!1;Qt={type:tr,value:ar},Xt=!0}catch{return zt.restore(rr),!1}return!0},this),Xt?Qt:zt.error("Choice not matched")},Lt.prototype._createEncoderBuffer=function(zt){return new At(zt,this.reporter)},Lt.prototype._encode=function(zt,Wt,Jt){var Qt=this._baseState;if(!(Qt.default!==null&&Qt.default===zt)){var Xt=this._encodeValue(zt,Wt,Jt);if(Xt!==void 0&&!this._skipDefault(Xt,Wt,Jt))return Xt}},Lt.prototype._encodeValue=function(zt,Wt,Jt){var Qt=this._baseState;if(Qt.parent===null)return Qt.children[0]._encode(zt,Wt||new kt);var nr=null;if(this.reporter=Wt,Qt.optional&&zt===void 0)if(Qt.default!==null)zt=Qt.default;else return;var Xt=null,tr=!1;if(Qt.any)nr=this._createEncoderBuffer(zt);else if(Qt.choice)nr=this._encodeChoice(zt,Wt);else if(Qt.contains)Xt=this._getUse(Qt.contains,Jt)._encode(zt,Wt),tr=!0;else if(Qt.children)Xt=Qt.children.map(function(lr){if(lr._baseState.tag==="null_")return lr._encode(null,Wt,zt);if(lr._baseState.key===null)return Wt.error("Child should have a key");var yr=Wt.enterKey(lr._baseState.key);if(typeof zt!="object")return Wt.error("Child expected, but input is not object");var Sr=lr._encode(zt[lr._baseState.key],Wt,zt);return Wt.leaveKey(yr),Sr},this).filter(function(lr){return lr}),Xt=this._createEncoderBuffer(Xt);else if(Qt.tag==="seqof"||Qt.tag==="setof"){if(!(Qt.args&&Qt.args.length===1))return Wt.error("Too many args for : "+Qt.tag);if(!Array.isArray(zt))return Wt.error("seqof/setof, but data is not Array");var rr=this.clone();rr._baseState.implicit=null,Xt=this._createEncoderBuffer(zt.map(function(lr){var yr=this._baseState;return this._getUse(yr.args[0],zt)._encode(lr,Wt)},rr))}else Qt.use!==null?nr=this._getUse(Qt.use,Jt)._encode(zt,Wt):(Xt=this._encodePrimitive(Qt.tag,zt),tr=!0);var nr;if(!Qt.any&&Qt.choice===null){var ar=Qt.implicit!==null?Qt.implicit:Qt.tag,ir=Qt.implicit===null?"universal":"context";ar===null?Qt.use===null&&Wt.error("Tag could be omitted only for .use()"):Qt.use===null&&(nr=this._encodeComposite(ar,tr,ir,Xt))}return Qt.explicit!==null&&(nr=this._encodeComposite(Qt.explicit,!1,"context",nr)),nr},Lt.prototype._encodeChoice=function(zt,Wt){var Jt=this._baseState,Qt=Jt.choice[zt.type];return Qt||Bt(!1,zt.type+" not found in "+JSON.stringify(Object.keys(Jt.choice))),Qt._encode(zt.value,Wt)},Lt.prototype._encodePrimitive=function(zt,Wt){var Jt=this._baseState;if(/str$/.test(zt))return this._encodeStr(Wt,zt);if(zt==="objid"&&Jt.args)return this._encodeObjid(Wt,Jt.reverseArgs[0],Jt.args[1]);if(zt==="objid")return this._encodeObjid(Wt,null,null);if(zt==="gentime"||zt==="utctime")return this._encodeTime(Wt,zt);if(zt==="null_")return this._encodeNull();if(zt==="int"||zt==="enum")return this._encodeInt(Wt,Jt.args&&Jt.reverseArgs[0]);if(zt==="bool")return this._encodeBool(Wt);if(zt==="objDesc")return this._encodeStr(Wt,zt);throw new Error("Unsupported tag: "+zt)},Lt.prototype._isNumstr=function(zt){return/^[0-9 ]*$/.test(zt)},Lt.prototype._isPrintstr=function(zt){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(zt)},node}var hasRequiredBase;function requireBase(){return hasRequiredBase||(hasRequiredBase=1,function(kt){var At=kt;At.Reporter=reporter.Reporter,At.DecoderBuffer=requireBuffer().DecoderBuffer,At.EncoderBuffer=requireBuffer().EncoderBuffer,At.Node=requireNode()}(base$1)),base$1}var constants={},der={},hasRequiredDer$2;function requireDer$2(){return hasRequiredDer$2||(hasRequiredDer$2=1,function(kt){var At=requireConstants();kt.tagClass={0:"universal",1:"application",2:"context",3:"private"},kt.tagClassByName=At._reverse(kt.tagClass),kt.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},kt.tagByName=At._reverse(kt.tag)}(der)),der}var hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,function(kt){var At=kt;At._reverse=function(Bt){var Nt={};return Object.keys(Bt).forEach(function(jt){(jt|0)==jt&&(jt=jt|0);var Ut=Bt[jt];Nt[Ut]=jt}),Nt},At.der=requireDer$2()}(constants)),constants}var decoders={},der_1$1,hasRequiredDer$1;function requireDer$1(){if(hasRequiredDer$1)return der_1$1;hasRequiredDer$1=1;var kt=inherits_browserExports,At=requireAsn1(),xt=At.base,Bt=At.bignum,Nt=At.constants.der;function jt(Vt){this.enc="der",this.name=Vt.name,this.entity=Vt,this.tree=new Ut,this.tree._init(Vt.body)}der_1$1=jt,jt.prototype.decode=function(zt,Wt){return zt instanceof xt.DecoderBuffer||(zt=new xt.DecoderBuffer(zt,Wt)),this.tree._decode(zt,Wt)};function Ut(Vt){xt.Node.call(this,"der",Vt)}kt(Ut,xt.Node),Ut.prototype._peekTag=function(zt,Wt,Jt){if(zt.isEmpty())return!1;var Qt=zt.save(),Xt=Lt(zt,'Failed to peek tag: "'+Wt+'"');return zt.isError(Xt)?Xt:(zt.restore(Qt),Xt.tag===Wt||Xt.tagStr===Wt||Xt.tagStr+"of"===Wt||Jt)},Ut.prototype._decodeTag=function(zt,Wt,Jt){var Qt=Lt(zt,'Failed to decode tag of "'+Wt+'"');if(zt.isError(Qt))return Qt;var Xt=Ht(zt,Qt.primitive,'Failed to get length of "'+Wt+'"');if(zt.isError(Xt))return Xt;if(!Jt&&Qt.tag!==Wt&&Qt.tagStr!==Wt&&Qt.tagStr+"of"!==Wt)return zt.error('Failed to match tag: "'+Wt+'"');if(Qt.primitive||Xt!==null)return zt.skip(Xt,'Failed to match body of: "'+Wt+'"');var tr=zt.save(),rr=this._skipUntilEnd(zt,'Failed to skip indefinite length body: "'+this.tag+'"');return zt.isError(rr)?rr:(Xt=zt.offset-tr.offset,zt.restore(tr),zt.skip(Xt,'Failed to match body of: "'+Wt+'"'))},Ut.prototype._skipUntilEnd=function(zt,Wt){for(;;){var Jt=Lt(zt,Wt);if(zt.isError(Jt))return Jt;var Qt=Ht(zt,Jt.primitive,Wt);if(zt.isError(Qt))return Qt;var Xt;if(Jt.primitive||Qt!==null?Xt=zt.skip(Qt):Xt=this._skipUntilEnd(zt,Wt),zt.isError(Xt))return Xt;if(Jt.tagStr==="end")break}},Ut.prototype._decodeList=function(zt,Wt,Jt,Qt){for(var Xt=[];!zt.isEmpty();){var tr=this._peekTag(zt,"end");if(zt.isError(tr))return tr;var rr=Jt.decode(zt,"der",Qt);if(zt.isError(rr)&&tr)break;Xt.push(rr)}return Xt},Ut.prototype._decodeStr=function(zt,Wt){if(Wt==="bitstr"){var Jt=zt.readUInt8();return zt.isError(Jt)?Jt:{unused:Jt,data:zt.raw()}}else if(Wt==="bmpstr"){var Qt=zt.raw();if(Qt.length%2===1)return zt.error("Decoding of string type: bmpstr length mismatch");for(var Xt="",tr=0;tr<Qt.length/2;tr++)Xt+=String.fromCharCode(Qt.readUInt16BE(tr*2));return Xt}else if(Wt==="numstr"){var rr=zt.raw().toString("ascii");return this._isNumstr(rr)?rr:zt.error("Decoding of string type: numstr unsupported characters")}else{if(Wt==="octstr")return zt.raw();if(Wt==="objDesc")return zt.raw();if(Wt==="printstr"){var nr=zt.raw().toString("ascii");return this._isPrintstr(nr)?nr:zt.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(Wt)?zt.raw().toString():zt.error("Decoding of string type: "+Wt+" unsupported")}},Ut.prototype._decodeObjid=function(zt,Wt,Jt){for(var Qt,Xt=[],tr=0;!zt.isEmpty();){var rr=zt.readUInt8();tr<<=7,tr|=rr&127,rr&128||(Xt.push(tr),tr=0)}rr&128&&Xt.push(tr);var nr=Xt[0]/40|0,ar=Xt[0]%40;if(Jt?Qt=Xt:Qt=[nr,ar].concat(Xt.slice(1)),Wt){var ir=Wt[Qt.join(" ")];ir===void 0&&(ir=Wt[Qt.join(".")]),ir!==void 0&&(Qt=ir)}return Qt},Ut.prototype._decodeTime=function(zt,Wt){var Jt=zt.raw().toString();if(Wt==="gentime")var Qt=Jt.slice(0,4)|0,Xt=Jt.slice(4,6)|0,tr=Jt.slice(6,8)|0,rr=Jt.slice(8,10)|0,nr=Jt.slice(10,12)|0,ar=Jt.slice(12,14)|0;else if(Wt==="utctime"){var Qt=Jt.slice(0,2)|0,Xt=Jt.slice(2,4)|0,tr=Jt.slice(4,6)|0,rr=Jt.slice(6,8)|0,nr=Jt.slice(8,10)|0,ar=Jt.slice(10,12)|0;Qt<70?Qt=2e3+Qt:Qt=1900+Qt}else return zt.error("Decoding "+Wt+" time is not supported yet");return Date.UTC(Qt,Xt-1,tr,rr,nr,ar,0)},Ut.prototype._decodeNull=function(zt){return null},Ut.prototype._decodeBool=function(zt){var Wt=zt.readUInt8();return zt.isError(Wt)?Wt:Wt!==0},Ut.prototype._decodeInt=function(zt,Wt){var Jt=zt.raw(),Qt=new Bt(Jt);return Wt&&(Qt=Wt[Qt.toString(10)]||Qt),Qt},Ut.prototype._use=function(zt,Wt){return typeof zt=="function"&&(zt=zt(Wt)),zt._getDecoder("der").tree};function Lt(Vt,zt){var Wt=Vt.readUInt8(zt);if(Vt.isError(Wt))return Wt;var Jt=Nt.tagClass[Wt>>6],Qt=(Wt&32)===0;if((Wt&31)===31){var Xt=Wt;for(Wt=0;(Xt&128)===128;){if(Xt=Vt.readUInt8(zt),Vt.isError(Xt))return Xt;Wt<<=7,Wt|=Xt&127}}else Wt&=31;var tr=Nt.tag[Wt];return{cls:Jt,primitive:Qt,tag:Wt,tagStr:tr}}function Ht(Vt,zt,Wt){var Jt=Vt.readUInt8(Wt);if(Vt.isError(Jt))return Jt;if(!zt&&Jt===128)return null;if(!(Jt&128))return Jt;var Qt=Jt&127;if(Qt>4)return Vt.error("length octect is too long");Jt=0;for(var Xt=0;Xt<Qt;Xt++){Jt<<=8;var tr=Vt.readUInt8(Wt);if(Vt.isError(tr))return tr;Jt|=tr}return Jt}return der_1$1}var pem$1,hasRequiredPem$1;function requirePem$1(){if(hasRequiredPem$1)return pem$1;hasRequiredPem$1=1;var kt=inherits_browserExports,At=buffer$2.Buffer,xt=requireDer$1();function Bt(Nt){xt.call(this,Nt),this.enc="pem"}return kt(Bt,xt),pem$1=Bt,Bt.prototype.decode=function(jt,Ut){for(var Lt=jt.toString().split(/[\r\n]+/g),Ht=Ut.label.toUpperCase(),Vt=/^-----(BEGIN|END) ([^-]+)-----$/,zt=-1,Wt=-1,Jt=0;Jt<Lt.length;Jt++){var Qt=Lt[Jt].match(Vt);if(Qt!==null&&Qt[2]===Ht)if(zt===-1){if(Qt[1]!=="BEGIN")break;zt=Jt}else{if(Qt[1]!=="END")break;Wt=Jt;break}}if(zt===-1||Wt===-1)throw new Error("PEM section not found for: "+Ht);var Xt=Lt.slice(zt+1,Wt).join("");Xt.replace(/[^a-z0-9\+\/=]+/gi,"");var tr=new At(Xt,"base64");return xt.prototype.decode.call(this,tr,Ut)},pem$1}var hasRequiredDecoders;function requireDecoders(){return hasRequiredDecoders||(hasRequiredDecoders=1,function(kt){var At=kt;At.der=requireDer$1(),At.pem=requirePem$1()}(decoders)),decoders}var encoders={},der_1,hasRequiredDer;function requireDer(){if(hasRequiredDer)return der_1;hasRequiredDer=1;var kt=inherits_browserExports,At=buffer$2.Buffer,xt=requireAsn1(),Bt=xt.base,Nt=xt.constants.der;function jt(Vt){this.enc="der",this.name=Vt.name,this.entity=Vt,this.tree=new Ut,this.tree._init(Vt.body)}der_1=jt,jt.prototype.encode=function(zt,Wt){return this.tree._encode(zt,Wt).join()};function Ut(Vt){Bt.Node.call(this,"der",Vt)}kt(Ut,Bt.Node),Ut.prototype._encodeComposite=function(zt,Wt,Jt,Qt){var Xt=Ht(zt,Wt,Jt,this.reporter);if(Qt.length<128){var nr=new At(2);return nr[0]=Xt,nr[1]=Qt.length,this._createEncoderBuffer([nr,Qt])}for(var tr=1,rr=Qt.length;rr>=256;rr>>=8)tr++;var nr=new At(2+tr);nr[0]=Xt,nr[1]=128|tr;for(var rr=1+tr,ar=Qt.length;ar>0;rr--,ar>>=8)nr[rr]=ar&255;return this._createEncoderBuffer([nr,Qt])},Ut.prototype._encodeStr=function(zt,Wt){if(Wt==="bitstr")return this._createEncoderBuffer([zt.unused|0,zt.data]);if(Wt==="bmpstr"){for(var Jt=new At(zt.length*2),Qt=0;Qt<zt.length;Qt++)Jt.writeUInt16BE(zt.charCodeAt(Qt),Qt*2);return this._createEncoderBuffer(Jt)}else return Wt==="numstr"?this._isNumstr(zt)?this._createEncoderBuffer(zt):this.reporter.error("Encoding of string type: numstr supports only digits and space"):Wt==="printstr"?this._isPrintstr(zt)?this._createEncoderBuffer(zt):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(Wt)?this._createEncoderBuffer(zt):Wt==="objDesc"?this._createEncoderBuffer(zt):this.reporter.error("Encoding of string type: "+Wt+" unsupported")},Ut.prototype._encodeObjid=function(zt,Wt,Jt){if(typeof zt=="string"){if(!Wt)return this.reporter.error("string objid given, but no values map found");if(!Wt.hasOwnProperty(zt))return this.reporter.error("objid not found in values map");zt=Wt[zt].split(/[\s\.]+/g);for(var Qt=0;Qt<zt.length;Qt++)zt[Qt]|=0}else if(Array.isArray(zt)){zt=zt.slice();for(var Qt=0;Qt<zt.length;Qt++)zt[Qt]|=0}if(!Array.isArray(zt))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(zt));if(!Jt){if(zt[1]>=40)return this.reporter.error("Second objid identifier OOB");zt.splice(0,2,zt[0]*40+zt[1])}for(var Xt=0,Qt=0;Qt<zt.length;Qt++){var tr=zt[Qt];for(Xt++;tr>=128;tr>>=7)Xt++}for(var rr=new At(Xt),nr=rr.length-1,Qt=zt.length-1;Qt>=0;Qt--){var tr=zt[Qt];for(rr[nr--]=tr&127;(tr>>=7)>0;)rr[nr--]=128|tr&127}return this._createEncoderBuffer(rr)};function Lt(Vt){return Vt<10?"0"+Vt:Vt}Ut.prototype._encodeTime=function(zt,Wt){var Jt,Qt=new Date(zt);return Wt==="gentime"?Jt=[Lt(Qt.getFullYear()),Lt(Qt.getUTCMonth()+1),Lt(Qt.getUTCDate()),Lt(Qt.getUTCHours()),Lt(Qt.getUTCMinutes()),Lt(Qt.getUTCSeconds()),"Z"].join(""):Wt==="utctime"?Jt=[Lt(Qt.getFullYear()%100),Lt(Qt.getUTCMonth()+1),Lt(Qt.getUTCDate()),Lt(Qt.getUTCHours()),Lt(Qt.getUTCMinutes()),Lt(Qt.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+Wt+" time is not supported yet"),this._encodeStr(Jt,"octstr")},Ut.prototype._encodeNull=function(){return this._createEncoderBuffer("")},Ut.prototype._encodeInt=function(zt,Wt){if(typeof zt=="string"){if(!Wt)return this.reporter.error("String int or enum given, but no values map");if(!Wt.hasOwnProperty(zt))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(zt));zt=Wt[zt]}if(typeof zt!="number"&&!At.isBuffer(zt)){var Jt=zt.toArray();!zt.sign&&Jt[0]&128&&Jt.unshift(0),zt=new At(Jt)}if(At.isBuffer(zt)){var Qt=zt.length;zt.length===0&&Qt++;var tr=new At(Qt);return zt.copy(tr),zt.length===0&&(tr[0]=0),this._createEncoderBuffer(tr)}if(zt<128)return this._createEncoderBuffer(zt);if(zt<256)return this._createEncoderBuffer([0,zt]);for(var Qt=1,Xt=zt;Xt>=256;Xt>>=8)Qt++;for(var tr=new Array(Qt),Xt=tr.length-1;Xt>=0;Xt--)tr[Xt]=zt&255,zt>>=8;return tr[0]&128&&tr.unshift(0),this._createEncoderBuffer(new At(tr))},Ut.prototype._encodeBool=function(zt){return this._createEncoderBuffer(zt?255:0)},Ut.prototype._use=function(zt,Wt){return typeof zt=="function"&&(zt=zt(Wt)),zt._getEncoder("der").tree},Ut.prototype._skipDefault=function(zt,Wt,Jt){var Qt=this._baseState,Xt;if(Qt.default===null)return!1;var tr=zt.join();if(Qt.defaultBuffer===void 0&&(Qt.defaultBuffer=this._encodeValue(Qt.default,Wt,Jt).join()),tr.length!==Qt.defaultBuffer.length)return!1;for(Xt=0;Xt<tr.length;Xt++)if(tr[Xt]!==Qt.defaultBuffer[Xt])return!1;return!0};function Ht(Vt,zt,Wt,Jt){var Qt;if(Vt==="seqof"?Vt="seq":Vt==="setof"&&(Vt="set"),Nt.tagByName.hasOwnProperty(Vt))Qt=Nt.tagByName[Vt];else if(typeof Vt=="number"&&(Vt|0)===Vt)Qt=Vt;else return Jt.error("Unknown tag: "+Vt);return Qt>=31?Jt.error("Multi-octet tag encoding unsupported"):(zt||(Qt|=32),Qt|=Nt.tagClassByName[Wt||"universal"]<<6,Qt)}return der_1}var pem,hasRequiredPem;function requirePem(){if(hasRequiredPem)return pem;hasRequiredPem=1;var kt=inherits_browserExports,At=requireDer();function xt(Bt){At.call(this,Bt),this.enc="pem"}return kt(xt,At),pem=xt,xt.prototype.encode=function(Nt,jt){for(var Ut=At.prototype.encode.call(this,Nt),Lt=Ut.toString("base64"),Ht=["-----BEGIN "+jt.label+"-----"],Vt=0;Vt<Lt.length;Vt+=64)Ht.push(Lt.slice(Vt,Vt+64));return Ht.push("-----END "+jt.label+"-----"),Ht.join(`
`)},pem}var hasRequiredEncoders;function requireEncoders(){return hasRequiredEncoders||(hasRequiredEncoders=1,function(kt){var At=kt;At.der=requireDer(),At.pem=requirePem()}(encoders)),encoders}var hasRequiredAsn1;function requireAsn1(){return hasRequiredAsn1||(hasRequiredAsn1=1,function(kt){var At=kt;At.bignum=bnExports$1,At.define=requireApi().define,At.base=requireBase(),At.constants=requireConstants(),At.decoders=requireDecoders(),At.encoders=requireEncoders()}(asn1$2)),asn1$2}var asn=requireAsn1(),Time$1=asn.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),AttributeTypeValue=asn.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),AlgorithmIdentifier$1=asn.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),SubjectPublicKeyInfo=asn.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier$1),this.key("subjectPublicKey").bitstr())}),RelativeDistinguishedName=asn.define("RelativeDistinguishedName",function(){this.setof(AttributeTypeValue)}),RDNSequence=asn.define("RDNSequence",function(){this.seqof(RelativeDistinguishedName)}),Name=asn.define("Name",function(){this.choice({rdnSequence:this.use(RDNSequence)})}),Validity=asn.define("Validity",function(){this.seq().obj(this.key("notBefore").use(Time$1),this.key("notAfter").use(Time$1))}),Extension=asn.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),TBSCertificate=asn.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(AlgorithmIdentifier$1),this.key("issuer").use(Name),this.key("validity").use(Validity),this.key("subject").use(Name),this.key("subjectPublicKeyInfo").use(SubjectPublicKeyInfo),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(Extension).optional())}),X509Certificate=asn.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(TBSCertificate),this.key("signatureAlgorithm").use(AlgorithmIdentifier$1),this.key("signatureValue").bitstr())}),certificate=X509Certificate,asn1$1=requireAsn1();asn1$3.certificate=certificate;var RSAPrivateKey=asn1$1.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});asn1$3.RSAPrivateKey=RSAPrivateKey;var RSAPublicKey=asn1$1.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});asn1$3.RSAPublicKey=RSAPublicKey;var AlgorithmIdentifier=asn1$1.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),PublicKey$2=asn1$1.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())});asn1$3.PublicKey=PublicKey$2;var PrivateKeyInfo=asn1$1.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())});asn1$3.PrivateKey=PrivateKeyInfo;var EncryptedPrivateKeyInfo=asn1$1.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});asn1$3.EncryptedPrivateKey=EncryptedPrivateKeyInfo;var DSAPrivateKey=asn1$1.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});asn1$3.DSAPrivateKey=DSAPrivateKey;asn1$3.DSAparam=asn1$1.define("DSAparam",function(){this.int()});var ECParameters=asn1$1.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}),ECPrivateKey=asn1$1.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(ECParameters),this.key("publicKey").optional().explicit(1).bitstr())});asn1$3.ECPrivateKey=ECPrivateKey;asn1$3.signature=asn1$1.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())});const require$$1$2={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"};var findProc=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,startRegex=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,fullRegex=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,evp=evp_bytestokey,ciphers$1=browser$8,Buffer$c=safeBufferExports$1.Buffer,fixProc$1=function(kt,At){var xt=kt.toString(),Bt=xt.match(findProc),Nt;if(Bt){var Ut="aes"+Bt[1],Lt=Buffer$c.from(Bt[2],"hex"),Ht=Buffer$c.from(Bt[3].replace(/[\r\n]/g,""),"base64"),Vt=evp(At,Lt.slice(0,8),parseInt(Bt[1],10)).key,zt=[],Wt=ciphers$1.createDecipheriv(Ut,Vt,Lt);zt.push(Wt.update(Ht)),zt.push(Wt.final()),Nt=Buffer$c.concat(zt)}else{var jt=xt.match(fullRegex);Nt=Buffer$c.from(jt[2].replace(/[\r\n]/g,""),"base64")}var Jt=xt.match(startRegex)[1];return{tag:Jt,data:Nt}},asn1=asn1$3,aesid=require$$1$2,fixProc=fixProc$1,ciphers=browser$8,compat$1=browser$a,Buffer$b=safeBufferExports$1.Buffer;function decrypt(kt,At){var xt=kt.algorithm.decrypt.kde.kdeparams.salt,Bt=parseInt(kt.algorithm.decrypt.kde.kdeparams.iters.toString(),10),Nt=aesid[kt.algorithm.decrypt.cipher.algo.join(".")],jt=kt.algorithm.decrypt.cipher.iv,Ut=kt.subjectPrivateKey,Lt=parseInt(Nt.split("-")[1],10)/8,Ht=compat$1.pbkdf2Sync(At,xt,Bt,Lt,"sha1"),Vt=ciphers.createDecipheriv(Nt,Ht,jt),zt=[];return zt.push(Vt.update(Ut)),zt.push(Vt.final()),Buffer$b.concat(zt)}function parseKeys$2(kt){var At;typeof kt=="object"&&!Buffer$b.isBuffer(kt)&&(At=kt.passphrase,kt=kt.key),typeof kt=="string"&&(kt=Buffer$b.from(kt));var xt=fixProc(kt,At),Bt=xt.tag,Nt=xt.data,jt,Ut;switch(Bt){case"CERTIFICATE":Ut=asn1.certificate.decode(Nt,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(Ut||(Ut=asn1.PublicKey.decode(Nt,"der")),jt=Ut.algorithm.algorithm.join("."),jt){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(Ut.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return Ut.subjectPrivateKey=Ut.subjectPublicKey,{type:"ec",data:Ut};case"1.2.840.10040.4.1":return Ut.algorithm.params.pub_key=asn1.DSAparam.decode(Ut.subjectPublicKey.data,"der"),{type:"dsa",data:Ut.algorithm.params};default:throw new Error("unknown key id "+jt)}case"ENCRYPTED PRIVATE KEY":Nt=asn1.EncryptedPrivateKey.decode(Nt,"der"),Nt=decrypt(Nt,At);case"PRIVATE KEY":switch(Ut=asn1.PrivateKey.decode(Nt,"der"),jt=Ut.algorithm.algorithm.join("."),jt){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(Ut.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:Ut.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(Ut.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return Ut.algorithm.params.priv_key=asn1.DSAparam.decode(Ut.subjectPrivateKey,"der"),{type:"dsa",params:Ut.algorithm.params};default:throw new Error("unknown key id "+jt)}case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(Nt,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(Nt,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(Nt,"der")};case"EC PRIVATE KEY":return Nt=asn1.ECPrivateKey.decode(Nt,"der"),{curve:Nt.parameters.value,privateKey:Nt.privateKey};default:throw new Error("unknown key type "+Bt)}}parseKeys$2.signature=asn1.signature;var parseAsn1=parseKeys$2;const require$$4$1={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var hasRequiredSign;function requireSign(){if(hasRequiredSign)return sign.exports;hasRequiredSign=1;var kt=safeBufferExports$1.Buffer,At=browser$b,xt=browserifyRsa,Bt=requireElliptic().ec,Nt=bnExports,jt=parseAsn1,Ut=require$$4$1,Lt=1;function Ht(nr,ar,ir,lr,yr){var Sr=jt(ar);if(Sr.curve){if(lr!=="ecdsa"&&lr!=="ecdsa/rsa")throw new Error("wrong private key type");return Vt(nr,Sr)}else if(Sr.type==="dsa"){if(lr!=="dsa")throw new Error("wrong private key type");return zt(nr,Sr,ir)}if(lr!=="rsa"&&lr!=="ecdsa/rsa")throw new Error("wrong private key type");if(ar.padding!==void 0&&ar.padding!==Lt)throw new Error("illegal or unsupported padding mode");nr=kt.concat([yr,nr]);for(var Ar=Sr.modulus.byteLength(),Dr=[0,1];nr.length+Dr.length+1<Ar;)Dr.push(255);Dr.push(0);for(var Br=-1;++Br<nr.length;)Dr.push(nr[Br]);var Lr=xt(Dr,Sr);return Lr}function Vt(nr,ar){var ir=Ut[ar.curve.join(".")];if(!ir)throw new Error("unknown curve "+ar.curve.join("."));var lr=new Bt(ir),yr=lr.keyFromPrivate(ar.privateKey),Sr=yr.sign(nr);return kt.from(Sr.toDER())}function zt(nr,ar,ir){for(var lr=ar.params.priv_key,yr=ar.params.p,Sr=ar.params.q,Ar=ar.params.g,Dr=new Nt(0),Br,Lr=Qt(nr,Sr).mod(Sr),Or=!1,vr=Jt(lr,Sr,nr,ir);Or===!1;)Br=tr(Sr,vr,ir),Dr=rr(Ar,Br,yr,Sr),Or=Br.invm(Sr).imul(Lr.add(lr.mul(Dr))).mod(Sr),Or.cmpn(0)===0&&(Or=!1,Dr=new Nt(0));return Wt(Dr,Or)}function Wt(nr,ar){nr=nr.toArray(),ar=ar.toArray(),nr[0]&128&&(nr=[0].concat(nr)),ar[0]&128&&(ar=[0].concat(ar));var ir=nr.length+ar.length+4,lr=[48,ir,2,nr.length];return lr=lr.concat(nr,[2,ar.length],ar),kt.from(lr)}function Jt(nr,ar,ir,lr){if(nr=kt.from(nr.toArray()),nr.length<ar.byteLength()){var yr=kt.alloc(ar.byteLength()-nr.length);nr=kt.concat([yr,nr])}var Sr=ir.length,Ar=Xt(ir,ar),Dr=kt.alloc(Sr);Dr.fill(1);var Br=kt.alloc(Sr);return Br=At(lr,Br).update(Dr).update(kt.from([0])).update(nr).update(Ar).digest(),Dr=At(lr,Br).update(Dr).digest(),Br=At(lr,Br).update(Dr).update(kt.from([1])).update(nr).update(Ar).digest(),Dr=At(lr,Br).update(Dr).digest(),{k:Br,v:Dr}}function Qt(nr,ar){var ir=new Nt(nr),lr=(nr.length<<3)-ar.bitLength();return lr>0&&ir.ishrn(lr),ir}function Xt(nr,ar){nr=Qt(nr,ar),nr=nr.mod(ar);var ir=kt.from(nr.toArray());if(ir.length<ar.byteLength()){var lr=kt.alloc(ar.byteLength()-ir.length);ir=kt.concat([lr,ir])}return ir}function tr(nr,ar,ir){var lr,yr;do{for(lr=kt.alloc(0);lr.length*8<nr.bitLength();)ar.v=At(ir,ar.k).update(ar.v).digest(),lr=kt.concat([lr,ar.v]);yr=Qt(lr,nr),ar.k=At(ir,ar.k).update(ar.v).update(kt.from([0])).digest(),ar.v=At(ir,ar.k).update(ar.v).digest()}while(yr.cmp(nr)!==-1);return yr}function rr(nr,ar,ir,lr){return nr.toRed(Nt.mont(ir)).redPow(ar).fromRed().mod(lr)}return sign.exports=Ht,sign.exports.getKey=Jt,sign.exports.makeKey=tr,sign.exports}var verify_1,hasRequiredVerify;function requireVerify(){if(hasRequiredVerify)return verify_1;hasRequiredVerify=1;var kt=safeBufferExports$1.Buffer,At=bnExports,xt=requireElliptic().ec,Bt=parseAsn1,Nt=require$$4$1;function jt(Vt,zt,Wt,Jt,Qt){var Xt=Bt(Wt);if(Xt.type==="ec"){if(Jt!=="ecdsa"&&Jt!=="ecdsa/rsa")throw new Error("wrong public key type");return Ut(Vt,zt,Xt)}else if(Xt.type==="dsa"){if(Jt!=="dsa")throw new Error("wrong public key type");return Lt(Vt,zt,Xt)}if(Jt!=="rsa"&&Jt!=="ecdsa/rsa")throw new Error("wrong public key type");zt=kt.concat([Qt,zt]);for(var tr=Xt.modulus.byteLength(),rr=[1],nr=0;zt.length+rr.length+2<tr;)rr.push(255),nr+=1;rr.push(0);for(var ar=-1;++ar<zt.length;)rr.push(zt[ar]);rr=kt.from(rr);var ir=At.mont(Xt.modulus);Vt=new At(Vt).toRed(ir),Vt=Vt.redPow(new At(Xt.publicExponent)),Vt=kt.from(Vt.fromRed().toArray());var lr=nr<8?1:0;for(tr=Math.min(Vt.length,rr.length),Vt.length!==rr.length&&(lr=1),ar=-1;++ar<tr;)lr|=Vt[ar]^rr[ar];return lr===0}function Ut(Vt,zt,Wt){var Jt=Nt[Wt.data.algorithm.curve.join(".")];if(!Jt)throw new Error("unknown curve "+Wt.data.algorithm.curve.join("."));var Qt=new xt(Jt),Xt=Wt.data.subjectPrivateKey.data;return Qt.verify(zt,Vt,Xt)}function Lt(Vt,zt,Wt){var Jt=Wt.data.p,Qt=Wt.data.q,Xt=Wt.data.g,tr=Wt.data.pub_key,rr=Bt.signature.decode(Vt,"der"),nr=rr.s,ar=rr.r;Ht(nr,Qt),Ht(ar,Qt);var ir=At.mont(Jt),lr=nr.invm(Qt),yr=Xt.toRed(ir).redPow(new At(zt).mul(lr).mod(Qt)).fromRed().mul(tr.toRed(ir).redPow(ar.mul(lr).mod(Qt)).fromRed()).mod(Jt).mod(Qt);return yr.cmp(ar)===0}function Ht(Vt,zt){if(Vt.cmpn(0)<=0)throw new Error("invalid sig");if(Vt.cmp(zt)>=0)throw new Error("invalid sig")}return verify_1=jt,verify_1}var browser$6,hasRequiredBrowser$2;function requireBrowser$2(){if(hasRequiredBrowser$2)return browser$6;hasRequiredBrowser$2=1;var kt=safeBufferExports$1.Buffer,At=browser$c,xt=readableBrowserExports,Bt=inherits_browserExports,Nt=requireSign(),jt=requireVerify(),Ut=require$$6$1;Object.keys(Ut).forEach(function(Wt){Ut[Wt].id=kt.from(Ut[Wt].id,"hex"),Ut[Wt.toLowerCase()]=Ut[Wt]});function Lt(Wt){xt.Writable.call(this);var Jt=Ut[Wt];if(!Jt)throw new Error("Unknown message digest");this._hashType=Jt.hash,this._hash=At(Jt.hash),this._tag=Jt.id,this._signType=Jt.sign}Bt(Lt,xt.Writable),Lt.prototype._write=function(Jt,Qt,Xt){this._hash.update(Jt),Xt()},Lt.prototype.update=function(Jt,Qt){return this._hash.update(typeof Jt=="string"?kt.from(Jt,Qt):Jt),this},Lt.prototype.sign=function(Jt,Qt){this.end();var Xt=this._hash.digest(),tr=Nt(Xt,Jt,this._hashType,this._signType,this._tag);return Qt?tr.toString(Qt):tr};function Ht(Wt){xt.Writable.call(this);var Jt=Ut[Wt];if(!Jt)throw new Error("Unknown message digest");this._hash=At(Jt.hash),this._tag=Jt.id,this._signType=Jt.sign}Bt(Ht,xt.Writable),Ht.prototype._write=function(Jt,Qt,Xt){this._hash.update(Jt),Xt()},Ht.prototype.update=function(Jt,Qt){return this._hash.update(typeof Jt=="string"?kt.from(Jt,Qt):Jt),this},Ht.prototype.verify=function(Jt,Qt,Xt){var tr=typeof Qt=="string"?kt.from(Qt,Xt):Qt;this.end();var rr=this._hash.digest();return jt(tr,rr,Jt,this._signType,this._tag)};function Vt(Wt){return new Lt(Wt)}function zt(Wt){return new Ht(Wt)}return browser$6={Sign:Vt,Verify:zt,createSign:Vt,createVerify:zt},browser$6}var browser$5,hasRequiredBrowser$1;function requireBrowser$1(){if(hasRequiredBrowser$1)return browser$5;hasRequiredBrowser$1=1;var kt=requireElliptic(),At=bnExports$1;browser$5=function(Ut){return new Bt(Ut)};var xt={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};xt.p224=xt.secp224r1,xt.p256=xt.secp256r1=xt.prime256v1,xt.p192=xt.secp192r1=xt.prime192v1,xt.p384=xt.secp384r1,xt.p521=xt.secp521r1;function Bt(jt){this.curveType=xt[jt],this.curveType||(this.curveType={name:jt}),this.curve=new kt.ec(this.curveType.name),this.keys=void 0}Bt.prototype.generateKeys=function(jt,Ut){return this.keys=this.curve.genKeyPair(),this.getPublicKey(jt,Ut)},Bt.prototype.computeSecret=function(jt,Ut,Lt){Ut=Ut||"utf8",buffer$2.Buffer.isBuffer(jt)||(jt=new buffer$2.Buffer(jt,Ut));var Ht=this.curve.keyFromPublic(jt).getPublic(),Vt=Ht.mul(this.keys.getPrivate()).getX();return Nt(Vt,Lt,this.curveType.byteLength)},Bt.prototype.getPublicKey=function(jt,Ut){var Lt=this.keys.getPublic(Ut==="compressed",!0);return Ut==="hybrid"&&(Lt[Lt.length-1]%2?Lt[0]=7:Lt[0]=6),Nt(Lt,jt)},Bt.prototype.getPrivateKey=function(jt){return Nt(this.keys.getPrivate(),jt)},Bt.prototype.setPublicKey=function(jt,Ut){return Ut=Ut||"utf8",buffer$2.Buffer.isBuffer(jt)||(jt=new buffer$2.Buffer(jt,Ut)),this.keys._importPublic(jt),this},Bt.prototype.setPrivateKey=function(jt,Ut){Ut=Ut||"utf8",buffer$2.Buffer.isBuffer(jt)||(jt=new buffer$2.Buffer(jt,Ut));var Lt=new At(jt);return Lt=Lt.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(Lt),this};function Nt(jt,Ut,Lt){Array.isArray(jt)||(jt=jt.toArray());var Ht=new buffer$2.Buffer(jt);if(Lt&&Ht.length<Lt){var Vt=new buffer$2.Buffer(Lt-Ht.length);Vt.fill(0),Ht=buffer$2.Buffer.concat([Vt,Ht])}return Ut?Ht.toString(Ut):Ht}return browser$5}var browser$4={},createHash$2=browser$c,Buffer$a=safeBufferExports$1.Buffer,mgf$2=function(kt,At){for(var xt=Buffer$a.alloc(0),Bt=0,Nt;xt.length<At;)Nt=i2ops(Bt++),xt=Buffer$a.concat([xt,createHash$2("sha1").update(kt).update(Nt).digest()]);return xt.slice(0,At)};function i2ops(kt){var At=Buffer$a.allocUnsafe(4);return At.writeUInt32BE(kt,0),At}var xor$2=function kt(At,xt){for(var Bt=At.length,Nt=-1;++Nt<Bt;)At[Nt]^=xt[Nt];return At},BN$2=bnExports$1,Buffer$9=safeBufferExports$1.Buffer;function withPublic$2(kt,At){return Buffer$9.from(kt.toRed(BN$2.mont(At.modulus)).redPow(new BN$2(At.publicExponent)).fromRed().toArray())}var withPublic_1=withPublic$2,parseKeys$1=parseAsn1,randomBytes$4=browserExports$2,createHash$1=browser$c,mgf$1=mgf$2,xor$1=xor$2,BN$1=bnExports$1,withPublic$1=withPublic_1,crt$1=browserifyRsa,Buffer$8=safeBufferExports$1.Buffer,publicEncrypt=function kt(At,xt,Bt){var Nt;At.padding?Nt=At.padding:Bt?Nt=1:Nt=4;var jt=parseKeys$1(At),Ut;if(Nt===4)Ut=oaep$1(jt,xt);else if(Nt===1)Ut=pkcs1$1(jt,xt,Bt);else if(Nt===3){if(Ut=new BN$1(xt),Ut.cmp(jt.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return Bt?crt$1(Ut,jt):withPublic$1(Ut,jt)};function oaep$1(kt,At){var xt=kt.modulus.byteLength(),Bt=At.length,Nt=createHash$1("sha1").update(Buffer$8.alloc(0)).digest(),jt=Nt.length,Ut=2*jt;if(Bt>xt-Ut-2)throw new Error("message too long");var Lt=Buffer$8.alloc(xt-Bt-Ut-2),Ht=xt-jt-1,Vt=randomBytes$4(jt),zt=xor$1(Buffer$8.concat([Nt,Lt,Buffer$8.alloc(1,1),At],Ht),mgf$1(Vt,Ht)),Wt=xor$1(Vt,mgf$1(zt,jt));return new BN$1(Buffer$8.concat([Buffer$8.alloc(1),Wt,zt],xt))}function pkcs1$1(kt,At,xt){var Bt=At.length,Nt=kt.modulus.byteLength();if(Bt>Nt-11)throw new Error("message too long");var jt;return xt?jt=Buffer$8.alloc(Nt-Bt-3,255):jt=nonZero(Nt-Bt-3),new BN$1(Buffer$8.concat([Buffer$8.from([0,xt?1:2]),jt,Buffer$8.alloc(1),At],Nt))}function nonZero(kt){for(var At=Buffer$8.allocUnsafe(kt),xt=0,Bt=randomBytes$4(kt*2),Nt=0,jt;xt<kt;)Nt===Bt.length&&(Bt=randomBytes$4(kt*2),Nt=0),jt=Bt[Nt++],jt&&(At[xt++]=jt);return At}var parseKeys=parseAsn1,mgf=mgf$2,xor=xor$2,BN=bnExports$1,crt=browserifyRsa,createHash=browser$c,withPublic=withPublic_1,Buffer$7=safeBufferExports$1.Buffer,privateDecrypt=function kt(At,xt,Bt){var Nt;At.padding?Nt=At.padding:Bt?Nt=1:Nt=4;var jt=parseKeys(At),Ut=jt.modulus.byteLength();if(xt.length>Ut||new BN(xt).cmp(jt.modulus)>=0)throw new Error("decryption error");var Lt;Bt?Lt=withPublic(new BN(xt),jt):Lt=crt(xt,jt);var Ht=Buffer$7.alloc(Ut-Lt.length);if(Lt=Buffer$7.concat([Ht,Lt],Ut),Nt===4)return oaep(jt,Lt);if(Nt===1)return pkcs1(jt,Lt,Bt);if(Nt===3)return Lt;throw new Error("unknown padding")};function oaep(kt,At){var xt=kt.modulus.byteLength(),Bt=createHash("sha1").update(Buffer$7.alloc(0)).digest(),Nt=Bt.length;if(At[0]!==0)throw new Error("decryption error");var jt=At.slice(1,Nt+1),Ut=At.slice(Nt+1),Lt=xor(jt,mgf(Ut,Nt)),Ht=xor(Ut,mgf(Lt,xt-Nt-1));if(compare(Bt,Ht.slice(0,Nt)))throw new Error("decryption error");for(var Vt=Nt;Ht[Vt]===0;)Vt++;if(Ht[Vt++]!==1)throw new Error("decryption error");return Ht.slice(Vt)}function pkcs1(kt,At,xt){for(var Bt=At.slice(0,2),Nt=2,jt=0;At[Nt++]!==0;)if(Nt>=At.length){jt++;break}var Ut=At.slice(2,Nt-1);if((Bt.toString("hex")!=="0002"&&!xt||Bt.toString("hex")!=="0001"&&xt)&&jt++,Ut.length<8&&jt++,jt)throw new Error("decryption error");return At.slice(Nt)}function compare(kt,At){kt=Buffer$7.from(kt),At=Buffer$7.from(At);var xt=0,Bt=kt.length;kt.length!==At.length&&(xt++,Bt=Math.min(kt.length,At.length));for(var Nt=-1;++Nt<Bt;)xt+=kt[Nt]^At[Nt];return xt}(function(kt){kt.publicEncrypt=publicEncrypt,kt.privateDecrypt=privateDecrypt,kt.privateEncrypt=function(xt,Bt){return kt.publicEncrypt(xt,Bt,!0)},kt.publicDecrypt=function(xt,Bt){return kt.privateDecrypt(xt,Bt,!0)}})(browser$4);var browser$3={};function oldBrowser(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var safeBuffer=safeBufferExports$1,randombytes=browserExports$2,Buffer$6=safeBuffer.Buffer,kBufferMaxLength=safeBuffer.kMaxLength,crypto$5=globalThis.crypto||globalThis.msCrypto,kMaxUint32=Math.pow(2,32)-1;function assertOffset(kt,At){if(typeof kt!="number"||kt!==kt)throw new TypeError("offset must be a number");if(kt>kMaxUint32||kt<0)throw new TypeError("offset must be a uint32");if(kt>kBufferMaxLength||kt>At)throw new RangeError("offset out of range")}function assertSize(kt,At,xt){if(typeof kt!="number"||kt!==kt)throw new TypeError("size must be a number");if(kt>kMaxUint32||kt<0)throw new TypeError("size must be a uint32");if(kt+At>xt||kt>kBufferMaxLength)throw new RangeError("buffer too small")}crypto$5&&crypto$5.getRandomValues||!process$9.browser?(browser$3.randomFill=randomFill,browser$3.randomFillSync=randomFillSync):(browser$3.randomFill=oldBrowser,browser$3.randomFillSync=oldBrowser);function randomFill(kt,At,xt,Bt){if(!Buffer$6.isBuffer(kt)&&!(kt instanceof globalThis.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof At=="function")Bt=At,At=0,xt=kt.length;else if(typeof xt=="function")Bt=xt,xt=kt.length-At;else if(typeof Bt!="function")throw new TypeError('"cb" argument must be a function');return assertOffset(At,kt.length),assertSize(xt,At,kt.length),actualFill(kt,At,xt,Bt)}function actualFill(kt,At,xt,Bt){if(process$9.browser){var Nt=kt.buffer,jt=new Uint8Array(Nt,At,xt);if(crypto$5.getRandomValues(jt),Bt){process$9.nextTick(function(){Bt(null,kt)});return}return kt}if(Bt){randombytes(xt,function(Lt,Ht){if(Lt)return Bt(Lt);Ht.copy(kt,At),Bt(null,kt)});return}var Ut=randombytes(xt);return Ut.copy(kt,At),kt}function randomFillSync(kt,At,xt){if(typeof At>"u"&&(At=0),!Buffer$6.isBuffer(kt)&&!(kt instanceof globalThis.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return assertOffset(At,kt.length),xt===void 0&&(xt=kt.length-At),assertSize(xt,At,kt.length),actualFill(kt,At,xt)}var hasRequiredCryptoBrowserify;function requireCryptoBrowserify(){if(hasRequiredCryptoBrowserify)return cryptoBrowserify;hasRequiredCryptoBrowserify=1,cryptoBrowserify.randomBytes=cryptoBrowserify.rng=cryptoBrowserify.pseudoRandomBytes=cryptoBrowserify.prng=browserExports$2,cryptoBrowserify.createHash=cryptoBrowserify.Hash=browser$c,cryptoBrowserify.createHmac=cryptoBrowserify.Hmac=browser$b;var kt=algos,At=Object.keys(kt),xt=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(At);cryptoBrowserify.getHashes=function(){return xt};var Bt=browser$a;cryptoBrowserify.pbkdf2=Bt.pbkdf2,cryptoBrowserify.pbkdf2Sync=Bt.pbkdf2Sync;var Nt=browser$9;cryptoBrowserify.Cipher=Nt.Cipher,cryptoBrowserify.createCipher=Nt.createCipher,cryptoBrowserify.Cipheriv=Nt.Cipheriv,cryptoBrowserify.createCipheriv=Nt.createCipheriv,cryptoBrowserify.Decipher=Nt.Decipher,cryptoBrowserify.createDecipher=Nt.createDecipher,cryptoBrowserify.Decipheriv=Nt.Decipheriv,cryptoBrowserify.createDecipheriv=Nt.createDecipheriv,cryptoBrowserify.getCiphers=Nt.getCiphers,cryptoBrowserify.listCiphers=Nt.listCiphers;var jt=requireBrowser$3();cryptoBrowserify.DiffieHellmanGroup=jt.DiffieHellmanGroup,cryptoBrowserify.createDiffieHellmanGroup=jt.createDiffieHellmanGroup,cryptoBrowserify.getDiffieHellman=jt.getDiffieHellman,cryptoBrowserify.createDiffieHellman=jt.createDiffieHellman,cryptoBrowserify.DiffieHellman=jt.DiffieHellman;var Ut=requireBrowser$2();cryptoBrowserify.createSign=Ut.createSign,cryptoBrowserify.Sign=Ut.Sign,cryptoBrowserify.createVerify=Ut.createVerify,cryptoBrowserify.Verify=Ut.Verify,cryptoBrowserify.createECDH=requireBrowser$1();var Lt=browser$4;cryptoBrowserify.publicEncrypt=Lt.publicEncrypt,cryptoBrowserify.privateEncrypt=Lt.privateEncrypt,cryptoBrowserify.publicDecrypt=Lt.publicDecrypt,cryptoBrowserify.privateDecrypt=Lt.privateDecrypt;var Ht=browser$3;return cryptoBrowserify.randomFill=Ht.randomFill,cryptoBrowserify.randomFillSync=Ht.randomFillSync,cryptoBrowserify.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},cryptoBrowserify.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6},cryptoBrowserify}var cryptoBrowserifyExports=requireCryptoBrowserify(),dist={},utils$7={};(function(kt){/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */Object.defineProperty(kt,"__esModule",{value:!0}),kt.setBigUint64=kt.Hash=kt.equalBytes=kt.ensureBytes=kt.checkOpts=kt.concatBytes=kt.toBytes=kt.bytesToUtf8=kt.utf8ToBytes=kt.asyncLoop=kt.nextTick=kt.hexToBytes=kt.bytesToHex=kt.isLE=kt.createView=kt.u32=kt.u16=kt.u8=void 0;const At=yr=>yr instanceof Uint8Array,xt=yr=>new Uint8Array(yr.buffer,yr.byteOffset,yr.byteLength);kt.u8=xt;const Bt=yr=>new Uint16Array(yr.buffer,yr.byteOffset,Math.floor(yr.byteLength/2));kt.u16=Bt;const Nt=yr=>new Uint32Array(yr.buffer,yr.byteOffset,Math.floor(yr.byteLength/4));kt.u32=Nt;const jt=yr=>new DataView(yr.buffer,yr.byteOffset,yr.byteLength);if(kt.createView=jt,kt.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!kt.isLE)throw new Error("Non little-endian hardware is not supported");const Ut=Array.from({length:256},(yr,Sr)=>Sr.toString(16).padStart(2,"0"));function Lt(yr){if(!At(yr))throw new Error("Uint8Array expected");let Sr="";for(let Ar=0;Ar<yr.length;Ar++)Sr+=Ut[yr[Ar]];return Sr}kt.bytesToHex=Lt;function Ht(yr){if(typeof yr!="string")throw new Error("hex string expected, got "+typeof yr);const Sr=yr.length;if(Sr%2)throw new Error("padded hex string expected, got unpadded hex of length "+Sr);const Ar=new Uint8Array(Sr/2);for(let Dr=0;Dr<Ar.length;Dr++){const Br=Dr*2,Lr=yr.slice(Br,Br+2),Or=Number.parseInt(Lr,16);if(Number.isNaN(Or)||Or<0)throw new Error("Invalid byte sequence");Ar[Dr]=Or}return Ar}kt.hexToBytes=Ht;const Vt=async()=>{};kt.nextTick=Vt;async function zt(yr,Sr,Ar){let Dr=Date.now();for(let Br=0;Br<yr;Br++){Ar(Br);const Lr=Date.now()-Dr;Lr>=0&&Lr<Sr||(await(0,kt.nextTick)(),Dr+=Lr)}}kt.asyncLoop=zt;function Wt(yr){if(typeof yr!="string")throw new Error(`utf8ToBytes expected string, got ${typeof yr}`);return new Uint8Array(new TextEncoder().encode(yr))}kt.utf8ToBytes=Wt;function Jt(yr){return new TextDecoder().decode(yr)}kt.bytesToUtf8=Jt;function Qt(yr){if(typeof yr=="string"&&(yr=Wt(yr)),!At(yr))throw new Error(`expected Uint8Array, got ${typeof yr}`);return yr}kt.toBytes=Qt;function Xt(...yr){const Sr=new Uint8Array(yr.reduce((Dr,Br)=>Dr+Br.length,0));let Ar=0;return yr.forEach(Dr=>{if(!At(Dr))throw new Error("Uint8Array expected");Sr.set(Dr,Ar),Ar+=Dr.length}),Sr}kt.concatBytes=Xt;const tr=yr=>Object.prototype.toString.call(yr)==="[object Object]"&&yr.constructor===Object;function rr(yr,Sr){if(Sr!==void 0&&(typeof Sr!="object"||!tr(Sr)))throw new Error("options must be object or undefined");return Object.assign(yr,Sr)}kt.checkOpts=rr;function nr(yr,Sr){if(!(yr instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof Sr=="number"&&yr.length!==Sr)throw new Error(`Uint8Array length ${Sr} expected`)}kt.ensureBytes=nr;function ar(yr,Sr){if(yr.length!==Sr.length)throw new Error("equalBytes: Different size of Uint8Arrays");let Ar=!0;for(let Dr=0;Dr<yr.length;Dr++)Ar&&(Ar=yr[Dr]===Sr[Dr]);return Ar}kt.equalBytes=ar;class ir{}kt.Hash=ir;function lr(yr,Sr,Ar,Dr){if(typeof yr.setBigUint64=="function")return yr.setBigUint64(Sr,Ar,Dr);const Br=BigInt(32),Lr=BigInt(4294967295),Or=Number(Ar>>Br&Lr),vr=Number(Ar&Lr),pr=Dr?4:0,dr=Dr?0:4;yr.setUint32(Sr+pr,Or,Dr),yr.setUint32(Sr+dr,vr,Dr)}kt.setBigUint64=lr})(utils$7);var config={},consts={};Object.defineProperty(consts,"__esModule",{value:!0});consts.AEAD_TAG_LENGTH=consts.XCHACHA20_NONCE_LENGTH=consts.CURVE25519_PUBLIC_KEY_SIZE=consts.ETH_PUBLIC_KEY_SIZE=consts.UNCOMPRESSED_PUBLIC_KEY_SIZE=consts.COMPRESSED_PUBLIC_KEY_SIZE=consts.SECRET_KEY_LENGTH=void 0;consts.SECRET_KEY_LENGTH=32;consts.COMPRESSED_PUBLIC_KEY_SIZE=33;consts.UNCOMPRESSED_PUBLIC_KEY_SIZE=65;consts.ETH_PUBLIC_KEY_SIZE=64;consts.CURVE25519_PUBLIC_KEY_SIZE=32;consts.XCHACHA20_NONCE_LENGTH=24;consts.AEAD_TAG_LENGTH=16;(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.ephemeralKeySize=kt.symmetricNonceLength=kt.symmetricAlgorithm=kt.isHkdfKeyCompressed=kt.isEphemeralKeyCompressed=kt.ellipticCurve=kt.ECIES_CONFIG=void 0;var At=consts,xt=function(){function Vt(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16}return Vt}();kt.ECIES_CONFIG=new xt;var Bt=function(){return kt.ECIES_CONFIG.ellipticCurve};kt.ellipticCurve=Bt;var Nt=function(){return kt.ECIES_CONFIG.isEphemeralKeyCompressed};kt.isEphemeralKeyCompressed=Nt;var jt=function(){return kt.ECIES_CONFIG.isHkdfKeyCompressed};kt.isHkdfKeyCompressed=jt;var Ut=function(){return kt.ECIES_CONFIG.symmetricAlgorithm};kt.symmetricAlgorithm=Ut;var Lt=function(){return kt.ECIES_CONFIG.symmetricNonceLength};kt.symmetricNonceLength=Lt;var Ht=function(){var Vt={secp256k1:kt.ECIES_CONFIG.isEphemeralKeyCompressed?At.COMPRESSED_PUBLIC_KEY_SIZE:At.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:At.CURVE25519_PUBLIC_KEY_SIZE,ed25519:At.CURVE25519_PUBLIC_KEY_SIZE};if(kt.ECIES_CONFIG.ellipticCurve in Vt)return Vt[kt.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")};kt.ephemeralKeySize=Ht})(config);var keys={},PrivateKey$1={},utils$6={},elliptic={},utils$5={},crypto$4={};Object.defineProperty(crypto$4,"__esModule",{value:!0});crypto$4.crypto=void 0;crypto$4.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;Object.defineProperty(utils$5,"__esModule",{value:!0});utils$5.getWebcryptoSubtle=utils$5.randomBytes=void 0;const crypto_1$1=crypto$4;function randomBytes$3(kt=32){if(crypto_1$1.crypto&&typeof crypto_1$1.crypto.getRandomValues=="function")return crypto_1$1.crypto.getRandomValues(new Uint8Array(kt));throw new Error("crypto.getRandomValues must be defined")}utils$5.randomBytes=randomBytes$3;function getWebcryptoSubtle$1(){if(crypto_1$1.crypto&&typeof crypto_1$1.crypto.subtle=="object"&&crypto_1$1.crypto.subtle!=null)return crypto_1$1.crypto.subtle;throw new Error("crypto.subtle must be defined")}utils$5.getWebcryptoSubtle=getWebcryptoSubtle$1;var ed25519$1={},sha512$1={},_md={},_assert$1={};Object.defineProperty(_assert$1,"__esModule",{value:!0});_assert$1.output=_assert$1.exists=_assert$1.hash=_assert$1.bytes=_assert$1.bool=_assert$1.number=_assert$1.isBytes=void 0;function number$3(kt){if(!Number.isSafeInteger(kt)||kt<0)throw new Error(`positive integer expected, not ${kt}`)}_assert$1.number=number$3;function bool$2(kt){if(typeof kt!="boolean")throw new Error(`boolean expected, not ${kt}`)}_assert$1.bool=bool$2;function isBytes$8(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}_assert$1.isBytes=isBytes$8;function bytes$4(kt,...At){if(!isBytes$8(kt))throw new Error("Uint8Array expected");if(At.length>0&&!At.includes(kt.length))throw new Error(`Uint8Array expected of length ${At}, not of length=${kt.length}`)}_assert$1.bytes=bytes$4;function hash$2(kt){if(typeof kt!="function"||typeof kt.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$3(kt.outputLen),number$3(kt.blockLen)}_assert$1.hash=hash$2;function exists$4(kt,At=!0){if(kt.destroyed)throw new Error("Hash instance has been destroyed");if(At&&kt.finished)throw new Error("Hash#digest() has already been called")}_assert$1.exists=exists$4;function output$4(kt,At){bytes$4(kt);const xt=At.outputLen;if(kt.length<xt)throw new Error(`digestInto() expects output buffer of length at least ${xt}`)}_assert$1.output=output$4;const assert$3={number:number$3,bool:bool$2,bytes:bytes$4,hash:hash$2,exists:exists$4,output:output$4};_assert$1.default=assert$3;var utils$4={},crypto$3={};Object.defineProperty(crypto$3,"__esModule",{value:!0});crypto$3.crypto=void 0;crypto$3.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;(function(kt){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(kt,"__esModule",{value:!0}),kt.randomBytes=kt.wrapXOFConstructorWithOpts=kt.wrapConstructorWithOpts=kt.wrapConstructor=kt.checkOpts=kt.Hash=kt.concatBytes=kt.toBytes=kt.utf8ToBytes=kt.asyncLoop=kt.nextTick=kt.hexToBytes=kt.bytesToHex=kt.byteSwap32=kt.byteSwapIfBE=kt.byteSwap=kt.isLE=kt.rotl=kt.rotr=kt.createView=kt.u32=kt.u8=kt.isBytes=void 0;const At=crypto$3,xt=_assert$1;function Bt(vr){return vr instanceof Uint8Array||vr!=null&&typeof vr=="object"&&vr.constructor.name==="Uint8Array"}kt.isBytes=Bt;const Nt=vr=>new Uint8Array(vr.buffer,vr.byteOffset,vr.byteLength);kt.u8=Nt;const jt=vr=>new Uint32Array(vr.buffer,vr.byteOffset,Math.floor(vr.byteLength/4));kt.u32=jt;const Ut=vr=>new DataView(vr.buffer,vr.byteOffset,vr.byteLength);kt.createView=Ut;const Lt=(vr,pr)=>vr<<32-pr|vr>>>pr;kt.rotr=Lt;const Ht=(vr,pr)=>vr<<pr|vr>>>32-pr>>>0;kt.rotl=Ht,kt.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;const Vt=vr=>vr<<24&4278190080|vr<<8&16711680|vr>>>8&65280|vr>>>24&255;kt.byteSwap=Vt,kt.byteSwapIfBE=kt.isLE?vr=>vr:vr=>(0,kt.byteSwap)(vr);function zt(vr){for(let pr=0;pr<vr.length;pr++)vr[pr]=(0,kt.byteSwap)(vr[pr])}kt.byteSwap32=zt;const Wt=Array.from({length:256},(vr,pr)=>pr.toString(16).padStart(2,"0"));function Jt(vr){(0,xt.bytes)(vr);let pr="";for(let dr=0;dr<vr.length;dr++)pr+=Wt[vr[dr]];return pr}kt.bytesToHex=Jt;const Qt={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Xt(vr){if(vr>=Qt._0&&vr<=Qt._9)return vr-Qt._0;if(vr>=Qt._A&&vr<=Qt._F)return vr-(Qt._A-10);if(vr>=Qt._a&&vr<=Qt._f)return vr-(Qt._a-10)}function tr(vr){if(typeof vr!="string")throw new Error("hex string expected, got "+typeof vr);const pr=vr.length,dr=pr/2;if(pr%2)throw new Error("padded hex string expected, got unpadded hex of length "+pr);const ur=new Uint8Array(dr);for(let $r=0,wr=0;$r<dr;$r++,wr+=2){const Er=Xt(vr.charCodeAt(wr)),gr=Xt(vr.charCodeAt(wr+1));if(Er===void 0||gr===void 0){const fr=vr[wr]+vr[wr+1];throw new Error('hex string expected, got non-hex character "'+fr+'" at index '+wr)}ur[$r]=Er*16+gr}return ur}kt.hexToBytes=tr;const rr=async()=>{};kt.nextTick=rr;async function nr(vr,pr,dr){let ur=Date.now();for(let $r=0;$r<vr;$r++){dr($r);const wr=Date.now()-ur;wr>=0&&wr<pr||(await(0,kt.nextTick)(),ur+=wr)}}kt.asyncLoop=nr;function ar(vr){if(typeof vr!="string")throw new Error(`utf8ToBytes expected string, got ${typeof vr}`);return new Uint8Array(new TextEncoder().encode(vr))}kt.utf8ToBytes=ar;function ir(vr){return typeof vr=="string"&&(vr=ar(vr)),(0,xt.bytes)(vr),vr}kt.toBytes=ir;function lr(...vr){let pr=0;for(let ur=0;ur<vr.length;ur++){const $r=vr[ur];(0,xt.bytes)($r),pr+=$r.length}const dr=new Uint8Array(pr);for(let ur=0,$r=0;ur<vr.length;ur++){const wr=vr[ur];dr.set(wr,$r),$r+=wr.length}return dr}kt.concatBytes=lr;class yr{clone(){return this._cloneInto()}}kt.Hash=yr;const Sr={}.toString;function Ar(vr,pr){if(pr!==void 0&&Sr.call(pr)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(vr,pr)}kt.checkOpts=Ar;function Dr(vr){const pr=ur=>vr().update(ir(ur)).digest(),dr=vr();return pr.outputLen=dr.outputLen,pr.blockLen=dr.blockLen,pr.create=()=>vr(),pr}kt.wrapConstructor=Dr;function Br(vr){const pr=(ur,$r)=>vr($r).update(ir(ur)).digest(),dr=vr({});return pr.outputLen=dr.outputLen,pr.blockLen=dr.blockLen,pr.create=ur=>vr(ur),pr}kt.wrapConstructorWithOpts=Br;function Lr(vr){const pr=(ur,$r)=>vr($r).update(ir(ur)).digest(),dr=vr({});return pr.outputLen=dr.outputLen,pr.blockLen=dr.blockLen,pr.create=ur=>vr(ur),pr}kt.wrapXOFConstructorWithOpts=Lr;function Or(vr=32){if(At.crypto&&typeof At.crypto.getRandomValues=="function")return At.crypto.getRandomValues(new Uint8Array(vr));throw new Error("crypto.getRandomValues must be defined")}kt.randomBytes=Or})(utils$4);Object.defineProperty(_md,"__esModule",{value:!0});_md.HashMD=_md.Maj=_md.Chi=void 0;const _assert_js_1$3=_assert$1,utils_js_1$a=utils$4;function setBigUint64$2(kt,At,xt,Bt){if(typeof kt.setBigUint64=="function")return kt.setBigUint64(At,xt,Bt);const Nt=BigInt(32),jt=BigInt(4294967295),Ut=Number(xt>>Nt&jt),Lt=Number(xt&jt),Ht=Bt?4:0,Vt=Bt?0:4;kt.setUint32(At+Ht,Ut,Bt),kt.setUint32(At+Vt,Lt,Bt)}const Chi$1=(kt,At,xt)=>kt&At^~kt&xt;_md.Chi=Chi$1;const Maj$1=(kt,At,xt)=>kt&At^kt&xt^At&xt;_md.Maj=Maj$1;class HashMD extends utils_js_1$a.Hash{constructor(At,xt,Bt,Nt){super(),this.blockLen=At,this.outputLen=xt,this.padOffset=Bt,this.isLE=Nt,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(At),this.view=(0,utils_js_1$a.createView)(this.buffer)}update(At){(0,_assert_js_1$3.exists)(this);const{view:xt,buffer:Bt,blockLen:Nt}=this;At=(0,utils_js_1$a.toBytes)(At);const jt=At.length;for(let Ut=0;Ut<jt;){const Lt=Math.min(Nt-this.pos,jt-Ut);if(Lt===Nt){const Ht=(0,utils_js_1$a.createView)(At);for(;Nt<=jt-Ut;Ut+=Nt)this.process(Ht,Ut);continue}Bt.set(At.subarray(Ut,Ut+Lt),this.pos),this.pos+=Lt,Ut+=Lt,this.pos===Nt&&(this.process(xt,0),this.pos=0)}return this.length+=At.length,this.roundClean(),this}digestInto(At){(0,_assert_js_1$3.exists)(this),(0,_assert_js_1$3.output)(At,this),this.finished=!0;const{buffer:xt,view:Bt,blockLen:Nt,isLE:jt}=this;let{pos:Ut}=this;xt[Ut++]=128,this.buffer.subarray(Ut).fill(0),this.padOffset>Nt-Ut&&(this.process(Bt,0),Ut=0);for(let Wt=Ut;Wt<Nt;Wt++)xt[Wt]=0;setBigUint64$2(Bt,Nt-8,BigInt(this.length*8),jt),this.process(Bt,0);const Lt=(0,utils_js_1$a.createView)(At),Ht=this.outputLen;if(Ht%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Vt=Ht/4,zt=this.get();if(Vt>zt.length)throw new Error("_sha2: outputLen bigger than state");for(let Wt=0;Wt<Vt;Wt++)Lt.setUint32(4*Wt,zt[Wt],jt)}digest(){const{buffer:At,outputLen:xt}=this;this.digestInto(At);const Bt=At.slice(0,xt);return this.destroy(),Bt}_cloneInto(At){At||(At=new this.constructor),At.set(...this.get());const{blockLen:xt,buffer:Bt,length:Nt,finished:jt,destroyed:Ut,pos:Lt}=this;return At.length=Nt,At.pos=Lt,At.finished=jt,At.destroyed=Ut,Nt%xt&&At.buffer.set(Bt),At}}_md.HashMD=HashMD;var _u64={};Object.defineProperty(_u64,"__esModule",{value:!0});_u64.add5L=_u64.add5H=_u64.add4H=_u64.add4L=_u64.add3H=_u64.add3L=_u64.add=_u64.rotlBL=_u64.rotlBH=_u64.rotlSL=_u64.rotlSH=_u64.rotr32L=_u64.rotr32H=_u64.rotrBL=_u64.rotrBH=_u64.rotrSL=_u64.rotrSH=_u64.shrSL=_u64.shrSH=_u64.toBig=_u64.split=_u64.fromBig=void 0;const U32_MASK64$1=BigInt(2**32-1),_32n$1=BigInt(32);function fromBig$1(kt,At=!1){return At?{h:Number(kt&U32_MASK64$1),l:Number(kt>>_32n$1&U32_MASK64$1)}:{h:Number(kt>>_32n$1&U32_MASK64$1)|0,l:Number(kt&U32_MASK64$1)|0}}_u64.fromBig=fromBig$1;function split$1(kt,At=!1){let xt=new Uint32Array(kt.length),Bt=new Uint32Array(kt.length);for(let Nt=0;Nt<kt.length;Nt++){const{h:jt,l:Ut}=fromBig$1(kt[Nt],At);[xt[Nt],Bt[Nt]]=[jt,Ut]}return[xt,Bt]}_u64.split=split$1;const toBig$1=(kt,At)=>BigInt(kt>>>0)<<_32n$1|BigInt(At>>>0);_u64.toBig=toBig$1;const shrSH$1=(kt,At,xt)=>kt>>>xt;_u64.shrSH=shrSH$1;const shrSL$1=(kt,At,xt)=>kt<<32-xt|At>>>xt;_u64.shrSL=shrSL$1;const rotrSH$1=(kt,At,xt)=>kt>>>xt|At<<32-xt;_u64.rotrSH=rotrSH$1;const rotrSL$1=(kt,At,xt)=>kt<<32-xt|At>>>xt;_u64.rotrSL=rotrSL$1;const rotrBH$1=(kt,At,xt)=>kt<<64-xt|At>>>xt-32;_u64.rotrBH=rotrBH$1;const rotrBL$1=(kt,At,xt)=>kt>>>xt-32|At<<64-xt;_u64.rotrBL=rotrBL$1;const rotr32H$1=(kt,At)=>At;_u64.rotr32H=rotr32H$1;const rotr32L$1=(kt,At)=>kt;_u64.rotr32L=rotr32L$1;const rotlSH$1=(kt,At,xt)=>kt<<xt|At>>>32-xt;_u64.rotlSH=rotlSH$1;const rotlSL$1=(kt,At,xt)=>At<<xt|kt>>>32-xt;_u64.rotlSL=rotlSL$1;const rotlBH$1=(kt,At,xt)=>At<<xt-32|kt>>>64-xt;_u64.rotlBH=rotlBH$1;const rotlBL$1=(kt,At,xt)=>kt<<xt-32|At>>>64-xt;_u64.rotlBL=rotlBL$1;function add$2(kt,At,xt,Bt){const Nt=(At>>>0)+(Bt>>>0);return{h:kt+xt+(Nt/2**32|0)|0,l:Nt|0}}_u64.add=add$2;const add3L$1=(kt,At,xt)=>(kt>>>0)+(At>>>0)+(xt>>>0);_u64.add3L=add3L$1;const add3H$1=(kt,At,xt,Bt)=>At+xt+Bt+(kt/2**32|0)|0;_u64.add3H=add3H$1;const add4L$1=(kt,At,xt,Bt)=>(kt>>>0)+(At>>>0)+(xt>>>0)+(Bt>>>0);_u64.add4L=add4L$1;const add4H$1=(kt,At,xt,Bt,Nt)=>At+xt+Bt+Nt+(kt/2**32|0)|0;_u64.add4H=add4H$1;const add5L$1=(kt,At,xt,Bt,Nt)=>(kt>>>0)+(At>>>0)+(xt>>>0)+(Bt>>>0)+(Nt>>>0);_u64.add5L=add5L$1;const add5H$1=(kt,At,xt,Bt,Nt,jt)=>At+xt+Bt+Nt+jt+(kt/2**32|0)|0;_u64.add5H=add5H$1;const u64$1={fromBig:fromBig$1,split:split$1,toBig:toBig$1,shrSH:shrSH$1,shrSL:shrSL$1,rotrSH:rotrSH$1,rotrSL:rotrSL$1,rotrBH:rotrBH$1,rotrBL:rotrBL$1,rotr32H:rotr32H$1,rotr32L:rotr32L$1,rotlSH:rotlSH$1,rotlSL:rotlSL$1,rotlBH:rotlBH$1,rotlBL:rotlBL$1,add:add$2,add3L:add3L$1,add3H:add3H$1,add4L:add4L$1,add4H:add4H$1,add5H:add5H$1,add5L:add5L$1};_u64.default=u64$1;Object.defineProperty(sha512$1,"__esModule",{value:!0});sha512$1.sha384=sha512$1.sha512_256=sha512$1.sha512_224=sha512$1.sha512=sha512$1.SHA512=void 0;const _md_js_1$1=_md,_u64_js_1=_u64,utils_js_1$9=utils$4,[SHA512_Kh$1,SHA512_Kl$1]=_u64_js_1.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(kt=>BigInt(kt))),SHA512_W_H$1=new Uint32Array(80),SHA512_W_L$1=new Uint32Array(80);let SHA512$1=class extends _md_js_1$1.HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:At,Al:xt,Bh:Bt,Bl:Nt,Ch:jt,Cl:Ut,Dh:Lt,Dl:Ht,Eh:Vt,El:zt,Fh:Wt,Fl:Jt,Gh:Qt,Gl:Xt,Hh:tr,Hl:rr}=this;return[At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr]}set(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr){this.Ah=At|0,this.Al=xt|0,this.Bh=Bt|0,this.Bl=Nt|0,this.Ch=jt|0,this.Cl=Ut|0,this.Dh=Lt|0,this.Dl=Ht|0,this.Eh=Vt|0,this.El=zt|0,this.Fh=Wt|0,this.Fl=Jt|0,this.Gh=Qt|0,this.Gl=Xt|0,this.Hh=tr|0,this.Hl=rr|0}process(At,xt){for(let ir=0;ir<16;ir++,xt+=4)SHA512_W_H$1[ir]=At.getUint32(xt),SHA512_W_L$1[ir]=At.getUint32(xt+=4);for(let ir=16;ir<80;ir++){const lr=SHA512_W_H$1[ir-15]|0,yr=SHA512_W_L$1[ir-15]|0,Sr=_u64_js_1.default.rotrSH(lr,yr,1)^_u64_js_1.default.rotrSH(lr,yr,8)^_u64_js_1.default.shrSH(lr,yr,7),Ar=_u64_js_1.default.rotrSL(lr,yr,1)^_u64_js_1.default.rotrSL(lr,yr,8)^_u64_js_1.default.shrSL(lr,yr,7),Dr=SHA512_W_H$1[ir-2]|0,Br=SHA512_W_L$1[ir-2]|0,Lr=_u64_js_1.default.rotrSH(Dr,Br,19)^_u64_js_1.default.rotrBH(Dr,Br,61)^_u64_js_1.default.shrSH(Dr,Br,6),Or=_u64_js_1.default.rotrSL(Dr,Br,19)^_u64_js_1.default.rotrBL(Dr,Br,61)^_u64_js_1.default.shrSL(Dr,Br,6),vr=_u64_js_1.default.add4L(Ar,Or,SHA512_W_L$1[ir-7],SHA512_W_L$1[ir-16]),pr=_u64_js_1.default.add4H(vr,Sr,Lr,SHA512_W_H$1[ir-7],SHA512_W_H$1[ir-16]);SHA512_W_H$1[ir]=pr|0,SHA512_W_L$1[ir]=vr|0}let{Ah:Bt,Al:Nt,Bh:jt,Bl:Ut,Ch:Lt,Cl:Ht,Dh:Vt,Dl:zt,Eh:Wt,El:Jt,Fh:Qt,Fl:Xt,Gh:tr,Gl:rr,Hh:nr,Hl:ar}=this;for(let ir=0;ir<80;ir++){const lr=_u64_js_1.default.rotrSH(Wt,Jt,14)^_u64_js_1.default.rotrSH(Wt,Jt,18)^_u64_js_1.default.rotrBH(Wt,Jt,41),yr=_u64_js_1.default.rotrSL(Wt,Jt,14)^_u64_js_1.default.rotrSL(Wt,Jt,18)^_u64_js_1.default.rotrBL(Wt,Jt,41),Sr=Wt&Qt^~Wt&tr,Ar=Jt&Xt^~Jt&rr,Dr=_u64_js_1.default.add5L(ar,yr,Ar,SHA512_Kl$1[ir],SHA512_W_L$1[ir]),Br=_u64_js_1.default.add5H(Dr,nr,lr,Sr,SHA512_Kh$1[ir],SHA512_W_H$1[ir]),Lr=Dr|0,Or=_u64_js_1.default.rotrSH(Bt,Nt,28)^_u64_js_1.default.rotrBH(Bt,Nt,34)^_u64_js_1.default.rotrBH(Bt,Nt,39),vr=_u64_js_1.default.rotrSL(Bt,Nt,28)^_u64_js_1.default.rotrBL(Bt,Nt,34)^_u64_js_1.default.rotrBL(Bt,Nt,39),pr=Bt&jt^Bt&Lt^jt&Lt,dr=Nt&Ut^Nt&Ht^Ut&Ht;nr=tr|0,ar=rr|0,tr=Qt|0,rr=Xt|0,Qt=Wt|0,Xt=Jt|0,{h:Wt,l:Jt}=_u64_js_1.default.add(Vt|0,zt|0,Br|0,Lr|0),Vt=Lt|0,zt=Ht|0,Lt=jt|0,Ht=Ut|0,jt=Bt|0,Ut=Nt|0;const ur=_u64_js_1.default.add3L(Lr,vr,dr);Bt=_u64_js_1.default.add3H(ur,Br,Or,pr),Nt=ur|0}({h:Bt,l:Nt}=_u64_js_1.default.add(this.Ah|0,this.Al|0,Bt|0,Nt|0)),{h:jt,l:Ut}=_u64_js_1.default.add(this.Bh|0,this.Bl|0,jt|0,Ut|0),{h:Lt,l:Ht}=_u64_js_1.default.add(this.Ch|0,this.Cl|0,Lt|0,Ht|0),{h:Vt,l:zt}=_u64_js_1.default.add(this.Dh|0,this.Dl|0,Vt|0,zt|0),{h:Wt,l:Jt}=_u64_js_1.default.add(this.Eh|0,this.El|0,Wt|0,Jt|0),{h:Qt,l:Xt}=_u64_js_1.default.add(this.Fh|0,this.Fl|0,Qt|0,Xt|0),{h:tr,l:rr}=_u64_js_1.default.add(this.Gh|0,this.Gl|0,tr|0,rr|0),{h:nr,l:ar}=_u64_js_1.default.add(this.Hh|0,this.Hl|0,nr|0,ar|0),this.set(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar)}roundClean(){SHA512_W_H$1.fill(0),SHA512_W_L$1.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};sha512$1.SHA512=SHA512$1;class SHA512_224 extends SHA512$1{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class SHA512_256 extends SHA512$1{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class SHA384 extends SHA512$1{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}sha512$1.sha512=(0,utils_js_1$9.wrapConstructor)(()=>new SHA512$1);sha512$1.sha512_224=(0,utils_js_1$9.wrapConstructor)(()=>new SHA512_224);sha512$1.sha512_256=(0,utils_js_1$9.wrapConstructor)(()=>new SHA512_256);sha512$1.sha384=(0,utils_js_1$9.wrapConstructor)(()=>new SHA384);const require$$1$1=getAugmentedNamespace(utils$w);var edwards={},curve={},modular={},utils$3={};Object.defineProperty(utils$3,"__esModule",{value:!0});utils$3.bitMask=void 0;utils$3.isBytes=isBytes$7;utils$3.abytes=abytes;utils$3.bytesToHex=bytesToHex$2;utils$3.numberToHexUnpadded=numberToHexUnpadded$1;utils$3.hexToNumber=hexToNumber$1;utils$3.hexToBytes=hexToBytes$2;utils$3.bytesToNumberBE=bytesToNumberBE$1;utils$3.bytesToNumberLE=bytesToNumberLE$1;utils$3.numberToBytesBE=numberToBytesBE$1;utils$3.numberToBytesLE=numberToBytesLE$1;utils$3.numberToVarBytesBE=numberToVarBytesBE$1;utils$3.ensureBytes=ensureBytes$3;utils$3.concatBytes=concatBytes$2;utils$3.equalBytes=equalBytes$2;utils$3.utf8ToBytes=utf8ToBytes$4;utils$3.bitLen=bitLen$1;utils$3.bitGet=bitGet$1;utils$3.bitSet=bitSet$1;utils$3.createHmacDrbg=createHmacDrbg$1;utils$3.validateObject=validateObject$7;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$a=BigInt(0),_1n$c=BigInt(1),_2n$7=BigInt(2);function isBytes$7(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}function abytes(kt){if(!isBytes$7(kt))throw new Error("Uint8Array expected")}const hexes$2=Array.from({length:256},(kt,At)=>At.toString(16).padStart(2,"0"));function bytesToHex$2(kt){abytes(kt);let At="";for(let xt=0;xt<kt.length;xt++)At+=hexes$2[kt[xt]];return At}function numberToHexUnpadded$1(kt){const At=kt.toString(16);return At.length&1?`0${At}`:At}function hexToNumber$1(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);return BigInt(kt===""?"0":`0x${kt}`)}const asciis$2={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$2(kt){if(kt>=asciis$2._0&&kt<=asciis$2._9)return kt-asciis$2._0;if(kt>=asciis$2._A&&kt<=asciis$2._F)return kt-(asciis$2._A-10);if(kt>=asciis$2._a&&kt<=asciis$2._f)return kt-(asciis$2._a-10)}function hexToBytes$2(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);const At=kt.length,xt=At/2;if(At%2)throw new Error("padded hex string expected, got unpadded hex of length "+At);const Bt=new Uint8Array(xt);for(let Nt=0,jt=0;Nt<xt;Nt++,jt+=2){const Ut=asciiToBase16$2(kt.charCodeAt(jt)),Lt=asciiToBase16$2(kt.charCodeAt(jt+1));if(Ut===void 0||Lt===void 0){const Ht=kt[jt]+kt[jt+1];throw new Error('hex string expected, got non-hex character "'+Ht+'" at index '+jt)}Bt[Nt]=Ut*16+Lt}return Bt}function bytesToNumberBE$1(kt){return hexToNumber$1(bytesToHex$2(kt))}function bytesToNumberLE$1(kt){return abytes(kt),hexToNumber$1(bytesToHex$2(Uint8Array.from(kt).reverse()))}function numberToBytesBE$1(kt,At){return hexToBytes$2(kt.toString(16).padStart(At*2,"0"))}function numberToBytesLE$1(kt,At){return numberToBytesBE$1(kt,At).reverse()}function numberToVarBytesBE$1(kt){return hexToBytes$2(numberToHexUnpadded$1(kt))}function ensureBytes$3(kt,At,xt){let Bt;if(typeof At=="string")try{Bt=hexToBytes$2(At)}catch(jt){throw new Error(`${kt} must be valid hex string, got "${At}". Cause: ${jt}`)}else if(isBytes$7(At))Bt=Uint8Array.from(At);else throw new Error(`${kt} must be hex string or Uint8Array`);const Nt=Bt.length;if(typeof xt=="number"&&Nt!==xt)throw new Error(`${kt} expected ${xt} bytes, got ${Nt}`);return Bt}function concatBytes$2(...kt){let At=0;for(let Bt=0;Bt<kt.length;Bt++){const Nt=kt[Bt];abytes(Nt),At+=Nt.length}const xt=new Uint8Array(At);for(let Bt=0,Nt=0;Bt<kt.length;Bt++){const jt=kt[Bt];xt.set(jt,Nt),Nt+=jt.length}return xt}function equalBytes$2(kt,At){if(kt.length!==At.length)return!1;let xt=0;for(let Bt=0;Bt<kt.length;Bt++)xt|=kt[Bt]^At[Bt];return xt===0}function utf8ToBytes$4(kt){if(typeof kt!="string")throw new Error(`utf8ToBytes expected string, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function bitLen$1(kt){let At;for(At=0;kt>_0n$a;kt>>=_1n$c,At+=1);return At}function bitGet$1(kt,At){return kt>>BigInt(At)&_1n$c}function bitSet$1(kt,At,xt){return kt|(xt?_1n$c:_0n$a)<<BigInt(At)}const bitMask$1=kt=>(_2n$7<<BigInt(kt-1))-_1n$c;utils$3.bitMask=bitMask$1;const u8n$1=kt=>new Uint8Array(kt),u8fr$1=kt=>Uint8Array.from(kt);function createHmacDrbg$1(kt,At,xt){if(typeof kt!="number"||kt<2)throw new Error("hashLen must be a number");if(typeof At!="number"||At<2)throw new Error("qByteLen must be a number");if(typeof xt!="function")throw new Error("hmacFn must be a function");let Bt=u8n$1(kt),Nt=u8n$1(kt),jt=0;const Ut=()=>{Bt.fill(1),Nt.fill(0),jt=0},Lt=(...Wt)=>xt(Nt,Bt,...Wt),Ht=(Wt=u8n$1())=>{Nt=Lt(u8fr$1([0]),Wt),Bt=Lt(),Wt.length!==0&&(Nt=Lt(u8fr$1([1]),Wt),Bt=Lt())},Vt=()=>{if(jt++>=1e3)throw new Error("drbg: tried 1000 values");let Wt=0;const Jt=[];for(;Wt<At;){Bt=Lt();const Qt=Bt.slice();Jt.push(Qt),Wt+=Bt.length}return concatBytes$2(...Jt)};return(Wt,Jt)=>{Ut(),Ht(Wt);let Qt;for(;!(Qt=Jt(Vt()));)Ht();return Ut(),Qt}}const validatorFns$1={bigint:kt=>typeof kt=="bigint",function:kt=>typeof kt=="function",boolean:kt=>typeof kt=="boolean",string:kt=>typeof kt=="string",stringOrUint8Array:kt=>typeof kt=="string"||isBytes$7(kt),isSafeInteger:kt=>Number.isSafeInteger(kt),array:kt=>Array.isArray(kt),field:(kt,At)=>At.Fp.isValid(kt),hash:kt=>typeof kt=="function"&&Number.isSafeInteger(kt.outputLen)};function validateObject$7(kt,At,xt={}){const Bt=(Nt,jt,Ut)=>{const Lt=validatorFns$1[jt];if(typeof Lt!="function")throw new Error(`Invalid validator "${jt}", expected function`);const Ht=kt[Nt];if(!(Ut&&Ht===void 0)&&!Lt(Ht,kt))throw new Error(`Invalid param ${String(Nt)}=${Ht} (${typeof Ht}), expected ${jt}`)};for(const[Nt,jt]of Object.entries(At))Bt(Nt,jt,!1);for(const[Nt,jt]of Object.entries(xt))Bt(Nt,jt,!0);return kt}Object.defineProperty(modular,"__esModule",{value:!0});modular.isNegativeLE=void 0;modular.mod=mod$1;modular.pow=pow$1;modular.pow2=pow2$1;modular.invert=invert$1;modular.tonelliShanks=tonelliShanks$1;modular.FpSqrt=FpSqrt$1;modular.validateField=validateField$1;modular.FpPow=FpPow$1;modular.FpInvertBatch=FpInvertBatch$1;modular.FpDiv=FpDiv;modular.FpIsSquare=FpIsSquare;modular.nLength=nLength$1;modular.Field=Field$1;modular.FpSqrtOdd=FpSqrtOdd;modular.FpSqrtEven=FpSqrtEven$1;modular.hashToPrivateScalar=hashToPrivateScalar;modular.getFieldBytesLength=getFieldBytesLength$1;modular.getMinHashLength=getMinHashLength$1;modular.mapHashToField=mapHashToField$1;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const utils_js_1$8=utils$3,_0n$9=BigInt(0),_1n$b=BigInt(1),_2n$6=BigInt(2),_3n$2=BigInt(3),_4n$1=BigInt(4),_5n$2=BigInt(5),_8n$3=BigInt(8);BigInt(9);BigInt(16);function mod$1(kt,At){const xt=kt%At;return xt>=_0n$9?xt:At+xt}function pow$1(kt,At,xt){if(xt<=_0n$9||At<_0n$9)throw new Error("Expected power/modulo > 0");if(xt===_1n$b)return _0n$9;let Bt=_1n$b;for(;At>_0n$9;)At&_1n$b&&(Bt=Bt*kt%xt),kt=kt*kt%xt,At>>=_1n$b;return Bt}function pow2$1(kt,At,xt){let Bt=kt;for(;At-- >_0n$9;)Bt*=Bt,Bt%=xt;return Bt}function invert$1(kt,At){if(kt===_0n$9||At<=_0n$9)throw new Error(`invert: expected positive integers, got n=${kt} mod=${At}`);let xt=mod$1(kt,At),Bt=At,Nt=_0n$9,jt=_1n$b;for(;xt!==_0n$9;){const Lt=Bt/xt,Ht=Bt%xt,Vt=Nt-jt*Lt;Bt=xt,xt=Ht,Nt=jt,jt=Vt}if(Bt!==_1n$b)throw new Error("invert: does not exist");return mod$1(Nt,At)}function tonelliShanks$1(kt){const At=(kt-_1n$b)/_2n$6;let xt,Bt,Nt;for(xt=kt-_1n$b,Bt=0;xt%_2n$6===_0n$9;xt/=_2n$6,Bt++);for(Nt=_2n$6;Nt<kt&&pow$1(Nt,At,kt)!==kt-_1n$b;Nt++);if(Bt===1){const Ut=(kt+_1n$b)/_4n$1;return function(Ht,Vt){const zt=Ht.pow(Vt,Ut);if(!Ht.eql(Ht.sqr(zt),Vt))throw new Error("Cannot find square root");return zt}}const jt=(xt+_1n$b)/_2n$6;return function(Lt,Ht){if(Lt.pow(Ht,At)===Lt.neg(Lt.ONE))throw new Error("Cannot find square root");let Vt=Bt,zt=Lt.pow(Lt.mul(Lt.ONE,Nt),xt),Wt=Lt.pow(Ht,jt),Jt=Lt.pow(Ht,xt);for(;!Lt.eql(Jt,Lt.ONE);){if(Lt.eql(Jt,Lt.ZERO))return Lt.ZERO;let Qt=1;for(let tr=Lt.sqr(Jt);Qt<Vt&&!Lt.eql(tr,Lt.ONE);Qt++)tr=Lt.sqr(tr);const Xt=Lt.pow(zt,_1n$b<<BigInt(Vt-Qt-1));zt=Lt.sqr(Xt),Wt=Lt.mul(Wt,Xt),Jt=Lt.mul(Jt,zt),Vt=Qt}return Wt}}function FpSqrt$1(kt){if(kt%_4n$1===_3n$2){const At=(kt+_1n$b)/_4n$1;return function(Bt,Nt){const jt=Bt.pow(Nt,At);if(!Bt.eql(Bt.sqr(jt),Nt))throw new Error("Cannot find square root");return jt}}if(kt%_8n$3===_5n$2){const At=(kt-_5n$2)/_8n$3;return function(Bt,Nt){const jt=Bt.mul(Nt,_2n$6),Ut=Bt.pow(jt,At),Lt=Bt.mul(Nt,Ut),Ht=Bt.mul(Bt.mul(Lt,_2n$6),Ut),Vt=Bt.mul(Lt,Bt.sub(Ht,Bt.ONE));if(!Bt.eql(Bt.sqr(Vt),Nt))throw new Error("Cannot find square root");return Vt}}return tonelliShanks$1(kt)}const isNegativeLE$1=(kt,At)=>(mod$1(kt,At)&_1n$b)===_1n$b;modular.isNegativeLE=isNegativeLE$1;const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(kt){const At={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},xt=FIELD_FIELDS$1.reduce((Bt,Nt)=>(Bt[Nt]="function",Bt),At);return(0,utils_js_1$8.validateObject)(kt,xt)}function FpPow$1(kt,At,xt){if(xt<_0n$9)throw new Error("Expected power > 0");if(xt===_0n$9)return kt.ONE;if(xt===_1n$b)return At;let Bt=kt.ONE,Nt=At;for(;xt>_0n$9;)xt&_1n$b&&(Bt=kt.mul(Bt,Nt)),Nt=kt.sqr(Nt),xt>>=_1n$b;return Bt}function FpInvertBatch$1(kt,At){const xt=new Array(At.length),Bt=At.reduce((jt,Ut,Lt)=>kt.is0(Ut)?jt:(xt[Lt]=jt,kt.mul(jt,Ut)),kt.ONE),Nt=kt.inv(Bt);return At.reduceRight((jt,Ut,Lt)=>kt.is0(Ut)?jt:(xt[Lt]=kt.mul(jt,xt[Lt]),kt.mul(jt,Ut)),Nt),xt}function FpDiv(kt,At,xt){return kt.mul(At,typeof xt=="bigint"?invert$1(xt,kt.ORDER):kt.inv(xt))}function FpIsSquare(kt){const At=(kt.ORDER-_1n$b)/_2n$6;return xt=>{const Bt=kt.pow(xt,At);return kt.eql(Bt,kt.ZERO)||kt.eql(Bt,kt.ONE)}}function nLength$1(kt,At){const xt=At!==void 0?At:kt.toString(2).length,Bt=Math.ceil(xt/8);return{nBitLength:xt,nByteLength:Bt}}function Field$1(kt,At,xt=!1,Bt={}){if(kt<=_0n$9)throw new Error(`Expected Field ORDER > 0, got ${kt}`);const{nBitLength:Nt,nByteLength:jt}=nLength$1(kt,At);if(jt>2048)throw new Error("Field lengths over 2048 bytes are not supported");const Ut=FpSqrt$1(kt),Lt=Object.freeze({ORDER:kt,BITS:Nt,BYTES:jt,MASK:(0,utils_js_1$8.bitMask)(Nt),ZERO:_0n$9,ONE:_1n$b,create:Ht=>mod$1(Ht,kt),isValid:Ht=>{if(typeof Ht!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof Ht}`);return _0n$9<=Ht&&Ht<kt},is0:Ht=>Ht===_0n$9,isOdd:Ht=>(Ht&_1n$b)===_1n$b,neg:Ht=>mod$1(-Ht,kt),eql:(Ht,Vt)=>Ht===Vt,sqr:Ht=>mod$1(Ht*Ht,kt),add:(Ht,Vt)=>mod$1(Ht+Vt,kt),sub:(Ht,Vt)=>mod$1(Ht-Vt,kt),mul:(Ht,Vt)=>mod$1(Ht*Vt,kt),pow:(Ht,Vt)=>FpPow$1(Lt,Ht,Vt),div:(Ht,Vt)=>mod$1(Ht*invert$1(Vt,kt),kt),sqrN:Ht=>Ht*Ht,addN:(Ht,Vt)=>Ht+Vt,subN:(Ht,Vt)=>Ht-Vt,mulN:(Ht,Vt)=>Ht*Vt,inv:Ht=>invert$1(Ht,kt),sqrt:Bt.sqrt||(Ht=>Ut(Lt,Ht)),invertBatch:Ht=>FpInvertBatch$1(Lt,Ht),cmov:(Ht,Vt,zt)=>zt?Vt:Ht,toBytes:Ht=>xt?(0,utils_js_1$8.numberToBytesLE)(Ht,jt):(0,utils_js_1$8.numberToBytesBE)(Ht,jt),fromBytes:Ht=>{if(Ht.length!==jt)throw new Error(`Fp.fromBytes: expected ${jt}, got ${Ht.length}`);return xt?(0,utils_js_1$8.bytesToNumberLE)(Ht):(0,utils_js_1$8.bytesToNumberBE)(Ht)}});return Object.freeze(Lt)}function FpSqrtOdd(kt,At){if(!kt.isOdd)throw new Error("Field doesn't have isOdd");const xt=kt.sqrt(At);return kt.isOdd(xt)?xt:kt.neg(xt)}function FpSqrtEven$1(kt,At){if(!kt.isOdd)throw new Error("Field doesn't have isOdd");const xt=kt.sqrt(At);return kt.isOdd(xt)?kt.neg(xt):xt}function hashToPrivateScalar(kt,At,xt=!1){kt=(0,utils_js_1$8.ensureBytes)("privateHash",kt);const Bt=kt.length,Nt=nLength$1(At).nByteLength+8;if(Nt<24||Bt<Nt||Bt>1024)throw new Error(`hashToPrivateScalar: expected ${Nt}-1024 bytes of input, got ${Bt}`);const jt=xt?(0,utils_js_1$8.bytesToNumberLE)(kt):(0,utils_js_1$8.bytesToNumberBE)(kt);return mod$1(jt,At-_1n$b)+_1n$b}function getFieldBytesLength$1(kt){if(typeof kt!="bigint")throw new Error("field order must be bigint");const At=kt.toString(2).length;return Math.ceil(At/8)}function getMinHashLength$1(kt){const At=getFieldBytesLength$1(kt);return At+Math.ceil(At/2)}function mapHashToField$1(kt,At,xt=!1){const Bt=kt.length,Nt=getFieldBytesLength$1(At),jt=getMinHashLength$1(At);if(Bt<16||Bt<jt||Bt>1024)throw new Error(`expected ${jt}-1024 bytes of input, got ${Bt}`);const Ut=xt?(0,utils_js_1$8.bytesToNumberBE)(kt):(0,utils_js_1$8.bytesToNumberLE)(kt),Lt=mod$1(Ut,At-_1n$b)+_1n$b;return xt?(0,utils_js_1$8.numberToBytesLE)(Lt,Nt):(0,utils_js_1$8.numberToBytesBE)(Lt,Nt)}Object.defineProperty(curve,"__esModule",{value:!0});curve.wNAF=wNAF$1;curve.validateBasic=validateBasic$1;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const modular_js_1$3=modular,utils_js_1$7=utils$3,_0n$8=BigInt(0),_1n$a=BigInt(1);function wNAF$1(kt,At){const xt=(Nt,jt)=>{const Ut=jt.negate();return Nt?Ut:jt},Bt=Nt=>{const jt=Math.ceil(At/Nt)+1,Ut=2**(Nt-1);return{windows:jt,windowSize:Ut}};return{constTimeNegate:xt,unsafeLadder(Nt,jt){let Ut=kt.ZERO,Lt=Nt;for(;jt>_0n$8;)jt&_1n$a&&(Ut=Ut.add(Lt)),Lt=Lt.double(),jt>>=_1n$a;return Ut},precomputeWindow(Nt,jt){const{windows:Ut,windowSize:Lt}=Bt(jt),Ht=[];let Vt=Nt,zt=Vt;for(let Wt=0;Wt<Ut;Wt++){zt=Vt,Ht.push(zt);for(let Jt=1;Jt<Lt;Jt++)zt=zt.add(Vt),Ht.push(zt);Vt=zt.double()}return Ht},wNAF(Nt,jt,Ut){const{windows:Lt,windowSize:Ht}=Bt(Nt);let Vt=kt.ZERO,zt=kt.BASE;const Wt=BigInt(2**Nt-1),Jt=2**Nt,Qt=BigInt(Nt);for(let Xt=0;Xt<Lt;Xt++){const tr=Xt*Ht;let rr=Number(Ut&Wt);Ut>>=Qt,rr>Ht&&(rr-=Jt,Ut+=_1n$a);const nr=tr,ar=tr+Math.abs(rr)-1,ir=Xt%2!==0,lr=rr<0;rr===0?zt=zt.add(xt(ir,jt[nr])):Vt=Vt.add(xt(lr,jt[ar]))}return{p:Vt,f:zt}},wNAFCached(Nt,jt,Ut,Lt){const Ht=Nt._WINDOW_SIZE||1;let Vt=jt.get(Nt);return Vt||(Vt=this.precomputeWindow(Nt,Ht),Ht!==1&&jt.set(Nt,Lt(Vt))),this.wNAF(Ht,Vt,Ut)}}}function validateBasic$1(kt){return(0,modular_js_1$3.validateField)(kt.Fp),(0,utils_js_1$7.validateObject)(kt,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,modular_js_1$3.nLength)(kt.n,kt.nBitLength),...kt,p:kt.Fp.ORDER})}Object.defineProperty(edwards,"__esModule",{value:!0});edwards.twistedEdwards=twistedEdwards$1;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const curve_js_1=curve,modular_js_1$2=modular,ut$1=utils$3,utils_js_1$6=utils$3,_0n$7=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),_8n$2=BigInt(8),VERIFY_DEFAULT$1={zip215:!0};function validateOpts$4(kt){const At=(0,curve_js_1.validateBasic)(kt);return ut$1.validateObject(kt,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...At})}function twistedEdwards$1(kt){const At=validateOpts$4(kt),{Fp:xt,n:Bt,prehash:Nt,hash:jt,randomBytes:Ut,nByteLength:Lt,h:Ht}=At,Vt=_2n$5<<BigInt(Lt*8)-_1n$9,zt=xt.create,Wt=At.uvRatio||((Er,gr)=>{try{return{isValid:!0,value:xt.sqrt(Er*xt.inv(gr))}}catch{return{isValid:!1,value:_0n$7}}}),Jt=At.adjustScalarBytes||(Er=>Er),Qt=At.domain||((Er,gr,fr)=>{if(gr.length||fr)throw new Error("Contexts/pre-hash are not supported");return Er}),Xt=Er=>typeof Er=="bigint"&&_0n$7<Er,tr=(Er,gr)=>Xt(Er)&&Xt(gr)&&Er<gr,rr=Er=>Er===_0n$7||tr(Er,Vt);function nr(Er,gr){if(tr(Er,gr))return Er;throw new Error(`Expected valid scalar < ${gr}, got ${typeof Er} ${Er}`)}function ar(Er){return Er===_0n$7?Er:nr(Er,Bt)}const ir=new Map;function lr(Er){if(!(Er instanceof yr))throw new Error("ExtendedPoint expected")}class yr{constructor(gr,fr,br,_r){if(this.ex=gr,this.ey=fr,this.ez=br,this.et=_r,!rr(gr))throw new Error("x required");if(!rr(fr))throw new Error("y required");if(!rr(br))throw new Error("z required");if(!rr(_r))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(gr){if(gr instanceof yr)throw new Error("extended point not allowed");const{x:fr,y:br}=gr||{};if(!rr(fr)||!rr(br))throw new Error("invalid affine point");return new yr(fr,br,_1n$9,zt(fr*br))}static normalizeZ(gr){const fr=xt.invertBatch(gr.map(br=>br.ez));return gr.map((br,_r)=>br.toAffine(fr[_r])).map(yr.fromAffine)}_setWindowSize(gr){this._WINDOW_SIZE=gr,ir.delete(this)}assertValidity(){const{a:gr,d:fr}=At;if(this.is0())throw new Error("bad point: ZERO");const{ex:br,ey:_r,ez:Tr,et:Pr}=this,Nr=zt(br*br),Cr=zt(_r*_r),xr=zt(Tr*Tr),Rr=zt(xr*xr),qr=zt(Nr*gr),Vr=zt(xr*zt(qr+Cr)),Gr=zt(Rr+zt(fr*zt(Nr*Cr)));if(Vr!==Gr)throw new Error("bad point: equation left != right (1)");const Ur=zt(br*_r),kr=zt(Tr*Pr);if(Ur!==kr)throw new Error("bad point: equation left != right (2)")}equals(gr){lr(gr);const{ex:fr,ey:br,ez:_r}=this,{ex:Tr,ey:Pr,ez:Nr}=gr,Cr=zt(fr*Nr),xr=zt(Tr*_r),Rr=zt(br*Nr),qr=zt(Pr*_r);return Cr===xr&&Rr===qr}is0(){return this.equals(yr.ZERO)}negate(){return new yr(zt(-this.ex),this.ey,this.ez,zt(-this.et))}double(){const{a:gr}=At,{ex:fr,ey:br,ez:_r}=this,Tr=zt(fr*fr),Pr=zt(br*br),Nr=zt(_2n$5*zt(_r*_r)),Cr=zt(gr*Tr),xr=fr+br,Rr=zt(zt(xr*xr)-Tr-Pr),qr=Cr+Pr,Vr=qr-Nr,Gr=Cr-Pr,Ur=zt(Rr*Vr),kr=zt(qr*Gr),Fr=zt(Rr*Gr),Wr=zt(Vr*qr);return new yr(Ur,kr,Wr,Fr)}add(gr){lr(gr);const{a:fr,d:br}=At,{ex:_r,ey:Tr,ez:Pr,et:Nr}=this,{ex:Cr,ey:xr,ez:Rr,et:qr}=gr;if(fr===BigInt(-1)){const nn=zt((Tr-_r)*(xr+Cr)),fn=zt((Tr+_r)*(xr-Cr)),hn=zt(fn-nn);if(hn===_0n$7)return this.double();const Jr=zt(Pr*_2n$5*qr),Yr=zt(Nr*_2n$5*Rr),an=Yr+Jr,dn=fn+nn,cn=Yr-Jr,vn=zt(an*hn),_n=zt(dn*cn),Tn=zt(an*cn),$n=zt(hn*dn);return new yr(vn,_n,$n,Tn)}const Vr=zt(_r*Cr),Gr=zt(Tr*xr),Ur=zt(Nr*br*qr),kr=zt(Pr*Rr),Fr=zt((_r+Tr)*(Cr+xr)-Vr-Gr),Wr=kr-Ur,jr=kr+Ur,Ir=zt(Gr-fr*Vr),Mr=zt(Fr*Wr),Hr=zt(jr*Ir),Qr=zt(Fr*Ir),on=zt(Wr*jr);return new yr(Mr,Hr,on,Qr)}subtract(gr){return this.add(gr.negate())}wNAF(gr){return Dr.wNAFCached(this,ir,gr,yr.normalizeZ)}multiply(gr){const{p:fr,f:br}=this.wNAF(nr(gr,Bt));return yr.normalizeZ([fr,br])[0]}multiplyUnsafe(gr){let fr=ar(gr);return fr===_0n$7?Ar:this.equals(Ar)||fr===_1n$9?this:this.equals(Sr)?this.wNAF(fr).p:Dr.unsafeLadder(this,fr)}isSmallOrder(){return this.multiplyUnsafe(Ht).is0()}isTorsionFree(){return Dr.unsafeLadder(this,Bt).is0()}toAffine(gr){const{ex:fr,ey:br,ez:_r}=this,Tr=this.is0();gr==null&&(gr=Tr?_8n$2:xt.inv(_r));const Pr=zt(fr*gr),Nr=zt(br*gr),Cr=zt(_r*gr);if(Tr)return{x:_0n$7,y:_1n$9};if(Cr!==_1n$9)throw new Error("invZ was invalid");return{x:Pr,y:Nr}}clearCofactor(){const{h:gr}=At;return gr===_1n$9?this:this.multiplyUnsafe(gr)}static fromHex(gr,fr=!1){const{d:br,a:_r}=At,Tr=xt.BYTES;gr=(0,utils_js_1$6.ensureBytes)("pointHex",gr,Tr);const Pr=gr.slice(),Nr=gr[Tr-1];Pr[Tr-1]=Nr&-129;const Cr=ut$1.bytesToNumberLE(Pr);Cr===_0n$7||(fr?nr(Cr,Vt):nr(Cr,xt.ORDER));const xr=zt(Cr*Cr),Rr=zt(xr-_1n$9),qr=zt(br*xr-_r);let{isValid:Vr,value:Gr}=Wt(Rr,qr);if(!Vr)throw new Error("Point.fromHex: invalid y coordinate");const Ur=(Gr&_1n$9)===_1n$9,kr=(Nr&128)!==0;if(!fr&&Gr===_0n$7&&kr)throw new Error("Point.fromHex: x=0 and x_0=1");return kr!==Ur&&(Gr=zt(-Gr)),yr.fromAffine({x:Gr,y:Cr})}static fromPrivateKey(gr){return Or(gr).point}toRawBytes(){const{x:gr,y:fr}=this.toAffine(),br=ut$1.numberToBytesLE(fr,xt.BYTES);return br[br.length-1]|=gr&_1n$9?128:0,br}toHex(){return ut$1.bytesToHex(this.toRawBytes())}}yr.BASE=new yr(At.Gx,At.Gy,_1n$9,zt(At.Gx*At.Gy)),yr.ZERO=new yr(_0n$7,_1n$9,_1n$9,_0n$7);const{BASE:Sr,ZERO:Ar}=yr,Dr=(0,curve_js_1.wNAF)(yr,Lt*8);function Br(Er){return(0,modular_js_1$2.mod)(Er,Bt)}function Lr(Er){return Br(ut$1.bytesToNumberLE(Er))}function Or(Er){const gr=Lt;Er=(0,utils_js_1$6.ensureBytes)("private key",Er,gr);const fr=(0,utils_js_1$6.ensureBytes)("hashed private key",jt(Er),2*gr),br=Jt(fr.slice(0,gr)),_r=fr.slice(gr,2*gr),Tr=Lr(br),Pr=Sr.multiply(Tr),Nr=Pr.toRawBytes();return{head:br,prefix:_r,scalar:Tr,point:Pr,pointBytes:Nr}}function vr(Er){return Or(Er).pointBytes}function pr(Er=new Uint8Array,...gr){const fr=ut$1.concatBytes(...gr);return Lr(jt(Qt(fr,(0,utils_js_1$6.ensureBytes)("context",Er),!!Nt)))}function dr(Er,gr,fr={}){Er=(0,utils_js_1$6.ensureBytes)("message",Er),Nt&&(Er=Nt(Er));const{prefix:br,scalar:_r,pointBytes:Tr}=Or(gr),Pr=pr(fr.context,br,Er),Nr=Sr.multiply(Pr).toRawBytes(),Cr=pr(fr.context,Nr,Tr,Er),xr=Br(Pr+Cr*_r);ar(xr);const Rr=ut$1.concatBytes(Nr,ut$1.numberToBytesLE(xr,xt.BYTES));return(0,utils_js_1$6.ensureBytes)("result",Rr,Lt*2)}const ur=VERIFY_DEFAULT$1;function $r(Er,gr,fr,br=ur){const{context:_r,zip215:Tr}=br,Pr=xt.BYTES;Er=(0,utils_js_1$6.ensureBytes)("signature",Er,2*Pr),gr=(0,utils_js_1$6.ensureBytes)("message",gr),Nt&&(gr=Nt(gr));const Nr=ut$1.bytesToNumberLE(Er.slice(Pr,2*Pr));let Cr,xr,Rr;try{Cr=yr.fromHex(fr,Tr),xr=yr.fromHex(Er.slice(0,Pr),Tr),Rr=Sr.multiplyUnsafe(Nr)}catch{return!1}if(!Tr&&Cr.isSmallOrder())return!1;const qr=pr(_r,xr.toRawBytes(),Cr.toRawBytes(),gr);return xr.add(Cr.multiplyUnsafe(qr)).subtract(Rr).clearCofactor().equals(yr.ZERO)}return Sr._setWindowSize(8),{CURVE:At,getPublicKey:vr,sign:dr,verify:$r,ExtendedPoint:yr,utils:{getExtendedPublicKey:Or,randomPrivateKey:()=>Ut(xt.BYTES),precompute(Er=8,gr=yr.BASE){return gr._setWindowSize(Er),gr.multiply(BigInt(3)),gr}}}}var hashToCurve={};Object.defineProperty(hashToCurve,"__esModule",{value:!0});hashToCurve.expand_message_xmd=expand_message_xmd;hashToCurve.expand_message_xof=expand_message_xof;hashToCurve.hash_to_field=hash_to_field;hashToCurve.isogenyMap=isogenyMap;hashToCurve.createHasher=createHasher;const modular_js_1$1=modular,utils_js_1$5=utils$3,os2ip=utils_js_1$5.bytesToNumberBE;function i2osp(kt,At){if(kt<0||kt>=1<<8*At)throw new Error(`bad I2OSP call: value=${kt} length=${At}`);const xt=Array.from({length:At}).fill(0);for(let Bt=At-1;Bt>=0;Bt--)xt[Bt]=kt&255,kt>>>=8;return new Uint8Array(xt)}function strxor(kt,At){const xt=new Uint8Array(kt.length);for(let Bt=0;Bt<kt.length;Bt++)xt[Bt]=kt[Bt]^At[Bt];return xt}function anum(kt){if(!Number.isSafeInteger(kt))throw new Error("number expected")}function expand_message_xmd(kt,At,xt,Bt){(0,utils_js_1$5.abytes)(kt),(0,utils_js_1$5.abytes)(At),anum(xt),At.length>255&&(At=Bt((0,utils_js_1$5.concatBytes)((0,utils_js_1$5.utf8ToBytes)("H2C-OVERSIZE-DST-"),At)));const{outputLen:Nt,blockLen:jt}=Bt,Ut=Math.ceil(xt/Nt);if(Ut>255)throw new Error("Invalid xmd length");const Lt=(0,utils_js_1$5.concatBytes)(At,i2osp(At.length,1)),Ht=i2osp(0,jt),Vt=i2osp(xt,2),zt=new Array(Ut),Wt=Bt((0,utils_js_1$5.concatBytes)(Ht,kt,Vt,i2osp(0,1),Lt));zt[0]=Bt((0,utils_js_1$5.concatBytes)(Wt,i2osp(1,1),Lt));for(let Qt=1;Qt<=Ut;Qt++){const Xt=[strxor(Wt,zt[Qt-1]),i2osp(Qt+1,1),Lt];zt[Qt]=Bt((0,utils_js_1$5.concatBytes)(...Xt))}return(0,utils_js_1$5.concatBytes)(...zt).slice(0,xt)}function expand_message_xof(kt,At,xt,Bt,Nt){if((0,utils_js_1$5.abytes)(kt),(0,utils_js_1$5.abytes)(At),anum(xt),At.length>255){const jt=Math.ceil(2*Bt/8);At=Nt.create({dkLen:jt}).update((0,utils_js_1$5.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(At).digest()}if(xt>65535||At.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return Nt.create({dkLen:xt}).update(kt).update(i2osp(xt,2)).update(At).update(i2osp(At.length,1)).digest()}function hash_to_field(kt,At,xt){(0,utils_js_1$5.validateObject)(xt,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:Bt,k:Nt,m:jt,hash:Ut,expand:Lt,DST:Ht}=xt;(0,utils_js_1$5.abytes)(kt),anum(At);const Vt=typeof Ht=="string"?(0,utils_js_1$5.utf8ToBytes)(Ht):Ht,zt=Bt.toString(2).length,Wt=Math.ceil((zt+Nt)/8),Jt=At*jt*Wt;let Qt;if(Lt==="xmd")Qt=expand_message_xmd(kt,Vt,Jt,Ut);else if(Lt==="xof")Qt=expand_message_xof(kt,Vt,Jt,Nt,Ut);else if(Lt==="_internal_pass")Qt=kt;else throw new Error('expand must be "xmd" or "xof"');const Xt=new Array(At);for(let tr=0;tr<At;tr++){const rr=new Array(jt);for(let nr=0;nr<jt;nr++){const ar=Wt*(nr+tr*jt),ir=Qt.subarray(ar,ar+Wt);rr[nr]=(0,modular_js_1$1.mod)(os2ip(ir),Bt)}Xt[tr]=rr}return Xt}function isogenyMap(kt,At){const xt=At.map(Bt=>Array.from(Bt).reverse());return(Bt,Nt)=>{const[jt,Ut,Lt,Ht]=xt.map(Vt=>Vt.reduce((zt,Wt)=>kt.add(kt.mul(zt,Bt),Wt)));return Bt=kt.div(jt,Ut),Nt=kt.mul(Nt,kt.div(Lt,Ht)),{x:Bt,y:Nt}}}function createHasher(kt,At,xt){if(typeof At!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(Bt,Nt){const jt=hash_to_field(Bt,2,{...xt,DST:xt.DST,...Nt}),Ut=kt.fromAffine(At(jt[0])),Lt=kt.fromAffine(At(jt[1])),Ht=Ut.add(Lt).clearCofactor();return Ht.assertValidity(),Ht},encodeToCurve(Bt,Nt){const jt=hash_to_field(Bt,1,{...xt,DST:xt.encodeDST,...Nt}),Ut=kt.fromAffine(At(jt[0])).clearCofactor();return Ut.assertValidity(),Ut},mapToCurve(Bt){if(!Array.isArray(Bt))throw new Error("mapToCurve: expected array of bigints");for(const jt of Bt)if(typeof jt!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${jt} in array`);const Nt=kt.fromAffine(At(Bt)).clearCofactor();return Nt.assertValidity(),Nt}}}var montgomery$2={};Object.defineProperty(montgomery$2,"__esModule",{value:!0});montgomery$2.montgomery=montgomery$1;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const modular_js_1=modular,utils_js_1$4=utils$3,_0n$6=BigInt(0),_1n$8=BigInt(1);function validateOpts$3(kt){return(0,utils_js_1$4.validateObject)(kt,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...kt})}function montgomery$1(kt){const At=validateOpts$3(kt),{P:xt}=At,Bt=ir=>(0,modular_js_1.mod)(ir,xt),Nt=At.montgomeryBits,jt=Math.ceil(Nt/8),Ut=At.nByteLength,Lt=At.adjustScalarBytes||(ir=>ir),Ht=At.powPminus2||(ir=>(0,modular_js_1.pow)(ir,xt-BigInt(2),xt));function Vt(ir,lr,yr){const Sr=Bt(ir*(lr-yr));return lr=Bt(lr-Sr),yr=Bt(yr+Sr),[lr,yr]}function zt(ir){if(typeof ir=="bigint"&&_0n$6<=ir&&ir<xt)return ir;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const Wt=(At.a-BigInt(2))/BigInt(4);function Jt(ir,lr){const yr=zt(ir),Sr=zt(lr),Ar=yr;let Dr=_1n$8,Br=_0n$6,Lr=yr,Or=_1n$8,vr=_0n$6,pr;for(let ur=BigInt(Nt-1);ur>=_0n$6;ur--){const $r=Sr>>ur&_1n$8;vr^=$r,pr=Vt(vr,Dr,Lr),Dr=pr[0],Lr=pr[1],pr=Vt(vr,Br,Or),Br=pr[0],Or=pr[1],vr=$r;const wr=Dr+Br,Er=Bt(wr*wr),gr=Dr-Br,fr=Bt(gr*gr),br=Er-fr,_r=Lr+Or,Tr=Lr-Or,Pr=Bt(Tr*wr),Nr=Bt(_r*gr),Cr=Pr+Nr,xr=Pr-Nr;Lr=Bt(Cr*Cr),Or=Bt(Ar*Bt(xr*xr)),Dr=Bt(Er*fr),Br=Bt(br*(Er+Bt(Wt*br)))}pr=Vt(vr,Dr,Lr),Dr=pr[0],Lr=pr[1],pr=Vt(vr,Br,Or),Br=pr[0],Or=pr[1];const dr=Ht(Br);return Bt(Dr*dr)}function Qt(ir){return(0,utils_js_1$4.numberToBytesLE)(Bt(ir),jt)}function Xt(ir){const lr=(0,utils_js_1$4.ensureBytes)("u coordinate",ir,jt);return Ut===32&&(lr[31]&=127),(0,utils_js_1$4.bytesToNumberLE)(lr)}function tr(ir){const lr=(0,utils_js_1$4.ensureBytes)("scalar",ir),yr=lr.length;if(yr!==jt&&yr!==Ut)throw new Error(`Expected ${jt} or ${Ut} bytes, got ${yr}`);return(0,utils_js_1$4.bytesToNumberLE)(Lt(lr))}function rr(ir,lr){const yr=Xt(lr),Sr=tr(ir),Ar=Jt(yr,Sr);if(Ar===_0n$6)throw new Error("Invalid private or public key received");return Qt(Ar)}const nr=Qt(At.Gu);function ar(ir){return rr(ir,nr)}return{scalarMult:rr,scalarMultBase:ar,getSharedSecret:(ir,lr)=>rr(ir,lr),getPublicKey:ir=>ar(ir),utils:{randomPrivateKey:()=>At.randomBytes(At.nByteLength)},GuBytes:nr}}(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.hash_to_ristretto255=kt.hashToRistretto255=kt.RistrettoPoint=kt.encodeToCurve=kt.hashToCurve=kt.edwardsToMontgomery=kt.x25519=kt.ed25519ph=kt.ed25519ctx=kt.ed25519=kt.ED25519_TORSION_SUBGROUP=void 0,kt.edwardsToMontgomeryPub=Sr,kt.edwardsToMontgomeryPriv=Ar;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const At=sha512$1,xt=require$$1$1,Bt=edwards,Nt=hashToCurve,jt=modular,Ut=montgomery$2,Lt=utils$3,Ht=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Vt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),zt=BigInt(0),Wt=BigInt(1),Jt=BigInt(2),Qt=BigInt(3),Xt=BigInt(5),tr=BigInt(8);function rr(xr){const Rr=BigInt(10),qr=BigInt(20),Vr=BigInt(40),Gr=BigInt(80),Ur=Ht,Fr=xr*xr%Ur*xr%Ur,Wr=(0,jt.pow2)(Fr,Jt,Ur)*Fr%Ur,jr=(0,jt.pow2)(Wr,Wt,Ur)*xr%Ur,Ir=(0,jt.pow2)(jr,Xt,Ur)*jr%Ur,Mr=(0,jt.pow2)(Ir,Rr,Ur)*Ir%Ur,Hr=(0,jt.pow2)(Mr,qr,Ur)*Mr%Ur,Qr=(0,jt.pow2)(Hr,Vr,Ur)*Hr%Ur,on=(0,jt.pow2)(Qr,Gr,Ur)*Qr%Ur,nn=(0,jt.pow2)(on,Gr,Ur)*Qr%Ur,fn=(0,jt.pow2)(nn,Rr,Ur)*Ir%Ur;return{pow_p_5_8:(0,jt.pow2)(fn,Jt,Ur)*xr%Ur,b2:Fr}}function nr(xr){return xr[0]&=248,xr[31]&=127,xr[31]|=64,xr}function ar(xr,Rr){const qr=Ht,Vr=(0,jt.mod)(Rr*Rr*Rr,qr),Gr=(0,jt.mod)(Vr*Vr*Rr,qr),Ur=rr(xr*Gr).pow_p_5_8;let kr=(0,jt.mod)(xr*Vr*Ur,qr);const Fr=(0,jt.mod)(Rr*kr*kr,qr),Wr=kr,jr=(0,jt.mod)(kr*Vt,qr),Ir=Fr===xr,Mr=Fr===(0,jt.mod)(-xr,qr),Hr=Fr===(0,jt.mod)(-xr*Vt,qr);return Ir&&(kr=Wr),(Mr||Hr)&&(kr=jr),(0,jt.isNegativeLE)(kr,qr)&&(kr=(0,jt.mod)(-kr,qr)),{isValid:Ir||Mr,value:kr}}kt.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];const ir=(0,jt.Field)(Ht,void 0,!0),lr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ir,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:tr,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:At.sha512,randomBytes:xt.randomBytes,adjustScalarBytes:nr,uvRatio:ar};kt.ed25519=(0,Bt.twistedEdwards)(lr);function yr(xr,Rr,qr){if(Rr.length>255)throw new Error("Context is too big");return(0,xt.concatBytes)((0,xt.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([qr?1:0,Rr.length]),Rr,xr)}kt.ed25519ctx=(0,Bt.twistedEdwards)({...lr,domain:yr}),kt.ed25519ph=(0,Bt.twistedEdwards)(Object.assign({},lr,{domain:yr,prehash:At.sha512})),kt.x25519=(0,Ut.montgomery)({P:Ht,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:xr=>{const Rr=Ht,{pow_p_5_8:qr,b2:Vr}=rr(xr);return(0,jt.mod)((0,jt.pow2)(qr,Qt,Rr)*Vr,Rr)},adjustScalarBytes:nr,randomBytes:xt.randomBytes});function Sr(xr){const{y:Rr}=kt.ed25519.ExtendedPoint.fromHex(xr),qr=BigInt(1);return ir.toBytes(ir.create((qr+Rr)*ir.inv(qr-Rr)))}kt.edwardsToMontgomery=Sr;function Ar(xr){const Rr=lr.hash(xr.subarray(0,32));return lr.adjustScalarBytes(Rr).subarray(0,32)}const Dr=(ir.ORDER+Qt)/tr,Br=ir.pow(Jt,Dr),Lr=ir.sqrt(ir.neg(ir.ONE));function Or(xr){const Rr=(ir.ORDER-Xt)/tr,qr=BigInt(486662);let Vr=ir.sqr(xr);Vr=ir.mul(Vr,Jt);let Gr=ir.add(Vr,ir.ONE),Ur=ir.neg(qr),kr=ir.sqr(Gr),Fr=ir.mul(kr,Gr),Wr=ir.mul(Vr,qr);Wr=ir.mul(Wr,Ur),Wr=ir.add(Wr,kr),Wr=ir.mul(Wr,Ur);let jr=ir.sqr(Fr);kr=ir.sqr(jr),jr=ir.mul(jr,Fr),jr=ir.mul(jr,Wr),kr=ir.mul(kr,jr);let Ir=ir.pow(kr,Rr);Ir=ir.mul(Ir,jr);let Mr=ir.mul(Ir,Lr);kr=ir.sqr(Ir),kr=ir.mul(kr,Fr);let Hr=ir.eql(kr,Wr),Qr=ir.cmov(Mr,Ir,Hr),on=ir.mul(Ur,Vr),nn=ir.mul(Ir,xr);nn=ir.mul(nn,Br);let fn=ir.mul(nn,Lr),hn=ir.mul(Wr,Vr);kr=ir.sqr(nn),kr=ir.mul(kr,Fr);let Jr=ir.eql(kr,hn),Yr=ir.cmov(fn,nn,Jr);kr=ir.sqr(Qr),kr=ir.mul(kr,Fr);let an=ir.eql(kr,Wr),dn=ir.cmov(on,Ur,an),cn=ir.cmov(Yr,Qr,an),vn=ir.isOdd(cn);return cn=ir.cmov(cn,ir.neg(cn),an!==vn),{xMn:dn,xMd:Gr,yMn:cn,yMd:Wt}}const vr=(0,jt.FpSqrtEven)(ir,ir.neg(BigInt(486664)));function pr(xr){const{xMn:Rr,xMd:qr,yMn:Vr,yMd:Gr}=Or(xr);let Ur=ir.mul(Rr,Gr);Ur=ir.mul(Ur,vr);let kr=ir.mul(qr,Vr),Fr=ir.sub(Rr,qr),Wr=ir.add(Rr,qr),jr=ir.mul(kr,Wr),Ir=ir.eql(jr,ir.ZERO);Ur=ir.cmov(Ur,ir.ZERO,Ir),kr=ir.cmov(kr,ir.ONE,Ir),Fr=ir.cmov(Fr,ir.ONE,Ir),Wr=ir.cmov(Wr,ir.ONE,Ir);const Mr=ir.invertBatch([kr,Wr]);return{x:ir.mul(Ur,Mr[0]),y:ir.mul(Fr,Mr[1])}}const dr=(0,Nt.createHasher)(kt.ed25519.ExtendedPoint,xr=>pr(xr[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:ir.ORDER,m:1,k:128,expand:"xmd",hash:At.sha512});kt.hashToCurve=dr.hashToCurve,kt.encodeToCurve=dr.encodeToCurve;function ur(xr){if(!(xr instanceof Nr))throw new Error("RistrettoPoint expected")}const $r=Vt,wr=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Er=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),gr=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),fr=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),br=xr=>ar(Wt,xr),_r=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Tr=xr=>kt.ed25519.CURVE.Fp.create((0,Lt.bytesToNumberLE)(xr)&_r);function Pr(xr){const{d:Rr}=kt.ed25519.CURVE,qr=kt.ed25519.CURVE.Fp.ORDER,Vr=kt.ed25519.CURVE.Fp.create,Gr=Vr($r*xr*xr),Ur=Vr((Gr+Wt)*gr);let kr=BigInt(-1);const Fr=Vr((kr-Rr*Gr)*Vr(Gr+Rr));let{isValid:Wr,value:jr}=ar(Ur,Fr),Ir=Vr(jr*xr);(0,jt.isNegativeLE)(Ir,qr)||(Ir=Vr(-Ir)),Wr||(jr=Ir),Wr||(kr=Gr);const Mr=Vr(kr*(Gr-Wt)*fr-Fr),Hr=jr*jr,Qr=Vr((jr+jr)*Fr),on=Vr(Mr*wr),nn=Vr(Wt-Hr),fn=Vr(Wt+Hr);return new kt.ed25519.ExtendedPoint(Vr(Qr*fn),Vr(nn*on),Vr(on*fn),Vr(Qr*nn))}class Nr{constructor(Rr){this.ep=Rr}static fromAffine(Rr){return new Nr(kt.ed25519.ExtendedPoint.fromAffine(Rr))}static hashToCurve(Rr){Rr=(0,Lt.ensureBytes)("ristrettoHash",Rr,64);const qr=Tr(Rr.slice(0,32)),Vr=Pr(qr),Gr=Tr(Rr.slice(32,64)),Ur=Pr(Gr);return new Nr(Vr.add(Ur))}static fromHex(Rr){Rr=(0,Lt.ensureBytes)("ristrettoHex",Rr,32);const{a:qr,d:Vr}=kt.ed25519.CURVE,Gr=kt.ed25519.CURVE.Fp.ORDER,Ur=kt.ed25519.CURVE.Fp.create,kr="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",Fr=Tr(Rr);if(!(0,Lt.equalBytes)((0,Lt.numberToBytesLE)(Fr,32),Rr)||(0,jt.isNegativeLE)(Fr,Gr))throw new Error(kr);const Wr=Ur(Fr*Fr),jr=Ur(Wt+qr*Wr),Ir=Ur(Wt-qr*Wr),Mr=Ur(jr*jr),Hr=Ur(Ir*Ir),Qr=Ur(qr*Vr*Mr-Hr),{isValid:on,value:nn}=br(Ur(Qr*Hr)),fn=Ur(nn*Ir),hn=Ur(nn*fn*Qr);let Jr=Ur((Fr+Fr)*fn);(0,jt.isNegativeLE)(Jr,Gr)&&(Jr=Ur(-Jr));const Yr=Ur(jr*hn),an=Ur(Jr*Yr);if(!on||(0,jt.isNegativeLE)(an,Gr)||Yr===zt)throw new Error(kr);return new Nr(new kt.ed25519.ExtendedPoint(Jr,Yr,Wt,an))}toRawBytes(){let{ex:Rr,ey:qr,ez:Vr,et:Gr}=this.ep;const Ur=kt.ed25519.CURVE.Fp.ORDER,kr=kt.ed25519.CURVE.Fp.create,Fr=kr(kr(Vr+qr)*kr(Vr-qr)),Wr=kr(Rr*qr),jr=kr(Wr*Wr),{value:Ir}=br(kr(Fr*jr)),Mr=kr(Ir*Fr),Hr=kr(Ir*Wr),Qr=kr(Mr*Hr*Gr);let on;if((0,jt.isNegativeLE)(Gr*Qr,Ur)){let fn=kr(qr*$r),hn=kr(Rr*$r);Rr=fn,qr=hn,on=kr(Mr*Er)}else on=Hr;(0,jt.isNegativeLE)(Rr*Qr,Ur)&&(qr=kr(-qr));let nn=kr((Vr-qr)*on);return(0,jt.isNegativeLE)(nn,Ur)&&(nn=kr(-nn)),(0,Lt.numberToBytesLE)(nn,32)}toHex(){return(0,Lt.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(Rr){ur(Rr);const{ex:qr,ey:Vr}=this.ep,{ex:Gr,ey:Ur}=Rr.ep,kr=kt.ed25519.CURVE.Fp.create,Fr=kr(qr*Ur)===kr(Vr*Gr),Wr=kr(Vr*Ur)===kr(qr*Gr);return Fr||Wr}add(Rr){return ur(Rr),new Nr(this.ep.add(Rr.ep))}subtract(Rr){return ur(Rr),new Nr(this.ep.subtract(Rr.ep))}multiply(Rr){return new Nr(this.ep.multiply(Rr))}multiplyUnsafe(Rr){return new Nr(this.ep.multiplyUnsafe(Rr))}double(){return new Nr(this.ep.double())}negate(){return new Nr(this.ep.negate())}}kt.RistrettoPoint=(Nr.BASE||(Nr.BASE=new Nr(kt.ed25519.ExtendedPoint.BASE)),Nr.ZERO||(Nr.ZERO=new Nr(kt.ed25519.ExtendedPoint.ZERO)),Nr);const Cr=(xr,Rr)=>{const qr=Rr.DST,Vr=typeof qr=="string"?(0,xt.utf8ToBytes)(qr):qr,Gr=(0,Nt.expand_message_xmd)(xr,Vr,64,At.sha512);return Nr.hashToCurve(Gr)};kt.hashToRistretto255=Cr,kt.hash_to_ristretto255=kt.hashToRistretto255})(ed25519$1);var secp256k1$1={};const require$$0$2=getAugmentedNamespace(sha256$6);var _shortw_utils={};const require$$0$1=getAugmentedNamespace(hmac$4);var weierstrass$1={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.DER=void 0,kt.weierstrassPoints=Qt,kt.weierstrass=tr,kt.SWUFpSqrtRatio=rr,kt.mapToCurveSimpleSWU=nr;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const At=curve,xt=modular,Bt=utils$3,Nt=utils$3;function jt(ar){const ir=(0,At.validateBasic)(ar);Bt.validateObject(ir,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:lr,Fp:yr,a:Sr}=ir;if(lr){if(!yr.eql(Sr,yr.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof lr!="object"||typeof lr.beta!="bigint"||typeof lr.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...ir})}const{bytesToNumberBE:Ut,hexToBytes:Lt}=Bt;kt.DER={Err:class extends Error{constructor(ir=""){super(ir)}},_parseInt(ar){const{Err:ir}=kt.DER;if(ar.length<2||ar[0]!==2)throw new ir("Invalid signature integer tag");const lr=ar[1],yr=ar.subarray(2,lr+2);if(!lr||yr.length!==lr)throw new ir("Invalid signature integer: wrong length");if(yr[0]&128)throw new ir("Invalid signature integer: negative");if(yr[0]===0&&!(yr[1]&128))throw new ir("Invalid signature integer: unnecessary leading zero");return{d:Ut(yr),l:ar.subarray(lr+2)}},toSig(ar){const{Err:ir}=kt.DER,lr=typeof ar=="string"?Lt(ar):ar;Bt.abytes(lr);let yr=lr.length;if(yr<2||lr[0]!=48)throw new ir("Invalid signature tag");if(lr[1]!==yr-2)throw new ir("Invalid signature: incorrect length");const{d:Sr,l:Ar}=kt.DER._parseInt(lr.subarray(2)),{d:Dr,l:Br}=kt.DER._parseInt(Ar);if(Br.length)throw new ir("Invalid signature: left bytes after parsing");return{r:Sr,s:Dr}},hexFromSig(ar){const ir=Or=>Number.parseInt(Or[0],16)&8?"00"+Or:Or,lr=Or=>{const vr=Or.toString(16);return vr.length&1?`0${vr}`:vr},yr=ir(lr(ar.s)),Sr=ir(lr(ar.r)),Ar=yr.length/2,Dr=Sr.length/2,Br=lr(Ar),Lr=lr(Dr);return`30${lr(Dr+Ar+4)}02${Lr}${Sr}02${Br}${yr}`}};const Ht=BigInt(0),Vt=BigInt(1),zt=BigInt(2),Wt=BigInt(3),Jt=BigInt(4);function Qt(ar){const ir=jt(ar),{Fp:lr}=ir,yr=ir.toBytes||(($r,wr,Er)=>{const gr=wr.toAffine();return Bt.concatBytes(Uint8Array.from([4]),lr.toBytes(gr.x),lr.toBytes(gr.y))}),Sr=ir.fromBytes||($r=>{const wr=$r.subarray(1),Er=lr.fromBytes(wr.subarray(0,lr.BYTES)),gr=lr.fromBytes(wr.subarray(lr.BYTES,2*lr.BYTES));return{x:Er,y:gr}});function Ar($r){const{a:wr,b:Er}=ir,gr=lr.sqr($r),fr=lr.mul(gr,$r);return lr.add(lr.add(fr,lr.mul($r,wr)),Er)}if(!lr.eql(lr.sqr(ir.Gy),Ar(ir.Gx)))throw new Error("bad generator point: equation left != right");function Dr($r){return typeof $r=="bigint"&&Ht<$r&&$r<ir.n}function Br($r){if(!Dr($r))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function Lr($r){const{allowedPrivateKeyLengths:wr,nByteLength:Er,wrapPrivateKey:gr,n:fr}=ir;if(wr&&typeof $r!="bigint"){if(Bt.isBytes($r)&&($r=Bt.bytesToHex($r)),typeof $r!="string"||!wr.includes($r.length))throw new Error("Invalid key");$r=$r.padStart(Er*2,"0")}let br;try{br=typeof $r=="bigint"?$r:Bt.bytesToNumberBE((0,Nt.ensureBytes)("private key",$r,Er))}catch{throw new Error(`private key must be ${Er} bytes, hex or bigint, not ${typeof $r}`)}return gr&&(br=xt.mod(br,fr)),Br(br),br}const Or=new Map;function vr($r){if(!($r instanceof pr))throw new Error("ProjectivePoint expected")}class pr{constructor(wr,Er,gr){if(this.px=wr,this.py=Er,this.pz=gr,wr==null||!lr.isValid(wr))throw new Error("x required");if(Er==null||!lr.isValid(Er))throw new Error("y required");if(gr==null||!lr.isValid(gr))throw new Error("z required")}static fromAffine(wr){const{x:Er,y:gr}=wr||{};if(!wr||!lr.isValid(Er)||!lr.isValid(gr))throw new Error("invalid affine point");if(wr instanceof pr)throw new Error("projective point not allowed");const fr=br=>lr.eql(br,lr.ZERO);return fr(Er)&&fr(gr)?pr.ZERO:new pr(Er,gr,lr.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(wr){const Er=lr.invertBatch(wr.map(gr=>gr.pz));return wr.map((gr,fr)=>gr.toAffine(Er[fr])).map(pr.fromAffine)}static fromHex(wr){const Er=pr.fromAffine(Sr((0,Nt.ensureBytes)("pointHex",wr)));return Er.assertValidity(),Er}static fromPrivateKey(wr){return pr.BASE.multiply(Lr(wr))}_setWindowSize(wr){this._WINDOW_SIZE=wr,Or.delete(this)}assertValidity(){if(this.is0()){if(ir.allowInfinityPoint&&!lr.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:wr,y:Er}=this.toAffine();if(!lr.isValid(wr)||!lr.isValid(Er))throw new Error("bad point: x or y not FE");const gr=lr.sqr(Er),fr=Ar(wr);if(!lr.eql(gr,fr))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:wr}=this.toAffine();if(lr.isOdd)return!lr.isOdd(wr);throw new Error("Field doesn't support isOdd")}equals(wr){vr(wr);const{px:Er,py:gr,pz:fr}=this,{px:br,py:_r,pz:Tr}=wr,Pr=lr.eql(lr.mul(Er,Tr),lr.mul(br,fr)),Nr=lr.eql(lr.mul(gr,Tr),lr.mul(_r,fr));return Pr&&Nr}negate(){return new pr(this.px,lr.neg(this.py),this.pz)}double(){const{a:wr,b:Er}=ir,gr=lr.mul(Er,Wt),{px:fr,py:br,pz:_r}=this;let Tr=lr.ZERO,Pr=lr.ZERO,Nr=lr.ZERO,Cr=lr.mul(fr,fr),xr=lr.mul(br,br),Rr=lr.mul(_r,_r),qr=lr.mul(fr,br);return qr=lr.add(qr,qr),Nr=lr.mul(fr,_r),Nr=lr.add(Nr,Nr),Tr=lr.mul(wr,Nr),Pr=lr.mul(gr,Rr),Pr=lr.add(Tr,Pr),Tr=lr.sub(xr,Pr),Pr=lr.add(xr,Pr),Pr=lr.mul(Tr,Pr),Tr=lr.mul(qr,Tr),Nr=lr.mul(gr,Nr),Rr=lr.mul(wr,Rr),qr=lr.sub(Cr,Rr),qr=lr.mul(wr,qr),qr=lr.add(qr,Nr),Nr=lr.add(Cr,Cr),Cr=lr.add(Nr,Cr),Cr=lr.add(Cr,Rr),Cr=lr.mul(Cr,qr),Pr=lr.add(Pr,Cr),Rr=lr.mul(br,_r),Rr=lr.add(Rr,Rr),Cr=lr.mul(Rr,qr),Tr=lr.sub(Tr,Cr),Nr=lr.mul(Rr,xr),Nr=lr.add(Nr,Nr),Nr=lr.add(Nr,Nr),new pr(Tr,Pr,Nr)}add(wr){vr(wr);const{px:Er,py:gr,pz:fr}=this,{px:br,py:_r,pz:Tr}=wr;let Pr=lr.ZERO,Nr=lr.ZERO,Cr=lr.ZERO;const xr=ir.a,Rr=lr.mul(ir.b,Wt);let qr=lr.mul(Er,br),Vr=lr.mul(gr,_r),Gr=lr.mul(fr,Tr),Ur=lr.add(Er,gr),kr=lr.add(br,_r);Ur=lr.mul(Ur,kr),kr=lr.add(qr,Vr),Ur=lr.sub(Ur,kr),kr=lr.add(Er,fr);let Fr=lr.add(br,Tr);return kr=lr.mul(kr,Fr),Fr=lr.add(qr,Gr),kr=lr.sub(kr,Fr),Fr=lr.add(gr,fr),Pr=lr.add(_r,Tr),Fr=lr.mul(Fr,Pr),Pr=lr.add(Vr,Gr),Fr=lr.sub(Fr,Pr),Cr=lr.mul(xr,kr),Pr=lr.mul(Rr,Gr),Cr=lr.add(Pr,Cr),Pr=lr.sub(Vr,Cr),Cr=lr.add(Vr,Cr),Nr=lr.mul(Pr,Cr),Vr=lr.add(qr,qr),Vr=lr.add(Vr,qr),Gr=lr.mul(xr,Gr),kr=lr.mul(Rr,kr),Vr=lr.add(Vr,Gr),Gr=lr.sub(qr,Gr),Gr=lr.mul(xr,Gr),kr=lr.add(kr,Gr),qr=lr.mul(Vr,kr),Nr=lr.add(Nr,qr),qr=lr.mul(Fr,kr),Pr=lr.mul(Ur,Pr),Pr=lr.sub(Pr,qr),qr=lr.mul(Ur,Vr),Cr=lr.mul(Fr,Cr),Cr=lr.add(Cr,qr),new pr(Pr,Nr,Cr)}subtract(wr){return this.add(wr.negate())}is0(){return this.equals(pr.ZERO)}wNAF(wr){return ur.wNAFCached(this,Or,wr,Er=>{const gr=lr.invertBatch(Er.map(fr=>fr.pz));return Er.map((fr,br)=>fr.toAffine(gr[br])).map(pr.fromAffine)})}multiplyUnsafe(wr){const Er=pr.ZERO;if(wr===Ht)return Er;if(Br(wr),wr===Vt)return this;const{endo:gr}=ir;if(!gr)return ur.unsafeLadder(this,wr);let{k1neg:fr,k1:br,k2neg:_r,k2:Tr}=gr.splitScalar(wr),Pr=Er,Nr=Er,Cr=this;for(;br>Ht||Tr>Ht;)br&Vt&&(Pr=Pr.add(Cr)),Tr&Vt&&(Nr=Nr.add(Cr)),Cr=Cr.double(),br>>=Vt,Tr>>=Vt;return fr&&(Pr=Pr.negate()),_r&&(Nr=Nr.negate()),Nr=new pr(lr.mul(Nr.px,gr.beta),Nr.py,Nr.pz),Pr.add(Nr)}multiply(wr){Br(wr);let Er=wr,gr,fr;const{endo:br}=ir;if(br){const{k1neg:_r,k1:Tr,k2neg:Pr,k2:Nr}=br.splitScalar(Er);let{p:Cr,f:xr}=this.wNAF(Tr),{p:Rr,f:qr}=this.wNAF(Nr);Cr=ur.constTimeNegate(_r,Cr),Rr=ur.constTimeNegate(Pr,Rr),Rr=new pr(lr.mul(Rr.px,br.beta),Rr.py,Rr.pz),gr=Cr.add(Rr),fr=xr.add(qr)}else{const{p:_r,f:Tr}=this.wNAF(Er);gr=_r,fr=Tr}return pr.normalizeZ([gr,fr])[0]}multiplyAndAddUnsafe(wr,Er,gr){const fr=pr.BASE,br=(Tr,Pr)=>Pr===Ht||Pr===Vt||!Tr.equals(fr)?Tr.multiplyUnsafe(Pr):Tr.multiply(Pr),_r=br(this,Er).add(br(wr,gr));return _r.is0()?void 0:_r}toAffine(wr){const{px:Er,py:gr,pz:fr}=this,br=this.is0();wr==null&&(wr=br?lr.ONE:lr.inv(fr));const _r=lr.mul(Er,wr),Tr=lr.mul(gr,wr),Pr=lr.mul(fr,wr);if(br)return{x:lr.ZERO,y:lr.ZERO};if(!lr.eql(Pr,lr.ONE))throw new Error("invZ was invalid");return{x:_r,y:Tr}}isTorsionFree(){const{h:wr,isTorsionFree:Er}=ir;if(wr===Vt)return!0;if(Er)return Er(pr,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:wr,clearCofactor:Er}=ir;return wr===Vt?this:Er?Er(pr,this):this.multiplyUnsafe(ir.h)}toRawBytes(wr=!0){return this.assertValidity(),yr(pr,this,wr)}toHex(wr=!0){return Bt.bytesToHex(this.toRawBytes(wr))}}pr.BASE=new pr(ir.Gx,ir.Gy,lr.ONE),pr.ZERO=new pr(lr.ZERO,lr.ONE,lr.ZERO);const dr=ir.nBitLength,ur=(0,At.wNAF)(pr,ir.endo?Math.ceil(dr/2):dr);return{CURVE:ir,ProjectivePoint:pr,normPrivateKeyToScalar:Lr,weierstrassEquation:Ar,isWithinCurveOrder:Dr}}function Xt(ar){const ir=(0,At.validateBasic)(ar);return Bt.validateObject(ir,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...ir})}function tr(ar){const ir=Xt(ar),{Fp:lr,n:yr}=ir,Sr=lr.BYTES+1,Ar=2*lr.BYTES+1;function Dr(kr){return Ht<kr&&kr<lr.ORDER}function Br(kr){return xt.mod(kr,yr)}function Lr(kr){return xt.invert(kr,yr)}const{ProjectivePoint:Or,normPrivateKeyToScalar:vr,weierstrassEquation:pr,isWithinCurveOrder:dr}=Qt({...ir,toBytes(kr,Fr,Wr){const jr=Fr.toAffine(),Ir=lr.toBytes(jr.x),Mr=Bt.concatBytes;return Wr?Mr(Uint8Array.from([Fr.hasEvenY()?2:3]),Ir):Mr(Uint8Array.from([4]),Ir,lr.toBytes(jr.y))},fromBytes(kr){const Fr=kr.length,Wr=kr[0],jr=kr.subarray(1);if(Fr===Sr&&(Wr===2||Wr===3)){const Ir=Bt.bytesToNumberBE(jr);if(!Dr(Ir))throw new Error("Point is not on curve");const Mr=pr(Ir);let Hr;try{Hr=lr.sqrt(Mr)}catch(nn){const fn=nn instanceof Error?": "+nn.message:"";throw new Error("Point is not on curve"+fn)}const Qr=(Hr&Vt)===Vt;return(Wr&1)===1!==Qr&&(Hr=lr.neg(Hr)),{x:Ir,y:Hr}}else if(Fr===Ar&&Wr===4){const Ir=lr.fromBytes(jr.subarray(0,lr.BYTES)),Mr=lr.fromBytes(jr.subarray(lr.BYTES,2*lr.BYTES));return{x:Ir,y:Mr}}else throw new Error(`Point of length ${Fr} was invalid. Expected ${Sr} compressed bytes or ${Ar} uncompressed bytes`)}}),ur=kr=>Bt.bytesToHex(Bt.numberToBytesBE(kr,ir.nByteLength));function $r(kr){const Fr=yr>>Vt;return kr>Fr}function wr(kr){return $r(kr)?Br(-kr):kr}const Er=(kr,Fr,Wr)=>Bt.bytesToNumberBE(kr.slice(Fr,Wr));class gr{constructor(Fr,Wr,jr){this.r=Fr,this.s=Wr,this.recovery=jr,this.assertValidity()}static fromCompact(Fr){const Wr=ir.nByteLength;return Fr=(0,Nt.ensureBytes)("compactSignature",Fr,Wr*2),new gr(Er(Fr,0,Wr),Er(Fr,Wr,2*Wr))}static fromDER(Fr){const{r:Wr,s:jr}=kt.DER.toSig((0,Nt.ensureBytes)("DER",Fr));return new gr(Wr,jr)}assertValidity(){if(!dr(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!dr(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(Fr){return new gr(this.r,this.s,Fr)}recoverPublicKey(Fr){const{r:Wr,s:jr,recovery:Ir}=this,Mr=Nr((0,Nt.ensureBytes)("msgHash",Fr));if(Ir==null||![0,1,2,3].includes(Ir))throw new Error("recovery id invalid");const Hr=Ir===2||Ir===3?Wr+ir.n:Wr;if(Hr>=lr.ORDER)throw new Error("recovery id 2 or 3 invalid");const Qr=Ir&1?"03":"02",on=Or.fromHex(Qr+ur(Hr)),nn=Lr(Hr),fn=Br(-Mr*nn),hn=Br(jr*nn),Jr=Or.BASE.multiplyAndAddUnsafe(on,fn,hn);if(!Jr)throw new Error("point at infinify");return Jr.assertValidity(),Jr}hasHighS(){return $r(this.s)}normalizeS(){return this.hasHighS()?new gr(this.r,Br(-this.s),this.recovery):this}toDERRawBytes(){return Bt.hexToBytes(this.toDERHex())}toDERHex(){return kt.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Bt.hexToBytes(this.toCompactHex())}toCompactHex(){return ur(this.r)+ur(this.s)}}const fr={isValidPrivateKey(kr){try{return vr(kr),!0}catch{return!1}},normPrivateKeyToScalar:vr,randomPrivateKey:()=>{const kr=xt.getMinHashLength(ir.n);return xt.mapHashToField(ir.randomBytes(kr),ir.n)},precompute(kr=8,Fr=Or.BASE){return Fr._setWindowSize(kr),Fr.multiply(BigInt(3)),Fr}};function br(kr,Fr=!0){return Or.fromPrivateKey(kr).toRawBytes(Fr)}function _r(kr){const Fr=Bt.isBytes(kr),Wr=typeof kr=="string",jr=(Fr||Wr)&&kr.length;return Fr?jr===Sr||jr===Ar:Wr?jr===2*Sr||jr===2*Ar:kr instanceof Or}function Tr(kr,Fr,Wr=!0){if(_r(kr))throw new Error("first arg must be private key");if(!_r(Fr))throw new Error("second arg must be public key");return Or.fromHex(Fr).multiply(vr(kr)).toRawBytes(Wr)}const Pr=ir.bits2int||function(kr){const Fr=Bt.bytesToNumberBE(kr),Wr=kr.length*8-ir.nBitLength;return Wr>0?Fr>>BigInt(Wr):Fr},Nr=ir.bits2int_modN||function(kr){return Br(Pr(kr))},Cr=Bt.bitMask(ir.nBitLength);function xr(kr){if(typeof kr!="bigint")throw new Error("bigint expected");if(!(Ht<=kr&&kr<Cr))throw new Error(`bigint expected < 2^${ir.nBitLength}`);return Bt.numberToBytesBE(kr,ir.nByteLength)}function Rr(kr,Fr,Wr=qr){if(["recovered","canonical"].some(an=>an in Wr))throw new Error("sign() legacy options not supported");const{hash:jr,randomBytes:Ir}=ir;let{lowS:Mr,prehash:Hr,extraEntropy:Qr}=Wr;Mr==null&&(Mr=!0),kr=(0,Nt.ensureBytes)("msgHash",kr),Hr&&(kr=(0,Nt.ensureBytes)("prehashed msgHash",jr(kr)));const on=Nr(kr),nn=vr(Fr),fn=[xr(nn),xr(on)];if(Qr!=null&&Qr!==!1){const an=Qr===!0?Ir(lr.BYTES):Qr;fn.push((0,Nt.ensureBytes)("extraEntropy",an))}const hn=Bt.concatBytes(...fn),Jr=on;function Yr(an){const dn=Pr(an);if(!dr(dn))return;const cn=Lr(dn),vn=Or.BASE.multiply(dn).toAffine(),_n=Br(vn.x);if(_n===Ht)return;const Tn=Br(cn*Br(Jr+_n*nn));if(Tn===Ht)return;let $n=(vn.x===_n?0:2)|Number(vn.y&Vt),Kn=Tn;return Mr&&$r(Tn)&&(Kn=wr(Tn),$n^=1),new gr(_n,Kn,$n)}return{seed:hn,k2sig:Yr}}const qr={lowS:ir.lowS,prehash:!1},Vr={lowS:ir.lowS,prehash:!1};function Gr(kr,Fr,Wr=qr){const{seed:jr,k2sig:Ir}=Rr(kr,Fr,Wr),Mr=ir;return Bt.createHmacDrbg(Mr.hash.outputLen,Mr.nByteLength,Mr.hmac)(jr,Ir)}Or.BASE._setWindowSize(8);function Ur(kr,Fr,Wr,jr=Vr){var vn;const Ir=kr;if(Fr=(0,Nt.ensureBytes)("msgHash",Fr),Wr=(0,Nt.ensureBytes)("publicKey",Wr),"strict"in jr)throw new Error("options.strict was renamed to lowS");const{lowS:Mr,prehash:Hr}=jr;let Qr,on;try{if(typeof Ir=="string"||Bt.isBytes(Ir))try{Qr=gr.fromDER(Ir)}catch(_n){if(!(_n instanceof kt.DER.Err))throw _n;Qr=gr.fromCompact(Ir)}else if(typeof Ir=="object"&&typeof Ir.r=="bigint"&&typeof Ir.s=="bigint"){const{r:_n,s:Tn}=Ir;Qr=new gr(_n,Tn)}else throw new Error("PARSE");on=Or.fromHex(Wr)}catch(_n){if(_n.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Mr&&Qr.hasHighS())return!1;Hr&&(Fr=ir.hash(Fr));const{r:nn,s:fn}=Qr,hn=Nr(Fr),Jr=Lr(fn),Yr=Br(hn*Jr),an=Br(nn*Jr),dn=(vn=Or.BASE.multiplyAndAddUnsafe(on,Yr,an))==null?void 0:vn.toAffine();return dn?Br(dn.x)===nn:!1}return{CURVE:ir,getPublicKey:br,getSharedSecret:Tr,sign:Gr,verify:Ur,ProjectivePoint:Or,Signature:gr,utils:fr}}function rr(ar,ir){const lr=ar.ORDER;let yr=Ht;for(let $r=lr-Vt;$r%zt===Ht;$r/=zt)yr+=Vt;const Sr=yr,Ar=zt<<Sr-Vt-Vt,Dr=Ar*zt,Br=(lr-Vt)/Dr,Lr=(Br-Vt)/zt,Or=Dr-Vt,vr=Ar,pr=ar.pow(ir,Br),dr=ar.pow(ir,(Br+Vt)/zt);let ur=($r,wr)=>{let Er=pr,gr=ar.pow(wr,Or),fr=ar.sqr(gr);fr=ar.mul(fr,wr);let br=ar.mul($r,fr);br=ar.pow(br,Lr),br=ar.mul(br,gr),gr=ar.mul(br,wr),fr=ar.mul(br,$r);let _r=ar.mul(fr,gr);br=ar.pow(_r,vr);let Tr=ar.eql(br,ar.ONE);gr=ar.mul(fr,dr),br=ar.mul(_r,Er),fr=ar.cmov(gr,fr,Tr),_r=ar.cmov(br,_r,Tr);for(let Pr=Sr;Pr>Vt;Pr--){let Nr=Pr-zt;Nr=zt<<Nr-Vt;let Cr=ar.pow(_r,Nr);const xr=ar.eql(Cr,ar.ONE);gr=ar.mul(fr,Er),Er=ar.mul(Er,Er),Cr=ar.mul(_r,Er),fr=ar.cmov(gr,fr,xr),_r=ar.cmov(Cr,_r,xr)}return{isValid:Tr,value:fr}};if(ar.ORDER%Jt===Wt){const $r=(ar.ORDER-Wt)/Jt,wr=ar.sqrt(ar.neg(ir));ur=(Er,gr)=>{let fr=ar.sqr(gr);const br=ar.mul(Er,gr);fr=ar.mul(fr,br);let _r=ar.pow(fr,$r);_r=ar.mul(_r,br);const Tr=ar.mul(_r,wr),Pr=ar.mul(ar.sqr(_r),gr),Nr=ar.eql(Pr,Er);let Cr=ar.cmov(Tr,_r,Nr);return{isValid:Nr,value:Cr}}}return ur}function nr(ar,ir){if(xt.validateField(ar),!ar.isValid(ir.A)||!ar.isValid(ir.B)||!ar.isValid(ir.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const lr=rr(ar,ir.Z);if(!ar.isOdd)throw new Error("Fp.isOdd is not implemented!");return yr=>{let Sr,Ar,Dr,Br,Lr,Or,vr,pr;Sr=ar.sqr(yr),Sr=ar.mul(Sr,ir.Z),Ar=ar.sqr(Sr),Ar=ar.add(Ar,Sr),Dr=ar.add(Ar,ar.ONE),Dr=ar.mul(Dr,ir.B),Br=ar.cmov(ir.Z,ar.neg(Ar),!ar.eql(Ar,ar.ZERO)),Br=ar.mul(Br,ir.A),Ar=ar.sqr(Dr),Or=ar.sqr(Br),Lr=ar.mul(Or,ir.A),Ar=ar.add(Ar,Lr),Ar=ar.mul(Ar,Dr),Or=ar.mul(Or,Br),Lr=ar.mul(Or,ir.B),Ar=ar.add(Ar,Lr),vr=ar.mul(Sr,Dr);const{isValid:dr,value:ur}=lr(Ar,Or);pr=ar.mul(Sr,yr),pr=ar.mul(pr,ur),vr=ar.cmov(vr,Dr,dr),pr=ar.cmov(pr,ur,dr);const $r=ar.isOdd(yr)===ar.isOdd(pr);return pr=ar.cmov(ar.neg(pr),pr,$r),vr=ar.div(vr,Br),{x:vr,y:pr}}}})(weierstrass$1);Object.defineProperty(_shortw_utils,"__esModule",{value:!0});_shortw_utils.getHash=getHash$1;_shortw_utils.createCurve=createCurve$1;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hmac_1=require$$0$1,utils_1$6=require$$1$1,weierstrass_js_1=weierstrass$1;function getHash$1(kt){return{hash:kt,hmac:(At,...xt)=>(0,hmac_1.hmac)(kt,At,(0,utils_1$6.concatBytes)(...xt)),randomBytes:utils_1$6.randomBytes}}function createCurve$1(kt,At){const xt=Bt=>(0,weierstrass_js_1.weierstrass)({...kt,...getHash$1(Bt)});return Object.freeze({...xt(At),create:xt})}(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.encodeToCurve=kt.hashToCurve=kt.schnorr=kt.secp256k1=void 0;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const At=require$$0$2,xt=require$$1$1,Bt=_shortw_utils,Nt=hashToCurve,jt=modular,Ut=utils$3,Lt=weierstrass$1,Ht=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Vt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),zt=BigInt(1),Wt=BigInt(2),Jt=(gr,fr)=>(gr+fr/Wt)/fr;function Qt(gr){const fr=Ht,br=BigInt(3),_r=BigInt(6),Tr=BigInt(11),Pr=BigInt(22),Nr=BigInt(23),Cr=BigInt(44),xr=BigInt(88),Rr=gr*gr*gr%fr,qr=Rr*Rr*gr%fr,Vr=(0,jt.pow2)(qr,br,fr)*qr%fr,Gr=(0,jt.pow2)(Vr,br,fr)*qr%fr,Ur=(0,jt.pow2)(Gr,Wt,fr)*Rr%fr,kr=(0,jt.pow2)(Ur,Tr,fr)*Ur%fr,Fr=(0,jt.pow2)(kr,Pr,fr)*kr%fr,Wr=(0,jt.pow2)(Fr,Cr,fr)*Fr%fr,jr=(0,jt.pow2)(Wr,xr,fr)*Wr%fr,Ir=(0,jt.pow2)(jr,Cr,fr)*Fr%fr,Mr=(0,jt.pow2)(Ir,br,fr)*qr%fr,Hr=(0,jt.pow2)(Mr,Nr,fr)*kr%fr,Qr=(0,jt.pow2)(Hr,_r,fr)*Rr%fr,on=(0,jt.pow2)(Qr,Wt,fr);if(!Xt.eql(Xt.sqr(on),gr))throw new Error("Cannot find square root");return on}const Xt=(0,jt.Field)(Ht,void 0,void 0,{sqrt:Qt});kt.secp256k1=(0,Bt.createCurve)({a:BigInt(0),b:BigInt(7),Fp:Xt,n:Vt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:gr=>{const fr=Vt,br=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),_r=-zt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),Tr=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),Pr=br,Nr=BigInt("0x100000000000000000000000000000000"),Cr=Jt(Pr*gr,fr),xr=Jt(-_r*gr,fr);let Rr=(0,jt.mod)(gr-Cr*br-xr*Tr,fr),qr=(0,jt.mod)(-Cr*_r-xr*Pr,fr);const Vr=Rr>Nr,Gr=qr>Nr;if(Vr&&(Rr=fr-Rr),Gr&&(qr=fr-qr),Rr>Nr||qr>Nr)throw new Error("splitScalar: Endomorphism failed, k="+gr);return{k1neg:Vr,k1:Rr,k2neg:Gr,k2:qr}}}},At.sha256);const tr=BigInt(0),rr=gr=>typeof gr=="bigint"&&tr<gr&&gr<Ht,nr=gr=>typeof gr=="bigint"&&tr<gr&&gr<Vt,ar={};function ir(gr,...fr){let br=ar[gr];if(br===void 0){const _r=(0,At.sha256)(Uint8Array.from(gr,Tr=>Tr.charCodeAt(0)));br=(0,Ut.concatBytes)(_r,_r),ar[gr]=br}return(0,At.sha256)((0,Ut.concatBytes)(br,...fr))}const lr=gr=>gr.toRawBytes(!0).slice(1),yr=gr=>(0,Ut.numberToBytesBE)(gr,32),Sr=gr=>(0,jt.mod)(gr,Ht),Ar=gr=>(0,jt.mod)(gr,Vt),Dr=kt.secp256k1.ProjectivePoint,Br=(gr,fr,br)=>Dr.BASE.multiplyAndAddUnsafe(gr,fr,br);function Lr(gr){let fr=kt.secp256k1.utils.normPrivateKeyToScalar(gr),br=Dr.fromPrivateKey(fr);return{scalar:br.hasEvenY()?fr:Ar(-fr),bytes:lr(br)}}function Or(gr){if(!rr(gr))throw new Error("bad x: need 0 < x < p");const fr=Sr(gr*gr),br=Sr(fr*gr+BigInt(7));let _r=Qt(br);_r%Wt!==tr&&(_r=Sr(-_r));const Tr=new Dr(gr,_r,zt);return Tr.assertValidity(),Tr}function vr(...gr){return Ar((0,Ut.bytesToNumberBE)(ir("BIP0340/challenge",...gr)))}function pr(gr){return Lr(gr).bytes}function dr(gr,fr,br=(0,xt.randomBytes)(32)){const _r=(0,Ut.ensureBytes)("message",gr),{bytes:Tr,scalar:Pr}=Lr(fr),Nr=(0,Ut.ensureBytes)("auxRand",br,32),Cr=yr(Pr^(0,Ut.bytesToNumberBE)(ir("BIP0340/aux",Nr))),xr=ir("BIP0340/nonce",Cr,Tr,_r),Rr=Ar((0,Ut.bytesToNumberBE)(xr));if(Rr===tr)throw new Error("sign failed: k is zero");const{bytes:qr,scalar:Vr}=Lr(Rr),Gr=vr(qr,Tr,_r),Ur=new Uint8Array(64);if(Ur.set(qr,0),Ur.set(yr(Ar(Vr+Gr*Pr)),32),!ur(Ur,_r,Tr))throw new Error("sign: Invalid signature produced");return Ur}function ur(gr,fr,br){const _r=(0,Ut.ensureBytes)("signature",gr,64),Tr=(0,Ut.ensureBytes)("message",fr),Pr=(0,Ut.ensureBytes)("publicKey",br,32);try{const Nr=Or((0,Ut.bytesToNumberBE)(Pr)),Cr=(0,Ut.bytesToNumberBE)(_r.subarray(0,32));if(!rr(Cr))return!1;const xr=(0,Ut.bytesToNumberBE)(_r.subarray(32,64));if(!nr(xr))return!1;const Rr=vr(yr(Cr),lr(Nr),Tr),qr=Br(Nr,xr,Ar(-Rr));return!(!qr||!qr.hasEvenY()||qr.toAffine().x!==Cr)}catch{return!1}}kt.schnorr={getPublicKey:pr,sign:dr,verify:ur,utils:{randomPrivateKey:kt.secp256k1.utils.randomPrivateKey,lift_x:Or,pointToBytes:lr,numberToBytesBE:Ut.numberToBytesBE,bytesToNumberBE:Ut.bytesToNumberBE,taggedHash:ir,mod:jt.mod}};const $r=(0,Nt.isogenyMap)(Xt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(gr=>gr.map(fr=>BigInt(fr)))),wr=(0,Lt.mapToCurveSimpleSWU)(Xt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Xt.create(BigInt("-11"))}),Er=(0,Nt.createHasher)(kt.secp256k1.ProjectivePoint,gr=>{const{x:fr,y:br}=wr(Xt.create(gr[0]));return $r(fr,br)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Xt.ORDER,m:1,k:128,expand:"xmd",hash:At.sha256});kt.hashToCurve=Er.hashToCurve,kt.encodeToCurve=Er.encodeToCurve})(secp256k1$1);var hex={};Object.defineProperty(hex,"__esModule",{value:!0});hex.decodeHex=hex.remove0x=void 0;var utils_1$5=utils$7;function remove0x(kt){return kt.startsWith("0x")||kt.startsWith("0X")?kt.slice(2):kt}hex.remove0x=remove0x;function decodeHex(kt){return(0,utils_1$5.hexToBytes)(remove0x(kt))}hex.decodeHex=decodeHex;var symmetric={},chacha={},_poly1305={},_assert={};Object.defineProperty(_assert,"__esModule",{value:!0});_assert.output=_assert.exists=_assert.hash=_assert.bytes=_assert.bool=_assert.number=void 0;function number$2(kt){if(!Number.isSafeInteger(kt)||kt<0)throw new Error(`Wrong positive integer: ${kt}`)}_assert.number=number$2;function bool$1(kt){if(typeof kt!="boolean")throw new Error(`Expected boolean, not ${kt}`)}_assert.bool=bool$1;function bytes$3(kt,...At){if(!(kt instanceof Uint8Array))throw new Error("Expected Uint8Array");if(At.length>0&&!At.includes(kt.length))throw new Error(`Expected Uint8Array of length ${At}, not of length=${kt.length}`)}_assert.bytes=bytes$3;function hash$1(kt){if(typeof kt!="function"||typeof kt.create!="function")throw new Error("hash must be wrapped by utils.wrapConstructor");number$2(kt.outputLen),number$2(kt.blockLen)}_assert.hash=hash$1;function exists$3(kt,At=!0){if(kt.destroyed)throw new Error("Hash instance has been destroyed");if(At&&kt.finished)throw new Error("Hash#digest() has already been called")}_assert.exists=exists$3;function output$3(kt,At){bytes$3(kt);const xt=At.outputLen;if(kt.length<xt)throw new Error(`digestInto() expects output buffer of length at least ${xt}`)}_assert.output=output$3;const assert$2={number:number$2,bool:bool$1,bytes:bytes$3,hash:hash$1,exists:exists$3,output:output$3};_assert.default=assert$2;Object.defineProperty(_poly1305,"__esModule",{value:!0});_poly1305.poly1305=_poly1305.wrapConstructorWithKey=void 0;const utils_js_1$3=utils$7,_assert_js_1$2=_assert,u8to16$2=(kt,At)=>kt[At++]&255|(kt[At++]&255)<<8;let Poly1305$2=class{constructor(At){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,At=(0,utils_js_1$3.toBytes)(At),(0,utils_js_1$3.ensureBytes)(At,32);const xt=u8to16$2(At,0),Bt=u8to16$2(At,2),Nt=u8to16$2(At,4),jt=u8to16$2(At,6),Ut=u8to16$2(At,8),Lt=u8to16$2(At,10),Ht=u8to16$2(At,12),Vt=u8to16$2(At,14);this.r[0]=xt&8191,this.r[1]=(xt>>>13|Bt<<3)&8191,this.r[2]=(Bt>>>10|Nt<<6)&7939,this.r[3]=(Nt>>>7|jt<<9)&8191,this.r[4]=(jt>>>4|Ut<<12)&255,this.r[5]=Ut>>>1&8190,this.r[6]=(Ut>>>14|Lt<<2)&8191,this.r[7]=(Lt>>>11|Ht<<5)&8065,this.r[8]=(Ht>>>8|Vt<<8)&8191,this.r[9]=Vt>>>5&127;for(let zt=0;zt<8;zt++)this.pad[zt]=u8to16$2(At,16+2*zt)}process(At,xt,Bt=!1){const Nt=Bt?0:2048,{h:jt,r:Ut}=this,Lt=Ut[0],Ht=Ut[1],Vt=Ut[2],zt=Ut[3],Wt=Ut[4],Jt=Ut[5],Qt=Ut[6],Xt=Ut[7],tr=Ut[8],rr=Ut[9],nr=u8to16$2(At,xt+0),ar=u8to16$2(At,xt+2),ir=u8to16$2(At,xt+4),lr=u8to16$2(At,xt+6),yr=u8to16$2(At,xt+8),Sr=u8to16$2(At,xt+10),Ar=u8to16$2(At,xt+12),Dr=u8to16$2(At,xt+14);let Br=jt[0]+(nr&8191),Lr=jt[1]+((nr>>>13|ar<<3)&8191),Or=jt[2]+((ar>>>10|ir<<6)&8191),vr=jt[3]+((ir>>>7|lr<<9)&8191),pr=jt[4]+((lr>>>4|yr<<12)&8191),dr=jt[5]+(yr>>>1&8191),ur=jt[6]+((yr>>>14|Sr<<2)&8191),$r=jt[7]+((Sr>>>11|Ar<<5)&8191),wr=jt[8]+((Ar>>>8|Dr<<8)&8191),Er=jt[9]+(Dr>>>5|Nt),gr=0,fr=gr+Br*Lt+Lr*(5*rr)+Or*(5*tr)+vr*(5*Xt)+pr*(5*Qt);gr=fr>>>13,fr&=8191,fr+=dr*(5*Jt)+ur*(5*Wt)+$r*(5*zt)+wr*(5*Vt)+Er*(5*Ht),gr+=fr>>>13,fr&=8191;let br=gr+Br*Ht+Lr*Lt+Or*(5*rr)+vr*(5*tr)+pr*(5*Xt);gr=br>>>13,br&=8191,br+=dr*(5*Qt)+ur*(5*Jt)+$r*(5*Wt)+wr*(5*zt)+Er*(5*Vt),gr+=br>>>13,br&=8191;let _r=gr+Br*Vt+Lr*Ht+Or*Lt+vr*(5*rr)+pr*(5*tr);gr=_r>>>13,_r&=8191,_r+=dr*(5*Xt)+ur*(5*Qt)+$r*(5*Jt)+wr*(5*Wt)+Er*(5*zt),gr+=_r>>>13,_r&=8191;let Tr=gr+Br*zt+Lr*Vt+Or*Ht+vr*Lt+pr*(5*rr);gr=Tr>>>13,Tr&=8191,Tr+=dr*(5*tr)+ur*(5*Xt)+$r*(5*Qt)+wr*(5*Jt)+Er*(5*Wt),gr+=Tr>>>13,Tr&=8191;let Pr=gr+Br*Wt+Lr*zt+Or*Vt+vr*Ht+pr*Lt;gr=Pr>>>13,Pr&=8191,Pr+=dr*(5*rr)+ur*(5*tr)+$r*(5*Xt)+wr*(5*Qt)+Er*(5*Jt),gr+=Pr>>>13,Pr&=8191;let Nr=gr+Br*Jt+Lr*Wt+Or*zt+vr*Vt+pr*Ht;gr=Nr>>>13,Nr&=8191,Nr+=dr*Lt+ur*(5*rr)+$r*(5*tr)+wr*(5*Xt)+Er*(5*Qt),gr+=Nr>>>13,Nr&=8191;let Cr=gr+Br*Qt+Lr*Jt+Or*Wt+vr*zt+pr*Vt;gr=Cr>>>13,Cr&=8191,Cr+=dr*Ht+ur*Lt+$r*(5*rr)+wr*(5*tr)+Er*(5*Xt),gr+=Cr>>>13,Cr&=8191;let xr=gr+Br*Xt+Lr*Qt+Or*Jt+vr*Wt+pr*zt;gr=xr>>>13,xr&=8191,xr+=dr*Vt+ur*Ht+$r*Lt+wr*(5*rr)+Er*(5*tr),gr+=xr>>>13,xr&=8191;let Rr=gr+Br*tr+Lr*Xt+Or*Qt+vr*Jt+pr*Wt;gr=Rr>>>13,Rr&=8191,Rr+=dr*zt+ur*Vt+$r*Ht+wr*Lt+Er*(5*rr),gr+=Rr>>>13,Rr&=8191;let qr=gr+Br*rr+Lr*tr+Or*Xt+vr*Qt+pr*Jt;gr=qr>>>13,qr&=8191,qr+=dr*Wt+ur*zt+$r*Vt+wr*Ht+Er*Lt,gr+=qr>>>13,qr&=8191,gr=(gr<<2)+gr|0,gr=gr+fr|0,fr=gr&8191,gr=gr>>>13,br+=gr,jt[0]=fr,jt[1]=br,jt[2]=_r,jt[3]=Tr,jt[4]=Pr,jt[5]=Nr,jt[6]=Cr,jt[7]=xr,jt[8]=Rr,jt[9]=qr}finalize(){const{h:At,pad:xt}=this,Bt=new Uint16Array(10);let Nt=At[1]>>>13;At[1]&=8191;for(let Lt=2;Lt<10;Lt++)At[Lt]+=Nt,Nt=At[Lt]>>>13,At[Lt]&=8191;At[0]+=Nt*5,Nt=At[0]>>>13,At[0]&=8191,At[1]+=Nt,Nt=At[1]>>>13,At[1]&=8191,At[2]+=Nt,Bt[0]=At[0]+5,Nt=Bt[0]>>>13,Bt[0]&=8191;for(let Lt=1;Lt<10;Lt++)Bt[Lt]=At[Lt]+Nt,Nt=Bt[Lt]>>>13,Bt[Lt]&=8191;Bt[9]-=8192;let jt=(Nt^1)-1;for(let Lt=0;Lt<10;Lt++)Bt[Lt]&=jt;jt=~jt;for(let Lt=0;Lt<10;Lt++)At[Lt]=At[Lt]&jt|Bt[Lt];At[0]=(At[0]|At[1]<<13)&65535,At[1]=(At[1]>>>3|At[2]<<10)&65535,At[2]=(At[2]>>>6|At[3]<<7)&65535,At[3]=(At[3]>>>9|At[4]<<4)&65535,At[4]=(At[4]>>>12|At[5]<<1|At[6]<<14)&65535,At[5]=(At[6]>>>2|At[7]<<11)&65535,At[6]=(At[7]>>>5|At[8]<<8)&65535,At[7]=(At[8]>>>8|At[9]<<5)&65535;let Ut=At[0]+xt[0];At[0]=Ut&65535;for(let Lt=1;Lt<8;Lt++)Ut=(At[Lt]+xt[Lt]|0)+(Ut>>>16)|0,At[Lt]=Ut&65535}update(At){_assert_js_1$2.default.exists(this);const{buffer:xt,blockLen:Bt}=this;At=(0,utils_js_1$3.toBytes)(At);const Nt=At.length;for(let jt=0;jt<Nt;){const Ut=Math.min(Bt-this.pos,Nt-jt);if(Ut===Bt){for(;Bt<=Nt-jt;jt+=Bt)this.process(At,jt);continue}xt.set(At.subarray(jt,jt+Ut),this.pos),this.pos+=Ut,jt+=Ut,this.pos===Bt&&(this.process(xt,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(At){_assert_js_1$2.default.exists(this),_assert_js_1$2.default.output(At,this),this.finished=!0;const{buffer:xt,h:Bt}=this;let{pos:Nt}=this;if(Nt){for(xt[Nt++]=1;Nt<16;Nt++)xt[Nt]=0;this.process(xt,0,!0)}this.finalize();let jt=0;for(let Ut=0;Ut<8;Ut++)At[jt++]=Bt[Ut]>>>0,At[jt++]=Bt[Ut]>>>8;return At}digest(){const{buffer:At,outputLen:xt}=this;this.digestInto(At);const Bt=At.slice(0,xt);return this.destroy(),Bt}};function wrapConstructorWithKey$2(kt){const At=(Bt,Nt)=>kt(Nt).update((0,utils_js_1$3.toBytes)(Bt)).digest(),xt=kt(new Uint8Array(32));return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=Bt=>kt(Bt),At}_poly1305.wrapConstructorWithKey=wrapConstructorWithKey$2;_poly1305.poly1305=wrapConstructorWithKey$2(kt=>new Poly1305$2(kt));var _salsa={};Object.defineProperty(_salsa,"__esModule",{value:!0});_salsa.salsaBasic=void 0;const _assert_js_1$1=_assert,utils_js_1$2=utils$7,sigma16$2=(0,utils_js_1$2.utf8ToBytes)("expand 16-byte k"),sigma32$2=(0,utils_js_1$2.utf8ToBytes)("expand 32-byte k"),sigma16_32$1=(0,utils_js_1$2.u32)(sigma16$2),sigma32_32$1=(0,utils_js_1$2.u32)(sigma32$2),isAligned32$1=kt=>!(kt.byteOffset%4),salsaBasic=kt=>{const{core:At,rounds:xt,counterRight:Bt,counterLen:Nt,allow128bitKeys:jt,extendNonceFn:Ut,blockLen:Lt}=(0,utils_js_1$2.checkOpts)({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},kt);_assert_js_1$1.default.number(Nt),_assert_js_1$1.default.number(xt),_assert_js_1$1.default.number(Lt),_assert_js_1$1.default.bool(Bt),_assert_js_1$1.default.bool(jt);const Ht=Lt/4;if(Lt%4!==0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(Vt,zt,Wt,Jt,Qt=0)=>{if(_assert_js_1$1.default.bytes(Vt),_assert_js_1$1.default.bytes(zt),_assert_js_1$1.default.bytes(Wt),Jt||(Jt=new Uint8Array(Wt.length)),_assert_js_1$1.default.bytes(Jt),_assert_js_1$1.default.number(Qt),Qt<0||Qt>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(Jt.length<Wt.length)throw new Error(`Salsa/ChaCha: output (${Jt.length}) is shorter than data (${Wt.length})`);const Xt=[];let tr,rr;if(Vt.length===32)isAligned32$1(Vt)?tr=Vt:(tr=Vt.slice(),Xt.push(tr)),rr=sigma32_32$1;else if(Vt.length===16&&jt)tr=new Uint8Array(32),tr.set(Vt),tr.set(Vt,16),rr=sigma16_32$1,Xt.push(tr);else throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${Vt.length}`);if(isAligned32$1(zt)||(zt=zt.slice(),Xt.push(zt)),Ut){if(zt.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");tr=Ut(rr,tr,zt.subarray(0,16),new Uint8Array(32)),Xt.push(tr),zt=zt.subarray(16)}const nr=16-Nt;if(zt.length!==nr)throw new Error(`Salsa/ChaCha: nonce must be ${nr} or 16 bytes`);if(nr!==12){const Br=new Uint8Array(12);Br.set(zt,Bt?0:12-zt.length),Xt.push(zt=Br)}const ar=new Uint8Array(Lt),ir=(0,utils_js_1$2.u32)(ar),lr=(0,utils_js_1$2.u32)(tr),yr=(0,utils_js_1$2.u32)(zt),Sr=isAligned32$1(Wt)&&(0,utils_js_1$2.u32)(Wt),Ar=isAligned32$1(Jt)&&(0,utils_js_1$2.u32)(Jt);Xt.push(ir);const Dr=Wt.length;for(let Br=0,Lr=Qt;Br<Dr;Lr++){if(At(rr,lr,yr,ir,Lr,xt),Lr>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const Or=Math.min(Lt,Dr-Br);if(Or===Lt&&Ar&&Sr){const vr=Br/4;if(Br%4!==0)throw new Error("Salsa/ChaCha: invalid block position");for(let pr=0;pr<Ht;pr++)Ar[vr+pr]=Sr[vr+pr]^ir[pr];Br+=Lt;continue}for(let vr=0;vr<Or;vr++)Jt[Br+vr]=Wt[Br+vr]^ar[vr];Br+=Or}for(let Br=0;Br<Xt.length;Br++)Xt[Br].fill(0);return Jt}};_salsa.salsaBasic=salsaBasic;(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.xchacha20poly1305=kt.chacha20poly1305=kt._poly1305_aead=kt.chacha12=kt.chacha8=kt.xchacha20=kt.chacha20=kt.chacha20orig=kt.hchacha=void 0;const At=utils$7,xt=_poly1305,Bt=_salsa,Nt=(Wt,Jt)=>Wt<<Jt|Wt>>>32-Jt;function jt(Wt,Jt,Qt,Xt,tr,rr=20){let nr=Wt[0],ar=Wt[1],ir=Wt[2],lr=Wt[3],yr=Jt[0],Sr=Jt[1],Ar=Jt[2],Dr=Jt[3],Br=Jt[4],Lr=Jt[5],Or=Jt[6],vr=Jt[7],pr=tr,dr=Qt[0],ur=Qt[1],$r=Qt[2],wr=nr,Er=ar,gr=ir,fr=lr,br=yr,_r=Sr,Tr=Ar,Pr=Dr,Nr=Br,Cr=Lr,xr=Or,Rr=vr,qr=pr,Vr=dr,Gr=ur,Ur=$r;for(let Fr=0;Fr<rr;Fr+=2)wr=wr+br|0,qr=Nt(qr^wr,16),Nr=Nr+qr|0,br=Nt(br^Nr,12),wr=wr+br|0,qr=Nt(qr^wr,8),Nr=Nr+qr|0,br=Nt(br^Nr,7),Er=Er+_r|0,Vr=Nt(Vr^Er,16),Cr=Cr+Vr|0,_r=Nt(_r^Cr,12),Er=Er+_r|0,Vr=Nt(Vr^Er,8),Cr=Cr+Vr|0,_r=Nt(_r^Cr,7),gr=gr+Tr|0,Gr=Nt(Gr^gr,16),xr=xr+Gr|0,Tr=Nt(Tr^xr,12),gr=gr+Tr|0,Gr=Nt(Gr^gr,8),xr=xr+Gr|0,Tr=Nt(Tr^xr,7),fr=fr+Pr|0,Ur=Nt(Ur^fr,16),Rr=Rr+Ur|0,Pr=Nt(Pr^Rr,12),fr=fr+Pr|0,Ur=Nt(Ur^fr,8),Rr=Rr+Ur|0,Pr=Nt(Pr^Rr,7),wr=wr+_r|0,Ur=Nt(Ur^wr,16),xr=xr+Ur|0,_r=Nt(_r^xr,12),wr=wr+_r|0,Ur=Nt(Ur^wr,8),xr=xr+Ur|0,_r=Nt(_r^xr,7),Er=Er+Tr|0,qr=Nt(qr^Er,16),Rr=Rr+qr|0,Tr=Nt(Tr^Rr,12),Er=Er+Tr|0,qr=Nt(qr^Er,8),Rr=Rr+qr|0,Tr=Nt(Tr^Rr,7),gr=gr+Pr|0,Vr=Nt(Vr^gr,16),Nr=Nr+Vr|0,Pr=Nt(Pr^Nr,12),gr=gr+Pr|0,Vr=Nt(Vr^gr,8),Nr=Nr+Vr|0,Pr=Nt(Pr^Nr,7),fr=fr+br|0,Gr=Nt(Gr^fr,16),Cr=Cr+Gr|0,br=Nt(br^Cr,12),fr=fr+br|0,Gr=Nt(Gr^fr,8),Cr=Cr+Gr|0,br=Nt(br^Cr,7);let kr=0;Xt[kr++]=nr+wr|0,Xt[kr++]=ar+Er|0,Xt[kr++]=ir+gr|0,Xt[kr++]=lr+fr|0,Xt[kr++]=yr+br|0,Xt[kr++]=Sr+_r|0,Xt[kr++]=Ar+Tr|0,Xt[kr++]=Dr+Pr|0,Xt[kr++]=Br+Nr|0,Xt[kr++]=Lr+Cr|0,Xt[kr++]=Or+xr|0,Xt[kr++]=vr+Rr|0,Xt[kr++]=pr+qr|0,Xt[kr++]=dr+Vr|0,Xt[kr++]=ur+Gr|0,Xt[kr++]=$r+Ur|0}function Ut(Wt,Jt,Qt,Xt){const tr=(0,At.u32)(Jt),rr=(0,At.u32)(Qt),nr=(0,At.u32)(Xt);let ar=Wt[0],ir=Wt[1],lr=Wt[2],yr=Wt[3],Sr=tr[0],Ar=tr[1],Dr=tr[2],Br=tr[3],Lr=tr[4],Or=tr[5],vr=tr[6],pr=tr[7],dr=rr[0],ur=rr[1],$r=rr[2],wr=rr[3];for(let Er=0;Er<20;Er+=2)ar=ar+Sr|0,dr=Nt(dr^ar,16),Lr=Lr+dr|0,Sr=Nt(Sr^Lr,12),ar=ar+Sr|0,dr=Nt(dr^ar,8),Lr=Lr+dr|0,Sr=Nt(Sr^Lr,7),ir=ir+Ar|0,ur=Nt(ur^ir,16),Or=Or+ur|0,Ar=Nt(Ar^Or,12),ir=ir+Ar|0,ur=Nt(ur^ir,8),Or=Or+ur|0,Ar=Nt(Ar^Or,7),lr=lr+Dr|0,$r=Nt($r^lr,16),vr=vr+$r|0,Dr=Nt(Dr^vr,12),lr=lr+Dr|0,$r=Nt($r^lr,8),vr=vr+$r|0,Dr=Nt(Dr^vr,7),yr=yr+Br|0,wr=Nt(wr^yr,16),pr=pr+wr|0,Br=Nt(Br^pr,12),yr=yr+Br|0,wr=Nt(wr^yr,8),pr=pr+wr|0,Br=Nt(Br^pr,7),ar=ar+Ar|0,wr=Nt(wr^ar,16),vr=vr+wr|0,Ar=Nt(Ar^vr,12),ar=ar+Ar|0,wr=Nt(wr^ar,8),vr=vr+wr|0,Ar=Nt(Ar^vr,7),ir=ir+Dr|0,dr=Nt(dr^ir,16),pr=pr+dr|0,Dr=Nt(Dr^pr,12),ir=ir+Dr|0,dr=Nt(dr^ir,8),pr=pr+dr|0,Dr=Nt(Dr^pr,7),lr=lr+Br|0,ur=Nt(ur^lr,16),Lr=Lr+ur|0,Br=Nt(Br^Lr,12),lr=lr+Br|0,ur=Nt(ur^lr,8),Lr=Lr+ur|0,Br=Nt(Br^Lr,7),yr=yr+Sr|0,$r=Nt($r^yr,16),Or=Or+$r|0,Sr=Nt(Sr^Or,12),yr=yr+Sr|0,$r=Nt($r^yr,8),Or=Or+$r|0,Sr=Nt(Sr^Or,7);return nr[0]=ar,nr[1]=ir,nr[2]=lr,nr[3]=yr,nr[4]=dr,nr[5]=ur,nr[6]=$r,nr[7]=wr,Xt}kt.hchacha=Ut,kt.chacha20orig=(0,Bt.salsaBasic)({core:jt,counterRight:!1,counterLen:8}),kt.chacha20=(0,Bt.salsaBasic)({core:jt,counterRight:!1,counterLen:4,allow128bitKeys:!1}),kt.xchacha20=(0,Bt.salsaBasic)({core:jt,counterRight:!1,counterLen:8,extendNonceFn:Ut,allow128bitKeys:!1}),kt.chacha8=(0,Bt.salsaBasic)({core:jt,counterRight:!1,counterLen:4,rounds:8}),kt.chacha12=(0,Bt.salsaBasic)({core:jt,counterRight:!1,counterLen:4,rounds:12});const Lt=new Uint8Array(16),Ht=(Wt,Jt)=>{Wt.update(Jt);const Qt=Jt.length%16;Qt&&Wt.update(Lt.subarray(Qt))},Vt=(Wt,Jt,Qt,Xt,tr)=>{const rr=Wt(Jt,Qt,new Uint8Array(32)),nr=xt.poly1305.create(rr);tr&&Ht(nr,tr),Ht(nr,Xt);const ar=new Uint8Array(16),ir=(0,At.createView)(ar);(0,At.setBigUint64)(ir,0,BigInt(tr?tr.length:0),!0),(0,At.setBigUint64)(ir,8,BigInt(Xt.length),!0),nr.update(ar);const lr=nr.digest();return rr.fill(0),lr},zt=Wt=>(Jt,Qt,Xt)=>((0,At.ensureBytes)(Jt,32),(0,At.ensureBytes)(Qt),{tagLength:16,encrypt:(rr,nr)=>{const ar=rr.length,ir=ar+16;nr?(0,At.ensureBytes)(nr,ir):nr=new Uint8Array(ir),Wt(Jt,Qt,rr,nr,1);const lr=Vt(Wt,Jt,Qt,nr.subarray(0,-16),Xt);return nr.set(lr,ar),nr},decrypt:(rr,nr)=>{const ar=rr.length,ir=ar-16;if(ar<16)throw new Error("encrypted data must be at least 16 bytes");nr?(0,At.ensureBytes)(nr,ir):nr=new Uint8Array(ir);const lr=rr.subarray(0,-16),yr=rr.subarray(-16),Sr=Vt(Wt,Jt,Qt,lr,Xt);if(!(0,At.equalBytes)(yr,Sr))throw new Error("invalid tag");return Wt(Jt,Qt,lr,nr,1),nr}});kt._poly1305_aead=zt,kt.chacha20poly1305=(0,kt._poly1305_aead)(kt.chacha20),kt.xchacha20poly1305=(0,kt._poly1305_aead)(kt.xchacha20)})(chacha);var hkdf$1={},hmac$1={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.hmac=kt.HMAC=void 0;const At=_assert$1,xt=utils$4;class Bt extends xt.Hash{constructor(Ut,Lt){super(),this.finished=!1,this.destroyed=!1,(0,At.hash)(Ut);const Ht=(0,xt.toBytes)(Lt);if(this.iHash=Ut.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Vt=this.blockLen,zt=new Uint8Array(Vt);zt.set(Ht.length>Vt?Ut.create().update(Ht).digest():Ht);for(let Wt=0;Wt<zt.length;Wt++)zt[Wt]^=54;this.iHash.update(zt),this.oHash=Ut.create();for(let Wt=0;Wt<zt.length;Wt++)zt[Wt]^=106;this.oHash.update(zt),zt.fill(0)}update(Ut){return(0,At.exists)(this),this.iHash.update(Ut),this}digestInto(Ut){(0,At.exists)(this),(0,At.bytes)(Ut,this.outputLen),this.finished=!0,this.iHash.digestInto(Ut),this.oHash.update(Ut),this.oHash.digestInto(Ut),this.destroy()}digest(){const Ut=new Uint8Array(this.oHash.outputLen);return this.digestInto(Ut),Ut}_cloneInto(Ut){Ut||(Ut=Object.create(Object.getPrototypeOf(this),{}));const{oHash:Lt,iHash:Ht,finished:Vt,destroyed:zt,blockLen:Wt,outputLen:Jt}=this;return Ut=Ut,Ut.finished=Vt,Ut.destroyed=zt,Ut.blockLen=Wt,Ut.outputLen=Jt,Ut.oHash=Lt._cloneInto(Ut.oHash),Ut.iHash=Ht._cloneInto(Ut.iHash),Ut}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}kt.HMAC=Bt;const Nt=(jt,Ut,Lt)=>new Bt(jt,Ut).update(Lt).digest();kt.hmac=Nt,kt.hmac.create=(jt,Ut)=>new Bt(jt,Ut)})(hmac$1);Object.defineProperty(hkdf$1,"__esModule",{value:!0});hkdf$1.hkdf=hkdf$1.expand=hkdf$1.extract=void 0;const _assert_js_1=_assert$1,utils_js_1$1=utils$4,hmac_js_1=hmac$1;function extract(kt,At,xt){return(0,_assert_js_1.hash)(kt),xt===void 0&&(xt=new Uint8Array(kt.outputLen)),(0,hmac_js_1.hmac)(kt,(0,utils_js_1$1.toBytes)(xt),(0,utils_js_1$1.toBytes)(At))}hkdf$1.extract=extract;const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(kt,At,xt,Bt=32){if((0,_assert_js_1.hash)(kt),(0,_assert_js_1.number)(Bt),Bt>255*kt.outputLen)throw new Error("Length should be <= 255*HashLen");const Nt=Math.ceil(Bt/kt.outputLen);xt===void 0&&(xt=EMPTY_BUFFER);const jt=new Uint8Array(Nt*kt.outputLen),Ut=hmac_js_1.hmac.create(kt,At),Lt=Ut._cloneInto(),Ht=new Uint8Array(Ut.outputLen);for(let Vt=0;Vt<Nt;Vt++)HKDF_COUNTER[0]=Vt+1,Lt.update(Vt===0?EMPTY_BUFFER:Ht).update(xt).update(HKDF_COUNTER).digestInto(Ht),jt.set(Ht,kt.outputLen*Vt),Ut._cloneInto(Lt);return Ut.destroy(),Lt.destroy(),Ht.fill(0),HKDF_COUNTER.fill(0),jt.slice(0,Bt)}hkdf$1.expand=expand;const hkdf=(kt,At,xt,Bt,Nt)=>expand(kt,extract(kt,At,xt),Bt,Nt);hkdf$1.hkdf=hkdf;var sha256$1={};Object.defineProperty(sha256$1,"__esModule",{value:!0});sha256$1.sha224=sha256$1.sha256=void 0;const _md_js_1=_md,utils_js_1=utils$4,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends _md_js_1.HashMD{constructor(){super(64,32,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:At,B:xt,C:Bt,D:Nt,E:jt,F:Ut,G:Lt,H:Ht}=this;return[At,xt,Bt,Nt,jt,Ut,Lt,Ht]}set(At,xt,Bt,Nt,jt,Ut,Lt,Ht){this.A=At|0,this.B=xt|0,this.C=Bt|0,this.D=Nt|0,this.E=jt|0,this.F=Ut|0,this.G=Lt|0,this.H=Ht|0}process(At,xt){for(let Wt=0;Wt<16;Wt++,xt+=4)SHA256_W$1[Wt]=At.getUint32(xt,!1);for(let Wt=16;Wt<64;Wt++){const Jt=SHA256_W$1[Wt-15],Qt=SHA256_W$1[Wt-2],Xt=(0,utils_js_1.rotr)(Jt,7)^(0,utils_js_1.rotr)(Jt,18)^Jt>>>3,tr=(0,utils_js_1.rotr)(Qt,17)^(0,utils_js_1.rotr)(Qt,19)^Qt>>>10;SHA256_W$1[Wt]=tr+SHA256_W$1[Wt-7]+Xt+SHA256_W$1[Wt-16]|0}let{A:Bt,B:Nt,C:jt,D:Ut,E:Lt,F:Ht,G:Vt,H:zt}=this;for(let Wt=0;Wt<64;Wt++){const Jt=(0,utils_js_1.rotr)(Lt,6)^(0,utils_js_1.rotr)(Lt,11)^(0,utils_js_1.rotr)(Lt,25),Qt=zt+Jt+(0,_md_js_1.Chi)(Lt,Ht,Vt)+SHA256_K$1[Wt]+SHA256_W$1[Wt]|0,tr=((0,utils_js_1.rotr)(Bt,2)^(0,utils_js_1.rotr)(Bt,13)^(0,utils_js_1.rotr)(Bt,22))+(0,_md_js_1.Maj)(Bt,Nt,jt)|0;zt=Vt,Vt=Ht,Ht=Lt,Lt=Ut+Qt|0,Ut=jt,jt=Nt,Nt=Bt,Bt=Qt+tr|0}Bt=Bt+this.A|0,Nt=Nt+this.B|0,jt=jt+this.C|0,Ut=Ut+this.D|0,Lt=Lt+this.E|0,Ht=Ht+this.F|0,Vt=Vt+this.G|0,zt=zt+this.H|0,this.set(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}sha256$1.sha256=(0,utils_js_1.wrapConstructor)(()=>new SHA256$1);sha256$1.sha224=(0,utils_js_1.wrapConstructor)(()=>new SHA224);var compat={};Object.defineProperty(compat,"__esModule",{value:!0});compat.aes256gcm=void 0;var utils_1$4=utils$7,crypto_1=requireCryptoBrowserify(),consts_1$2=consts;function aes256gcm(kt,At,xt){var Bt=function(jt){var Ut=(0,crypto_1.createCipheriv)("aes-256-gcm",kt,At);xt&&Ut.setAAD(xt);var Lt=Ut.update(jt),Ht=Ut.final();return(0,utils_1$4.concatBytes)(Lt,Ht,Ut.getAuthTag())},Nt=function(jt){var Ut=jt.subarray(0,jt.length-consts_1$2.AEAD_TAG_LENGTH),Lt=jt.subarray(-consts_1$2.AEAD_TAG_LENGTH),Ht=(0,crypto_1.createDecipheriv)("aes-256-gcm",kt,At);xt&&Ht.setAAD(xt),Ht.setAuthTag(Lt);var Vt=Ht.update(Ut),zt=Ht.final();return(0,utils_1$4.concatBytes)(Vt,zt)};return{tagLength:consts_1$2.AEAD_TAG_LENGTH,encrypt:Bt,decrypt:Nt}}compat.aes256gcm=aes256gcm;Object.defineProperty(symmetric,"__esModule",{value:!0});symmetric.deriveKey=symmetric.aesDecrypt=symmetric.aesEncrypt=void 0;var chacha_1=chacha,utils_1$3=utils$7,utils_2$3=utils$5,hkdf_1=hkdf$1,sha256_1=sha256$1,config_1$3=config,consts_1$1=consts,compat_1=compat;function aesEncrypt(kt,At){return _exec$1(!0,kt,At)}symmetric.aesEncrypt=aesEncrypt;function aesDecrypt(kt,At){return _exec$1(!1,kt,At)}symmetric.aesDecrypt=aesDecrypt;function deriveKey(kt){return(0,hkdf_1.hkdf)(sha256_1.sha256,kt,void 0,void 0,32)}symmetric.deriveKey=deriveKey;function _exec$1(kt,At,xt){var Bt=(0,config_1$3.symmetricAlgorithm)(),Nt=kt?_encrypt:_decrypt;if(Bt==="aes-256-gcm")return Nt(compat_1.aes256gcm,At,xt,(0,config_1$3.symmetricNonceLength)());if(Bt==="xchacha20")return Nt(chacha_1.xchacha20poly1305,At,xt,consts_1$1.XCHACHA20_NONCE_LENGTH);throw new Error("Not implemented")}function _encrypt(kt,At,xt,Bt){var Nt=(0,utils_2$3.randomBytes)(Bt),jt=kt(At,Nt),Ut=jt.encrypt(xt),Lt=Ut.subarray(0,Ut.length-consts_1$1.AEAD_TAG_LENGTH),Ht=Ut.subarray(-consts_1$1.AEAD_TAG_LENGTH);return(0,utils_1$3.concatBytes)(Nt,Ht,Lt)}function _decrypt(kt,At,xt,Bt){var Nt=Bt+consts_1$1.AEAD_TAG_LENGTH,jt=xt.subarray(0,Bt),Ut=xt.subarray(Bt,Nt),Lt=xt.subarray(Nt),Ht=kt(At,Uint8Array.from(jt)),Vt=(0,utils_1$3.concatBytes)(Lt,Ut);return Ht.decrypt(Vt)}Object.defineProperty(elliptic,"__esModule",{value:!0});elliptic.hexToPublicKey=elliptic.convertPublicKeyFormat=elliptic.getSharedPoint=elliptic.getSharedKey=elliptic.getPublicKey=elliptic.isValidPrivateKey=elliptic.getValidSecret=void 0;var utils_1$2=utils$7,utils_2$2=utils$5,ed25519_1=ed25519$1,secp256k1_1=secp256k1$1,config_1$2=config,consts_1=consts,hex_1=hex,symmetric_1=symmetric;function getValidSecret(){var kt;do kt=(0,utils_2$2.randomBytes)(consts_1.SECRET_KEY_LENGTH);while(!isValidPrivateKey(kt));return kt}elliptic.getValidSecret=getValidSecret;function isValidPrivateKey(kt){return _exec(function(At){return At.utils.isValidPrivateKey(kt)},function(){return!0},function(){return!0})}elliptic.isValidPrivateKey=isValidPrivateKey;function getPublicKey(kt){return _exec(function(At){return At.getPublicKey(kt)},function(At){return At.getPublicKey(kt)},function(At){return At.getPublicKey(kt)})}elliptic.getPublicKey=getPublicKey;function getSharedKey(kt,At){return(0,symmetric_1.deriveKey)((0,utils_1$2.concatBytes)(kt,At))}elliptic.getSharedKey=getSharedKey;function getSharedPoint(kt,At,xt){return _exec(function(Bt){return Bt.getSharedSecret(kt,At,xt)},function(Bt){return Bt.getSharedSecret(kt,At)},function(Bt){var Nt=Bt.utils.getExtendedPublicKey(kt).scalar,jt=Bt.ExtendedPoint.fromHex(At).multiply(Nt);return jt.toRawBytes()})}elliptic.getSharedPoint=getSharedPoint;function convertPublicKeyFormat(kt,At){return _exec(function(xt){return xt.getSharedSecret(BigInt(1),kt,At)},function(){return kt},function(){return kt})}elliptic.convertPublicKeyFormat=convertPublicKeyFormat;function hexToPublicKey(kt){var At=(0,hex_1.decodeHex)(kt);return _exec(function(){if(At.length===consts_1.ETH_PUBLIC_KEY_SIZE){var xt=new Uint8Array(1+At.length);return xt.set([4]),xt.set(At,1),xt}return At},function(){return At},function(){return At})}elliptic.hexToPublicKey=hexToPublicKey;function _exec(kt,At,xt){if((0,config_1$2.ellipticCurve)()==="secp256k1")return kt(secp256k1_1.secp256k1);if((0,config_1$2.ellipticCurve)()==="x25519")return At(ed25519_1.x25519);if((0,config_1$2.ellipticCurve)()==="ed25519")return xt(ed25519_1.ed25519);throw new Error("Not implemented")}(function(kt){var At=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Bt,Nt,jt,Ut){Ut===void 0&&(Ut=jt);var Lt=Object.getOwnPropertyDescriptor(Nt,jt);(!Lt||("get"in Lt?!Nt.__esModule:Lt.writable||Lt.configurable))&&(Lt={enumerable:!0,get:function(){return Nt[jt]}}),Object.defineProperty(Bt,Ut,Lt)}:function(Bt,Nt,jt,Ut){Ut===void 0&&(Ut=jt),Bt[Ut]=Nt[jt]}),xt=commonjsGlobal&&commonjsGlobal.__exportStar||function(Bt,Nt){for(var jt in Bt)jt!=="default"&&!Object.prototype.hasOwnProperty.call(Nt,jt)&&At(Nt,Bt,jt)};Object.defineProperty(kt,"__esModule",{value:!0}),xt(elliptic,kt),xt(hex,kt),xt(symmetric,kt)})(utils$6);var PublicKey$1={};Object.defineProperty(PublicKey$1,"__esModule",{value:!0});PublicKey$1.PublicKey=void 0;var utils_1$1=utils$7,config_1$1=config,utils_2$1=utils$6,PublicKey=function(){function kt(At){this.data=(0,utils_2$1.convertPublicKeyFormat)(At,!0)}return kt.fromHex=function(At){return new kt((0,utils_2$1.hexToPublicKey)(At))},Object.defineProperty(kt.prototype,"uncompressed",{get:function(){return buffer$2.Buffer.from((0,utils_2$1.convertPublicKeyFormat)(this.data,!1))},enumerable:!1,configurable:!0}),Object.defineProperty(kt.prototype,"compressed",{get:function(){return buffer$2.Buffer.from(this.data)},enumerable:!1,configurable:!0}),kt.prototype.toHex=function(At){return At===void 0&&(At=!0),At?(0,utils_1$1.bytesToHex)(this.data):(0,utils_1$1.bytesToHex)(this.uncompressed)},kt.prototype.decapsulate=function(At){var xt,Bt;return(0,config_1$1.isHkdfKeyCompressed)()?(xt=this.data,Bt=At.multiply(this,!0)):(xt=this.uncompressed,Bt=At.multiply(this,!1)),(0,utils_2$1.getSharedKey)(xt,Bt)},kt.prototype.equals=function(At){return(0,utils_1$1.equalBytes)(this.data,At.data)},kt}();PublicKey$1.PublicKey=PublicKey;Object.defineProperty(PrivateKey$1,"__esModule",{value:!0});PrivateKey$1.PrivateKey=void 0;var utils_1=utils$7,config_1=config,utils_2=utils$6,PublicKey_1=PublicKey$1,PrivateKey=function(){function kt(At){var xt=At===void 0?(0,utils_2.getValidSecret)():At;if(!(0,utils_2.isValidPrivateKey)(xt))throw new Error("Invalid private key");this.data=xt,this.publicKey=new PublicKey_1.PublicKey((0,utils_2.getPublicKey)(xt))}return kt.fromHex=function(At){return new kt((0,utils_2.decodeHex)(At))},Object.defineProperty(kt.prototype,"secret",{get:function(){return buffer$2.Buffer.from(this.data)},enumerable:!1,configurable:!0}),kt.prototype.toHex=function(){return(0,utils_1.bytesToHex)(this.data)},kt.prototype.encapsulate=function(At){var xt,Bt;return(0,config_1.isHkdfKeyCompressed)()?(xt=this.publicKey.compressed,Bt=this.multiply(At,!0)):(xt=this.publicKey.uncompressed,Bt=this.multiply(At,!1)),(0,utils_2.getSharedKey)(xt,Bt)},kt.prototype.multiply=function(At,xt){return xt===void 0&&(xt=!1),(0,utils_2.getSharedPoint)(this.data,At.compressed,xt)},kt.prototype.equals=function(At){return(0,utils_1.equalBytes)(this.data,At.data)},kt}();PrivateKey$1.PrivateKey=PrivateKey;(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.PublicKey=kt.PrivateKey=void 0;var At=PrivateKey$1;Object.defineProperty(kt,"PrivateKey",{enumerable:!0,get:function(){return At.PrivateKey}});var xt=PublicKey$1;Object.defineProperty(kt,"PublicKey",{enumerable:!0,get:function(){return xt.PublicKey}})})(keys);(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.utils=kt.PublicKey=kt.PrivateKey=kt.ECIES_CONFIG=kt.decrypt=kt.encrypt=void 0;var At=utils$7,xt=config,Bt=keys,Nt=utils$6;function jt(Vt,zt){var Wt=new Bt.PrivateKey,Jt=Vt instanceof Uint8Array?new Bt.PublicKey(Vt):Bt.PublicKey.fromHex(Vt),Qt=Wt.encapsulate(Jt),Xt=(0,Nt.aesEncrypt)(Qt,zt),tr;return(0,xt.isEphemeralKeyCompressed)()?tr=Wt.publicKey.compressed:tr=Wt.publicKey.uncompressed,buffer$2.Buffer.from((0,At.concatBytes)(tr,Xt))}kt.encrypt=jt;function Ut(Vt,zt){var Wt=Vt instanceof Uint8Array?new Bt.PrivateKey(Vt):Bt.PrivateKey.fromHex(Vt),Jt=(0,xt.ephemeralKeySize)(),Qt=new Bt.PublicKey(zt.subarray(0,Jt)),Xt=zt.subarray(Jt),tr=Qt.decapsulate(Wt);return buffer$2.Buffer.from((0,Nt.aesDecrypt)(tr,Xt))}kt.decrypt=Ut;var Lt=config;Object.defineProperty(kt,"ECIES_CONFIG",{enumerable:!0,get:function(){return Lt.ECIES_CONFIG}});var Ht=keys;Object.defineProperty(kt,"PrivateKey",{enumerable:!0,get:function(){return Ht.PrivateKey}}),Object.defineProperty(kt,"PublicKey",{enumerable:!0,get:function(){return Ht.PublicKey}}),kt.utils={aesDecrypt:Nt.aesDecrypt,aesEncrypt:Nt.aesEncrypt,decodeHex:Nt.decodeHex,getValidSecret:Nt.getValidSecret,remove0x:Nt.remove0x}})(dist);var browser$2={exports:{}},stream$1={exports:{}},primordials$1={ArrayIsArray(kt){return Array.isArray(kt)},ArrayPrototypeIncludes(kt,At){return kt.includes(At)},ArrayPrototypeIndexOf(kt,At){return kt.indexOf(At)},ArrayPrototypeJoin(kt,At){return kt.join(At)},ArrayPrototypeMap(kt,At){return kt.map(At)},ArrayPrototypePop(kt,At){return kt.pop(At)},ArrayPrototypePush(kt,At){return kt.push(At)},ArrayPrototypeSlice(kt,At,xt){return kt.slice(At,xt)},Error,FunctionPrototypeCall(kt,At,...xt){return kt.call(At,...xt)},FunctionPrototypeSymbolHasInstance(kt,At){return Function.prototype[Symbol.hasInstance].call(kt,At)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(kt,At){return Object.defineProperties(kt,At)},ObjectDefineProperty(kt,At,xt){return Object.defineProperty(kt,At,xt)},ObjectGetOwnPropertyDescriptor(kt,At){return Object.getOwnPropertyDescriptor(kt,At)},ObjectKeys(kt){return Object.keys(kt)},ObjectSetPrototypeOf(kt,At){return Object.setPrototypeOf(kt,At)},Promise,PromisePrototypeCatch(kt,At){return kt.catch(At)},PromisePrototypeThen(kt,At,xt){return kt.then(At,xt)},PromiseReject(kt){return Promise.reject(kt)},PromiseResolve(kt){return Promise.resolve(kt)},ReflectApply:Reflect.apply,RegExpPrototypeTest(kt,At){return kt.test(At)},SafeSet:Set,String,StringPrototypeSlice(kt,At,xt){return kt.slice(At,xt)},StringPrototypeToLowerCase(kt){return kt.toLowerCase()},StringPrototypeToUpperCase(kt){return kt.toUpperCase()},StringPrototypeTrim(kt){return kt.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(kt,At,xt){return kt.set(At,xt)},Boolean,Uint8Array},util$2={exports:{}},browser$1={exports:{}},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser$1.exports;hasRequiredBrowser=1;const{AbortController:kt,AbortSignal:At}=typeof self<"u"?self:typeof window<"u"?window:void 0;return browser$1.exports=kt,browser$1.exports.AbortSignal=At,browser$1.exports.default=kt,browser$1.exports}(function(kt){const At=buffer$2,{kResistStopPropagation:xt,SymbolDispose:Bt}=primordials$1,Nt=globalThis.AbortSignal||requireBrowser().AbortSignal,jt=globalThis.AbortController||requireBrowser().AbortController,Ut=Object.getPrototypeOf(async function(){}).constructor,Lt=globalThis.Blob||At.Blob,Ht=typeof Lt<"u"?function(Qt){return Qt instanceof Lt}:function(Qt){return!1},Vt=(Jt,Qt)=>{if(Jt!==void 0&&(Jt===null||typeof Jt!="object"||!("aborted"in Jt)))throw new ERR_INVALID_ARG_TYPE(Qt,"AbortSignal",Jt)},zt=(Jt,Qt)=>{if(typeof Jt!="function")throw new ERR_INVALID_ARG_TYPE(Qt,"Function",Jt)};class Wt extends Error{constructor(Qt){if(!Array.isArray(Qt))throw new TypeError(`Expected input to be an Array, got ${typeof Qt}`);let Xt="";for(let tr=0;tr<Qt.length;tr++)Xt+=`    ${Qt[tr].stack}
`;super(Xt),this.name="AggregateError",this.errors=Qt}}kt.exports={AggregateError:Wt,kEmptyObject:Object.freeze({}),once(Jt){let Qt=!1;return function(...Xt){Qt||(Qt=!0,Jt.apply(this,Xt))}},createDeferredPromise:function(){let Jt,Qt;return{promise:new Promise((tr,rr)=>{Jt=tr,Qt=rr}),resolve:Jt,reject:Qt}},promisify(Jt){return new Promise((Qt,Xt)=>{Jt((tr,...rr)=>tr?Xt(tr):Qt(...rr))})},debuglog(){return function(){}},format(Jt,...Qt){return Jt.replace(/%([sdifj])/g,function(...[Xt,tr]){const rr=Qt.shift();return tr==="f"?rr.toFixed(6):tr==="j"?JSON.stringify(rr):tr==="s"&&typeof rr=="object"?`${rr.constructor!==Object?rr.constructor.name:""} {}`.trim():rr.toString()})},inspect(Jt){switch(typeof Jt){case"string":if(Jt.includes("'"))if(Jt.includes('"')){if(!Jt.includes("`")&&!Jt.includes("${"))return`\`${Jt}\``}else return`"${Jt}"`;return`'${Jt}'`;case"number":return isNaN(Jt)?"NaN":Object.is(Jt,-0)?String(Jt):Jt;case"bigint":return`${String(Jt)}n`;case"boolean":case"undefined":return String(Jt);case"object":return"{}"}},types:{isAsyncFunction(Jt){return Jt instanceof Ut},isArrayBufferView(Jt){return ArrayBuffer.isView(Jt)}},isBlob:Ht,deprecate(Jt,Qt){return Jt},addAbortListener:eventsExports.addAbortListener||function(Qt,Xt){if(Qt===void 0)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",Qt);Vt(Qt,"signal"),zt(Xt,"listener");let tr;return Qt.aborted?queueMicrotask(()=>Xt()):(Qt.addEventListener("abort",Xt,{__proto__:null,once:!0,[xt]:!0}),tr=()=>{Qt.removeEventListener("abort",Xt)}),{__proto__:null,[Bt](){var rr;(rr=tr)===null||rr===void 0||rr()}}},AbortSignalAny:Nt.any||function(Qt){if(Qt.length===1)return Qt[0];const Xt=new jt,tr=()=>Xt.abort();return Qt.forEach(rr=>{Vt(rr,"signals"),rr.addEventListener("abort",tr,{once:!0})}),Xt.signal.addEventListener("abort",()=>{Qt.forEach(rr=>rr.removeEventListener("abort",tr))},{once:!0}),Xt.signal}},kt.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(util$2);var utilExports$1=util$2.exports,operators$1={};const{format:format$6,inspect:inspect$3,AggregateError:CustomAggregateError$1}=utilExports$1,AggregateError$2=globalThis.AggregateError||CustomAggregateError$1,kIsNodeError$1=Symbol("kIsNodeError"),kTypes$1=["string","function","number","object","Function","Object","boolean","bigint","symbol"],classRegExp$1=/^([A-Z][a-z0-9]*)+$/,nodeInternalPrefix$1="__node_internal_",codes$3={};function assert$1(kt,At){if(!kt)throw new codes$3.ERR_INTERNAL_ASSERTION(At)}function addNumericalSeparator$1(kt){let At="",xt=kt.length;const Bt=kt[0]==="-"?1:0;for(;xt>=Bt+4;xt-=3)At=`_${kt.slice(xt-3,xt)}${At}`;return`${kt.slice(0,xt)}${At}`}function getMessage$1(kt,At,xt){if(typeof At=="function")return assert$1(At.length<=xt.length,`Code: ${kt}; The provided arguments length (${xt.length}) does not match the required ones (${At.length}).`),At(...xt);const Bt=(At.match(/%[dfijoOs]/g)||[]).length;return assert$1(Bt===xt.length,`Code: ${kt}; The provided arguments length (${xt.length}) does not match the required ones (${Bt}).`),xt.length===0?At:format$6(At,...xt)}function E$2(kt,At,xt){xt||(xt=Error);class Bt extends xt{constructor(...jt){super(getMessage$1(kt,At,jt))}toString(){return`${this.name} [${kt}]: ${this.message}`}}Object.defineProperties(Bt.prototype,{name:{value:xt.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${kt}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),Bt.prototype.code=kt,Bt.prototype[kIsNodeError$1]=!0,codes$3[kt]=Bt}function hideStackFrames$3(kt){const At=nodeInternalPrefix$1+kt.name;return Object.defineProperty(kt,"name",{value:At}),kt}function aggregateTwoErrors$5(kt,At){if(kt&&At&&kt!==At){if(Array.isArray(At.errors))return At.errors.push(kt),At;const xt=new AggregateError$2([At,kt],At.message);return xt.code=At.code,xt}return kt||At}let AbortError$e=class extends Error{constructor(At="The operation was aborted",xt=void 0){if(xt!==void 0&&typeof xt!="object")throw new codes$3.ERR_INVALID_ARG_TYPE("options","Object",xt);super(At,xt),this.code="ABORT_ERR",this.name="AbortError"}};E$2("ERR_ASSERTION","%s",Error);E$2("ERR_INVALID_ARG_TYPE",(kt,At,xt)=>{assert$1(typeof kt=="string","'name' must be a string"),Array.isArray(At)||(At=[At]);let Bt="The ";kt.endsWith(" argument")?Bt+=`${kt} `:Bt+=`"${kt}" ${kt.includes(".")?"property":"argument"} `,Bt+="must be ";const Nt=[],jt=[],Ut=[];for(const Ht of At)assert$1(typeof Ht=="string","All expected entries have to be of type string"),kTypes$1.includes(Ht)?Nt.push(Ht.toLowerCase()):classRegExp$1.test(Ht)?jt.push(Ht):(assert$1(Ht!=="object",'The value "object" should be written as "Object"'),Ut.push(Ht));if(jt.length>0){const Ht=Nt.indexOf("object");Ht!==-1&&(Nt.splice(Nt,Ht,1),jt.push("Object"))}if(Nt.length>0){switch(Nt.length){case 1:Bt+=`of type ${Nt[0]}`;break;case 2:Bt+=`one of type ${Nt[0]} or ${Nt[1]}`;break;default:{const Ht=Nt.pop();Bt+=`one of type ${Nt.join(", ")}, or ${Ht}`}}(jt.length>0||Ut.length>0)&&(Bt+=" or ")}if(jt.length>0){switch(jt.length){case 1:Bt+=`an instance of ${jt[0]}`;break;case 2:Bt+=`an instance of ${jt[0]} or ${jt[1]}`;break;default:{const Ht=jt.pop();Bt+=`an instance of ${jt.join(", ")}, or ${Ht}`}}Ut.length>0&&(Bt+=" or ")}switch(Ut.length){case 0:break;case 1:Ut[0].toLowerCase()!==Ut[0]&&(Bt+="an "),Bt+=`${Ut[0]}`;break;case 2:Bt+=`one of ${Ut[0]} or ${Ut[1]}`;break;default:{const Ht=Ut.pop();Bt+=`one of ${Ut.join(", ")}, or ${Ht}`}}if(xt==null)Bt+=`. Received ${xt}`;else if(typeof xt=="function"&&xt.name)Bt+=`. Received function ${xt.name}`;else if(typeof xt=="object"){var Lt;if((Lt=xt.constructor)!==null&&Lt!==void 0&&Lt.name)Bt+=`. Received an instance of ${xt.constructor.name}`;else{const Ht=inspect$3(xt,{depth:-1});Bt+=`. Received ${Ht}`}}else{let Ht=inspect$3(xt,{colors:!1});Ht.length>25&&(Ht=`${Ht.slice(0,25)}...`),Bt+=`. Received type ${typeof xt} (${Ht})`}return Bt},TypeError);E$2("ERR_INVALID_ARG_VALUE",(kt,At,xt="is invalid")=>{let Bt=inspect$3(At);return Bt.length>128&&(Bt=Bt.slice(0,128)+"..."),`The ${kt.includes(".")?"property":"argument"} '${kt}' ${xt}. Received ${Bt}`},TypeError);E$2("ERR_INVALID_RETURN_VALUE",(kt,At,xt)=>{var Bt;const Nt=xt!=null&&(Bt=xt.constructor)!==null&&Bt!==void 0&&Bt.name?`instance of ${xt.constructor.name}`:`type ${typeof xt}`;return`Expected ${kt} to be returned from the "${At}" function but got ${Nt}.`},TypeError);E$2("ERR_MISSING_ARGS",(...kt)=>{assert$1(kt.length>0,"At least one arg needs to be specified");let At;const xt=kt.length;switch(kt=(Array.isArray(kt)?kt:[kt]).map(Bt=>`"${Bt}"`).join(" or "),xt){case 1:At+=`The ${kt[0]} argument`;break;case 2:At+=`The ${kt[0]} and ${kt[1]} arguments`;break;default:{const Bt=kt.pop();At+=`The ${kt.join(", ")}, and ${Bt} arguments`}break}return`${At} must be specified`},TypeError);E$2("ERR_OUT_OF_RANGE",(kt,At,xt)=>{assert$1(At,'Missing "range" argument');let Bt;return Number.isInteger(xt)&&Math.abs(xt)>2**32?Bt=addNumericalSeparator$1(String(xt)):typeof xt=="bigint"?(Bt=String(xt),(xt>2n**32n||xt<-(2n**32n))&&(Bt=addNumericalSeparator$1(Bt)),Bt+="n"):Bt=inspect$3(xt),`The value of "${kt}" is out of range. It must be ${At}. Received ${Bt}`},RangeError);E$2("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);E$2("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);E$2("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);E$2("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);E$2("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);E$2("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);E$2("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);E$2("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);E$2("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);E$2("ERR_STREAM_WRITE_AFTER_END","write after end",Error);E$2("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var errors$2={AbortError:AbortError$e,aggregateTwoErrors:hideStackFrames$3(aggregateTwoErrors$5),hideStackFrames:hideStackFrames$3,codes:codes$3};const{ArrayIsArray:ArrayIsArray$5,ArrayPrototypeIncludes:ArrayPrototypeIncludes$1,ArrayPrototypeJoin:ArrayPrototypeJoin$1,ArrayPrototypeMap:ArrayPrototypeMap$1,NumberIsInteger:NumberIsInteger$3,NumberIsNaN:NumberIsNaN$3,NumberMAX_SAFE_INTEGER:NumberMAX_SAFE_INTEGER$1,NumberMIN_SAFE_INTEGER:NumberMIN_SAFE_INTEGER$1,NumberParseInt:NumberParseInt$1,ObjectPrototypeHasOwnProperty:ObjectPrototypeHasOwnProperty$1,RegExpPrototypeExec:RegExpPrototypeExec$1,String:String$2,StringPrototypeToUpperCase:StringPrototypeToUpperCase$1,StringPrototypeTrim:StringPrototypeTrim$1}=primordials$1,{hideStackFrames:hideStackFrames$2,codes:{ERR_SOCKET_BAD_PORT:ERR_SOCKET_BAD_PORT$1,ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$a,ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$7,ERR_OUT_OF_RANGE:ERR_OUT_OF_RANGE$3,ERR_UNKNOWN_SIGNAL:ERR_UNKNOWN_SIGNAL$1}}=errors$2,{normalizeEncoding:normalizeEncoding$1}=utilExports$1,{isAsyncFunction:isAsyncFunction$1,isArrayBufferView:isArrayBufferView$1}=utilExports$1.types,signals$1={};function isInt32$1(kt){return kt===(kt|0)}function isUint32$1(kt){return kt===kt>>>0}const octalReg$1=/^[0-7]+$/,modeDesc$1="must be a 32-bit unsigned integer or an octal string";function parseFileMode$1(kt,At,xt){if(typeof kt>"u"&&(kt=xt),typeof kt=="string"){if(RegExpPrototypeExec$1(octalReg$1,kt)===null)throw new ERR_INVALID_ARG_VALUE$7(At,kt,modeDesc$1);kt=NumberParseInt$1(kt,8)}return validateUint32$1(kt,At),kt}const validateInteger$4=hideStackFrames$2((kt,At,xt=NumberMIN_SAFE_INTEGER$1,Bt=NumberMAX_SAFE_INTEGER$1)=>{if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$a(At,"number",kt);if(!NumberIsInteger$3(kt))throw new ERR_OUT_OF_RANGE$3(At,"an integer",kt);if(kt<xt||kt>Bt)throw new ERR_OUT_OF_RANGE$3(At,`>= ${xt} && <= ${Bt}`,kt)}),validateInt32$1=hideStackFrames$2((kt,At,xt=-2147483648,Bt=2147483647)=>{if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$a(At,"number",kt);if(!NumberIsInteger$3(kt))throw new ERR_OUT_OF_RANGE$3(At,"an integer",kt);if(kt<xt||kt>Bt)throw new ERR_OUT_OF_RANGE$3(At,`>= ${xt} && <= ${Bt}`,kt)}),validateUint32$1=hideStackFrames$2((kt,At,xt=!1)=>{if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$a(At,"number",kt);if(!NumberIsInteger$3(kt))throw new ERR_OUT_OF_RANGE$3(At,"an integer",kt);const Bt=xt?1:0,Nt=4294967295;if(kt<Bt||kt>Nt)throw new ERR_OUT_OF_RANGE$3(At,`>= ${Bt} && <= ${Nt}`,kt)});function validateString$1(kt,At){if(typeof kt!="string")throw new ERR_INVALID_ARG_TYPE$a(At,"string",kt)}function validateNumber$1(kt,At,xt=void 0,Bt){if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$a(At,"number",kt);if(xt!=null&&kt<xt||Bt!=null&&kt>Bt||(xt!=null||Bt!=null)&&NumberIsNaN$3(kt))throw new ERR_OUT_OF_RANGE$3(At,`${xt!=null?`>= ${xt}`:""}${xt!=null&&Bt!=null?" && ":""}${Bt!=null?`<= ${Bt}`:""}`,kt)}const validateOneOf$1=hideStackFrames$2((kt,At,xt)=>{if(!ArrayPrototypeIncludes$1(xt,kt)){const Nt="must be one of: "+ArrayPrototypeJoin$1(ArrayPrototypeMap$1(xt,jt=>typeof jt=="string"?`'${jt}'`:String$2(jt)),", ");throw new ERR_INVALID_ARG_VALUE$7(At,kt,Nt)}});function validateBoolean$3(kt,At){if(typeof kt!="boolean")throw new ERR_INVALID_ARG_TYPE$a(At,"boolean",kt)}function getOwnPropertyValueOrDefault$1(kt,At,xt){return kt==null||!ObjectPrototypeHasOwnProperty$1(kt,At)?xt:kt[At]}const validateObject$6=hideStackFrames$2((kt,At,xt=null)=>{const Bt=getOwnPropertyValueOrDefault$1(xt,"allowArray",!1),Nt=getOwnPropertyValueOrDefault$1(xt,"allowFunction",!1);if(!getOwnPropertyValueOrDefault$1(xt,"nullable",!1)&&kt===null||!Bt&&ArrayIsArray$5(kt)||typeof kt!="object"&&(!Nt||typeof kt!="function"))throw new ERR_INVALID_ARG_TYPE$a(At,"Object",kt)}),validateDictionary$1=hideStackFrames$2((kt,At)=>{if(kt!=null&&typeof kt!="object"&&typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$a(At,"a dictionary",kt)}),validateArray$2=hideStackFrames$2((kt,At,xt=0)=>{if(!ArrayIsArray$5(kt))throw new ERR_INVALID_ARG_TYPE$a(At,"Array",kt);if(kt.length<xt){const Bt=`must be longer than ${xt}`;throw new ERR_INVALID_ARG_VALUE$7(At,kt,Bt)}});function validateStringArray$1(kt,At){validateArray$2(kt,At);for(let xt=0;xt<kt.length;xt++)validateString$1(kt[xt],`${At}[${xt}]`)}function validateBooleanArray$1(kt,At){validateArray$2(kt,At);for(let xt=0;xt<kt.length;xt++)validateBoolean$3(kt[xt],`${At}[${xt}]`)}function validateAbortSignalArray(kt,At){validateArray$2(kt,At);for(let xt=0;xt<kt.length;xt++){const Bt=kt[xt],Nt=`${At}[${xt}]`;if(Bt==null)throw new ERR_INVALID_ARG_TYPE$a(Nt,"AbortSignal",Bt);validateAbortSignal$7(Bt,Nt)}}function validateSignalName$1(kt,At="signal"){if(validateString$1(kt,At),signals$1[kt]===void 0)throw signals$1[StringPrototypeToUpperCase$1(kt)]!==void 0?new ERR_UNKNOWN_SIGNAL$1(kt+" (signals must use all capital letters)"):new ERR_UNKNOWN_SIGNAL$1(kt)}const validateBuffer$1=hideStackFrames$2((kt,At="buffer")=>{if(!isArrayBufferView$1(kt))throw new ERR_INVALID_ARG_TYPE$a(At,["Buffer","TypedArray","DataView"],kt)});function validateEncoding$1(kt,At){const xt=normalizeEncoding$1(At),Bt=kt.length;if(xt==="hex"&&Bt%2!==0)throw new ERR_INVALID_ARG_VALUE$7("encoding",At,`is invalid for data of length ${Bt}`)}function validatePort$1(kt,At="Port",xt=!0){if(typeof kt!="number"&&typeof kt!="string"||typeof kt=="string"&&StringPrototypeTrim$1(kt).length===0||+kt!==+kt>>>0||kt>65535||kt===0&&!xt)throw new ERR_SOCKET_BAD_PORT$1(At,kt,xt);return kt|0}const validateAbortSignal$7=hideStackFrames$2((kt,At)=>{if(kt!==void 0&&(kt===null||typeof kt!="object"||!("aborted"in kt)))throw new ERR_INVALID_ARG_TYPE$a(At,"AbortSignal",kt)}),validateFunction$6=hideStackFrames$2((kt,At)=>{if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$a(At,"Function",kt)}),validatePlainFunction$1=hideStackFrames$2((kt,At)=>{if(typeof kt!="function"||isAsyncFunction$1(kt))throw new ERR_INVALID_ARG_TYPE$a(At,"Function",kt)}),validateUndefined$1=hideStackFrames$2((kt,At)=>{if(kt!==void 0)throw new ERR_INVALID_ARG_TYPE$a(At,"undefined",kt)});function validateUnion$2(kt,At,xt){if(!ArrayPrototypeIncludes$1(xt,kt))throw new ERR_INVALID_ARG_TYPE$a(At,`('${ArrayPrototypeJoin$1(xt,"|")}')`,kt)}const linkValueRegExp$1=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function validateLinkHeaderFormat$1(kt,At){if(typeof kt>"u"||!RegExpPrototypeExec$1(linkValueRegExp$1,kt))throw new ERR_INVALID_ARG_VALUE$7(At,kt,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function validateLinkHeaderValue$1(kt){if(typeof kt=="string")return validateLinkHeaderFormat$1(kt,"hints"),kt;if(ArrayIsArray$5(kt)){const At=kt.length;let xt="";if(At===0)return xt;for(let Bt=0;Bt<At;Bt++){const Nt=kt[Bt];validateLinkHeaderFormat$1(Nt,"hints"),xt+=Nt,Bt!==At-1&&(xt+=", ")}return xt}throw new ERR_INVALID_ARG_VALUE$7("hints",kt,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var validators$1={isInt32:isInt32$1,isUint32:isUint32$1,parseFileMode:parseFileMode$1,validateArray:validateArray$2,validateStringArray:validateStringArray$1,validateBooleanArray:validateBooleanArray$1,validateAbortSignalArray,validateBoolean:validateBoolean$3,validateBuffer:validateBuffer$1,validateDictionary:validateDictionary$1,validateEncoding:validateEncoding$1,validateFunction:validateFunction$6,validateInt32:validateInt32$1,validateInteger:validateInteger$4,validateNumber:validateNumber$1,validateObject:validateObject$6,validateOneOf:validateOneOf$1,validatePlainFunction:validatePlainFunction$1,validatePort:validatePort$1,validateSignalName:validateSignalName$1,validateString:validateString$1,validateUint32:validateUint32$1,validateUndefined:validateUndefined$1,validateUnion:validateUnion$2,validateAbortSignal:validateAbortSignal$7,validateLinkHeaderValue:validateLinkHeaderValue$1},endOfStream$1={exports:{}};const{SymbolAsyncIterator:SymbolAsyncIterator$5,SymbolIterator:SymbolIterator$5,SymbolFor:SymbolFor$1}=primordials$1,kIsDestroyed$1=SymbolFor$1("nodejs.stream.destroyed"),kIsErrored$1=SymbolFor$1("nodejs.stream.errored"),kIsReadable$1=SymbolFor$1("nodejs.stream.readable"),kIsWritable=SymbolFor$1("nodejs.stream.writable"),kIsDisturbed$1=SymbolFor$1("nodejs.stream.disturbed"),kIsClosedPromise$3=SymbolFor$1("nodejs.webstream.isClosedPromise"),kControllerErrorFunction$1=SymbolFor$1("nodejs.webstream.controllerErrorFunction");function isReadableNodeStream$5(kt,At=!1){var xt;return!!(kt&&typeof kt.pipe=="function"&&typeof kt.on=="function"&&(!At||typeof kt.pause=="function"&&typeof kt.resume=="function")&&(!kt._writableState||((xt=kt._readableState)===null||xt===void 0?void 0:xt.readable)!==!1)&&(!kt._writableState||kt._readableState))}function isWritableNodeStream$3(kt){var At;return!!(kt&&typeof kt.write=="function"&&typeof kt.on=="function"&&(!kt._readableState||((At=kt._writableState)===null||At===void 0?void 0:At.writable)!==!1))}function isDuplexNodeStream$1(kt){return!!(kt&&typeof kt.pipe=="function"&&kt._readableState&&typeof kt.on=="function"&&typeof kt.write=="function")}function isNodeStream$9(kt){return kt&&(kt._readableState||kt._writableState||typeof kt.write=="function"&&typeof kt.on=="function"||typeof kt.pipe=="function"&&typeof kt.on=="function")}function isReadableStream$7(kt){return!!(kt&&!isNodeStream$9(kt)&&typeof kt.pipeThrough=="function"&&typeof kt.getReader=="function"&&typeof kt.cancel=="function")}function isWritableStream$5(kt){return!!(kt&&!isNodeStream$9(kt)&&typeof kt.getWriter=="function"&&typeof kt.abort=="function")}function isTransformStream$5(kt){return!!(kt&&!isNodeStream$9(kt)&&typeof kt.readable=="object"&&typeof kt.writable=="object")}function isWebStream$5(kt){return isReadableStream$7(kt)||isWritableStream$5(kt)||isTransformStream$5(kt)}function isIterable$4(kt,At){return kt==null?!1:At===!0?typeof kt[SymbolAsyncIterator$5]=="function":At===!1?typeof kt[SymbolIterator$5]=="function":typeof kt[SymbolAsyncIterator$5]=="function"||typeof kt[SymbolIterator$5]=="function"}function isDestroyed$3(kt){if(!isNodeStream$9(kt))return null;const At=kt._writableState,xt=kt._readableState,Bt=At||xt;return!!(kt.destroyed||kt[kIsDestroyed$1]||Bt!=null&&Bt.destroyed)}function isWritableEnded$1(kt){if(!isWritableNodeStream$3(kt))return null;if(kt.writableEnded===!0)return!0;const At=kt._writableState;return At!=null&&At.errored?!1:typeof(At==null?void 0:At.ended)!="boolean"?null:At.ended}function isWritableFinished$3(kt,At){if(!isWritableNodeStream$3(kt))return null;if(kt.writableFinished===!0)return!0;const xt=kt._writableState;return xt!=null&&xt.errored?!1:typeof(xt==null?void 0:xt.finished)!="boolean"?null:!!(xt.finished||At===!1&&xt.ended===!0&&xt.length===0)}function isReadableEnded$2(kt){if(!isReadableNodeStream$5(kt))return null;if(kt.readableEnded===!0)return!0;const At=kt._readableState;return!At||At.errored?!1:typeof(At==null?void 0:At.ended)!="boolean"?null:At.ended}function isReadableFinished$4(kt,At){if(!isReadableNodeStream$5(kt))return null;const xt=kt._readableState;return xt!=null&&xt.errored?!1:typeof(xt==null?void 0:xt.endEmitted)!="boolean"?null:!!(xt.endEmitted||At===!1&&xt.ended===!0&&xt.length===0)}function isReadable$7(kt){return kt&&kt[kIsReadable$1]!=null?kt[kIsReadable$1]:typeof(kt==null?void 0:kt.readable)!="boolean"?null:isDestroyed$3(kt)?!1:isReadableNodeStream$5(kt)&&kt.readable&&!isReadableFinished$4(kt)}function isWritable$7(kt){return kt&&kt[kIsWritable]!=null?kt[kIsWritable]:typeof(kt==null?void 0:kt.writable)!="boolean"?null:isDestroyed$3(kt)?!1:isWritableNodeStream$3(kt)&&kt.writable&&!isWritableEnded$1(kt)}function isFinished$3(kt,At){return isNodeStream$9(kt)?isDestroyed$3(kt)?!0:!((At==null?void 0:At.readable)!==!1&&isReadable$7(kt)||(At==null?void 0:At.writable)!==!1&&isWritable$7(kt)):null}function isWritableErrored$3(kt){var At,xt;return isNodeStream$9(kt)?kt.writableErrored?kt.writableErrored:(At=(xt=kt._writableState)===null||xt===void 0?void 0:xt.errored)!==null&&At!==void 0?At:null:null}function isReadableErrored$3(kt){var At,xt;return isNodeStream$9(kt)?kt.readableErrored?kt.readableErrored:(At=(xt=kt._readableState)===null||xt===void 0?void 0:xt.errored)!==null&&At!==void 0?At:null:null}function isClosed$3(kt){if(!isNodeStream$9(kt))return null;if(typeof kt.closed=="boolean")return kt.closed;const At=kt._writableState,xt=kt._readableState;return typeof(At==null?void 0:At.closed)=="boolean"||typeof(xt==null?void 0:xt.closed)=="boolean"?(At==null?void 0:At.closed)||(xt==null?void 0:xt.closed):typeof kt._closed=="boolean"&&isOutgoingMessage$1(kt)?kt._closed:null}function isOutgoingMessage$1(kt){return typeof kt._closed=="boolean"&&typeof kt._defaultKeepAlive=="boolean"&&typeof kt._removedConnection=="boolean"&&typeof kt._removedContLen=="boolean"}function isServerResponse$1(kt){return typeof kt._sent100=="boolean"&&isOutgoingMessage$1(kt)}function isServerRequest$3(kt){var At;return typeof kt._consuming=="boolean"&&typeof kt._dumped=="boolean"&&((At=kt.req)===null||At===void 0?void 0:At.upgradeOrConnect)===void 0}function willEmitClose$1(kt){if(!isNodeStream$9(kt))return null;const At=kt._writableState,xt=kt._readableState,Bt=At||xt;return!Bt&&isServerResponse$1(kt)||!!(Bt&&Bt.autoDestroy&&Bt.emitClose&&Bt.closed===!1)}function isDisturbed$1(kt){var At;return!!(kt&&((At=kt[kIsDisturbed$1])!==null&&At!==void 0?At:kt.readableDidRead||kt.readableAborted))}function isErrored$1(kt){var At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt;return!!(kt&&((At=(xt=(Bt=(Nt=(jt=(Ut=kt[kIsErrored$1])!==null&&Ut!==void 0?Ut:kt.readableErrored)!==null&&jt!==void 0?jt:kt.writableErrored)!==null&&Nt!==void 0?Nt:(Lt=kt._readableState)===null||Lt===void 0?void 0:Lt.errorEmitted)!==null&&Bt!==void 0?Bt:(Ht=kt._writableState)===null||Ht===void 0?void 0:Ht.errorEmitted)!==null&&xt!==void 0?xt:(Vt=kt._readableState)===null||Vt===void 0?void 0:Vt.errored)!==null&&At!==void 0?At:!((zt=kt._writableState)===null||zt===void 0)&&zt.errored))}var utils$2={isDestroyed:isDestroyed$3,kIsDestroyed:kIsDestroyed$1,isDisturbed:isDisturbed$1,kIsDisturbed:kIsDisturbed$1,isErrored:isErrored$1,kIsErrored:kIsErrored$1,isReadable:isReadable$7,kIsReadable:kIsReadable$1,kIsClosedPromise:kIsClosedPromise$3,kControllerErrorFunction:kControllerErrorFunction$1,kIsWritable,isClosed:isClosed$3,isDuplexNodeStream:isDuplexNodeStream$1,isFinished:isFinished$3,isIterable:isIterable$4,isReadableNodeStream:isReadableNodeStream$5,isReadableStream:isReadableStream$7,isReadableEnded:isReadableEnded$2,isReadableFinished:isReadableFinished$4,isReadableErrored:isReadableErrored$3,isNodeStream:isNodeStream$9,isWebStream:isWebStream$5,isWritable:isWritable$7,isWritableNodeStream:isWritableNodeStream$3,isWritableStream:isWritableStream$5,isWritableEnded:isWritableEnded$1,isWritableFinished:isWritableFinished$3,isWritableErrored:isWritableErrored$3,isServerRequest:isServerRequest$3,isServerResponse:isServerResponse$1,willEmitClose:willEmitClose$1,isTransformStream:isTransformStream$5};const process$7=browserExports$3,{AbortError:AbortError$d,codes:codes$2}=errors$2,{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$9,ERR_STREAM_PREMATURE_CLOSE:ERR_STREAM_PREMATURE_CLOSE$3}=codes$2,{kEmptyObject:kEmptyObject$1,once:once$3}=utilExports$1,{validateAbortSignal:validateAbortSignal$6,validateFunction:validateFunction$5,validateObject:validateObject$5,validateBoolean:validateBoolean$2}=validators$1,{Promise:Promise$6,PromisePrototypeThen:PromisePrototypeThen$5,SymbolDispose:SymbolDispose$1}=primordials$1,{isClosed:isClosed$2,isReadable:isReadable$6,isReadableNodeStream:isReadableNodeStream$4,isReadableStream:isReadableStream$6,isReadableFinished:isReadableFinished$3,isReadableErrored:isReadableErrored$2,isWritable:isWritable$6,isWritableNodeStream:isWritableNodeStream$2,isWritableStream:isWritableStream$4,isWritableFinished:isWritableFinished$2,isWritableErrored:isWritableErrored$2,isNodeStream:isNodeStream$8,willEmitClose:_willEmitClose$1,kIsClosedPromise:kIsClosedPromise$2}=utils$2;let addAbortListener$1;function isRequest$3(kt){return kt.setHeader&&typeof kt.abort=="function"}const nop$1=()=>{};function eos$5(kt,At,xt){var Bt,Nt;if(arguments.length===2?(xt=At,At=kEmptyObject$1):At==null?At=kEmptyObject$1:validateObject$5(At,"options"),validateFunction$5(xt,"callback"),validateAbortSignal$6(At.signal,"options.signal"),xt=once$3(xt),isReadableStream$6(kt)||isWritableStream$4(kt))return eosWeb$1(kt,At,xt);if(!isNodeStream$8(kt))throw new ERR_INVALID_ARG_TYPE$9("stream",["ReadableStream","WritableStream","Stream"],kt);const jt=(Bt=At.readable)!==null&&Bt!==void 0?Bt:isReadableNodeStream$4(kt),Ut=(Nt=At.writable)!==null&&Nt!==void 0?Nt:isWritableNodeStream$2(kt),Lt=kt._writableState,Ht=kt._readableState,Vt=()=>{kt.writable||Jt()};let zt=_willEmitClose$1(kt)&&isReadableNodeStream$4(kt)===jt&&isWritableNodeStream$2(kt)===Ut,Wt=isWritableFinished$2(kt,!1);const Jt=()=>{Wt=!0,kt.destroyed&&(zt=!1),!(zt&&(!kt.readable||jt))&&(!jt||Qt)&&xt.call(kt)};let Qt=isReadableFinished$3(kt,!1);const Xt=()=>{Qt=!0,kt.destroyed&&(zt=!1),!(zt&&(!kt.writable||Ut))&&(!Ut||Wt)&&xt.call(kt)},tr=yr=>{xt.call(kt,yr)};let rr=isClosed$2(kt);const nr=()=>{rr=!0;const yr=isWritableErrored$2(kt)||isReadableErrored$2(kt);if(yr&&typeof yr!="boolean")return xt.call(kt,yr);if(jt&&!Qt&&isReadableNodeStream$4(kt,!0)&&!isReadableFinished$3(kt,!1))return xt.call(kt,new ERR_STREAM_PREMATURE_CLOSE$3);if(Ut&&!Wt&&!isWritableFinished$2(kt,!1))return xt.call(kt,new ERR_STREAM_PREMATURE_CLOSE$3);xt.call(kt)},ar=()=>{rr=!0;const yr=isWritableErrored$2(kt)||isReadableErrored$2(kt);if(yr&&typeof yr!="boolean")return xt.call(kt,yr);xt.call(kt)},ir=()=>{kt.req.on("finish",Jt)};isRequest$3(kt)?(kt.on("complete",Jt),zt||kt.on("abort",nr),kt.req?ir():kt.on("request",ir)):Ut&&!Lt&&(kt.on("end",Vt),kt.on("close",Vt)),!zt&&typeof kt.aborted=="boolean"&&kt.on("aborted",nr),kt.on("end",Xt),kt.on("finish",Jt),At.error!==!1&&kt.on("error",tr),kt.on("close",nr),rr?process$7.nextTick(nr):Lt!=null&&Lt.errorEmitted||Ht!=null&&Ht.errorEmitted?zt||process$7.nextTick(ar):(!jt&&(!zt||isReadable$6(kt))&&(Wt||isWritable$6(kt)===!1)||!Ut&&(!zt||isWritable$6(kt))&&(Qt||isReadable$6(kt)===!1)||Ht&&kt.req&&kt.aborted)&&process$7.nextTick(ar);const lr=()=>{xt=nop$1,kt.removeListener("aborted",nr),kt.removeListener("complete",Jt),kt.removeListener("abort",nr),kt.removeListener("request",ir),kt.req&&kt.req.removeListener("finish",Jt),kt.removeListener("end",Vt),kt.removeListener("close",Vt),kt.removeListener("finish",Jt),kt.removeListener("end",Xt),kt.removeListener("error",tr),kt.removeListener("close",nr)};if(At.signal&&!rr){const yr=()=>{const Sr=xt;lr(),Sr.call(kt,new AbortError$d(void 0,{cause:At.signal.reason}))};if(At.signal.aborted)process$7.nextTick(yr);else{addAbortListener$1=addAbortListener$1||utilExports$1.addAbortListener;const Sr=addAbortListener$1(At.signal,yr),Ar=xt;xt=once$3((...Dr)=>{Sr[SymbolDispose$1](),Ar.apply(kt,Dr)})}}return lr}function eosWeb$1(kt,At,xt){let Bt=!1,Nt=nop$1;if(At.signal)if(Nt=()=>{Bt=!0,xt.call(kt,new AbortError$d(void 0,{cause:At.signal.reason}))},At.signal.aborted)process$7.nextTick(Nt);else{addAbortListener$1=addAbortListener$1||utilExports$1.addAbortListener;const Ut=addAbortListener$1(At.signal,Nt),Lt=xt;xt=once$3((...Ht)=>{Ut[SymbolDispose$1](),Lt.apply(kt,Ht)})}const jt=(...Ut)=>{Bt||process$7.nextTick(()=>xt.apply(kt,Ut))};return PromisePrototypeThen$5(kt[kIsClosedPromise$2].promise,jt,jt),nop$1}function finished$3(kt,At){var xt;let Bt=!1;return At===null&&(At=kEmptyObject$1),(xt=At)!==null&&xt!==void 0&&xt.cleanup&&(validateBoolean$2(At.cleanup,"cleanup"),Bt=At.cleanup),new Promise$6((Nt,jt)=>{const Ut=eos$5(kt,At,Lt=>{Bt&&Ut(),Lt?jt(Lt):Nt()})})}endOfStream$1.exports=eos$5;endOfStream$1.exports.finished=finished$3;var endOfStreamExports$1=endOfStream$1.exports;const process$6=browserExports$3,{aggregateTwoErrors:aggregateTwoErrors$4,codes:{ERR_MULTIPLE_CALLBACK:ERR_MULTIPLE_CALLBACK$1},AbortError:AbortError$c}=errors$2,{Symbol:Symbol$7}=primordials$1,{kIsDestroyed,isDestroyed:isDestroyed$2,isFinished:isFinished$2,isServerRequest:isServerRequest$2}=utils$2,kDestroy$1=Symbol$7("kDestroy"),kConstruct$1=Symbol$7("kConstruct");function checkError$1(kt,At,xt){kt&&(kt.stack,At&&!At.errored&&(At.errored=kt),xt&&!xt.errored&&(xt.errored=kt))}function destroy$1(kt,At){const xt=this._readableState,Bt=this._writableState,Nt=Bt||xt;return Bt!=null&&Bt.destroyed||xt!=null&&xt.destroyed?(typeof At=="function"&&At(),this):(checkError$1(kt,Bt,xt),Bt&&(Bt.destroyed=!0),xt&&(xt.destroyed=!0),Nt.constructed?_destroy$1(this,kt,At):this.once(kDestroy$1,function(jt){_destroy$1(this,aggregateTwoErrors$4(jt,kt),At)}),this)}function _destroy$1(kt,At,xt){let Bt=!1;function Nt(jt){if(Bt)return;Bt=!0;const Ut=kt._readableState,Lt=kt._writableState;checkError$1(jt,Lt,Ut),Lt&&(Lt.closed=!0),Ut&&(Ut.closed=!0),typeof xt=="function"&&xt(jt),jt?process$6.nextTick(emitErrorCloseNT$1,kt,jt):process$6.nextTick(emitCloseNT$1,kt)}try{kt._destroy(At||null,Nt)}catch(jt){Nt(jt)}}function emitErrorCloseNT$1(kt,At){emitErrorNT$1(kt,At),emitCloseNT$1(kt)}function emitCloseNT$1(kt){const At=kt._readableState,xt=kt._writableState;xt&&(xt.closeEmitted=!0),At&&(At.closeEmitted=!0),(xt!=null&&xt.emitClose||At!=null&&At.emitClose)&&kt.emit("close")}function emitErrorNT$1(kt,At){const xt=kt._readableState,Bt=kt._writableState;Bt!=null&&Bt.errorEmitted||xt!=null&&xt.errorEmitted||(Bt&&(Bt.errorEmitted=!0),xt&&(xt.errorEmitted=!0),kt.emit("error",At))}function undestroy$1(){const kt=this._readableState,At=this._writableState;kt&&(kt.constructed=!0,kt.closed=!1,kt.closeEmitted=!1,kt.destroyed=!1,kt.errored=null,kt.errorEmitted=!1,kt.reading=!1,kt.ended=kt.readable===!1,kt.endEmitted=kt.readable===!1),At&&(At.constructed=!0,At.destroyed=!1,At.closed=!1,At.closeEmitted=!1,At.errored=null,At.errorEmitted=!1,At.finalCalled=!1,At.prefinished=!1,At.ended=At.writable===!1,At.ending=At.writable===!1,At.finished=At.writable===!1)}function errorOrDestroy$1(kt,At,xt){const Bt=kt._readableState,Nt=kt._writableState;if(Nt!=null&&Nt.destroyed||Bt!=null&&Bt.destroyed)return this;Bt!=null&&Bt.autoDestroy||Nt!=null&&Nt.autoDestroy?kt.destroy(At):At&&(At.stack,Nt&&!Nt.errored&&(Nt.errored=At),Bt&&!Bt.errored&&(Bt.errored=At),xt?process$6.nextTick(emitErrorNT$1,kt,At):emitErrorNT$1(kt,At))}function construct$1(kt,At){if(typeof kt._construct!="function")return;const xt=kt._readableState,Bt=kt._writableState;xt&&(xt.constructed=!1),Bt&&(Bt.constructed=!1),kt.once(kConstruct$1,At),!(kt.listenerCount(kConstruct$1)>1)&&process$6.nextTick(constructNT$1,kt)}function constructNT$1(kt){let At=!1;function xt(Bt){if(At){errorOrDestroy$1(kt,Bt??new ERR_MULTIPLE_CALLBACK$1);return}At=!0;const Nt=kt._readableState,jt=kt._writableState,Ut=jt||Nt;Nt&&(Nt.constructed=!0),jt&&(jt.constructed=!0),Ut.destroyed?kt.emit(kDestroy$1,Bt):Bt?errorOrDestroy$1(kt,Bt,!0):process$6.nextTick(emitConstructNT$1,kt)}try{kt._construct(Bt=>{process$6.nextTick(xt,Bt)})}catch(Bt){process$6.nextTick(xt,Bt)}}function emitConstructNT$1(kt){kt.emit(kConstruct$1)}function isRequest$2(kt){return(kt==null?void 0:kt.setHeader)&&typeof kt.abort=="function"}function emitCloseLegacy$1(kt){kt.emit("close")}function emitErrorCloseLegacy$1(kt,At){kt.emit("error",At),process$6.nextTick(emitCloseLegacy$1,kt)}function destroyer$5(kt,At){!kt||isDestroyed$2(kt)||(!At&&!isFinished$2(kt)&&(At=new AbortError$c),isServerRequest$2(kt)?(kt.socket=null,kt.destroy(At)):isRequest$2(kt)?kt.abort():isRequest$2(kt.req)?kt.req.abort():typeof kt.destroy=="function"?kt.destroy(At):typeof kt.close=="function"?kt.close():At?process$6.nextTick(emitErrorCloseLegacy$1,kt,At):process$6.nextTick(emitCloseLegacy$1,kt),kt.destroyed||(kt[kIsDestroyed]=!0))}var destroy_1$1={construct:construct$1,destroyer:destroyer$5,destroy:destroy$1,undestroy:undestroy$1,errorOrDestroy:errorOrDestroy$1};const{ArrayIsArray:ArrayIsArray$4,ObjectSetPrototypeOf:ObjectSetPrototypeOf$5}=primordials$1,{EventEmitter:EE$1}=eventsExports;function Stream$2(kt){EE$1.call(this,kt)}ObjectSetPrototypeOf$5(Stream$2.prototype,EE$1.prototype);ObjectSetPrototypeOf$5(Stream$2,EE$1);Stream$2.prototype.pipe=function(kt,At){const xt=this;function Bt(zt){kt.writable&&kt.write(zt)===!1&&xt.pause&&xt.pause()}xt.on("data",Bt);function Nt(){xt.readable&&xt.resume&&xt.resume()}kt.on("drain",Nt),!kt._isStdio&&(!At||At.end!==!1)&&(xt.on("end",Ut),xt.on("close",Lt));let jt=!1;function Ut(){jt||(jt=!0,kt.end())}function Lt(){jt||(jt=!0,typeof kt.destroy=="function"&&kt.destroy())}function Ht(zt){Vt(),EE$1.listenerCount(this,"error")===0&&this.emit("error",zt)}prependListener$1(xt,"error",Ht),prependListener$1(kt,"error",Ht);function Vt(){xt.removeListener("data",Bt),kt.removeListener("drain",Nt),xt.removeListener("end",Ut),xt.removeListener("close",Lt),xt.removeListener("error",Ht),kt.removeListener("error",Ht),xt.removeListener("end",Vt),xt.removeListener("close",Vt),kt.removeListener("close",Vt)}return xt.on("end",Vt),xt.on("close",Vt),kt.on("close",Vt),kt.emit("pipe",xt),kt};function prependListener$1(kt,At,xt){if(typeof kt.prependListener=="function")return kt.prependListener(At,xt);!kt._events||!kt._events[At]?kt.on(At,xt):ArrayIsArray$4(kt._events[At])?kt._events[At].unshift(xt):kt._events[At]=[xt,kt._events[At]]}var legacy$1={Stream:Stream$2,prependListener:prependListener$1},addAbortSignal$1={exports:{}};(function(kt){const{SymbolDispose:At}=primordials$1,{AbortError:xt,codes:Bt}=errors$2,{isNodeStream:Nt,isWebStream:jt,kControllerErrorFunction:Ut}=utils$2,Lt=endOfStreamExports$1,{ERR_INVALID_ARG_TYPE:Ht}=Bt;let Vt;const zt=(Wt,Jt)=>{if(typeof Wt!="object"||!("aborted"in Wt))throw new Ht(Jt,"AbortSignal",Wt)};kt.exports.addAbortSignal=function(Jt,Qt){if(zt(Jt,"signal"),!Nt(Qt)&&!jt(Qt))throw new Ht("stream",["ReadableStream","WritableStream","Stream"],Qt);return kt.exports.addAbortSignalNoValidate(Jt,Qt)},kt.exports.addAbortSignalNoValidate=function(Wt,Jt){if(typeof Wt!="object"||!("aborted"in Wt))return Jt;const Qt=Nt(Jt)?()=>{Jt.destroy(new xt(void 0,{cause:Wt.reason}))}:()=>{Jt[Ut](new xt(void 0,{cause:Wt.reason}))};if(Wt.aborted)Qt();else{Vt=Vt||utilExports$1.addAbortListener;const Xt=Vt(Wt,Qt);Lt(Jt,Xt[At])}return Jt}})(addAbortSignal$1);var addAbortSignalExports$1=addAbortSignal$1.exports;const{StringPrototypeSlice:StringPrototypeSlice$1,SymbolIterator:SymbolIterator$4,TypedArrayPrototypeSet:TypedArrayPrototypeSet$1,Uint8Array:Uint8Array$2}=primordials$1,{Buffer:Buffer$5}=buffer$2,{inspect:inspect$2}=utilExports$1;var buffer_list$1=class{constructor(){this.head=null,this.tail=null,this.length=0}push(At){const xt={data:At,next:null};this.length>0?this.tail.next=xt:this.head=xt,this.tail=xt,++this.length}unshift(At){const xt={data:At,next:this.head};this.length===0&&(this.tail=xt),this.head=xt,++this.length}shift(){if(this.length===0)return;const At=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,At}clear(){this.head=this.tail=null,this.length=0}join(At){if(this.length===0)return"";let xt=this.head,Bt=""+xt.data;for(;(xt=xt.next)!==null;)Bt+=At+xt.data;return Bt}concat(At){if(this.length===0)return Buffer$5.alloc(0);const xt=Buffer$5.allocUnsafe(At>>>0);let Bt=this.head,Nt=0;for(;Bt;)TypedArrayPrototypeSet$1(xt,Bt.data,Nt),Nt+=Bt.data.length,Bt=Bt.next;return xt}consume(At,xt){const Bt=this.head.data;if(At<Bt.length){const Nt=Bt.slice(0,At);return this.head.data=Bt.slice(At),Nt}return At===Bt.length?this.shift():xt?this._getString(At):this._getBuffer(At)}first(){return this.head.data}*[SymbolIterator$4](){for(let At=this.head;At;At=At.next)yield At.data}_getString(At){let xt="",Bt=this.head,Nt=0;do{const jt=Bt.data;if(At>jt.length)xt+=jt,At-=jt.length;else{At===jt.length?(xt+=jt,++Nt,Bt.next?this.head=Bt.next:this.head=this.tail=null):(xt+=StringPrototypeSlice$1(jt,0,At),this.head=Bt,Bt.data=StringPrototypeSlice$1(jt,At));break}++Nt}while((Bt=Bt.next)!==null);return this.length-=Nt,xt}_getBuffer(At){const xt=Buffer$5.allocUnsafe(At),Bt=At;let Nt=this.head,jt=0;do{const Ut=Nt.data;if(At>Ut.length)TypedArrayPrototypeSet$1(xt,Ut,Bt-At),At-=Ut.length;else{At===Ut.length?(TypedArrayPrototypeSet$1(xt,Ut,Bt-At),++jt,Nt.next?this.head=Nt.next:this.head=this.tail=null):(TypedArrayPrototypeSet$1(xt,new Uint8Array$2(Ut.buffer,Ut.byteOffset,At),Bt-At),this.head=Nt,Nt.data=Ut.slice(At));break}++jt}while((Nt=Nt.next)!==null);return this.length-=jt,xt}[Symbol.for("nodejs.util.inspect.custom")](At,xt){return inspect$2(this,{...xt,depth:0,customInspect:!1})}};const{MathFloor:MathFloor$3,NumberIsInteger:NumberIsInteger$2}=primordials$1,{validateInteger:validateInteger$3}=validators$1,{ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$6}=errors$2.codes;let defaultHighWaterMarkBytes=16*1024,defaultHighWaterMarkObjectMode=16;function highWaterMarkFrom$1(kt,At,xt){return kt.highWaterMark!=null?kt.highWaterMark:At?kt[xt]:null}function getDefaultHighWaterMark$1(kt){return kt?defaultHighWaterMarkObjectMode:defaultHighWaterMarkBytes}function setDefaultHighWaterMark(kt,At){validateInteger$3(At,"value",0),kt?defaultHighWaterMarkObjectMode=At:defaultHighWaterMarkBytes=At}function getHighWaterMark$3(kt,At,xt,Bt){const Nt=highWaterMarkFrom$1(At,Bt,xt);if(Nt!=null){if(!NumberIsInteger$2(Nt)||Nt<0){const jt=Bt?`options.${xt}`:"options.highWaterMark";throw new ERR_INVALID_ARG_VALUE$6(jt,Nt)}return MathFloor$3(Nt)}return getDefaultHighWaterMark$1(kt.objectMode)}var state$1={getHighWaterMark:getHighWaterMark$3,getDefaultHighWaterMark:getDefaultHighWaterMark$1,setDefaultHighWaterMark};const process$5=browserExports$3,{PromisePrototypeThen:PromisePrototypeThen$4,SymbolAsyncIterator:SymbolAsyncIterator$4,SymbolIterator:SymbolIterator$3}=primordials$1,{Buffer:Buffer$4}=buffer$2,{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$8,ERR_STREAM_NULL_VALUES:ERR_STREAM_NULL_VALUES$1}=errors$2.codes;function from$4(kt,At,xt){let Bt;if(typeof At=="string"||At instanceof Buffer$4)return new kt({objectMode:!0,...xt,read(){this.push(At),this.push(null)}});let Nt;if(At&&At[SymbolAsyncIterator$4])Nt=!0,Bt=At[SymbolAsyncIterator$4]();else if(At&&At[SymbolIterator$3])Nt=!1,Bt=At[SymbolIterator$3]();else throw new ERR_INVALID_ARG_TYPE$8("iterable",["Iterable"],At);const jt=new kt({objectMode:!0,highWaterMark:1,...xt});let Ut=!1;jt._read=function(){Ut||(Ut=!0,Ht())},jt._destroy=function(Vt,zt){PromisePrototypeThen$4(Lt(Vt),()=>process$5.nextTick(zt,Vt),Wt=>process$5.nextTick(zt,Wt||Vt))};async function Lt(Vt){const zt=Vt!=null,Wt=typeof Bt.throw=="function";if(zt&&Wt){const{value:Jt,done:Qt}=await Bt.throw(Vt);if(await Jt,Qt)return}if(typeof Bt.return=="function"){const{value:Jt}=await Bt.return();await Jt}}async function Ht(){for(;;){try{const{value:Vt,done:zt}=Nt?await Bt.next():Bt.next();if(zt)jt.push(null);else{const Wt=Vt&&typeof Vt.then=="function"?await Vt:Vt;if(Wt===null)throw Ut=!1,new ERR_STREAM_NULL_VALUES$1;if(jt.push(Wt))continue;Ut=!1}}catch(Vt){jt.destroy(Vt)}break}}return jt}var from_1$1=from$4,readable$1,hasRequiredReadable$1;function requireReadable$1(){if(hasRequiredReadable$1)return readable$1;hasRequiredReadable$1=1;const kt=browserExports$3,{ArrayPrototypeIndexOf:At,NumberIsInteger:xt,NumberIsNaN:Bt,NumberParseInt:Nt,ObjectDefineProperties:jt,ObjectKeys:Ut,ObjectSetPrototypeOf:Lt,Promise:Ht,SafeSet:Vt,SymbolAsyncDispose:zt,SymbolAsyncIterator:Wt,Symbol:Jt}=primordials$1;readable$1=nn,nn.ReadableState=on;const{EventEmitter:Qt}=eventsExports,{Stream:Xt,prependListener:tr}=legacy$1,{Buffer:rr}=buffer$2,{addAbortSignal:nr}=addAbortSignalExports$1,ar=endOfStreamExports$1;let ir=utilExports$1.debuglog("stream",Zr=>{ir=Zr});const lr=buffer_list$1,yr=destroy_1$1,{getHighWaterMark:Sr,getDefaultHighWaterMark:Ar}=state$1,{aggregateTwoErrors:Dr,codes:{ERR_INVALID_ARG_TYPE:Br,ERR_METHOD_NOT_IMPLEMENTED:Lr,ERR_OUT_OF_RANGE:Or,ERR_STREAM_PUSH_AFTER_EOF:vr,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:pr},AbortError:dr}=errors$2,{validateObject:ur}=validators$1,$r=Jt("kPaused"),{StringDecoder:wr}=requireString_decoder(),Er=from_1$1;Lt(nn.prototype,Xt.prototype),Lt(nn,Xt);const gr=()=>{},{errorOrDestroy:fr}=yr,br=1,_r=2,Tr=4,Pr=8,Nr=16,Cr=32,xr=64,Rr=128,qr=256,Vr=512,Gr=1024,Ur=2048,kr=4096,Fr=8192,Wr=16384,jr=32768,Ir=65536,Mr=1<<17,Hr=1<<18;function Qr(Zr){return{enumerable:!1,get(){return(this.state&Zr)!==0},set(en){en?this.state|=Zr:this.state&=~Zr}}}jt(on.prototype,{objectMode:Qr(br),ended:Qr(_r),endEmitted:Qr(Tr),reading:Qr(Pr),constructed:Qr(Nr),sync:Qr(Cr),needReadable:Qr(xr),emittedReadable:Qr(Rr),readableListening:Qr(qr),resumeScheduled:Qr(Vr),errorEmitted:Qr(Gr),emitClose:Qr(Ur),autoDestroy:Qr(kr),destroyed:Qr(Fr),closed:Qr(Wr),closeEmitted:Qr(jr),multiAwaitDrain:Qr(Ir),readingMore:Qr(Mr),dataEmitted:Qr(Hr)});function on(Zr,en,pn){typeof pn!="boolean"&&(pn=en instanceof requireDuplex$1()),this.state=Ur|kr|Nr|Cr,Zr&&Zr.objectMode&&(this.state|=br),pn&&Zr&&Zr.readableObjectMode&&(this.state|=br),this.highWaterMark=Zr?Sr(this,Zr,"readableHighWaterMark",pn):Ar(!1),this.buffer=new lr,this.length=0,this.pipes=[],this.flowing=null,this[$r]=null,Zr&&Zr.emitClose===!1&&(this.state&=~Ur),Zr&&Zr.autoDestroy===!1&&(this.state&=~kr),this.errored=null,this.defaultEncoding=Zr&&Zr.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,Zr&&Zr.encoding&&(this.decoder=new wr(Zr.encoding),this.encoding=Zr.encoding)}function nn(Zr){if(!(this instanceof nn))return new nn(Zr);const en=this instanceof requireDuplex$1();this._readableState=new on(Zr,this,en),Zr&&(typeof Zr.read=="function"&&(this._read=Zr.read),typeof Zr.destroy=="function"&&(this._destroy=Zr.destroy),typeof Zr.construct=="function"&&(this._construct=Zr.construct),Zr.signal&&!en&&nr(Zr.signal,this)),Xt.call(this,Zr),yr.construct(this,()=>{this._readableState.needReadable&&_n(this,this._readableState)})}nn.prototype.destroy=yr.destroy,nn.prototype._undestroy=yr.undestroy,nn.prototype._destroy=function(Zr,en){en(Zr)},nn.prototype[Qt.captureRejectionSymbol]=function(Zr){this.destroy(Zr)},nn.prototype[zt]=function(){let Zr;return this.destroyed||(Zr=this.readableEnded?null:new dr,this.destroy(Zr)),new Ht((en,pn)=>ar(this,mn=>mn&&mn!==Zr?pn(mn):en(null)))},nn.prototype.push=function(Zr,en){return fn(this,Zr,en,!1)},nn.prototype.unshift=function(Zr,en){return fn(this,Zr,en,!0)};function fn(Zr,en,pn,mn){ir("readableAddChunk",en);const yn=Zr._readableState;let Ln;if(yn.state&br||(typeof en=="string"?(pn=pn||yn.defaultEncoding,yn.encoding!==pn&&(mn&&yn.encoding?en=rr.from(en,pn).toString(yn.encoding):(en=rr.from(en,pn),pn=""))):en instanceof rr?pn="":Xt._isUint8Array(en)?(en=Xt._uint8ArrayToBuffer(en),pn=""):en!=null&&(Ln=new Br("chunk",["string","Buffer","Uint8Array"],en))),Ln)fr(Zr,Ln);else if(en===null)yn.state&=~Pr,dn(Zr,yn);else if(yn.state&br||en&&en.length>0)if(mn)if(yn.state&Tr)fr(Zr,new pr);else{if(yn.destroyed||yn.errored)return!1;hn(Zr,yn,en,!0)}else if(yn.ended)fr(Zr,new vr);else{if(yn.destroyed||yn.errored)return!1;yn.state&=~Pr,yn.decoder&&!pn?(en=yn.decoder.write(en),yn.objectMode||en.length!==0?hn(Zr,yn,en,!1):_n(Zr,yn)):hn(Zr,yn,en,!1)}else mn||(yn.state&=~Pr,_n(Zr,yn));return!yn.ended&&(yn.length<yn.highWaterMark||yn.length===0)}function hn(Zr,en,pn,mn){en.flowing&&en.length===0&&!en.sync&&Zr.listenerCount("data")>0?(en.state&Ir?en.awaitDrainWriters.clear():en.awaitDrainWriters=null,en.dataEmitted=!0,Zr.emit("data",pn)):(en.length+=en.objectMode?1:pn.length,mn?en.buffer.unshift(pn):en.buffer.push(pn),en.state&xr&&cn(Zr)),_n(Zr,en)}nn.prototype.isPaused=function(){const Zr=this._readableState;return Zr[$r]===!0||Zr.flowing===!1},nn.prototype.setEncoding=function(Zr){const en=new wr(Zr);this._readableState.decoder=en,this._readableState.encoding=this._readableState.decoder.encoding;const pn=this._readableState.buffer;let mn="";for(const yn of pn)mn+=en.write(yn);return pn.clear(),mn!==""&&pn.push(mn),this._readableState.length=mn.length,this};const Jr=1073741824;function Yr(Zr){if(Zr>Jr)throw new Or("size","<= 1GiB",Zr);return Zr--,Zr|=Zr>>>1,Zr|=Zr>>>2,Zr|=Zr>>>4,Zr|=Zr>>>8,Zr|=Zr>>>16,Zr++,Zr}function an(Zr,en){return Zr<=0||en.length===0&&en.ended?0:en.state&br?1:Bt(Zr)?en.flowing&&en.length?en.buffer.first().length:en.length:Zr<=en.length?Zr:en.ended?en.length:0}nn.prototype.read=function(Zr){ir("read",Zr),Zr===void 0?Zr=NaN:xt(Zr)||(Zr=Nt(Zr,10));const en=this._readableState,pn=Zr;if(Zr>en.highWaterMark&&(en.highWaterMark=Yr(Zr)),Zr!==0&&(en.state&=~Rr),Zr===0&&en.needReadable&&((en.highWaterMark!==0?en.length>=en.highWaterMark:en.length>0)||en.ended))return ir("read: emitReadable",en.length,en.ended),en.length===0&&en.ended?xn(this):cn(this),null;if(Zr=an(Zr,en),Zr===0&&en.ended)return en.length===0&&xn(this),null;let mn=(en.state&xr)!==0;if(ir("need readable",mn),(en.length===0||en.length-Zr<en.highWaterMark)&&(mn=!0,ir("length less than watermark",mn)),en.ended||en.reading||en.destroyed||en.errored||!en.constructed)mn=!1,ir("reading, ended or constructing",mn);else if(mn){ir("do read"),en.state|=Pr|Cr,en.length===0&&(en.state|=xr);try{this._read(en.highWaterMark)}catch(Ln){fr(this,Ln)}en.state&=~Cr,en.reading||(Zr=an(pn,en))}let yn;return Zr>0?yn=Vn(Zr,en):yn=null,yn===null?(en.needReadable=en.length<=en.highWaterMark,Zr=0):(en.length-=Zr,en.multiAwaitDrain?en.awaitDrainWriters.clear():en.awaitDrainWriters=null),en.length===0&&(en.ended||(en.needReadable=!0),pn!==Zr&&en.ended&&xn(this)),yn!==null&&!en.errorEmitted&&!en.closeEmitted&&(en.dataEmitted=!0,this.emit("data",yn)),yn};function dn(Zr,en){if(ir("onEofChunk"),!en.ended){if(en.decoder){const pn=en.decoder.end();pn&&pn.length&&(en.buffer.push(pn),en.length+=en.objectMode?1:pn.length)}en.ended=!0,en.sync?cn(Zr):(en.needReadable=!1,en.emittedReadable=!0,vn(Zr))}}function cn(Zr){const en=Zr._readableState;ir("emitReadable",en.needReadable,en.emittedReadable),en.needReadable=!1,en.emittedReadable||(ir("emitReadable",en.flowing),en.emittedReadable=!0,kt.nextTick(vn,Zr))}function vn(Zr){const en=Zr._readableState;ir("emitReadable_",en.destroyed,en.length,en.ended),!en.destroyed&&!en.errored&&(en.length||en.ended)&&(Zr.emit("readable"),en.emittedReadable=!1),en.needReadable=!en.flowing&&!en.ended&&en.length<=en.highWaterMark,qn(Zr)}function _n(Zr,en){!en.readingMore&&en.constructed&&(en.readingMore=!0,kt.nextTick(Tn,Zr,en))}function Tn(Zr,en){for(;!en.reading&&!en.ended&&(en.length<en.highWaterMark||en.flowing&&en.length===0);){const pn=en.length;if(ir("maybeReadMore read 0"),Zr.read(0),pn===en.length)break}en.readingMore=!1}nn.prototype._read=function(Zr){throw new Lr("_read()")},nn.prototype.pipe=function(Zr,en){const pn=this,mn=this._readableState;mn.pipes.length===1&&(mn.multiAwaitDrain||(mn.multiAwaitDrain=!0,mn.awaitDrainWriters=new Vt(mn.awaitDrainWriters?[mn.awaitDrainWriters]:[]))),mn.pipes.push(Zr),ir("pipe count=%d opts=%j",mn.pipes.length,en);const Ln=(!en||en.end!==!1)&&Zr!==kt.stdout&&Zr!==kt.stderr?tn:kn;mn.endEmitted?kt.nextTick(Ln):pn.once("end",Ln),Zr.on("unpipe",Gn);function Gn(Cn,Nn){ir("onunpipe"),Cn===pn&&Nn&&Nn.hasUnpiped===!1&&(Nn.hasUnpiped=!0,ln())}function tn(){ir("onend"),Zr.end()}let Xr,sn=!1;function ln(){ir("cleanup"),Zr.removeListener("close",En),Zr.removeListener("finish",Dn),Xr&&Zr.removeListener("drain",Xr),Zr.removeListener("error",gn),Zr.removeListener("unpipe",Gn),pn.removeListener("end",tn),pn.removeListener("end",kn),pn.removeListener("data",wn),sn=!0,Xr&&mn.awaitDrainWriters&&(!Zr._writableState||Zr._writableState.needDrain)&&Xr()}function un(){sn||(mn.pipes.length===1&&mn.pipes[0]===Zr?(ir("false write response, pause",0),mn.awaitDrainWriters=Zr,mn.multiAwaitDrain=!1):mn.pipes.length>1&&mn.pipes.includes(Zr)&&(ir("false write response, pause",mn.awaitDrainWriters.size),mn.awaitDrainWriters.add(Zr)),pn.pause()),Xr||(Xr=$n(pn,Zr),Zr.on("drain",Xr))}pn.on("data",wn);function wn(Cn){ir("ondata");const Nn=Zr.write(Cn);ir("dest.write",Nn),Nn===!1&&un()}function gn(Cn){if(ir("onerror",Cn),kn(),Zr.removeListener("error",gn),Zr.listenerCount("error")===0){const Nn=Zr._writableState||Zr._readableState;Nn&&!Nn.errorEmitted?fr(Zr,Cn):Zr.emit("error",Cn)}}tr(Zr,"error",gn);function En(){Zr.removeListener("finish",Dn),kn()}Zr.once("close",En);function Dn(){ir("onfinish"),Zr.removeListener("close",En),kn()}Zr.once("finish",Dn);function kn(){ir("unpipe"),pn.unpipe(Zr)}return Zr.emit("pipe",pn),Zr.writableNeedDrain===!0?un():mn.flowing||(ir("pipe resume"),pn.resume()),Zr};function $n(Zr,en){return function(){const mn=Zr._readableState;mn.awaitDrainWriters===en?(ir("pipeOnDrain",1),mn.awaitDrainWriters=null):mn.multiAwaitDrain&&(ir("pipeOnDrain",mn.awaitDrainWriters.size),mn.awaitDrainWriters.delete(en)),(!mn.awaitDrainWriters||mn.awaitDrainWriters.size===0)&&Zr.listenerCount("data")&&Zr.resume()}}nn.prototype.unpipe=function(Zr){const en=this._readableState,pn={hasUnpiped:!1};if(en.pipes.length===0)return this;if(!Zr){const yn=en.pipes;en.pipes=[],this.pause();for(let Ln=0;Ln<yn.length;Ln++)yn[Ln].emit("unpipe",this,{hasUnpiped:!1});return this}const mn=At(en.pipes,Zr);return mn===-1?this:(en.pipes.splice(mn,1),en.pipes.length===0&&this.pause(),Zr.emit("unpipe",this,pn),this)},nn.prototype.on=function(Zr,en){const pn=Xt.prototype.on.call(this,Zr,en),mn=this._readableState;return Zr==="data"?(mn.readableListening=this.listenerCount("readable")>0,mn.flowing!==!1&&this.resume()):Zr==="readable"&&!mn.endEmitted&&!mn.readableListening&&(mn.readableListening=mn.needReadable=!0,mn.flowing=!1,mn.emittedReadable=!1,ir("on readable",mn.length,mn.reading),mn.length?cn(this):mn.reading||kt.nextTick(Un,this)),pn},nn.prototype.addListener=nn.prototype.on,nn.prototype.removeListener=function(Zr,en){const pn=Xt.prototype.removeListener.call(this,Zr,en);return Zr==="readable"&&kt.nextTick(Kn,this),pn},nn.prototype.off=nn.prototype.removeListener,nn.prototype.removeAllListeners=function(Zr){const en=Xt.prototype.removeAllListeners.apply(this,arguments);return(Zr==="readable"||Zr===void 0)&&kt.nextTick(Kn,this),en};function Kn(Zr){const en=Zr._readableState;en.readableListening=Zr.listenerCount("readable")>0,en.resumeScheduled&&en[$r]===!1?en.flowing=!0:Zr.listenerCount("data")>0?Zr.resume():en.readableListening||(en.flowing=null)}function Un(Zr){ir("readable nexttick read 0"),Zr.read(0)}nn.prototype.resume=function(){const Zr=this._readableState;return Zr.flowing||(ir("resume"),Zr.flowing=!Zr.readableListening,In(this,Zr)),Zr[$r]=!1,this};function In(Zr,en){en.resumeScheduled||(en.resumeScheduled=!0,kt.nextTick(Mn,Zr,en))}function Mn(Zr,en){ir("resume",en.reading),en.reading||Zr.read(0),en.resumeScheduled=!1,Zr.emit("resume"),qn(Zr),en.flowing&&!en.reading&&Zr.read(0)}nn.prototype.pause=function(){return ir("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(ir("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[$r]=!0,this};function qn(Zr){const en=Zr._readableState;for(ir("flow",en.flowing);en.flowing&&Zr.read()!==null;);}nn.prototype.wrap=function(Zr){let en=!1;Zr.on("data",mn=>{!this.push(mn)&&Zr.pause&&(en=!0,Zr.pause())}),Zr.on("end",()=>{this.push(null)}),Zr.on("error",mn=>{fr(this,mn)}),Zr.on("close",()=>{this.destroy()}),Zr.on("destroy",()=>{this.destroy()}),this._read=()=>{en&&Zr.resume&&(en=!1,Zr.resume())};const pn=Ut(Zr);for(let mn=1;mn<pn.length;mn++){const yn=pn[mn];this[yn]===void 0&&typeof Zr[yn]=="function"&&(this[yn]=Zr[yn].bind(Zr))}return this},nn.prototype[Wt]=function(){return On(this)},nn.prototype.iterator=function(Zr){return Zr!==void 0&&ur(Zr,"options"),On(this,Zr)};function On(Zr,en){typeof Zr.read!="function"&&(Zr=nn.wrap(Zr,{objectMode:!0}));const pn=Hn(Zr,en);return pn.stream=Zr,pn}async function*Hn(Zr,en){let pn=gr;function mn(Gn){this===Zr?(pn(),pn=gr):pn=Gn}Zr.on("readable",mn);let yn;const Ln=ar(Zr,{writable:!1},Gn=>{yn=Gn?Dr(yn,Gn):null,pn(),pn=gr});try{for(;;){const Gn=Zr.destroyed?null:Zr.read();if(Gn!==null)yield Gn;else{if(yn)throw yn;if(yn===null)return;await new Ht(mn)}}}catch(Gn){throw yn=Dr(yn,Gn),yn}finally{(yn||(en==null?void 0:en.destroyOnReturn)!==!1)&&(yn===void 0||Zr._readableState.autoDestroy)?yr.destroyer(Zr,null):(Zr.off("readable",mn),Ln())}}jt(nn.prototype,{readable:{__proto__:null,get(){const Zr=this._readableState;return!!Zr&&Zr.readable!==!1&&!Zr.destroyed&&!Zr.errorEmitted&&!Zr.endEmitted},set(Zr){this._readableState&&(this._readableState.readable=!!Zr)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(Zr){this._readableState&&(this._readableState.flowing=Zr)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(Zr){this._readableState&&(this._readableState.destroyed=Zr)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),jt(on.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[$r]!==!1},set(Zr){this[$r]=!!Zr}}}),nn._fromList=Vn;function Vn(Zr,en){if(en.length===0)return null;let pn;return en.objectMode?pn=en.buffer.shift():!Zr||Zr>=en.length?(en.decoder?pn=en.buffer.join(""):en.buffer.length===1?pn=en.buffer.first():pn=en.buffer.concat(en.length),en.buffer.clear()):pn=en.buffer.consume(Zr,en.decoder),pn}function xn(Zr){const en=Zr._readableState;ir("endReadable",en.endEmitted),en.endEmitted||(en.ended=!0,kt.nextTick(zn,en,Zr))}function zn(Zr,en){if(ir("endReadableNT",Zr.endEmitted,Zr.length),!Zr.errored&&!Zr.closeEmitted&&!Zr.endEmitted&&Zr.length===0){if(Zr.endEmitted=!0,en.emit("end"),en.writable&&en.allowHalfOpen===!1)kt.nextTick(Jn,en);else if(Zr.autoDestroy){const pn=en._writableState;(!pn||pn.autoDestroy&&(pn.finished||pn.writable===!1))&&en.destroy()}}}function Jn(Zr){Zr.writable&&!Zr.writableEnded&&!Zr.destroyed&&Zr.end()}nn.from=function(Zr,en){return Er(nn,Zr,en)};let Bn;function Qn(){return Bn===void 0&&(Bn={}),Bn}return nn.fromWeb=function(Zr,en){return Qn().newStreamReadableFromReadableStream(Zr,en)},nn.toWeb=function(Zr,en){return Qn().newReadableStreamFromStreamReadable(Zr,en)},nn.wrap=function(Zr,en){var pn,mn;return new nn({objectMode:(pn=(mn=Zr.readableObjectMode)!==null&&mn!==void 0?mn:Zr.objectMode)!==null&&pn!==void 0?pn:!0,...en,destroy(yn,Ln){yr.destroyer(Zr,yn),Ln(yn)}}).wrap(Zr)},readable$1}var writable$1,hasRequiredWritable$1;function requireWritable$1(){if(hasRequiredWritable$1)return writable$1;hasRequiredWritable$1=1;const kt=browserExports$3,{ArrayPrototypeSlice:At,Error:xt,FunctionPrototypeSymbolHasInstance:Bt,ObjectDefineProperty:Nt,ObjectDefineProperties:jt,ObjectSetPrototypeOf:Ut,StringPrototypeToLowerCase:Lt,Symbol:Ht,SymbolHasInstance:Vt}=primordials$1;writable$1=ur,ur.WritableState=pr;const{EventEmitter:zt}=eventsExports,Wt=legacy$1.Stream,{Buffer:Jt}=buffer$2,Qt=destroy_1$1,{addAbortSignal:Xt}=addAbortSignalExports$1,{getHighWaterMark:tr,getDefaultHighWaterMark:rr}=state$1,{ERR_INVALID_ARG_TYPE:nr,ERR_METHOD_NOT_IMPLEMENTED:ar,ERR_MULTIPLE_CALLBACK:ir,ERR_STREAM_CANNOT_PIPE:lr,ERR_STREAM_DESTROYED:yr,ERR_STREAM_ALREADY_FINISHED:Sr,ERR_STREAM_NULL_VALUES:Ar,ERR_STREAM_WRITE_AFTER_END:Dr,ERR_UNKNOWN_ENCODING:Br}=errors$2.codes,{errorOrDestroy:Lr}=Qt;Ut(ur.prototype,Wt.prototype),Ut(ur,Wt);function Or(){}const vr=Ht("kOnFinished");function pr(kr,Fr,Wr){typeof Wr!="boolean"&&(Wr=Fr instanceof requireDuplex$1()),this.objectMode=!!(kr&&kr.objectMode),Wr&&(this.objectMode=this.objectMode||!!(kr&&kr.writableObjectMode)),this.highWaterMark=kr?tr(this,kr,"writableHighWaterMark",Wr):rr(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const jr=!!(kr&&kr.decodeStrings===!1);this.decodeStrings=!jr,this.defaultEncoding=kr&&kr.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=fr.bind(void 0,Fr),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,dr(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!kr||kr.emitClose!==!1,this.autoDestroy=!kr||kr.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[vr]=[]}function dr(kr){kr.buffered=[],kr.bufferedIndex=0,kr.allBuffers=!0,kr.allNoop=!0}pr.prototype.getBuffer=function(){return At(this.buffered,this.bufferedIndex)},Nt(pr.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function ur(kr){const Fr=this instanceof requireDuplex$1();if(!Fr&&!Bt(ur,this))return new ur(kr);this._writableState=new pr(kr,this,Fr),kr&&(typeof kr.write=="function"&&(this._write=kr.write),typeof kr.writev=="function"&&(this._writev=kr.writev),typeof kr.destroy=="function"&&(this._destroy=kr.destroy),typeof kr.final=="function"&&(this._final=kr.final),typeof kr.construct=="function"&&(this._construct=kr.construct),kr.signal&&Xt(kr.signal,this)),Wt.call(this,kr),Qt.construct(this,()=>{const Wr=this._writableState;Wr.writing||Pr(this,Wr),Rr(this,Wr)})}Nt(ur,Vt,{__proto__:null,value:function(kr){return Bt(this,kr)?!0:this!==ur?!1:kr&&kr._writableState instanceof pr}}),ur.prototype.pipe=function(){Lr(this,new lr)};function $r(kr,Fr,Wr,jr){const Ir=kr._writableState;if(typeof Wr=="function")jr=Wr,Wr=Ir.defaultEncoding;else{if(!Wr)Wr=Ir.defaultEncoding;else if(Wr!=="buffer"&&!Jt.isEncoding(Wr))throw new Br(Wr);typeof jr!="function"&&(jr=Or)}if(Fr===null)throw new Ar;if(!Ir.objectMode)if(typeof Fr=="string")Ir.decodeStrings!==!1&&(Fr=Jt.from(Fr,Wr),Wr="buffer");else if(Fr instanceof Jt)Wr="buffer";else if(Wt._isUint8Array(Fr))Fr=Wt._uint8ArrayToBuffer(Fr),Wr="buffer";else throw new nr("chunk",["string","Buffer","Uint8Array"],Fr);let Mr;return Ir.ending?Mr=new Dr:Ir.destroyed&&(Mr=new yr("write")),Mr?(kt.nextTick(jr,Mr),Lr(kr,Mr,!0),Mr):(Ir.pendingcb++,wr(kr,Ir,Fr,Wr,jr))}ur.prototype.write=function(kr,Fr,Wr){return $r(this,kr,Fr,Wr)===!0},ur.prototype.cork=function(){this._writableState.corked++},ur.prototype.uncork=function(){const kr=this._writableState;kr.corked&&(kr.corked--,kr.writing||Pr(this,kr))},ur.prototype.setDefaultEncoding=function(Fr){if(typeof Fr=="string"&&(Fr=Lt(Fr)),!Jt.isEncoding(Fr))throw new Br(Fr);return this._writableState.defaultEncoding=Fr,this};function wr(kr,Fr,Wr,jr,Ir){const Mr=Fr.objectMode?1:Wr.length;Fr.length+=Mr;const Hr=Fr.length<Fr.highWaterMark;return Hr||(Fr.needDrain=!0),Fr.writing||Fr.corked||Fr.errored||!Fr.constructed?(Fr.buffered.push({chunk:Wr,encoding:jr,callback:Ir}),Fr.allBuffers&&jr!=="buffer"&&(Fr.allBuffers=!1),Fr.allNoop&&Ir!==Or&&(Fr.allNoop=!1)):(Fr.writelen=Mr,Fr.writecb=Ir,Fr.writing=!0,Fr.sync=!0,kr._write(Wr,jr,Fr.onwrite),Fr.sync=!1),Hr&&!Fr.errored&&!Fr.destroyed}function Er(kr,Fr,Wr,jr,Ir,Mr,Hr){Fr.writelen=jr,Fr.writecb=Hr,Fr.writing=!0,Fr.sync=!0,Fr.destroyed?Fr.onwrite(new yr("write")):Wr?kr._writev(Ir,Fr.onwrite):kr._write(Ir,Mr,Fr.onwrite),Fr.sync=!1}function gr(kr,Fr,Wr,jr){--Fr.pendingcb,jr(Wr),Tr(Fr),Lr(kr,Wr)}function fr(kr,Fr){const Wr=kr._writableState,jr=Wr.sync,Ir=Wr.writecb;if(typeof Ir!="function"){Lr(kr,new ir);return}Wr.writing=!1,Wr.writecb=null,Wr.length-=Wr.writelen,Wr.writelen=0,Fr?(Fr.stack,Wr.errored||(Wr.errored=Fr),kr._readableState&&!kr._readableState.errored&&(kr._readableState.errored=Fr),jr?kt.nextTick(gr,kr,Wr,Fr,Ir):gr(kr,Wr,Fr,Ir)):(Wr.buffered.length>Wr.bufferedIndex&&Pr(kr,Wr),jr?Wr.afterWriteTickInfo!==null&&Wr.afterWriteTickInfo.cb===Ir?Wr.afterWriteTickInfo.count++:(Wr.afterWriteTickInfo={count:1,cb:Ir,stream:kr,state:Wr},kt.nextTick(br,Wr.afterWriteTickInfo)):_r(kr,Wr,1,Ir))}function br({stream:kr,state:Fr,count:Wr,cb:jr}){return Fr.afterWriteTickInfo=null,_r(kr,Fr,Wr,jr)}function _r(kr,Fr,Wr,jr){for(!Fr.ending&&!kr.destroyed&&Fr.length===0&&Fr.needDrain&&(Fr.needDrain=!1,kr.emit("drain"));Wr-- >0;)Fr.pendingcb--,jr();Fr.destroyed&&Tr(Fr),Rr(kr,Fr)}function Tr(kr){if(kr.writing)return;for(let Ir=kr.bufferedIndex;Ir<kr.buffered.length;++Ir){var Fr;const{chunk:Mr,callback:Hr}=kr.buffered[Ir],Qr=kr.objectMode?1:Mr.length;kr.length-=Qr,Hr((Fr=kr.errored)!==null&&Fr!==void 0?Fr:new yr("write"))}const Wr=kr[vr].splice(0);for(let Ir=0;Ir<Wr.length;Ir++){var jr;Wr[Ir]((jr=kr.errored)!==null&&jr!==void 0?jr:new yr("end"))}dr(kr)}function Pr(kr,Fr){if(Fr.corked||Fr.bufferProcessing||Fr.destroyed||!Fr.constructed)return;const{buffered:Wr,bufferedIndex:jr,objectMode:Ir}=Fr,Mr=Wr.length-jr;if(!Mr)return;let Hr=jr;if(Fr.bufferProcessing=!0,Mr>1&&kr._writev){Fr.pendingcb-=Mr-1;const Qr=Fr.allNoop?Or:nn=>{for(let fn=Hr;fn<Wr.length;++fn)Wr[fn].callback(nn)},on=Fr.allNoop&&Hr===0?Wr:At(Wr,Hr);on.allBuffers=Fr.allBuffers,Er(kr,Fr,!0,Fr.length,on,"",Qr),dr(Fr)}else{do{const{chunk:Qr,encoding:on,callback:nn}=Wr[Hr];Wr[Hr++]=null;const fn=Ir?1:Qr.length;Er(kr,Fr,!1,fn,Qr,on,nn)}while(Hr<Wr.length&&!Fr.writing);Hr===Wr.length?dr(Fr):Hr>256?(Wr.splice(0,Hr),Fr.bufferedIndex=0):Fr.bufferedIndex=Hr}Fr.bufferProcessing=!1}ur.prototype._write=function(kr,Fr,Wr){if(this._writev)this._writev([{chunk:kr,encoding:Fr}],Wr);else throw new ar("_write()")},ur.prototype._writev=null,ur.prototype.end=function(kr,Fr,Wr){const jr=this._writableState;typeof kr=="function"?(Wr=kr,kr=null,Fr=null):typeof Fr=="function"&&(Wr=Fr,Fr=null);let Ir;if(kr!=null){const Mr=$r(this,kr,Fr);Mr instanceof xt&&(Ir=Mr)}return jr.corked&&(jr.corked=1,this.uncork()),Ir||(!jr.errored&&!jr.ending?(jr.ending=!0,Rr(this,jr,!0),jr.ended=!0):jr.finished?Ir=new Sr("end"):jr.destroyed&&(Ir=new yr("end"))),typeof Wr=="function"&&(Ir||jr.finished?kt.nextTick(Wr,Ir):jr[vr].push(Wr)),this};function Nr(kr){return kr.ending&&!kr.destroyed&&kr.constructed&&kr.length===0&&!kr.errored&&kr.buffered.length===0&&!kr.finished&&!kr.writing&&!kr.errorEmitted&&!kr.closeEmitted}function Cr(kr,Fr){let Wr=!1;function jr(Ir){if(Wr){Lr(kr,Ir??ir());return}if(Wr=!0,Fr.pendingcb--,Ir){const Mr=Fr[vr].splice(0);for(let Hr=0;Hr<Mr.length;Hr++)Mr[Hr](Ir);Lr(kr,Ir,Fr.sync)}else Nr(Fr)&&(Fr.prefinished=!0,kr.emit("prefinish"),Fr.pendingcb++,kt.nextTick(qr,kr,Fr))}Fr.sync=!0,Fr.pendingcb++;try{kr._final(jr)}catch(Ir){jr(Ir)}Fr.sync=!1}function xr(kr,Fr){!Fr.prefinished&&!Fr.finalCalled&&(typeof kr._final=="function"&&!Fr.destroyed?(Fr.finalCalled=!0,Cr(kr,Fr)):(Fr.prefinished=!0,kr.emit("prefinish")))}function Rr(kr,Fr,Wr){Nr(Fr)&&(xr(kr,Fr),Fr.pendingcb===0&&(Wr?(Fr.pendingcb++,kt.nextTick((jr,Ir)=>{Nr(Ir)?qr(jr,Ir):Ir.pendingcb--},kr,Fr)):Nr(Fr)&&(Fr.pendingcb++,qr(kr,Fr))))}function qr(kr,Fr){Fr.pendingcb--,Fr.finished=!0;const Wr=Fr[vr].splice(0);for(let jr=0;jr<Wr.length;jr++)Wr[jr]();if(kr.emit("finish"),Fr.autoDestroy){const jr=kr._readableState;(!jr||jr.autoDestroy&&(jr.endEmitted||jr.readable===!1))&&kr.destroy()}}jt(ur.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(kr){this._writableState&&(this._writableState.destroyed=kr)}},writable:{__proto__:null,get(){const kr=this._writableState;return!!kr&&kr.writable!==!1&&!kr.destroyed&&!kr.errored&&!kr.ending&&!kr.ended},set(kr){this._writableState&&(this._writableState.writable=!!kr)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const kr=this._writableState;return kr?!kr.destroyed&&!kr.ending&&kr.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Vr=Qt.destroy;ur.prototype.destroy=function(kr,Fr){const Wr=this._writableState;return!Wr.destroyed&&(Wr.bufferedIndex<Wr.buffered.length||Wr[vr].length)&&kt.nextTick(Tr,Wr),Vr.call(this,kr,Fr),this},ur.prototype._undestroy=Qt.undestroy,ur.prototype._destroy=function(kr,Fr){Fr(kr)},ur.prototype[zt.captureRejectionSymbol]=function(kr){this.destroy(kr)};let Gr;function Ur(){return Gr===void 0&&(Gr={}),Gr}return ur.fromWeb=function(kr,Fr){return Ur().newStreamWritableFromWritableStream(kr,Fr)},ur.toWeb=function(kr){return Ur().newWritableStreamFromStreamWritable(kr)},writable$1}var duplexify$1,hasRequiredDuplexify$1;function requireDuplexify$1(){if(hasRequiredDuplexify$1)return duplexify$1;hasRequiredDuplexify$1=1;const kt=browserExports$3,At=buffer$2,{isReadable:xt,isWritable:Bt,isIterable:Nt,isNodeStream:jt,isReadableNodeStream:Ut,isWritableNodeStream:Lt,isDuplexNodeStream:Ht,isReadableStream:Vt,isWritableStream:zt}=utils$2,Wt=endOfStreamExports$1,{AbortError:Jt,codes:{ERR_INVALID_ARG_TYPE:Qt,ERR_INVALID_RETURN_VALUE:Xt}}=errors$2,{destroyer:tr}=destroy_1$1,rr=requireDuplex$1(),nr=requireReadable$1(),ar=requireWritable$1(),{createDeferredPromise:ir}=utilExports$1,lr=from_1$1,yr=globalThis.Blob||At.Blob,Sr=typeof yr<"u"?function(pr){return pr instanceof yr}:function(pr){return!1},Ar=globalThis.AbortController||requireBrowser().AbortController,{FunctionPrototypeCall:Dr}=primordials$1;class Br extends rr{constructor(pr){super(pr),(pr==null?void 0:pr.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(pr==null?void 0:pr.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}duplexify$1=function vr(pr,dr){if(Ht(pr))return pr;if(Ut(pr))return Or({readable:pr});if(Lt(pr))return Or({writable:pr});if(jt(pr))return Or({writable:!1,readable:!1});if(Vt(pr))return Or({readable:nr.fromWeb(pr)});if(zt(pr))return Or({writable:ar.fromWeb(pr)});if(typeof pr=="function"){const{value:$r,write:wr,final:Er,destroy:gr}=Lr(pr);if(Nt($r))return lr(Br,$r,{objectMode:!0,write:wr,final:Er,destroy:gr});const fr=$r==null?void 0:$r.then;if(typeof fr=="function"){let br;const _r=Dr(fr,$r,Tr=>{if(Tr!=null)throw new Xt("nully","body",Tr)},Tr=>{tr(br,Tr)});return br=new Br({objectMode:!0,readable:!1,write:wr,final(Tr){Er(async()=>{try{await _r,kt.nextTick(Tr,null)}catch(Pr){kt.nextTick(Tr,Pr)}})},destroy:gr})}throw new Xt("Iterable, AsyncIterable or AsyncFunction",dr,$r)}if(Sr(pr))return vr(pr.arrayBuffer());if(Nt(pr))return lr(Br,pr,{objectMode:!0,writable:!1});if(Vt(pr==null?void 0:pr.readable)&&zt(pr==null?void 0:pr.writable))return Br.fromWeb(pr);if(typeof(pr==null?void 0:pr.writable)=="object"||typeof(pr==null?void 0:pr.readable)=="object"){const $r=pr!=null&&pr.readable?Ut(pr==null?void 0:pr.readable)?pr==null?void 0:pr.readable:vr(pr.readable):void 0,wr=pr!=null&&pr.writable?Lt(pr==null?void 0:pr.writable)?pr==null?void 0:pr.writable:vr(pr.writable):void 0;return Or({readable:$r,writable:wr})}const ur=pr==null?void 0:pr.then;if(typeof ur=="function"){let $r;return Dr(ur,pr,wr=>{wr!=null&&$r.push(wr),$r.push(null)},wr=>{tr($r,wr)}),$r=new Br({objectMode:!0,writable:!1,read(){}})}throw new Qt(dr,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],pr)};function Lr(vr){let{promise:pr,resolve:dr}=ir();const ur=new Ar,$r=ur.signal;return{value:vr(async function*(){for(;;){const Er=pr;pr=null;const{chunk:gr,done:fr,cb:br}=await Er;if(kt.nextTick(br),fr)return;if($r.aborted)throw new Jt(void 0,{cause:$r.reason});({promise:pr,resolve:dr}=ir()),yield gr}}(),{signal:$r}),write(Er,gr,fr){const br=dr;dr=null,br({chunk:Er,done:!1,cb:fr})},final(Er){const gr=dr;dr=null,gr({done:!0,cb:Er})},destroy(Er,gr){ur.abort(),gr(Er)}}}function Or(vr){const pr=vr.readable&&typeof vr.readable.read!="function"?nr.wrap(vr.readable):vr.readable,dr=vr.writable;let ur=!!xt(pr),$r=!!Bt(dr),wr,Er,gr,fr,br;function _r(Tr){const Pr=fr;fr=null,Pr?Pr(Tr):Tr&&br.destroy(Tr)}return br=new Br({readableObjectMode:!!(pr!=null&&pr.readableObjectMode),writableObjectMode:!!(dr!=null&&dr.writableObjectMode),readable:ur,writable:$r}),$r&&(Wt(dr,Tr=>{$r=!1,Tr&&tr(pr,Tr),_r(Tr)}),br._write=function(Tr,Pr,Nr){dr.write(Tr,Pr)?Nr():wr=Nr},br._final=function(Tr){dr.end(),Er=Tr},dr.on("drain",function(){if(wr){const Tr=wr;wr=null,Tr()}}),dr.on("finish",function(){if(Er){const Tr=Er;Er=null,Tr()}})),ur&&(Wt(pr,Tr=>{ur=!1,Tr&&tr(pr,Tr),_r(Tr)}),pr.on("readable",function(){if(gr){const Tr=gr;gr=null,Tr()}}),pr.on("end",function(){br.push(null)}),br._read=function(){for(;;){const Tr=pr.read();if(Tr===null){gr=br._read;return}if(!br.push(Tr))return}}),br._destroy=function(Tr,Pr){!Tr&&fr!==null&&(Tr=new Jt),gr=null,wr=null,Er=null,fr===null?Pr(Tr):(fr=Pr,tr(dr,Tr),tr(pr,Tr))},br}return duplexify$1}var duplex$1,hasRequiredDuplex$1;function requireDuplex$1(){if(hasRequiredDuplex$1)return duplex$1;hasRequiredDuplex$1=1;const{ObjectDefineProperties:kt,ObjectGetOwnPropertyDescriptor:At,ObjectKeys:xt,ObjectSetPrototypeOf:Bt}=primordials$1;duplex$1=Ut;const Nt=requireReadable$1(),jt=requireWritable$1();Bt(Ut.prototype,Nt.prototype),Bt(Ut,Nt);{const zt=xt(jt.prototype);for(let Wt=0;Wt<zt.length;Wt++){const Jt=zt[Wt];Ut.prototype[Jt]||(Ut.prototype[Jt]=jt.prototype[Jt])}}function Ut(zt){if(!(this instanceof Ut))return new Ut(zt);Nt.call(this,zt),jt.call(this,zt),zt?(this.allowHalfOpen=zt.allowHalfOpen!==!1,zt.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),zt.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}kt(Ut.prototype,{writable:{__proto__:null,...At(jt.prototype,"writable")},writableHighWaterMark:{__proto__:null,...At(jt.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...At(jt.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...At(jt.prototype,"writableBuffer")},writableLength:{__proto__:null,...At(jt.prototype,"writableLength")},writableFinished:{__proto__:null,...At(jt.prototype,"writableFinished")},writableCorked:{__proto__:null,...At(jt.prototype,"writableCorked")},writableEnded:{__proto__:null,...At(jt.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...At(jt.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(zt){this._readableState&&this._writableState&&(this._readableState.destroyed=zt,this._writableState.destroyed=zt)}}});let Lt;function Ht(){return Lt===void 0&&(Lt={}),Lt}Ut.fromWeb=function(zt,Wt){return Ht().newStreamDuplexFromReadableWritablePair(zt,Wt)},Ut.toWeb=function(zt){return Ht().newReadableWritablePairFromDuplex(zt)};let Vt;return Ut.from=function(zt){return Vt||(Vt=requireDuplexify$1()),Vt(zt,"body")},duplex$1}const{ObjectSetPrototypeOf:ObjectSetPrototypeOf$4,Symbol:Symbol$6}=primordials$1;var transform$1=Transform$3;const{ERR_METHOD_NOT_IMPLEMENTED:ERR_METHOD_NOT_IMPLEMENTED$1}=errors$2.codes,Duplex$5=requireDuplex$1(),{getHighWaterMark:getHighWaterMark$2}=state$1;ObjectSetPrototypeOf$4(Transform$3.prototype,Duplex$5.prototype);ObjectSetPrototypeOf$4(Transform$3,Duplex$5);const kCallback$3=Symbol$6("kCallback");function Transform$3(kt){if(!(this instanceof Transform$3))return new Transform$3(kt);const At=kt?getHighWaterMark$2(this,kt,"readableHighWaterMark",!0):null;At===0&&(kt={...kt,highWaterMark:null,readableHighWaterMark:At,writableHighWaterMark:kt.writableHighWaterMark||0}),Duplex$5.call(this,kt),this._readableState.sync=!1,this[kCallback$3]=null,kt&&(typeof kt.transform=="function"&&(this._transform=kt.transform),typeof kt.flush=="function"&&(this._flush=kt.flush)),this.on("prefinish",prefinish$1)}function final$1(kt){typeof this._flush=="function"&&!this.destroyed?this._flush((At,xt)=>{if(At){kt?kt(At):this.destroy(At);return}xt!=null&&this.push(xt),this.push(null),kt&&kt()}):(this.push(null),kt&&kt())}function prefinish$1(){this._final!==final$1&&final$1.call(this)}Transform$3.prototype._final=final$1;Transform$3.prototype._transform=function(kt,At,xt){throw new ERR_METHOD_NOT_IMPLEMENTED$1("_transform()")};Transform$3.prototype._write=function(kt,At,xt){const Bt=this._readableState,Nt=this._writableState,jt=Bt.length;this._transform(kt,At,(Ut,Lt)=>{if(Ut){xt(Ut);return}Lt!=null&&this.push(Lt),Nt.ended||jt===Bt.length||Bt.length<Bt.highWaterMark?xt():this[kCallback$3]=xt})};Transform$3.prototype._read=function(){if(this[kCallback$3]){const kt=this[kCallback$3];this[kCallback$3]=null,kt()}};const{ObjectSetPrototypeOf:ObjectSetPrototypeOf$3}=primordials$1;var passthrough$1=PassThrough$3;const Transform$2=transform$1;ObjectSetPrototypeOf$3(PassThrough$3.prototype,Transform$2.prototype);ObjectSetPrototypeOf$3(PassThrough$3,Transform$2);function PassThrough$3(kt){if(!(this instanceof PassThrough$3))return new PassThrough$3(kt);Transform$2.call(this,kt)}PassThrough$3.prototype._transform=function(kt,At,xt){xt(null,kt)};const process$4=browserExports$3,{ArrayIsArray:ArrayIsArray$3,Promise:Promise$5,SymbolAsyncIterator:SymbolAsyncIterator$3,SymbolDispose}=primordials$1,eos$4=endOfStreamExports$1,{once:once$2}=utilExports$1,destroyImpl$1=destroy_1$1,Duplex$4=requireDuplex$1(),{aggregateTwoErrors:aggregateTwoErrors$3,codes:{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$7,ERR_INVALID_RETURN_VALUE:ERR_INVALID_RETURN_VALUE$1,ERR_MISSING_ARGS:ERR_MISSING_ARGS$5,ERR_STREAM_DESTROYED:ERR_STREAM_DESTROYED$1,ERR_STREAM_PREMATURE_CLOSE:ERR_STREAM_PREMATURE_CLOSE$2},AbortError:AbortError$b}=errors$2,{validateFunction:validateFunction$4,validateAbortSignal:validateAbortSignal$5}=validators$1,{isIterable:isIterable$3,isReadable:isReadable$5,isReadableNodeStream:isReadableNodeStream$3,isNodeStream:isNodeStream$7,isTransformStream:isTransformStream$4,isWebStream:isWebStream$4,isReadableStream:isReadableStream$5,isReadableFinished:isReadableFinished$2}=utils$2,AbortController$3=globalThis.AbortController||requireBrowser().AbortController;let PassThrough$2,Readable$1,addAbortListener;function destroyer$4(kt,At,xt){let Bt=!1;kt.on("close",()=>{Bt=!0});const Nt=eos$4(kt,{readable:At,writable:xt},jt=>{Bt=!jt});return{destroy:jt=>{Bt||(Bt=!0,destroyImpl$1.destroyer(kt,jt||new ERR_STREAM_DESTROYED$1("pipe")))},cleanup:Nt}}function popCallback$1(kt){return validateFunction$4(kt[kt.length-1],"streams[stream.length - 1]"),kt.pop()}function makeAsyncIterable$1(kt){if(isIterable$3(kt))return kt;if(isReadableNodeStream$3(kt))return fromReadable$1(kt);throw new ERR_INVALID_ARG_TYPE$7("val",["Readable","Iterable","AsyncIterable"],kt)}async function*fromReadable$1(kt){Readable$1||(Readable$1=requireReadable$1()),yield*Readable$1.prototype[SymbolAsyncIterator$3].call(kt)}async function pumpToNode$1(kt,At,xt,{end:Bt}){let Nt,jt=null;const Ut=Vt=>{if(Vt&&(Nt=Vt),jt){const zt=jt;jt=null,zt()}},Lt=()=>new Promise$5((Vt,zt)=>{Nt?zt(Nt):jt=()=>{Nt?zt(Nt):Vt()}});At.on("drain",Ut);const Ht=eos$4(At,{readable:!1},Ut);try{At.writableNeedDrain&&await Lt();for await(const Vt of kt)At.write(Vt)||await Lt();Bt&&(At.end(),await Lt()),xt()}catch(Vt){xt(Nt!==Vt?aggregateTwoErrors$3(Nt,Vt):Vt)}finally{Ht(),At.off("drain",Ut)}}async function pumpToWeb$1(kt,At,xt,{end:Bt}){isTransformStream$4(At)&&(At=At.writable);const Nt=At.getWriter();try{for await(const jt of kt)await Nt.ready,Nt.write(jt).catch(()=>{});await Nt.ready,Bt&&await Nt.close(),xt()}catch(jt){try{await Nt.abort(jt),xt(jt)}catch(Ut){xt(Ut)}}}function pipeline$3(...kt){return pipelineImpl$1(kt,once$2(popCallback$1(kt)))}function pipelineImpl$1(kt,At,xt){if(kt.length===1&&ArrayIsArray$3(kt[0])&&(kt=kt[0]),kt.length<2)throw new ERR_MISSING_ARGS$5("streams");const Bt=new AbortController$3,Nt=Bt.signal,jt=xt==null?void 0:xt.signal,Ut=[];validateAbortSignal$5(jt,"options.signal");function Lt(){Xt(new AbortError$b)}addAbortListener=addAbortListener||utilExports$1.addAbortListener;let Ht;jt&&(Ht=addAbortListener(jt,Lt));let Vt,zt;const Wt=[];let Jt=0;function Qt(ar){Xt(ar,--Jt===0)}function Xt(ar,ir){var lr;if(ar&&(!Vt||Vt.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Vt=ar),!(!Vt&&!ir)){for(;Wt.length;)Wt.shift()(Vt);(lr=Ht)===null||lr===void 0||lr[SymbolDispose](),Bt.abort(),ir&&(Vt||Ut.forEach(yr=>yr()),process$4.nextTick(At,Vt,zt))}}let tr;for(let ar=0;ar<kt.length;ar++){const ir=kt[ar],lr=ar<kt.length-1,yr=ar>0,Sr=lr||(xt==null?void 0:xt.end)!==!1,Ar=ar===kt.length-1;if(isNodeStream$7(ir)){let Dr=function(Br){Br&&Br.name!=="AbortError"&&Br.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Qt(Br)};if(Sr){const{destroy:Br,cleanup:Lr}=destroyer$4(ir,lr,yr);Wt.push(Br),isReadable$5(ir)&&Ar&&Ut.push(Lr)}ir.on("error",Dr),isReadable$5(ir)&&Ar&&Ut.push(()=>{ir.removeListener("error",Dr)})}if(ar===0)if(typeof ir=="function"){if(tr=ir({signal:Nt}),!isIterable$3(tr))throw new ERR_INVALID_RETURN_VALUE$1("Iterable, AsyncIterable or Stream","source",tr)}else isIterable$3(ir)||isReadableNodeStream$3(ir)||isTransformStream$4(ir)?tr=ir:tr=Duplex$4.from(ir);else if(typeof ir=="function"){if(isTransformStream$4(tr)){var rr;tr=makeAsyncIterable$1((rr=tr)===null||rr===void 0?void 0:rr.readable)}else tr=makeAsyncIterable$1(tr);if(tr=ir(tr,{signal:Nt}),lr){if(!isIterable$3(tr,!0))throw new ERR_INVALID_RETURN_VALUE$1("AsyncIterable",`transform[${ar-1}]`,tr)}else{var nr;PassThrough$2||(PassThrough$2=passthrough$1);const Dr=new PassThrough$2({objectMode:!0}),Br=(nr=tr)===null||nr===void 0?void 0:nr.then;if(typeof Br=="function")Jt++,Br.call(tr,vr=>{zt=vr,vr!=null&&Dr.write(vr),Sr&&Dr.end(),process$4.nextTick(Qt)},vr=>{Dr.destroy(vr),process$4.nextTick(Qt,vr)});else if(isIterable$3(tr,!0))Jt++,pumpToNode$1(tr,Dr,Qt,{end:Sr});else if(isReadableStream$5(tr)||isTransformStream$4(tr)){const vr=tr.readable||tr;Jt++,pumpToNode$1(vr,Dr,Qt,{end:Sr})}else throw new ERR_INVALID_RETURN_VALUE$1("AsyncIterable or Promise","destination",tr);tr=Dr;const{destroy:Lr,cleanup:Or}=destroyer$4(tr,!1,!0);Wt.push(Lr),Ar&&Ut.push(Or)}}else if(isNodeStream$7(ir)){if(isReadableNodeStream$3(tr)){Jt+=2;const Dr=pipe$2(tr,ir,Qt,{end:Sr});isReadable$5(ir)&&Ar&&Ut.push(Dr)}else if(isTransformStream$4(tr)||isReadableStream$5(tr)){const Dr=tr.readable||tr;Jt++,pumpToNode$1(Dr,ir,Qt,{end:Sr})}else if(isIterable$3(tr))Jt++,pumpToNode$1(tr,ir,Qt,{end:Sr});else throw new ERR_INVALID_ARG_TYPE$7("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],tr);tr=ir}else if(isWebStream$4(ir)){if(isReadableNodeStream$3(tr))Jt++,pumpToWeb$1(makeAsyncIterable$1(tr),ir,Qt,{end:Sr});else if(isReadableStream$5(tr)||isIterable$3(tr))Jt++,pumpToWeb$1(tr,ir,Qt,{end:Sr});else if(isTransformStream$4(tr))Jt++,pumpToWeb$1(tr.readable,ir,Qt,{end:Sr});else throw new ERR_INVALID_ARG_TYPE$7("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],tr);tr=ir}else tr=Duplex$4.from(ir)}return(Nt!=null&&Nt.aborted||jt!=null&&jt.aborted)&&process$4.nextTick(Lt),tr}function pipe$2(kt,At,xt,{end:Bt}){let Nt=!1;if(At.on("close",()=>{Nt||xt(new ERR_STREAM_PREMATURE_CLOSE$2)}),kt.pipe(At,{end:!1}),Bt){let jt=function(){Nt=!0,At.end()};isReadableFinished$2(kt)?process$4.nextTick(jt):kt.once("end",jt)}else xt();return eos$4(kt,{readable:!0,writable:!1},jt=>{const Ut=kt._readableState;jt&&jt.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ut&&Ut.ended&&!Ut.errored&&!Ut.errorEmitted?kt.once("end",xt).once("error",xt):xt(jt)}),eos$4(At,{readable:!1,writable:!0},xt)}var pipeline_1$1={pipelineImpl:pipelineImpl$1,pipeline:pipeline$3};const{pipeline:pipeline$2}=pipeline_1$1,Duplex$3=requireDuplex$1(),{destroyer:destroyer$3}=destroy_1$1,{isNodeStream:isNodeStream$6,isReadable:isReadable$4,isWritable:isWritable$5,isWebStream:isWebStream$3,isTransformStream:isTransformStream$3,isWritableStream:isWritableStream$3,isReadableStream:isReadableStream$4}=utils$2,{AbortError:AbortError$a,codes:{ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$5,ERR_MISSING_ARGS:ERR_MISSING_ARGS$4}}=errors$2,eos$3=endOfStreamExports$1;var compose$3=function kt(...At){if(At.length===0)throw new ERR_MISSING_ARGS$4("streams");if(At.length===1)return Duplex$3.from(At[0]);const xt=[...At];if(typeof At[0]=="function"&&(At[0]=Duplex$3.from(At[0])),typeof At[At.length-1]=="function"){const Qt=At.length-1;At[Qt]=Duplex$3.from(At[Qt])}for(let Qt=0;Qt<At.length;++Qt)if(!(!isNodeStream$6(At[Qt])&&!isWebStream$3(At[Qt]))){if(Qt<At.length-1&&!(isReadable$4(At[Qt])||isReadableStream$4(At[Qt])||isTransformStream$3(At[Qt])))throw new ERR_INVALID_ARG_VALUE$5(`streams[${Qt}]`,xt[Qt],"must be readable");if(Qt>0&&!(isWritable$5(At[Qt])||isWritableStream$3(At[Qt])||isTransformStream$3(At[Qt])))throw new ERR_INVALID_ARG_VALUE$5(`streams[${Qt}]`,xt[Qt],"must be writable")}let Bt,Nt,jt,Ut,Lt;function Ht(Qt){const Xt=Ut;Ut=null,Xt?Xt(Qt):Qt?Lt.destroy(Qt):!Jt&&!Wt&&Lt.destroy()}const Vt=At[0],zt=pipeline$2(At,Ht),Wt=!!(isWritable$5(Vt)||isWritableStream$3(Vt)||isTransformStream$3(Vt)),Jt=!!(isReadable$4(zt)||isReadableStream$4(zt)||isTransformStream$3(zt));if(Lt=new Duplex$3({writableObjectMode:!!(Vt!=null&&Vt.writableObjectMode),readableObjectMode:!!(zt!=null&&zt.readableObjectMode),writable:Wt,readable:Jt}),Wt){if(isNodeStream$6(Vt))Lt._write=function(Xt,tr,rr){Vt.write(Xt,tr)?rr():Bt=rr},Lt._final=function(Xt){Vt.end(),Nt=Xt},Vt.on("drain",function(){if(Bt){const Xt=Bt;Bt=null,Xt()}});else if(isWebStream$3(Vt)){const tr=(isTransformStream$3(Vt)?Vt.writable:Vt).getWriter();Lt._write=async function(rr,nr,ar){try{await tr.ready,tr.write(rr).catch(()=>{}),ar()}catch(ir){ar(ir)}},Lt._final=async function(rr){try{await tr.ready,tr.close().catch(()=>{}),Nt=rr}catch(nr){rr(nr)}}}const Qt=isTransformStream$3(zt)?zt.readable:zt;eos$3(Qt,()=>{if(Nt){const Xt=Nt;Nt=null,Xt()}})}if(Jt){if(isNodeStream$6(zt))zt.on("readable",function(){if(jt){const Qt=jt;jt=null,Qt()}}),zt.on("end",function(){Lt.push(null)}),Lt._read=function(){for(;;){const Qt=zt.read();if(Qt===null){jt=Lt._read;return}if(!Lt.push(Qt))return}};else if(isWebStream$3(zt)){const Xt=(isTransformStream$3(zt)?zt.readable:zt).getReader();Lt._read=async function(){for(;;)try{const{value:tr,done:rr}=await Xt.read();if(!Lt.push(tr))return;if(rr){Lt.push(null);return}}catch{return}}}}return Lt._destroy=function(Qt,Xt){!Qt&&Ut!==null&&(Qt=new AbortError$a),jt=null,Bt=null,Nt=null,Ut===null?Xt(Qt):(Ut=Xt,isNodeStream$6(zt)&&destroyer$3(zt,Qt))},Lt};const AbortController$2=globalThis.AbortController||requireBrowser().AbortController,{codes:{ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$4,ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$6,ERR_MISSING_ARGS:ERR_MISSING_ARGS$3,ERR_OUT_OF_RANGE:ERR_OUT_OF_RANGE$2},AbortError:AbortError$9}=errors$2,{validateAbortSignal:validateAbortSignal$4,validateInteger:validateInteger$2,validateObject:validateObject$4}=validators$1,kWeakHandler$1=primordials$1.Symbol("kWeak"),kResistStopPropagation=primordials$1.Symbol("kResistStopPropagation"),{finished:finished$2}=endOfStreamExports$1,staticCompose$1=compose$3,{addAbortSignalNoValidate:addAbortSignalNoValidate$1}=addAbortSignalExports$1,{isWritable:isWritable$4,isNodeStream:isNodeStream$5}=utils$2,{deprecate}=utilExports$1,{ArrayPrototypePush:ArrayPrototypePush$1,Boolean:Boolean$1,MathFloor:MathFloor$2,Number:Number$2,NumberIsNaN:NumberIsNaN$2,Promise:Promise$4,PromiseReject:PromiseReject$1,PromiseResolve,PromisePrototypeThen:PromisePrototypeThen$3,Symbol:Symbol$5}=primordials$1,kEmpty$1=Symbol$5("kEmpty"),kEof$1=Symbol$5("kEof");function compose$2(kt,At){if(At!=null&&validateObject$4(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal$4(At.signal,"options.signal"),isNodeStream$5(kt)&&!isWritable$4(kt))throw new ERR_INVALID_ARG_VALUE$4("stream",kt,"must be writable");const xt=staticCompose$1(this,kt);return At!=null&&At.signal&&addAbortSignalNoValidate$1(At.signal,xt),xt}function map$2(kt,At){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$6("fn",["Function","AsyncFunction"],kt);At!=null&&validateObject$4(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal$4(At.signal,"options.signal");let xt=1;(At==null?void 0:At.concurrency)!=null&&(xt=MathFloor$2(At.concurrency));let Bt=xt-1;return(At==null?void 0:At.highWaterMark)!=null&&(Bt=MathFloor$2(At.highWaterMark)),validateInteger$2(xt,"options.concurrency",1),validateInteger$2(Bt,"options.highWaterMark",0),Bt+=xt,(async function*(){const jt=utilExports$1.AbortSignalAny([At==null?void 0:At.signal].filter(Boolean$1)),Ut=this,Lt=[],Ht={signal:jt};let Vt,zt,Wt=!1,Jt=0;function Qt(){Wt=!0,Xt()}function Xt(){Jt-=1,tr()}function tr(){zt&&!Wt&&Jt<xt&&Lt.length<Bt&&(zt(),zt=null)}async function rr(){try{for await(let nr of Ut){if(Wt)return;if(jt.aborted)throw new AbortError$9;try{if(nr=kt(nr,Ht),nr===kEmpty$1)continue;nr=PromiseResolve(nr)}catch(ar){nr=PromiseReject$1(ar)}Jt+=1,PromisePrototypeThen$3(nr,Xt,Qt),Lt.push(nr),Vt&&(Vt(),Vt=null),!Wt&&(Lt.length>=Bt||Jt>=xt)&&await new Promise$4(ar=>{zt=ar})}Lt.push(kEof$1)}catch(nr){const ar=PromiseReject$1(nr);PromisePrototypeThen$3(ar,Xt,Qt),Lt.push(ar)}finally{Wt=!0,Vt&&(Vt(),Vt=null)}}rr();try{for(;;){for(;Lt.length>0;){const nr=await Lt[0];if(nr===kEof$1)return;if(jt.aborted)throw new AbortError$9;nr!==kEmpty$1&&(yield nr),Lt.shift(),tr()}await new Promise$4(nr=>{Vt=nr})}}finally{Wt=!0,zt&&(zt(),zt=null)}}).call(this)}function asIndexedPairs$1(kt=void 0){return kt!=null&&validateObject$4(kt,"options"),(kt==null?void 0:kt.signal)!=null&&validateAbortSignal$4(kt.signal,"options.signal"),(async function*(){let xt=0;for await(const Nt of this){var Bt;if(kt!=null&&(Bt=kt.signal)!==null&&Bt!==void 0&&Bt.aborted)throw new AbortError$9({cause:kt.signal.reason});yield[xt++,Nt]}}).call(this)}async function some$1(kt,At=void 0){for await(const xt of filter$2.call(this,kt,At))return!0;return!1}async function every$1(kt,At=void 0){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$6("fn",["Function","AsyncFunction"],kt);return!await some$1.call(this,async(...xt)=>!await kt(...xt),At)}async function find$1(kt,At){for await(const xt of filter$2.call(this,kt,At))return xt}async function forEach$1(kt,At){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$6("fn",["Function","AsyncFunction"],kt);async function xt(Bt,Nt){return await kt(Bt,Nt),kEmpty$1}for await(const Bt of map$2.call(this,xt,At));}function filter$2(kt,At){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$6("fn",["Function","AsyncFunction"],kt);async function xt(Bt,Nt){return await kt(Bt,Nt)?Bt:kEmpty$1}return map$2.call(this,xt,At)}let ReduceAwareErrMissingArgs$1=class extends ERR_MISSING_ARGS$3{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function reduce$1(kt,At,xt){var Bt;if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$6("reducer",["Function","AsyncFunction"],kt);xt!=null&&validateObject$4(xt,"options"),(xt==null?void 0:xt.signal)!=null&&validateAbortSignal$4(xt.signal,"options.signal");let Nt=arguments.length>1;if(xt!=null&&(Bt=xt.signal)!==null&&Bt!==void 0&&Bt.aborted){const Vt=new AbortError$9(void 0,{cause:xt.signal.reason});throw this.once("error",()=>{}),await finished$2(this.destroy(Vt)),Vt}const jt=new AbortController$2,Ut=jt.signal;if(xt!=null&&xt.signal){const Vt={once:!0,[kWeakHandler$1]:this,[kResistStopPropagation]:!0};xt.signal.addEventListener("abort",()=>jt.abort(),Vt)}let Lt=!1;try{for await(const Vt of this){var Ht;if(Lt=!0,xt!=null&&(Ht=xt.signal)!==null&&Ht!==void 0&&Ht.aborted)throw new AbortError$9;Nt?At=await kt(At,Vt,{signal:Ut}):(At=Vt,Nt=!0)}if(!Lt&&!Nt)throw new ReduceAwareErrMissingArgs$1}finally{jt.abort()}return At}async function toArray$1(kt){kt!=null&&validateObject$4(kt,"options"),(kt==null?void 0:kt.signal)!=null&&validateAbortSignal$4(kt.signal,"options.signal");const At=[];for await(const Bt of this){var xt;if(kt!=null&&(xt=kt.signal)!==null&&xt!==void 0&&xt.aborted)throw new AbortError$9(void 0,{cause:kt.signal.reason});ArrayPrototypePush$1(At,Bt)}return At}function flatMap$1(kt,At){const xt=map$2.call(this,kt,At);return(async function*(){for await(const Nt of xt)yield*Nt}).call(this)}function toIntegerOrInfinity$1(kt){if(kt=Number$2(kt),NumberIsNaN$2(kt))return 0;if(kt<0)throw new ERR_OUT_OF_RANGE$2("number",">= 0",kt);return kt}function drop$1(kt,At=void 0){return At!=null&&validateObject$4(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal$4(At.signal,"options.signal"),kt=toIntegerOrInfinity$1(kt),(async function*(){var Bt;if(At!=null&&(Bt=At.signal)!==null&&Bt!==void 0&&Bt.aborted)throw new AbortError$9;for await(const jt of this){var Nt;if(At!=null&&(Nt=At.signal)!==null&&Nt!==void 0&&Nt.aborted)throw new AbortError$9;kt--<=0&&(yield jt)}}).call(this)}function take$1(kt,At=void 0){return At!=null&&validateObject$4(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal$4(At.signal,"options.signal"),kt=toIntegerOrInfinity$1(kt),(async function*(){var Bt;if(At!=null&&(Bt=At.signal)!==null&&Bt!==void 0&&Bt.aborted)throw new AbortError$9;for await(const jt of this){var Nt;if(At!=null&&(Nt=At.signal)!==null&&Nt!==void 0&&Nt.aborted)throw new AbortError$9;if(kt-- >0&&(yield jt),kt<=0)return}}).call(this)}operators$1.streamReturningOperators={asIndexedPairs:deprecate(asIndexedPairs$1,"readable.asIndexedPairs will be removed in a future version."),drop:drop$1,filter:filter$2,flatMap:flatMap$1,map:map$2,take:take$1,compose:compose$2};operators$1.promiseReturningOperators={every:every$1,forEach:forEach$1,reduce:reduce$1,toArray:toArray$1,some:some$1,find:find$1};var promises$1,hasRequiredPromises$1;function requirePromises$1(){if(hasRequiredPromises$1)return promises$1;hasRequiredPromises$1=1;const{ArrayPrototypePop:kt,Promise:At}=primordials$1,{isIterable:xt,isNodeStream:Bt,isWebStream:Nt}=utils$2,{pipelineImpl:jt}=pipeline_1$1,{finished:Ut}=endOfStreamExports$1;requireStream$1();function Lt(...Ht){return new At((Vt,zt)=>{let Wt,Jt;const Qt=Ht[Ht.length-1];if(Qt&&typeof Qt=="object"&&!Bt(Qt)&&!xt(Qt)&&!Nt(Qt)){const Xt=kt(Ht);Wt=Xt.signal,Jt=Xt.end}jt(Ht,(Xt,tr)=>{Xt?zt(Xt):Vt(tr)},{signal:Wt,end:Jt})})}return promises$1={finished:Ut,pipeline:Lt},promises$1}var hasRequiredStream$1;function requireStream$1(){if(hasRequiredStream$1)return stream$1.exports;hasRequiredStream$1=1;const{Buffer:kt}=buffer$2,{ObjectDefineProperty:At,ObjectKeys:xt,ReflectApply:Bt}=primordials$1,{promisify:{custom:Nt}}=utilExports$1,{streamReturningOperators:jt,promiseReturningOperators:Ut}=operators$1,{codes:{ERR_ILLEGAL_CONSTRUCTOR:Lt}}=errors$2,Ht=compose$3,{setDefaultHighWaterMark:Vt,getDefaultHighWaterMark:zt}=state$1,{pipeline:Wt}=pipeline_1$1,{destroyer:Jt}=destroy_1$1,Qt=endOfStreamExports$1,Xt=requirePromises$1(),tr=utils$2,rr=stream$1.exports=legacy$1.Stream;rr.isDestroyed=tr.isDestroyed,rr.isDisturbed=tr.isDisturbed,rr.isErrored=tr.isErrored,rr.isReadable=tr.isReadable,rr.isWritable=tr.isWritable,rr.Readable=requireReadable$1();for(const ar of xt(jt)){let lr=function(...yr){if(new.target)throw Lt();return rr.Readable.from(Bt(ir,this,yr))};const ir=jt[ar];At(lr,"name",{__proto__:null,value:ir.name}),At(lr,"length",{__proto__:null,value:ir.length}),At(rr.Readable.prototype,ar,{__proto__:null,value:lr,enumerable:!1,configurable:!0,writable:!0})}for(const ar of xt(Ut)){let lr=function(...yr){if(new.target)throw Lt();return Bt(ir,this,yr)};const ir=Ut[ar];At(lr,"name",{__proto__:null,value:ir.name}),At(lr,"length",{__proto__:null,value:ir.length}),At(rr.Readable.prototype,ar,{__proto__:null,value:lr,enumerable:!1,configurable:!0,writable:!0})}rr.Writable=requireWritable$1(),rr.Duplex=requireDuplex$1(),rr.Transform=transform$1,rr.PassThrough=passthrough$1,rr.pipeline=Wt;const{addAbortSignal:nr}=addAbortSignalExports$1;return rr.addAbortSignal=nr,rr.finished=Qt,rr.destroy=Jt,rr.compose=Ht,rr.setDefaultHighWaterMark=Vt,rr.getDefaultHighWaterMark=zt,At(rr,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return Xt}}),At(Wt,Nt,{__proto__:null,enumerable:!0,get(){return Xt.pipeline}}),At(Qt,Nt,{__proto__:null,enumerable:!0,get(){return Xt.finished}}),rr.Stream=rr,rr._isUint8Array=function(ir){return ir instanceof Uint8Array},rr._uint8ArrayToBuffer=function(ir){return kt.from(ir.buffer,ir.byteOffset,ir.byteLength)},stream$1.exports}(function(kt){const At=requireStream$1(),xt=requirePromises$1(),Bt=At.Readable.destroy;kt.exports=At.Readable,kt.exports._uint8ArrayToBuffer=At._uint8ArrayToBuffer,kt.exports._isUint8Array=At._isUint8Array,kt.exports.isDisturbed=At.isDisturbed,kt.exports.isErrored=At.isErrored,kt.exports.isReadable=At.isReadable,kt.exports.Readable=At.Readable,kt.exports.Writable=At.Writable,kt.exports.Duplex=At.Duplex,kt.exports.Transform=At.Transform,kt.exports.PassThrough=At.PassThrough,kt.exports.addAbortSignal=At.addAbortSignal,kt.exports.finished=At.finished,kt.exports.destroy=At.destroy,kt.exports.destroy=Bt,kt.exports.pipeline=At.pipeline,kt.exports.compose=At.compose,Object.defineProperty(At,"promises",{configurable:!0,enumerable:!0,get(){return xt}}),kt.exports.Stream=At.Stream,kt.exports.default=kt.exports})(browser$2);var browserExports$1=browser$2.exports,__awaiter$2A=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};dist.ECIES_CONFIG.isEphemeralKeyCompressed=!0;class Encryption{static aes256CtrEncrypt(At,xt,Bt){return __awaiter$2A(this,void 0,void 0,function*(){const Nt=cryptoBrowserifyExports.createCipheriv("aes-256-ctr",At,xt),jt=new browserExports$1.Readable({read(){}});return Bt.on("data",Ut=>{const Lt=Nt.update(Ut);jt.push(Lt)}),Bt.on("end",()=>{const Ut=Nt.final();jt.push(Ut),jt.push(null)}),Bt.on("error",Ut=>{jt.emit("error",Ut)}),jt})}static aes256CtrDecrypt(At,xt,Bt){return __awaiter$2A(this,void 0,void 0,function*(){const Nt=cryptoBrowserifyExports.createDecipheriv("aes-256-ctr",At,xt),jt=new browserExports$1.Readable({read(){}});return Bt.on("data",Ut=>{const Lt=Nt.update(Ut);jt.push(Lt)}),Bt.on("end",()=>{const Ut=Nt.final();jt.push(Ut),jt.push(null)}),Bt.on("error",Ut=>{jt.emit("error",Ut)}),jt})}static eciesSecp256k1Encrypt(At,xt){return __awaiter$2A(this,void 0,void 0,function*(){const Bt=buffer$2.Buffer.from(At),Nt=buffer$2.Buffer.from(xt),jt=dist.encrypt(Bt,Nt);let Ut=0,Lt=Encryption.isEphemeralKeyCompressed?33:65;const Ht=jt.subarray(Ut,Lt);Ut=Lt,Lt+=dist.ECIES_CONFIG.symmetricNonceLength;const Vt=jt.subarray(Ut,Lt);Ut=Lt,Lt+=16;const zt=jt.subarray(Ut,Lt);return{ciphertext:jt.subarray(Lt),ephemeralPublicKey:Ht,initializationVector:Vt,messageAuthenticationCode:zt}})}static eciesSecp256k1Decrypt(At){return __awaiter$2A(this,void 0,void 0,function*(){const xt=buffer$2.Buffer.from(At.privateKey),Bt=buffer$2.Buffer.concat([At.ephemeralPublicKey,At.initializationVector,At.messageAuthenticationCode,At.ciphertext]);return dist.decrypt(xt,Bt)})}static get isEphemeralKeyCompressed(){return dist.ECIES_CONFIG.isEphemeralKeyCompressed}}var EncryptionAlgorithm;(function(kt){kt.Aes256Ctr="A256CTR",kt.EciesSecp256k1="ECIES-ES256K"})(EncryptionAlgorithm||(EncryptionAlgorithm={}));var __awaiter$2z=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class GeneralJwsBuilder{constructor(At){this.jws=At}static create(At,xt=[]){return __awaiter$2z(this,void 0,void 0,function*(){const Bt={payload:Encoder$4.bytesToBase64Url(At),signatures:[]},Nt=new GeneralJwsBuilder(Bt);for(const jt of xt)yield Nt.addSignature(jt);return Nt})}addSignature(At){return __awaiter$2z(this,void 0,void 0,function*(){const xt={kid:At.keyId,alg:At.algorithm},Bt=JSON.stringify(xt),Nt=Encoder$4.stringToBase64Url(Bt),jt=`${Nt}.${this.jws.payload}`,Ut=Encoder$4.stringToBytes(jt),Lt=yield At.sign(Ut),Ht=Encoder$4.bytesToBase64Url(Lt);this.jws.signatures.push({protected:Nt,signature:Ht})})}getJws(){return this.jws}}const cr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function getWebcryptoSubtle(){if(cr&&typeof cr.subtle=="object"&&cr.subtle!=null)return cr.subtle;throw new Error("crypto.subtle must be defined")}function number$1(kt){if(!Number.isSafeInteger(kt)||kt<0)throw new Error(`positive integer expected, not ${kt}`)}function bool(kt){if(typeof kt!="boolean")throw new Error(`boolean expected, not ${kt}`)}function isBytes$6(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}function bytes$2(kt,...At){if(!isBytes$6(kt))throw new Error("Uint8Array expected");if(At.length>0&&!At.includes(kt.length))throw new Error(`Uint8Array expected of length ${At}, not of length=${kt.length}`)}function exists$2(kt,At=!0){if(kt.destroyed)throw new Error("Hash instance has been destroyed");if(At&&kt.finished)throw new Error("Hash#digest() has already been called")}function output$2(kt,At){bytes$2(kt);const xt=At.outputLen;if(kt.length<xt)throw new Error(`digestInto() expects output buffer of length at least ${xt}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u32$1=kt=>new Uint32Array(kt.buffer,kt.byteOffset,Math.floor(kt.byteLength/4)),createView$1=kt=>new DataView(kt.buffer,kt.byteOffset,kt.byteLength),isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$3(kt){if(typeof kt!="string")throw new Error(`string expected, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function toBytes$2(kt){if(typeof kt=="string")kt=utf8ToBytes$3(kt);else if(isBytes$6(kt))kt=kt.slice();else throw new Error(`Uint8Array expected, got ${typeof kt}`);return kt}function checkOpts$1(kt,At){if(At==null||typeof At!="object")throw new Error("options must be defined");return Object.assign(kt,At)}function equalBytes$1(kt,At){if(kt.length!==At.length)return!1;let xt=0;for(let Bt=0;Bt<kt.length;Bt++)xt|=kt[Bt]^At[Bt];return xt===0}const wrapCipher=(kt,At)=>(Object.assign(At,kt),At);function setBigUint64$1(kt,At,xt,Bt){if(typeof kt.setBigUint64=="function")return kt.setBigUint64(At,xt,Bt);const Nt=BigInt(32),jt=BigInt(4294967295),Ut=Number(xt>>Nt&jt),Lt=Number(xt&jt),Ht=4,Vt=0;kt.setUint32(At+Ht,Ut,Bt),kt.setUint32(At+Vt,Lt,Bt)}var __awaiter$2y=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},KeyDerivationScheme;(function(kt){kt.DataFormats="dataFormats",kt.ProtocolContext="protocolContext",kt.ProtocolPath="protocolPath",kt.Schemas="schemas"})(KeyDerivationScheme||(KeyDerivationScheme={}));class HdKey{static derivePrivateKey(At,xt){var Bt;return __awaiter$2y(this,void 0,void 0,function*(){const Nt=Secp256k1$3.privateJwkToBytes(At.derivedPrivateKey),jt=(Bt=At.derivationPath)!==null&&Bt!==void 0?Bt:[],Ut=yield HdKey.derivePrivateKeyBytes(Nt,xt),Lt=yield Secp256k1$3.privateKeyToJwk(Ut);return{rootKeyId:At.rootKeyId,derivationScheme:At.derivationScheme,derivationPath:[...jt,...xt],derivedPrivateKey:Lt}})}static derivePublicKey(At,xt){return __awaiter$2y(this,void 0,void 0,function*(){const Bt=yield HdKey.derivePrivateKey(At,xt);return yield Secp256k1$3.getPublicJwk(Bt.derivedPrivateKey)})}static derivePrivateKeyBytes(At,xt){return __awaiter$2y(this,void 0,void 0,function*(){HdKey.validateKeyDerivationPath(xt);let Bt=At;for(const Nt of xt){const jt=Encoder$4.stringToBytes(Nt);Bt=yield HdKey.deriveKeyUsingHkdf({hashAlgorithm:"SHA-256",initialKeyMaterial:Bt,info:jt,keyLengthInBytes:32})}return Bt})}static deriveKeyUsingHkdf(At){return __awaiter$2y(this,void 0,void 0,function*(){const{hashAlgorithm:xt,initialKeyMaterial:Bt,info:Nt,keyLengthInBytes:jt}=At,Lt=yield getWebcryptoSubtle().importKey("raw",Bt,{name:"HKDF"},!1,["deriveBits"]),Ht=yield crypto.subtle.deriveBits({name:"HKDF",hash:xt,salt:new Uint8Array(0),info:Nt},Lt,jt*8);return new Uint8Array(Ht)})}static validateKeyDerivationPath(At){if(At.includes(""))throw new DwnError(DwnErrorCode.HdKeyDerivationPathInvalid,`Invalid key derivation path: ${At}`)}}function lexicographicalCompare(kt,At){return kt>At?1:kt<At?-1:0}function isEmptyObject$1(kt){if(typeof kt!="object")return!1;for(const At in kt)return!1;return!0}function removeUndefinedProperties$2(kt){Object.keys(kt).forEach(At=>{kt[At]===void 0?delete kt[At]:typeof kt[At]=="object"&&removeUndefinedProperties$2(kt[At])})}var __awaiter$2x=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Message{static getAuthor(At){if(At.authorization===void 0)return;let xt;return At.authorization.authorDelegatedGrant!==void 0?xt=Message.getSigner(At.authorization.authorDelegatedGrant):xt=Message.getSigner(At),xt}static validateJsonSchema(At){const xt=At.descriptor.interface,Bt=At.descriptor.method,Nt=xt+Bt;validateJsonSchema(Nt,At)}static getSigner(At){return At.authorization===void 0?void 0:Jws.getSignerDid(At.authorization.signature.signatures[0])}static getCid(At){return __awaiter$2x(this,void 0,void 0,function*(){const xt=Object.assign({},At);return xt.encodedData&&delete xt.encodedData,yield Cid.computeCid(xt)})}static compareCid(At,xt){return __awaiter$2x(this,void 0,void 0,function*(){const Bt=yield Message.getCid(At),Nt=yield Message.getCid(xt);return lexicographicalCompare(Bt,Nt)})}static createAuthorization(At){return __awaiter$2x(this,void 0,void 0,function*(){const{descriptor:xt,signer:Bt,delegatedGrant:Nt,permissionGrantId:jt,protocolRole:Ut}=At;let Lt;Nt!==void 0&&(Lt=yield Message.getCid(Nt));const Vt={signature:yield Message.createSignature(xt,Bt,{delegatedGrantId:Lt,permissionGrantId:jt,protocolRole:Ut})};return Nt!==void 0&&(Vt.authorDelegatedGrant=Nt),Vt})}static createSignature(At,xt,Bt){return __awaiter$2x(this,void 0,void 0,function*(){const Nt=yield Cid.computeCid(At),jt=Object.assign({descriptorCid:Nt},Bt);removeUndefinedProperties$2(jt);const Ut=Encoder$4.objectToBytes(jt);return(yield GeneralJwsBuilder.create(Ut,[xt])).getJws()})}static getNewestMessage(At){return __awaiter$2x(this,void 0,void 0,function*(){let xt;for(const Bt of At)(xt===void 0||(yield Message.isNewer(Bt,xt)))&&(xt=Bt);return xt})}static getOldestMessage(At){return __awaiter$2x(this,void 0,void 0,function*(){let xt;for(const Bt of At)(xt===void 0||(yield Message.isOlder(Bt,xt)))&&(xt=Bt);return xt})}static isNewer(At,xt){return __awaiter$2x(this,void 0,void 0,function*(){return(yield Message.compareMessageTimestamp(At,xt))>0})}static isOlder(At,xt){return __awaiter$2x(this,void 0,void 0,function*(){return(yield Message.compareMessageTimestamp(At,xt))<0})}static isSignedByAuthorDelegate(At){var xt;return((xt=At.authorization)===null||xt===void 0?void 0:xt.authorDelegatedGrant)!==void 0}static isSignedByOwnerDelegate(At){var xt;return((xt=At.authorization)===null||xt===void 0?void 0:xt.ownerDelegatedGrant)!==void 0}static compareMessageTimestamp(At,xt){return __awaiter$2x(this,void 0,void 0,function*(){return At.descriptor.messageTimestamp>xt.descriptor.messageTimestamp?1:At.descriptor.messageTimestamp<xt.descriptor.messageTimestamp?-1:Message.compareCid(At,xt)})}static validateSignatureStructure(At,xt,Bt="GenericSignaturePayload"){return __awaiter$2x(this,void 0,void 0,function*(){if(At.signatures.length!==1)throw new DwnError(DwnErrorCode.AuthenticationMoreThanOneSignatureNotSupported,"expected no more than 1 signature for authorization purpose");const Nt=Jws.decodePlainObjectPayload(At);validateJsonSchema(Bt,Nt);const{descriptorCid:jt}=Nt,Ut=yield Cid.computeCid(xt);if(jt!==Ut)throw new DwnError(DwnErrorCode.AuthenticateDescriptorCidMismatch,`provided descriptorCid ${jt} does not match expected CID ${Ut}`);return Nt})}}var __awaiter$2w=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let PermissionGrant$1=class ls{static parse(At){return __awaiter$2w(this,void 0,void 0,function*(){return new ls(At)})}constructor(At){this.id=At.recordId,this.grantor=Message.getSigner(At),this.grantee=At.descriptor.recipient,this.dateGranted=At.descriptor.dateCreated;const xt=At.encodedData,Bt=Encoder$4.base64UrlToObject(xt);this.dateExpires=Bt.dateExpires,this.delegated=Bt.delegated,this.description=Bt.description,this.requestId=Bt.requestId,this.scope=Bt.scope,this.conditions=Bt.conditions}};var DateSort;(function(kt){kt.CreatedAscending="createdAscending",kt.CreatedDescending="createdDescending",kt.PublishedAscending="publishedAscending",kt.PublishedDescending="publishedDescending"})(DateSort||(DateSort={}));var __rest$z=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class FilterUtility{static matchAnyFilter(At,xt){if(xt.length===0)return!0;for(const Bt of xt)if(this.matchFilter(At,Bt))return!0;return!1}static matchFilter(At,xt){for(const Bt in xt){const Nt=xt[Bt],jt=At[Bt];if(jt===void 0||!(Array.isArray(jt)?this.matchAnyIndexValue(Nt,jt):this.matchIndexValue(Nt,jt)))return!1}return!0}static matchAnyIndexValue(At,xt){for(const Bt of xt)if(this.matchIndexValue(At,Bt))return!0;return!1}static matchIndexValue(At,xt){if(typeof At=="object"){if(Array.isArray(At)){if(this.matchOneOf(At,xt))return!0}else if(this.matchRange(At,xt))return!0}else if(xt===At)return!0;return!1}static matchOneOf(At,xt){for(const Bt of At)if(xt===Bt)return!0;return!1}static matchRange(At,xt){return!(At.lt!==void 0&&xt>=At.lt||At.lte!==void 0&&xt>At.lte||At.gt!==void 0&&xt<=At.gt||At.gte!==void 0&&xt<At.gte)}static isEqualFilter(At){return typeof At!="object"}static isRangeFilter(At){return typeof At=="object"&&!Array.isArray(At)?"gt"in At||"lt"in At||"lte"in At||"gte"in At:!1}static isOneOfFilter(At){return!!(typeof At=="object"&&Array.isArray(At))}static convertRangeCriterion(At){let xt;return At.to!==void 0&&At.from!==void 0?xt={gte:At.from,lt:At.to}:At.to!==void 0?xt={lt:At.to}:At.from!==void 0&&(xt={gte:At.from}),xt}static constructPrefixFilterAsRangeFilter(At){return{gte:At,lt:At+""}}}class FilterSelector{static reduceFilter(At){if(Object.keys(At).length<=1)return At;const{recordId:Bt,attester:Nt,parentId:jt,recipient:Ut,contextId:Lt,author:Ht,protocolPath:Vt,schema:zt,protocol:Wt}=At,Jt=__rest$z(At,["recordId","attester","parentId","recipient","contextId","author","protocolPath","schema","protocol"]);if(Bt!==void 0)return{recordId:Bt};if(Nt!==void 0)return{attester:Nt};if(jt!==void 0)return{parentId:jt};if(Ut!==void 0)return{recipient:Ut};if(Lt!==void 0)return{contextId:Lt};if(Vt!==void 0)return{protocolPath:Vt};if(zt!==void 0)return{schema:zt};if(Wt!==void 0)return{protocol:Wt};const Xt=Object.keys(Jt)[0],tr={};return tr[Xt]=At[Xt],tr}}var DwnInterfaceName;(function(kt){kt.Messages="Messages",kt.Protocols="Protocols",kt.Records="Records"})(DwnInterfaceName||(DwnInterfaceName={}));var DwnMethodName;(function(kt){kt.Configure="Configure",kt.Query="Query",kt.Read="Read",kt.Write="Write",kt.Delete="Delete",kt.Subscribe="Subscribe"})(DwnMethodName||(DwnMethodName={}));function validateProtocolUrlNormalized(kt){let At;try{At=normalizeProtocolUrl(kt)}catch{At=void 0}if(kt!==At)throw new DwnError(DwnErrorCode.UrlProtocolNotNormalized,`Protocol URI ${kt} must be normalized.`)}function normalizeProtocolUrl(kt){return normalizeUrl(kt)}function validateSchemaUrlNormalized(kt){let At;try{At=normalizeSchemaUrl(kt)}catch{At=void 0}if(kt!==At)throw new DwnError(DwnErrorCode.UrlSchemaNotNormalized,`Schema URI ${kt} must be normalized.`)}function normalizeSchemaUrl(kt){return normalizeUrl(kt)}function normalizeUrl(kt){let At;/^[^:]+:(\/{2})?[^\/].*/.test(kt)?At=kt:At=`http://${kt}`;try{const xt=new URL(At);return xt.search="",xt.hash="",removeTrailingSlash(xt.href)}catch{throw new DwnError(DwnErrorCode.UrlProtocolNotNormalizable,"Could not normalize protocol URI")}}function removeTrailingSlash(kt){return kt.endsWith("/")?kt.slice(0,-1):kt}var __awaiter$2v=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$y=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Records{static isRecordsWrite(At){return At.descriptor.interface===DwnInterfaceName.Records&&At.descriptor.method===DwnMethodName.Write}static decrypt(At,xt,Bt){return __awaiter$2v(this,void 0,void 0,function*(){const{encryption:Nt}=At,jt=Nt.keyEncryption.find(tr=>tr.rootKeyId===xt.rootKeyId&&tr.derivationScheme===xt.derivationScheme);if(jt===void 0)throw new DwnError(DwnErrorCode.RecordsDecryptNoMatchingKeyEncryptedFound,`Unable to find a symmetric key encrypted using key         with ID '${xt.rootKeyId}' and '${xt.derivationScheme}' derivation scheme.`);const Ut=Records.constructKeyDerivationPath(jt.derivationScheme,At),Lt=yield Records.derivePrivateKey(xt,Ut),Ht=Encoder$4.base64UrlToBytes(jt.encryptedKey),Vt=Secp256k1$3.publicJwkToBytes(jt.ephemeralPublicKey),zt=Encoder$4.base64UrlToBytes(jt.initializationVector),Wt=Encoder$4.base64UrlToBytes(jt.messageAuthenticationCode),Jt=yield Encryption.eciesSecp256k1Decrypt({ciphertext:Ht,ephemeralPublicKey:Vt,initializationVector:zt,messageAuthenticationCode:Wt,privateKey:Lt}),Qt=Encoder$4.base64UrlToBytes(Nt.initializationVector);return yield Encryption.aes256CtrDecrypt(Jt,Qt,Bt)})}static constructKeyDerivationPath(At,xt){const Bt=xt.descriptor,Nt=xt.contextId;let jt;return At===KeyDerivationScheme.DataFormats?jt=Records.constructKeyDerivationPathUsingDataFormatsScheme(Bt.schema,Bt.dataFormat):At===KeyDerivationScheme.ProtocolPath?jt=Records.constructKeyDerivationPathUsingProtocolPathScheme(Bt):At===KeyDerivationScheme.ProtocolContext?jt=Records.constructKeyDerivationPathUsingProtocolContextScheme(Nt):jt=Records.constructKeyDerivationPathUsingSchemasScheme(Bt.schema),jt}static constructKeyDerivationPathUsingDataFormatsScheme(At,xt){return At!==void 0?[KeyDerivationScheme.DataFormats,At,xt]:[KeyDerivationScheme.DataFormats,xt]}static constructKeyDerivationPathUsingProtocolPathScheme(At){if(At.protocol===void 0)throw new DwnError(DwnErrorCode.RecordsProtocolPathDerivationSchemeMissingProtocol,"Unable to construct key derivation path using `protocols` scheme because `protocol` is missing.");const xt=At.protocolPath.split("/");return[KeyDerivationScheme.ProtocolPath,At.protocol,...xt]}static constructKeyDerivationPathUsingProtocolContextScheme(At){if(At===void 0)throw new DwnError(DwnErrorCode.RecordsProtocolContextDerivationSchemeMissingContextId,"Unable to construct key derivation path using `protocolContext` scheme because `contextId` is missing.");const xt=At.split("/")[0];return[KeyDerivationScheme.ProtocolContext,xt]}static constructKeyDerivationPathUsingSchemasScheme(At){if(At===void 0)throw new DwnError(DwnErrorCode.RecordsSchemasDerivationSchemeMissingSchema,"Unable to construct key derivation path using `schemas` scheme because `schema` is missing.");return[KeyDerivationScheme.Schemas,At]}static derivePrivateKey(At,xt){var Bt;return __awaiter$2v(this,void 0,void 0,function*(){if(At.derivedPrivateKey.crv!=="secp256k1")throw new DwnError(DwnErrorCode.RecordsDerivePrivateKeyUnSupportedCurve,`Curve ${At.derivedPrivateKey.crv} is not supported.`);const Nt=(Bt=At.derivationPath)!==null&&Bt!==void 0?Bt:[];Records.validateAncestorKeyAndDescentKeyDerivationPathsMatch(Nt,xt);const jt=xt.slice(Nt.length),Ut=Secp256k1$3.privateJwkToBytes(At.derivedPrivateKey);return yield HdKey.derivePrivateKeyBytes(Ut,jt)})}static validateAncestorKeyAndDescentKeyDerivationPathsMatch(At,xt){for(let Bt=0;Bt<At.length;Bt++){const Nt=At[Bt],jt=xt[Bt];if(Nt!==jt)throw new DwnError(DwnErrorCode.RecordsInvalidAncestorKeyDerivationSegment,`Ancestor key derivation segment '${Nt}' mismatches against the descendant key derivation segment '${jt}'.`)}}static getParentContextFromOfContextId(At){if(At===void 0)return;const xt=At.lastIndexOf("/");return xt===-1?"":At.substring(0,xt)}static normalizeFilter(At){let xt;At.protocol===void 0?xt=void 0:xt=normalizeProtocolUrl(At.protocol);let Bt;At.schema===void 0?Bt=void 0:Bt=normalizeSchemaUrl(At.schema);const Nt=Object.assign(Object.assign({},At),{protocol:xt,schema:Bt});return removeUndefinedProperties$2(Nt),Nt}static isStartsWithFilter(At){return typeof At=="object"&&"startsWith"in At&&typeof At.startsWith=="string"}static buildTagIndexes(At){const xt={};for(const Bt in At){const Nt=At[Bt];xt[`tag.${Bt}`]=Nt}return xt}static convertTagsFilter(At){const xt={};for(const Bt in At){const Nt=At[Bt];xt[`tag.${Bt}`]=this.isStartsWithFilter(Nt)?FilterUtility.constructPrefixFilterAsRangeFilter(Nt.startsWith):Nt}return xt}static convertFilter(At,xt){const{tags:Bt}=At,Nt=__rest$y(At,["tags"]);let jt={};Bt!==void 0&&(jt=Object.assign({},this.convertTagsFilter(Bt)));const Ut=Object.assign(Object.assign({},Nt),jt),{dateCreated:Lt,datePublished:Ht,dateUpdated:Vt,contextId:zt}=At,Wt=Lt?FilterUtility.convertRangeCriterion(Lt):void 0;Wt&&(Ut.dateCreated=Wt);const Jt=Ht?FilterUtility.convertRangeCriterion(Ht):void 0;Jt&&(Ut.published=!0,Ut.datePublished=Jt),Ut.published!==!0&&(xt===DateSort.PublishedAscending||xt===DateSort.PublishedDescending)&&(Ut.published=!0);const Qt=Vt?FilterUtility.convertRangeCriterion(Vt):void 0;Qt&&(Ut.messageTimestamp=Qt,delete Ut.dateUpdated);const Xt=zt?FilterUtility.constructPrefixFilterAsRangeFilter(zt):void 0;return Xt&&(Ut.contextId=Xt),Array.isArray(Ut.author)&&Ut.author.length===0&&delete Ut.author,Array.isArray(Ut.recipient)&&Ut.recipient.length===0&&delete Ut.recipient,Ut}static validateDelegatedGrantReferentialIntegrity(At,xt,Bt){var Nt,jt;return __awaiter$2v(this,void 0,void 0,function*(){const Ut=(xt==null?void 0:xt.delegatedGrantId)!==void 0,Lt=((Nt=At.authorization)===null||Nt===void 0?void 0:Nt.authorDelegatedGrant)!==void 0;if(Ut!==Lt)throw new DwnError(DwnErrorCode.RecordsAuthorDelegatedGrantAndIdExistenceMismatch,`delegatedGrantId in message (author) signature and authorDelegatedGrant must both exist or be undefined.          delegatedGrantId in message (author) signature defined: ${Ut},          authorDelegatedGrant defined: ${Lt}`);if(Lt){const zt=At.authorization.authorDelegatedGrant;if((yield PermissionGrant$1.parse(zt)).delegated!==!0)throw new DwnError(DwnErrorCode.RecordsAuthorDelegatedGrantNotADelegatedGrant,"The owner delegated grant given is not a delegated grant.");const Jt=zt.descriptor.recipient,Qt=Message.getSigner(At);if(Jt!==Qt)throw new DwnError(DwnErrorCode.RecordsAuthorDelegatedGrantGrantedToAndOwnerSignatureMismatch,`grantedTo ${Jt} in author delegated grant must be the same as the signer ${Qt} of the message signature.`);const Xt=yield Message.getCid(zt);if(Xt!==xt.delegatedGrantId)throw new DwnError(DwnErrorCode.RecordsAuthorDelegatedGrantCidMismatch,`CID of the author delegated grant ${Xt} must be the same as           the delegatedGrantId ${xt.delegatedGrantId} in the message signature.`)}const Ht=(Bt==null?void 0:Bt.delegatedGrantId)!==void 0,Vt=((jt=At.authorization)===null||jt===void 0?void 0:jt.ownerDelegatedGrant)!==void 0;if(Ht!==Vt)throw new DwnError(DwnErrorCode.RecordsOwnerDelegatedGrantAndIdExistenceMismatch,`delegatedGrantId in owner signature and ownerDelegatedGrant must both exist or be undefined.          delegatedGrantId in owner signature defined: ${Ht},          ownerDelegatedGrant defined: ${Vt}`);if(Vt){const zt=At.authorization.ownerDelegatedGrant;if((yield PermissionGrant$1.parse(zt)).delegated!==!0)throw new DwnError(DwnErrorCode.RecordsOwnerDelegatedGrantNotADelegatedGrant,"The owner delegated grant given is not a delegated grant.");const Jt=zt.descriptor.recipient,Qt=Jws.getSignerDid(At.authorization.ownerSignature.signatures[0]);if(Jt!==Qt)throw new DwnError(DwnErrorCode.RecordsOwnerDelegatedGrantGrantedToAndOwnerSignatureMismatch,`grantedTo ${Jt} in owner delegated grant must be the same as the signer ${Qt} of the owner signature.`);const Xt=yield Message.getCid(zt);if(Xt!==Bt.delegatedGrantId)throw new DwnError(DwnErrorCode.RecordsOwnerDelegatedGrantCidMismatch,`CID of the owner delegated grant ${Xt} must be the same as           the delegatedGrantId ${Bt.delegatedGrantId} in the owner signature.`)}})}static shouldProtocolAuthorize(At){return At.protocolRole!==void 0}static filterIncludesPublishedRecords(At){return At.datePublished!==void 0||At.published!==!1}static filterIncludesUnpublishedRecords(At){return At.datePublished===void 0&&At.published===void 0?!0:At.published===!1}static canPerformDeleteAgainstRecord(At,xt){if(xt===void 0)return!1;if(xt.descriptor.method===DwnMethodName.Delete){if(At.descriptor.prune!==!0)return!1;if(xt.descriptor.prune===!0)return!1}return!0}static shouldBuildUnpublishedRecipientFilter(At,xt){const{recipient:Bt}=At;return Array.isArray(Bt)?Bt.length===0||Bt.includes(xt):Bt===void 0||Bt===xt}static shouldBuildUnpublishedAuthorFilter(At,xt){const{author:Bt}=At;return Array.isArray(Bt)?Bt.length===0||Bt.includes(xt):Bt===void 0||Bt===xt}}var __awaiter$2u=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class GrantAuthorization{static performBaseValidation(At){return __awaiter$2u(this,void 0,void 0,function*(){const{incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}=At,Lt=xt.descriptor;GrantAuthorization.verifyExpectedGrantorAndGrantee(Bt,Nt,jt);const Ht=Bt;yield GrantAuthorization.verifyGrantActive(Ht,Lt.messageTimestamp,jt,Ut),yield GrantAuthorization.verifyGrantScopeInterfaceAndMethod(Lt.interface,Lt.method,jt)})}static verifyExpectedGrantorAndGrantee(At,xt,Bt){const Nt=Bt.grantee;if(xt!==Nt)throw new DwnError(DwnErrorCode.GrantAuthorizationNotGrantedToAuthor,`Permission grant is granted to ${Nt}, but need to be granted to ${xt}`);const jt=Bt.grantor;if(At!==jt)throw new DwnError(DwnErrorCode.GrantAuthorizationNotGrantedForTenant,`Permission grant is granted by ${jt}, but need to be granted by ${At}`)}static verifyGrantActive(At,xt,Bt,Nt){return __awaiter$2u(this,void 0,void 0,function*(){if(xt<Bt.dateGranted)throw new DwnError(DwnErrorCode.GrantAuthorizationGrantNotYetActive,"The message has a timestamp before the associated permission grant becomes active");if(xt>=Bt.dateExpires)throw new DwnError(DwnErrorCode.GrantAuthorizationGrantExpired,"The message has timestamp after the expiry of the associated permission grant");const jt={parentId:Bt.id,protocolPath:"grant/revocation",isLatestBaseState:!0},{messages:Ut}=yield Nt.query(At,[jt]),Lt=yield Message.getOldestMessage(Ut);if(Lt!==void 0&&Lt.descriptor.messageTimestamp<=xt)throw new DwnError(DwnErrorCode.GrantAuthorizationGrantRevoked,`Permission grant with CID ${Bt.id} has been revoked`)})}static verifyGrantScopeInterfaceAndMethod(At,xt,Bt){return __awaiter$2u(this,void 0,void 0,function*(){if(At!==Bt.scope.interface)throw new DwnError(DwnErrorCode.GrantAuthorizationInterfaceMismatch,`DWN Interface of incoming message is outside the scope of permission grant with ID ${Bt.id}`);if(xt!==Bt.scope.method)throw new DwnError(DwnErrorCode.GrantAuthorizationMethodMismatch,`DWN Method of incoming message is outside the scope of permission grant with ID ${Bt.id}`)})}}var PermissionConditionPublication;(function(kt){kt.Required="Required",kt.Prohibited="Prohibited"})(PermissionConditionPublication||(PermissionConditionPublication={}));var __awaiter$2t=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsGrantAuthorization{static authorizeWrite(At){return __awaiter$2t(this,void 0,void 0,function*(){const{recordsWriteMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}),RecordsGrantAuthorization.verifyScope(xt,jt.scope),RecordsGrantAuthorization.verifyConditions(xt,jt.conditions)})}static authorizeRead(At){return __awaiter$2t(this,void 0,void 0,function*(){const{recordsReadMessage:xt,recordsWriteMessageToBeRead:Bt,expectedGrantor:Nt,expectedGrantee:jt,permissionGrant:Ut,messageStore:Lt}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Nt,expectedGrantee:jt,permissionGrant:Ut,messageStore:Lt}),RecordsGrantAuthorization.verifyScope(Bt,Ut.scope)})}static authorizeQueryOrSubscribe(At){return __awaiter$2t(this,void 0,void 0,function*(){const{incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut});const Ht=jt.scope.protocol,Vt=xt.descriptor.filter.protocol;if(Ht!==void 0&&Vt!==Ht)throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationQueryOrSubscribeProtocolScopeMismatch,`Grant protocol scope ${Ht} does not match protocol in message ${Vt}`)})}static authorizeDelete(At){return __awaiter$2t(this,void 0,void 0,function*(){const{recordsDeleteMessage:xt,recordsWriteToDelete:Bt,expectedGrantor:Nt,expectedGrantee:jt,permissionGrant:Ut,messageStore:Lt}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Nt,expectedGrantee:jt,permissionGrant:Ut,messageStore:Lt});const Vt=Ut.scope.protocol,zt=Bt.descriptor.protocol;if(Vt!==void 0&&zt!==Vt)throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationDeleteProtocolScopeMismatch,`Grant protocol scope ${Vt} does not match protocol in record to delete ${zt}`)})}static verifyScope(At,xt){if(xt.protocol!==At.descriptor.protocol)throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationScopeProtocolMismatch,"Grant scope specifies different protocol than what appears in the record");if(xt.contextId!==void 0&&(At.contextId===void 0||!At.contextId.startsWith(xt.contextId)))throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationScopeContextIdMismatch,"Grant scope specifies different contextId than what appears in the record");if(xt.protocolPath!==void 0&&xt.protocolPath!==At.descriptor.protocolPath)throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationScopeProtocolPathMismatch,"Grant scope specifies different protocolPath than what appears in the record")}static verifyConditions(At,xt){if((xt==null?void 0:xt.publication)===PermissionConditionPublication.Required&&!At.descriptor.published)throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationConditionPublicationRequired,"Permission grant requires message to be published");if((xt==null?void 0:xt.publication)===PermissionConditionPublication.Prohibited&&At.descriptor.published)throw new DwnError(DwnErrorCode.RecordsGrantAuthorizationConditionPublicationProhibited,"Permission grant prohibits message from being published")}}class JSBI extends Array{constructor(At,xt){if(super(At),this.sign=xt,Object.setPrototypeOf(this,JSBI.prototype),At>JSBI.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(At){var xt=Math.floor,Bt=Number.isFinite;if(typeof At=="number"){if(At===0)return JSBI.__zero();if(JSBI.__isOneDigitInt(At))return 0>At?JSBI.__oneDigit(-At,!0):JSBI.__oneDigit(At,!1);if(!Bt(At)||xt(At)!==At)throw new RangeError("The number "+At+" cannot be converted to BigInt because it is not an integer");return JSBI.__fromDouble(At)}if(typeof At=="string"){const Nt=JSBI.__fromString(At);if(Nt===null)throw new SyntaxError("Cannot convert "+At+" to a BigInt");return Nt}if(typeof At=="boolean")return At===!0?JSBI.__oneDigit(1,!1):JSBI.__zero();if(typeof At=="object"){if(At.constructor===JSBI)return At;const Nt=JSBI.__toPrimitive(At);return JSBI.BigInt(Nt)}throw new TypeError("Cannot convert "+At+" to a BigInt")}toDebugString(){const At=["BigInt["];for(const xt of this)At.push((xt&&(xt>>>0).toString(16))+", ");return At.push("]"),At.join("")}toString(At=10){if(2>At||36<At)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":At&At-1?JSBI.__toStringGeneric(this,At,!1):JSBI.__toStringBasePowerOfTwo(this,At)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(At){const xt=At.length;if(xt===0)return 0;if(xt===1){const rr=At.__unsignedDigit(0);return At.sign?-rr:rr}const Bt=At.__digit(xt-1),Nt=JSBI.__clz30(Bt),jt=30*xt-Nt;if(1024<jt)return At.sign?-1/0:1/0;let Ut=jt-1,Lt=Bt,Ht=xt-1;const Vt=Nt+3;let zt=Vt===32?0:Lt<<Vt;zt>>>=12;const Wt=Vt-12;let Jt=12<=Vt?0:Lt<<20+Vt,Qt=20+Vt;for(0<Wt&&0<Ht&&(Ht--,Lt=At.__digit(Ht),zt|=Lt>>>30-Wt,Jt=Lt<<Wt+2,Qt=Wt+2);0<Qt&&0<Ht;)Ht--,Lt=At.__digit(Ht),Jt|=30<=Qt?Lt<<Qt-30:Lt>>>30-Qt,Qt-=30;const Xt=JSBI.__decideRounding(At,Qt,Ht,Lt);if((Xt===1||Xt===0&&(1&Jt)==1)&&(Jt=Jt+1>>>0,Jt===0&&(zt++,zt>>>20!=0&&(zt=0,Ut++,1023<Ut))))return At.sign?-1/0:1/0;const tr=At.sign?-2147483648:0;return Ut=Ut+1023<<20,JSBI.__kBitConversionInts[1]=tr|Ut|zt,JSBI.__kBitConversionInts[0]=Jt,JSBI.__kBitConversionDouble[0]}static unaryMinus(At){if(At.length===0)return At;const xt=At.__copy();return xt.sign=!At.sign,xt}static bitwiseNot(At){return At.sign?JSBI.__absoluteSubOne(At).__trim():JSBI.__absoluteAddOne(At,!0)}static exponentiate(At,xt){if(xt.sign)throw new RangeError("Exponent must be positive");if(xt.length===0)return JSBI.__oneDigit(1,!1);if(At.length===0)return At;if(At.length===1&&At.__digit(0)===1)return At.sign&&!(1&xt.__digit(0))?JSBI.unaryMinus(At):At;if(1<xt.length)throw new RangeError("BigInt too big");let Bt=xt.__unsignedDigit(0);if(Bt===1)return At;if(Bt>=JSBI.__kMaxLengthBits)throw new RangeError("BigInt too big");if(At.length===1&&At.__digit(0)===2){const Ut=1+(0|Bt/30),Lt=At.sign&&(1&Bt)!=0,Ht=new JSBI(Ut,Lt);Ht.__initializeDigits();const Vt=1<<Bt%30;return Ht.__setDigit(Ut-1,Vt),Ht}let Nt=null,jt=At;for(1&Bt&&(Nt=At),Bt>>=1;Bt!==0;Bt>>=1)jt=JSBI.multiply(jt,jt),1&Bt&&(Nt===null?Nt=jt:Nt=JSBI.multiply(Nt,jt));return Nt}static multiply(At,xt){if(At.length===0)return At;if(xt.length===0)return xt;let Bt=At.length+xt.length;30<=At.__clzmsd()+xt.__clzmsd()&&Bt--;const Nt=new JSBI(Bt,At.sign!==xt.sign);Nt.__initializeDigits();for(let jt=0;jt<At.length;jt++)JSBI.__multiplyAccumulate(xt,At.__digit(jt),Nt,jt);return Nt.__trim()}static divide(At,xt){if(xt.length===0)throw new RangeError("Division by zero");if(0>JSBI.__absoluteCompare(At,xt))return JSBI.__zero();const Bt=At.sign!==xt.sign,Nt=xt.__unsignedDigit(0);let jt;if(xt.length===1&&32767>=Nt){if(Nt===1)return Bt===At.sign?At:JSBI.unaryMinus(At);jt=JSBI.__absoluteDivSmall(At,Nt,null)}else jt=JSBI.__absoluteDivLarge(At,xt,!0,!1);return jt.sign=Bt,jt.__trim()}static remainder(At,xt){if(xt.length===0)throw new RangeError("Division by zero");if(0>JSBI.__absoluteCompare(At,xt))return At;const Bt=xt.__unsignedDigit(0);if(xt.length===1&&32767>=Bt){if(Bt===1)return JSBI.__zero();const jt=JSBI.__absoluteModSmall(At,Bt);return jt===0?JSBI.__zero():JSBI.__oneDigit(jt,At.sign)}const Nt=JSBI.__absoluteDivLarge(At,xt,!1,!0);return Nt.sign=At.sign,Nt.__trim()}static add(At,xt){const Bt=At.sign;return Bt===xt.sign?JSBI.__absoluteAdd(At,xt,Bt):0<=JSBI.__absoluteCompare(At,xt)?JSBI.__absoluteSub(At,xt,Bt):JSBI.__absoluteSub(xt,At,!Bt)}static subtract(At,xt){const Bt=At.sign;return Bt===xt.sign?0<=JSBI.__absoluteCompare(At,xt)?JSBI.__absoluteSub(At,xt,Bt):JSBI.__absoluteSub(xt,At,!Bt):JSBI.__absoluteAdd(At,xt,Bt)}static leftShift(At,xt){return xt.length===0||At.length===0?At:xt.sign?JSBI.__rightShiftByAbsolute(At,xt):JSBI.__leftShiftByAbsolute(At,xt)}static signedRightShift(At,xt){return xt.length===0||At.length===0?At:xt.sign?JSBI.__leftShiftByAbsolute(At,xt):JSBI.__rightShiftByAbsolute(At,xt)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(At,xt){return 0>JSBI.__compareToBigInt(At,xt)}static lessThanOrEqual(At,xt){return 0>=JSBI.__compareToBigInt(At,xt)}static greaterThan(At,xt){return 0<JSBI.__compareToBigInt(At,xt)}static greaterThanOrEqual(At,xt){return 0<=JSBI.__compareToBigInt(At,xt)}static equal(At,xt){if(At.sign!==xt.sign||At.length!==xt.length)return!1;for(let Bt=0;Bt<At.length;Bt++)if(At.__digit(Bt)!==xt.__digit(Bt))return!1;return!0}static notEqual(At,xt){return!JSBI.equal(At,xt)}static bitwiseAnd(At,xt){var Bt=Math.max;if(!At.sign&&!xt.sign)return JSBI.__absoluteAnd(At,xt).__trim();if(At.sign&&xt.sign){const Nt=Bt(At.length,xt.length)+1;let jt=JSBI.__absoluteSubOne(At,Nt);const Ut=JSBI.__absoluteSubOne(xt);return jt=JSBI.__absoluteOr(jt,Ut,jt),JSBI.__absoluteAddOne(jt,!0,jt).__trim()}return At.sign&&([At,xt]=[xt,At]),JSBI.__absoluteAndNot(At,JSBI.__absoluteSubOne(xt)).__trim()}static bitwiseXor(At,xt){var Bt=Math.max;if(!At.sign&&!xt.sign)return JSBI.__absoluteXor(At,xt).__trim();if(At.sign&&xt.sign){const Ut=Bt(At.length,xt.length),Lt=JSBI.__absoluteSubOne(At,Ut),Ht=JSBI.__absoluteSubOne(xt);return JSBI.__absoluteXor(Lt,Ht,Lt).__trim()}const Nt=Bt(At.length,xt.length)+1;At.sign&&([At,xt]=[xt,At]);let jt=JSBI.__absoluteSubOne(xt,Nt);return jt=JSBI.__absoluteXor(jt,At,jt),JSBI.__absoluteAddOne(jt,!0,jt).__trim()}static bitwiseOr(At,xt){var Bt=Math.max;const Nt=Bt(At.length,xt.length);if(!At.sign&&!xt.sign)return JSBI.__absoluteOr(At,xt).__trim();if(At.sign&&xt.sign){let Ut=JSBI.__absoluteSubOne(At,Nt);const Lt=JSBI.__absoluteSubOne(xt);return Ut=JSBI.__absoluteAnd(Ut,Lt,Ut),JSBI.__absoluteAddOne(Ut,!0,Ut).__trim()}At.sign&&([At,xt]=[xt,At]);let jt=JSBI.__absoluteSubOne(xt,Nt);return jt=JSBI.__absoluteAndNot(jt,At,jt),JSBI.__absoluteAddOne(jt,!0,jt).__trim()}static asIntN(At,xt){var Bt=Math.floor;if(xt.length===0)return xt;if(At=Bt(At),0>At)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(At===0)return JSBI.__zero();if(At>=JSBI.__kMaxLengthBits)return xt;const Nt=0|(At+29)/30;if(xt.length<Nt)return xt;const jt=xt.__unsignedDigit(Nt-1),Ut=1<<(At-1)%30;if(xt.length===Nt&&jt<Ut)return xt;if((jt&Ut)!==Ut)return JSBI.__truncateToNBits(At,xt);if(!xt.sign)return JSBI.__truncateAndSubFromPowerOfTwo(At,xt,!0);if(!(jt&Ut-1)){for(let Lt=Nt-2;0<=Lt;Lt--)if(xt.__digit(Lt)!==0)return JSBI.__truncateAndSubFromPowerOfTwo(At,xt,!1);return xt.length===Nt&&jt===Ut?xt:JSBI.__truncateToNBits(At,xt)}return JSBI.__truncateAndSubFromPowerOfTwo(At,xt,!1)}static asUintN(At,xt){var Bt=Math.floor;if(xt.length===0)return xt;if(At=Bt(At),0>At)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(At===0)return JSBI.__zero();if(xt.sign){if(At>JSBI.__kMaxLengthBits)throw new RangeError("BigInt too big");return JSBI.__truncateAndSubFromPowerOfTwo(At,xt,!1)}if(At>=JSBI.__kMaxLengthBits)return xt;const Nt=0|(At+29)/30;if(xt.length<Nt)return xt;const jt=At%30;return xt.length==Nt&&(jt===0||!(xt.__digit(Nt-1)>>>jt))?xt:JSBI.__truncateToNBits(At,xt)}static ADD(At,xt){if(At=JSBI.__toPrimitive(At),xt=JSBI.__toPrimitive(xt),typeof At=="string")return typeof xt!="string"&&(xt=xt.toString()),At+xt;if(typeof xt=="string")return At.toString()+xt;if(At=JSBI.__toNumeric(At),xt=JSBI.__toNumeric(xt),JSBI.__isBigInt(At)&&JSBI.__isBigInt(xt))return JSBI.add(At,xt);if(typeof At=="number"&&typeof xt=="number")return At+xt;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(At,xt){return JSBI.__compare(At,xt,0)}static LE(At,xt){return JSBI.__compare(At,xt,1)}static GT(At,xt){return JSBI.__compare(At,xt,2)}static GE(At,xt){return JSBI.__compare(At,xt,3)}static EQ(At,xt){for(;;){if(JSBI.__isBigInt(At))return JSBI.__isBigInt(xt)?JSBI.equal(At,xt):JSBI.EQ(xt,At);if(typeof At=="number"){if(JSBI.__isBigInt(xt))return JSBI.__equalToNumber(xt,At);if(typeof xt!="object")return At==xt;xt=JSBI.__toPrimitive(xt)}else if(typeof At=="string"){if(JSBI.__isBigInt(xt))return At=JSBI.__fromString(At),At!==null&&JSBI.equal(At,xt);if(typeof xt!="object")return At==xt;xt=JSBI.__toPrimitive(xt)}else if(typeof At=="boolean"){if(JSBI.__isBigInt(xt))return JSBI.__equalToNumber(xt,+At);if(typeof xt!="object")return At==xt;xt=JSBI.__toPrimitive(xt)}else if(typeof At=="symbol"){if(JSBI.__isBigInt(xt))return!1;if(typeof xt!="object")return At==xt;xt=JSBI.__toPrimitive(xt)}else if(typeof At=="object"){if(typeof xt=="object"&&xt.constructor!==JSBI)return At==xt;At=JSBI.__toPrimitive(At)}else return At==xt}}static NE(At,xt){return!JSBI.EQ(At,xt)}static DataViewGetBigInt64(At,xt,Bt=!1){return JSBI.asIntN(64,JSBI.DataViewGetBigUint64(At,xt,Bt))}static DataViewGetBigUint64(At,xt,Bt=!1){const[Nt,jt]=Bt?[4,0]:[0,4],Ut=At.getUint32(xt+Nt,Bt),Lt=At.getUint32(xt+jt,Bt),Ht=new JSBI(3,!1);return Ht.__setDigit(0,1073741823&Lt),Ht.__setDigit(1,(268435455&Ut)<<2|Lt>>>30),Ht.__setDigit(2,Ut>>>28),Ht.__trim()}static DataViewSetBigInt64(At,xt,Bt,Nt=!1){JSBI.DataViewSetBigUint64(At,xt,Bt,Nt)}static DataViewSetBigUint64(At,xt,Bt,Nt=!1){Bt=JSBI.asUintN(64,Bt);let jt=0,Ut=0;if(0<Bt.length&&(Ut=Bt.__digit(0),1<Bt.length)){const Vt=Bt.__digit(1);Ut|=Vt<<30,jt=Vt>>>2,2<Bt.length&&(jt|=Bt.__digit(2)<<28)}const[Lt,Ht]=Nt?[4,0]:[0,4];At.setUint32(xt+Lt,jt,Nt),At.setUint32(xt+Ht,Ut,Nt)}static __zero(){return new JSBI(0,!1)}static __oneDigit(At,xt){const Bt=new JSBI(1,xt);return Bt.__setDigit(0,At),Bt}__copy(){const At=new JSBI(this.length,this.sign);for(let xt=0;xt<this.length;xt++)At[xt]=this[xt];return At}__trim(){let At=this.length,xt=this[At-1];for(;xt===0;)At--,xt=this[At-1],this.pop();return At===0&&(this.sign=!1),this}__initializeDigits(){for(let At=0;At<this.length;At++)this[At]=0}static __decideRounding(At,xt,Bt,Nt){if(0<xt)return-1;let jt;if(0>xt)jt=-xt-1;else{if(Bt===0)return-1;Bt--,Nt=At.__digit(Bt),jt=29}let Ut=1<<jt;if(!(Nt&Ut))return-1;if(Ut-=1,(Nt&Ut)!=0)return 1;for(;0<Bt;)if(Bt--,At.__digit(Bt)!==0)return 1;return 0}static __fromDouble(At){JSBI.__kBitConversionDouble[0]=At;const xt=2047&JSBI.__kBitConversionInts[1]>>>20,Bt=xt-1023,Nt=(0|Bt/30)+1,jt=new JSBI(Nt,0>At);let Ut=1048575&JSBI.__kBitConversionInts[1]|1048576,Lt=JSBI.__kBitConversionInts[0];const Ht=20,Vt=Bt%30;let zt,Wt=0;if(Vt<20){const Jt=Ht-Vt;Wt=Jt+32,zt=Ut>>>Jt,Ut=Ut<<32-Jt|Lt>>>Jt,Lt<<=32-Jt}else if(Vt===20)Wt=32,zt=Ut,Ut=Lt,Lt=0;else{const Jt=Vt-Ht;Wt=32-Jt,zt=Ut<<Jt|Lt>>>32-Jt,Ut=Lt<<Jt,Lt=0}jt.__setDigit(Nt-1,zt);for(let Jt=Nt-2;0<=Jt;Jt--)0<Wt?(Wt-=30,zt=Ut>>>2,Ut=Ut<<30|Lt>>>2,Lt<<=30):zt=0,jt.__setDigit(Jt,zt);return jt.__trim()}static __isWhitespace(At){return 13>=At&&9<=At||(159>=At?At==32:131071>=At?At==160||At==5760:196607>=At?(At&=131071,10>=At||At==40||At==41||At==47||At==95||At==4096):At==65279)}static __fromString(At,xt=0){let Bt=0;const Nt=At.length;let jt=0;if(jt===Nt)return JSBI.__zero();let Ut=At.charCodeAt(jt);for(;JSBI.__isWhitespace(Ut);){if(++jt===Nt)return JSBI.__zero();Ut=At.charCodeAt(jt)}if(Ut===43){if(++jt===Nt)return null;Ut=At.charCodeAt(jt),Bt=1}else if(Ut===45){if(++jt===Nt)return null;Ut=At.charCodeAt(jt),Bt=-1}if(xt===0){if(xt=10,Ut===48){if(++jt===Nt)return JSBI.__zero();if(Ut=At.charCodeAt(jt),Ut===88||Ut===120){if(xt=16,++jt===Nt)return null;Ut=At.charCodeAt(jt)}else if(Ut===79||Ut===111){if(xt=8,++jt===Nt)return null;Ut=At.charCodeAt(jt)}else if(Ut===66||Ut===98){if(xt=2,++jt===Nt)return null;Ut=At.charCodeAt(jt)}}}else if(xt===16&&Ut===48){if(++jt===Nt)return JSBI.__zero();if(Ut=At.charCodeAt(jt),Ut===88||Ut===120){if(++jt===Nt)return null;Ut=At.charCodeAt(jt)}}if(Bt!=0&&xt!==10)return null;for(;Ut===48;){if(++jt===Nt)return JSBI.__zero();Ut=At.charCodeAt(jt)}const Lt=Nt-jt;let Ht=JSBI.__kMaxBitsPerChar[xt],Vt=JSBI.__kBitsPerCharTableMultiplier-1;if(Lt>1073741824/Ht)return null;const zt=Ht*Lt+Vt>>>JSBI.__kBitsPerCharTableShift,Wt=new JSBI(0|(zt+29)/30,!1),Jt=10>xt?xt:10,Qt=10<xt?xt-10:0;if(xt&xt-1){Wt.__initializeDigits();let Xt=!1,tr=0;do{let rr=0,nr=1;for(;;){let ir;if(Ut-48>>>0<Jt)ir=Ut-48;else if((32|Ut)-97>>>0<Qt)ir=(32|Ut)-87;else{Xt=!0;break}const lr=nr*xt;if(1073741823<lr)break;if(nr=lr,rr=rr*xt+ir,tr++,++jt===Nt){Xt=!0;break}Ut=At.charCodeAt(jt)}Vt=30*JSBI.__kBitsPerCharTableMultiplier-1;const ar=0|(Ht*tr+Vt>>>JSBI.__kBitsPerCharTableShift)/30;Wt.__inplaceMultiplyAdd(nr,rr,ar)}while(!Xt)}else{Ht>>=JSBI.__kBitsPerCharTableShift;const Xt=[],tr=[];let rr=!1;do{let nr=0,ar=0;for(;;){let ir;if(Ut-48>>>0<Jt)ir=Ut-48;else if((32|Ut)-97>>>0<Qt)ir=(32|Ut)-87;else{rr=!0;break}if(ar+=Ht,nr=nr<<Ht|ir,++jt===Nt){rr=!0;break}if(Ut=At.charCodeAt(jt),30<ar+Ht)break}Xt.push(nr),tr.push(ar)}while(!rr);JSBI.__fillFromParts(Wt,Xt,tr)}if(jt!==Nt){if(!JSBI.__isWhitespace(Ut))return null;for(jt++;jt<Nt;jt++)if(Ut=At.charCodeAt(jt),!JSBI.__isWhitespace(Ut))return null}return Wt.sign=Bt==-1,Wt.__trim()}static __fillFromParts(At,xt,Bt){let Nt=0,jt=0,Ut=0;for(let Lt=xt.length-1;0<=Lt;Lt--){const Ht=xt[Lt],Vt=Bt[Lt];jt|=Ht<<Ut,Ut+=Vt,Ut===30?(At.__setDigit(Nt++,jt),Ut=0,jt=0):30<Ut&&(At.__setDigit(Nt++,1073741823&jt),Ut-=30,jt=Ht>>>Vt-Ut)}if(jt!==0){if(Nt>=At.length)throw new Error("implementation bug");At.__setDigit(Nt++,jt)}for(;Nt<At.length;Nt++)At.__setDigit(Nt,0)}static __toStringBasePowerOfTwo(At,xt){const Bt=At.length;let Nt=xt-1;Nt=(85&Nt>>>1)+(85&Nt),Nt=(51&Nt>>>2)+(51&Nt),Nt=(15&Nt>>>4)+(15&Nt);const jt=Nt,Ut=xt-1,Lt=At.__digit(Bt-1),Ht=JSBI.__clz30(Lt);let Vt=0|(30*Bt-Ht+jt-1)/jt;if(At.sign&&Vt++,268435456<Vt)throw new Error("string too long");const zt=Array(Vt);let Wt=Vt-1,Jt=0,Qt=0;for(let tr=0;tr<Bt-1;tr++){const rr=At.__digit(tr),nr=(Jt|rr<<Qt)&Ut;zt[Wt--]=JSBI.__kConversionChars[nr];const ar=jt-Qt;for(Jt=rr>>>ar,Qt=30-ar;Qt>=jt;)zt[Wt--]=JSBI.__kConversionChars[Jt&Ut],Jt>>>=jt,Qt-=jt}const Xt=(Jt|Lt<<Qt)&Ut;for(zt[Wt--]=JSBI.__kConversionChars[Xt],Jt=Lt>>>jt-Qt;Jt!==0;)zt[Wt--]=JSBI.__kConversionChars[Jt&Ut],Jt>>>=jt;if(At.sign&&(zt[Wt--]="-"),Wt!=-1)throw new Error("implementation bug");return zt.join("")}static __toStringGeneric(At,xt,Bt){const Nt=At.length;if(Nt===0)return"";if(Nt===1){let tr=At.__unsignedDigit(0).toString(xt);return Bt===!1&&At.sign&&(tr="-"+tr),tr}const jt=30*Nt-JSBI.__clz30(At.__digit(Nt-1)),Ut=JSBI.__kMaxBitsPerChar[xt],Lt=Ut-1;let Ht=jt*JSBI.__kBitsPerCharTableMultiplier;Ht+=Lt-1,Ht=0|Ht/Lt;const Vt=Ht+1>>1,zt=JSBI.exponentiate(JSBI.__oneDigit(xt,!1),JSBI.__oneDigit(Vt,!1));let Wt,Jt;const Qt=zt.__unsignedDigit(0);if(zt.length===1&&32767>=Qt){Wt=new JSBI(At.length,!1),Wt.__initializeDigits();let tr=0;for(let rr=2*At.length-1;0<=rr;rr--){const nr=tr<<15|At.__halfDigit(rr);Wt.__setHalfDigit(rr,0|nr/Qt),tr=0|nr%Qt}Jt=tr.toString(xt)}else{const tr=JSBI.__absoluteDivLarge(At,zt,!0,!0);Wt=tr.quotient;const rr=tr.remainder.__trim();Jt=JSBI.__toStringGeneric(rr,xt,!0)}Wt.__trim();let Xt=JSBI.__toStringGeneric(Wt,xt,!0);for(;Jt.length<Vt;)Jt="0"+Jt;return Bt===!1&&At.sign&&(Xt="-"+Xt),Xt+Jt}static __unequalSign(At){return At?-1:1}static __absoluteGreater(At){return At?-1:1}static __absoluteLess(At){return At?1:-1}static __compareToBigInt(At,xt){const Bt=At.sign;if(Bt!==xt.sign)return JSBI.__unequalSign(Bt);const Nt=JSBI.__absoluteCompare(At,xt);return 0<Nt?JSBI.__absoluteGreater(Bt):0>Nt?JSBI.__absoluteLess(Bt):0}static __compareToNumber(At,xt){if(JSBI.__isOneDigitInt(xt)){const Bt=At.sign,Nt=0>xt;if(Bt!==Nt)return JSBI.__unequalSign(Bt);if(At.length===0){if(Nt)throw new Error("implementation bug");return xt===0?0:-1}if(1<At.length)return JSBI.__absoluteGreater(Bt);const jt=Math.abs(xt),Ut=At.__unsignedDigit(0);return Ut>jt?JSBI.__absoluteGreater(Bt):Ut<jt?JSBI.__absoluteLess(Bt):0}return JSBI.__compareToDouble(At,xt)}static __compareToDouble(At,xt){if(xt!==xt)return xt;if(xt===1/0)return-1;if(xt===-1/0)return 1;const Bt=At.sign;if(Bt!==0>xt)return JSBI.__unequalSign(Bt);if(xt===0)throw new Error("implementation bug: should be handled elsewhere");if(At.length===0)return-1;JSBI.__kBitConversionDouble[0]=xt;const Nt=2047&JSBI.__kBitConversionInts[1]>>>20;if(Nt==2047)throw new Error("implementation bug: handled elsewhere");const jt=Nt-1023;if(0>jt)return JSBI.__absoluteGreater(Bt);const Ut=At.length;let Lt=At.__digit(Ut-1);const Ht=JSBI.__clz30(Lt),Vt=30*Ut-Ht,zt=jt+1;if(Vt<zt)return JSBI.__absoluteLess(Bt);if(Vt>zt)return JSBI.__absoluteGreater(Bt);let Wt=1048576|1048575&JSBI.__kBitConversionInts[1],Jt=JSBI.__kBitConversionInts[0];const Qt=20,Xt=29-Ht;if(Xt!==(0|(Vt-1)%30))throw new Error("implementation bug");let tr,rr=0;if(20>Xt){const nr=Qt-Xt;rr=nr+32,tr=Wt>>>nr,Wt=Wt<<32-nr|Jt>>>nr,Jt<<=32-nr}else if(Xt===20)rr=32,tr=Wt,Wt=Jt,Jt=0;else{const nr=Xt-Qt;rr=32-nr,tr=Wt<<nr|Jt>>>32-nr,Wt=Jt<<nr,Jt=0}if(Lt>>>=0,tr>>>=0,Lt>tr)return JSBI.__absoluteGreater(Bt);if(Lt<tr)return JSBI.__absoluteLess(Bt);for(let nr=Ut-2;0<=nr;nr--){0<rr?(rr-=30,tr=Wt>>>2,Wt=Wt<<30|Jt>>>2,Jt<<=30):tr=0;const ar=At.__unsignedDigit(nr);if(ar>tr)return JSBI.__absoluteGreater(Bt);if(ar<tr)return JSBI.__absoluteLess(Bt)}if(Wt!==0||Jt!==0){if(rr===0)throw new Error("implementation bug");return JSBI.__absoluteLess(Bt)}return 0}static __equalToNumber(At,xt){var Bt=Math.abs;return JSBI.__isOneDigitInt(xt)?xt===0?At.length===0:At.length===1&&At.sign===0>xt&&At.__unsignedDigit(0)===Bt(xt):JSBI.__compareToDouble(At,xt)===0}static __comparisonResultToBool(At,xt){return xt===0?0>At:xt===1?0>=At:xt===2?0<At:xt===3?0<=At:void 0}static __compare(At,xt,Bt){if(At=JSBI.__toPrimitive(At),xt=JSBI.__toPrimitive(xt),typeof At=="string"&&typeof xt=="string")switch(Bt){case 0:return At<xt;case 1:return At<=xt;case 2:return At>xt;case 3:return At>=xt}if(JSBI.__isBigInt(At)&&typeof xt=="string")return xt=JSBI.__fromString(xt),xt!==null&&JSBI.__comparisonResultToBool(JSBI.__compareToBigInt(At,xt),Bt);if(typeof At=="string"&&JSBI.__isBigInt(xt))return At=JSBI.__fromString(At),At!==null&&JSBI.__comparisonResultToBool(JSBI.__compareToBigInt(At,xt),Bt);if(At=JSBI.__toNumeric(At),xt=JSBI.__toNumeric(xt),JSBI.__isBigInt(At)){if(JSBI.__isBigInt(xt))return JSBI.__comparisonResultToBool(JSBI.__compareToBigInt(At,xt),Bt);if(typeof xt!="number")throw new Error("implementation bug");return JSBI.__comparisonResultToBool(JSBI.__compareToNumber(At,xt),Bt)}if(typeof At!="number")throw new Error("implementation bug");if(JSBI.__isBigInt(xt))return JSBI.__comparisonResultToBool(JSBI.__compareToNumber(xt,At),2^Bt);if(typeof xt!="number")throw new Error("implementation bug");return Bt===0?At<xt:Bt===1?At<=xt:Bt===2?At>xt:Bt===3?At>=xt:void 0}__clzmsd(){return JSBI.__clz30(this.__digit(this.length-1))}static __absoluteAdd(At,xt,Bt){if(At.length<xt.length)return JSBI.__absoluteAdd(xt,At,Bt);if(At.length===0)return At;if(xt.length===0)return At.sign===Bt?At:JSBI.unaryMinus(At);let Nt=At.length;(At.__clzmsd()===0||xt.length===At.length&&xt.__clzmsd()===0)&&Nt++;const jt=new JSBI(Nt,Bt);let Ut=0,Lt=0;for(;Lt<xt.length;Lt++){const Ht=At.__digit(Lt)+xt.__digit(Lt)+Ut;Ut=Ht>>>30,jt.__setDigit(Lt,1073741823&Ht)}for(;Lt<At.length;Lt++){const Ht=At.__digit(Lt)+Ut;Ut=Ht>>>30,jt.__setDigit(Lt,1073741823&Ht)}return Lt<jt.length&&jt.__setDigit(Lt,Ut),jt.__trim()}static __absoluteSub(At,xt,Bt){if(At.length===0)return At;if(xt.length===0)return At.sign===Bt?At:JSBI.unaryMinus(At);const Nt=new JSBI(At.length,Bt);let jt=0,Ut=0;for(;Ut<xt.length;Ut++){const Lt=At.__digit(Ut)-xt.__digit(Ut)-jt;jt=1&Lt>>>30,Nt.__setDigit(Ut,1073741823&Lt)}for(;Ut<At.length;Ut++){const Lt=At.__digit(Ut)-jt;jt=1&Lt>>>30,Nt.__setDigit(Ut,1073741823&Lt)}return Nt.__trim()}static __absoluteAddOne(At,xt,Bt=null){const Nt=At.length;Bt===null?Bt=new JSBI(Nt,xt):Bt.sign=xt;let jt=1;for(let Ut=0;Ut<Nt;Ut++){const Lt=At.__digit(Ut)+jt;jt=Lt>>>30,Bt.__setDigit(Ut,1073741823&Lt)}return jt!=0&&Bt.__setDigitGrow(Nt,1),Bt}static __absoluteSubOne(At,xt){const Bt=At.length;xt=xt||Bt;const Nt=new JSBI(xt,!1);let jt=1;for(let Ut=0;Ut<Bt;Ut++){const Lt=At.__digit(Ut)-jt;jt=1&Lt>>>30,Nt.__setDigit(Ut,1073741823&Lt)}if(jt!=0)throw new Error("implementation bug");for(let Ut=Bt;Ut<xt;Ut++)Nt.__setDigit(Ut,0);return Nt}static __absoluteAnd(At,xt,Bt=null){let Nt=At.length,jt=xt.length,Ut=jt;if(Nt<jt){Ut=Nt;const Vt=At,zt=Nt;At=xt,Nt=jt,xt=Vt,jt=zt}let Lt=Ut;Bt===null?Bt=new JSBI(Lt,!1):Lt=Bt.length;let Ht=0;for(;Ht<Ut;Ht++)Bt.__setDigit(Ht,At.__digit(Ht)&xt.__digit(Ht));for(;Ht<Lt;Ht++)Bt.__setDigit(Ht,0);return Bt}static __absoluteAndNot(At,xt,Bt=null){const Nt=At.length,jt=xt.length;let Ut=jt;Nt<jt&&(Ut=Nt);let Lt=Nt;Bt===null?Bt=new JSBI(Lt,!1):Lt=Bt.length;let Ht=0;for(;Ht<Ut;Ht++)Bt.__setDigit(Ht,At.__digit(Ht)&~xt.__digit(Ht));for(;Ht<Nt;Ht++)Bt.__setDigit(Ht,At.__digit(Ht));for(;Ht<Lt;Ht++)Bt.__setDigit(Ht,0);return Bt}static __absoluteOr(At,xt,Bt=null){let Nt=At.length,jt=xt.length,Ut=jt;if(Nt<jt){Ut=Nt;const Vt=At,zt=Nt;At=xt,Nt=jt,xt=Vt,jt=zt}let Lt=Nt;Bt===null?Bt=new JSBI(Lt,!1):Lt=Bt.length;let Ht=0;for(;Ht<Ut;Ht++)Bt.__setDigit(Ht,At.__digit(Ht)|xt.__digit(Ht));for(;Ht<Nt;Ht++)Bt.__setDigit(Ht,At.__digit(Ht));for(;Ht<Lt;Ht++)Bt.__setDigit(Ht,0);return Bt}static __absoluteXor(At,xt,Bt=null){let Nt=At.length,jt=xt.length,Ut=jt;if(Nt<jt){Ut=Nt;const Vt=At,zt=Nt;At=xt,Nt=jt,xt=Vt,jt=zt}let Lt=Nt;Bt===null?Bt=new JSBI(Lt,!1):Lt=Bt.length;let Ht=0;for(;Ht<Ut;Ht++)Bt.__setDigit(Ht,At.__digit(Ht)^xt.__digit(Ht));for(;Ht<Nt;Ht++)Bt.__setDigit(Ht,At.__digit(Ht));for(;Ht<Lt;Ht++)Bt.__setDigit(Ht,0);return Bt}static __absoluteCompare(At,xt){const Bt=At.length-xt.length;if(Bt!=0)return Bt;let Nt=At.length-1;for(;0<=Nt&&At.__digit(Nt)===xt.__digit(Nt);)Nt--;return 0>Nt?0:At.__unsignedDigit(Nt)>xt.__unsignedDigit(Nt)?1:-1}static __multiplyAccumulate(At,xt,Bt,Nt){if(xt===0)return;const jt=32767&xt,Ut=xt>>>15;let Lt=0,Ht=0;for(let Vt,zt=0;zt<At.length;zt++,Nt++){Vt=Bt.__digit(Nt);const Wt=At.__digit(zt),Jt=32767&Wt,Qt=Wt>>>15,Xt=JSBI.__imul(Jt,jt),tr=JSBI.__imul(Jt,Ut),rr=JSBI.__imul(Qt,jt),nr=JSBI.__imul(Qt,Ut);Vt+=Ht+Xt+Lt,Lt=Vt>>>30,Vt&=1073741823,Vt+=((32767&tr)<<15)+((32767&rr)<<15),Lt+=Vt>>>30,Ht=nr+(tr>>>15)+(rr>>>15),Bt.__setDigit(Nt,1073741823&Vt)}for(;Lt!=0||Ht!==0;Nt++){let Vt=Bt.__digit(Nt);Vt+=Lt+Ht,Ht=0,Lt=Vt>>>30,Bt.__setDigit(Nt,1073741823&Vt)}}static __internalMultiplyAdd(At,xt,Bt,Nt,jt){let Ut=Bt,Lt=0;for(let Ht=0;Ht<Nt;Ht++){const Vt=At.__digit(Ht),zt=JSBI.__imul(32767&Vt,xt),Wt=JSBI.__imul(Vt>>>15,xt),Jt=zt+((32767&Wt)<<15)+Lt+Ut;Ut=Jt>>>30,Lt=Wt>>>15,jt.__setDigit(Ht,1073741823&Jt)}if(jt.length>Nt)for(jt.__setDigit(Nt++,Ut+Lt);Nt<jt.length;)jt.__setDigit(Nt++,0);else if(Ut+Lt!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(At,xt,Bt){Bt>this.length&&(Bt=this.length);const Nt=32767&At,jt=At>>>15;let Ut=0,Lt=xt;for(let Ht=0;Ht<Bt;Ht++){const Vt=this.__digit(Ht),zt=32767&Vt,Wt=Vt>>>15,Jt=JSBI.__imul(zt,Nt),Qt=JSBI.__imul(zt,jt),Xt=JSBI.__imul(Wt,Nt),tr=JSBI.__imul(Wt,jt);let rr=Lt+Jt+Ut;Ut=rr>>>30,rr&=1073741823,rr+=((32767&Qt)<<15)+((32767&Xt)<<15),Ut+=rr>>>30,Lt=tr+(Qt>>>15)+(Xt>>>15),this.__setDigit(Ht,1073741823&rr)}if(Ut!=0||Lt!==0)throw new Error("implementation bug")}static __absoluteDivSmall(At,xt,Bt=null){Bt===null&&(Bt=new JSBI(At.length,!1));let Nt=0;for(let jt,Ut=2*At.length-1;0<=Ut;Ut-=2){jt=(Nt<<15|At.__halfDigit(Ut))>>>0;const Lt=0|jt/xt;Nt=0|jt%xt,jt=(Nt<<15|At.__halfDigit(Ut-1))>>>0;const Ht=0|jt/xt;Nt=0|jt%xt,Bt.__setDigit(Ut>>>1,Lt<<15|Ht)}return Bt}static __absoluteModSmall(At,xt){let Bt=0;for(let Nt=2*At.length-1;0<=Nt;Nt--)Bt=0|((Bt<<15|At.__halfDigit(Nt))>>>0)%xt;return Bt}static __absoluteDivLarge(At,xt,Bt,Nt){const jt=xt.__halfDigitLength(),Ut=xt.length,Lt=At.__halfDigitLength()-jt;let Ht=null;Bt&&(Ht=new JSBI(Lt+2>>>1,!1),Ht.__initializeDigits());const Vt=new JSBI(jt+2>>>1,!1);Vt.__initializeDigits();const zt=JSBI.__clz15(xt.__halfDigit(jt-1));0<zt&&(xt=JSBI.__specialLeftShift(xt,zt,0));const Wt=JSBI.__specialLeftShift(At,zt,1),Jt=xt.__halfDigit(jt-1);let Qt=0;for(let Xt,tr=Lt;0<=tr;tr--){Xt=32767;const rr=Wt.__halfDigit(tr+jt);if(rr!==Jt){const ar=(rr<<15|Wt.__halfDigit(tr+jt-1))>>>0;Xt=0|ar/Jt;let ir=0|ar%Jt;const lr=xt.__halfDigit(jt-2),yr=Wt.__halfDigit(tr+jt-2);for(;JSBI.__imul(Xt,lr)>>>0>(ir<<16|yr)>>>0&&(Xt--,ir+=Jt,!(32767<ir)););}JSBI.__internalMultiplyAdd(xt,Xt,0,Ut,Vt);let nr=Wt.__inplaceSub(Vt,tr,jt+1);nr!==0&&(nr=Wt.__inplaceAdd(xt,tr,jt),Wt.__setHalfDigit(tr+jt,32767&Wt.__halfDigit(tr+jt)+nr),Xt--),Bt&&(1&tr?Qt=Xt<<15:Ht.__setDigit(tr>>>1,Qt|Xt))}if(Nt)return Wt.__inplaceRightShift(zt),Bt?{quotient:Ht,remainder:Wt}:Wt;if(Bt)return Ht;throw new Error("unreachable")}static __clz15(At){return JSBI.__clz30(At)-15}__inplaceAdd(At,xt,Bt){let Nt=0;for(let jt=0;jt<Bt;jt++){const Ut=this.__halfDigit(xt+jt)+At.__halfDigit(jt)+Nt;Nt=Ut>>>15,this.__setHalfDigit(xt+jt,32767&Ut)}return Nt}__inplaceSub(At,xt,Bt){let Nt=0;if(1&xt){xt>>=1;let jt=this.__digit(xt),Ut=32767&jt,Lt=0;for(;Lt<Bt-1>>>1;Lt++){const zt=At.__digit(Lt),Wt=(jt>>>15)-(32767&zt)-Nt;Nt=1&Wt>>>15,this.__setDigit(xt+Lt,(32767&Wt)<<15|32767&Ut),jt=this.__digit(xt+Lt+1),Ut=(32767&jt)-(zt>>>15)-Nt,Nt=1&Ut>>>15}const Ht=At.__digit(Lt),Vt=(jt>>>15)-(32767&Ht)-Nt;if(Nt=1&Vt>>>15,this.__setDigit(xt+Lt,(32767&Vt)<<15|32767&Ut),xt+Lt+1>=this.length)throw new RangeError("out of bounds");!(1&Bt)&&(jt=this.__digit(xt+Lt+1),Ut=(32767&jt)-(Ht>>>15)-Nt,Nt=1&Ut>>>15,this.__setDigit(xt+At.length,1073709056&jt|32767&Ut))}else{xt>>=1;let jt=0;for(;jt<At.length-1;jt++){const zt=this.__digit(xt+jt),Wt=At.__digit(jt),Jt=(32767&zt)-(32767&Wt)-Nt;Nt=1&Jt>>>15;const Qt=(zt>>>15)-(Wt>>>15)-Nt;Nt=1&Qt>>>15,this.__setDigit(xt+jt,(32767&Qt)<<15|32767&Jt)}const Ut=this.__digit(xt+jt),Lt=At.__digit(jt),Ht=(32767&Ut)-(32767&Lt)-Nt;Nt=1&Ht>>>15;let Vt=0;!(1&Bt)&&(Vt=(Ut>>>15)-(Lt>>>15)-Nt,Nt=1&Vt>>>15),this.__setDigit(xt+jt,(32767&Vt)<<15|32767&Ht)}return Nt}__inplaceRightShift(At){if(At===0)return;let xt=this.__digit(0)>>>At;const Bt=this.length-1;for(let Nt=0;Nt<Bt;Nt++){const jt=this.__digit(Nt+1);this.__setDigit(Nt,1073741823&jt<<30-At|xt),xt=jt>>>At}this.__setDigit(Bt,xt)}static __specialLeftShift(At,xt,Bt){const Nt=At.length,jt=new JSBI(Nt+Bt,!1);if(xt===0){for(let Lt=0;Lt<Nt;Lt++)jt.__setDigit(Lt,At.__digit(Lt));return 0<Bt&&jt.__setDigit(Nt,0),jt}let Ut=0;for(let Lt=0;Lt<Nt;Lt++){const Ht=At.__digit(Lt);jt.__setDigit(Lt,1073741823&Ht<<xt|Ut),Ut=Ht>>>30-xt}return 0<Bt&&jt.__setDigit(Nt,Ut),jt}static __leftShiftByAbsolute(At,xt){const Bt=JSBI.__toShiftAmount(xt);if(0>Bt)throw new RangeError("BigInt too big");const Nt=0|Bt/30,jt=Bt%30,Ut=At.length,Lt=jt!==0&&At.__digit(Ut-1)>>>30-jt!=0,Ht=Ut+Nt+(Lt?1:0),Vt=new JSBI(Ht,At.sign);if(jt===0){let zt=0;for(;zt<Nt;zt++)Vt.__setDigit(zt,0);for(;zt<Ht;zt++)Vt.__setDigit(zt,At.__digit(zt-Nt))}else{let zt=0;for(let Wt=0;Wt<Nt;Wt++)Vt.__setDigit(Wt,0);for(let Wt=0;Wt<Ut;Wt++){const Jt=At.__digit(Wt);Vt.__setDigit(Wt+Nt,1073741823&Jt<<jt|zt),zt=Jt>>>30-jt}if(Lt)Vt.__setDigit(Ut+Nt,zt);else if(zt!==0)throw new Error("implementation bug")}return Vt.__trim()}static __rightShiftByAbsolute(At,xt){const Bt=At.length,Nt=At.sign,jt=JSBI.__toShiftAmount(xt);if(0>jt)return JSBI.__rightShiftByMaximum(Nt);const Ut=0|jt/30,Lt=jt%30;let Ht=Bt-Ut;if(0>=Ht)return JSBI.__rightShiftByMaximum(Nt);let Vt=!1;if(Nt){if(At.__digit(Ut)&(1<<Lt)-1)Vt=!0;else for(let Wt=0;Wt<Ut;Wt++)if(At.__digit(Wt)!==0){Vt=!0;break}}Vt&&Lt===0&&!~At.__digit(Bt-1)&&Ht++;let zt=new JSBI(Ht,Nt);if(Lt===0){zt.__setDigit(Ht-1,0);for(let Wt=Ut;Wt<Bt;Wt++)zt.__setDigit(Wt-Ut,At.__digit(Wt))}else{let Wt=At.__digit(Ut)>>>Lt;const Jt=Bt-Ut-1;for(let Qt=0;Qt<Jt;Qt++){const Xt=At.__digit(Qt+Ut+1);zt.__setDigit(Qt,1073741823&Xt<<30-Lt|Wt),Wt=Xt>>>Lt}zt.__setDigit(Jt,Wt)}return Vt&&(zt=JSBI.__absoluteAddOne(zt,!0,zt)),zt.__trim()}static __rightShiftByMaximum(At){return At?JSBI.__oneDigit(1,!0):JSBI.__zero()}static __toShiftAmount(At){if(1<At.length)return-1;const xt=At.__unsignedDigit(0);return xt>JSBI.__kMaxLengthBits?-1:xt}static __toPrimitive(At,xt="default"){if(typeof At!="object"||At.constructor===JSBI)return At;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const jt=At[Symbol.toPrimitive];if(jt){const Ut=jt(xt);if(typeof Ut!="object")return Ut;throw new TypeError("Cannot convert object to primitive value")}}const Bt=At.valueOf;if(Bt){const jt=Bt.call(At);if(typeof jt!="object")return jt}const Nt=At.toString;if(Nt){const jt=Nt.call(At);if(typeof jt!="object")return jt}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(At){return JSBI.__isBigInt(At)?At:+At}static __isBigInt(At){return typeof At=="object"&&At!==null&&At.constructor===JSBI}static __truncateToNBits(At,xt){const Bt=0|(At+29)/30,Nt=new JSBI(Bt,xt.sign),jt=Bt-1;for(let Lt=0;Lt<jt;Lt++)Nt.__setDigit(Lt,xt.__digit(Lt));let Ut=xt.__digit(jt);if(At%30!=0){const Lt=32-At%30;Ut=Ut<<Lt>>>Lt}return Nt.__setDigit(jt,Ut),Nt.__trim()}static __truncateAndSubFromPowerOfTwo(At,xt,Bt){var Nt=Math.min;const jt=0|(At+29)/30,Ut=new JSBI(jt,Bt);let Lt=0;const Ht=jt-1;let Vt=0;for(const Qt=Nt(Ht,xt.length);Lt<Qt;Lt++){const Xt=0-xt.__digit(Lt)-Vt;Vt=1&Xt>>>30,Ut.__setDigit(Lt,1073741823&Xt)}for(;Lt<Ht;Lt++)Ut.__setDigit(Lt,0|1073741823&-Vt);let zt=Ht<xt.length?xt.__digit(Ht):0;const Wt=At%30;let Jt;if(Wt==0)Jt=0-zt-Vt,Jt&=1073741823;else{const Qt=32-Wt;zt=zt<<Qt>>>Qt;const Xt=1<<32-Qt;Jt=Xt-zt-Vt,Jt&=Xt-1}return Ut.__setDigit(Ht,Jt),Ut.__trim()}__digit(At){return this[At]}__unsignedDigit(At){return this[At]>>>0}__setDigit(At,xt){this[At]=0|xt}__setDigitGrow(At,xt){this[At]=0|xt}__halfDigitLength(){const At=this.length;return 32767>=this.__unsignedDigit(At-1)?2*At-1:2*At}__halfDigit(At){return 32767&this[At>>>1]>>>15*(1&At)}__setHalfDigit(At,xt){const Bt=At>>>1,Nt=this.__digit(Bt),jt=1&At?32767&Nt|xt<<15:1073709056&Nt|32767&xt;this.__setDigit(Bt,jt)}static __digitPow(At,xt){let Bt=1;for(;0<xt;)1&xt&&(Bt*=At),xt>>>=1,At*=At;return Bt}static __isOneDigitInt(At){return(1073741823&At)===At}}JSBI.__kMaxLength=33554432,JSBI.__kMaxLengthBits=JSBI.__kMaxLength<<5,JSBI.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],JSBI.__kBitsPerCharTableShift=5,JSBI.__kBitsPerCharTableMultiplier=1<<JSBI.__kBitsPerCharTableShift,JSBI.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],JSBI.__kBitConversionBuffer=new ArrayBuffer(8),JSBI.__kBitConversionDouble=new Float64Array(JSBI.__kBitConversionBuffer),JSBI.__kBitConversionInts=new Int32Array(JSBI.__kBitConversionBuffer),JSBI.__clz30=Math.clz32?function(kt){return Math.clz32(kt)-2}:function(kt){return kt===0?30:0|29-(0|Math.log(kt>>>0)/Math.LN2)},JSBI.__imul=Math.imul||function(kt,At){return 0|kt*At};const t$1={};function MakeIntrinsicClass(kt,At){Object.defineProperty(kt.prototype,Symbol.toStringTag,{value:At,writable:!1,enumerable:!1,configurable:!0});for(const xt of Object.getOwnPropertyNames(kt)){const Bt=Object.getOwnPropertyDescriptor(kt,xt);Bt.configurable&&Bt.enumerable&&(Bt.enumerable=!1,Object.defineProperty(kt,xt,Bt))}for(const xt of Object.getOwnPropertyNames(kt.prototype)){const Bt=Object.getOwnPropertyDescriptor(kt.prototype,xt);Bt.configurable&&Bt.enumerable&&(Bt.enumerable=!1,Object.defineProperty(kt.prototype,xt,Bt))}DefineIntrinsic(At,kt),DefineIntrinsic(`${At}.prototype`,kt.prototype)}function DefineIntrinsic(kt,At){const xt=`%${kt}%`;if(t$1[xt]!==void 0)throw new Error(`intrinsic ${kt} already exists`);t$1[xt]=At}function GetIntrinsic(kt){return t$1[kt]}var r,o$2;const n="slot-epochNanoSeconds",a="slot-timezone-identifier",i$3="slot-year",s$2="slot-month",l="slot-day",d$1="slot-hour",m$1="slot-minute",c="slot-second",h$1="slot-millisecond",u="slot-microsecond",T="slot-nanosecond",p="slot-calendar",f$1="slot-date-brand",y$1="slot-year-month-brand",I="slot-month-day-brand",S="slot-cached-instant",g="slot-time-zone",w$1="slot-years",D="slot-months",G="slot-weeks",v="slot-days",C="slot-hours",O="slot-minutes",b="slot-seconds",E$1="slot-milliseconds",M="slot-microseconds",R="slot-nanoseconds",F="slot-calendar-identifier",Y=new WeakMap,P=Symbol.for("@@Temporal__GetSlots");(r=globalThis)[P]||(r[P]=function kt(At){return Y.get(At)});const Z=globalThis[P],B=Symbol.for("@@Temporal__CreateSlots");(o$2=globalThis)[B]||(o$2[B]=function kt(At){Y.set(At,Object.create(null))});const N=globalThis[B];function HasSlot(kt,...At){if(!kt||typeof kt!="object")return!1;const xt=Z(kt);return!!xt&&At.every(Bt=>Bt in xt)}function GetSlot(kt,At){var Bt;const xt=(Bt=Z(kt))==null?void 0:Bt[At];if(xt===void 0)throw new TypeError(`Missing internal slot ${At}`);return xt}function SetSlot(kt,At,xt){const Bt=Z(kt);if(Bt===void 0)throw new TypeError("Missing slots for the given container");if(Bt[At])throw new TypeError(`${At} already has set`);Bt[At]=xt}const j=/\.[-A-Za-z_]|\.\.[-A-Za-z._]{1,12}|\.[-A-Za-z_][-A-Za-z._]{0,12}|[A-Za-z_][-A-Za-z._]{0,13}/,$=new RegExp("(?:"+[`(?:${j.source})(?:\\/(?:${j.source}))*`,"Etc/GMT(?:0|[-+]\\d{1,2})","GMT[-+]?0","EST5EDT","CST6CDT","MST7MDT","PST8PDT",/(?:[+\u2212-][0-2][0-9](?::?[0-5][0-9](?::?[0-5][0-9](?:[.,]\d{1,9})?)?)?)/.source].join("|")+")"),k=/(?:[+\u2212-]\d{6}|\d{4})/,U=/(?:0[1-9]|1[0-2])/,A=/(?:0[1-9]|[12]\d|3[01])/,L=new RegExp(`(${k.source})(?:-(${U.source})-(${A.source})|(${U.source})(${A.source}))`),x=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,W=/([+\u2212-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/,q=new RegExp(`([zZ])|${W.source}?`),H=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,V=new RegExp([`^${L.source}`,`(?:(?:T|\\s+)${x.source}(?:${q.source})?)?`,`(?:\\[!?(${$.source})\\])?`,`((?:${H.source})*)$`].join(""),"i"),z=new RegExp([`^T?${x.source}`,`(?:${q.source})?`,`(?:\\[!?${$.source}\\])?`,`((?:${H.source})*)$`].join(""),"i"),_=new RegExp(`^(${k.source})-?(${U.source})(?:\\[!?${$.source}\\])?((?:${H.source})*)$`),J=new RegExp(`^(?:--)?(${U.source})-?(${A.source})(?:\\[!?${$.source}\\])?((?:${H.source})*)$`),K=/(\d+)(?:[.,](\d{1,9}))?/,X=new RegExp(`(?:${K.source}H)?(?:${K.source}M)?(?:${K.source}S)?`),Q=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${X.source})?$`,"i"),ee=Array.prototype.includes,te=Array.prototype.push,re=globalThis.Intl.DateTimeFormat,oe=Math.min,ne=Math.max,ae=Math.abs,ie=Math.floor,se=Math.sign,le=Math.trunc,de=Number.isNaN,me=Number.isFinite,ce=Number,he=String,ue=Number.MAX_SAFE_INTEGER,Te=Object.create,pe=Object.getOwnPropertyDescriptor,fe=Reflect.apply,ye=Reflect.ownKeys,Ie=JSBI.BigInt(0),Se=JSBI.BigInt(1),ge=JSBI.BigInt(60),we=JSBI.BigInt(24),De=JSBI.BigInt(1e3),Ge=JSBI.BigInt(1e6),ve=JSBI.BigInt(1e9),Ce=JSBI.BigInt(-1),Oe=JSBI.multiply(JSBI.BigInt(3600),ve),be=JSBI.multiply(ge,ve),Ee=JSBI.multiply(Oe,we),Me=JSBI.multiply(JSBI.BigInt(-86400),JSBI.BigInt(1e17)),Re=JSBI.multiply(JSBI.BigInt(86400),JSBI.BigInt(1e17)),Fe=-271821,Ye=275760,Pe=JSBI.multiply(JSBI.BigInt(-388152),JSBI.BigInt(1e13)),Ze=JSBI.multiply(Ee,JSBI.BigInt(3660)),Be=JSBI.multiply(Ee,JSBI.BigInt(366)),Ne=JSBI.multiply(Ee,JSBI.BigInt(14)),je=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"];function isZero(kt){return JSBI.equal(kt,Ie)}function GetMethod(kt,At){const xt=kt[At];if(xt!==void 0)return xt}function Call(kt,At,xt){const Bt=arguments.length>2?xt:[];return fe(kt,At,Bt)}function IsObject(kt){return typeof kt=="object"&&kt!==null||typeof kt=="function"}function ToNumber(kt){if(typeof kt=="bigint")throw new TypeError("Cannot convert BigInt to number");return ce(kt)}function ToIntegerOrInfinity(kt){const At=ToNumber(kt);if(de(At)||At===0)return 0;if(!me(At))return At;const xt=ie(ae(At));return xt===0?0:se(At)*xt}function IsIntegralNumber(kt){if(typeof kt!="number"||de(kt)||!me(kt))return!1;const At=ae(kt);return ie(At)===At}function ToString(kt){if(typeof kt=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return he(kt)}function ToIntegerWithTruncation(kt){const At=ToNumber(kt);if(At===0)return 0;if(de(At)||!me(At))throw new RangeError("invalid number value");const xt=le(At);return xt===0?0:xt}function ToPositiveIntegerWithTruncation(kt,At){const xt=ToIntegerWithTruncation(kt);if(xt<=0)throw At!==void 0?new RangeError(`property '${At}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return xt}function ToIntegerIfIntegral(kt){const At=ToNumber(kt);if(!me(At))throw new RangeError("infinity is out of range");if(!IsIntegralNumber(At))throw new RangeError(`unsupported fractional value ${kt}`);return At===0?0:At}function divmod(kt,At){return{quotient:JSBI.divide(kt,At),remainder:JSBI.remainder(kt,At)}}function isNegativeJSBI(kt){return JSBI.lessThan(kt,Ie)}function signJSBI(kt){return isZero(kt)?0:isNegativeJSBI(kt)?-1:1}function abs(kt){return JSBI.lessThan(kt,Ie)?JSBI.multiply(kt,Ce):kt}const $e=new Map([["year",ToIntegerWithTruncation],["month",ToPositiveIntegerWithTruncation],["monthCode",ToString],["day",ToPositiveIntegerWithTruncation],["hour",ToIntegerWithTruncation],["minute",ToIntegerWithTruncation],["second",ToIntegerWithTruncation],["millisecond",ToIntegerWithTruncation],["microsecond",ToIntegerWithTruncation],["nanosecond",ToIntegerWithTruncation],["years",ToIntegerIfIntegral],["months",ToIntegerIfIntegral],["weeks",ToIntegerIfIntegral],["days",ToIntegerIfIntegral],["hours",ToIntegerIfIntegral],["minutes",ToIntegerIfIntegral],["seconds",ToIntegerIfIntegral],["milliseconds",ToIntegerIfIntegral],["microseconds",ToIntegerIfIntegral],["nanoseconds",ToIntegerIfIntegral],["era",ToString],["eraYear",ToIntegerOrInfinity],["offset",ToString]]),ke=new Map([["hour",0],["minute",0],["second",0],["millisecond",0],["microsecond",0],["nanosecond",0]]),Ue=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],Ae=new Map(Ue.map(kt=>[kt[0],kt[1]])),Le=new Map(Ue.map(([kt,At])=>[At,kt])),xe=Ue.map(([,kt])=>kt),We=Array.from(Ae.keys()).sort(),qe=new Map;function getIntlDateTimeFormatEnUsForTimeZone(kt){let At=qe.get(kt);return At===void 0&&(At=new re("en-us",{timeZone:he(kt),hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),qe.set(kt,At)),At}function ToObject(kt){if(kt==null)throw new TypeError(`Expected object not ${kt}`);return Object(kt)}function CopyDataProperties(kt,At,xt,Bt){if(At==null)return;const Nt=ye(At);for(const jt of Nt)if(!xt.some(Ut=>Object.is(Ut,jt))&&Object.prototype.propertyIsEnumerable.call(At,jt)){const Ut=At[jt];if(Bt&&Bt.some(Lt=>Object.is(Lt,Ut)))continue;kt[jt]=Ut}}function IsTemporalInstant(kt){return HasSlot(kt,n)&&!HasSlot(kt,g,p)}function IsTemporalTimeZone(kt){return HasSlot(kt,a)}function IsTemporalCalendar(kt){return HasSlot(kt,F)}function IsTemporalDuration(kt){return HasSlot(kt,w$1,D,v,C,O,b,E$1,M,R)}function IsTemporalDate(kt){return HasSlot(kt,f$1)}function IsTemporalTime(kt){return HasSlot(kt,d$1,m$1,c,h$1,u,T)&&!HasSlot(kt,i$3,s$2,l)}function IsTemporalDateTime(kt){return HasSlot(kt,i$3,s$2,l,d$1,m$1,c,h$1,u,T)}function IsTemporalYearMonth(kt){return HasSlot(kt,y$1)}function IsTemporalMonthDay(kt){return HasSlot(kt,I)}function IsTemporalZonedDateTime(kt){return HasSlot(kt,n,g,p)}function RejectTemporalLikeObject(kt){if(HasSlot(kt,p)||HasSlot(kt,g))throw new TypeError("with() does not support a calendar or timeZone property");if(IsTemporalTime(kt))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(kt.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(kt.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function ParseTemporalTimeZone(kt){const{ianaName:At,offset:xt,z:Bt}=function(jt){if(new RegExp(`^${$.source}$`,"i").test(jt))return{ianaName:jt};try{const Ut=ParseISODateTime(jt);if(Ut.z||Ut.offset||Ut.ianaName)return Ut}catch{}throw new RangeError(`Invalid time zone: ${jt}`)}(kt);return At?GetCanonicalTimeZoneIdentifier(At):Bt?"UTC":FormatTimeZoneOffsetString(ParseTimeZoneOffsetString(xt))}function MaybeFormatCalendarAnnotation(kt,At){return At==="never"?"":FormatCalendarAnnotation(ToTemporalCalendarIdentifier(kt),At)}function FormatCalendarAnnotation(kt,At){return At==="never"||At==="auto"&&kt==="iso8601"?"":`[${At==="critical"?"!":""}u-ca=${kt}]`}function ParseISODateTime(kt){const At=V.exec(kt);if(!At)throw new RangeError(`invalid ISO 8601 string: ${kt}`);let xt=At[1];if(xt[0]===""&&(xt=`-${xt.slice(1)}`),xt==="-000000")throw new RangeError(`invalid ISO 8601 string: ${kt}`);const Bt=ToIntegerOrInfinity(xt),Nt=ToIntegerOrInfinity(At[2]||At[4]),jt=ToIntegerOrInfinity(At[3]||At[5]),Ut=ToIntegerOrInfinity(At[6]),Lt=At[6]!==void 0,Ht=ToIntegerOrInfinity(At[7]||At[10]);let Vt=ToIntegerOrInfinity(At[8]||At[11]);Vt===60&&(Vt=59);const zt=(At[9]||At[12])+"000000000",Wt=ToIntegerOrInfinity(zt.slice(0,3)),Jt=ToIntegerOrInfinity(zt.slice(3,6)),Qt=ToIntegerOrInfinity(zt.slice(6,9));let Xt,tr=!1;if(At[13])Xt=void 0,tr=!0;else if(At[14]&&At[15]){const ir=At[14]==="-"||At[14]===""?"-":"+",lr=At[15]||"00",yr=At[16]||"00",Sr=At[17]||"00";let Ar=At[18]||"0";if(Xt=`${ir}${lr}:${yr}`,+Ar){for(;Ar.endsWith("0");)Ar=Ar.slice(0,-1);Xt+=`:${Sr}.${Ar}`}else+Sr&&(Xt+=`:${Sr}`);Xt==="-00:00"&&(Xt="+00:00")}const rr=At[19],nr=At[20];let ar;for(const[,ir,lr,yr]of nr.matchAll(H))if(lr==="u-ca")ar===void 0&&(ar=yr);else if(ir==="!")throw new RangeError(`Unrecognized annotation: !${lr}=${yr}`);return RejectDateTime(Bt,Nt,jt,Ut,Ht,Vt,Wt,Jt,Qt),{year:Bt,month:Nt,day:jt,hasTime:Lt,hour:Ut,minute:Ht,second:Vt,millisecond:Wt,microsecond:Jt,nanosecond:Qt,ianaName:rr,offset:Xt,z:tr,calendar:ar}}function ParseTemporalYearMonthString(kt){const At=_.exec(kt);let xt,Bt,Nt,jt;if(At){let Ut=At[1];if(Ut[0]===""&&(Ut=`-${Ut.slice(1)}`),Ut==="-000000")throw new RangeError(`invalid ISO 8601 string: ${kt}`);xt=ToIntegerOrInfinity(Ut),Bt=ToIntegerOrInfinity(At[2]);const Lt=At[3];for(const[,Ht,Vt,zt]of Lt.matchAll(H))if(Vt==="u-ca")Nt===void 0&&(Nt=zt);else if(Ht==="!")throw new RangeError(`Unrecognized annotation: !${Vt}=${zt}`);if(Nt!==void 0&&Nt!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let Ut;if({year:xt,month:Bt,calendar:Nt,day:jt,z:Ut}=ParseISODateTime(kt),Ut)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:xt,month:Bt,calendar:Nt,referenceISODay:jt}}function ParseTemporalMonthDayString(kt){const At=J.exec(kt);let xt,Bt,Nt,jt;if(At){xt=ToIntegerOrInfinity(At[1]),Bt=ToIntegerOrInfinity(At[2]);const Ut=At[3];for(const[,Lt,Ht,Vt]of Ut.matchAll(H))if(Ht==="u-ca")Nt===void 0&&(Nt=Vt);else if(Lt==="!")throw new RangeError(`Unrecognized annotation: !${Ht}=${Vt}`);if(Nt!==void 0&&Nt!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let Ut;if({month:xt,day:Bt,calendar:Nt,year:jt,z:Ut}=ParseISODateTime(kt),Ut)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:xt,day:Bt,calendar:Nt,referenceISOYear:jt}}function ParseTemporalInstant(kt){let{year:At,month:xt,day:Bt,hour:Nt,minute:jt,second:Ut,millisecond:Lt,microsecond:Ht,nanosecond:Vt,offset:zt,z:Wt}=function(tr){const rr=ParseISODateTime(tr);if(!rr.z&&!rr.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return rr}(kt);if(!Wt&&!zt)throw new RangeError("Temporal.Instant requires a time zone offset");const Jt=Wt?0:ParseTimeZoneOffsetString(zt);({year:At,month:xt,day:Bt,hour:Nt,minute:jt,second:Ut,millisecond:Lt,microsecond:Ht,nanosecond:Vt}=BalanceISODateTime(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt-Jt));const Qt=GetUTCEpochNanoseconds(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt);if(Qt===null)throw new RangeError("DateTime outside of supported range");return Qt}function RegulateISODate(kt,At,xt,Bt){let Nt=kt,jt=At,Ut=xt;switch(Bt){case"reject":RejectISODate(Nt,jt,Ut);break;case"constrain":({year:Nt,month:jt,day:Ut}=ConstrainISODate(Nt,jt,Ut))}return{year:Nt,month:jt,day:Ut}}function RegulateTime(kt,At,xt,Bt,Nt,jt,Ut){let Lt=kt,Ht=At,Vt=xt,zt=Bt,Wt=Nt,Jt=jt;switch(Ut){case"reject":RejectTime(Lt,Ht,Vt,zt,Wt,Jt);break;case"constrain":({hour:Lt,minute:Ht,second:Vt,millisecond:zt,microsecond:Wt,nanosecond:Jt}=function(Xt,tr,rr,nr,ar,ir){const lr=ConstrainToRange(Xt,0,23),yr=ConstrainToRange(tr,0,59),Sr=ConstrainToRange(rr,0,59),Ar=ConstrainToRange(nr,0,999),Dr=ConstrainToRange(ar,0,999),Br=ConstrainToRange(ir,0,999);return{hour:lr,minute:yr,second:Sr,millisecond:Ar,microsecond:Dr,nanosecond:Br}}(Lt,Ht,Vt,zt,Wt,Jt))}return{hour:Lt,minute:Ht,second:Vt,millisecond:zt,microsecond:Wt,nanosecond:Jt}}function ToTemporalDurationRecord(kt){if(!IsObject(kt))return function(Xt){const tr=Q.exec(Xt);if(!tr)throw new RangeError(`invalid duration: ${Xt}`);if(tr.slice(2).every(wr=>wr===void 0))throw new RangeError(`invalid duration: ${Xt}`);const rr=tr[1]==="-"||tr[1]===""?-1:1,nr=tr[2]===void 0?0:ToIntegerWithTruncation(tr[2])*rr,ar=tr[3]===void 0?0:ToIntegerWithTruncation(tr[3])*rr,ir=tr[4]===void 0?0:ToIntegerWithTruncation(tr[4])*rr,lr=tr[5]===void 0?0:ToIntegerWithTruncation(tr[5])*rr,yr=tr[6]===void 0?0:ToIntegerWithTruncation(tr[6])*rr,Sr=tr[7],Ar=tr[8],Dr=tr[9],Br=tr[10],Lr=tr[11];let Or=0,vr=0,pr=0;if(Sr!==void 0){if(Ar??Dr??Br??Lr)throw new RangeError("only the smallest unit can be fractional");pr=3600*ToIntegerOrInfinity((Sr+"000000000").slice(0,9))*rr}else if(Or=Ar===void 0?0:ToIntegerWithTruncation(Ar)*rr,Dr!==void 0){if(Br??Lr)throw new RangeError("only the smallest unit can be fractional");pr=60*ToIntegerOrInfinity((Dr+"000000000").slice(0,9))*rr}else vr=Br===void 0?0:ToIntegerWithTruncation(Br)*rr,Lr!==void 0&&(pr=ToIntegerOrInfinity((Lr+"000000000").slice(0,9))*rr);const dr=pr%1e3,ur=le(pr/1e3)%1e3,$r=le(pr/1e6)%1e3;return vr+=le(pr/1e9)%60,Or+=le(pr/6e10),RejectDuration(nr,ar,ir,lr,yr,Or,vr,$r,ur,dr),{years:nr,months:ar,weeks:ir,days:lr,hours:yr,minutes:Or,seconds:vr,milliseconds:$r,microseconds:ur,nanoseconds:dr}}(ToString(kt));if(IsTemporalDuration(kt))return{years:GetSlot(kt,w$1),months:GetSlot(kt,D),weeks:GetSlot(kt,G),days:GetSlot(kt,v),hours:GetSlot(kt,C),minutes:GetSlot(kt,O),seconds:GetSlot(kt,b),milliseconds:GetSlot(kt,E$1),microseconds:GetSlot(kt,M),nanoseconds:GetSlot(kt,R)};const At={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let xt=function(Xt){if(!IsObject(Xt))throw new TypeError("invalid duration-like");const tr={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let rr=!1;for(const nr of We){const ar=Xt[nr];ar!==void 0&&(rr=!0,tr[nr]=ToIntegerIfIntegral(ar))}if(!rr)throw new TypeError("invalid duration-like");return tr}(kt);for(const Qt of We){const Xt=xt[Qt];Xt!==void 0&&(At[Qt]=Xt)}let{years:Bt,months:Nt,weeks:jt,days:Ut,hours:Lt,minutes:Ht,seconds:Vt,milliseconds:zt,microseconds:Wt,nanoseconds:Jt}=At;return RejectDuration(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt),{years:Bt,months:Nt,weeks:jt,days:Ut,hours:Lt,minutes:Ht,seconds:Vt,milliseconds:zt,microseconds:Wt,nanoseconds:Jt}}function ToTemporalOverflow(kt){return kt===void 0?"constrain":GetOption(kt,"overflow",["constrain","reject"],"constrain")}function ToTemporalDisambiguation(kt){return kt===void 0?"compatible":GetOption(kt,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function ToTemporalRoundingMode(kt,At){return GetOption(kt,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],At)}function ToTemporalOffset(kt,At){return kt===void 0?At:GetOption(kt,"offset",["prefer","use","ignore","reject"],At)}function ToCalendarNameOption(kt){return GetOption(kt,"calendarName",["auto","always","never","critical"],"auto")}function ToTemporalRoundingIncrement(kt){let At=kt.roundingIncrement;if(At===void 0)return 1;if(At=ToNumber(At),!me(At))throw new RangeError("roundingIncrement must be finite");const xt=le(At);if(xt<1||xt>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${At}`);return xt}function ValidateTemporalRoundingIncrement(kt,At,xt){const Bt=xt?At:At-1;if(kt>Bt)throw new RangeError(`roundingIncrement must be at least 1 and less than ${Bt}, not ${kt}`);if(At%kt!=0)throw new RangeError(`Rounding increment must divide evenly into ${At}`)}function ToFractionalSecondDigits(kt){const At=kt.fractionalSecondDigits;if(At===void 0)return"auto";if(typeof At!="number"){if(ToString(At)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${At}`);return"auto"}const xt=ie(At);if(!me(xt)||xt<0||xt>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${At}`);return xt}function ToSecondsStringPrecisionRecord(kt,At){switch(kt){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(At){case"auto":return{precision:At,unit:"nanosecond",increment:1};case 0:return{precision:At,unit:"second",increment:1};case 1:case 2:case 3:return{precision:At,unit:"millisecond",increment:10**(3-At)};case 4:case 5:case 6:return{precision:At,unit:"microsecond",increment:10**(6-At)};case 7:case 8:case 9:return{precision:At,unit:"nanosecond",increment:10**(9-At)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${At}`)}}const He=Symbol("~required~");function GetTemporalUnit(kt,At,xt,Bt,Nt=[]){const jt=[];for(const[,Vt,zt]of Ue)xt!=="datetime"&&xt!==zt||jt.push(Vt);jt.push(...Nt);let Ut=Bt;Ut===He?Ut=void 0:Ut!==void 0&&jt.push(Ut);const Lt=[...jt];for(const Vt of jt){const zt=Le.get(Vt);zt!==void 0&&Lt.push(zt)}let Ht=GetOption(kt,At,Lt,Ut);if(Ht===void 0&&Bt===He)throw new RangeError(`${At} is required`);return Ae.has(Ht)?Ae.get(Ht):Ht}function ToRelativeTemporalObject(kt){const At=kt.relativeTo;if(At===void 0)return At;let xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt="option",tr=!1;if(IsObject(At)){if(IsTemporalZonedDateTime(At)||IsTemporalDate(At))return At;if(IsTemporalDateTime(At))return TemporalDateTimeToDate(At);Wt=GetTemporalCalendarSlotValueWithISODefault(At);const rr=CalendarFields(Wt,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);rr.push("timeZone","offset");const nr=PrepareTemporalFields(At,rr,[]),ar=Te(null);ar.overflow="constrain",{year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt}=InterpretTemporalDateTimeFields(Wt,nr,ar),Qt=nr.offset,Qt===void 0&&(Xt="wall"),Jt=nr.timeZone,Jt!==void 0&&(Jt=ToTemporalTimeZoneSlotValue(Jt))}else{let rr,nr;if({year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt,calendar:Wt,ianaName:rr,offset:Qt,z:nr}=ParseISODateTime(ToString(At)),rr)Jt=ToTemporalTimeZoneSlotValue(rr),nr?Xt="exact":Qt||(Xt="wall"),tr=!0;else if(nr)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");if(Wt||(Wt="iso8601"),!IsBuiltinCalendar(Wt))throw new RangeError(`invalid calendar identifier ${Wt}`);Wt=ASCIILowercase(Wt)}return Jt===void 0?CreateTemporalDate(xt,Bt,Nt,Wt):CreateTemporalZonedDateTime(InterpretISODateTimeOffset(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Xt,Xt==="option"?ParseTimeZoneOffsetString(Qt):0,Jt,"compatible","reject",tr),Jt,Wt)}function DefaultTemporalLargestUnit(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt){for(const[zt,Wt]of[["years",kt],["months",At],["weeks",xt],["days",Bt],["hours",Nt],["minutes",jt],["seconds",Ut],["milliseconds",Lt],["microseconds",Ht],["nanoseconds",Vt]])if(Wt!==0)return Ae.get(zt);return"nanosecond"}function LargerOfTwoTemporalUnits(kt,At){return xe.indexOf(kt)>xe.indexOf(At)?At:kt}function PrepareTemporalFields(kt,At,xt,{emptySourceErrorMessage:Bt}={emptySourceErrorMessage:"no supported properties found"}){const Nt=Te(null);let jt=!1;At.sort();for(const Ut of At){let Lt=kt[Ut];if(Lt!==void 0)jt=!0,$e.has(Ut)&&(Lt=$e.get(Ut)(Lt)),Nt[Ut]=Lt;else if(xt!=="partial"){if(ee.call(xt,Ut))throw new TypeError(`required property '${Ut}' missing or undefined`);Lt=ke.get(Ut),Nt[Ut]=Lt}}if(xt==="partial"&&!jt)throw new TypeError(Bt);return Nt}function ToTemporalTimeRecord(kt,At="complete"){const xt=["hour","microsecond","millisecond","minute","nanosecond","second"],Bt=PrepareTemporalFields(kt,xt,"partial",{emptySourceErrorMessage:"invalid time-like"}),Nt={};for(const jt of xt){const Ut=pe(Bt,jt);Ut!==void 0?Nt[jt]=Ut.value:At==="complete"&&(Nt[jt]=0)}return Nt}function ToTemporalDate(kt,At){let xt=kt;if(IsObject(xt)){if(IsTemporalDate(xt))return xt;if(IsTemporalZonedDateTime(xt)&&(ToTemporalOverflow(At),xt=GetPlainDateTimeFor(GetSlot(xt,g),GetSlot(xt,S),GetSlot(xt,p))),IsTemporalDateTime(xt))return ToTemporalOverflow(At),CreateTemporalDate(GetSlot(xt,i$3),GetSlot(xt,s$2),GetSlot(xt,l),GetSlot(xt,p));const Ht=GetTemporalCalendarSlotValueWithISODefault(xt);return CalendarDateFromFields(Ht,PrepareTemporalFields(xt,CalendarFields(Ht,["day","month","monthCode","year"]),[]),At)}ToTemporalOverflow(At);let{year:Bt,month:Nt,day:jt,calendar:Ut,z:Lt}=function(Vt){return ParseISODateTime(Vt)}(ToString(xt));if(Lt)throw new RangeError("Z designator not supported for PlainDate");if(Ut||(Ut="iso8601"),!IsBuiltinCalendar(Ut))throw new RangeError(`invalid calendar identifier ${Ut}`);return Ut=ASCIILowercase(Ut),CreateTemporalDate(Bt,Nt,jt,Ut)}function InterpretTemporalDateTimeFields(kt,At,xt){let{hour:Bt,minute:Nt,second:jt,millisecond:Ut,microsecond:Lt,nanosecond:Ht}=ToTemporalTimeRecord(At);const Vt=ToTemporalOverflow(xt),zt=CalendarDateFromFields(kt,At,xt),Wt=GetSlot(zt,i$3),Jt=GetSlot(zt,s$2),Qt=GetSlot(zt,l);return{hour:Bt,minute:Nt,second:jt,millisecond:Ut,microsecond:Lt,nanosecond:Ht}=RegulateTime(Bt,Nt,jt,Ut,Lt,Ht,Vt),{year:Wt,month:Jt,day:Qt,hour:Bt,minute:Nt,second:jt,millisecond:Ut,microsecond:Lt,nanosecond:Ht}}function ToTemporalDateTime(kt,At){let xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt;if(IsObject(kt)){if(IsTemporalDateTime(kt))return kt;if(IsTemporalZonedDateTime(kt))return ToTemporalOverflow(At),GetPlainDateTimeFor(GetSlot(kt,g),GetSlot(kt,S),GetSlot(kt,p));if(IsTemporalDate(kt))return ToTemporalOverflow(At),CreateTemporalDateTime(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l),0,0,0,0,0,0,GetSlot(kt,p));Wt=GetTemporalCalendarSlotValueWithISODefault(kt);const Jt=PrepareTemporalFields(kt,CalendarFields(Wt,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),[]);({year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt}=InterpretTemporalDateTimeFields(Wt,Jt,At))}else{let Jt;if(ToTemporalOverflow(At),{year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt,calendar:Wt,z:Jt}=function(Xt){return ParseISODateTime(Xt)}(ToString(kt)),Jt)throw new RangeError("Z designator not supported for PlainDateTime");if(RejectDateTime(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt),Wt||(Wt="iso8601"),!IsBuiltinCalendar(Wt))throw new RangeError(`invalid calendar identifier ${Wt}`);Wt=ASCIILowercase(Wt)}return CreateTemporalDateTime(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt)}function ToTemporalDuration(kt){if(IsTemporalDuration(kt))return kt;let{years:At,months:xt,weeks:Bt,days:Nt,hours:jt,minutes:Ut,seconds:Lt,milliseconds:Ht,microseconds:Vt,nanoseconds:zt}=ToTemporalDurationRecord(kt);return new(GetIntrinsic("%Temporal.Duration%"))(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt)}function ToTemporalInstant(kt){if(IsTemporalInstant(kt))return kt;if(IsTemporalZonedDateTime(kt))return new(GetIntrinsic("%Temporal.Instant%"))(GetSlot(kt,n));const At=ParseTemporalInstant(ToString(kt));return new(GetIntrinsic("%Temporal.Instant%"))(At)}function ToTemporalMonthDay(kt,At){let xt=kt;if(IsObject(xt)){if(IsTemporalMonthDay(xt))return xt;let Lt,Ht;if(HasSlot(xt,p))Lt=GetSlot(xt,p),Ht=!1;else{let zt=xt.calendar;Ht=zt===void 0,zt===void 0&&(zt="iso8601"),Lt=ToTemporalCalendarSlotValue(zt)}const Vt=PrepareTemporalFields(xt,CalendarFields(Lt,["day","month","monthCode","year"]),[]);return Ht&&Vt.month!==void 0&&Vt.monthCode===void 0&&Vt.year===void 0&&(Vt.year=1972),CalendarMonthDayFromFields(Lt,Vt,At)}ToTemporalOverflow(At);let{month:Bt,day:Nt,referenceISOYear:jt,calendar:Ut}=ParseTemporalMonthDayString(ToString(xt));if(Ut===void 0&&(Ut="iso8601"),!IsBuiltinCalendar(Ut))throw new RangeError(`invalid calendar identifier ${Ut}`);return Ut=ASCIILowercase(Ut),jt===void 0?(RejectISODate(1972,Bt,Nt),CreateTemporalMonthDay(Bt,Nt,Ut)):CalendarMonthDayFromFields(Ut,CreateTemporalMonthDay(Bt,Nt,Ut,jt))}function ToTemporalTime(kt,At="constrain"){let xt,Bt,Nt,jt,Ut,Lt,Ht=kt;if(IsObject(Ht)){if(IsTemporalTime(Ht))return Ht;if(IsTemporalZonedDateTime(Ht)&&(Ht=GetPlainDateTimeFor(GetSlot(Ht,g),GetSlot(Ht,S),GetSlot(Ht,p))),IsTemporalDateTime(Ht))return new(GetIntrinsic("%Temporal.PlainTime%"))(GetSlot(Ht,d$1),GetSlot(Ht,m$1),GetSlot(Ht,c),GetSlot(Ht,h$1),GetSlot(Ht,u),GetSlot(Ht,T));({hour:xt,minute:Bt,second:Nt,millisecond:jt,microsecond:Ut,nanosecond:Lt}=ToTemporalTimeRecord(Ht)),{hour:xt,minute:Bt,second:Nt,millisecond:jt,microsecond:Ut,nanosecond:Lt}=RegulateTime(xt,Bt,Nt,jt,Ut,Lt,At)}else({hour:xt,minute:Bt,second:Nt,millisecond:jt,microsecond:Ut,nanosecond:Lt}=function(zt){const Wt=z.exec(zt);let Jt,Qt,Xt,tr,rr,nr,ar;if(Wt){Jt=ToIntegerOrInfinity(Wt[1]),Qt=ToIntegerOrInfinity(Wt[2]||Wt[5]),Xt=ToIntegerOrInfinity(Wt[3]||Wt[6]),Xt===60&&(Xt=59);const ir=(Wt[4]||Wt[7])+"000000000";tr=ToIntegerOrInfinity(ir.slice(0,3)),rr=ToIntegerOrInfinity(ir.slice(3,6)),nr=ToIntegerOrInfinity(ir.slice(6,9)),ar=Wt[14];for(const[,lr,yr,Sr]of ar.matchAll(H))if(yr!=="u-ca"&&lr==="!")throw new RangeError(`Unrecognized annotation: !${yr}=${Sr}`);if(Wt[8])throw new RangeError("Z designator not supported for PlainTime")}else{let ir,lr;if({hasTime:lr,hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr,z:ir}=ParseISODateTime(zt),!lr)throw new RangeError(`time is missing in string: ${zt}`);if(ir)throw new RangeError("Z designator not supported for PlainTime")}if(/[tT ][0-9][0-9]/.test(zt))return{hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr};try{const{month:ir,day:lr}=ParseTemporalMonthDayString(zt);RejectISODate(1972,ir,lr)}catch{try{const{year:ir,month:lr}=ParseTemporalYearMonthString(zt);RejectISODate(ir,lr,1)}catch{return{hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr}}}throw new RangeError(`invalid ISO 8601 time-only string ${zt}; may need a T prefix`)}(ToString(Ht))),RejectTime(xt,Bt,Nt,jt,Ut,Lt);return new(GetIntrinsic("%Temporal.PlainTime%"))(xt,Bt,Nt,jt,Ut,Lt)}function ToTemporalYearMonth(kt,At){if(IsObject(kt)){if(IsTemporalYearMonth(kt))return kt;const Ut=GetTemporalCalendarSlotValueWithISODefault(kt);return CalendarYearMonthFromFields(Ut,PrepareTemporalFields(kt,CalendarFields(Ut,["month","monthCode","year"]),[]),At)}ToTemporalOverflow(At);let{year:xt,month:Bt,referenceISODay:Nt,calendar:jt}=ParseTemporalYearMonthString(ToString(kt));if(jt===void 0&&(jt="iso8601"),!IsBuiltinCalendar(jt))throw new RangeError(`invalid calendar identifier ${jt}`);return jt=ASCIILowercase(jt),Nt===void 0?(RejectISODate(xt,Bt,1),CreateTemporalYearMonth(xt,Bt,jt)):CalendarYearMonthFromFields(jt,CreateTemporalYearMonth(xt,Bt,jt,Nt))}function InterpretISODateTimeOffset(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt){const tr=new(GetIntrinsic("%Temporal.PlainDateTime%"))(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht);if(Vt==="wall"||Qt==="ignore")return GetSlot(GetInstantFor(Wt,tr,Jt),n);if(Vt==="exact"||Qt==="use"){const nr=GetUTCEpochNanoseconds(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht);if(nr===null)throw new RangeError("ZonedDateTime outside of supported range");return JSBI.subtract(nr,JSBI.BigInt(zt))}const rr=GetPossibleInstantsFor(Wt,tr);for(const nr of rr){const ar=GetOffsetNanosecondsFor(Wt,nr),ir=JSBI.toNumber(RoundNumberToIncrement(JSBI.BigInt(ar),be,"halfExpand"));if(ar===zt||Xt&&ir===zt)return GetSlot(nr,n)}if(Qt==="reject"){const nr=FormatTimeZoneOffsetString(zt),ar=IsTemporalTimeZone(Wt)?GetSlot(Wt,a):"time zone";throw new RangeError(`Offset ${nr} is invalid for ${tr.toString()} in ${ar}`)}return GetSlot(DisambiguatePossibleInstants(rr,Wt,tr,Jt),n)}function ToTemporalZonedDateTime(kt,At){let xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr=!1,nr="option";if(IsObject(kt)){if(IsTemporalZonedDateTime(kt))return kt;Qt=GetTemporalCalendarSlotValueWithISODefault(kt);const ir=CalendarFields(Qt,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);ir.push("timeZone","offset");const lr=PrepareTemporalFields(kt,ir,["timeZone"]);Wt=ToTemporalTimeZoneSlotValue(lr.timeZone),Jt=lr.offset,Jt===void 0&&(nr="wall"),Xt=ToTemporalDisambiguation(At),tr=ToTemporalOffset(At,"reject"),{year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt}=InterpretTemporalDateTimeFields(Qt,lr,At)}else{let ir,lr;if({year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt,ianaName:ir,offset:Jt,z:lr,calendar:Qt}=function(Sr){const Ar=ParseISODateTime(Sr);if(!Ar.ianaName)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return Ar}(ToString(kt)),Wt=ToTemporalTimeZoneSlotValue(ir),lr?nr="exact":Jt||(nr="wall"),Qt||(Qt="iso8601"),!IsBuiltinCalendar(Qt))throw new RangeError(`invalid calendar identifier ${Qt}`);Qt=ASCIILowercase(Qt),rr=!0,Xt=ToTemporalDisambiguation(At),tr=ToTemporalOffset(At,"reject"),ToTemporalOverflow(At)}let ar=0;return nr==="option"&&(ar=ParseTimeZoneOffsetString(Jt)),CreateTemporalZonedDateTime(InterpretISODateTimeOffset(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,nr,ar,Wt,Xt,tr,rr),Wt,Qt)}function CreateTemporalDateSlots(kt,At,xt,Bt,Nt){RejectISODate(At,xt,Bt),RejectDateRange(At,xt,Bt),N(kt),SetSlot(kt,i$3,At),SetSlot(kt,s$2,xt),SetSlot(kt,l,Bt),SetSlot(kt,p,Nt),SetSlot(kt,f$1,!0)}function CreateTemporalDate(kt,At,xt,Bt="iso8601"){const Nt=GetIntrinsic("%Temporal.PlainDate%"),jt=Te(Nt.prototype);return CreateTemporalDateSlots(jt,kt,At,xt,Bt),jt}function CreateTemporalDateTimeSlots(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt){RejectDateTime(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt),RejectDateTimeRange(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt),N(kt),SetSlot(kt,i$3,At),SetSlot(kt,s$2,xt),SetSlot(kt,l,Bt),SetSlot(kt,d$1,Nt),SetSlot(kt,m$1,jt),SetSlot(kt,c,Ut),SetSlot(kt,h$1,Lt),SetSlot(kt,u,Ht),SetSlot(kt,T,Vt),SetSlot(kt,p,zt)}function CreateTemporalDateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt="iso8601"){const zt=GetIntrinsic("%Temporal.PlainDateTime%"),Wt=Te(zt.prototype);return CreateTemporalDateTimeSlots(Wt,kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt),Wt}function CreateTemporalMonthDaySlots(kt,At,xt,Bt,Nt){RejectISODate(Nt,At,xt),RejectDateRange(Nt,At,xt),N(kt),SetSlot(kt,s$2,At),SetSlot(kt,l,xt),SetSlot(kt,i$3,Nt),SetSlot(kt,p,Bt),SetSlot(kt,I,!0)}function CreateTemporalMonthDay(kt,At,xt="iso8601",Bt=1972){const Nt=GetIntrinsic("%Temporal.PlainMonthDay%"),jt=Te(Nt.prototype);return CreateTemporalMonthDaySlots(jt,kt,At,xt,Bt),jt}function CreateTemporalYearMonthSlots(kt,At,xt,Bt,Nt){RejectISODate(At,xt,Nt),function(Ut,Lt){RejectToRange(Ut,Fe,Ye),Ut===Fe?RejectToRange(Lt,4,12):Ut===Ye&&RejectToRange(Lt,1,9)}(At,xt),N(kt),SetSlot(kt,i$3,At),SetSlot(kt,s$2,xt),SetSlot(kt,l,Nt),SetSlot(kt,p,Bt),SetSlot(kt,y$1,!0)}function CreateTemporalYearMonth(kt,At,xt="iso8601",Bt=1){const Nt=GetIntrinsic("%Temporal.PlainYearMonth%"),jt=Te(Nt.prototype);return CreateTemporalYearMonthSlots(jt,kt,At,xt,Bt),jt}function CreateTemporalZonedDateTimeSlots(kt,At,xt,Bt){ValidateEpochNanoseconds(At),N(kt),SetSlot(kt,n,At),SetSlot(kt,g,xt),SetSlot(kt,p,Bt);const Nt=new(GetIntrinsic("%Temporal.Instant%"))(GetSlot(kt,n));SetSlot(kt,S,Nt)}function CreateTemporalZonedDateTime(kt,At,xt="iso8601"){const Bt=GetIntrinsic("%Temporal.ZonedDateTime%"),Nt=Te(Bt.prototype);return CreateTemporalZonedDateTimeSlots(Nt,kt,At,xt),Nt}function CalendarFields(kt,At){if(typeof kt=="string"){const Nt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.fields%"),Nt,[At])}const xt=Call(GetMethod(kt,"fields"),kt,[At]),Bt=[];for(const Nt of xt){if(typeof Nt!="string")throw new TypeError("bad return from calendar.fields()");te.call(Bt,Nt)}return Bt}function CalendarMergeFields(kt,At,xt){if(typeof kt=="string"){const Nt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.mergeFields%"),Nt,[At,xt])}const Bt=Call(GetMethod(kt,"mergeFields"),kt,[At,xt]);if(!IsObject(Bt))throw new TypeError("bad return from calendar.mergeFields()");return Bt}function CalendarDateAdd(kt,At,xt,Bt,Nt){let jt=Nt;if(typeof kt=="string"){const Lt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.dateAdd%"),Lt,[At,xt,Bt])}jt===void 0&&(jt=GetMethod(kt,"dateAdd"));const Ut=fe(jt,kt,[At,xt,Bt]);if(!IsTemporalDate(Ut))throw new TypeError("invalid result");return Ut}function CalendarDateUntil(kt,At,xt,Bt,Nt){let jt=Nt;if(typeof kt=="string"){const Lt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.dateUntil%"),Lt,[At,xt,Bt])}jt===void 0&&(jt=GetMethod(kt,"dateUntil"));const Ut=fe(jt,kt,[At,xt,Bt]);if(!IsTemporalDuration(Ut))throw new TypeError("invalid result");return Ut}function CalendarYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.year%"),Bt,[At])}let xt=Call(GetMethod(kt,"year"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar year result must be an integer");if(!IsIntegralNumber(xt))throw new RangeError("calendar year result must be an integer");return xt}function CalendarMonth(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.month%"),Bt,[At])}let xt=Call(GetMethod(kt,"month"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar month result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar month result must be a positive integer");return xt}function CalendarMonthCode(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.monthCode%"),Bt,[At])}let xt=Call(GetMethod(kt,"monthCode"),kt,[At]);if(typeof xt!="string")throw new TypeError("calendar monthCode result must be a string");return xt}function CalendarDay(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.day%"),Bt,[At])}const xt=Call(GetMethod(kt,"day"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar day result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar day result must be a positive integer");return xt}function CalendarEra(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.era%"),Bt,[At])}let xt=Call(GetMethod(kt,"era"),kt,[At]);if(xt===void 0)return xt;if(typeof xt!="string")throw new TypeError("calendar era result must be a string or undefined");return xt}function CalendarEraYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.eraYear%"),Bt,[At])}let xt=Call(GetMethod(kt,"eraYear"),kt,[At]);if(xt===void 0)return xt;if(typeof xt!="number")throw new TypeError("calendar eraYear result must be an integer or undefined");if(!IsIntegralNumber(xt))throw new RangeError("calendar eraYear result must be an integer or undefined");return xt}function CalendarDayOfWeek(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.dayOfWeek%"),Bt,[At])}const xt=Call(GetMethod(kt,"dayOfWeek"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar dayOfWeek result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar dayOfWeek result must be a positive integer");return xt}function CalendarDayOfYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.dayOfYear%"),Bt,[At])}const xt=Call(GetMethod(kt,"dayOfYear"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar dayOfYear result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar dayOfYear result must be a positive integer");return xt}function CalendarWeekOfYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.weekOfYear%"),Bt,[At])}const xt=Call(GetMethod(kt,"weekOfYear"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar weekOfYear result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar weekOfYear result must be a positive integer");return xt}function CalendarYearOfWeek(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.yearOfWeek%"),Bt,[At])}const xt=Call(GetMethod(kt,"yearOfWeek"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar yearOfWeek result must be an integer");if(!IsIntegralNumber(xt))throw new RangeError("calendar yearOfWeek result must be an integer");return xt}function CalendarDaysInWeek(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.daysInWeek%"),Bt,[At])}const xt=Call(GetMethod(kt,"daysInWeek"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar daysInWeek result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar daysInWeek result must be a positive integer");return xt}function CalendarDaysInMonth(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.daysInMonth%"),Bt,[At])}const xt=Call(GetMethod(kt,"daysInMonth"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar daysInMonth result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar daysInMonth result must be a positive integer");return xt}function CalendarDaysInYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.daysInYear%"),Bt,[At])}const xt=Call(GetMethod(kt,"daysInYear"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar daysInYear result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar daysInYear result must be a positive integer");return xt}function CalendarMonthsInYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.monthsInYear%"),Bt,[At])}const xt=Call(GetMethod(kt,"monthsInYear"),kt,[At]);if(typeof xt!="number")throw new TypeError("calendar monthsInYear result must be a positive integer");if(!IsIntegralNumber(xt)||xt<1)throw new RangeError("calendar monthsInYear result must be a positive integer");return xt}function CalendarInLeapYear(kt,At){if(typeof kt=="string"){const Bt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.inLeapYear%"),Bt,[At])}const xt=Call(GetMethod(kt,"inLeapYear"),kt,[At]);if(typeof xt!="boolean")throw new TypeError("calendar inLeapYear result must be a boolean");return xt}function ToTemporalCalendarSlotValue(kt){if(IsObject(kt)){if(HasSlot(kt,p))return GetSlot(kt,p);if(!function(Nt){return!!IsTemporalCalendar(Nt)||"dateAdd"in Nt&&"dateFromFields"in Nt&&"dateUntil"in Nt&&"day"in Nt&&"dayOfWeek"in Nt&&"dayOfYear"in Nt&&"daysInMonth"in Nt&&"daysInWeek"in Nt&&"daysInYear"in Nt&&"fields"in Nt&&"id"in Nt&&"inLeapYear"in Nt&&"mergeFields"in Nt&&"month"in Nt&&"monthCode"in Nt&&"monthDayFromFields"in Nt&&"monthsInYear"in Nt&&"weekOfYear"in Nt&&"year"in Nt&&"yearMonthFromFields"in Nt&&"yearOfWeek"in Nt}(kt))throw new TypeError("expected a Temporal.Calendar or object implementing the Temporal.Calendar protocol");return kt}const At=ToString(kt);if(IsBuiltinCalendar(At))return ASCIILowercase(At);let xt;try{({calendar:xt}=ParseISODateTime(At))}catch{try{({calendar:xt}=ParseTemporalYearMonthString(At))}catch{({calendar:xt}=ParseTemporalMonthDayString(At))}}if(xt||(xt="iso8601"),!IsBuiltinCalendar(xt))throw new RangeError(`invalid calendar identifier ${xt}`);return ASCIILowercase(xt)}function GetTemporalCalendarSlotValueWithISODefault(kt){if(HasSlot(kt,p))return GetSlot(kt,p);const{calendar:At}=kt;return At===void 0?"iso8601":ToTemporalCalendarSlotValue(At)}function ToTemporalCalendarIdentifier(kt){if(typeof kt=="string")return kt;const At=kt.id;if(typeof At!="string")throw new TypeError("calendar.id should be a string");return At}function ToTemporalCalendarObject(kt){return IsObject(kt)?kt:new(GetIntrinsic("%Temporal.Calendar%"))(kt)}function CalendarEquals(kt,At){return kt===At?!0:ToTemporalCalendarIdentifier(kt)===ToTemporalCalendarIdentifier(At)}function ThrowIfCalendarsNotEqual(kt,At,xt){if(kt===At)return;const Bt=ToTemporalCalendarIdentifier(kt),Nt=ToTemporalCalendarIdentifier(At);if(Bt!==Nt)throw new RangeError(`cannot ${xt} of ${Bt} and ${Nt} calendars`)}function ConsolidateCalendars(kt,At){if(kt===At)return At;const xt=ToTemporalCalendarIdentifier(kt),Bt=ToTemporalCalendarIdentifier(At);if(xt===Bt||xt==="iso8601")return At;if(Bt==="iso8601")return kt;throw new RangeError("irreconcilable calendars")}function CalendarDateFromFields(kt,At,xt,Bt){if(typeof kt=="string"){const jt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.dateFromFields%"),jt,[At,xt])}const Nt=Call(GetMethod(kt,"dateFromFields"),kt,[At,xt]);if(!IsTemporalDate(Nt))throw new TypeError("invalid result");return Nt}function CalendarYearMonthFromFields(kt,At,xt){if(typeof kt=="string"){const Nt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.yearMonthFromFields%"),Nt,[At,xt])}let Bt=Call(GetMethod(kt,"yearMonthFromFields"),kt,[At,xt]);if(!IsTemporalYearMonth(Bt))throw new TypeError("invalid result");return Bt}function CalendarMonthDayFromFields(kt,At,xt){if(typeof kt=="string"){const Nt=new(GetIntrinsic("%Temporal.Calendar%"))(kt);return Call(GetIntrinsic("%Temporal.Calendar.prototype.monthDayFromFields%"),Nt,[At,xt])}let Bt=Call(GetMethod(kt,"monthDayFromFields"),kt,[At,xt]);if(!IsTemporalMonthDay(Bt))throw new TypeError("invalid result");return Bt}function ToTemporalTimeZoneSlotValue(kt){if(IsObject(kt)){if(IsTemporalZonedDateTime(kt))return GetSlot(kt,g);if(!function(xt){return!!IsTemporalTimeZone(xt)||"getOffsetNanosecondsFor"in xt&&"getPossibleInstantsFor"in xt&&"id"in xt}(kt))throw new TypeError("expected a Temporal.TimeZone or object implementing the Temporal.TimeZone protocol");return kt}return ParseTemporalTimeZone(ToString(kt))}function ToTemporalTimeZoneIdentifier(kt){if(typeof kt=="string")return kt;const At=kt.id;if(typeof At!="string")throw new TypeError("timeZone.id should be a string");return At}function ToTemporalTimeZoneObject(kt){return IsObject(kt)?kt:new(GetIntrinsic("%Temporal.TimeZone%"))(kt)}function TimeZoneEquals(kt,At){return kt===At?!0:ToTemporalTimeZoneIdentifier(kt)===ToTemporalTimeZoneIdentifier(At)}function TemporalDateTimeToDate(kt){return CreateTemporalDate(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l),GetSlot(kt,p))}function TemporalDateTimeToTime(kt){return new(GetIntrinsic("%Temporal.PlainTime%"))(GetSlot(kt,d$1),GetSlot(kt,m$1),GetSlot(kt,c),GetSlot(kt,h$1),GetSlot(kt,u),GetSlot(kt,T))}function GetOffsetNanosecondsFor(kt,At,xt){if(typeof kt=="string"){const Nt=new(GetIntrinsic("%Temporal.TimeZone%"))(kt);return Call(GetIntrinsic("%Temporal.TimeZone.prototype.getOffsetNanosecondsFor%"),Nt,[At])}const Bt=Call(GetMethod(kt,"getOffsetNanosecondsFor"),kt,[At]);if(typeof Bt!="number")throw new TypeError("bad return from getOffsetNanosecondsFor");if(!IsIntegralNumber(Bt)||ae(Bt)>=864e11)throw new RangeError("out-of-range return from getOffsetNanosecondsFor");return Bt}function GetOffsetStringFor(kt,At){return FormatTimeZoneOffsetString(GetOffsetNanosecondsFor(kt,At))}function GetPlainDateTimeFor(kt,At,xt){const Bt=GetSlot(At,n),Nt=GetOffsetNanosecondsFor(kt,At);let{year:jt,month:Ut,day:Lt,hour:Ht,minute:Vt,second:zt,millisecond:Wt,microsecond:Jt,nanosecond:Qt}=GetISOPartsFromEpoch(Bt);return{year:jt,month:Ut,day:Lt,hour:Ht,minute:Vt,second:zt,millisecond:Wt,microsecond:Jt,nanosecond:Qt}=BalanceISODateTime(jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt+Nt),CreateTemporalDateTime(jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,xt)}function GetInstantFor(kt,At,xt){return DisambiguatePossibleInstants(GetPossibleInstantsFor(kt,At),kt,At,xt)}function DisambiguatePossibleInstants(kt,At,xt,Bt){const Nt=GetIntrinsic("%Temporal.Instant%"),jt=kt.length;if(jt===1)return kt[0];if(jt)switch(Bt){case"compatible":case"earlier":return kt[0];case"later":return kt[jt-1];case"reject":throw new RangeError("multiple instants found")}const Ut=GetSlot(xt,i$3),Lt=GetSlot(xt,s$2),Ht=GetSlot(xt,l),Vt=GetSlot(xt,d$1),zt=GetSlot(xt,m$1),Wt=GetSlot(xt,c),Jt=GetSlot(xt,h$1),Qt=GetSlot(xt,u),Xt=GetSlot(xt,T),tr=GetUTCEpochNanoseconds(Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt);if(tr===null)throw new RangeError("DateTime outside of supported range");const rr=new Nt(JSBI.subtract(tr,Ee)),nr=new Nt(JSBI.add(tr,Ee)),ar=GetOffsetNanosecondsFor(At,rr),ir=GetOffsetNanosecondsFor(At,nr)-ar;switch(Bt){case"earlier":{const lr=GetSlot(xt,p),yr=GetIntrinsic("%Temporal.PlainDateTime%"),Sr=AddDateTime(Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,lr,0,0,0,0,0,0,0,0,0,-ir,void 0);return GetPossibleInstantsFor(At,new yr(Sr.year,Sr.month,Sr.day,Sr.hour,Sr.minute,Sr.second,Sr.millisecond,Sr.microsecond,Sr.nanosecond,lr))[0]}case"compatible":case"later":{const lr=GetSlot(xt,p),yr=GetIntrinsic("%Temporal.PlainDateTime%"),Sr=AddDateTime(Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,lr,0,0,0,0,0,0,0,0,0,ir,void 0),Ar=GetPossibleInstantsFor(At,new yr(Sr.year,Sr.month,Sr.day,Sr.hour,Sr.minute,Sr.second,Sr.millisecond,Sr.microsecond,Sr.nanosecond,lr));return Ar[Ar.length-1]}case"reject":throw new RangeError("no such instant found")}}function GetPossibleInstantsFor(kt,At,xt){if(typeof kt=="string"){const jt=new(GetIntrinsic("%Temporal.TimeZone%"))(kt);return Call(GetIntrinsic("%Temporal.TimeZone.prototype.getPossibleInstantsFor%"),jt,[At])}const Bt=Call(GetMethod(kt,"getPossibleInstantsFor"),kt,[At]),Nt=[];for(const jt of Bt){if(!IsTemporalInstant(jt))throw new TypeError("bad return from getPossibleInstantsFor");te.call(Nt,jt)}return Nt}function ISOYearString(kt){let At;return kt<0||kt>9999?At=(kt<0?"-":"+")+`000000${ae(kt)}`.slice(-6):At=`0000${kt}`.slice(-4),At}function ISODateTimePartString(kt){return`00${kt}`.slice(-2)}function FormatSecondsStringPart(kt,At,xt,Bt,Nt){if(Nt==="minute")return"";const jt=`:${ISODateTimePartString(kt)}`;let Ut,Lt=1e6*At+1e3*xt+Bt;if(Nt==="auto"){if(Lt===0)return jt;for(Ut=`${Lt}`.padStart(9,"0");Ut[Ut.length-1]==="0";)Ut=Ut.slice(0,-1)}else{if(Nt===0)return jt;Ut=`${Lt}`.padStart(9,"0").slice(0,Nt)}return`${jt}.${Ut}`}function TemporalInstantToString(kt,At,xt){let Bt=At;Bt===void 0&&(Bt="UTC");const Nt=GetPlainDateTimeFor(Bt,kt,"iso8601"),jt=ISOYearString(GetSlot(Nt,i$3)),Ut=ISODateTimePartString(GetSlot(Nt,s$2)),Lt=ISODateTimePartString(GetSlot(Nt,l)),Ht=ISODateTimePartString(GetSlot(Nt,d$1)),Vt=ISODateTimePartString(GetSlot(Nt,m$1)),zt=FormatSecondsStringPart(GetSlot(Nt,c),GetSlot(Nt,h$1),GetSlot(Nt,u),GetSlot(Nt,T),xt);let Wt="Z";return At!==void 0&&(Wt=FormatISOTimeZoneOffsetString(GetOffsetNanosecondsFor(Bt,kt))),`${jt}-${Ut}-${Lt}T${Ht}:${Vt}${zt}${Wt}`}function TemporalDurationToString(kt,At="auto",xt){function Bt(Br){return Br<=ue?Br.toString(10):JSBI.BigInt(Br).toString(10)}const Nt=GetSlot(kt,w$1),jt=GetSlot(kt,D),Ut=GetSlot(kt,G),Lt=GetSlot(kt,v),Ht=GetSlot(kt,C),Vt=GetSlot(kt,O);let zt=GetSlot(kt,b),Wt=GetSlot(kt,E$1),Jt=GetSlot(kt,M),Qt=GetSlot(kt,R);const Xt=DurationSign(Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt);if(xt){const{unit:Br,increment:Lr,roundingMode:Or}=xt;({seconds:zt,milliseconds:Wt,microseconds:Jt,nanoseconds:Qt}=RoundDuration(0,0,0,0,0,0,zt,Wt,Jt,Qt,Lr,Br,Or))}const tr=[];Nt&&tr.push(`${Bt(ae(Nt))}Y`),jt&&tr.push(`${Bt(ae(jt))}M`),Ut&&tr.push(`${Bt(ae(Ut))}W`),Lt&&tr.push(`${Bt(ae(Lt))}D`);const rr=[];Ht&&rr.push(`${Bt(ae(Ht))}H`),Vt&&rr.push(`${Bt(ae(Vt))}M`);const nr=[];let ar,ir,lr,yr,Sr=TotalDurationNanoseconds(0,0,0,zt,Wt,Jt,Qt,0);({quotient:Sr,remainder:ar}=divmod(Sr,De)),{quotient:Sr,remainder:ir}=divmod(Sr,De),{quotient:yr,remainder:lr}=divmod(Sr,De);const Ar=1e6*ae(JSBI.toNumber(lr))+1e3*ae(JSBI.toNumber(ir))+ae(JSBI.toNumber(ar));let Dr;if(At==="auto"){if(Ar!==0)for(Dr=`${Ar}`.padStart(9,"0");Dr[Dr.length-1]==="0";)Dr=Dr.slice(0,-1)}else At!==0&&(Dr=`${Ar}`.padStart(9,"0").slice(0,At));return Dr&&nr.unshift(".",Dr),JSBI.equal(yr,Ie)&&!nr.length&&At==="auto"||nr.unshift(abs(yr).toString()),nr.length&&rr.push(`${nr.join("")}S`),rr.length&&rr.unshift("T"),tr.length||rr.length?`${Xt<0?"-":""}P${tr.join("")}${rr.join("")}`:"PT0S"}function TemporalDateToString(kt,At="auto"){return`${ISOYearString(GetSlot(kt,i$3))}-${ISODateTimePartString(GetSlot(kt,s$2))}-${ISODateTimePartString(GetSlot(kt,l))}${MaybeFormatCalendarAnnotation(GetSlot(kt,p),At)}`}function TemporalDateTimeToString(kt,At,xt="auto",Bt){let Nt=GetSlot(kt,i$3),jt=GetSlot(kt,s$2),Ut=GetSlot(kt,l),Lt=GetSlot(kt,d$1),Ht=GetSlot(kt,m$1),Vt=GetSlot(kt,c),zt=GetSlot(kt,h$1),Wt=GetSlot(kt,u),Jt=GetSlot(kt,T);if(Bt){const{unit:Qt,increment:Xt,roundingMode:tr}=Bt;({year:Nt,month:jt,day:Ut,hour:Lt,minute:Ht,second:Vt,millisecond:zt,microsecond:Wt,nanosecond:Jt}=RoundISODateTime(Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Xt,Qt,tr))}return`${ISOYearString(Nt)}-${ISODateTimePartString(jt)}-${ISODateTimePartString(Ut)}T${ISODateTimePartString(Lt)}:${ISODateTimePartString(Ht)}${FormatSecondsStringPart(Vt,zt,Wt,Jt,At)}${MaybeFormatCalendarAnnotation(GetSlot(kt,p),xt)}`}function TemporalMonthDayToString(kt,At="auto"){let xt=`${ISODateTimePartString(GetSlot(kt,s$2))}-${ISODateTimePartString(GetSlot(kt,l))}`;const Bt=ToTemporalCalendarIdentifier(GetSlot(kt,p));(At==="always"||At==="critical"||Bt!=="iso8601")&&(xt=`${ISOYearString(GetSlot(kt,i$3))}-${xt}`);const Nt=FormatCalendarAnnotation(Bt,At);return Nt&&(xt+=Nt),xt}function TemporalYearMonthToString(kt,At="auto"){let xt=`${ISOYearString(GetSlot(kt,i$3))}-${ISODateTimePartString(GetSlot(kt,s$2))}`;const Bt=ToTemporalCalendarIdentifier(GetSlot(kt,p));(At==="always"||At==="critical"||Bt!=="iso8601")&&(xt+=`-${ISODateTimePartString(GetSlot(kt,l))}`);const Nt=FormatCalendarAnnotation(Bt,At);return Nt&&(xt+=Nt),xt}function TemporalZonedDateTimeToString(kt,At,xt="auto",Bt="auto",Nt="auto",jt){let Ut=GetSlot(kt,S);if(jt){const{unit:zt,increment:Wt,roundingMode:Jt}=jt,Qt=RoundInstant(GetSlot(kt,n),Wt,zt,Jt);Ut=new(GetIntrinsic("%Temporal.Instant%"))(Qt)}const Lt=GetSlot(kt,g),Ht=GetPlainDateTimeFor(Lt,Ut,"iso8601");let Vt=`${ISOYearString(GetSlot(Ht,i$3))}-${ISODateTimePartString(GetSlot(Ht,s$2))}-${ISODateTimePartString(GetSlot(Ht,l))}T${ISODateTimePartString(GetSlot(Ht,d$1))}:${ISODateTimePartString(GetSlot(Ht,m$1))}${FormatSecondsStringPart(GetSlot(Ht,c),GetSlot(Ht,h$1),GetSlot(Ht,u),GetSlot(Ht,T),At)}`;return Nt!=="never"&&(Vt+=FormatISOTimeZoneOffsetString(GetOffsetNanosecondsFor(Lt,Ut))),Bt!=="never"&&(Vt+=`[${Bt==="critical"?"!":""}${ToTemporalTimeZoneIdentifier(Lt)}]`),Vt+=MaybeFormatCalendarAnnotation(GetSlot(kt,p),xt),Vt}function IsTimeZoneOffsetString(kt){return ze.test(he(kt))}function ParseTimeZoneOffsetString(kt){const At=ze.exec(he(kt));if(!At)throw new RangeError(`invalid time zone offset: ${kt}`);return(At[1]==="-"||At[1]===""?-1:1)*(1e9*(60*(60*+At[2]+ +(At[3]||0))+ +(At[4]||0))+ +((At[5]||0)+"000000000").slice(0,9))}function GetCanonicalTimeZoneIdentifier(kt){return IsTimeZoneOffsetString(kt)?FormatTimeZoneOffsetString(ParseTimeZoneOffsetString(kt)):getIntlDateTimeFormatEnUsForTimeZone(he(kt)).resolvedOptions().timeZone}function GetNamedTimeZoneOffsetNanoseconds(kt,At){const{year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt,nanosecond:zt}=GetNamedTimeZoneDateTimeParts(kt,At),Wt=xt%400,Jt=(xt-Wt)/400,Qt=JSBI.multiply(JSBI.BigInt(146097),Ee),Xt=GetUTCEpochNanoseconds(Wt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt),tr=JSBI.add(Xt,JSBI.multiply(Qt,JSBI.BigInt(Jt)));return JSBI.toNumber(JSBI.subtract(tr,At))}function FormatTimeZoneOffsetString(kt){const At=kt<0?"-":"+",xt=ae(kt),Bt=xt%1e9,Nt=ie(xt/1e9)%60,jt=ie(xt/6e10)%60,Ut=ISODateTimePartString(ie(xt/36e11)),Lt=ISODateTimePartString(jt),Ht=ISODateTimePartString(Nt);let Vt="";if(Bt){let zt=`${Bt}`.padStart(9,"0");for(;zt[zt.length-1]==="0";)zt=zt.slice(0,-1);Vt=`:${Ht}.${zt}`}else Nt&&(Vt=`:${Ht}`);return`${At}${Ut}:${Lt}${Vt}`}function FormatISOTimeZoneOffsetString(kt){let At=JSBI.toNumber(RoundNumberToIncrement(JSBI.BigInt(kt),be,"halfExpand"));const xt=At<0?"-":"+";At=ae(At);const Bt=At/6e10%60;return`${xt}${ISODateTimePartString(ie(At/36e11))}:${ISODateTimePartString(Bt)}`}function GetUTCEpochNanoseconds(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht){const Vt=new Date;Vt.setUTCHours(Bt,Nt,jt,Ut),Vt.setUTCFullYear(kt,At-1,xt);const zt=Vt.getTime();if(de(zt))return null;let Wt=JSBI.multiply(JSBI.BigInt(zt),Ge);return Wt=JSBI.add(Wt,JSBI.multiply(JSBI.BigInt(Lt),De)),Wt=JSBI.add(Wt,JSBI.BigInt(Ht)),JSBI.lessThan(Wt,Me)||JSBI.greaterThan(Wt,Re)?null:Wt}function GetISOPartsFromEpoch(kt){const{quotient:At,remainder:xt}=divmod(kt,Ge);let Bt=JSBI.toNumber(At),Nt=JSBI.toNumber(xt);Nt<0&&(Nt+=1e6,Bt-=1);const jt=ie(Nt/1e3)%1e3,Ut=Nt%1e3,Lt=new Date(Bt);return{epochMilliseconds:Bt,year:Lt.getUTCFullYear(),month:Lt.getUTCMonth()+1,day:Lt.getUTCDate(),hour:Lt.getUTCHours(),minute:Lt.getUTCMinutes(),second:Lt.getUTCSeconds(),millisecond:Lt.getUTCMilliseconds(),microsecond:jt,nanosecond:Ut}}function GetNamedTimeZoneDateTimeParts(kt,At){const{epochMilliseconds:xt,millisecond:Bt,microsecond:Nt,nanosecond:jt}=GetISOPartsFromEpoch(At),{year:Ut,month:Lt,day:Ht,hour:Vt,minute:zt,second:Wt}=function(Qt,Xt){const tr=getIntlDateTimeFormatEnUsForTimeZone(Qt).format(new Date(Xt));return function(nr){const ar=nr.split(/[^\w]+/);if(ar.length!==7)throw new RangeError(`expected 7 parts in "${nr}`);const ir=+ar[0],lr=+ar[1];let yr=+ar[2];const Sr=ar[3].toUpperCase();if(Sr==="B"||Sr==="BC")yr=1-yr;else if(Sr!=="A"&&Sr!=="AD")throw new RangeError(`Unknown era ${Sr} in "${nr}`);let Ar=+ar[4];Ar===24&&(Ar=0);const Dr=+ar[5],Br=+ar[6];if(!(me(yr)&&me(ir)&&me(lr)&&me(Ar)&&me(Dr)&&me(Br)))throw new RangeError(`Invalid number in "${nr}`);return{year:yr,month:ir,day:lr,hour:Ar,minute:Dr,second:Br}}(tr)}(kt,xt);return BalanceISODateTime(Ut,Lt,Ht,Vt,zt,Wt,Bt,Nt,jt)}function maxJSBI(kt,At){return JSBI.lessThan(kt,At)?At:kt}function afterLatestPossibleTzdbRuleChange(){return JSBI.add(Ve(),Ze)}function GetNamedTimeZoneNextTransition(kt,At){if(JSBI.lessThan(At,Pe))return GetNamedTimeZoneNextTransition(kt,Pe);const xt=JSBI.add(At,Be),Bt=maxJSBI(afterLatestPossibleTzdbRuleChange(),xt);let Nt=maxJSBI(Pe,At);const jt=GetNamedTimeZoneOffsetNanoseconds(kt,Nt);let Ut=Nt,Lt=jt;for(;jt===Lt&&JSBI.lessThan(JSBI.BigInt(Nt),Bt);){if(Ut=JSBI.add(Nt,Ne),JSBI.greaterThan(Ut,Re))return null;Lt=GetNamedTimeZoneOffsetNanoseconds(kt,Ut),jt===Lt&&(Nt=Ut)}return jt===Lt?null:bisect(Ht=>GetNamedTimeZoneOffsetNanoseconds(kt,Ht),Nt,Ut,jt,Lt)}function GetNamedTimeZonePreviousTransition(kt,At){const xt=afterLatestPossibleTzdbRuleChange(),Bt=JSBI.greaterThan(At,xt),Nt=Bt?JSBI.subtract(At,Be):Pe;if(kt==="Africa/Casablanca"||kt==="Africa/El_Aaiun"){const Vt=GetSlot(ToTemporalInstant("2088-01-01T00Z"),n);if(JSBI.lessThan(Vt,At))return GetNamedTimeZonePreviousTransition(kt,Vt)}let jt=JSBI.subtract(At,Se);if(JSBI.lessThan(jt,Pe))return null;const Ut=GetNamedTimeZoneOffsetNanoseconds(kt,jt);let Lt=jt,Ht=Ut;for(;Ut===Ht&&JSBI.greaterThan(jt,Nt);){if(Lt=JSBI.subtract(jt,Ne),JSBI.lessThan(Lt,Pe))return null;Ht=GetNamedTimeZoneOffsetNanoseconds(kt,Lt),Ut===Ht&&(jt=Lt)}if(Ut===Ht){if(Bt){const Vt=JSBI.subtract(xt,Ee);return GetNamedTimeZonePreviousTransition(kt,Vt)}return null}return bisect(Vt=>GetNamedTimeZoneOffsetNanoseconds(kt,Vt),Lt,jt,Ht,Ut)}function LeapYear(kt){return kt===void 0?!1:kt%4==0&&(kt%100!=0||kt%400==0)}function ISODaysInMonth(kt,At){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[LeapYear(kt)?"leapyear":"standard"][At-1]}function DayOfWeek(kt,At,xt){const Bt=At+(At<3?10:-2),Nt=kt-(At<3?1:0),jt=ie(Nt/100),Ut=Nt-100*jt,Lt=(xt+ie(2.6*Bt-.2)+(Ut+ie(Ut/4))+(ie(jt/4)-2*jt))%7;return Lt+(Lt<=0?7:0)}function DayOfYear(kt,At,xt){let Bt=xt;for(let Nt=At-1;Nt>0;Nt--)Bt+=ISODaysInMonth(kt,Nt);return Bt}function WeekOfYear(kt,At,xt){const Bt=DayOfYear(kt,At,xt),Nt=DayOfWeek(kt,At,xt)||7,jt=DayOfWeek(kt,1,1),Ut=ie((Bt-Nt+10)/7);return Ut<1?jt===5||jt===6&&LeapYear(kt-1)?{week:53,year:kt-1}:{week:52,year:kt-1}:Ut===53&&(LeapYear(kt)?366:365)-Bt<4-Nt?{week:1,year:kt+1}:{week:Ut,year:kt}}function DurationSign(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt){for(const zt of[kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt])if(zt!==0)return zt<0?-1:1;return 0}function BalanceISOYearMonth(kt,At){let xt=kt,Bt=At;if(!me(xt)||!me(Bt))throw new RangeError("infinity is out of range");return Bt-=1,xt+=ie(Bt/12),Bt%=12,Bt<0&&(Bt+=12),Bt+=1,{year:xt,month:Bt}}function BalanceISODate(kt,At,xt){let Bt=kt,Nt=At,jt=xt;if(!me(jt))throw new RangeError("infinity is out of range");({year:Bt,month:Nt}=BalanceISOYearMonth(Bt,Nt));const Ut=146097;if(ae(jt)>Ut){const Vt=le(jt/Ut);Bt+=400*Vt,jt-=Vt*Ut}let Lt=0,Ht=Nt>2?Bt:Bt-1;for(;Lt=LeapYear(Ht)?366:365,jt<-Lt;)Bt-=1,Ht-=1,jt+=Lt;for(Ht+=1;Lt=LeapYear(Ht)?366:365,jt>Lt;)Bt+=1,Ht+=1,jt-=Lt;for(;jt<1;)({year:Bt,month:Nt}=BalanceISOYearMonth(Bt,Nt-1)),jt+=ISODaysInMonth(Bt,Nt);for(;jt>ISODaysInMonth(Bt,Nt);)jt-=ISODaysInMonth(Bt,Nt),{year:Bt,month:Nt}=BalanceISOYearMonth(Bt,Nt+1);return{year:Bt,month:Nt,day:jt}}function BalanceISODateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht){const{deltaDays:Vt,hour:zt,minute:Wt,second:Jt,millisecond:Qt,microsecond:Xt,nanosecond:tr}=BalanceTime(Bt,Nt,jt,Ut,Lt,Ht),{year:rr,month:nr,day:ar}=BalanceISODate(kt,At,xt+Vt);return{year:rr,month:nr,day:ar,hour:zt,minute:Wt,second:Jt,millisecond:Qt,microsecond:Xt,nanosecond:tr}}function BalanceTime(kt,At,xt,Bt,Nt,jt){let Ut,Lt=JSBI.BigInt(kt),Ht=JSBI.BigInt(At),Vt=JSBI.BigInt(xt),zt=JSBI.BigInt(Bt),Wt=JSBI.BigInt(Nt),Jt=JSBI.BigInt(jt);return{quotient:Ut,remainder:Jt}=NonNegativeBigIntDivmod(Jt,De),Wt=JSBI.add(Wt,Ut),{quotient:Ut,remainder:Wt}=NonNegativeBigIntDivmod(Wt,De),zt=JSBI.add(zt,Ut),{quotient:Ut,remainder:zt}=NonNegativeBigIntDivmod(zt,De),Vt=JSBI.add(Vt,Ut),{quotient:Ut,remainder:Vt}=NonNegativeBigIntDivmod(Vt,ge),Ht=JSBI.add(Ht,Ut),{quotient:Ut,remainder:Ht}=NonNegativeBigIntDivmod(Ht,ge),Lt=JSBI.add(Lt,Ut),{quotient:Ut,remainder:Lt}=NonNegativeBigIntDivmod(Lt,we),{deltaDays:JSBI.toNumber(Ut),hour:JSBI.toNumber(Lt),minute:JSBI.toNumber(Ht),second:JSBI.toNumber(Vt),millisecond:JSBI.toNumber(zt),microsecond:JSBI.toNumber(Wt),nanosecond:JSBI.toNumber(Jt)}}function TotalDurationNanoseconds(kt,At,xt,Bt,Nt,jt,Ut,Lt){const Ht=JSBI.BigInt(kt);let Vt=JSBI.BigInt(Ut);kt!==0&&(Vt=JSBI.subtract(JSBI.BigInt(Ut),JSBI.BigInt(Lt)));const zt=JSBI.add(JSBI.BigInt(At),JSBI.multiply(Ht,JSBI.BigInt(24))),Wt=JSBI.add(JSBI.BigInt(xt),JSBI.multiply(zt,ge)),Jt=JSBI.add(JSBI.BigInt(Bt),JSBI.multiply(Wt,ge)),Qt=JSBI.add(JSBI.BigInt(Nt),JSBI.multiply(Jt,De)),Xt=JSBI.add(JSBI.BigInt(jt),JSBI.multiply(Qt,De));return JSBI.add(JSBI.BigInt(Vt),JSBI.multiply(Xt,De))}function NanosecondsToDays(kt,At){const xt=GetIntrinsic("%Temporal.Instant%"),Bt=se(JSBI.toNumber(kt));let Nt=JSBI.BigInt(kt),jt=864e11;if(Bt===0)return{days:0,nanoseconds:Ie,dayLengthNs:jt};if(!IsTemporalZonedDateTime(At)){let ir;return{quotient:ir,remainder:Nt}=divmod(Nt,JSBI.BigInt(jt)),{days:JSBI.toNumber(ir),nanoseconds:Nt,dayLengthNs:jt}}const Ut=GetSlot(At,n),Lt=GetSlot(At,S),Ht=JSBI.add(Ut,Nt),Vt=new xt(Ht),zt=GetSlot(At,g),Wt=GetSlot(At,p),Jt=GetPlainDateTimeFor(zt,Lt,Wt),Qt=GetPlainDateTimeFor(zt,Vt,Wt);let{days:Xt}=DifferenceISODateTime(GetSlot(Jt,i$3),GetSlot(Jt,s$2),GetSlot(Jt,l),GetSlot(Jt,d$1),GetSlot(Jt,m$1),GetSlot(Jt,c),GetSlot(Jt,h$1),GetSlot(Jt,u),GetSlot(Jt,T),GetSlot(Qt,i$3),GetSlot(Qt,s$2),GetSlot(Qt,l),GetSlot(Qt,d$1),GetSlot(Qt,m$1),GetSlot(Qt,c),GetSlot(Qt,h$1),GetSlot(Qt,u),GetSlot(Qt,T),Wt,"day",Te(null)),tr=AddZonedDateTime(Lt,zt,Wt,0,0,0,Xt,0,0,0,0,0,0),rr=JSBI.BigInt(Xt);if(Bt===1)for(;JSBI.greaterThan(rr,Ie)&&JSBI.greaterThan(tr,Ht);)rr=JSBI.subtract(rr,Se),tr=AddZonedDateTime(Lt,zt,Wt,0,0,0,JSBI.toNumber(rr),0,0,0,0,0,0);Nt=JSBI.subtract(Ht,tr);let nr=!1,ar=new xt(tr);do{const ir=AddZonedDateTime(ar,zt,Wt,0,0,0,Bt,0,0,0,0,0,0),lr=GetSlot(ar,n);jt=JSBI.toNumber(JSBI.subtract(ir,lr)),nr=JSBI.greaterThanOrEqual(JSBI.multiply(JSBI.subtract(Nt,JSBI.BigInt(jt)),JSBI.BigInt(Bt)),Ie),nr&&(Nt=JSBI.subtract(Nt,JSBI.BigInt(jt)),ar=new xt(ir),rr=JSBI.add(rr,JSBI.BigInt(Bt)))}while(nr);if(!isZero(rr)&&signJSBI(rr)!==Bt)throw new RangeError("Time zone or calendar converted nanoseconds into a number of days with the opposite sign");if(!isZero(Nt)&&signJSBI(Nt)!==Bt)throw isNegativeJSBI(Nt)&&Bt===1?new Error("assert not reached"):new RangeError("Time zone or calendar ended up with a remainder of nanoseconds with the opposite sign");if(JSBI.greaterThanOrEqual(abs(Nt),abs(JSBI.BigInt(jt))))throw new Error("assert not reached");return{days:JSBI.toNumber(rr),nanoseconds:Nt,dayLengthNs:ae(jt)}}function BalanceDuration(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht){let Vt=BalancePossiblyInfiniteDuration(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht);if(Vt==="positive overflow"||Vt==="negative overflow")throw new RangeError("Duration out of range");return Vt}function BalancePossiblyInfiniteDuration(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht){let Vt,zt,Wt,Jt,Qt,Xt,tr=kt;if(IsTemporalZonedDateTime(Ht)){const Ar=AddZonedDateTime(GetSlot(Ht,S),GetSlot(Ht,g),GetSlot(Ht,p),0,0,0,tr,At,xt,Bt,Nt,jt,Ut),Dr=GetSlot(Ht,n);Vt=JSBI.subtract(Ar,Dr)}else Vt=TotalDurationNanoseconds(tr,At,xt,Bt,Nt,jt,Ut,0);Lt==="year"||Lt==="month"||Lt==="week"||Lt==="day"?{days:tr,nanoseconds:Vt}=NanosecondsToDays(Vt,Ht):tr=0;const rr=JSBI.lessThan(Vt,Ie)?-1:1;switch(Vt=abs(Vt),zt=Wt=Jt=Qt=Xt=Ie,Lt){case"year":case"month":case"week":case"day":case"hour":({quotient:zt,remainder:Vt}=divmod(Vt,De)),{quotient:Wt,remainder:zt}=divmod(zt,De),{quotient:Jt,remainder:Wt}=divmod(Wt,De),{quotient:Qt,remainder:Jt}=divmod(Jt,ge),{quotient:Xt,remainder:Qt}=divmod(Qt,ge);break;case"minute":({quotient:zt,remainder:Vt}=divmod(Vt,De)),{quotient:Wt,remainder:zt}=divmod(zt,De),{quotient:Jt,remainder:Wt}=divmod(Wt,De),{quotient:Qt,remainder:Jt}=divmod(Jt,ge);break;case"second":({quotient:zt,remainder:Vt}=divmod(Vt,De)),{quotient:Wt,remainder:zt}=divmod(zt,De),{quotient:Jt,remainder:Wt}=divmod(Wt,De);break;case"millisecond":({quotient:zt,remainder:Vt}=divmod(Vt,De)),{quotient:Wt,remainder:zt}=divmod(zt,De);break;case"microsecond":({quotient:zt,remainder:Vt}=divmod(Vt,De));break;case"nanosecond":break;default:throw new Error("assert not reached")}const nr=JSBI.toNumber(Xt)*rr,ar=JSBI.toNumber(Qt)*rr,ir=JSBI.toNumber(Jt)*rr,lr=JSBI.toNumber(Wt)*rr,yr=JSBI.toNumber(zt)*rr,Sr=JSBI.toNumber(Vt)*rr;for(const Ar of[tr,nr,ar,ir,lr,yr,Sr])if(!me(Ar))return rr===1?"positive overflow":"negative overflow";return{days:tr,hours:nr,minutes:ar,seconds:ir,milliseconds:lr,microseconds:yr,nanoseconds:Sr}}function UnbalanceDurationRelative(kt,At,xt,Bt,Nt,jt){const Ut=GetIntrinsic("%Temporal.Duration%"),Lt=DurationSign(kt,At,xt,Bt,0,0,0,0,0,0);if(Lt===0)return{years:kt,months:At,weeks:xt,days:Bt};const Ht=JSBI.BigInt(Lt);let Vt,zt,Wt=JSBI.BigInt(kt),Jt=JSBI.BigInt(At),Qt=JSBI.BigInt(xt),Xt=JSBI.BigInt(Bt);jt&&(zt=ToTemporalDate(jt),Vt=GetSlot(zt,p));const tr=new Ut(Lt),rr=new Ut(0,Lt),nr=new Ut(0,0,Lt);switch(Nt){case"year":break;case"month":{if(!Vt)throw new RangeError("a starting point is required for months balancing");let ar,ir;for(typeof Vt!="string"&&(ar=GetMethod(Vt,"dateAdd"),ir=GetMethod(Vt,"dateUntil"));!isZero(Wt);){const lr=CalendarDateAdd(Vt,zt,tr,void 0,ar),yr=Te(null);yr.largestUnit="month";const Sr=CalendarDateUntil(Vt,zt,lr,yr,ir),Ar=JSBI.BigInt(GetSlot(Sr,D));zt=lr,Jt=JSBI.add(Jt,Ar),Wt=JSBI.subtract(Wt,Ht)}}break;case"week":{if(!Vt)throw new RangeError("a starting point is required for weeks balancing");const ar=typeof Vt!="string"?GetMethod(Vt,"dateAdd"):void 0;for(;!isZero(Wt);){let ir;({relativeTo:zt,days:ir}=MoveRelativeDate(Vt,zt,tr,ar)),Xt=JSBI.add(Xt,JSBI.BigInt(ir)),Wt=JSBI.subtract(Wt,Ht)}for(;!isZero(Jt);){let ir;({relativeTo:zt,days:ir}=MoveRelativeDate(Vt,zt,rr,ar)),Xt=JSBI.add(Xt,JSBI.BigInt(ir)),Jt=JSBI.subtract(Jt,Ht)}break}default:{if(isZero(Wt)&&isZero(Jt)&&isZero(Qt))break;if(!Vt)throw new RangeError("a starting point is required for balancing calendar units");const ar=typeof Vt!="string"?GetMethod(Vt,"dateAdd"):void 0;for(;!isZero(Wt);){let ir;({relativeTo:zt,days:ir}=MoveRelativeDate(Vt,zt,tr,ar)),Xt=JSBI.add(Xt,JSBI.BigInt(ir)),Wt=JSBI.subtract(Wt,Ht)}for(;!isZero(Jt);){let ir;({relativeTo:zt,days:ir}=MoveRelativeDate(Vt,zt,rr,ar)),Xt=JSBI.add(Xt,JSBI.BigInt(ir)),Jt=JSBI.subtract(Jt,Ht)}for(;!isZero(Qt);){let ir;({relativeTo:zt,days:ir}=MoveRelativeDate(Vt,zt,nr,ar)),Xt=JSBI.add(Xt,JSBI.BigInt(ir)),Qt=JSBI.subtract(Qt,Ht)}break}}return{years:JSBI.toNumber(Wt),months:JSBI.toNumber(Jt),weeks:JSBI.toNumber(Qt),days:JSBI.toNumber(Xt)}}function CalculateOffsetShift(kt,At,xt,Bt,Nt){if(IsTemporalZonedDateTime(kt)){const jt=GetSlot(kt,S),Ut=GetSlot(kt,g),Lt=GetSlot(kt,p),Ht=GetOffsetNanosecondsFor(Ut,jt),Vt=AddZonedDateTime(jt,Ut,Lt,At,xt,Bt,Nt,0,0,0,0,0,0);return GetOffsetNanosecondsFor(Ut,new(GetIntrinsic("%Temporal.Instant%"))(Vt))-Ht}return 0}function CreateNegatedTemporalDuration(kt){return new(GetIntrinsic("%Temporal.Duration%"))(-GetSlot(kt,w$1),-GetSlot(kt,D),-GetSlot(kt,G),-GetSlot(kt,v),-GetSlot(kt,C),-GetSlot(kt,O),-GetSlot(kt,b),-GetSlot(kt,E$1),-GetSlot(kt,M),-GetSlot(kt,R))}function ConstrainToRange(kt,At,xt){return oe(xt,ne(At,kt))}function ConstrainISODate(kt,At,xt){const Bt=ConstrainToRange(At,1,12);return{year:kt,month:Bt,day:ConstrainToRange(xt,1,ISODaysInMonth(kt,Bt))}}function RejectToRange(kt,At,xt){if(kt<At||kt>xt)throw new RangeError(`value out of range: ${At} <= ${kt} <= ${xt}`)}function RejectISODate(kt,At,xt){RejectToRange(At,1,12),RejectToRange(xt,1,ISODaysInMonth(kt,At))}function RejectDateRange(kt,At,xt){RejectDateTimeRange(kt,At,xt,12,0,0,0,0,0)}function RejectTime(kt,At,xt,Bt,Nt,jt){RejectToRange(kt,0,23),RejectToRange(At,0,59),RejectToRange(xt,0,59),RejectToRange(Bt,0,999),RejectToRange(Nt,0,999),RejectToRange(jt,0,999)}function RejectDateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht){RejectISODate(kt,At,xt),RejectTime(Bt,Nt,jt,Ut,Lt,Ht)}function RejectDateTimeRange(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht){if(RejectToRange(kt,Fe,Ye),kt===Fe&&GetUTCEpochNanoseconds(kt,At,xt+1,Bt,Nt,jt,Ut,Lt,Ht-1)==null||kt===Ye&&GetUTCEpochNanoseconds(kt,At,xt-1,Bt,Nt,jt,Ut,Lt,Ht+1)==null)throw new RangeError("DateTime outside of supported range")}function ValidateEpochNanoseconds(kt){if(JSBI.lessThan(kt,Me)||JSBI.greaterThan(kt,Re))throw new RangeError("Instant outside of supported range")}function RejectDuration(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt){const zt=DurationSign(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt);for(const Wt of[kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt]){if(!me(Wt))throw new RangeError("infinite values not allowed as duration fields");const Jt=se(Wt);if(Jt!==0&&Jt!==zt)throw new RangeError("mixed-sign values not allowed as duration fields")}}function DifferenceISODate(kt,At,xt,Bt,Nt,jt,Ut){switch(Ut){case"year":case"month":{const Lt=-CompareISODate(kt,At,xt,Bt,Nt,jt);if(Lt===0)return{years:0,months:0,weeks:0,days:0};const Ht={year:kt,month:At,day:xt},Vt={year:Bt,month:Nt,day:jt};let zt=Vt.year-Ht.year,Wt=AddISODate(kt,At,xt,zt,0,0,0,"constrain"),Jt=-CompareISODate(Wt.year,Wt.month,Wt.day,Bt,Nt,jt);if(Jt===0)return Ut==="year"?{years:zt,months:0,weeks:0,days:0}:{years:0,months:12*zt,weeks:0,days:0};let Qt=Vt.month-Ht.month;if(Jt!==Lt&&(zt-=Lt,Qt+=12*Lt),Wt=AddISODate(kt,At,xt,zt,Qt,0,0,"constrain"),Jt=-CompareISODate(Wt.year,Wt.month,Wt.day,Bt,Nt,jt),Jt===0)return Ut==="year"?{years:zt,months:Qt,weeks:0,days:0}:{years:0,months:Qt+12*zt,weeks:0,days:0};Jt!==Lt&&(Qt-=Lt,Qt===-Lt&&(zt-=Lt,Qt=11*Lt),Wt=AddISODate(kt,At,xt,zt,Qt,0,0,"constrain"));let Xt=0;return Xt=Wt.month===Vt.month?Vt.day-Wt.day:Lt<0?-Wt.day-(ISODaysInMonth(Vt.year,Vt.month)-Vt.day):Vt.day+(ISODaysInMonth(Wt.year,Wt.month)-Wt.day),Ut==="month"&&(Qt+=12*zt,zt=0),{years:zt,months:Qt,weeks:0,days:Xt}}case"week":case"day":{let Lt,Ht,Vt;CompareISODate(kt,At,xt,Bt,Nt,jt)<0?(Ht={year:kt,month:At,day:xt},Lt={year:Bt,month:Nt,day:jt},Vt=1):(Ht={year:Bt,month:Nt,day:jt},Lt={year:kt,month:At,day:xt},Vt=-1);let zt=DayOfYear(Lt.year,Lt.month,Lt.day)-DayOfYear(Ht.year,Ht.month,Ht.day);for(let Jt=Ht.year;Jt<Lt.year;++Jt)zt+=LeapYear(Jt)?366:365;let Wt=0;return Ut==="week"&&(Wt=ie(zt/7),zt%=7),Wt*=Vt,zt*=Vt,{years:0,months:0,weeks:Wt,days:zt}}default:throw new Error("assert not reached")}}function DifferenceTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt){let Jt=Ut-kt,Qt=Lt-At,Xt=Ht-xt,tr=Vt-Bt,rr=zt-Nt,nr=Wt-jt;const ar=DurationSign(0,0,0,0,Jt,Qt,Xt,tr,rr,nr);Jt*=ar,Qt*=ar,Xt*=ar,tr*=ar,rr*=ar,nr*=ar;let ir=0;if({deltaDays:ir,hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr}=BalanceTime(Jt,Qt,Xt,tr,rr,nr),ir!=0)throw new Error("assertion failure in DifferenceTime: _bt_.[[Days]] should be 0");return Jt*=ar,Qt*=ar,Xt*=ar,tr*=ar,rr*=ar,nr*=ar,{hours:Jt,minutes:Qt,seconds:Xt,milliseconds:tr,microseconds:rr,nanoseconds:nr}}function DifferenceInstant(kt,At,xt,Bt,Nt,jt){const Ut=JSBI.subtract(At,kt);let Lt=0,Ht=0,Vt=JSBI.toNumber(JSBI.remainder(Ut,De)),zt=JSBI.toNumber(JSBI.remainder(JSBI.divide(Ut,De),De)),Wt=JSBI.toNumber(JSBI.remainder(JSBI.divide(Ut,Ge),De)),Jt=JSBI.toNumber(JSBI.divide(Ut,ve));return{hours:Lt,minutes:Ht,seconds:Jt,milliseconds:Wt,microseconds:zt,nanoseconds:Vt}=RoundDuration(0,0,0,0,0,0,Jt,Wt,zt,Vt,xt,Bt,jt),BalanceDuration(0,Lt,Ht,Jt,Wt,zt,Vt,Nt)}function DifferenceISODateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr){let yr=kt,Sr=At,Ar=xt,{hours:Dr,minutes:Br,seconds:Lr,milliseconds:Or,microseconds:vr,nanoseconds:pr}=DifferenceTime(Bt,Nt,jt,Ut,Lt,Ht,Jt,Qt,Xt,tr,rr,nr);const dr=DurationSign(0,0,0,0,Dr,Br,Lr,Or,vr,pr);CompareISODate(Vt,zt,Wt,yr,Sr,Ar)===-dr&&({year:yr,month:Sr,day:Ar}=BalanceISODate(yr,Sr,Ar-dr),{hours:Dr,minutes:Br,seconds:Lr,milliseconds:Or,microseconds:vr,nanoseconds:pr}=BalanceDuration(-dr,Dr,Br,Lr,Or,vr,pr,ir));const ur=CreateTemporalDate(yr,Sr,Ar,ar),$r=CreateTemporalDate(Vt,zt,Wt,ar),wr=LargerOfTwoTemporalUnits("day",ir),Er=CopyOptions(lr);Er.largestUnit=wr;let{years:gr,months:fr,weeks:br,days:_r}=CalendarDateUntil(ar,ur,$r,Er);return{days:_r,hours:Dr,minutes:Br,seconds:Lr,milliseconds:Or,microseconds:vr,nanoseconds:pr}=BalanceDuration(_r,Dr,Br,Lr,Or,vr,pr,ir),{years:gr,months:fr,weeks:br,days:_r,hours:Dr,minutes:Br,seconds:Lr,milliseconds:Or,microseconds:vr,nanoseconds:pr}}function DifferenceZonedDateTime(kt,At,xt,Bt,Nt,jt){const Ut=JSBI.subtract(At,kt);if(JSBI.equal(Ut,Ie))return{years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};const Lt=GetIntrinsic("%Temporal.Instant%"),Ht=new Lt(kt),Vt=new Lt(At),zt=GetPlainDateTimeFor(xt,Ht,Bt),Wt=GetPlainDateTimeFor(xt,Vt,Bt);let{years:Jt,months:Qt,weeks:Xt,days:tr}=DifferenceISODateTime(GetSlot(zt,i$3),GetSlot(zt,s$2),GetSlot(zt,l),GetSlot(zt,d$1),GetSlot(zt,m$1),GetSlot(zt,c),GetSlot(zt,h$1),GetSlot(zt,u),GetSlot(zt,T),GetSlot(Wt,i$3),GetSlot(Wt,s$2),GetSlot(Wt,l),GetSlot(Wt,d$1),GetSlot(Wt,m$1),GetSlot(Wt,c),GetSlot(Wt,h$1),GetSlot(Wt,u),GetSlot(Wt,T),Bt,Nt,jt);const rr=AddZonedDateTime(Ht,xt,Bt,Jt,Qt,Xt,0,0,0,0,0,0,0);let nr=JSBI.subtract(At,rr);const ar=CreateTemporalZonedDateTime(rr,xt,Bt);({nanoseconds:nr,days:tr}=NanosecondsToDays(nr,ar));const{hours:ir,minutes:lr,seconds:yr,milliseconds:Sr,microseconds:Ar,nanoseconds:Dr}=BalanceDuration(0,0,0,0,0,0,JSBI.toNumber(nr),"hour");return{years:Jt,months:Qt,weeks:Xt,days:tr,hours:ir,minutes:lr,seconds:yr,milliseconds:Sr,microseconds:Ar,nanoseconds:Dr}}function GetDifferenceSettings(kt,At,xt,Bt,Nt,jt){const Ut=Ue.reduce((Qt,Xt)=>{const tr=Xt[0],rr=Xt[1],nr=Xt[2];return xt!=="datetime"&&nr!==xt||Bt.includes(rr)||Qt.push(rr,tr),Qt},[]);let Lt=GetTemporalUnit(At,"largestUnit",xt,"auto");if(Bt.includes(Lt))throw new RangeError(`largestUnit must be one of ${Ut.join(", ")}, not ${Lt}`);const Ht=ToTemporalRoundingIncrement(At);let Vt=ToTemporalRoundingMode(At,"trunc");kt==="since"&&(Vt=function(Xt){switch(Xt){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return Xt}}(Vt));const zt=GetTemporalUnit(At,"smallestUnit",xt,Nt);if(Bt.includes(zt))throw new RangeError(`smallestUnit must be one of ${Ut.join(", ")}, not ${zt}`);const Wt=LargerOfTwoTemporalUnits(jt,zt);if(Lt==="auto"&&(Lt=Wt),LargerOfTwoTemporalUnits(Lt,zt)!==Lt)throw new RangeError(`largestUnit ${Lt} cannot be smaller than smallestUnit ${zt}`);const Jt={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[zt];return Jt!==void 0&&ValidateTemporalRoundingIncrement(Ht,Jt,!1),{largestUnit:Lt,roundingIncrement:Ht,roundingMode:Vt,smallestUnit:zt}}function DifferenceTemporalInstant(kt,At,xt,Bt){const Nt=kt==="since"?-1:1,jt=ToTemporalInstant(xt),Ut=GetDifferenceSettings(kt,CopyOptions(Bt),"time",[],"nanosecond","second"),Lt=GetSlot(At,n),Ht=GetSlot(jt,n);let{hours:Vt,minutes:zt,seconds:Wt,milliseconds:Jt,microseconds:Qt,nanoseconds:Xt}=DifferenceInstant(Lt,Ht,Ut.roundingIncrement,Ut.smallestUnit,Ut.largestUnit,Ut.roundingMode);return new(GetIntrinsic("%Temporal.Duration%"))(0,0,0,0,Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt,Nt*Qt,Nt*Xt)}function DifferenceTemporalPlainDate(kt,At,xt,Bt){const Nt=kt==="since"?-1:1,jt=ToTemporalDate(xt),Ut=GetSlot(At,p);ThrowIfCalendarsNotEqual(Ut,GetSlot(jt,p),"compute difference between dates");const Lt=CopyOptions(Bt),Ht=GetDifferenceSettings(kt,Lt,"date",[],"day","day");Lt.largestUnit=Ht.largestUnit;let{years:Vt,months:zt,weeks:Wt,days:Jt}=CalendarDateUntil(Ut,At,jt,Lt);return Ht.smallestUnit==="day"&&Ht.roundingIncrement===1||({years:Vt,months:zt,weeks:Wt,days:Jt}=RoundDuration(Vt,zt,Wt,Jt,0,0,0,0,0,0,Ht.roundingIncrement,Ht.smallestUnit,Ht.roundingMode,At)),new(GetIntrinsic("%Temporal.Duration%"))(Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt,0,0,0,0,0,0)}function DifferenceTemporalPlainDateTime(kt,At,xt,Bt){const Nt=kt==="since"?-1:1,jt=ToTemporalDateTime(xt),Ut=GetSlot(At,p);ThrowIfCalendarsNotEqual(Ut,GetSlot(jt,p),"compute difference between dates");const Lt=CopyOptions(Bt),Ht=GetDifferenceSettings(kt,Lt,"datetime",[],"nanosecond","day");let{years:Vt,months:zt,weeks:Wt,days:Jt,hours:Qt,minutes:Xt,seconds:tr,milliseconds:rr,microseconds:nr,nanoseconds:ar}=DifferenceISODateTime(GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),GetSlot(At,d$1),GetSlot(At,m$1),GetSlot(At,c),GetSlot(At,h$1),GetSlot(At,u),GetSlot(At,T),GetSlot(jt,i$3),GetSlot(jt,s$2),GetSlot(jt,l),GetSlot(jt,d$1),GetSlot(jt,m$1),GetSlot(jt,c),GetSlot(jt,h$1),GetSlot(jt,u),GetSlot(jt,T),Ut,Ht.largestUnit,Lt);const ir=TemporalDateTimeToDate(At);return{years:Vt,months:zt,weeks:Wt,days:Jt,hours:Qt,minutes:Xt,seconds:tr,milliseconds:rr,microseconds:nr,nanoseconds:ar}=RoundDuration(Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,Ht.roundingIncrement,Ht.smallestUnit,Ht.roundingMode,ir),{days:Jt,hours:Qt,minutes:Xt,seconds:tr,milliseconds:rr,microseconds:nr,nanoseconds:ar}=BalanceDuration(Jt,Qt,Xt,tr,rr,nr,ar,Ht.largestUnit),new(GetIntrinsic("%Temporal.Duration%"))(Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt,Nt*Qt,Nt*Xt,Nt*tr,Nt*rr,Nt*nr,Nt*ar)}function DifferenceTemporalPlainTime(kt,At,xt,Bt){const Nt=kt==="since"?-1:1,jt=ToTemporalTime(xt),Ut=GetDifferenceSettings(kt,CopyOptions(Bt),"time",[],"nanosecond","hour");let{hours:Lt,minutes:Ht,seconds:Vt,milliseconds:zt,microseconds:Wt,nanoseconds:Jt}=DifferenceTime(GetSlot(At,d$1),GetSlot(At,m$1),GetSlot(At,c),GetSlot(At,h$1),GetSlot(At,u),GetSlot(At,T),GetSlot(jt,d$1),GetSlot(jt,m$1),GetSlot(jt,c),GetSlot(jt,h$1),GetSlot(jt,u),GetSlot(jt,T));return{hours:Lt,minutes:Ht,seconds:Vt,milliseconds:zt,microseconds:Wt,nanoseconds:Jt}=RoundDuration(0,0,0,0,Lt,Ht,Vt,zt,Wt,Jt,Ut.roundingIncrement,Ut.smallestUnit,Ut.roundingMode),{hours:Lt,minutes:Ht,seconds:Vt,milliseconds:zt,microseconds:Wt,nanoseconds:Jt}=BalanceDuration(0,Lt,Ht,Vt,zt,Wt,Jt,Ut.largestUnit),new(GetIntrinsic("%Temporal.Duration%"))(0,0,0,0,Nt*Lt,Nt*Ht,Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt)}function DifferenceTemporalPlainYearMonth(kt,At,xt,Bt){const Nt=kt==="since"?-1:1,jt=ToTemporalYearMonth(xt),Ut=GetSlot(At,p);ThrowIfCalendarsNotEqual(Ut,GetSlot(jt,p),"compute difference between months");const Lt=CopyOptions(Bt),Ht=GetDifferenceSettings(kt,Lt,"date",["week","day"],"month","year");Lt.largestUnit=Ht.largestUnit;const Vt=CalendarFields(Ut,["monthCode","year"]),zt=PrepareTemporalFields(At,Vt,[]);zt.day=1;const Wt=CalendarDateFromFields(Ut,zt),Jt=PrepareTemporalFields(jt,Vt,[]);Jt.day=1;const Qt=CalendarDateFromFields(Ut,Jt);let{years:Xt,months:tr}=CalendarDateUntil(Ut,Wt,Qt,Lt);return Ht.smallestUnit==="month"&&Ht.roundingIncrement===1||({years:Xt,months:tr}=RoundDuration(Xt,tr,0,0,0,0,0,0,0,0,Ht.roundingIncrement,Ht.smallestUnit,Ht.roundingMode,Wt)),new(GetIntrinsic("%Temporal.Duration%"))(Nt*Xt,Nt*tr,0,0,0,0,0,0,0,0)}function DifferenceTemporalZonedDateTime(kt,At,xt,Bt){const Nt=kt==="since"?-1:1,jt=ToTemporalZonedDateTime(xt),Ut=GetSlot(At,p);ThrowIfCalendarsNotEqual(Ut,GetSlot(jt,p),"compute difference between dates");const Lt=CopyOptions(Bt),Ht=GetDifferenceSettings(kt,Lt,"datetime",[],"nanosecond","hour");Lt.largestUnit=Ht.largestUnit;const Vt=GetSlot(At,n),zt=GetSlot(jt,n);let Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr;if(Ht.largestUnit!=="year"&&Ht.largestUnit!=="month"&&Ht.largestUnit!=="week"&&Ht.largestUnit!=="day")Wt=0,Jt=0,Qt=0,Xt=0,{hours:tr,minutes:rr,seconds:nr,milliseconds:ar,microseconds:ir,nanoseconds:lr}=DifferenceInstant(Vt,zt,Ht.roundingIncrement,Ht.smallestUnit,Ht.largestUnit,Ht.roundingMode);else{const yr=GetSlot(At,g);if(!TimeZoneEquals(yr,GetSlot(jt,g)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");({years:Wt,months:Jt,weeks:Qt,days:Xt,hours:tr,minutes:rr,seconds:nr,milliseconds:ar,microseconds:ir,nanoseconds:lr}=DifferenceZonedDateTime(Vt,zt,yr,Ut,Ht.largestUnit,Lt)),{years:Wt,months:Jt,weeks:Qt,days:Xt,hours:tr,minutes:rr,seconds:nr,milliseconds:ar,microseconds:ir,nanoseconds:lr}=RoundDuration(Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr,Ht.roundingIncrement,Ht.smallestUnit,Ht.roundingMode,At),{years:Wt,months:Jt,weeks:Qt,days:Xt,hours:tr,minutes:rr,seconds:nr,milliseconds:ar,microseconds:ir,nanoseconds:lr}=AdjustRoundedDurationDays(Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr,Ht.roundingIncrement,Ht.smallestUnit,Ht.roundingMode,At)}return new(GetIntrinsic("%Temporal.Duration%"))(Nt*Wt,Nt*Jt,Nt*Qt,Nt*Xt,Nt*tr,Nt*rr,Nt*nr,Nt*ar,Nt*ir,Nt*lr)}function AddISODate(kt,At,xt,Bt,Nt,jt,Ut,Lt){let Ht=kt,Vt=At,zt=xt,Wt=jt,Jt=Ut;return Ht+=Bt,Vt+=Nt,{year:Ht,month:Vt}=BalanceISOYearMonth(Ht,Vt),{year:Ht,month:Vt,day:zt}=RegulateISODate(Ht,Vt,zt,Lt),Jt+=7*Wt,zt+=Jt,{year:Ht,month:Vt,day:zt}=BalanceISODate(Ht,Vt,zt),{year:Ht,month:Vt,day:zt}}function AddTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt){let Jt=kt,Qt=At,Xt=xt,tr=Bt,rr=Nt,nr=jt;Jt+=Ut,Qt+=Lt,Xt+=Ht,tr+=Vt,rr+=zt,nr+=Wt;let ar=0;return{deltaDays:ar,hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr}=BalanceTime(Jt,Qt,Xt,tr,rr,nr),{deltaDays:ar,hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr}}function AddDuration(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr){const yr=LargerOfTwoTemporalUnits(DefaultTemporalLargestUnit(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt),DefaultTemporalLargestUnit(zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir));let Sr,Ar,Dr,Br,Lr,Or,vr,pr,dr,ur;if(lr)if(IsTemporalDate(lr)){const $r=GetIntrinsic("%Temporal.Duration%"),wr=GetSlot(lr,p),Er=new $r(kt,At,xt,Bt,0,0,0,0,0,0),gr=new $r(zt,Wt,Jt,Qt,0,0,0,0,0,0),fr=typeof wr!="string"?GetMethod(wr,"dateAdd"):void 0,br=CalendarDateAdd(wr,lr,Er,void 0,fr),_r=CalendarDateAdd(wr,br,gr,void 0,fr),Tr=LargerOfTwoTemporalUnits("day",yr),Pr=Te(null);Pr.largestUnit=Tr,{years:Sr,months:Ar,weeks:Dr,days:Br}=CalendarDateUntil(wr,lr,_r,Pr),{days:Br,hours:Lr,minutes:Or,seconds:vr,milliseconds:pr,microseconds:dr,nanoseconds:ur}=BalanceDuration(Br,JSBI.add(JSBI.BigInt(Nt),JSBI.BigInt(Xt)),JSBI.add(JSBI.BigInt(jt),JSBI.BigInt(tr)),JSBI.add(JSBI.BigInt(Ut),JSBI.BigInt(rr)),JSBI.add(JSBI.BigInt(Lt),JSBI.BigInt(nr)),JSBI.add(JSBI.BigInt(Ht),JSBI.BigInt(ar)),JSBI.add(JSBI.BigInt(Vt),JSBI.BigInt(ir)),yr)}else{const $r=GetIntrinsic("%Temporal.Instant%"),wr=GetSlot(lr,g),Er=GetSlot(lr,p),gr=AddZonedDateTime(GetSlot(lr,S),wr,Er,kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt),fr=AddZonedDateTime(new $r(gr),wr,Er,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir);yr!=="year"&&yr!=="month"&&yr!=="week"&&yr!=="day"?(Sr=0,Ar=0,Dr=0,Br=0,{hours:Lr,minutes:Or,seconds:vr,milliseconds:pr,microseconds:dr,nanoseconds:ur}=DifferenceInstant(GetSlot(lr,n),fr,1,"nanosecond",yr,"halfExpand")):{years:Sr,months:Ar,weeks:Dr,days:Br,hours:Lr,minutes:Or,seconds:vr,milliseconds:pr,microseconds:dr,nanoseconds:ur}=DifferenceZonedDateTime(GetSlot(lr,n),fr,wr,Er,yr,Te(null))}else{if(yr==="year"||yr==="month"||yr==="week")throw new RangeError("relativeTo is required for years, months, or weeks arithmetic");Sr=Ar=Dr=0,{days:Br,hours:Lr,minutes:Or,seconds:vr,milliseconds:pr,microseconds:dr,nanoseconds:ur}=BalanceDuration(Bt+Qt,JSBI.add(JSBI.BigInt(Nt),JSBI.BigInt(Xt)),JSBI.add(JSBI.BigInt(jt),JSBI.BigInt(tr)),JSBI.add(JSBI.BigInt(Ut),JSBI.BigInt(rr)),JSBI.add(JSBI.BigInt(Lt),JSBI.BigInt(nr)),JSBI.add(JSBI.BigInt(Ht),JSBI.BigInt(ar)),JSBI.add(JSBI.BigInt(Vt),JSBI.BigInt(ir)),yr)}return RejectDuration(Sr,Ar,Dr,Br,Lr,Or,vr,pr,dr,ur),{years:Sr,months:Ar,weeks:Dr,days:Br,hours:Lr,minutes:Or,seconds:vr,milliseconds:pr,microseconds:dr,nanoseconds:ur}}function AddInstant(kt,At,xt,Bt,Nt,jt,Ut){let Lt=Ie;Lt=JSBI.add(Lt,JSBI.BigInt(Ut)),Lt=JSBI.add(Lt,JSBI.multiply(JSBI.BigInt(jt),De)),Lt=JSBI.add(Lt,JSBI.multiply(JSBI.BigInt(Nt),Ge)),Lt=JSBI.add(Lt,JSBI.multiply(JSBI.BigInt(Bt),ve)),Lt=JSBI.add(Lt,JSBI.multiply(JSBI.BigInt(xt),JSBI.BigInt(6e10))),Lt=JSBI.add(Lt,JSBI.multiply(JSBI.BigInt(At),JSBI.BigInt(36e11)));const Ht=JSBI.add(kt,Lt);return ValidateEpochNanoseconds(Ht),Ht}function AddDateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr){let yr=Qt,{deltaDays:Sr,hour:Ar,minute:Dr,second:Br,millisecond:Lr,microsecond:Or,nanosecond:vr}=AddTime(Bt,Nt,jt,Ut,Lt,Ht,Xt,tr,rr,nr,ar,ir);yr+=Sr;const pr=GetIntrinsic("%Temporal.Duration%"),dr=CalendarDateAdd(Vt,CreateTemporalDate(kt,At,xt,Vt),new pr(zt,Wt,Jt,yr,0,0,0,0,0,0),lr);return{year:GetSlot(dr,i$3),month:GetSlot(dr,s$2),day:GetSlot(dr,l),hour:Ar,minute:Dr,second:Br,millisecond:Lr,microsecond:Or,nanosecond:vr}}function AddZonedDateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt){const Xt=GetIntrinsic("%Temporal.Duration%");if(DurationSign(Bt,Nt,jt,Ut,0,0,0,0,0,0)===0)return AddInstant(GetSlot(kt,n),Lt,Ht,Vt,zt,Wt,Jt);const tr=GetPlainDateTimeFor(At,kt,xt),rr=CalendarDateAdd(xt,CreateTemporalDate(GetSlot(tr,i$3),GetSlot(tr,s$2),GetSlot(tr,l),xt),new Xt(Bt,Nt,jt,Ut,0,0,0,0,0,0),Qt),nr=CreateTemporalDateTime(GetSlot(rr,i$3),GetSlot(rr,s$2),GetSlot(rr,l),GetSlot(tr,d$1),GetSlot(tr,m$1),GetSlot(tr,c),GetSlot(tr,h$1),GetSlot(tr,u),GetSlot(tr,T),xt);return AddInstant(GetSlot(GetInstantFor(At,nr,"compatible"),n),Lt,Ht,Vt,zt,Wt,Jt)}function AddDurationToOrSubtractDurationFromDuration(kt,At,xt,Bt){const Nt=kt==="subtract"?-1:1;let{years:jt,months:Ut,weeks:Lt,days:Ht,hours:Vt,minutes:zt,seconds:Wt,milliseconds:Jt,microseconds:Qt,nanoseconds:Xt}=ToTemporalDurationRecord(xt);const tr=ToRelativeTemporalObject(GetOptionsObject(Bt));return{years:jt,months:Ut,weeks:Lt,days:Ht,hours:Vt,minutes:zt,seconds:Wt,milliseconds:Jt,microseconds:Qt,nanoseconds:Xt}=AddDuration(GetSlot(At,w$1),GetSlot(At,D),GetSlot(At,G),GetSlot(At,v),GetSlot(At,C),GetSlot(At,O),GetSlot(At,b),GetSlot(At,E$1),GetSlot(At,M),GetSlot(At,R),Nt*jt,Nt*Ut,Nt*Lt,Nt*Ht,Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt,Nt*Qt,Nt*Xt,tr),new(GetIntrinsic("%Temporal.Duration%"))(jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt)}function AddDurationToOrSubtractDurationFromInstant(kt,At,xt){const Bt=kt==="subtract"?-1:1,{hours:Nt,minutes:jt,seconds:Ut,milliseconds:Lt,microseconds:Ht,nanoseconds:Vt}=function(Jt,Qt){let Xt=ToTemporalDurationRecord(Jt);for(const tr of Qt)if(Xt[tr]!==0)throw new RangeError(`Duration field ${tr} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);return Xt}(xt,["years","months","weeks","days"]),zt=AddInstant(GetSlot(At,n),Bt*Nt,Bt*jt,Bt*Ut,Bt*Lt,Bt*Ht,Bt*Vt);return new(GetIntrinsic("%Temporal.Instant%"))(zt)}function AddDurationToOrSubtractDurationFromPlainDateTime(kt,At,xt,Bt){const Nt=kt==="subtract"?-1:1,{years:jt,months:Ut,weeks:Lt,days:Ht,hours:Vt,minutes:zt,seconds:Wt,milliseconds:Jt,microseconds:Qt,nanoseconds:Xt}=ToTemporalDurationRecord(xt),tr=GetOptionsObject(Bt),rr=GetSlot(At,p),{year:nr,month:ar,day:ir,hour:lr,minute:yr,second:Sr,millisecond:Ar,microsecond:Dr,nanosecond:Br}=AddDateTime(GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),GetSlot(At,d$1),GetSlot(At,m$1),GetSlot(At,c),GetSlot(At,h$1),GetSlot(At,u),GetSlot(At,T),rr,Nt*jt,Nt*Ut,Nt*Lt,Nt*Ht,Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt,Nt*Qt,Nt*Xt,tr);return CreateTemporalDateTime(nr,ar,ir,lr,yr,Sr,Ar,Dr,Br,rr)}function AddDurationToOrSubtractDurationFromPlainTime(kt,At,xt){const Bt=kt==="subtract"?-1:1,{hours:Nt,minutes:jt,seconds:Ut,milliseconds:Lt,microseconds:Ht,nanoseconds:Vt}=ToTemporalDurationRecord(xt);let{hour:zt,minute:Wt,second:Jt,millisecond:Qt,microsecond:Xt,nanosecond:tr}=AddTime(GetSlot(At,d$1),GetSlot(At,m$1),GetSlot(At,c),GetSlot(At,h$1),GetSlot(At,u),GetSlot(At,T),Bt*Nt,Bt*jt,Bt*Ut,Bt*Lt,Bt*Ht,Bt*Vt);return{hour:zt,minute:Wt,second:Jt,millisecond:Qt,microsecond:Xt,nanosecond:tr}=RegulateTime(zt,Wt,Jt,Qt,Xt,tr,"reject"),new(GetIntrinsic("%Temporal.PlainTime%"))(zt,Wt,Jt,Qt,Xt,tr)}function AddDurationToOrSubtractDurationFromPlainYearMonth(kt,At,xt,Bt){let Nt=ToTemporalDurationRecord(xt);kt==="subtract"&&(Nt={years:-Nt.years,months:-Nt.months,weeks:-Nt.weeks,days:-Nt.days,hours:-Nt.hours,minutes:-Nt.minutes,seconds:-Nt.seconds,milliseconds:-Nt.milliseconds,microseconds:-Nt.microseconds,nanoseconds:-Nt.nanoseconds});let{years:jt,months:Ut,weeks:Lt,days:Ht,hours:Vt,minutes:zt,seconds:Wt,milliseconds:Jt,microseconds:Qt,nanoseconds:Xt}=Nt;({days:Ht}=BalanceDuration(Ht,Vt,zt,Wt,Jt,Qt,Xt,"day"));const tr=GetOptionsObject(Bt),rr=GetSlot(At,p),nr=CalendarFields(rr,["monthCode","year"]),ar=PrepareTemporalFields(At,nr,[]),ir=Te(null);CopyDataProperties(ir,ar,[]),ar.day=1;let lr=CalendarDateFromFields(rr,ar);const yr=DurationSign(jt,Ut,Lt,Ht,0,0,0,0,0,0),Sr=GetMethod(rr,"dateAdd"),Ar=GetIntrinsic("%Temporal.Duration%");if(yr<0){const Lr=CalendarDateAdd(rr,lr,new Ar(0,1,0,0,0,0,0,0,0,0),void 0,Sr),Or=CalendarDateAdd(rr,Lr,new Ar(0,0,0,-1,0,0,0,0,0,0),void 0,Sr);ir.day=CalendarDay(rr,Or),lr=CalendarDateFromFields(rr,ir)}const Dr=new Ar(jt,Ut,Lt,Ht,0,0,0,0,0,0),Br=CopyOptions(tr);return CalendarYearMonthFromFields(rr,PrepareTemporalFields(CalendarDateAdd(rr,lr,Dr,tr,Sr),nr,[]),Br)}function AddDurationToOrSubtractDurationFromZonedDateTime(kt,At,xt,Bt){const Nt=kt==="subtract"?-1:1,{years:jt,months:Ut,weeks:Lt,days:Ht,hours:Vt,minutes:zt,seconds:Wt,milliseconds:Jt,microseconds:Qt,nanoseconds:Xt}=ToTemporalDurationRecord(xt),tr=GetOptionsObject(Bt),rr=GetSlot(At,g),nr=GetSlot(At,p);return CreateTemporalZonedDateTime(AddZonedDateTime(GetSlot(At,S),rr,nr,Nt*jt,Nt*Ut,Nt*Lt,Nt*Ht,Nt*Vt,Nt*zt,Nt*Wt,Nt*Jt,Nt*Qt,Nt*Xt,tr),rr,nr)}function RoundNumberToIncrement(kt,At,xt){if(JSBI.equal(At,Se))return kt;let{quotient:Bt,remainder:Nt}=divmod(kt,At);if(JSBI.equal(Nt,Ie))return kt;const jt=JSBI.lessThan(Nt,Ie)?-1:1,Ut=abs(JSBI.multiply(Nt,JSBI.BigInt(2))),Lt=JSBI.equal(Ut,At),Ht=JSBI.greaterThan(Ut,At);switch(xt){case"ceil":jt>0&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)));break;case"floor":jt<0&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)));break;case"expand":Bt=JSBI.add(Bt,JSBI.BigInt(jt));break;case"trunc":break;case"halfCeil":(Ht||Lt&&jt>0)&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)));break;case"halfFloor":(Ht||Lt&&jt<0)&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)));break;case"halfExpand":(Ht||Lt)&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)));break;case"halfTrunc":Ht&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)));break;case"halfEven":(Ht||Lt&&JSBI.toNumber(JSBI.remainder(abs(Bt),JSBI.BigInt(2)))===1)&&(Bt=JSBI.add(Bt,JSBI.BigInt(jt)))}return JSBI.multiply(Bt,At)}function RoundInstant(kt,At,xt,Bt){let{remainder:Nt}=NonNegativeBigIntDivmod(kt,Ee);const jt=JSBI.subtract(kt,Nt),Ut=RoundNumberToIncrement(Nt,JSBI.BigInt(_e[xt]*At),Bt);return JSBI.add(jt,Ut)}function RoundISODateTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt=864e11){const{deltaDays:Qt,hour:Xt,minute:tr,second:rr,millisecond:nr,microsecond:ar,nanosecond:ir}=RoundTime(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt),{year:lr,month:yr,day:Sr}=BalanceISODate(kt,At,xt+Qt);return{year:lr,month:yr,day:Sr,hour:Xt,minute:tr,second:rr,millisecond:nr,microsecond:ar,nanosecond:ir}}function RoundTime(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt=864e11){let zt=Ie;switch(Lt){case"day":case"hour":zt=JSBI.BigInt(kt);case"minute":zt=JSBI.add(JSBI.multiply(zt,ge),JSBI.BigInt(At));case"second":zt=JSBI.add(JSBI.multiply(zt,ge),JSBI.BigInt(xt));case"millisecond":zt=JSBI.add(JSBI.multiply(zt,De),JSBI.BigInt(Bt));case"microsecond":zt=JSBI.add(JSBI.multiply(zt,De),JSBI.BigInt(Nt));case"nanosecond":zt=JSBI.add(JSBI.multiply(zt,De),JSBI.BigInt(jt))}const Wt=Lt==="day"?Vt:_e[Lt],Jt=RoundNumberToIncrement(zt,JSBI.BigInt(Wt*Ut),Ht),Qt=JSBI.toNumber(JSBI.divide(Jt,JSBI.BigInt(Wt)));switch(Lt){case"day":return{deltaDays:Qt,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return BalanceTime(Qt,0,0,0,0,0);case"minute":return BalanceTime(kt,Qt,0,0,0,0);case"second":return BalanceTime(kt,At,Qt,0,0,0);case"millisecond":return BalanceTime(kt,At,xt,Qt,0,0);case"microsecond":return BalanceTime(kt,At,xt,Bt,Qt,0);case"nanosecond":return BalanceTime(kt,At,xt,Bt,Nt,Qt);default:throw new Error(`Invalid unit ${Lt}`)}}function DaysUntil(kt,At){return DifferenceISODate(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l),GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),"day").days}function MoveRelativeDate(kt,At,xt,Bt){const Nt=CalendarDateAdd(kt,At,xt,void 0,Bt);return{relativeTo:Nt,days:DaysUntil(At,Nt)}}function MoveRelativeZonedDateTime(kt,At,xt,Bt,Nt){const jt=GetSlot(kt,g),Ut=GetSlot(kt,p);return CreateTemporalZonedDateTime(AddZonedDateTime(GetSlot(kt,S),jt,Ut,At,xt,Bt,Nt,0,0,0,0,0,0),jt,Ut)}function AdjustRoundedDurationDays(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt){let Xt=kt,tr=At,rr=xt,nr=Bt,ar=Nt,ir=jt,lr=Ut,yr=Lt,Sr=Ht,Ar=Vt;if(!IsTemporalZonedDateTime(Qt)||Wt==="year"||Wt==="month"||Wt==="week"||Wt==="day"||Wt==="nanosecond"&&zt===1)return{years:Xt,months:tr,weeks:rr,days:nr,hours:ar,minutes:ir,seconds:lr,milliseconds:yr,microseconds:Sr,nanoseconds:Ar};let Dr=TotalDurationNanoseconds(0,ar,ir,lr,yr,Sr,Ar,0);const Br=se(JSBI.toNumber(Dr)),Lr=GetSlot(Qt,g),Or=GetSlot(Qt,p),vr=AddZonedDateTime(GetSlot(Qt,S),Lr,Or,Xt,tr,rr,nr,0,0,0,0,0,0),pr=AddZonedDateTime(new(GetIntrinsic("%Temporal.Instant%"))(vr),Lr,Or,0,0,0,Br,0,0,0,0,0,0),dr=JSBI.subtract(pr,vr);return JSBI.greaterThanOrEqual(JSBI.multiply(JSBI.subtract(Dr,dr),JSBI.BigInt(Br)),Ie)&&({years:Xt,months:tr,weeks:rr,days:nr}=AddDuration(Xt,tr,rr,nr,0,0,0,0,0,0,0,0,0,Br,0,0,0,0,0,0,Qt),Dr=RoundInstant(JSBI.subtract(Dr,dr),zt,Wt,Jt),{hours:ar,minutes:ir,seconds:lr,milliseconds:yr,microseconds:Sr,nanoseconds:Ar}=BalanceDuration(0,0,0,0,0,0,JSBI.toNumber(Dr),"hour")),{years:Xt,months:tr,weeks:rr,days:nr,hours:ar,minutes:ir,seconds:lr,milliseconds:yr,microseconds:Sr,nanoseconds:Ar}}function RoundDuration(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt){let Xt=kt,tr=At,rr=xt,nr=Bt,ar=Nt,ir=jt,lr=Ut,yr=Lt,Sr=Ht,Ar=JSBI.BigInt(Vt);const Dr=GetIntrinsic("%Temporal.Duration%");let Br,Lr,Or,vr,pr=Qt;if(pr){if(IsTemporalZonedDateTime(pr))Lr=pr,pr=ToTemporalDate(pr);else if(!IsTemporalDate(pr))throw new TypeError("starting point must be PlainDate or ZonedDateTime");Br=GetSlot(pr,p)}if(Wt==="year"||Wt==="month"||Wt==="week"||Wt==="day"){let dr,ur,$r;Ar=TotalDurationNanoseconds(0,ar,ir,lr,yr,Sr,Vt,0),Lr&&(dr=MoveRelativeZonedDateTime(Lr,Xt,tr,rr,nr)),{days:ur,nanoseconds:Ar,dayLengthNs:$r}=NanosecondsToDays(Ar,dr),Or=JSBI.BigInt($r),nr+=ur,ar=ir=lr=yr=Sr=0}switch(Wt){case"year":{if(!Br)throw new RangeError("A starting point is required for years rounding");const dr=new Dr(Xt),ur=typeof Br!="string"?GetMethod(Br,"dateAdd"):void 0,$r=CalendarDateAdd(Br,pr,dr,void 0,ur),wr=CalendarDateAdd(Br,pr,new Dr(Xt,tr,rr),void 0,ur);pr=$r,nr+=DaysUntil($r,wr);const Er=CalendarDateAdd(Br,pr,new Dr(0,0,0,nr),void 0,ur),gr=Te(null);gr.largestUnit="year";const fr=CalendarDateUntil(Br,pr,Er,gr).years;Xt+=fr;const br=pr;pr=CalendarDateAdd(Br,pr,new Dr(fr),void 0,ur),nr-=DaysUntil(br,pr);const _r=new Dr(nr<0?-1:1);let{days:Tr}=MoveRelativeDate(Br,pr,_r,ur);Tr=ae(Tr);const Pr=JSBI.multiply(JSBI.BigInt(Tr),Or);Ar=JSBI.add(JSBI.add(JSBI.multiply(Pr,JSBI.BigInt(Xt)),JSBI.multiply(JSBI.BigInt(nr),Or)),Ar);const Nr=RoundNumberToIncrement(Ar,JSBI.multiply(Pr,JSBI.BigInt(zt)),Jt);vr=BigIntDivideToNumber(Ar,Pr),Xt=JSBI.toNumber(JSBI.divide(Nr,Pr)),Ar=Ie,tr=rr=nr=0;break}case"month":{if(!Br)throw new RangeError("A starting point is required for months rounding");const dr=new Dr(Xt,tr),ur=typeof Br!="string"?GetMethod(Br,"dateAdd"):void 0,$r=CalendarDateAdd(Br,pr,dr,void 0,ur),wr=CalendarDateAdd(Br,pr,new Dr(Xt,tr,rr),void 0,ur);pr=$r,nr+=DaysUntil($r,wr);const Er=se(nr),gr=new Dr(0,nr<0?-1:1);let fr;for({relativeTo:pr,days:fr}=MoveRelativeDate(Br,pr,gr,ur);ae(nr)>=ae(fr);)tr+=Er,nr-=fr,{relativeTo:pr,days:fr}=MoveRelativeDate(Br,pr,gr,ur);fr=ae(fr);const br=JSBI.multiply(JSBI.BigInt(fr),Or);Ar=JSBI.add(JSBI.add(JSBI.multiply(br,JSBI.BigInt(tr)),JSBI.multiply(JSBI.BigInt(nr),Or)),Ar);const _r=RoundNumberToIncrement(Ar,JSBI.multiply(br,JSBI.BigInt(zt)),Jt);vr=BigIntDivideToNumber(Ar,br),tr=JSBI.toNumber(JSBI.divide(_r,br)),Ar=Ie,rr=nr=0;break}case"week":{if(!Br)throw new RangeError("A starting point is required for weeks rounding");const dr=se(nr),ur=new Dr(0,0,nr<0?-1:1),$r=typeof Br!="string"?GetMethod(Br,"dateAdd"):void 0;let wr;for({relativeTo:pr,days:wr}=MoveRelativeDate(Br,pr,ur,$r);ae(nr)>=ae(wr);)rr+=dr,nr-=wr,{relativeTo:pr,days:wr}=MoveRelativeDate(Br,pr,ur,$r);wr=ae(wr);const Er=JSBI.multiply(JSBI.BigInt(wr),Or);Ar=JSBI.add(JSBI.add(JSBI.multiply(Er,JSBI.BigInt(rr)),JSBI.multiply(JSBI.BigInt(nr),Or)),Ar);const gr=RoundNumberToIncrement(Ar,JSBI.multiply(Er,JSBI.BigInt(zt)),Jt);vr=BigIntDivideToNumber(Ar,Er),rr=JSBI.toNumber(JSBI.divide(gr,Er)),Ar=Ie,nr=0;break}case"day":{const dr=Or;Ar=JSBI.add(JSBI.multiply(dr,JSBI.BigInt(nr)),Ar);const ur=RoundNumberToIncrement(Ar,JSBI.multiply(dr,JSBI.BigInt(zt)),Jt);vr=BigIntDivideToNumber(Ar,dr),nr=JSBI.toNumber(JSBI.divide(ur,dr)),Ar=Ie;break}case"hour":{let ur=JSBI.multiply(JSBI.BigInt(ar),JSBI.BigInt(36e11));ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(ir),JSBI.BigInt(6e10))),ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(lr),ve)),ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(yr),Ge)),ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(Sr),De)),ur=JSBI.add(ur,Ar),vr=BigIntDivideToNumber(ur,JSBI.BigInt(36e11));const $r=RoundNumberToIncrement(ur,JSBI.BigInt(36e11*zt),Jt);ar=JSBI.toNumber(JSBI.divide($r,JSBI.BigInt(36e11))),Ar=Ie,ir=lr=yr=Sr=0;break}case"minute":{let ur=JSBI.multiply(JSBI.BigInt(ir),JSBI.BigInt(6e10));ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(lr),ve)),ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(yr),Ge)),ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(Sr),De)),ur=JSBI.add(ur,Ar),vr=BigIntDivideToNumber(ur,JSBI.BigInt(6e10));const $r=RoundNumberToIncrement(ur,JSBI.BigInt(6e10*zt),Jt);ir=JSBI.toNumber(JSBI.divide($r,JSBI.BigInt(6e10))),Ar=Ie,lr=yr=Sr=0;break}case"second":{let ur=JSBI.multiply(JSBI.BigInt(lr),ve);ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(yr),Ge)),ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(Sr),De)),ur=JSBI.add(ur,Ar),vr=BigIntDivideToNumber(ur,JSBI.BigInt(1e9));const $r=RoundNumberToIncrement(ur,JSBI.BigInt(1e9*zt),Jt);lr=JSBI.toNumber(JSBI.divide($r,JSBI.BigInt(1e9))),Ar=Ie,yr=Sr=0;break}case"millisecond":{let ur=JSBI.multiply(JSBI.BigInt(yr),Ge);ur=JSBI.add(ur,JSBI.multiply(JSBI.BigInt(Sr),De)),ur=JSBI.add(ur,Ar),vr=BigIntDivideToNumber(ur,JSBI.BigInt(1e6));const $r=RoundNumberToIncrement(ur,JSBI.BigInt(1e6*zt),Jt);yr=JSBI.toNumber(JSBI.divide($r,JSBI.BigInt(1e6))),Ar=Ie,Sr=0;break}case"microsecond":{let ur=JSBI.multiply(JSBI.BigInt(Sr),De);ur=JSBI.add(ur,Ar),vr=BigIntDivideToNumber(ur,JSBI.BigInt(1e3));const $r=RoundNumberToIncrement(ur,JSBI.BigInt(1e3*zt),Jt);Sr=JSBI.toNumber(JSBI.divide($r,JSBI.BigInt(1e3))),Ar=Ie;break}case"nanosecond":vr=JSBI.toNumber(Ar),Ar=RoundNumberToIncrement(JSBI.BigInt(Ar),JSBI.BigInt(zt),Jt)}return{years:Xt,months:tr,weeks:rr,days:nr,hours:ar,minutes:ir,seconds:lr,milliseconds:yr,microseconds:Sr,nanoseconds:JSBI.toNumber(Ar),total:vr}}function CompareISODate(kt,At,xt,Bt,Nt,jt){for(const[Ut,Lt]of[[kt,Bt],[At,Nt],[xt,jt]])if(Ut!==Lt)return ComparisonResult(Ut-Lt);return 0}function NonNegativeBigIntDivmod(kt,At){let{quotient:xt,remainder:Bt}=divmod(kt,At);return JSBI.lessThan(Bt,Ie)&&(xt=JSBI.subtract(xt,Se),Bt=JSBI.add(Bt,At)),{quotient:xt,remainder:Bt}}function BigIntFloorDiv(kt,At){const{quotient:xt,remainder:Bt}=divmod(kt,At);return isZero(Bt)||!isNegativeJSBI(kt)==!isNegativeJSBI(At)?xt:JSBI.subtract(xt,Se)}function BigIntDivideToNumber(kt,At){const{quotient:xt,remainder:Bt}=divmod(kt,At);return JSBI.toNumber(xt)+JSBI.toNumber(Bt)/JSBI.toNumber(At)}function ToBigIntExternal(kt){const At=ToBigInt(kt);return globalThis.BigInt!==void 0?globalThis.BigInt(At.toString(10)):At}function ToBigInt(kt){let At=kt;if(typeof kt=="object"){const xt=kt[Symbol.toPrimitive];xt&&typeof xt=="function"&&(At=fe(xt,kt,["number"]))}if(typeof At=="number")throw new TypeError("cannot convert number to bigint");return typeof At=="bigint"?JSBI.BigInt(At.toString(10)):JSBI.BigInt(At)}const Ve=(()=>{let kt=JSBI.BigInt(Date.now()%1e6);return()=>{const At=JSBI.BigInt(Date.now()),xt=JSBI.add(JSBI.multiply(At,Ge),kt);return kt=JSBI.remainder(At,Ge),JSBI.greaterThan(xt,Re)?Re:JSBI.lessThan(xt,Me)?Me:xt}})();function DefaultTimeZone(){return new re().resolvedOptions().timeZone}function ComparisonResult(kt){return kt<0?-1:kt>0?1:kt}function GetOptionsObject(kt){if(kt===void 0)return Te(null);if(IsObject(kt)&&kt!==null)return kt;throw new TypeError("Options parameter must be an object, not "+(kt===null?"null":typeof kt))}function CreateOnePropObject(kt,At){const xt=Te(null);return xt[kt]=At,xt}function CopyOptions(kt){const At=Te(null);return CopyDataProperties(At,GetOptionsObject(kt),[]),At}function GetOption(kt,At,xt,Bt){let Nt=kt[At];if(Nt!==void 0){if(Nt=ToString(Nt),!xt.includes(Nt))throw new RangeError(`${At} must be one of ${xt.join(", ")}, not ${Nt}`);return Nt}return Bt}function IsBuiltinCalendar(kt){return je.includes(ASCIILowercase(kt))}function ASCIILowercase(kt){return kt.replace(/[A-Z]/g,At=>{const xt=At.charCodeAt(0);return String.fromCharCode(xt+32)})}const ze=new RegExp(`^${W.source}$`);function bisect(kt,At,xt,Bt=kt(At),Nt=kt(xt)){let jt=JSBI.BigInt(At),Ut=JSBI.BigInt(xt),Lt=Bt,Ht=Nt;for(;JSBI.greaterThan(JSBI.subtract(Ut,jt),Se);){const Vt=JSBI.divide(JSBI.add(jt,Ut),JSBI.BigInt(2)),zt=kt(Vt);if(zt===Lt)jt=Vt,Lt=zt;else{if(zt!==Ht)throw new Error(`invalid state in bisection ${Lt} - ${zt} - ${Ht}`);Ut=Vt,Ht=zt}}return Ut}const _e={hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},Je=Symbol("date"),Ke=Symbol("ym"),Xe=Symbol("md"),Qe=Symbol("time"),et=Symbol("datetime"),tt=Symbol("instant"),rt=Symbol("original"),ot=Symbol("timezone"),nt=Symbol("calendar-id"),at=Symbol("locale"),it=Symbol("options"),descriptor=kt=>({value:kt,enumerable:!0,writable:!1,configurable:!0}),st=globalThis.Intl.DateTimeFormat,lt=Object.assign,dt=Object.prototype.hasOwnProperty,mt=Reflect.apply;function getPropLazy(kt,At){let xt=kt[At];return typeof xt=="function"&&(xt=new st(kt[at],xt(kt[it])),kt[At]=xt),xt}function DateTimeFormatImpl(kt,At={}){if(!(this instanceof DateTimeFormatImpl))return new DateTimeFormatImpl(kt,At);const xt=At!==void 0,Bt=xt?lt({},At):{},Nt=new st(kt,Bt),jt=Nt.resolvedOptions();if(xt){const Ut=lt({},jt);for(const Lt in Ut)mt(dt,Bt,[Lt])||delete Ut[Lt];this[it]=Ut}else this[it]=Bt;this[at]=jt.locale,this[rt]=Nt,this[ot]=jt.timeZone,this[nt]=jt.calendar,this[Je]=dateAmend,this[Ke]=yearMonthAmend,this[Xe]=monthDayAmend,this[Qe]=timeAmend,this[et]=datetimeAmend,this[tt]=instantAmend}Object.defineProperty(DateTimeFormatImpl,"name",{writable:!0,value:"DateTimeFormat"}),DateTimeFormatImpl.supportedLocalesOf=function(kt,At){return st.supportedLocalesOf(kt,At)};const ct={resolvedOptions:descriptor(function kt(){return this[rt].resolvedOptions()}),format:descriptor(function kt(At,...xt){let{instant:Bt,formatter:Nt}=extractOverrides(At,this);return Bt&&Nt?Nt.format(Bt.epochMilliseconds):this[rt].format(At,...xt)}),formatRange:descriptor(function kt(At,xt){if(isTemporalObject(At)||isTemporalObject(xt)){if(!sameTemporalType(At,xt))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{instant:Bt,formatter:Nt}=extractOverrides(At,this),{instant:jt,formatter:Ut}=extractOverrides(xt,this);if(Bt&&jt&&Nt&&Ut&&Nt===Ut)return Nt.formatRange(Bt.epochMilliseconds,jt.epochMilliseconds)}return this[rt].formatRange(At,xt)})};"formatToParts"in st.prototype&&(ct.formatToParts=descriptor(function kt(At,...xt){let{instant:Bt,formatter:Nt}=extractOverrides(At,this);return Bt&&Nt?Nt.formatToParts(Bt.epochMilliseconds):this[rt].formatToParts(At,...xt)})),"formatRangeToParts"in st.prototype&&(ct.formatRangeToParts=descriptor(function kt(At,xt){if(isTemporalObject(At)||isTemporalObject(xt)){if(!sameTemporalType(At,xt))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{instant:Bt,formatter:Nt}=extractOverrides(At,this),{instant:jt,formatter:Ut}=extractOverrides(xt,this);if(Bt&&jt&&Nt&&Ut&&Nt===Ut)return Nt.formatRangeToParts(Bt.epochMilliseconds,jt.epochMilliseconds)}return this[rt].formatRangeToParts(At,xt)})),DateTimeFormatImpl.prototype=Object.create(st.prototype,ct),Object.defineProperty(DateTimeFormatImpl,"prototype",{writable:!1,enumerable:!1,configurable:!1});const ht=DateTimeFormatImpl;function amend(kt={},At={}){const xt=lt({},kt);for(const Bt of["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"])xt[Bt]=Bt in At?At[Bt]:xt[Bt],xt[Bt]!==!1&&xt[Bt]!==void 0||delete xt[Bt];return xt}function timeAmend(kt){let At=amend(kt,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});return hasTimeOptions(At)||(At=lt({},At,{hour:"numeric",minute:"numeric",second:"numeric"})),At}function yearMonthAmend(kt){let At=amend(kt,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"year"in At||"month"in At||(At=lt(At,{year:"numeric",month:"numeric"})),At}function monthDayAmend(kt){let At=amend(kt,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"month"in At||"day"in At||(At=lt({},At,{month:"numeric",day:"numeric"})),At}function dateAmend(kt){let At=amend(kt,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});return hasDateOptions(At)||(At=lt({},At,{year:"numeric",month:"numeric",day:"numeric"})),At}function datetimeAmend(kt){let At=amend(kt,{timeZoneName:!1});return hasTimeOptions(At)||hasDateOptions(At)||(At=lt({},At,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),At}function instantAmend(kt){let At=kt;return hasTimeOptions(At)||hasDateOptions(At)||(At=lt({},At,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),At}function hasDateOptions(kt){return"year"in kt||"month"in kt||"day"in kt||"weekday"in kt||"dateStyle"in kt}function hasTimeOptions(kt){return"hour"in kt||"minute"in kt||"second"in kt||"timeStyle"in kt||"dayPeriod"in kt}function isTemporalObject(kt){return IsTemporalDate(kt)||IsTemporalTime(kt)||IsTemporalDateTime(kt)||IsTemporalZonedDateTime(kt)||IsTemporalYearMonth(kt)||IsTemporalMonthDay(kt)||IsTemporalInstant(kt)}function sameTemporalType(kt,At){return!(!isTemporalObject(kt)||!isTemporalObject(At))&&!(IsTemporalTime(kt)&&!IsTemporalTime(At))&&!(IsTemporalDate(kt)&&!IsTemporalDate(At))&&!(IsTemporalDateTime(kt)&&!IsTemporalDateTime(At))&&!(IsTemporalZonedDateTime(kt)&&!IsTemporalZonedDateTime(At))&&!(IsTemporalYearMonth(kt)&&!IsTemporalYearMonth(At))&&!(IsTemporalMonthDay(kt)&&!IsTemporalMonthDay(At))&&!(IsTemporalInstant(kt)&&!IsTemporalInstant(At))}function extractOverrides(kt,At){const xt=GetIntrinsic("%Temporal.PlainDateTime%");if(IsTemporalTime(kt)){const Bt=new xt(1970,1,1,GetSlot(kt,d$1),GetSlot(kt,m$1),GetSlot(kt,c),GetSlot(kt,h$1),GetSlot(kt,u),GetSlot(kt,T),At[nt]);return{instant:GetInstantFor(At[ot],Bt,"compatible"),formatter:getPropLazy(At,Qe)}}if(IsTemporalYearMonth(kt)){const Bt=GetSlot(kt,i$3),Nt=GetSlot(kt,s$2),jt=GetSlot(kt,l),Ut=ToTemporalCalendarIdentifier(GetSlot(kt,p));if(Ut!==At[nt])throw new RangeError(`cannot format PlainYearMonth with calendar ${Ut} in locale with calendar ${At[nt]}`);const Lt=new xt(Bt,Nt,jt,12,0,0,0,0,0,Ut);return{instant:GetInstantFor(At[ot],Lt,"compatible"),formatter:getPropLazy(At,Ke)}}if(IsTemporalMonthDay(kt)){const Bt=GetSlot(kt,i$3),Nt=GetSlot(kt,s$2),jt=GetSlot(kt,l),Ut=ToTemporalCalendarIdentifier(GetSlot(kt,p));if(Ut!==At[nt])throw new RangeError(`cannot format PlainMonthDay with calendar ${Ut} in locale with calendar ${At[nt]}`);const Lt=new xt(Bt,Nt,jt,12,0,0,0,0,0,Ut);return{instant:GetInstantFor(At[ot],Lt,"compatible"),formatter:getPropLazy(At,Xe)}}if(IsTemporalDate(kt)){const Bt=GetSlot(kt,i$3),Nt=GetSlot(kt,s$2),jt=GetSlot(kt,l),Ut=ToTemporalCalendarIdentifier(GetSlot(kt,p));if(Ut!=="iso8601"&&Ut!==At[nt])throw new RangeError(`cannot format PlainDate with calendar ${Ut} in locale with calendar ${At[nt]}`);const Lt=new xt(Bt,Nt,jt,12,0,0,0,0,0,At[nt]);return{instant:GetInstantFor(At[ot],Lt,"compatible"),formatter:getPropLazy(At,Je)}}if(IsTemporalDateTime(kt)){const Bt=GetSlot(kt,i$3),Nt=GetSlot(kt,s$2),jt=GetSlot(kt,l),Ut=GetSlot(kt,d$1),Lt=GetSlot(kt,m$1),Ht=GetSlot(kt,c),Vt=GetSlot(kt,h$1),zt=GetSlot(kt,u),Wt=GetSlot(kt,T),Jt=ToTemporalCalendarIdentifier(GetSlot(kt,p));if(Jt!=="iso8601"&&Jt!==At[nt])throw new RangeError(`cannot format PlainDateTime with calendar ${Jt} in locale with calendar ${At[nt]}`);let Qt=kt;return Jt==="iso8601"&&(Qt=new xt(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,At[nt])),{instant:GetInstantFor(At[ot],Qt,"compatible"),formatter:getPropLazy(At,et)}}if(IsTemporalZonedDateTime(kt))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return IsTemporalInstant(kt)?{instant:kt,formatter:getPropLazy(At,tt)}:{}}class Instant{constructor(At){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const xt=ToBigInt(At);ValidateEpochNanoseconds(xt),N(this),SetSlot(this,n,xt)}get epochSeconds(){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");const At=GetSlot(this,n);return JSBI.toNumber(BigIntFloorDiv(At,ve))}get epochMilliseconds(){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");const At=JSBI.BigInt(GetSlot(this,n));return JSBI.toNumber(BigIntFloorDiv(At,Ge))}get epochMicroseconds(){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return ToBigIntExternal(BigIntFloorDiv(JSBI.BigInt(GetSlot(this,n)),De))}get epochNanoseconds(){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return ToBigIntExternal(JSBI.BigInt(GetSlot(this,n)))}add(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromInstant("add",this,At)}subtract(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromInstant("subtract",this,At)}until(At,xt){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return DifferenceTemporalInstant("until",this,At,xt)}since(At,xt){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return DifferenceTemporalInstant("since",this,At,xt)}round(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");if(At===void 0)throw new TypeError("options parameter is required");const xt=typeof At=="string"?CreateOnePropObject("smallestUnit",At):GetOptionsObject(At),Bt=ToTemporalRoundingIncrement(xt),Nt=ToTemporalRoundingMode(xt,"halfExpand"),jt=GetTemporalUnit(xt,"smallestUnit","time",He);ValidateTemporalRoundingIncrement(Bt,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[jt],!0);const Ut=RoundInstant(GetSlot(this,n),Bt,jt,Nt);return new Instant(Ut)}equals(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");const xt=ToTemporalInstant(At),Bt=GetSlot(this,n),Nt=GetSlot(xt,n);return JSBI.equal(JSBI.BigInt(Bt),JSBI.BigInt(Nt))}toString(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");const xt=GetOptionsObject(At),Bt=ToFractionalSecondDigits(xt),Nt=ToTemporalRoundingMode(xt,"trunc"),jt=GetTemporalUnit(xt,"smallestUnit","time",void 0);if(jt==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let Ut=xt.timeZone;Ut!==void 0&&(Ut=ToTemporalTimeZoneSlotValue(Ut));const{precision:Lt,unit:Ht,increment:Vt}=ToSecondsStringPrecisionRecord(jt,Bt),zt=RoundInstant(GetSlot(this,n),Vt,Ht,Nt);return TemporalInstantToString(new Instant(zt),Ut,Lt)}toJSON(){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return TemporalInstantToString(this,void 0,"auto")}toLocaleString(At,xt){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");return new ht(At,xt).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.Instant")}toZonedDateTime(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument in toZonedDateTime");const xt=At.calendar;if(xt===void 0)throw new TypeError("missing calendar property in toZonedDateTime");const Bt=ToTemporalCalendarSlotValue(xt),Nt=At.timeZone;if(Nt===void 0)throw new TypeError("missing timeZone property in toZonedDateTime");const jt=ToTemporalTimeZoneSlotValue(Nt);return CreateTemporalZonedDateTime(GetSlot(this,n),jt,Bt)}toZonedDateTimeISO(At){if(!IsTemporalInstant(this))throw new TypeError("invalid receiver");const xt=ToTemporalTimeZoneSlotValue(At);return CreateTemporalZonedDateTime(GetSlot(this,n),xt,"iso8601")}static fromEpochSeconds(At){const xt=ToNumber(At),Bt=JSBI.multiply(JSBI.BigInt(xt),ve);return ValidateEpochNanoseconds(Bt),new Instant(Bt)}static fromEpochMilliseconds(At){const xt=ToNumber(At),Bt=JSBI.multiply(JSBI.BigInt(xt),Ge);return ValidateEpochNanoseconds(Bt),new Instant(Bt)}static fromEpochMicroseconds(At){const xt=ToBigInt(At),Bt=JSBI.multiply(xt,De);return ValidateEpochNanoseconds(Bt),new Instant(Bt)}static fromEpochNanoseconds(At){const xt=ToBigInt(At);return ValidateEpochNanoseconds(xt),new Instant(xt)}static from(At){return IsTemporalInstant(At)?new Instant(GetSlot(At,n)):ToTemporalInstant(At)}static compare(At,xt){const Bt=ToTemporalInstant(At),Nt=ToTemporalInstant(xt),jt=GetSlot(Bt,n),Ut=GetSlot(Nt,n);return JSBI.lessThan(jt,Ut)?-1:JSBI.greaterThan(jt,Ut)?1:0}}MakeIntrinsicClass(Instant,"Temporal.Instant");const Tt=Array.prototype.includes,pt=Array.prototype.push,ft=globalThis.Intl.DateTimeFormat,yt=Array.prototype.sort,It=Math.abs,St=Math.floor,gt=Object.create,wt=Object.entries,Dt=Set,Gt=Reflect.ownKeys,vt=Set.prototype.add,Ct=Set.prototype.values,Ot={};class Calendar{constructor(At){if(arguments.length<1)throw new RangeError("missing argument: id is required");const xt=ToString(At);if(!IsBuiltinCalendar(xt))throw new RangeError(`invalid calendar identifier ${xt}`);N(this),SetSlot(this,F,ASCIILowercase(xt))}get id(){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return GetSlot(this,F)}dateFromFields(At,xt){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid fields");const Bt=GetOptionsObject(xt),Nt=GetSlot(this,F);return Ot[Nt].dateFromFields(At,Bt,Nt)}yearMonthFromFields(At,xt){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid fields");const Bt=GetOptionsObject(xt),Nt=GetSlot(this,F);return Ot[Nt].yearMonthFromFields(At,Bt,Nt)}monthDayFromFields(At,xt){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid fields");const Bt=GetOptionsObject(xt),Nt=GetSlot(this,F);return Ot[Nt].monthDayFromFields(At,Bt,Nt)}fields(At){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const xt=[],Bt=new Set(["year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond"]);for(const Nt of At){if(typeof Nt!="string")throw new TypeError("invalid fields");if(!Bt.has(Nt))throw new RangeError(`invalid field name ${Nt}`);Bt.delete(Nt),pt.call(xt,Nt)}return Ot[GetSlot(this,F)].fields(xt)}mergeFields(At,xt){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const Bt=ToObject(At),Nt=gt(null);CopyDataProperties(Nt,Bt,[],[void 0]);const jt=ToObject(xt),Ut=gt(null);CopyDataProperties(Ut,jt,[],[void 0]);const Lt=Gt(Ut),Ht=Ot[GetSlot(this,F)].fieldKeysToIgnore(Lt),Vt=gt(null),zt=Gt(Nt);for(const Wt of zt){let Jt;Jt=Call(Tt,Ht,[Wt])?Ut[Wt]:Nt[Wt],Jt!==void 0&&(Vt[Wt]=Jt)}return CopyDataProperties(Vt,Ut,[]),Vt}dateAdd(At,xt,Bt){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const Nt=ToTemporalDate(At),jt=ToTemporalDuration(xt),Ut=ToTemporalOverflow(GetOptionsObject(Bt)),{days:Lt}=BalanceDuration(GetSlot(jt,v),GetSlot(jt,C),GetSlot(jt,O),GetSlot(jt,b),GetSlot(jt,E$1),GetSlot(jt,M),GetSlot(jt,R),"day"),Ht=GetSlot(this,F);return Ot[Ht].dateAdd(Nt,GetSlot(jt,w$1),GetSlot(jt,D),GetSlot(jt,G),Lt,Ut,Ht)}dateUntil(At,xt,Bt){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const Nt=ToTemporalDate(At),jt=ToTemporalDate(xt);let Ut=GetTemporalUnit(GetOptionsObject(Bt),"largestUnit","date","auto");Ut==="auto"&&(Ut="day");const{years:Lt,months:Ht,weeks:Vt,days:zt}=Ot[GetSlot(this,F)].dateUntil(Nt,jt,Ut);return new(GetIntrinsic("%Temporal.Duration%"))(Lt,Ht,Vt,zt,0,0,0,0,0,0)}year(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].year(xt)}month(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");if(IsTemporalMonthDay(xt))throw new TypeError("use monthCode on PlainMonthDay instead");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].month(xt)}monthCode(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||IsTemporalMonthDay(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].monthCode(xt)}day(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalMonthDay(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].day(xt)}era(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].era(xt)}eraYear(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].eraYear(xt)}dayOfWeek(At){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At);return Ot[GetSlot(this,F)].dayOfWeek(xt)}dayOfYear(At){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At);return Ot[GetSlot(this,F)].dayOfYear(xt)}weekOfYear(At){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At);return Ot[GetSlot(this,F)].weekOfYear(xt)}yearOfWeek(At){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At);return Ot[GetSlot(this,F)].yearOfWeek(xt)}daysInWeek(At){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At);return Ot[GetSlot(this,F)].daysInWeek(xt)}daysInMonth(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].daysInMonth(xt)}daysInYear(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].daysInYear(xt)}monthsInYear(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].monthsInYear(xt)}inLeapYear(At){let xt=At;if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return IsTemporalYearMonth(xt)||(xt=ToTemporalDate(xt)),Ot[GetSlot(this,F)].inLeapYear(xt)}toString(){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return GetSlot(this,F)}toJSON(){if(!IsTemporalCalendar(this))throw new TypeError("invalid receiver");return GetSlot(this,F)}static from(At){return ToTemporalCalendarObject(ToTemporalCalendarSlotValue(At))}}function monthCodeNumberPart(kt){if(!kt.startsWith("M"))throw new RangeError(`Invalid month code: ${kt}.  Month codes must start with M.`);const At=+kt.slice(1);if(isNaN(At))throw new RangeError(`Invalid month code: ${kt}`);return At}function buildMonthCode(kt,At=!1){return`M${kt.toString().padStart(2,"0")}${At?"L":""}`}function resolveNonLunisolarMonth(kt,At,xt=12){let{month:Bt,monthCode:Nt}=kt;if(Nt===void 0){if(Bt===void 0)throw new TypeError("Either month or monthCode are required");At==="reject"&&RejectToRange(Bt,1,xt),At==="constrain"&&(Bt=ConstrainToRange(Bt,1,xt)),Nt=buildMonthCode(Bt)}else{const jt=monthCodeNumberPart(Nt);if(Bt!==void 0&&Bt!==jt)throw new RangeError(`monthCode ${Nt} and month ${Bt} must match if both are present`);if(Nt!==buildMonthCode(jt))throw new RangeError(`Invalid month code: ${Nt}`);if(Bt=jt,Bt<1||Bt>xt)throw new RangeError(`Invalid monthCode: ${Nt}`)}return{...kt,month:Bt,monthCode:Nt}}MakeIntrinsicClass(Calendar,"Temporal.Calendar"),DefineIntrinsic("Temporal.Calendar.from",Calendar.from),DefineIntrinsic("Temporal.Calendar.prototype.dateAdd",Calendar.prototype.dateAdd),DefineIntrinsic("Temporal.Calendar.prototype.dateFromFields",Calendar.prototype.dateFromFields),DefineIntrinsic("Temporal.Calendar.prototype.dateUntil",Calendar.prototype.dateUntil),DefineIntrinsic("Temporal.Calendar.prototype.day",Calendar.prototype.day),DefineIntrinsic("Temporal.Calendar.prototype.dayOfWeek",Calendar.prototype.dayOfWeek),DefineIntrinsic("Temporal.Calendar.prototype.dayOfYear",Calendar.prototype.dayOfYear),DefineIntrinsic("Temporal.Calendar.prototype.daysInMonth",Calendar.prototype.daysInMonth),DefineIntrinsic("Temporal.Calendar.prototype.daysInWeek",Calendar.prototype.daysInWeek),DefineIntrinsic("Temporal.Calendar.prototype.daysInYear",Calendar.prototype.daysInYear),DefineIntrinsic("Temporal.Calendar.prototype.era",Calendar.prototype.era),DefineIntrinsic("Temporal.Calendar.prototype.eraYear",Calendar.prototype.eraYear),DefineIntrinsic("Temporal.Calendar.prototype.fields",Calendar.prototype.fields),DefineIntrinsic("Temporal.Calendar.prototype.inLeapYear",Calendar.prototype.inLeapYear),DefineIntrinsic("Temporal.Calendar.prototype.mergeFields",Calendar.prototype.mergeFields),DefineIntrinsic("Temporal.Calendar.prototype.month",Calendar.prototype.month),DefineIntrinsic("Temporal.Calendar.prototype.monthCode",Calendar.prototype.monthCode),DefineIntrinsic("Temporal.Calendar.prototype.monthDayFromFields",Calendar.prototype.monthDayFromFields),DefineIntrinsic("Temporal.Calendar.prototype.monthsInYear",Calendar.prototype.monthsInYear),DefineIntrinsic("Temporal.Calendar.prototype.weekOfYear",Calendar.prototype.weekOfYear),DefineIntrinsic("Temporal.Calendar.prototype.year",Calendar.prototype.year),DefineIntrinsic("Temporal.Calendar.prototype.yearMonthFromFields",Calendar.prototype.yearMonthFromFields),DefineIntrinsic("Temporal.Calendar.prototype.yearOfWeek",Calendar.prototype.yearOfWeek),Ot.iso8601={dateFromFields(kt,At,xt){let Bt=PrepareTemporalFields(kt,["day","month","monthCode","year"],["year","day"]);const Nt=ToTemporalOverflow(At);Bt=resolveNonLunisolarMonth(Bt);let{year:jt,month:Ut,day:Lt}=Bt;return{year:jt,month:Ut,day:Lt}=RegulateISODate(jt,Ut,Lt,Nt),CreateTemporalDate(jt,Ut,Lt,xt)},yearMonthFromFields(kt,At,xt){let Bt=PrepareTemporalFields(kt,["month","monthCode","year"],["year"]);const Nt=ToTemporalOverflow(At);Bt=resolveNonLunisolarMonth(Bt);let{year:jt,month:Ut}=Bt;return{year:jt,month:Ut}=function(Ht,Vt,zt){let Wt=Ht,Jt=Vt;switch(zt){case"reject":RejectISODate(Wt,Jt,1);break;case"constrain":({year:Wt,month:Jt}=ConstrainISODate(Wt,Jt))}return{year:Wt,month:Jt}}(jt,Ut,Nt),CreateTemporalYearMonth(jt,Ut,xt,1)},monthDayFromFields(kt,At,xt){let Bt=PrepareTemporalFields(kt,["day","month","monthCode","year"],["day"]);const Nt=ToTemporalOverflow(At);if(Bt.month!==void 0&&Bt.year===void 0&&Bt.monthCode===void 0)throw new TypeError("either year or monthCode required with month");const jt=Bt.monthCode===void 0;Bt=resolveNonLunisolarMonth(Bt);let{month:Ut,day:Lt,year:Ht}=Bt;return{month:Ut,day:Lt}=RegulateISODate(jt?Ht:1972,Ut,Lt,Nt),CreateTemporalMonthDay(Ut,Lt,xt,1972)},fields:kt=>kt,fieldKeysToIgnore(kt){const At=new Dt;for(let xt=0;xt<kt.length;xt++){const Bt=kt[xt];Call(vt,At,[Bt]),Bt==="month"?Call(vt,At,["monthCode"]):Bt==="monthCode"&&Call(vt,At,["month"])}return[...Call(Ct,At,[])]},dateAdd(kt,At,xt,Bt,Nt,jt,Ut){let Lt=GetSlot(kt,i$3),Ht=GetSlot(kt,s$2),Vt=GetSlot(kt,l);return{year:Lt,month:Ht,day:Vt}=AddISODate(Lt,Ht,Vt,At,xt,Bt,Nt,jt),CreateTemporalDate(Lt,Ht,Vt,Ut)},dateUntil:(kt,At,xt)=>DifferenceISODate(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l),GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),xt),year:kt=>GetSlot(kt,i$3),era(){},eraYear(){},month:kt=>GetSlot(kt,s$2),monthCode:kt=>buildMonthCode(GetSlot(kt,s$2)),day:kt=>GetSlot(kt,l),dayOfWeek:kt=>DayOfWeek(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l)),dayOfYear:kt=>DayOfYear(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l)),weekOfYear:kt=>WeekOfYear(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l)).week,yearOfWeek:kt=>WeekOfYear(GetSlot(kt,i$3),GetSlot(kt,s$2),GetSlot(kt,l)).year,daysInWeek:()=>7,daysInMonth:kt=>ISODaysInMonth(GetSlot(kt,i$3),GetSlot(kt,s$2)),daysInYear(kt){let At=kt;return HasSlot(At,i$3)||(At=ToTemporalDate(At)),LeapYear(GetSlot(At,i$3))?366:365},monthsInYear:()=>12,inLeapYear(kt){let At=kt;return HasSlot(At,i$3)||(At=ToTemporalDate(At)),LeapYear(GetSlot(At,i$3))}};class OneObjectCache{constructor(At){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,this.now=globalThis.performance?globalThis.performance.now():Date.now(),At!==void 0){let xt=0;for(const Bt of At.map.entries()){if(++xt>OneObjectCache.MAX_CACHE_ENTRIES)break;this.map.set(...Bt)}}}get(At){const xt=this.map.get(At);return xt&&(this.hits++,this.report()),this.calls++,xt}set(At,xt){this.map.set(At,xt),this.misses++,this.report()}report(){}setObject(At){if(OneObjectCache.objectMap.get(At))throw new RangeError("object already cached");OneObjectCache.objectMap.set(At,this),this.report()}static getCacheForObject(At){let xt=OneObjectCache.objectMap.get(At);return xt||(xt=new OneObjectCache,OneObjectCache.objectMap.set(At,xt)),xt}}function toUtcIsoDateString({isoYear:kt,isoMonth:At,isoDay:xt}){return`${ISOYearString(kt)}-${ISODateTimePartString(At)}-${ISODateTimePartString(xt)}T00:00Z`}function simpleDateDiff(kt,At){return{years:kt.year-At.year,months:kt.month-At.month,days:kt.day-At.day}}OneObjectCache.objectMap=new WeakMap,OneObjectCache.MAX_CACHE_ENTRIES=1e3;class HelperBase{constructor(){this.eraLength="short",this.hasEra=!0,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new ft(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:this.eraLength,timeZone:"UTC"})),this.formatter}isoToCalendarDate(At,xt){const{year:Bt,month:Nt,day:jt}=At,Ut=JSON.stringify({func:"isoToCalendarDate",isoYear:Bt,isoMonth:Nt,isoDay:jt,id:this.id}),Lt=xt.get(Ut);if(Lt)return Lt;const Ht=this.getFormatter();let Vt,zt;try{zt=toUtcIsoDateString({isoYear:Bt,isoMonth:Nt,isoDay:jt}),Vt=Ht.formatToParts(new Date(zt))}catch{throw new RangeError(`Invalid ISO date: ${JSON.stringify({isoYear:Bt,isoMonth:Nt,isoDay:jt})}`)}const Wt={};for(let{type:Qt,value:Xt}of Vt){if(Qt==="year"&&(Wt.eraYear=+Xt),Qt==="relatedYear"&&(Wt.eraYear=+Xt),Qt==="month"){const tr=/^([0-9]*)(.*?)$/.exec(Xt);if(!tr||tr.length!=3||!tr[1]&&!tr[2])throw new RangeError(`Unexpected month: ${Xt}`);if(Wt.month=tr[1]?+tr[1]:1,Wt.month<1)throw new RangeError(`Invalid month ${Xt} from ${zt}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(Wt.month>13)throw new RangeError(`Invalid month ${Xt} from ${zt}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);tr[2]&&(Wt.monthExtra=tr[2])}Qt==="day"&&(Wt.day=+Xt),this.hasEra&&Qt==="era"&&Xt!=null&&Xt!==""&&(Xt=Xt.split(" (")[0],Wt.era=Xt.normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(" ","-").toLowerCase())}if(Wt.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.reviseIntlEra){const{era:Qt,eraYear:Xt}=this.reviseIntlEra(Wt,At);Wt.era=Qt,Wt.eraYear=Xt}this.checkIcuBugs&&this.checkIcuBugs(At);const Jt=this.adjustCalendarDate(Wt,xt,"constrain",!0);if(Jt.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(At)}`);if(Jt.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(At)}`);if(Jt.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(At)}`);return xt.set(Ut,Jt),["constrain","reject"].forEach(Qt=>{const Xt=JSON.stringify({func:"calendarToIsoDate",year:Jt.year,month:Jt.month,day:Jt.day,overflow:Qt,id:this.id});xt.set(Xt,At)}),Jt}validateCalendarDate(At){const{era:xt,month:Bt,year:Nt,day:jt,eraYear:Ut,monthCode:Lt,monthExtra:Ht}=At;if(Ht!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(Nt===void 0&&Ut===void 0)throw new TypeError("year or eraYear is required");if(Bt===void 0&&Lt===void 0)throw new TypeError("month or monthCode is required");if(jt===void 0)throw new RangeError("Missing day");if(Lt!==void 0){if(typeof Lt!="string")throw new RangeError("monthCode must be a string, not "+typeof Lt);if(!/^M([01]?\d)(L?)$/.test(Lt))throw new RangeError(`Invalid monthCode: ${Lt}`)}if(this.constantEra){if(xt!==void 0&&xt!==this.constantEra)throw new RangeError(`era must be ${this.constantEra}, not ${xt}`);if(Ut!==void 0&&Nt!==void 0&&Ut!==Nt)throw new RangeError(`eraYear ${Ut} does not match year ${Nt}`)}if(this.hasEra&&At.era===void 0!=(At.eraYear===void 0))throw new RangeError("properties 'era' and 'eraYear' must be provided together")}adjustCalendarDate(At,xt,Bt="constrain",Nt=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let jt=At;if(this.validateCalendarDate(jt),this.constantEra){const{year:Vt,eraYear:zt}=jt;jt={...jt,era:this.constantEra,year:Vt!==void 0?Vt:zt,eraYear:zt!==void 0?zt:Vt}}const Ut=this.monthsInYear(jt,xt);let{month:Lt,monthCode:Ht}=jt;return{month:Lt,monthCode:Ht}=resolveNonLunisolarMonth(jt,Bt,Ut),{...jt,month:Lt,monthCode:Ht}}regulateMonthDayNaive(At,xt,Bt){const Nt=this.monthsInYear(At,Bt);let{month:jt,day:Ut}=At;return xt==="reject"?(RejectToRange(jt,1,Nt),RejectToRange(Ut,1,this.maximumMonthLength(At))):(jt=ConstrainToRange(jt,1,Nt),Ut=ConstrainToRange(Ut,1,this.maximumMonthLength({...At,month:jt}))),{...At,month:jt,day:Ut}}calendarToIsoDate(At,xt="constrain",Bt){const Nt=At;let jt=this.adjustCalendarDate(At,Bt,xt,!1);jt=this.regulateMonthDayNaive(jt,xt,Bt);const{year:Ut,month:Lt,day:Ht}=jt,Vt=JSON.stringify({func:"calendarToIsoDate",year:Ut,month:Lt,day:Ht,overflow:xt,id:this.id});let zt,Wt=Bt.get(Vt);if(Wt||Nt.year!==void 0&&Nt.month!==void 0&&Nt.day!==void 0&&(Nt.year!==jt.year||Nt.month!==jt.month||Nt.day!==jt.day)&&(zt=JSON.stringify({func:"calendarToIsoDate",year:Nt.year,month:Nt.month,day:Nt.day,overflow:xt,id:this.id}),Wt=Bt.get(zt),Wt))return Wt;let Jt=this.estimateIsoDate({year:Ut,month:Lt,day:Ht});const Qt=ar=>{let ir=this.addDaysIso(Jt,ar);if(jt.day>this.minimumMonthLength(jt)){let lr=this.isoToCalendarDate(ir,Bt);for(;lr.month!==Lt||lr.year!==Ut;){if(xt==="reject")throw new RangeError(`day ${Ht} does not exist in month ${Lt} of year ${Ut}`);ir=this.addDaysIso(ir,-1),lr=this.isoToCalendarDate(ir,Bt)}}return ir};let Xt=0,tr=this.isoToCalendarDate(Jt,Bt),rr=simpleDateDiff(jt,tr);if(rr.years!==0||rr.months!==0||rr.days!==0){const ar=365*rr.years+30*rr.months+rr.days;Jt=this.addDaysIso(Jt,ar),tr=this.isoToCalendarDate(Jt,Bt),rr=simpleDateDiff(jt,tr),rr.years===0&&rr.months===0?Jt=Qt(rr.days):Xt=this.compareCalendarDates(jt,tr)}let nr=8;for(;Xt;){Jt=this.addDaysIso(Jt,Xt*nr);const ar=tr;tr=this.isoToCalendarDate(Jt,Bt);const ir=Xt;if(Xt=this.compareCalendarDates(jt,tr),Xt){if(rr=simpleDateDiff(jt,tr),rr.years===0&&rr.months===0)Jt=Qt(rr.days),Xt=0;else if(ir&&Xt!==ir)if(nr>1)nr/=2;else{if(xt==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...Nt})}`);this.compareCalendarDates(tr,ar)>0&&(Jt=this.addDaysIso(Jt,-1)),Xt=0}}}if(Bt.set(Vt,Jt),zt&&Bt.set(zt,Jt),jt.year===void 0||jt.month===void 0||jt.day===void 0||jt.monthCode===void 0||this.hasEra&&(jt.era===void 0||jt.eraYear===void 0))throw new RangeError("Unexpected missing property");return Jt}temporalToCalendarDate(At,xt){const Bt={year:GetSlot(At,i$3),month:GetSlot(At,s$2),day:GetSlot(At,l)};return this.isoToCalendarDate(Bt,xt)}compareCalendarDates(At,xt){const Bt=PrepareTemporalFields(At,["day","month","year"],["day","month","year"]),Nt=PrepareTemporalFields(xt,["day","month","year"],["day","month","year"]);return Bt.year!==Nt.year?ComparisonResult(Bt.year-Nt.year):Bt.month!==Nt.month?ComparisonResult(Bt.month-Nt.month):Bt.day!==Nt.day?ComparisonResult(Bt.day-Nt.day):0}regulateDate(At,xt="constrain",Bt){const Nt=this.calendarToIsoDate(At,xt,Bt);return this.isoToCalendarDate(Nt,Bt)}addDaysIso(At,xt){return AddISODate(At.year,At.month,At.day,0,0,0,xt,"constrain")}addDaysCalendar(At,xt,Bt){const Nt=this.calendarToIsoDate(At,"constrain",Bt),jt=this.addDaysIso(Nt,xt);return this.isoToCalendarDate(jt,Bt)}addMonthsCalendar(At,xt,Bt,Nt){let jt=At;const{day:Ut}=jt;for(let Lt=0,Ht=It(xt);Lt<Ht;Lt++){const{month:Vt}=jt,zt=jt,Wt=xt<0?-Math.max(Ut,this.daysInPreviousMonth(jt,Nt)):this.daysInMonth(jt,Nt),Jt=this.calendarToIsoDate(jt,"constrain",Nt);let Qt=this.addDaysIso(Jt,Wt);if(jt=this.isoToCalendarDate(Qt,Nt),xt>0){const Xt=this.monthsInYear(zt,Nt);for(;jt.month-1!=Vt%Xt;)Qt=this.addDaysIso(Qt,-1),jt=this.isoToCalendarDate(Qt,Nt)}jt.day!==Ut&&(jt=this.regulateDate({...jt,day:Ut},"constrain",Nt))}if(Bt==="reject"&&jt.day!==Ut)throw new RangeError(`Day ${Ut} does not exist in resulting calendar month`);return jt}addCalendar(At,{years:xt=0,months:Bt=0,weeks:Nt=0,days:jt=0},Ut,Lt){const{year:Ht,day:Vt,monthCode:zt}=At,Wt=this.adjustCalendarDate({year:Ht+xt,monthCode:zt,day:Vt},Lt),Jt=this.addMonthsCalendar(Wt,Bt,Ut,Lt),Qt=jt+7*Nt;return this.addDaysCalendar(Jt,Qt,Lt)}untilCalendar(At,xt,Bt,Nt){let jt=0,Ut=0,Lt=0,Ht=0;switch(Bt){case"day":jt=this.calendarDaysUntil(At,xt,Nt);break;case"week":{const Vt=this.calendarDaysUntil(At,xt,Nt);jt=Vt%7,Ut=(Vt-jt)/7;break}case"month":case"year":{const Vt=this.compareCalendarDates(xt,At);if(!Vt)return{years:0,months:0,weeks:0,days:0};const zt=xt.year-At.year,Wt=xt.day-At.day;if(Bt==="year"&&zt){let Xt=0;xt.monthCode>At.monthCode&&(Xt=1),xt.monthCode<At.monthCode&&(Xt=-1),Xt||(Xt=Math.sign(Wt)),Ht=Xt*Vt<0?zt-Vt:zt}let Jt,Qt=Ht?this.addCalendar(At,{years:Ht},"constrain",Nt):At;do Lt+=Vt,Jt=Qt,Qt=this.addMonthsCalendar(Jt,Vt,"constrain",Nt),Qt.day!==At.day&&(Qt=this.regulateDate({...Qt,day:At.day},"constrain",Nt));while(this.compareCalendarDates(xt,Qt)*Vt>=0);Lt-=Vt,jt=this.calendarDaysUntil(Jt,xt,Nt);break}}return{years:Ht,months:Lt,weeks:Ut,days:jt}}daysInMonth(At,xt){const{day:Bt}=At,Nt=this.maximumMonthLength(At),jt=this.minimumMonthLength(At);if(jt===Nt)return jt;const Ut=Bt<=Nt-jt?Nt:jt,Lt=this.calendarToIsoDate(At,"constrain",xt),Ht=this.addDaysIso(Lt,Ut),Vt=this.isoToCalendarDate(Ht,xt),zt=this.addDaysIso(Ht,-Vt.day);return this.isoToCalendarDate(zt,xt).day}daysInPreviousMonth(At,xt){const{day:Bt,month:Nt,year:jt}=At;let Ut={year:Nt>1?jt:jt-1,month:Nt,day:1};const Lt=Nt>1?Nt-1:this.monthsInYear(Ut,xt);Ut={...Ut,month:Lt};const Ht=this.minimumMonthLength(Ut),Vt=this.maximumMonthLength(Ut);if(Ht===Vt)return Vt;const zt=this.calendarToIsoDate(At,"constrain",xt),Wt=this.addDaysIso(zt,-Bt);return this.isoToCalendarDate(Wt,xt).day}startOfCalendarYear(At){return{year:At.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(At){return{year:At.year,month:At.month,day:1}}calendarDaysUntil(At,xt,Bt){const Nt=this.calendarToIsoDate(At,"constrain",Bt),jt=this.calendarToIsoDate(xt,"constrain",Bt);return this.isoDaysUntil(Nt,jt)}isoDaysUntil(At,xt){return DifferenceISODate(At.year,At.month,At.day,xt.year,xt.month,xt.day,"day").days}monthDayFromFields(At,xt,Bt){let Nt,jt,Ut,Lt,Ht,{monthCode:Vt,day:zt}=At;if(Vt===void 0){let{year:Qt,era:Xt,eraYear:tr}=At;if(Qt===void 0&&(Xt===void 0||tr===void 0))throw new TypeError("when `monthCode` is omitted, `year` (or `era` and `eraYear`) and `month` are required");({monthCode:Vt,day:zt}=this.isoToCalendarDate(this.calendarToIsoDate(At,xt,Bt),Bt))}const Wt=this.isoToCalendarDate({year:1972,month:12,day:31},Bt),Jt=Wt.monthCode>Vt||Wt.monthCode===Vt&&Wt.day>=zt?Wt.year:Wt.year-1;for(let Qt=0;Qt<100;Qt++){const Xt=this.adjustCalendarDate({day:zt,monthCode:Vt,year:Jt-Qt},Bt),tr=this.calendarToIsoDate(Xt,"constrain",Bt),rr=this.isoToCalendarDate(tr,Bt);if({year:Nt,month:jt,day:Ut}=tr,rr.monthCode===Vt&&rr.day===zt)return{month:jt,day:Ut,year:Nt};xt==="constrain"&&(Lt===void 0||rr.monthCode===Lt.monthCode&&rr.day>Lt.day)&&(Lt=rr,Ht=tr)}if(xt==="constrain"&&Ht!==void 0)return Ht;throw new RangeError(`No recent ${this.id} year with monthCode ${Vt} and day ${zt}`)}}class HebrewHelper extends HelperBase{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}},this.hasEra=!1}inLeapYear(At){const{year:xt}=At;return(7*xt+1)%19<7}monthsInYear(At){return this.inLeapYear(At)?13:12}minimumMonthLength(At){return this.minMaxMonthLength(At,"min")}maximumMonthLength(At){return this.minMaxMonthLength(At,"max")}minMaxMonthLength(At,xt){const{month:Bt,year:Nt}=At,jt=this.getMonthCode(Nt,Bt),Ut=wt(this.months).find(Ht=>Ht[1].monthCode===jt);if(Ut===void 0)throw new RangeError(`unmatched Hebrew month: ${Bt}`);const Lt=Ut[1].days;return typeof Lt=="number"?Lt:Lt[xt]}estimateIsoDate(At){const{year:xt}=At;return{year:xt-3760,month:1,day:1}}getMonthCode(At,xt){return this.inLeapYear({year:At})?xt===6?buildMonthCode(5,!0):buildMonthCode(xt<6?xt:xt-1):buildMonthCode(xt)}adjustCalendarDate(At,xt,Bt="constrain",Nt=!1){let{year:jt,eraYear:Ut,month:Lt,monthCode:Ht,day:Vt,monthExtra:zt}=At;if(jt===void 0&&Ut!==void 0&&(jt=Ut),Ut===void 0&&jt!==void 0&&(Ut=jt),Nt){if(zt){const Wt=this.months[zt];if(!Wt)throw new RangeError(`Unrecognized month from formatToParts: ${zt}`);Lt=this.inLeapYear({year:jt})?Wt.leap:Wt.regular}return Ht=this.getMonthCode(jt,Lt),{year:jt,month:Lt,day:Vt,era:void 0,eraYear:Ut,monthCode:Ht}}if(this.validateCalendarDate(At),Lt===void 0)if(Ht.endsWith("L")){if(Ht!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${Ht}`);if(Lt=6,!this.inLeapYear({year:jt})){if(Bt==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${jt} which is not a leap year`);Lt=6,Ht="M06"}}else{Lt=monthCodeNumberPart(Ht),this.inLeapYear({year:jt})&&Lt>=6&&Lt++;const Wt=this.monthsInYear({year:jt});if(Lt<1||Lt>Wt)throw new RangeError(`Invalid monthCode: ${Ht}`)}else if(Bt==="reject"?(RejectToRange(Lt,1,this.monthsInYear({year:jt})),RejectToRange(Vt,1,this.maximumMonthLength({year:jt,month:Lt}))):(Lt=ConstrainToRange(Lt,1,this.monthsInYear({year:jt})),Vt=ConstrainToRange(Vt,1,this.maximumMonthLength({year:jt,month:Lt}))),Ht===void 0)Ht=this.getMonthCode(jt,Lt);else if(this.getMonthCode(jt,Lt)!==Ht)throw new RangeError(`monthCode ${Ht} doesn't correspond to month ${Lt} in Hebrew year ${jt}`);return{...At,day:Vt,month:Lt,monthCode:Ht,year:jt,eraYear:Ut}}}class IslamicBaseHelper extends HelperBase{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425,this.constantEra="ah"}inLeapYear(At,xt){return this.daysInMonth({year:At.year,month:12,day:1},xt)===30}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}estimateIsoDate(At){const{year:xt}=this.adjustCalendarDate(At);return{year:St(xt*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class IslamicHelper extends IslamicBaseHelper{constructor(){super(...arguments),this.id="islamic"}}class IslamicUmalquraHelper extends IslamicBaseHelper{constructor(){super(...arguments),this.id="islamic-umalqura"}}class IslamicTblaHelper extends IslamicBaseHelper{constructor(){super(...arguments),this.id="islamic-tbla"}}class IslamicCivilHelper extends IslamicBaseHelper{constructor(){super(...arguments),this.id="islamic-civil"}}class IslamicRgsaHelper extends IslamicBaseHelper{constructor(){super(...arguments),this.id="islamic-rgsa"}}class IslamicCcHelper extends IslamicBaseHelper{constructor(){super(...arguments),this.id="islamicc"}}class PersianHelper extends HelperBase{constructor(){super(...arguments),this.id="persian",this.calendarType="solar",this.constantEra="ap"}inLeapYear(At,xt){return IslamicHelper.prototype.inLeapYear.call(this,At,xt)}monthsInYear(){return 12}minimumMonthLength(At){const{month:xt}=At;return xt===12?29:xt<=6?31:30}maximumMonthLength(At){const{month:xt}=At;return xt===12?30:xt<=6?31:30}estimateIsoDate(At){const{year:xt}=this.adjustCalendarDate(At);return{year:xt+621,month:1,day:1}}}class IndianHelper extends HelperBase{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.constantEra="saka",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(At){return isGregorianLeapYear(At.year+78)}monthsInYear(){return 12}minimumMonthLength(At){return this.getMonthInfo(At).length}maximumMonthLength(At){return this.getMonthInfo(At).length}getMonthInfo(At){const{month:xt}=At;let Bt=this.months[xt];if(Bt===void 0)throw new RangeError(`Invalid month: ${xt}`);return this.inLeapYear(At)&&Bt.leap&&(Bt=Bt.leap),Bt}estimateIsoDate(At){const xt=this.adjustCalendarDate(At),Bt=this.getMonthInfo(xt);return AddISODate(xt.year+78+(Bt.nextYear?1:0),Bt.month,Bt.day,0,0,0,xt.day-1,"constrain")}checkIcuBugs(At){if(this.vulnerableToBceBug&&At.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function isGregorianLeapYear(kt){return kt%4==0&&(kt%100!=0||kt%400==0)}class GregorianBaseHelper extends HelperBase{constructor(At,xt){super(),this.calendarType="solar",this.v8IsVulnerableToJulianBug=new Date("+001001-01-01T00:00Z").toLocaleDateString("en-US-u-ca-japanese",{timeZone:"UTC"}).startsWith("12"),this.calendarIsVulnerableToJulianBug=!1,this.id=At;const{eras:Bt,anchorEra:Nt}=function(Ut){let Lt,Ht=Ut;if(Ht.length===0)throw new RangeError("Invalid era data: eras are required");if(Ht.length===1&&Ht[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(Ht.length===1&&!Ht[0].name)throw new RangeError("Invalid era data: at least one named era is required");if(Ht.filter(zt=>zt.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");Ht.forEach(zt=>{if(zt.isAnchor||!zt.anchorEpoch&&!zt.reverseOf){if(Lt)throw new RangeError("Invalid era data: cannot have multiple anchor eras");Lt=zt,zt.anchorEpoch={year:zt.hasYearZero?0:1}}else if(!zt.name)throw new RangeError("If era name is blank, it must be the anchor era")}),Ht=Ht.filter(zt=>zt.name),Ht.forEach(zt=>{const{reverseOf:Wt}=zt;if(Wt){const Jt=Ht.find(Qt=>Qt.name===Wt);if(Jt===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${Wt}`);zt.reverseOf=Jt,zt.anchorEpoch=Jt.anchorEpoch,zt.isoEpoch=Jt.isoEpoch}zt.anchorEpoch.month===void 0&&(zt.anchorEpoch.month=1),zt.anchorEpoch.day===void 0&&(zt.anchorEpoch.day=1)}),yt.call(Ht,(zt,Wt)=>{if(zt.reverseOf)return 1;if(Wt.reverseOf)return-1;if(!zt.isoEpoch||!Wt.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return Wt.isoEpoch.year-zt.isoEpoch.year});const Vt=Ht[Ht.length-1].reverseOf;if(Vt&&Vt!==Ht[Ht.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return Ht.forEach((zt,Wt)=>{zt.genericName="era"+(Ht.length-1-Wt)}),{eras:Ht,anchorEra:Lt||Ht[0]}}(xt);this.anchorEra=Nt,this.eras=Bt}inLeapYear(At){const{year:xt}=this.estimateIsoDate({month:1,day:1,year:At.year});return isGregorianLeapYear(xt)}monthsInYear(){return 12}minimumMonthLength(At){const{month:xt}=At;return xt===2?this.inLeapYear(At)?29:28:[4,6,9,11].indexOf(xt)>=0?30:31}maximumMonthLength(At){return this.minimumMonthLength(At)}completeEraYear(At){const xt=(Lt,Ht)=>{const Vt=At[Lt];if(Vt!=null&&Vt!=Ht)throw new RangeError(`Input ${Lt} ${Vt} doesn't match calculated value ${Ht}`)},Bt=Lt=>{let Ht;const Vt={...At,year:Lt},zt=this.eras.find((Wt,Jt)=>{if(Jt===this.eras.length-1){if(Wt.reverseOf){if(Lt>0)throw new RangeError(`Signed year ${Lt} is invalid for era ${Wt.name}`);return Ht=Wt.anchorEpoch.year-Lt,!0}return Ht=Lt-Wt.anchorEpoch.year+(Wt.hasYearZero?0:1),!0}return this.compareCalendarDates(Vt,Wt.anchorEpoch)>=0&&(Ht=Lt-Wt.anchorEpoch.year+(Wt.hasYearZero?0:1),!0)});if(!zt)throw new RangeError(`Year ${Lt} was not matched by any era`);return{eraYear:Ht,era:zt.name}};let{year:Nt,eraYear:jt,era:Ut}=At;if(Nt!=null)({eraYear:jt,era:Ut}=Bt(Nt)),xt("era",Ut),xt("eraYear",jt);else{if(jt==null)throw new RangeError("Either `year` or `eraYear` and `era` are required");{const Lt=Ut===void 0?void 0:this.eras.find(Ht=>Ht.name===Ut||Ht.genericName===Ut);if(!Lt)throw new RangeError(`Era ${Ut} (ISO year ${jt}) was not matched by any era`);if(jt<1&&Lt.reverseOf)throw new RangeError(`Years in ${Ut} era must be positive, not ${Nt}`);Nt=Lt.reverseOf?Lt.anchorEpoch.year-jt:jt+Lt.anchorEpoch.year-(Lt.hasYearZero?0:1),xt("year",Nt),{eraYear:jt,era:Ut}=Bt(Nt)}}return{...At,year:Nt,eraYear:jt,era:Ut}}adjustCalendarDate(At,xt,Bt="constrain"){let Nt=At;const{month:jt,monthCode:Ut}=Nt;return jt===void 0&&(Nt={...Nt,month:monthCodeNumberPart(Ut)}),this.validateCalendarDate(Nt),Nt=this.completeEraYear(Nt),super.adjustCalendarDate(Nt,xt,Bt)}estimateIsoDate(At){const xt=this.adjustCalendarDate(At),{year:Bt,month:Nt,day:jt}=xt,{anchorEra:Ut}=this;return RegulateISODate(Bt+Ut.isoEpoch.year-(Ut.hasYearZero?0:1),Nt,jt,"constrain")}checkIcuBugs(At){if(this.calendarIsVulnerableToJulianBug&&this.v8IsVulnerableToJulianBug&&CompareISODate(At.year,At.month,At.day,1582,10,15)<0)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 1582-10-15 (see https://bugs.chromium.org/p/chromium/issues/detail?id=1173158)`)}}class OrthodoxBaseHelper extends GregorianBaseHelper{constructor(At,xt){super(At,xt)}inLeapYear(At){const{year:xt}=At;return(xt+1)%4==0}monthsInYear(){return 13}minimumMonthLength(At){const{month:xt}=At;return xt===13?this.inLeapYear(At)?6:5:30}maximumMonthLength(At){return this.minimumMonthLength(At)}}class EthioaaHelper extends OrthodoxBaseHelper{constructor(){super("ethioaa",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}}])}}class CopticHelper extends OrthodoxBaseHelper{constructor(){super("coptic",[{name:"era1",isoEpoch:{year:284,month:8,day:29}},{name:"era0",reverseOf:"era1"}])}}class EthiopicHelper extends OrthodoxBaseHelper{constructor(){super("ethiopic",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}},{name:"era1",isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class RocHelper extends GregorianBaseHelper{constructor(){super("roc",[{name:"minguo",isoEpoch:{year:1912,month:1,day:1}},{name:"before-roc",reverseOf:"minguo"}]),this.calendarIsVulnerableToJulianBug=!0}}class BuddhistHelper extends GregorianBaseHelper{constructor(){super("buddhist",[{name:"be",hasYearZero:!0,isoEpoch:{year:-543,month:1,day:1}}]),this.calendarIsVulnerableToJulianBug=!0}}class GregoryHelper extends GregorianBaseHelper{constructor(){super("gregory",[{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}])}reviseIntlEra(At){let{era:xt,eraYear:Bt}=At;return xt!=="bc"&&xt!=="b"||(xt="bce"),xt!=="ad"&&xt!=="a"||(xt="ce"),{era:xt,eraYear:Bt}}}class JapaneseHelper extends GregorianBaseHelper{constructor(){super("japanese",[{name:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{name:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{name:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{name:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{name:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}]),this.calendarIsVulnerableToJulianBug=!0,this.eraLength="long",this.erasBeginMidYear=!0}reviseIntlEra(At,xt){const{era:Bt,eraYear:Nt}=At,{year:jt}=xt;return this.eras.find(Ut=>Ut.name===Bt)?{era:Bt,eraYear:Nt}:jt<1?{era:"bce",eraYear:1-jt}:{era:"ce",eraYear:jt}}}class ChineseBaseHelper extends HelperBase{constructor(){super(...arguments),this.calendarType="lunisolar",this.hasEra=!1}inLeapYear(At,xt){const Bt=this.getMonthList(At.year,xt);return wt(Bt).length===13}monthsInYear(At,xt){return this.inLeapYear(At,xt)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}getMonthList(At,xt){if(At===void 0)throw new TypeError("Missing year");const Bt=JSON.stringify({func:"getMonthList",calendarYear:At,id:this.id}),Nt=xt.get(Bt);if(Nt)return Nt;const jt=this.getFormatter(),Ut=(rr,nr)=>{const ar=toUtcIsoDateString({isoYear:rr,isoMonth:2,isoDay:1}),ir=new Date(ar);ir.setUTCDate(nr+1);const lr=jt.formatToParts(ir),yr=lr.find(Dr=>Dr.type==="month").value,Sr=+lr.find(Dr=>Dr.type==="day").value;let Ar=lr.find(Dr=>Dr.type==="relatedYear");if(Ar===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return Ar=+Ar.value,{calendarMonthString:yr,calendarDay:Sr,calendarYearToVerify:Ar}};let Lt=17,{calendarMonthString:Ht,calendarDay:Vt,calendarYearToVerify:zt}=Ut(At,Lt);Ht!=="1"&&(Lt+=29,{calendarMonthString:Ht,calendarDay:Vt}=Ut(At,Lt)),Lt-=Vt-5;const Wt={};let Jt,Qt,Xt=1,tr=!1;do({calendarMonthString:Ht,calendarDay:Vt,calendarYearToVerify:zt}=Ut(At,Lt)),Jt&&(Wt[Qt].daysInMonth=Jt+30-Vt),zt!==At?tr=!0:(Wt[Ht]={monthIndex:Xt++},Lt+=30),Jt=Vt,Qt=Ht;while(!tr);return Wt[Qt].daysInMonth=Jt+30-Vt,xt.set(Bt,Wt),Wt}estimateIsoDate(At){const{year:xt,month:Bt}=At;return{year:xt,month:Bt>=12?12:Bt+1,day:1}}adjustCalendarDate(At,xt,Bt="constrain",Nt=!1){let{year:jt,month:Ut,monthExtra:Lt,day:Ht,monthCode:Vt,eraYear:zt}=At;if(Nt){if(jt=zt,Lt&&Lt!=="bis")throw new RangeError(`Unexpected leap month suffix: ${Lt}`);const Wt=buildMonthCode(Ut,Lt!==void 0),Jt=`${Ut}${Lt||""}`,Qt=this.getMonthList(jt,xt)[Jt];if(Qt===void 0)throw new RangeError(`Unmatched month ${Jt} in Chinese year ${jt}`);return Ut=Qt.monthIndex,{year:jt,month:Ut,day:Ht,era:void 0,eraYear:zt,monthCode:Wt}}if(this.validateCalendarDate(At),jt===void 0&&(jt=zt),zt===void 0&&(zt=jt),Ut===void 0){const Wt=this.getMonthList(jt,xt);let Jt=Vt.replace("L","bis").slice(1);Jt[0]==="0"&&(Jt=Jt.slice(1));let Qt=Wt[Jt];if(Ut=Qt&&Qt.monthIndex,Ut===void 0&&Vt.endsWith("L")&&Vt!="M13L"&&Bt==="constrain"){let Xt=Vt.slice(1,-1);Xt[0]==="0"&&(Xt=Xt.slice(1)),Qt=Wt[Xt],Qt&&(Ut=Qt.monthIndex,Vt=buildMonthCode(Xt))}if(Ut===void 0)throw new RangeError(`Unmatched month ${Vt} in Chinese year ${jt}`)}else if(Vt===void 0){const Wt=this.getMonthList(jt,xt),Jt=wt(Wt),Qt=Jt.length;Bt==="reject"?(RejectToRange(Ut,1,Qt),RejectToRange(Ht,1,this.maximumMonthLength())):(Ut=ConstrainToRange(Ut,1,Qt),Ht=ConstrainToRange(Ht,1,this.maximumMonthLength()));const Xt=Jt.find(([,tr])=>tr.monthIndex===Ut);if(Xt===void 0)throw new RangeError(`Invalid month ${Ut} in Chinese year ${jt}`);Vt=buildMonthCode(Xt[0].replace("bis",""),Xt[0].indexOf("bis")!==-1)}else{const Wt=this.getMonthList(jt,xt);let Jt=Vt.replace("L","bis").slice(1);Jt[0]==="0"&&(Jt=Jt.slice(1));const Qt=Wt[Jt];if(!Qt)throw new RangeError(`Unmatched monthCode ${Vt} in Chinese year ${jt}`);if(Ut!==Qt.monthIndex)throw new RangeError(`monthCode ${Vt} doesn't correspond to month ${Ut} in Chinese year ${jt}`)}return{...At,year:jt,eraYear:zt,month:Ut,monthCode:Vt,day:Ht}}}class ChineseHelper extends ChineseBaseHelper{constructor(){super(...arguments),this.id="chinese"}}class DangiHelper extends ChineseBaseHelper{constructor(){super(...arguments),this.id="dangi"}}class NonIsoCalendar{constructor(At){this.helper=At}dateFromFields(At,xt,Bt){const Nt=new OneObjectCache,jt=PrepareTemporalFields(At,this.fields(["day","month","monthCode","year"]),[]),Ut=ToTemporalOverflow(xt),{year:Lt,month:Ht,day:Vt}=this.helper.calendarToIsoDate(jt,Ut,Nt),zt=CreateTemporalDate(Lt,Ht,Vt,Bt);return Nt.setObject(zt),zt}yearMonthFromFields(At,xt,Bt){const Nt=new OneObjectCache,jt=PrepareTemporalFields(At,this.fields(["month","monthCode","year"]),[]),Ut=ToTemporalOverflow(xt),{year:Lt,month:Ht,day:Vt}=this.helper.calendarToIsoDate({...jt,day:1},Ut,Nt),zt=CreateTemporalYearMonth(Lt,Ht,Bt,Vt);return Nt.setObject(zt),zt}monthDayFromFields(At,xt,Bt){const Nt=new OneObjectCache,jt=PrepareTemporalFields(At,this.fields(["day","month","monthCode","year"]),[]),Ut=ToTemporalOverflow(xt),{year:Lt,month:Ht,day:Vt}=this.helper.monthDayFromFields(jt,Ut,Nt),zt=CreateTemporalMonthDay(Ht,Vt,Bt,Lt);return Nt.setObject(zt),zt}fields(At){let xt=At;return Tt.call(xt,"year")&&(xt=[...xt,"era","eraYear"]),xt}fieldKeysToIgnore(At){const xt=new Dt;for(let Bt=0;Bt<At.length;Bt++){const Nt=At[Bt];switch(Call(vt,xt,[Nt]),Nt){case"era":Call(vt,xt,["eraYear"]),Call(vt,xt,["year"]);break;case"eraYear":Call(vt,xt,["era"]),Call(vt,xt,["year"]);break;case"year":Call(vt,xt,["era"]),Call(vt,xt,["eraYear"]);break;case"month":Call(vt,xt,["monthCode"]),this.helper.erasBeginMidYear&&(Call(vt,xt,["era"]),Call(vt,xt,["eraYear"]));break;case"monthCode":Call(vt,xt,["month"]),this.helper.erasBeginMidYear&&(Call(vt,xt,["era"]),Call(vt,xt,["eraYear"]));break;case"day":this.helper.erasBeginMidYear&&(Call(vt,xt,["era"]),Call(vt,xt,["eraYear"]))}}return[...Call(Ct,xt,[])]}dateAdd(At,xt,Bt,Nt,jt,Ut,Lt){const Ht=OneObjectCache.getCacheForObject(At),Vt=this.helper.temporalToCalendarDate(At,Ht),zt=this.helper.addCalendar(Vt,{years:xt,months:Bt,weeks:Nt,days:jt},Ut,Ht),Wt=this.helper.calendarToIsoDate(zt,"constrain",Ht),{year:Jt,month:Qt,day:Xt}=Wt,tr=CreateTemporalDate(Jt,Qt,Xt,Lt);return new OneObjectCache(Ht).setObject(tr),tr}dateUntil(At,xt,Bt){const Nt=OneObjectCache.getCacheForObject(At),jt=OneObjectCache.getCacheForObject(xt),Ut=this.helper.temporalToCalendarDate(At,Nt),Lt=this.helper.temporalToCalendarDate(xt,jt);return this.helper.untilCalendar(Ut,Lt,Bt,Nt)}year(At){const xt=OneObjectCache.getCacheForObject(At);return this.helper.temporalToCalendarDate(At,xt).year}month(At){const xt=OneObjectCache.getCacheForObject(At);return this.helper.temporalToCalendarDate(At,xt).month}day(At){const xt=OneObjectCache.getCacheForObject(At);return this.helper.temporalToCalendarDate(At,xt).day}era(At){if(!this.helper.hasEra)return;const xt=OneObjectCache.getCacheForObject(At);return this.helper.temporalToCalendarDate(At,xt).era}eraYear(At){if(!this.helper.hasEra)return;const xt=OneObjectCache.getCacheForObject(At);return this.helper.temporalToCalendarDate(At,xt).eraYear}monthCode(At){const xt=OneObjectCache.getCacheForObject(At);return this.helper.temporalToCalendarDate(At,xt).monthCode}dayOfWeek(At){return Ot.iso8601.dayOfWeek(At)}dayOfYear(At){const xt=OneObjectCache.getCacheForObject(At),Bt=this.helper.isoToCalendarDate(At,xt),Nt=this.helper.startOfCalendarYear(Bt);return this.helper.calendarDaysUntil(Nt,Bt,xt)+1}weekOfYear(At){return Ot.iso8601.weekOfYear(At)}yearOfWeek(At){return Ot.iso8601.yearOfWeek(At)}daysInWeek(At){return Ot.iso8601.daysInWeek(At)}daysInMonth(At){const xt=OneObjectCache.getCacheForObject(At),Bt=this.helper.temporalToCalendarDate(At,xt),Nt=this.helper.maximumMonthLength(Bt);if(Nt===this.helper.minimumMonthLength(Bt))return Nt;const jt=this.helper.startOfCalendarMonth(Bt),Ut=this.helper.addMonthsCalendar(jt,1,"constrain",xt);return this.helper.calendarDaysUntil(jt,Ut,xt)}daysInYear(At){let xt=At;HasSlot(xt,i$3)||(xt=ToTemporalDate(xt));const Bt=OneObjectCache.getCacheForObject(xt),Nt=this.helper.temporalToCalendarDate(xt,Bt),jt=this.helper.startOfCalendarYear(Nt),Ut=this.helper.addCalendar(jt,{years:1},"constrain",Bt);return this.helper.calendarDaysUntil(jt,Ut,Bt)}monthsInYear(At){const xt=OneObjectCache.getCacheForObject(At),Bt=this.helper.temporalToCalendarDate(At,xt);return this.helper.monthsInYear(Bt,xt)}inLeapYear(At){let xt=At;HasSlot(xt,i$3)||(xt=ToTemporalDate(xt));const Bt=OneObjectCache.getCacheForObject(xt),Nt=this.helper.temporalToCalendarDate(xt,Bt);return this.helper.inLeapYear(Nt,Bt)}}for(const kt of[HebrewHelper,PersianHelper,EthiopicHelper,EthioaaHelper,CopticHelper,ChineseHelper,DangiHelper,RocHelper,IndianHelper,BuddhistHelper,GregoryHelper,JapaneseHelper,IslamicHelper,IslamicUmalquraHelper,IslamicTblaHelper,IslamicCivilHelper,IslamicRgsaHelper,IslamicCcHelper]){const At=new kt;Ot[At.id]=new NonIsoCalendar(At)}class PlainDate{constructor(At,xt,Bt,Nt="iso8601"){CreateTemporalDateSlots(this,ToIntegerWithTruncation(At),ToIntegerWithTruncation(xt),ToIntegerWithTruncation(Bt),ToTemporalCalendarSlotValue(Nt))}get calendarId(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return ToTemporalCalendarIdentifier(GetSlot(this,p))}get era(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarEra(GetSlot(this,p),this)}get eraYear(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarEraYear(GetSlot(this,p),this)}get year(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarYear(GetSlot(this,p),this)}get month(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarMonth(GetSlot(this,p),this)}get monthCode(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarMonthCode(GetSlot(this,p),this)}get day(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarDay(GetSlot(this,p),this)}get dayOfWeek(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarDayOfWeek(GetSlot(this,p),this)}get dayOfYear(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarDayOfYear(GetSlot(this,p),this)}get weekOfYear(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarWeekOfYear(GetSlot(this,p),this)}get yearOfWeek(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarYearOfWeek(GetSlot(this,p),this)}get daysInWeek(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarDaysInWeek(GetSlot(this,p),this)}get daysInMonth(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarDaysInMonth(GetSlot(this,p),this)}get daysInYear(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarDaysInYear(GetSlot(this,p),this)}get monthsInYear(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarMonthsInYear(GetSlot(this,p),this)}get inLeapYear(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return CalendarInLeapYear(GetSlot(this,p),this)}with(At,xt){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument");RejectTemporalLikeObject(At);const Bt=GetOptionsObject(xt),Nt=GetSlot(this,p),jt=CalendarFields(Nt,["day","month","monthCode","year"]);let Ut=PrepareTemporalFields(this,jt,[]);return Ut=CalendarMergeFields(Nt,Ut,PrepareTemporalFields(At,jt,"partial")),Ut=PrepareTemporalFields(Ut,jt,[]),CalendarDateFromFields(Nt,Ut,Bt)}withCalendar(At){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const xt=ToTemporalCalendarSlotValue(At);return new PlainDate(GetSlot(this,i$3),GetSlot(this,s$2),GetSlot(this,l),xt)}add(At,xt){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const Bt=ToTemporalDuration(At),Nt=GetOptionsObject(xt);return CalendarDateAdd(GetSlot(this,p),this,Bt,Nt)}subtract(At,xt){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const Bt=CreateNegatedTemporalDuration(ToTemporalDuration(At)),Nt=GetOptionsObject(xt);return CalendarDateAdd(GetSlot(this,p),this,Bt,Nt)}until(At,xt){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainDate("until",this,At,xt)}since(At,xt){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainDate("since",this,At,xt)}equals(At){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At);for(const Bt of[i$3,s$2,l])if(GetSlot(this,Bt)!==GetSlot(xt,Bt))return!1;return CalendarEquals(GetSlot(this,p),GetSlot(xt,p))}toString(At){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return TemporalDateToString(this,ToCalendarNameOption(GetOptionsObject(At)))}toJSON(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return TemporalDateToString(this)}toLocaleString(At,xt){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return new ht(At,xt).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDate")}toPlainDateTime(At){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const xt=GetSlot(this,i$3),Bt=GetSlot(this,s$2),Nt=GetSlot(this,l),jt=GetSlot(this,p);if(At===void 0)return CreateTemporalDateTime(xt,Bt,Nt,0,0,0,0,0,0,jt);const Ut=ToTemporalTime(At);return CreateTemporalDateTime(xt,Bt,Nt,GetSlot(Ut,d$1),GetSlot(Ut,m$1),GetSlot(Ut,c),GetSlot(Ut,h$1),GetSlot(Ut,u),GetSlot(Ut,T),jt)}toZonedDateTime(At){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");let xt,Bt;if(IsObject(At))if(IsTemporalTimeZone(At))xt=At;else{const Xt=At.timeZone;Xt===void 0?xt=ToTemporalTimeZoneSlotValue(At):(xt=ToTemporalTimeZoneSlotValue(Xt),Bt=At.plainTime)}else xt=ToTemporalTimeZoneSlotValue(At);const Nt=GetSlot(this,i$3),jt=GetSlot(this,s$2),Ut=GetSlot(this,l),Lt=GetSlot(this,p);let Ht=0,Vt=0,zt=0,Wt=0,Jt=0,Qt=0;return Bt!==void 0&&(Bt=ToTemporalTime(Bt),Ht=GetSlot(Bt,d$1),Vt=GetSlot(Bt,m$1),zt=GetSlot(Bt,c),Wt=GetSlot(Bt,h$1),Jt=GetSlot(Bt,u),Qt=GetSlot(Bt,T)),CreateTemporalZonedDateTime(GetSlot(GetInstantFor(xt,CreateTemporalDateTime(Nt,jt,Ut,Ht,Vt,zt,Wt,Jt,Qt,Lt),"compatible"),n),xt,Lt)}toPlainYearMonth(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const At=GetSlot(this,p);return CalendarYearMonthFromFields(At,PrepareTemporalFields(this,CalendarFields(At,["monthCode","year"]),[]))}toPlainMonthDay(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");const At=GetSlot(this,p);return CalendarMonthDayFromFields(At,PrepareTemporalFields(this,CalendarFields(At,["day","monthCode"]),[]))}getISOFields(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return{calendar:GetSlot(this,p),isoDay:GetSlot(this,l),isoMonth:GetSlot(this,s$2),isoYear:GetSlot(this,i$3)}}getCalendar(){if(!IsTemporalDate(this))throw new TypeError("invalid receiver");return ToTemporalCalendarObject(GetSlot(this,p))}static from(At,xt){const Bt=GetOptionsObject(xt);return IsTemporalDate(At)?(ToTemporalOverflow(Bt),CreateTemporalDate(GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),GetSlot(At,p))):ToTemporalDate(At,Bt)}static compare(At,xt){const Bt=ToTemporalDate(At),Nt=ToTemporalDate(xt);return CompareISODate(GetSlot(Bt,i$3),GetSlot(Bt,s$2),GetSlot(Bt,l),GetSlot(Nt,i$3),GetSlot(Nt,s$2),GetSlot(Nt,l))}}MakeIntrinsicClass(PlainDate,"Temporal.PlainDate");class PlainDateTime{constructor(At,xt,Bt,Nt=0,jt=0,Ut=0,Lt=0,Ht=0,Vt=0,zt="iso8601"){CreateTemporalDateTimeSlots(this,ToIntegerWithTruncation(At),ToIntegerWithTruncation(xt),ToIntegerWithTruncation(Bt),Nt===void 0?0:ToIntegerWithTruncation(Nt),jt===void 0?0:ToIntegerWithTruncation(jt),Ut===void 0?0:ToIntegerWithTruncation(Ut),Lt===void 0?0:ToIntegerWithTruncation(Lt),Ht===void 0?0:ToIntegerWithTruncation(Ht),Vt===void 0?0:ToIntegerWithTruncation(Vt),ToTemporalCalendarSlotValue(zt))}get calendarId(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return ToTemporalCalendarIdentifier(GetSlot(this,p))}get year(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarYear(GetSlot(this,p),this)}get month(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarMonth(GetSlot(this,p),this)}get monthCode(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarMonthCode(GetSlot(this,p),this)}get day(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarDay(GetSlot(this,p),this)}get hour(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return GetSlot(this,d$1)}get minute(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return GetSlot(this,m$1)}get second(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return GetSlot(this,c)}get millisecond(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return GetSlot(this,h$1)}get microsecond(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return GetSlot(this,u)}get nanosecond(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return GetSlot(this,T)}get era(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarEra(GetSlot(this,p),this)}get eraYear(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarEraYear(GetSlot(this,p),this)}get dayOfWeek(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarDayOfWeek(GetSlot(this,p),this)}get dayOfYear(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarDayOfYear(GetSlot(this,p),this)}get weekOfYear(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarWeekOfYear(GetSlot(this,p),this)}get yearOfWeek(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarYearOfWeek(GetSlot(this,p),this)}get daysInWeek(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarDaysInWeek(GetSlot(this,p),this)}get daysInYear(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarDaysInYear(GetSlot(this,p),this)}get daysInMonth(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarDaysInMonth(GetSlot(this,p),this)}get monthsInYear(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarMonthsInYear(GetSlot(this,p),this)}get inLeapYear(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return CalendarInLeapYear(GetSlot(this,p),this)}with(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument");RejectTemporalLikeObject(At);const Bt=GetOptionsObject(xt),Nt=GetSlot(this,p),jt=CalendarFields(Nt,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);let Ut=PrepareTemporalFields(this,jt,[]);Ut=CalendarMergeFields(Nt,Ut,PrepareTemporalFields(At,jt,"partial")),Ut=PrepareTemporalFields(Ut,jt,[]);const{year:Lt,month:Ht,day:Vt,hour:zt,minute:Wt,second:Jt,millisecond:Qt,microsecond:Xt,nanosecond:tr}=InterpretTemporalDateTimeFields(Nt,Ut,Bt);return CreateTemporalDateTime(Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,Nt)}withPlainTime(At){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const xt=GetSlot(this,i$3),Bt=GetSlot(this,s$2),Nt=GetSlot(this,l),jt=GetSlot(this,p);if(At===void 0)return CreateTemporalDateTime(xt,Bt,Nt,0,0,0,0,0,0,jt);const Ut=ToTemporalTime(At);return CreateTemporalDateTime(xt,Bt,Nt,GetSlot(Ut,d$1),GetSlot(Ut,m$1),GetSlot(Ut,c),GetSlot(Ut,h$1),GetSlot(Ut,u),GetSlot(Ut,T),jt)}withPlainDate(At){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At),Bt=GetSlot(xt,i$3),Nt=GetSlot(xt,s$2),jt=GetSlot(xt,l);let Ut=GetSlot(xt,p);const Lt=GetSlot(this,d$1),Ht=GetSlot(this,m$1),Vt=GetSlot(this,c),zt=GetSlot(this,h$1),Wt=GetSlot(this,u),Jt=GetSlot(this,T);return Ut=ConsolidateCalendars(GetSlot(this,p),Ut),CreateTemporalDateTime(Bt,Nt,jt,Lt,Ht,Vt,zt,Wt,Jt,Ut)}withCalendar(At){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalCalendarSlotValue(At);return new PlainDateTime(GetSlot(this,i$3),GetSlot(this,s$2),GetSlot(this,l),GetSlot(this,d$1),GetSlot(this,m$1),GetSlot(this,c),GetSlot(this,h$1),GetSlot(this,u),GetSlot(this,T),xt)}add(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromPlainDateTime("add",this,At,xt)}subtract(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromPlainDateTime("subtract",this,At,xt)}until(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainDateTime("until",this,At,xt)}since(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainDateTime("since",this,At,xt)}round(At){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");if(At===void 0)throw new TypeError("options parameter is required");const xt=typeof At=="string"?CreateOnePropObject("smallestUnit",At):GetOptionsObject(At),Bt=ToTemporalRoundingIncrement(xt),Nt=ToTemporalRoundingMode(xt,"halfExpand"),jt=GetTemporalUnit(xt,"smallestUnit","time",He,["day"]),Ut={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[jt];ValidateTemporalRoundingIncrement(Bt,Ut,Ut===1);let Lt=GetSlot(this,i$3),Ht=GetSlot(this,s$2),Vt=GetSlot(this,l),zt=GetSlot(this,d$1),Wt=GetSlot(this,m$1),Jt=GetSlot(this,c),Qt=GetSlot(this,h$1),Xt=GetSlot(this,u),tr=GetSlot(this,T);return{year:Lt,month:Ht,day:Vt,hour:zt,minute:Wt,second:Jt,millisecond:Qt,microsecond:Xt,nanosecond:tr}=RoundISODateTime(Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,Bt,jt,Nt),CreateTemporalDateTime(Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,GetSlot(this,p))}equals(At){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalDateTime(At);for(const Bt of[i$3,s$2,l,d$1,m$1,c,h$1,u,T])if(GetSlot(this,Bt)!==GetSlot(xt,Bt))return!1;return CalendarEquals(GetSlot(this,p),GetSlot(xt,p))}toString(At){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const xt=GetOptionsObject(At),Bt=ToCalendarNameOption(xt),Nt=ToFractionalSecondDigits(xt),jt=ToTemporalRoundingMode(xt,"trunc"),Ut=GetTemporalUnit(xt,"smallestUnit","time",void 0);if(Ut==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:Lt,unit:Ht,increment:Vt}=ToSecondsStringPrecisionRecord(Ut,Nt);return TemporalDateTimeToString(this,Lt,Bt,{unit:Ht,increment:Vt,roundingMode:jt})}toJSON(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return TemporalDateTimeToString(this,"auto")}toLocaleString(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return new ht(At,xt).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDateTime")}toZonedDateTime(At,xt){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const Bt=ToTemporalTimeZoneSlotValue(At);return CreateTemporalZonedDateTime(GetSlot(GetInstantFor(Bt,this,ToTemporalDisambiguation(GetOptionsObject(xt))),n),Bt,GetSlot(this,p))}toPlainDate(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return TemporalDateTimeToDate(this)}toPlainYearMonth(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const At=GetSlot(this,p);return CalendarYearMonthFromFields(At,PrepareTemporalFields(this,CalendarFields(At,["monthCode","year"]),[]))}toPlainMonthDay(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");const At=GetSlot(this,p);return CalendarMonthDayFromFields(At,PrepareTemporalFields(this,CalendarFields(At,["day","monthCode"]),[]))}toPlainTime(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return TemporalDateTimeToTime(this)}getISOFields(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return{calendar:GetSlot(this,p),isoDay:GetSlot(this,l),isoHour:GetSlot(this,d$1),isoMicrosecond:GetSlot(this,u),isoMillisecond:GetSlot(this,h$1),isoMinute:GetSlot(this,m$1),isoMonth:GetSlot(this,s$2),isoNanosecond:GetSlot(this,T),isoSecond:GetSlot(this,c),isoYear:GetSlot(this,i$3)}}getCalendar(){if(!IsTemporalDateTime(this))throw new TypeError("invalid receiver");return ToTemporalCalendarObject(GetSlot(this,p))}static from(At,xt){const Bt=GetOptionsObject(xt);return IsTemporalDateTime(At)?(ToTemporalOverflow(Bt),CreateTemporalDateTime(GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),GetSlot(At,d$1),GetSlot(At,m$1),GetSlot(At,c),GetSlot(At,h$1),GetSlot(At,u),GetSlot(At,T),GetSlot(At,p))):ToTemporalDateTime(At,Bt)}static compare(At,xt){const Bt=ToTemporalDateTime(At),Nt=ToTemporalDateTime(xt);for(const jt of[i$3,s$2,l,d$1,m$1,c,h$1,u,T]){const Ut=GetSlot(Bt,jt),Lt=GetSlot(Nt,jt);if(Ut!==Lt)return ComparisonResult(Ut-Lt)}return 0}}MakeIntrinsicClass(PlainDateTime,"Temporal.PlainDateTime");class Duration{constructor(At=0,xt=0,Bt=0,Nt=0,jt=0,Ut=0,Lt=0,Ht=0,Vt=0,zt=0){const Wt=At===void 0?0:ToIntegerIfIntegral(At),Jt=xt===void 0?0:ToIntegerIfIntegral(xt),Qt=Bt===void 0?0:ToIntegerIfIntegral(Bt),Xt=Nt===void 0?0:ToIntegerIfIntegral(Nt),tr=jt===void 0?0:ToIntegerIfIntegral(jt),rr=Ut===void 0?0:ToIntegerIfIntegral(Ut),nr=Lt===void 0?0:ToIntegerIfIntegral(Lt),ar=Ht===void 0?0:ToIntegerIfIntegral(Ht),ir=Vt===void 0?0:ToIntegerIfIntegral(Vt),lr=zt===void 0?0:ToIntegerIfIntegral(zt);RejectDuration(Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr),N(this),SetSlot(this,w$1,Wt),SetSlot(this,D,Jt),SetSlot(this,G,Qt),SetSlot(this,v,Xt),SetSlot(this,C,tr),SetSlot(this,O,rr),SetSlot(this,b,nr),SetSlot(this,E$1,ar),SetSlot(this,M,ir),SetSlot(this,R,lr)}get years(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,w$1)}get months(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,D)}get weeks(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,G)}get days(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,v)}get hours(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,C)}get minutes(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,O)}get seconds(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,b)}get milliseconds(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,E$1)}get microseconds(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,M)}get nanoseconds(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return GetSlot(this,R)}get sign(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return DurationSign(GetSlot(this,w$1),GetSlot(this,D),GetSlot(this,G),GetSlot(this,v),GetSlot(this,C),GetSlot(this,O),GetSlot(this,b),GetSlot(this,E$1),GetSlot(this,M),GetSlot(this,R))}get blank(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return DurationSign(GetSlot(this,w$1),GetSlot(this,D),GetSlot(this,G),GetSlot(this,v),GetSlot(this,C),GetSlot(this,O),GetSlot(this,b),GetSlot(this,E$1),GetSlot(this,M),GetSlot(this,R))===0}with(At){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");const xt=PrepareTemporalFields(At,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],"partial"),{years:Bt=GetSlot(this,w$1),months:Nt=GetSlot(this,D),weeks:jt=GetSlot(this,G),days:Ut=GetSlot(this,v),hours:Lt=GetSlot(this,C),minutes:Ht=GetSlot(this,O),seconds:Vt=GetSlot(this,b),milliseconds:zt=GetSlot(this,E$1),microseconds:Wt=GetSlot(this,M),nanoseconds:Jt=GetSlot(this,R)}=xt;return new Duration(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt)}negated(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return CreateNegatedTemporalDuration(this)}abs(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return new Duration(Math.abs(GetSlot(this,w$1)),Math.abs(GetSlot(this,D)),Math.abs(GetSlot(this,G)),Math.abs(GetSlot(this,v)),Math.abs(GetSlot(this,C)),Math.abs(GetSlot(this,O)),Math.abs(GetSlot(this,b)),Math.abs(GetSlot(this,E$1)),Math.abs(GetSlot(this,M)),Math.abs(GetSlot(this,R)))}add(At,xt){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromDuration("add",this,At,xt)}subtract(At,xt){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromDuration("subtract",this,At,xt)}round(At){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");if(At===void 0)throw new TypeError("options parameter is required");let xt=GetSlot(this,w$1),Bt=GetSlot(this,D),Nt=GetSlot(this,G),jt=GetSlot(this,v),Ut=GetSlot(this,C),Lt=GetSlot(this,O),Ht=GetSlot(this,b),Vt=GetSlot(this,E$1),zt=GetSlot(this,M),Wt=GetSlot(this,R),Jt=DefaultTemporalLargestUnit(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt);const Qt=typeof At=="string"?CreateOnePropObject("smallestUnit",At):GetOptionsObject(At);let Xt=GetTemporalUnit(Qt,"largestUnit","datetime",void 0,["auto"]),tr=ToRelativeTemporalObject(Qt);const rr=ToTemporalRoundingIncrement(Qt),nr=ToTemporalRoundingMode(Qt,"halfExpand");let ar=GetTemporalUnit(Qt,"smallestUnit","datetime",void 0),ir=!0;ar||(ir=!1,ar="nanosecond"),Jt=LargerOfTwoTemporalUnits(Jt,ar);let lr=!0;if(Xt||(lr=!1,Xt=Jt),Xt==="auto"&&(Xt=Jt),!ir&&!lr)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(LargerOfTwoTemporalUnits(Xt,ar)!==Xt)throw new RangeError(`largestUnit ${Xt} cannot be smaller than smallestUnit ${ar}`);const yr={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[ar];return yr!==void 0&&ValidateTemporalRoundingIncrement(rr,yr,!1),{years:xt,months:Bt,weeks:Nt,days:jt}=UnbalanceDurationRelative(xt,Bt,Nt,jt,Xt,tr),{years:xt,months:Bt,weeks:Nt,days:jt,hours:Ut,minutes:Lt,seconds:Ht,milliseconds:Vt,microseconds:zt,nanoseconds:Wt}=RoundDuration(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,rr,ar,nr,tr),{years:xt,months:Bt,weeks:Nt,days:jt,hours:Ut,minutes:Lt,seconds:Ht,milliseconds:Vt,microseconds:zt,nanoseconds:Wt}=AdjustRoundedDurationDays(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,rr,ar,nr,tr),{days:jt,hours:Ut,minutes:Lt,seconds:Ht,milliseconds:Vt,microseconds:zt,nanoseconds:Wt}=BalanceDuration(jt,Ut,Lt,Ht,Vt,zt,Wt,Xt,tr),{years:xt,months:Bt,weeks:Nt,days:jt}=function(Ar,Dr,Br,Lr,Or,vr){const pr=GetIntrinsic("%Temporal.Duration%"),dr=DurationSign(Ar,Dr,Br,Lr,0,0,0,0,0,0);if(dr===0)return{years:Ar,months:Dr,weeks:Br,days:Lr};const ur=JSBI.BigInt(dr);let $r,wr,Er=JSBI.BigInt(Ar),gr=JSBI.BigInt(Dr),fr=JSBI.BigInt(Br),br=JSBI.BigInt(Lr);vr&&(wr=ToTemporalDate(vr),$r=GetSlot(wr,p));const _r=new pr(dr),Tr=new pr(0,dr),Pr=new pr(0,0,dr);switch(Or){case"year":{if(!$r)throw new RangeError("a starting point is required for years balancing");const Nr=typeof $r!="string"?GetMethod($r,"dateAdd"):void 0;let Cr,xr,Rr;for({relativeTo:Cr,days:xr}=MoveRelativeDate($r,wr,_r,Nr);JSBI.greaterThanOrEqual(abs(br),JSBI.BigInt(ae(xr)));)br=JSBI.subtract(br,JSBI.BigInt(xr)),Er=JSBI.add(Er,ur),wr=Cr,{relativeTo:Cr,days:xr}=MoveRelativeDate($r,wr,_r,Nr);for({relativeTo:Cr,days:Rr}=MoveRelativeDate($r,wr,Tr,Nr);JSBI.greaterThanOrEqual(abs(br),JSBI.BigInt(ae(Rr)));)br=JSBI.subtract(br,JSBI.BigInt(Rr)),gr=JSBI.add(gr,ur),wr=Cr,{relativeTo:Cr,days:Rr}=MoveRelativeDate($r,wr,Tr,Nr);Cr=CalendarDateAdd($r,wr,_r,void 0,Nr);const qr=typeof $r!="string"?GetMethod($r,"dateUntil"):void 0,Vr=Te(null);Vr.largestUnit="month";let Gr=CalendarDateUntil($r,wr,Cr,Vr,qr),Ur=GetSlot(Gr,D);for(;JSBI.greaterThanOrEqual(abs(gr),JSBI.BigInt(ae(Ur)));){gr=JSBI.subtract(gr,JSBI.BigInt(Ur)),Er=JSBI.add(Er,ur),wr=Cr,Cr=CalendarDateAdd($r,wr,_r,void 0,Nr);const kr=Te(null);kr.largestUnit="month",Gr=CalendarDateUntil($r,wr,Cr,kr,qr),Ur=GetSlot(Gr,D)}break}case"month":{if(!$r)throw new RangeError("a starting point is required for months balancing");const Nr=typeof $r!="string"?GetMethod($r,"dateAdd"):void 0;let Cr,xr;for({relativeTo:Cr,days:xr}=MoveRelativeDate($r,wr,Tr,Nr);JSBI.greaterThanOrEqual(abs(br),JSBI.BigInt(ae(xr)));)br=JSBI.subtract(br,JSBI.BigInt(xr)),gr=JSBI.add(gr,ur),wr=Cr,{relativeTo:Cr,days:xr}=MoveRelativeDate($r,wr,Tr,Nr);break}case"week":{if(!$r)throw new RangeError("a starting point is required for weeks balancing");const Nr=typeof $r!="string"?GetMethod($r,"dateAdd"):void 0;let Cr,xr;for({relativeTo:Cr,days:xr}=MoveRelativeDate($r,wr,Pr,Nr);JSBI.greaterThanOrEqual(abs(br),JSBI.BigInt(ae(xr)));)br=JSBI.subtract(br,JSBI.BigInt(xr)),fr=JSBI.add(fr,ur),wr=Cr,{relativeTo:Cr,days:xr}=MoveRelativeDate($r,wr,Pr,Nr);break}}return{years:JSBI.toNumber(Er),months:JSBI.toNumber(gr),weeks:JSBI.toNumber(fr),days:JSBI.toNumber(br)}}(xt,Bt,Nt,jt,Xt,tr),new Duration(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt)}total(At){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");let xt=GetSlot(this,w$1),Bt=GetSlot(this,D),Nt=GetSlot(this,G),jt=GetSlot(this,v),Ut=GetSlot(this,C),Lt=GetSlot(this,O),Ht=GetSlot(this,b),Vt=GetSlot(this,E$1),zt=GetSlot(this,M),Wt=GetSlot(this,R);if(At===void 0)throw new TypeError("options argument is required");const Jt=typeof At=="string"?CreateOnePropObject("unit",At):GetOptionsObject(At),Qt=ToRelativeTemporalObject(Jt),Xt=GetTemporalUnit(Jt,"unit","datetime",He);let tr;({years:xt,months:Bt,weeks:Nt,days:jt}=UnbalanceDurationRelative(xt,Bt,Nt,jt,Xt,Qt)),IsTemporalZonedDateTime(Qt)&&(tr=MoveRelativeZonedDateTime(Qt,xt,Bt,Nt,0));let rr=BalancePossiblyInfiniteDuration(jt,Ut,Lt,Ht,Vt,zt,Wt,Xt,tr);if(rr==="positive overflow")return 1/0;if(rr==="negative overflow")return-1/0;({days:jt,hours:Ut,minutes:Lt,seconds:Ht,milliseconds:Vt,microseconds:zt,nanoseconds:Wt}=rr);const{total:nr}=RoundDuration(xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,1,Xt,"trunc",Qt);return nr}toString(At){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");const xt=GetOptionsObject(At),Bt=ToFractionalSecondDigits(xt),Nt=ToTemporalRoundingMode(xt,"trunc"),jt=GetTemporalUnit(xt,"smallestUnit","time",void 0);if(jt==="hour"||jt==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:Ut,unit:Lt,increment:Ht}=ToSecondsStringPrecisionRecord(jt,Bt);return TemporalDurationToString(this,Ut,{unit:Lt,increment:Ht,roundingMode:Nt})}toJSON(){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return TemporalDurationToString(this)}toLocaleString(At,xt){if(!IsTemporalDuration(this))throw new TypeError("invalid receiver");return typeof Intl<"u"&&Intl.DurationFormat!==void 0?new Intl.DurationFormat(At,xt).format(this):(console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),TemporalDurationToString(this))}valueOf(){throw new TypeError("use compare() to compare Temporal.Duration")}static from(At){return IsTemporalDuration(At)?new Duration(GetSlot(At,w$1),GetSlot(At,D),GetSlot(At,G),GetSlot(At,v),GetSlot(At,C),GetSlot(At,O),GetSlot(At,b),GetSlot(At,E$1),GetSlot(At,M),GetSlot(At,R)):ToTemporalDuration(At)}static compare(At,xt,Bt){const Nt=ToTemporalDuration(At),jt=ToTemporalDuration(xt),Ut=ToRelativeTemporalObject(GetOptionsObject(Bt)),Lt=GetSlot(Nt,w$1),Ht=GetSlot(Nt,D),Vt=GetSlot(Nt,G);let zt=GetSlot(Nt,v);const Wt=GetSlot(Nt,C),Jt=GetSlot(Nt,O),Qt=GetSlot(Nt,b),Xt=GetSlot(Nt,E$1),tr=GetSlot(Nt,M);let rr=GetSlot(Nt,R);const nr=GetSlot(jt,w$1),ar=GetSlot(jt,D),ir=GetSlot(jt,G);let lr=GetSlot(jt,v);const yr=GetSlot(jt,C),Sr=GetSlot(jt,O),Ar=GetSlot(jt,b),Dr=GetSlot(jt,E$1),Br=GetSlot(jt,M);let Lr=GetSlot(jt,R);const Or=CalculateOffsetShift(Ut,Lt,Ht,Vt,zt),vr=CalculateOffsetShift(Ut,nr,ar,ir,lr);Lt===0&&nr===0&&Ht===0&&ar===0&&Vt===0&&ir===0||({days:zt}=UnbalanceDurationRelative(Lt,Ht,Vt,zt,"day",Ut),{days:lr}=UnbalanceDurationRelative(nr,ar,ir,lr,"day",Ut));const pr=TotalDurationNanoseconds(zt,Wt,Jt,Qt,Xt,tr,rr,Or),dr=TotalDurationNanoseconds(lr,yr,Sr,Ar,Dr,Br,Lr,vr);return ComparisonResult(JSBI.toNumber(JSBI.subtract(pr,dr)))}}MakeIntrinsicClass(Duration,"Temporal.Duration");const bt=Object.create;class PlainMonthDay{constructor(At,xt,Bt="iso8601",Nt=1972){CreateTemporalMonthDaySlots(this,ToIntegerWithTruncation(At),ToIntegerWithTruncation(xt),ToTemporalCalendarSlotValue(Bt),ToIntegerWithTruncation(Nt))}get monthCode(){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return CalendarMonthCode(GetSlot(this,p),this)}get day(){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return CalendarDay(GetSlot(this,p),this)}get calendarId(){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return ToTemporalCalendarIdentifier(GetSlot(this,p))}with(At,xt){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument");RejectTemporalLikeObject(At);const Bt=GetOptionsObject(xt),Nt=GetSlot(this,p),jt=CalendarFields(Nt,["day","month","monthCode","year"]);let Ut=PrepareTemporalFields(this,jt,[]);return Ut=CalendarMergeFields(Nt,Ut,PrepareTemporalFields(At,jt,"partial")),Ut=PrepareTemporalFields(Ut,jt,[]),CalendarMonthDayFromFields(Nt,Ut,Bt)}equals(At){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");const xt=ToTemporalMonthDay(At);for(const Bt of[s$2,l,i$3])if(GetSlot(this,Bt)!==GetSlot(xt,Bt))return!1;return CalendarEquals(GetSlot(this,p),GetSlot(xt,p))}toString(At){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return TemporalMonthDayToString(this,ToCalendarNameOption(GetOptionsObject(At)))}toJSON(){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return TemporalMonthDayToString(this)}toLocaleString(At,xt){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return new ht(At,xt).format(this)}valueOf(){throw new TypeError("use equals() to compare Temporal.PlainMonthDay")}toPlainDate(At){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("argument should be an object");const xt=GetSlot(this,p),Bt=CalendarFields(xt,["day","monthCode"]),Nt=PrepareTemporalFields(this,Bt,[]),jt=CalendarFields(xt,["year"]);let Ut=CalendarMergeFields(xt,Nt,PrepareTemporalFields(At,jt,[]));Ut=PrepareTemporalFields(Ut,[...new Set([...Bt,...jt])],[]);const Lt=bt(null);return Lt.overflow="reject",CalendarDateFromFields(xt,Ut,Lt)}getISOFields(){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return{calendar:GetSlot(this,p),isoDay:GetSlot(this,l),isoMonth:GetSlot(this,s$2),isoYear:GetSlot(this,i$3)}}getCalendar(){if(!IsTemporalMonthDay(this))throw new TypeError("invalid receiver");return ToTemporalCalendarObject(GetSlot(this,p))}static from(At,xt){const Bt=GetOptionsObject(xt);return IsTemporalMonthDay(At)?(ToTemporalOverflow(Bt),CreateTemporalMonthDay(GetSlot(At,s$2),GetSlot(At,l),GetSlot(At,p),GetSlot(At,i$3))):ToTemporalMonthDay(At,Bt)}}MakeIntrinsicClass(PlainMonthDay,"Temporal.PlainMonthDay");const instant=()=>new(GetIntrinsic("%Temporal.Instant%"))(Ve()),plainDateTime=(kt,At=DefaultTimeZone())=>{const xt=ToTemporalTimeZoneSlotValue(At),Bt=ToTemporalCalendarSlotValue(kt);return GetPlainDateTimeFor(xt,instant(),Bt)},plainDateTimeISO=(kt=DefaultTimeZone())=>GetPlainDateTimeFor(ToTemporalTimeZoneSlotValue(kt),instant(),"iso8601"),zonedDateTime=(kt,At=DefaultTimeZone())=>{const xt=ToTemporalTimeZoneSlotValue(At),Bt=ToTemporalCalendarSlotValue(kt);return CreateTemporalZonedDateTime(Ve(),xt,Bt)},Et={instant,plainDateTime,plainDateTimeISO,plainDate:(kt,At=DefaultTimeZone())=>TemporalDateTimeToDate(plainDateTime(kt,At)),plainDateISO:(kt=DefaultTimeZone())=>TemporalDateTimeToDate(plainDateTimeISO(kt)),plainTimeISO:(kt=DefaultTimeZone())=>TemporalDateTimeToTime(plainDateTimeISO(kt)),timeZoneId:()=>DefaultTimeZone(),zonedDateTime,zonedDateTimeISO:(kt=DefaultTimeZone())=>zonedDateTime("iso8601",kt),[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(Et,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});const Mt=Object.assign;function TemporalTimeToString(kt,At,xt){let Bt=GetSlot(kt,d$1),Nt=GetSlot(kt,m$1),jt=GetSlot(kt,c),Ut=GetSlot(kt,h$1),Lt=GetSlot(kt,u),Ht=GetSlot(kt,T);if(xt){const{unit:Vt,increment:zt,roundingMode:Wt}=xt;({hour:Bt,minute:Nt,second:jt,millisecond:Ut,microsecond:Lt,nanosecond:Ht}=RoundTime(Bt,Nt,jt,Ut,Lt,Ht,zt,Vt,Wt))}return`${ISODateTimePartString(Bt)}:${ISODateTimePartString(Nt)}${FormatSecondsStringPart(jt,Ut,Lt,Ht,At)}`}class PlainTime{constructor(At=0,xt=0,Bt=0,Nt=0,jt=0,Ut=0){const Lt=At===void 0?0:ToIntegerWithTruncation(At),Ht=xt===void 0?0:ToIntegerWithTruncation(xt),Vt=Bt===void 0?0:ToIntegerWithTruncation(Bt),zt=Nt===void 0?0:ToIntegerWithTruncation(Nt),Wt=jt===void 0?0:ToIntegerWithTruncation(jt),Jt=Ut===void 0?0:ToIntegerWithTruncation(Ut);RejectTime(Lt,Ht,Vt,zt,Wt,Jt),N(this),SetSlot(this,d$1,Lt),SetSlot(this,m$1,Ht),SetSlot(this,c,Vt),SetSlot(this,h$1,zt),SetSlot(this,u,Wt),SetSlot(this,T,Jt)}get hour(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return GetSlot(this,d$1)}get minute(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return GetSlot(this,m$1)}get second(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return GetSlot(this,c)}get millisecond(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return GetSlot(this,h$1)}get microsecond(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return GetSlot(this,u)}get nanosecond(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return GetSlot(this,T)}with(At,xt){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument");RejectTemporalLikeObject(At);const Bt=ToTemporalOverflow(GetOptionsObject(xt)),Nt=ToTemporalTimeRecord(At,"partial"),jt=ToTemporalTimeRecord(this);let{hour:Ut,minute:Lt,second:Ht,millisecond:Vt,microsecond:zt,nanosecond:Wt}=Mt(jt,Nt);return{hour:Ut,minute:Lt,second:Ht,millisecond:Vt,microsecond:zt,nanosecond:Wt}=RegulateTime(Ut,Lt,Ht,Vt,zt,Wt,Bt),new PlainTime(Ut,Lt,Ht,Vt,zt,Wt)}add(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromPlainTime("add",this,At)}subtract(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromPlainTime("subtract",this,At)}until(At,xt){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainTime("until",this,At,xt)}since(At,xt){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainTime("since",this,At,xt)}round(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");if(At===void 0)throw new TypeError("options parameter is required");const xt=typeof At=="string"?CreateOnePropObject("smallestUnit",At):GetOptionsObject(At),Bt=ToTemporalRoundingIncrement(xt),Nt=ToTemporalRoundingMode(xt,"halfExpand"),jt=GetTemporalUnit(xt,"smallestUnit","time",He);ValidateTemporalRoundingIncrement(Bt,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[jt],!1);let Ut=GetSlot(this,d$1),Lt=GetSlot(this,m$1),Ht=GetSlot(this,c),Vt=GetSlot(this,h$1),zt=GetSlot(this,u),Wt=GetSlot(this,T);return{hour:Ut,minute:Lt,second:Ht,millisecond:Vt,microsecond:zt,nanosecond:Wt}=RoundTime(Ut,Lt,Ht,Vt,zt,Wt,Bt,jt,Nt),new PlainTime(Ut,Lt,Ht,Vt,zt,Wt)}equals(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalTime(At);for(const Bt of[d$1,m$1,c,h$1,u,T])if(GetSlot(this,Bt)!==GetSlot(xt,Bt))return!1;return!0}toString(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");const xt=GetOptionsObject(At),Bt=ToFractionalSecondDigits(xt),Nt=ToTemporalRoundingMode(xt,"trunc"),jt=GetTemporalUnit(xt,"smallestUnit","time",void 0);if(jt==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:Ut,unit:Lt,increment:Ht}=ToSecondsStringPrecisionRecord(jt,Bt);return TemporalTimeToString(this,Ut,{unit:Lt,increment:Ht,roundingMode:Nt})}toJSON(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return TemporalTimeToString(this,"auto")}toLocaleString(At,xt){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return new ht(At,xt).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainTime")}toPlainDateTime(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At),Bt=GetSlot(xt,i$3),Nt=GetSlot(xt,s$2),jt=GetSlot(xt,l),Ut=GetSlot(xt,p);return CreateTemporalDateTime(Bt,Nt,jt,GetSlot(this,d$1),GetSlot(this,m$1),GetSlot(this,c),GetSlot(this,h$1),GetSlot(this,u),GetSlot(this,T),Ut)}toZonedDateTime(At){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument");const xt=At.plainDate;if(xt===void 0)throw new TypeError("missing date property");const Bt=ToTemporalDate(xt),Nt=At.timeZone;if(Nt===void 0)throw new TypeError("missing timeZone property");const jt=ToTemporalTimeZoneSlotValue(Nt),Ut=GetSlot(Bt,i$3),Lt=GetSlot(Bt,s$2),Ht=GetSlot(Bt,l),Vt=GetSlot(Bt,p),zt=GetSlot(this,d$1),Wt=GetSlot(this,m$1),Jt=GetSlot(this,c),Qt=GetSlot(this,h$1),Xt=GetSlot(this,u),tr=GetSlot(this,T);return CreateTemporalZonedDateTime(GetSlot(GetInstantFor(jt,new(GetIntrinsic("%Temporal.PlainDateTime%"))(Ut,Lt,Ht,zt,Wt,Jt,Qt,Xt,tr,Vt),"compatible"),n),jt,Vt)}getISOFields(){if(!IsTemporalTime(this))throw new TypeError("invalid receiver");return{isoHour:GetSlot(this,d$1),isoMicrosecond:GetSlot(this,u),isoMillisecond:GetSlot(this,h$1),isoMinute:GetSlot(this,m$1),isoNanosecond:GetSlot(this,T),isoSecond:GetSlot(this,c)}}static from(At,xt){const Bt=ToTemporalOverflow(GetOptionsObject(xt));return IsTemporalTime(At)?new PlainTime(GetSlot(At,d$1),GetSlot(At,m$1),GetSlot(At,c),GetSlot(At,h$1),GetSlot(At,u),GetSlot(At,T)):ToTemporalTime(At,Bt)}static compare(At,xt){const Bt=ToTemporalTime(At),Nt=ToTemporalTime(xt);for(const jt of[d$1,m$1,c,h$1,u,T]){const Ut=GetSlot(Bt,jt),Lt=GetSlot(Nt,jt);if(Ut!==Lt)return ComparisonResult(Ut-Lt)}return 0}}MakeIntrinsicClass(PlainTime,"Temporal.PlainTime");class TimeZone{constructor(At){if(arguments.length<1)throw new RangeError("missing argument: identifier is required");const xt=GetCanonicalTimeZoneIdentifier(At);N(this),SetSlot(this,a,xt)}get id(){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");return GetSlot(this,a)}getOffsetNanosecondsFor(At){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");const xt=ToTemporalInstant(At),Bt=GetSlot(this,a);return IsTimeZoneOffsetString(Bt)?ParseTimeZoneOffsetString(Bt):GetNamedTimeZoneOffsetNanoseconds(Bt,GetSlot(xt,n))}getOffsetStringFor(At){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");return GetOffsetStringFor(this,ToTemporalInstant(At))}getPlainDateTimeFor(At,xt="iso8601"){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");return GetPlainDateTimeFor(this,ToTemporalInstant(At),ToTemporalCalendarSlotValue(xt))}getInstantFor(At,xt){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");return GetInstantFor(this,ToTemporalDateTime(At),ToTemporalDisambiguation(GetOptionsObject(xt)))}getPossibleInstantsFor(At){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");const xt=ToTemporalDateTime(At),Bt=GetIntrinsic("%Temporal.Instant%"),Nt=GetSlot(this,a);if(IsTimeZoneOffsetString(Nt)){const Ut=GetUTCEpochNanoseconds(GetSlot(xt,i$3),GetSlot(xt,s$2),GetSlot(xt,l),GetSlot(xt,d$1),GetSlot(xt,m$1),GetSlot(xt,c),GetSlot(xt,h$1),GetSlot(xt,u),GetSlot(xt,T));if(Ut===null)throw new RangeError("DateTime outside of supported range");const Lt=ParseTimeZoneOffsetString(Nt);return[new Bt(JSBI.subtract(Ut,JSBI.BigInt(Lt)))]}return function(Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr){const nr=GetUTCEpochNanoseconds(Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr);if(nr===null)throw new RangeError("DateTime outside of supported range");let ar=JSBI.subtract(nr,Ee);JSBI.lessThan(ar,Me)&&(ar=nr);let ir=JSBI.add(nr,Ee);JSBI.greaterThan(ir,Re)&&(ir=nr);const lr=GetNamedTimeZoneOffsetNanoseconds(Lt,ar),yr=GetNamedTimeZoneOffsetNanoseconds(Lt,ir);return(lr===yr?[lr]:[lr,yr]).map(Sr=>{const Ar=JSBI.subtract(nr,JSBI.BigInt(Sr)),Dr=GetNamedTimeZoneDateTimeParts(Lt,Ar);if(Ht===Dr.year&&Vt===Dr.month&&zt===Dr.day&&Wt===Dr.hour&&Jt===Dr.minute&&Qt===Dr.second&&Xt===Dr.millisecond&&tr===Dr.microsecond&&rr===Dr.nanosecond)return Ar}).filter(Sr=>Sr!==void 0)}(Nt,GetSlot(xt,i$3),GetSlot(xt,s$2),GetSlot(xt,l),GetSlot(xt,d$1),GetSlot(xt,m$1),GetSlot(xt,c),GetSlot(xt,h$1),GetSlot(xt,u),GetSlot(xt,T)).map(Ut=>new Bt(Ut))}getNextTransition(At){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");const xt=ToTemporalInstant(At),Bt=GetSlot(this,a);if(IsTimeZoneOffsetString(Bt)||Bt==="UTC")return null;let Nt=GetSlot(xt,n);const jt=GetIntrinsic("%Temporal.Instant%");return Nt=GetNamedTimeZoneNextTransition(Bt,Nt),Nt===null?null:new jt(Nt)}getPreviousTransition(At){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");const xt=ToTemporalInstant(At),Bt=GetSlot(this,a);if(IsTimeZoneOffsetString(Bt)||Bt==="UTC")return null;let Nt=GetSlot(xt,n);const jt=GetIntrinsic("%Temporal.Instant%");return Nt=GetNamedTimeZonePreviousTransition(Bt,Nt),Nt===null?null:new jt(Nt)}toString(){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");return GetSlot(this,a)}toJSON(){if(!IsTemporalTimeZone(this))throw new TypeError("invalid receiver");return GetSlot(this,a)}static from(At){return ToTemporalTimeZoneObject(ToTemporalTimeZoneSlotValue(At))}}MakeIntrinsicClass(TimeZone,"Temporal.TimeZone"),DefineIntrinsic("Temporal.TimeZone.prototype.getOffsetNanosecondsFor",TimeZone.prototype.getOffsetNanosecondsFor),DefineIntrinsic("Temporal.TimeZone.prototype.getPossibleInstantsFor",TimeZone.prototype.getPossibleInstantsFor);const Rt=Object.create;class PlainYearMonth{constructor(At,xt,Bt="iso8601",Nt=1){CreateTemporalYearMonthSlots(this,ToIntegerWithTruncation(At),ToIntegerWithTruncation(xt),ToTemporalCalendarSlotValue(Bt),ToIntegerWithTruncation(Nt))}get year(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarYear(GetSlot(this,p),this)}get month(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarMonth(GetSlot(this,p),this)}get monthCode(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarMonthCode(GetSlot(this,p),this)}get calendarId(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return ToTemporalCalendarIdentifier(GetSlot(this,p))}get era(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarEra(GetSlot(this,p),this)}get eraYear(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarEraYear(GetSlot(this,p),this)}get daysInMonth(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarDaysInMonth(GetSlot(this,p),this)}get daysInYear(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarDaysInYear(GetSlot(this,p),this)}get monthsInYear(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarMonthsInYear(GetSlot(this,p),this)}get inLeapYear(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return CalendarInLeapYear(GetSlot(this,p),this)}with(At,xt){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid argument");RejectTemporalLikeObject(At);const Bt=GetOptionsObject(xt),Nt=GetSlot(this,p),jt=CalendarFields(Nt,["month","monthCode","year"]);let Ut=PrepareTemporalFields(this,jt,[]);return Ut=CalendarMergeFields(Nt,Ut,PrepareTemporalFields(At,jt,"partial")),Ut=PrepareTemporalFields(Ut,jt,[]),CalendarYearMonthFromFields(Nt,Ut,Bt)}add(At,xt){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromPlainYearMonth("add",this,At,xt)}subtract(At,xt){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromPlainYearMonth("subtract",this,At,xt)}until(At,xt){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainYearMonth("until",this,At,xt)}since(At,xt){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return DifferenceTemporalPlainYearMonth("since",this,At,xt)}equals(At){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");const xt=ToTemporalYearMonth(At);for(const Bt of[i$3,s$2,l])if(GetSlot(this,Bt)!==GetSlot(xt,Bt))return!1;return CalendarEquals(GetSlot(this,p),GetSlot(xt,p))}toString(At){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return TemporalYearMonthToString(this,ToCalendarNameOption(GetOptionsObject(At)))}toJSON(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return TemporalYearMonthToString(this)}toLocaleString(At,xt){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return new ht(At,xt).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainYearMonth")}toPlainDate(At){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("argument should be an object");const xt=GetSlot(this,p),Bt=CalendarFields(xt,["monthCode","year"]),Nt=PrepareTemporalFields(this,Bt,[]),jt=CalendarFields(xt,["day"]);let Ut=CalendarMergeFields(xt,Nt,PrepareTemporalFields(At,jt,[]));Ut=PrepareTemporalFields(Ut,[...new Set([...Bt,...jt])],[]);const Lt=Rt(null);return Lt.overflow="reject",CalendarDateFromFields(xt,Ut,Lt)}getISOFields(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return{calendar:GetSlot(this,p),isoDay:GetSlot(this,l),isoMonth:GetSlot(this,s$2),isoYear:GetSlot(this,i$3)}}getCalendar(){if(!IsTemporalYearMonth(this))throw new TypeError("invalid receiver");return ToTemporalCalendarObject(GetSlot(this,p))}static from(At,xt){const Bt=GetOptionsObject(xt);return IsTemporalYearMonth(At)?(ToTemporalOverflow(Bt),CreateTemporalYearMonth(GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,p),GetSlot(At,l))):ToTemporalYearMonth(At,Bt)}static compare(At,xt){const Bt=ToTemporalYearMonth(At),Nt=ToTemporalYearMonth(xt);return CompareISODate(GetSlot(Bt,i$3),GetSlot(Bt,s$2),GetSlot(Bt,l),GetSlot(Nt,i$3),GetSlot(Nt,s$2),GetSlot(Nt,l))}}MakeIntrinsicClass(PlainYearMonth,"Temporal.PlainYearMonth");const Ft=ht.prototype.resolvedOptions,Yt=Object.create;class ZonedDateTime{constructor(At,xt,Bt="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");CreateTemporalZonedDateTimeSlots(this,ToBigInt(At),ToTemporalTimeZoneSlotValue(xt),ToTemporalCalendarSlotValue(Bt))}get calendarId(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return ToTemporalCalendarIdentifier(GetSlot(this,p))}get timeZoneId(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return ToTemporalTimeZoneIdentifier(GetSlot(this,g))}get year(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarYear(GetSlot(this,p),dateTime(this))}get month(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarMonth(GetSlot(this,p),dateTime(this))}get monthCode(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarMonthCode(GetSlot(this,p),dateTime(this))}get day(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarDay(GetSlot(this,p),dateTime(this))}get hour(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetSlot(dateTime(this),d$1)}get minute(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetSlot(dateTime(this),m$1)}get second(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetSlot(dateTime(this),c)}get millisecond(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetSlot(dateTime(this),h$1)}get microsecond(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetSlot(dateTime(this),u)}get nanosecond(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetSlot(dateTime(this),T)}get era(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarEra(GetSlot(this,p),dateTime(this))}get eraYear(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarEraYear(GetSlot(this,p),dateTime(this))}get epochSeconds(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=GetSlot(this,n);return JSBI.toNumber(BigIntFloorDiv(At,ve))}get epochMilliseconds(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=GetSlot(this,n);return JSBI.toNumber(BigIntFloorDiv(At,Ge))}get epochMicroseconds(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return ToBigIntExternal(BigIntFloorDiv(GetSlot(this,n),De))}get epochNanoseconds(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return ToBigIntExternal(GetSlot(this,n))}get dayOfWeek(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarDayOfWeek(GetSlot(this,p),dateTime(this))}get dayOfYear(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarDayOfYear(GetSlot(this,p),dateTime(this))}get weekOfYear(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarWeekOfYear(GetSlot(this,p),dateTime(this))}get yearOfWeek(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarYearOfWeek(GetSlot(this,p),dateTime(this))}get hoursInDay(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=dateTime(this),xt=GetIntrinsic("%Temporal.PlainDateTime%"),Bt=GetSlot(At,i$3),Nt=GetSlot(At,s$2),jt=GetSlot(At,l),Ut=new xt(Bt,Nt,jt,0,0,0,0,0,0),Lt=AddISODate(Bt,Nt,jt,0,0,0,1,"reject"),Ht=new xt(Lt.year,Lt.month,Lt.day,0,0,0,0,0,0),Vt=GetSlot(this,g),zt=GetSlot(GetInstantFor(Vt,Ut,"compatible"),n),Wt=GetSlot(GetInstantFor(Vt,Ht,"compatible"),n);return BigIntDivideToNumber(JSBI.subtract(Wt,zt),Oe)}get daysInWeek(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarDaysInWeek(GetSlot(this,p),dateTime(this))}get daysInMonth(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarDaysInMonth(GetSlot(this,p),dateTime(this))}get daysInYear(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarDaysInYear(GetSlot(this,p),dateTime(this))}get monthsInYear(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarMonthsInYear(GetSlot(this,p),dateTime(this))}get inLeapYear(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return CalendarInLeapYear(GetSlot(this,p),dateTime(this))}get offset(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetOffsetStringFor(GetSlot(this,g),GetSlot(this,S))}get offsetNanoseconds(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return GetOffsetNanosecondsFor(GetSlot(this,g),GetSlot(this,S))}with(At,xt){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");if(!IsObject(At))throw new TypeError("invalid zoned-date-time-like");RejectTemporalLikeObject(At);const Bt=GetOptionsObject(xt),Nt=GetSlot(this,p);let jt=CalendarFields(Nt,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);jt.push("offset");let Ut=PrepareTemporalFields(this,jt,["offset"]);Ut=CalendarMergeFields(Nt,Ut,PrepareTemporalFields(At,jt,"partial")),Ut=PrepareTemporalFields(Ut,jt,["offset"]);const Lt=ToTemporalDisambiguation(Bt),Ht=ToTemporalOffset(Bt,"prefer");let{year:Vt,month:zt,day:Wt,hour:Jt,minute:Qt,second:Xt,millisecond:tr,microsecond:rr,nanosecond:nr}=InterpretTemporalDateTimeFields(Nt,Ut,Bt);const ar=ParseTimeZoneOffsetString(Ut.offset),ir=GetSlot(this,g);return CreateTemporalZonedDateTime(InterpretISODateTimeOffset(Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,"option",ar,ir,Lt,Ht,!1),ir,Nt)}withPlainDate(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalDate(At),Bt=GetSlot(xt,i$3),Nt=GetSlot(xt,s$2),jt=GetSlot(xt,l);let Ut=GetSlot(xt,p);const Lt=dateTime(this),Ht=GetSlot(Lt,d$1),Vt=GetSlot(Lt,m$1),zt=GetSlot(Lt,c),Wt=GetSlot(Lt,h$1),Jt=GetSlot(Lt,u),Qt=GetSlot(Lt,T);Ut=ConsolidateCalendars(GetSlot(this,p),Ut);const Xt=GetSlot(this,g);return CreateTemporalZonedDateTime(GetSlot(GetInstantFor(Xt,new(GetIntrinsic("%Temporal.PlainDateTime%"))(Bt,Nt,jt,Ht,Vt,zt,Wt,Jt,Qt,Ut),"compatible"),n),Xt,Ut)}withPlainTime(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const xt=GetIntrinsic("%Temporal.PlainTime%"),Bt=At===void 0?new xt:ToTemporalTime(At),Nt=dateTime(this),jt=GetSlot(Nt,i$3),Ut=GetSlot(Nt,s$2),Lt=GetSlot(Nt,l),Ht=GetSlot(this,p),Vt=GetSlot(Bt,d$1),zt=GetSlot(Bt,m$1),Wt=GetSlot(Bt,c),Jt=GetSlot(Bt,h$1),Qt=GetSlot(Bt,u),Xt=GetSlot(Bt,T),tr=GetSlot(this,g);return CreateTemporalZonedDateTime(GetSlot(GetInstantFor(tr,new(GetIntrinsic("%Temporal.PlainDateTime%"))(jt,Ut,Lt,Vt,zt,Wt,Jt,Qt,Xt,Ht),"compatible"),n),tr,Ht)}withTimeZone(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalTimeZoneSlotValue(At);return CreateTemporalZonedDateTime(GetSlot(this,n),xt,GetSlot(this,p))}withCalendar(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalCalendarSlotValue(At);return CreateTemporalZonedDateTime(GetSlot(this,n),GetSlot(this,g),xt)}add(At,xt){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromZonedDateTime("add",this,At,xt)}subtract(At,xt){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return AddDurationToOrSubtractDurationFromZonedDateTime("subtract",this,At,xt)}until(At,xt){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return DifferenceTemporalZonedDateTime("until",this,At,xt)}since(At,xt){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return DifferenceTemporalZonedDateTime("since",this,At,xt)}round(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");if(At===void 0)throw new TypeError("options parameter is required");const xt=typeof At=="string"?CreateOnePropObject("smallestUnit",At):GetOptionsObject(At),Bt=ToTemporalRoundingIncrement(xt),Nt=ToTemporalRoundingMode(xt,"halfExpand"),jt=GetTemporalUnit(xt,"smallestUnit","time",He,["day"]),Ut={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[jt];ValidateTemporalRoundingIncrement(Bt,Ut,Ut===1);const Lt=dateTime(this);let Ht=GetSlot(Lt,i$3),Vt=GetSlot(Lt,s$2),zt=GetSlot(Lt,l),Wt=GetSlot(Lt,d$1),Jt=GetSlot(Lt,m$1),Qt=GetSlot(Lt,c),Xt=GetSlot(Lt,h$1),tr=GetSlot(Lt,u),rr=GetSlot(Lt,T);const nr=GetIntrinsic("%Temporal.PlainDateTime%"),ar=GetSlot(this,g),ir=GetSlot(this,p),lr=GetInstantFor(ar,new nr(GetSlot(Lt,i$3),GetSlot(Lt,s$2),GetSlot(Lt,l),0,0,0,0,0,0),"compatible"),yr=AddZonedDateTime(lr,ar,ir,0,0,0,1,0,0,0,0,0,0),Sr=JSBI.subtract(yr,JSBI.BigInt(GetSlot(lr,n)));if(JSBI.lessThanOrEqual(Sr,Ie))throw new RangeError("cannot round a ZonedDateTime in a calendar with zero or negative length days");return{year:Ht,month:Vt,day:zt,hour:Wt,minute:Jt,second:Qt,millisecond:Xt,microsecond:tr,nanosecond:rr}=RoundISODateTime(Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,Bt,jt,Nt,JSBI.toNumber(Sr)),CreateTemporalZonedDateTime(InterpretISODateTimeOffset(Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,"option",GetOffsetNanosecondsFor(ar,GetSlot(this,S)),ar,"compatible","prefer",!1),ar,GetSlot(this,p))}equals(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const xt=ToTemporalZonedDateTime(At),Bt=GetSlot(this,n),Nt=GetSlot(xt,n);return!!JSBI.equal(JSBI.BigInt(Bt),JSBI.BigInt(Nt))&&!!TimeZoneEquals(GetSlot(this,g),GetSlot(xt,g))&&CalendarEquals(GetSlot(this,p),GetSlot(xt,p))}toString(At){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const xt=GetOptionsObject(At),Bt=ToCalendarNameOption(xt),Nt=ToFractionalSecondDigits(xt),jt=function(Qt){return GetOption(Qt,"offset",["auto","never"],"auto")}(xt),Ut=ToTemporalRoundingMode(xt,"trunc"),Lt=GetTemporalUnit(xt,"smallestUnit","time",void 0);if(Lt==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const Ht=function(Qt){return GetOption(Qt,"timeZoneName",["auto","never","critical"],"auto")}(xt),{precision:Vt,unit:zt,increment:Wt}=ToSecondsStringPrecisionRecord(Lt,Nt);return TemporalZonedDateTimeToString(this,Vt,Bt,Ht,jt,{unit:zt,increment:Wt,roundingMode:Ut})}toLocaleString(At,xt){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const Bt=GetOptionsObject(xt),Nt=Yt(null);if(CopyDataProperties(Nt,Bt,["timeZone"]),Bt.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");Nt.year===void 0&&Nt.month===void 0&&Nt.day===void 0&&Nt.weekday===void 0&&Nt.dateStyle===void 0&&Nt.hour===void 0&&Nt.minute===void 0&&Nt.second===void 0&&Nt.timeStyle===void 0&&Nt.dayPeriod===void 0&&Nt.timeZoneName===void 0&&(Nt.timeZoneName="short");let jt=ToTemporalTimeZoneIdentifier(GetSlot(this,g));if(IsTimeZoneOffsetString(jt))throw new RangeError("toLocaleString does not support offset string time zones");jt=GetCanonicalTimeZoneIdentifier(jt),Nt.timeZone=jt;const Ut=new ht(At,Nt),Lt=Call(Ft,Ut,[]).calendar,Ht=ToTemporalCalendarIdentifier(GetSlot(this,p));if(Ht!=="iso8601"&&Lt!=="iso8601"&&Lt!==Ht)throw new RangeError(`cannot format ZonedDateTime with calendar ${Ht} in locale with calendar ${Lt}`);return Ut.format(GetSlot(this,S))}toJSON(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return TemporalZonedDateTimeToString(this,"auto")}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.ZonedDateTime")}startOfDay(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=dateTime(this),xt=GetIntrinsic("%Temporal.PlainDateTime%"),Bt=GetSlot(this,p),Nt=new xt(GetSlot(At,i$3),GetSlot(At,s$2),GetSlot(At,l),0,0,0,0,0,0,Bt),jt=GetSlot(this,g);return CreateTemporalZonedDateTime(GetSlot(GetInstantFor(jt,Nt,"compatible"),n),jt,Bt)}toInstant(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return new(GetIntrinsic("%Temporal.Instant%"))(GetSlot(this,n))}toPlainDate(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return TemporalDateTimeToDate(dateTime(this))}toPlainTime(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return TemporalDateTimeToTime(dateTime(this))}toPlainDateTime(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return dateTime(this)}toPlainYearMonth(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=GetSlot(this,p);return CalendarYearMonthFromFields(At,PrepareTemporalFields(this,CalendarFields(At,["monthCode","year"]),[]))}toPlainMonthDay(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=GetSlot(this,p);return CalendarMonthDayFromFields(At,PrepareTemporalFields(this,CalendarFields(At,["day","monthCode"]),[]))}getISOFields(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");const At=dateTime(this),xt=GetSlot(this,g);return{calendar:GetSlot(this,p),isoDay:GetSlot(At,l),isoHour:GetSlot(At,d$1),isoMicrosecond:GetSlot(At,u),isoMillisecond:GetSlot(At,h$1),isoMinute:GetSlot(At,m$1),isoMonth:GetSlot(At,s$2),isoNanosecond:GetSlot(At,T),isoSecond:GetSlot(At,c),isoYear:GetSlot(At,i$3),offset:GetOffsetStringFor(xt,GetSlot(this,S)),timeZone:xt}}getCalendar(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return ToTemporalCalendarObject(GetSlot(this,p))}getTimeZone(){if(!IsTemporalZonedDateTime(this))throw new TypeError("invalid receiver");return ToTemporalTimeZoneObject(GetSlot(this,g))}static from(At,xt){const Bt=GetOptionsObject(xt);return IsTemporalZonedDateTime(At)?(ToTemporalDisambiguation(Bt),ToTemporalOffset(Bt,"reject"),ToTemporalOverflow(Bt),CreateTemporalZonedDateTime(GetSlot(At,n),GetSlot(At,g),GetSlot(At,p))):ToTemporalZonedDateTime(At,Bt)}static compare(At,xt){const Bt=ToTemporalZonedDateTime(At),Nt=ToTemporalZonedDateTime(xt),jt=GetSlot(Bt,n),Ut=GetSlot(Nt,n);return JSBI.lessThan(JSBI.BigInt(jt),JSBI.BigInt(Ut))?-1:JSBI.greaterThan(JSBI.BigInt(jt),JSBI.BigInt(Ut))?1:0}}function dateTime(kt){return GetPlainDateTimeFor(GetSlot(kt,g),GetSlot(kt,S),GetSlot(kt,p))}MakeIntrinsicClass(ZonedDateTime,"Temporal.ZonedDateTime");var Pt=Object.freeze({__proto__:null,Calendar,Duration,Instant,Now:Et,PlainDate,PlainDateTime,PlainMonthDay,PlainTime,PlainYearMonth,TimeZone,ZonedDateTime});const Zt=[Instant,Calendar,PlainDate,PlainDateTime,Duration,PlainMonthDay,PlainTime,TimeZone,PlainYearMonth,ZonedDateTime];for(const kt of Zt){const At=Object.getOwnPropertyDescriptor(kt,"prototype");(At.configurable||At.enumerable||At.writable)&&(At.configurable=!1,At.enumerable=!1,At.writable=!1,Object.defineProperty(kt,"prototype",At))}var __awaiter$2s=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Time{static sleep(At){return __awaiter$2s(this,void 0,void 0,function*(){return new Promise(xt=>setTimeout(xt,At))})}static minimalSleep(){return __awaiter$2s(this,void 0,void 0,function*(){yield Time.sleep(2)})}static getCurrentTimestamp(){return Pt.Now.instant().toString({smallestUnit:"microseconds"})}static createTimestamp(At){const{year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt}=At;return Pt.ZonedDateTime.from({timeZone:"UTC",year:xt,month:Bt,day:Nt,hour:jt,minute:Ut,second:Lt,millisecond:Ht,microsecond:Vt}).toInstant().toString({smallestUnit:"microseconds"})}static createOffsetTimestamp(At,xt){const Bt=xt?Pt.Instant.from(xt):Pt.Now.instant(),Nt=Pt.Duration.from(At);return Bt.add(Nt).toString({smallestUnit:"microseconds"})}static validateTimestamp(At){try{Pt.Instant.from(At)}catch{throw new DwnError(DwnErrorCode.TimestampInvalid,`Invalid timestamp: ${At}`)}}}var __awaiter$2r=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$x=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class RecordsWrite{get message(){if(this._message.authorization===void 0)throw new DwnError(DwnErrorCode.RecordsWriteMissingSigner,"This RecordsWrite is not yet signed, JSON message cannot be generated from an incomplete state.");return this._message}get author(){return this._author}get signaturePayload(){return this._signaturePayload}get owner(){return this._owner}get ownerSignaturePayload(){return this._ownerSignaturePayload}get isSignedByAuthorDelegate(){return Message.isSignedByAuthorDelegate(this._message)}get isSignedByOwnerDelegate(){return Message.isSignedByOwnerDelegate(this._message)}get signer(){return Message.getSigner(this._message)}get ownerSignatureSigner(){var At;return((At=this._message.authorization)===null||At===void 0?void 0:At.ownerSignature)===void 0?void 0:Jws.getSignerDid(this._message.authorization.ownerSignature.signatures[0])}constructor(At,xt){this.parentContextId=xt,this._message=At,At.authorization!==void 0&&(this._author=Message.getAuthor(At),this._signaturePayload=Jws.decodePlainObjectPayload(At.authorization.signature),At.authorization.ownerSignature!==void 0&&(At.authorization.ownerDelegatedGrant!==void 0?this._owner=Message.getSigner(At.authorization.ownerDelegatedGrant):this._owner=Jws.getSignerDid(At.authorization.ownerSignature.signatures[0]),this._ownerSignaturePayload=Jws.decodePlainObjectPayload(At.authorization.ownerSignature))),this.attesters=RecordsWrite.getAttesters(At)}static parse(At){return __awaiter$2r(this,void 0,void 0,function*(){const xt=JSON.parse(JSON.stringify(At));yield Message.validateSignatureStructure(xt.authorization.signature,xt.descriptor,"RecordsWriteSignaturePayload"),xt.authorization.ownerSignature!==void 0&&(yield Message.validateSignatureStructure(xt.authorization.ownerSignature,xt.descriptor)),yield RecordsWrite.validateAttestationIntegrity(xt);const Bt=new RecordsWrite(xt);return yield Bt.validateIntegrity(),Bt})}static create(At){var xt,Bt,Nt,jt;return __awaiter$2r(this,void 0,void 0,function*(){if(At.protocol===void 0&&At.protocolPath!==void 0||At.protocol!==void 0&&At.protocolPath===void 0)throw new DwnError(DwnErrorCode.RecordsWriteCreateProtocolAndProtocolPathMutuallyInclusive,"`protocol` and `protocolPath` must both be defined or undefined at the same time");if(At.data===void 0&&At.dataCid===void 0||At.data!==void 0&&At.dataCid!==void 0)throw new DwnError(DwnErrorCode.RecordsWriteCreateDataAndDataCidMutuallyExclusive,"one and only one parameter between `data` and `dataCid` is required");if(At.dataCid===void 0&&At.dataSize!==void 0||At.dataCid!==void 0&&At.dataSize===void 0)throw new DwnError(DwnErrorCode.RecordsWriteCreateDataCidAndDataSizeMutuallyInclusive,"`dataCid` and `dataSize` must both be defined or undefined at the same time");if(At.signer===void 0&&At.delegatedGrant!==void 0)throw new DwnError(DwnErrorCode.RecordsWriteCreateMissingSigner,"`signer` must be given when `delegatedGrant` is given");const Ut=(xt=At.dataCid)!==null&&xt!==void 0?xt:yield Cid.computeDagPbCidFromBytes(At.data),Lt=(Bt=At.dataSize)!==null&&Bt!==void 0?Bt:At.data.length,Ht=Time.getCurrentTimestamp(),Vt={interface:DwnInterfaceName.Records,method:DwnMethodName.Write,protocol:At.protocol!==void 0?normalizeProtocolUrl(At.protocol):void 0,protocolPath:At.protocolPath,recipient:At.recipient,schema:At.schema!==void 0?normalizeSchemaUrl(At.schema):void 0,tags:At.tags,parentId:RecordsWrite.getRecordIdFromContextId(At.parentContextId),dataCid:Ut,dataSize:Lt,dateCreated:(Nt=At.dateCreated)!==null&&Nt!==void 0?Nt:Ht,messageTimestamp:(jt=At.messageTimestamp)!==null&&jt!==void 0?jt:Ht,published:At.published,datePublished:At.datePublished,dataFormat:At.dataFormat};At.published===!0&&At.datePublished===void 0&&(Vt.datePublished=Ht),removeUndefinedProperties$2(Vt);const zt=At.recordId,Wt=yield Cid.computeCid(Vt),Jt=yield RecordsWrite.createAttestation(Wt,At.attestationSigners),Qt=yield RecordsWrite.createEncryptionProperty(Vt,At.encryptionInput),Xt={recordId:zt,descriptor:Vt};Jt!==void 0&&(Xt.attestation=Jt),Qt!==void 0&&(Xt.encryption=Qt);const tr=new RecordsWrite(Xt,At.parentContextId);return At.signer!==void 0&&(yield tr.sign({signer:At.signer,delegatedGrant:At.delegatedGrant,permissionGrantId:At.permissionGrantId,protocolRole:At.protocolRole})),tr})}static getRecordIdFromContextId(At){return At==null?void 0:At.split("/").filter(xt=>xt!=="").pop()}static createFrom(At){var xt,Bt,Nt,jt;return __awaiter$2r(this,void 0,void 0,function*(){const Ut=At.recordsWriteMessage,Lt=yield RecordsWrite.parse(Ut),Ht=Time.getCurrentTimestamp(),Vt=(xt=At.published)!==null&&xt!==void 0?xt:At.datePublished?!0:Ut.descriptor.published;let zt;At.datePublished?zt=At.datePublished:Vt&&(Ut.descriptor.published?zt=Ut.descriptor.datePublished:zt=Ht);const Wt={recipient:Ut.descriptor.recipient,recordId:Ut.recordId,dateCreated:Ut.descriptor.dateCreated,protocol:Ut.descriptor.protocol,protocolPath:Ut.descriptor.protocolPath,schema:Ut.descriptor.schema,parentContextId:Records.getParentContextFromOfContextId(Ut.contextId),messageTimestamp:(Bt=At.messageTimestamp)!==null&&Bt!==void 0?Bt:Ht,published:Vt,datePublished:zt,tags:At.tags,data:At.data,dataCid:At.data?void 0:Ut.descriptor.dataCid,dataSize:At.data?void 0:Ut.descriptor.dataSize,dataFormat:(Nt=At.dataFormat)!==null&&Nt!==void 0?Nt:Ut.descriptor.dataFormat,protocolRole:(jt=At.protocolRole)!==null&&jt!==void 0?jt:Lt.signaturePayload.protocolRole,delegatedGrant:At.delegatedGrant,signer:At.signer,attestationSigners:At.attestationSigners};return yield RecordsWrite.create(Wt)})}toJSON(){return this.message}encryptSymmetricEncryptionKey(At){return __awaiter$2r(this,void 0,void 0,function*(){this._message.encryption=yield RecordsWrite.createEncryptionProperty(this._message.descriptor,At),delete this._message.authorization,this._signaturePayload=void 0,this._author=void 0})}sign(At){var xt;return __awaiter$2r(this,void 0,void 0,function*(){const{signer:Bt,delegatedGrant:Nt,permissionGrantId:jt,protocolRole:Ut}=At;let Lt,Ht;Nt!==void 0?(Lt=yield Message.getCid(Nt),Ht=Jws.getSignerDid(Nt.authorization.signature.signatures[0])):Ht=Jws.extractDid(Bt.keyId);const Vt=this._message.descriptor,zt=yield Cid.computeCid(Vt);this._message.recordId=(xt=this._message.recordId)!==null&&xt!==void 0?xt:yield RecordsWrite.getEntryId(Ht,Vt),this._message.descriptor.protocol!==void 0&&(this.parentContextId===void 0||this.parentContextId===""?this._message.contextId=this._message.recordId:this._message.contextId=this.parentContextId+"/"+this._message.recordId);const Wt=yield RecordsWrite.createSignerSignature({recordId:this._message.recordId,contextId:this._message.contextId,descriptorCid:zt,attestation:this._message.attestation,encryption:this._message.encryption,signer:Bt,delegatedGrantId:Lt,permissionGrantId:jt,protocolRole:Ut});this._message.authorization={signature:Wt},Nt!==void 0&&(this._message.authorization.authorDelegatedGrant=Nt),this._signaturePayload=Jws.decodePlainObjectPayload(Wt),this._author=Ht})}signAsOwner(At){return __awaiter$2r(this,void 0,void 0,function*(){if(this._author===void 0)throw new DwnError(DwnErrorCode.RecordsWriteSignAsOwnerUnknownAuthor,"Unable to sign as owner without message signature because owner needs to sign over `recordId` which depends on author DID.");const xt=this._message.descriptor,Bt=yield Message.createSignature(xt,At);this._message.authorization.ownerSignature=Bt,this._ownerSignaturePayload=Jws.decodePlainObjectPayload(Bt),this._owner=Jws.extractDid(At.keyId)})}signAsOwnerDelegate(At,xt){return __awaiter$2r(this,void 0,void 0,function*(){if(this._author===void 0)throw new DwnError(DwnErrorCode.RecordsWriteSignAsOwnerDelegateUnknownAuthor,"Unable to sign as owner delegate without message signature because owner delegate needs to sign over `recordId` which depends on author DID.");const Bt=yield Message.getCid(xt),Nt=this._message.descriptor,jt=yield Message.createSignature(Nt,At,{delegatedGrantId:Bt});this._message.authorization.ownerSignature=jt,this._message.authorization.ownerDelegatedGrant=xt,this._ownerSignaturePayload=Jws.decodePlainObjectPayload(jt),this._owner=Jws.getSignerDid(xt.authorization.signature.signatures[0])})}validateIntegrity(){return __awaiter$2r(this,void 0,void 0,function*(){if(yield this.isInitialWrite()){const Bt=this.message.descriptor.dateCreated,Nt=this.message.descriptor.messageTimestamp;if(Nt!==Bt)throw new DwnError(DwnErrorCode.RecordsWriteValidateIntegrityDateCreatedMismatch,`messageTimestamp ${Nt} must match dateCreated ${Bt} for the initial write`);if(this.message.descriptor.protocol!==void 0&&this.message.descriptor.parentId===void 0){const jt=yield this.getEntryId();if(this.message.contextId!==jt)throw new DwnError(DwnErrorCode.RecordsWriteValidateIntegrityContextIdMismatch,`contextId in message: ${this.message.contextId} does not match deterministic contextId: ${jt}`)}}const xt=this.signaturePayload;if(this.message.recordId!==xt.recordId)throw new DwnError(DwnErrorCode.RecordsWriteValidateIntegrityRecordIdUnauthorized,`recordId in message ${this.message.recordId} does not match recordId in authorization: ${xt.recordId}`);if(this.message.contextId!==xt.contextId)throw new DwnError(DwnErrorCode.RecordsWriteValidateIntegrityContextIdNotInSignerSignaturePayload,`contextId in message ${this.message.contextId} does not match contextId in authorization: ${xt.contextId}`);if(yield Records.validateDelegatedGrantReferentialIntegrity(this.message,xt,this.ownerSignaturePayload),xt.attestationCid!==void 0){const Bt=yield Cid.computeCid(this.message.attestation),Nt=xt.attestationCid;if(Nt!==Bt)throw new DwnError(DwnErrorCode.RecordsWriteValidateIntegrityAttestationMismatch,`CID ${Bt} of attestation property in message does not match attestationCid in authorization: ${Nt}`)}if(xt.encryptionCid!==void 0){const Bt=yield Cid.computeCid(this.message.encryption),Nt=xt.encryptionCid;if(Nt!==Bt)throw new DwnError(DwnErrorCode.RecordsWriteValidateIntegrityEncryptionCidMismatch,`CID ${Bt} of encryption property in message does not match encryptionCid in authorization: ${Nt}`)}this.message.descriptor.protocol!==void 0&&validateProtocolUrlNormalized(this.message.descriptor.protocol),this.message.descriptor.schema!==void 0&&validateSchemaUrlNormalized(this.message.descriptor.schema),Time.validateTimestamp(this.message.descriptor.messageTimestamp),Time.validateTimestamp(this.message.descriptor.dateCreated),this.message.descriptor.datePublished&&Time.validateTimestamp(this.message.descriptor.datePublished)})}static validateAttestationIntegrity(At){return __awaiter$2r(this,void 0,void 0,function*(){if(At.attestation===void 0)return;if(At.attestation.signatures.length!==1)throw new DwnError(DwnErrorCode.RecordsWriteAttestationIntegrityMoreThanOneSignature,`Currently implementation only supports 1 attester, but got ${At.attestation.signatures.length}`);const xt=Jws.decodePlainObjectPayload(At.attestation),{descriptorCid:Bt}=xt,Nt=yield Cid.computeCid(At.descriptor);if(Bt!==Nt)throw new DwnError(DwnErrorCode.RecordsWriteAttestationIntegrityDescriptorCidMismatch,`descriptorCid ${Bt} does not match expected descriptorCid ${Nt}`);const jt=Object.keys(xt).length;if(jt>1)throw new DwnError(DwnErrorCode.RecordsWriteAttestationIntegrityInvalidPayloadProperty,`Only 'descriptorCid' is allowed in attestation payload, but got ${jt} properties.`)})}getEntryId(){return __awaiter$2r(this,void 0,void 0,function*(){return yield RecordsWrite.getEntryId(this.author,this.message.descriptor)})}static getEntryId(At,xt){return __awaiter$2r(this,void 0,void 0,function*(){if(At===void 0)throw new DwnError(DwnErrorCode.RecordsWriteGetEntryIdUndefinedAuthor,"Property `author` is needed to compute entry ID.");const Bt=Object.assign({},xt);return Bt.author=At,yield Cid.computeCid(Bt)})}isInitialWrite(){return __awaiter$2r(this,void 0,void 0,function*(){return(yield this.getEntryId())===this.message.recordId})}constructIndexes(At){return __awaiter$2r(this,void 0,void 0,function*(){const xt=this.message,Bt=xt.descriptor,{tags:Nt}=Bt,jt=__rest$x(Bt,["tags"]);delete jt.published;let Ut=Object.assign(Object.assign({},jt),{isLatestBaseState:At,published:!!xt.descriptor.published,author:this.author,recordId:xt.recordId,entryId:yield RecordsWrite.getEntryId(this.author,this.message.descriptor)});if(Nt!==void 0&&At===!0){const Lt=Records.buildTagIndexes(Object.assign({},Nt));Ut=Object.assign(Object.assign({},Ut),Lt)}return this.attesters.length>0&&(Ut.attester=this.attesters[0]),xt.contextId!==void 0&&(Ut.contextId=xt.contextId),Ut})}authorizeAuthorDelegate(At){return __awaiter$2r(this,void 0,void 0,function*(){const xt=yield PermissionGrant$1.parse(this.message.authorization.authorDelegatedGrant);yield RecordsGrantAuthorization.authorizeWrite({recordsWriteMessage:this.message,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:xt,messageStore:At})})}authorizeOwnerDelegate(At){return __awaiter$2r(this,void 0,void 0,function*(){const xt=yield PermissionGrant$1.parse(this.message.authorization.ownerDelegatedGrant);yield RecordsGrantAuthorization.authorizeWrite({recordsWriteMessage:this.message,expectedGrantor:this.owner,expectedGrantee:this.ownerSignatureSigner,permissionGrant:xt,messageStore:At})})}static isInitialWrite(At){return __awaiter$2r(this,void 0,void 0,function*(){if(At.descriptor.interface!==DwnInterfaceName.Records||At.descriptor.method!==DwnMethodName.Write)return!1;const xt=At,Bt=Message.getAuthor(xt);return(yield RecordsWrite.getEntryId(Bt,xt.descriptor))===xt.recordId})}static createEncryptionProperty(At,xt){var Bt,Nt;return __awaiter$2r(this,void 0,void 0,function*(){if(xt===void 0)return;const jt=[];for(const Lt of xt.keyEncryptionInputs){if(Lt.derivationScheme===KeyDerivationScheme.ProtocolPath&&At.protocol===void 0)throw new DwnError(DwnErrorCode.RecordsWriteMissingProtocol,"`protocols` encryption scheme cannot be applied to record without the `protocol` property.");if(Lt.derivationScheme===KeyDerivationScheme.Schemas&&At.schema===void 0)throw new DwnError(DwnErrorCode.RecordsWriteMissingSchema,"`schemas` encryption scheme cannot be applied to record without the `schema` property.");const Ht=Secp256k1$3.publicJwkToBytes(Lt.publicKey),Vt=yield Encryption.eciesSecp256k1Encrypt(Ht,xt.key),zt=Encoder$4.bytesToBase64Url(Vt.ciphertext),Wt=yield Secp256k1$3.publicKeyToJwk(Vt.ephemeralPublicKey),Jt=Encoder$4.bytesToBase64Url(Vt.initializationVector),Qt=Encoder$4.bytesToBase64Url(Vt.messageAuthenticationCode),Xt={rootKeyId:Lt.publicKeyId,algorithm:(Bt=Lt.algorithm)!==null&&Bt!==void 0?Bt:EncryptionAlgorithm.EciesSecp256k1,derivationScheme:Lt.derivationScheme,ephemeralPublicKey:Wt,initializationVector:Jt,messageAuthenticationCode:Qt,encryptedKey:zt};Lt.derivationScheme===KeyDerivationScheme.ProtocolContext&&(Xt.derivedPublicKey=Lt.publicKey),jt.push(Xt)}return{algorithm:(Nt=xt.algorithm)!==null&&Nt!==void 0?Nt:EncryptionAlgorithm.Aes256Ctr,initializationVector:Encoder$4.bytesToBase64Url(xt.initializationVector),keyEncryption:jt}})}static createAttestation(At,xt){return __awaiter$2r(this,void 0,void 0,function*(){if(xt===void 0||xt.length===0)return;const Bt={descriptorCid:At},Nt=Encoder$4.objectToBytes(Bt);return(yield GeneralJwsBuilder.create(Nt,xt)).getJws()})}static createSignerSignature(At){return __awaiter$2r(this,void 0,void 0,function*(){const{recordId:xt,contextId:Bt,descriptorCid:Nt,attestation:jt,encryption:Ut,signer:Lt,delegatedGrantId:Ht,permissionGrantId:Vt,protocolRole:zt}=At,Wt=jt?yield Cid.computeCid(jt):void 0,Jt=Ut?yield Cid.computeCid(Ut):void 0,Qt={recordId:xt,descriptorCid:Nt,contextId:Bt,attestationCid:Wt,encryptionCid:Jt,delegatedGrantId:Ht,permissionGrantId:Vt,protocolRole:zt};removeUndefinedProperties$2(Qt);const Xt=Encoder$4.objectToBytes(Qt);return(yield GeneralJwsBuilder.create(Xt,[Lt])).getJws()})}static getInitialWrite(At){return __awaiter$2r(this,void 0,void 0,function*(){for(const xt of At)if(yield RecordsWrite.isInitialWrite(xt))return xt;throw new DwnError(DwnErrorCode.RecordsWriteGetInitialWriteNotFound,"Initial write is not found.")})}static verifyEqualityOfImmutableProperties(At,xt){const Bt=["dataCid","dataSize","dataFormat","datePublished","published","messageTimestamp","tags"];let Nt=[];Nt.push(...Object.keys(At.descriptor)),Nt.push(...Object.keys(xt.descriptor)),Nt=[...new Set(Nt)];for(const jt of Nt)if(Bt.indexOf(jt)===-1){const Ut=At.descriptor[jt],Lt=xt.descriptor[jt];if(Lt!==Ut)throw new DwnError(DwnErrorCode.RecordsWriteImmutablePropertyChanged,`${jt} is an immutable property: cannot change '${Ut}' to '${Lt}'`)}return!0}static getAttesters(At){var xt,Bt;return((Bt=(xt=At.attestation)===null||xt===void 0?void 0:xt.signatures)!==null&&Bt!==void 0?Bt:[]).map(Ut=>Jws.getSignerDid(Ut))}static fetchNewestRecordsWrite(At,xt,Bt){return __awaiter$2r(this,void 0,void 0,function*(){const Nt={interface:DwnInterfaceName.Records,method:DwnMethodName.Write,recordId:Bt},{messages:jt}=yield At.query(xt,[Nt]),Ut=yield Message.getNewestMessage(jt);if(Ut!==void 0)return Ut;throw new DwnError(DwnErrorCode.RecordsWriteGetNewestWriteRecordNotFound,"record not found")})}static fetchInitialRecordsWrite(At,xt,Bt){return __awaiter$2r(this,void 0,void 0,function*(){const Nt={entryId:Bt},{messages:jt}=yield At.query(xt,[Nt]);return jt.length===0?void 0:yield RecordsWrite.parse(jt[0])})}}var __awaiter$2q=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function authenticate(kt,At){return __awaiter$2q(this,void 0,void 0,function*(){if(kt===void 0)throw new DwnError(DwnErrorCode.AuthenticateJwsMissing,"Missing JWS.");if(yield GeneralJwsVerifier.verifySignatures(kt.signature,At),kt.ownerSignature!==void 0&&(yield GeneralJwsVerifier.verifySignatures(kt.ownerSignature,At)),kt.authorDelegatedGrant!==void 0){const xt=yield RecordsWrite.parse(kt.authorDelegatedGrant);yield GeneralJwsVerifier.verifySignatures(xt.message.authorization.signature,At)}if(kt.ownerDelegatedGrant!==void 0){const xt=yield RecordsWrite.parse(kt.ownerDelegatedGrant);yield GeneralJwsVerifier.verifySignatures(xt.message.authorization.signature,At)}})}var __awaiter$2p=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class AllowAllTenantGate{isActiveTenant(At){return __awaiter$2p(this,void 0,void 0,function*(){return{isActiveTenant:!0}})}}class AbstractMessage{get message(){return this._message}get signer(){return this._signer}get author(){return this._author}get signaturePayload(){return this._signaturePayload}get isSignedByAuthorDelegate(){return Message.isSignedByAuthorDelegate(this._message)}constructor(At){this._message=At,At.authorization!==void 0&&(this._signer=Message.getSigner(At),At.authorization.authorDelegatedGrant!==void 0?this._author=Message.getSigner(At.authorization.authorDelegatedGrant):this._author=this._signer,this._signaturePayload=Jws.decodePlainObjectPayload(At.authorization.signature))}toJSON(){return this.message}}var __awaiter$2o=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsQuery extends AbstractMessage{static parse(At){return __awaiter$2o(this,void 0,void 0,function*(){if(At.descriptor.filter.published===!1&&(At.descriptor.dateSort===DateSort.PublishedAscending||At.descriptor.dateSort===DateSort.PublishedDescending))throw new DwnError(DwnErrorCode.RecordsQueryParseFilterPublishedSortInvalid,`queries must not filter for \`published:false\` and sort by ${At.descriptor.dateSort}`);let xt;if(At.authorization!==void 0&&(xt=yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor)),yield Records.validateDelegatedGrantReferentialIntegrity(At,xt),(xt==null?void 0:xt.protocolRole)!==void 0&&At.descriptor.filter.protocolPath===void 0)throw new DwnError(DwnErrorCode.RecordsQueryFilterMissingRequiredProperties,"Role-authorized queries must include `protocolPath` in the filter");return At.descriptor.filter.protocol!==void 0&&validateProtocolUrlNormalized(At.descriptor.filter.protocol),At.descriptor.filter.schema!==void 0&&validateSchemaUrlNormalized(At.descriptor.filter.schema),Time.validateTimestamp(At.descriptor.messageTimestamp),new RecordsQuery(At)})}static create(At){var xt;return __awaiter$2o(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Records,method:DwnMethodName.Query,messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Time.getCurrentTimestamp(),filter:Records.normalizeFilter(At.filter),dateSort:At.dateSort,pagination:At.pagination};if(At.filter.published===!1&&(At.dateSort===DateSort.PublishedAscending||At.dateSort===DateSort.PublishedDescending))throw new DwnError(DwnErrorCode.RecordsQueryCreateFilterPublishedSortInvalid,`queries must not filter for \`published:false\` and sort by ${At.dateSort}`);removeUndefinedProperties$2(Bt);const Nt=At.signer;let jt;Nt&&(jt=yield Message.createAuthorization({descriptor:Bt,signer:Nt,protocolRole:At.protocolRole,delegatedGrant:At.delegatedGrant}));const Ut={descriptor:Bt,authorization:jt};return Message.validateJsonSchema(Ut),new RecordsQuery(Ut)})}authorizeDelegate(At){return __awaiter$2o(this,void 0,void 0,function*(){const xt=yield PermissionGrant$1.parse(this.message.authorization.authorDelegatedGrant);yield RecordsGrantAuthorization.authorizeQueryOrSubscribe({incomingMessage:this.message,expectedGrantee:this.signer,expectedGrantor:this.author,permissionGrant:xt,messageStore:At})})}}var __awaiter$2n=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DataStream{static toBytes(At){return __awaiter$2n(this,void 0,void 0,function*(){return new Promise((xt,Bt)=>{const Nt=[];At.on("data",jt=>{Nt.push(jt)}),At.on("end",()=>{const jt=DataStream.concatenateArrayOfBytes(Nt);xt(jt)}),At.on("error",Bt)})})}static toObject(At){return __awaiter$2n(this,void 0,void 0,function*(){const xt=yield DataStream.toBytes(At);return Encoder$4.bytesToObject(xt)})}static concatenateArrayOfBytes(At){const xt=At.reduce((jt,Ut)=>jt+Ut.length,0),Bt=new Uint8Array(xt);let Nt=0;for(const jt of At)Bt.set(jt,Nt),Nt+=jt.length;return Bt}static fromBytes(At){let Bt=0;return new browserExports$1.Readable({read(jt){Bt+1e5>At.length?(this.push(At.subarray(Bt)),this.push(null)):(this.push(At.subarray(Bt,Bt+1e5)),Bt=Bt+1e5)}})}static fromObject(At){const xt=Encoder$4.objectToBytes(At);return DataStream.fromBytes(xt)}static duplicateDataStream(At,xt){const Bt=[];for(let Nt=0;Nt<xt;Nt++){const jt=new browserExports$1.PassThrough;At.pipe(jt),Bt.push(jt)}return Bt}}function messageReplyFromError(kt,At){const xt=kt instanceof Error?kt.message:"Error";return{status:{code:At,detail:xt}}}var __awaiter$2m=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let PermissionRequest$1=class cs{static parse(At){return __awaiter$2m(this,void 0,void 0,function*(){return new cs(At)})}constructor(At){this.id=At.recordId,this.requester=Message.getSigner(At);const xt=At.encodedData,Bt=Encoder$4.base64UrlToObject(xt);this.delegated=Bt.delegated,this.description=Bt.description,this.scope=Bt.scope,this.conditions=Bt.conditions}};var __awaiter$2l=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class PermissionsProtocol{static parseRequest(At){return Encoder$4.base64UrlToObject(At)}static createRequest(At){return __awaiter$2l(this,void 0,void 0,function*(){if(this.isRecordPermissionScope(At.scope)&&At.scope.protocol===void 0)throw new DwnError(DwnErrorCode.PermissionsProtocolCreateRequestRecordsScopeMissingProtocol,"Permission request for Records must have a scope with a `protocol` property");const xt=PermissionsProtocol.normalizePermissionScope(At.scope),Bt={description:At.description,delegated:At.delegated,scope:xt,conditions:At.conditions};let Nt;this.hasProtocolScope(xt)&&(Nt={protocol:xt.protocol});const jt=Encoder$4.objectToBytes(Bt),Ut=yield RecordsWrite.create({signer:At.signer,messageTimestamp:At.dateRequested,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.requestPath,dataFormat:"application/json",data:jt,tags:Nt}),Lt=Object.assign(Object.assign({},Ut.message),{encodedData:Encoder$4.bytesToBase64Url(jt)});return{recordsWrite:Ut,permissionRequestData:Bt,permissionRequestBytes:jt,dataEncodedMessage:Lt}})}static createGrant(At){return __awaiter$2l(this,void 0,void 0,function*(){if(this.isRecordPermissionScope(At.scope)&&At.scope.protocol===void 0)throw new DwnError(DwnErrorCode.PermissionsProtocolCreateGrantRecordsScopeMissingProtocol,"Permission grants for Records must have a scope with a `protocol` property");const xt=PermissionsProtocol.normalizePermissionScope(At.scope),Bt={dateExpires:At.dateExpires,requestId:At.requestId,description:At.description,delegated:At.delegated,scope:xt,conditions:At.conditions};let Nt;this.hasProtocolScope(xt)&&(Nt={protocol:xt.protocol});const jt=Encoder$4.objectToBytes(Bt),Ut=yield RecordsWrite.create({signer:At.signer,messageTimestamp:At.dateGranted,dateCreated:At.dateGranted,recipient:At.grantedTo,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.grantPath,dataFormat:"application/json",data:jt,tags:Nt}),Lt=Object.assign(Object.assign({},Ut.message),{encodedData:Encoder$4.bytesToBase64Url(jt)});return{recordsWrite:Ut,permissionGrantData:Bt,permissionGrantBytes:jt,dataEncodedMessage:Lt}})}static createRevocation(At){return __awaiter$2l(this,void 0,void 0,function*(){const xt={description:At.description},Bt=At.grant.id;let Nt;this.hasProtocolScope(At.grant.scope)&&(Nt={protocol:normalizeProtocolUrl(At.grant.scope.protocol)});const jt=Encoder$4.objectToBytes(xt),Ut=yield RecordsWrite.create({signer:At.signer,parentContextId:Bt,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.revocationPath,dataFormat:"application/json",data:jt,tags:Nt}),Lt=Object.assign(Object.assign({},Ut.message),{encodedData:Encoder$4.bytesToBase64Url(jt)});return{recordsWrite:Ut,permissionRevocationData:xt,permissionRevocationBytes:jt,dataEncodedMessage:Lt}})}static validateSchema(At,xt){const Bt=Encoder$4.bytesToString(xt),Nt=JSON.parse(Bt);if(At.descriptor.protocolPath===PermissionsProtocol.requestPath){const jt=Nt;validateJsonSchema("PermissionRequestData",jt),PermissionsProtocol.validateScopeAndTags(jt.scope,At)}else if(At.descriptor.protocolPath===PermissionsProtocol.grantPath){validateJsonSchema("PermissionGrantData",Nt);const jt=Nt;PermissionsProtocol.validateScopeAndTags(jt.scope,At),Time.validateTimestamp(jt.dateExpires)}else if(At.descriptor.protocolPath===PermissionsProtocol.revocationPath)validateJsonSchema("PermissionRevocationData",Nt);else throw new DwnError(DwnErrorCode.PermissionsProtocolValidateSchemaUnexpectedRecord,`Unexpected permission record: ${At.descriptor.protocolPath}`)}static fetchGrant(At,xt,Bt){return __awaiter$2l(this,void 0,void 0,function*(){const Nt={recordId:Bt,isLatestBaseState:!0},{messages:jt}=yield xt.query(At,[Nt]),Ut=jt[0],Lt=Ut==null?void 0:Ut.descriptor.interface,Ht=Ut==null?void 0:Ut.descriptor.method;if(Lt!==DwnInterfaceName.Records||Ht!==DwnMethodName.Write||Ut.descriptor.protocolPath!==PermissionsProtocol.grantPath)throw new DwnError(DwnErrorCode.GrantAuthorizationGrantMissing,`Could not find permission grant with record ID ${Bt}.`);const Vt=Ut;return yield PermissionGrant$1.parse(Vt)})}static getScopeFromPermissionRecord(At,xt,Bt){return __awaiter$2l(this,void 0,void 0,function*(){if(Bt.descriptor.protocol!==PermissionsProtocol.uri)throw new DwnError(DwnErrorCode.PermissionsProtocolGetScopeInvalidProtocol,`Unexpected protocol for permission record: ${Bt.descriptor.protocol}`);return Bt.descriptor.protocolPath===PermissionsProtocol.revocationPath?(yield PermissionsProtocol.fetchGrant(At,xt,Bt.descriptor.parentId)).scope:Bt.descriptor.protocolPath===PermissionsProtocol.grantPath?(yield PermissionGrant$1.parse(Bt)).scope:(yield PermissionRequest$1.parse(Bt)).scope})}static normalizePermissionScope(At){const xt=Object.assign({},At);return PermissionsProtocol.hasProtocolScope(xt)&&(xt.protocol=normalizeProtocolUrl(xt.protocol)),xt}static isRecordPermissionScope(At){return At.interface==="Records"}static hasProtocolScope(At){return"protocol"in At&&At.protocol!==void 0}static validateTags(At,xt){if(At.descriptor.tags===void 0||At.descriptor.tags.protocol===void 0)throw new DwnError(DwnErrorCode.PermissionsProtocolValidateScopeMissingProtocolTag,"Permission grants must have a `tags` property that contains a protocol tag");const Bt=At.descriptor.tags.protocol;if(Bt!==xt)throw new DwnError(DwnErrorCode.PermissionsProtocolValidateScopeProtocolMismatch,`Permission grants must have a scope with a protocol that matches the tagged protocol: ${Bt}`)}static validateScopeAndTags(At,xt){if(this.hasProtocolScope(At)&&(validateProtocolUrlNormalized(At.protocol),this.validateTags(xt,At.protocol)),!!this.isRecordPermissionScope(At)&&At.contextId!==void 0&&At.protocolPath!==void 0)throw new DwnError(DwnErrorCode.PermissionsProtocolValidateScopeContextIdProhibitedProperties,"Permission grants cannot have both `contextId` and `protocolPath` present")}}PermissionsProtocol.uri="https://tbd.website/dwn/permissions";PermissionsProtocol.requestPath="request";PermissionsProtocol.grantPath="grant";PermissionsProtocol.revocationPath="grant/revocation";PermissionsProtocol.definition={published:!0,protocol:PermissionsProtocol.uri,types:{request:{dataFormats:["application/json"]},grant:{dataFormats:["application/json"]},revocation:{dataFormats:["application/json"]}},structure:{request:{$size:{max:1e4},$actions:[{who:"anyone",can:["create"]}]},grant:{$size:{max:1e4},$actions:[{who:"recipient",of:"grant",can:["read","query"]}],revocation:{$size:{max:1e4},$actions:[{who:"anyone",can:["read"]}]}}}};class Messages{static normalizeFilters(At){const xt=[];for(const Bt of At){const Nt=Bt.protocol!==void 0?normalizeProtocolUrl(Bt.protocol):void 0,jt=Object.assign(Object.assign({},Bt),{protocol:Nt});removeUndefinedProperties$2(jt),isEmptyObject$1(jt)||xt.push(jt)}return xt}static convertFilters(At){const xt=[];for(const Bt of At){const Nt=this.constructPermissionRecordsFilter(Bt);Nt&&xt.push(Nt),xt.push(this.convertFilter(Bt))}return xt}static constructPermissionRecordsFilter(At){const{protocol:xt,messageTimestamp:Bt}=At;if(xt!==void 0){const Nt=Object.assign({protocol:PermissionsProtocol.uri},Records.convertTagsFilter({protocol:xt}));if(Bt!=null){const jt=FilterUtility.convertRangeCriterion(Bt);jt&&(Nt.messageTimestamp=jt)}return Nt}}static convertFilter(At){const xt=Object.assign({},At),{messageTimestamp:Bt}=At,Nt=Bt?FilterUtility.convertRangeCriterion(Bt):void 0;return Nt&&(xt.messageTimestamp=Nt,delete xt.dateUpdated),xt}}var __awaiter$2k=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesGrantAuthorization{static authorizeMessagesRead(At){return __awaiter$2k(this,void 0,void 0,function*(){const{messagesReadMessage:xt,messageToRead:Bt,expectedGrantor:Nt,expectedGrantee:jt,permissionGrant:Ut,messageStore:Lt}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Nt,expectedGrantee:jt,permissionGrant:Ut,messageStore:Lt});const Ht=Ut.scope;yield MessagesGrantAuthorization.verifyScope(Nt,Bt,Ht,Lt)})}static authorizeQueryOrSubscribe(At){return __awaiter$2k(this,void 0,void 0,function*(){const{incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}=At;if(yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}),PermissionsProtocol.hasProtocolScope(jt.scope)){const Lt=jt.scope.protocol;for(const Ht of xt.descriptor.filters)if(Ht.protocol!==Lt)throw new DwnError(DwnErrorCode.MessagesGrantAuthorizationMismatchedProtocol,`The protocol ${Ht.protocol} does not match the scoped protocol ${Lt}`)}})}static verifyScope(At,xt,Bt,Nt){return __awaiter$2k(this,void 0,void 0,function*(){if(Bt.protocol!==void 0){if(xt.descriptor.interface===DwnInterfaceName.Records){const jt=xt,Ut=Records.isRecordsWrite(jt)?jt:yield RecordsWrite.fetchNewestRecordsWrite(Nt,At,jt.descriptor.recordId);if(Ut.descriptor.protocol===Bt.protocol)return;if(Ut.descriptor.protocol===PermissionsProtocol.uri){const Lt=yield PermissionsProtocol.getScopeFromPermissionRecord(At,Nt,Ut);if(PermissionsProtocol.hasProtocolScope(Lt)&&Lt.protocol===Bt.protocol)return}}else if(xt.descriptor.interface===DwnInterfaceName.Protocols&&xt.descriptor.definition.protocol===Bt.protocol)return;throw new DwnError(DwnErrorCode.MessagesReadVerifyScopeFailed,"record message failed scope authorization")}})}}var __awaiter$2j=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesQuery extends AbstractMessage{static parse(At){return __awaiter$2j(this,void 0,void 0,function*(){Message.validateJsonSchema(At),yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor);for(const xt of At.descriptor.filters)"protocol"in xt&&xt.protocol!==void 0&&validateProtocolUrlNormalized(xt.protocol);return new MessagesQuery(At)})}static create(At){var xt;return __awaiter$2j(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Messages,method:DwnMethodName.Query,filters:At.filters?Messages.normalizeFilters(At.filters):[],messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Time.getCurrentTimestamp(),cursor:At.cursor};removeUndefinedProperties$2(Bt);const{permissionGrantId:Nt,signer:jt}=At,Ut=yield Message.createAuthorization({descriptor:Bt,signer:jt,permissionGrantId:Nt}),Lt={descriptor:Bt,authorization:Ut};return Message.validateJsonSchema(Lt),new MessagesQuery(Lt)})}}var __awaiter$2i=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesQueryHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.eventLog=Bt}handle({tenant:At,message:xt}){return __awaiter$2i(this,void 0,void 0,function*(){let Bt;try{Bt=yield MessagesQuery.parse(xt)}catch(Lt){return messageReplyFromError(Lt,400)}try{yield authenticate(xt.authorization,this.didResolver),yield MessagesQueryHandler.authorizeMessagesQuery(At,Bt,this.messageStore)}catch(Lt){return messageReplyFromError(Lt,401)}const Nt=Messages.convertFilters(xt.descriptor.filters),{events:jt,cursor:Ut}=yield this.eventLog.queryEvents(At,Nt,xt.descriptor.cursor);return{status:{code:200,detail:"OK"},entries:jt,cursor:Ut}})}static authorizeMessagesQuery(At,xt,Bt){return __awaiter$2i(this,void 0,void 0,function*(){if(xt.author!==At)if(xt.author!==void 0&&xt.signaturePayload.permissionGrantId!==void 0){const Nt=yield PermissionsProtocol.fetchGrant(At,Bt,xt.signaturePayload.permissionGrantId);yield MessagesGrantAuthorization.authorizeQueryOrSubscribe({incomingMessage:xt.message,expectedGrantor:At,expectedGrantee:xt.author,permissionGrant:Nt,messageStore:Bt})}else throw new DwnError(DwnErrorCode.MessagesQueryAuthorizationFailed,"message failed authorization")})}}var __awaiter$2h=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesRead extends AbstractMessage{static parse(At){return __awaiter$2h(this,void 0,void 0,function*(){return Message.validateJsonSchema(At),this.validateMessageCid(At.descriptor.messageCid),yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor),Time.validateTimestamp(At.descriptor.messageTimestamp),new MessagesRead(At)})}static create(At){var xt;return __awaiter$2h(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Messages,method:DwnMethodName.Read,messageCid:At.messageCid,messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Time.getCurrentTimestamp()},{signer:Nt,permissionGrantId:jt}=At,Ut=yield Message.createAuthorization({descriptor:Bt,signer:Nt,permissionGrantId:jt}),Lt={descriptor:Bt,authorization:Ut};return Message.validateJsonSchema(Lt),MessagesRead.validateMessageCid(At.messageCid),new MessagesRead(Lt)})}static validateMessageCid(At){try{Cid.parseCid(At)}catch{throw new DwnError(DwnErrorCode.MessagesReadInvalidCid,`${At} is not a valid CID`)}}}var __awaiter$2g=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesReadHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.dataStore=Bt}handle({tenant:At,message:xt}){return __awaiter$2g(this,void 0,void 0,function*(){let Bt;try{Bt=yield MessagesRead.parse(xt)}catch(Ut){return messageReplyFromError(Ut,400)}try{yield authenticate(xt.authorization,this.didResolver)}catch(Ut){return messageReplyFromError(Ut,401)}const Nt=yield this.messageStore.get(At,xt.descriptor.messageCid);if(Nt===void 0)return{status:{code:404,detail:"Not Found"}};try{yield MessagesReadHandler.authorizeMessagesRead(At,Bt,Nt,this.messageStore)}catch(Ut){return messageReplyFromError(Ut,401)}const jt={message:Nt,messageCid:xt.descriptor.messageCid};if(Records.isRecordsWrite(Nt)){const Ut=jt.message;if(Ut.encodedData!==void 0){const Lt=Encoder$4.base64UrlToBytes(Ut.encodedData);jt.data=DataStream.fromBytes(Lt),delete Ut.encodedData}else{const Lt=yield this.dataStore.get(At,Ut.recordId,Ut.descriptor.dataCid);(Lt==null?void 0:Lt.dataStream)!==void 0&&(jt.data=Lt.dataStream)}}return{status:{code:200,detail:"OK"},entry:jt}})}static authorizeMessagesRead(At,xt,Bt,Nt){return __awaiter$2g(this,void 0,void 0,function*(){if(xt.author!==At)if(xt.author!==void 0&&xt.signaturePayload.permissionGrantId!==void 0){const jt=yield PermissionsProtocol.fetchGrant(At,Nt,xt.signaturePayload.permissionGrantId);yield MessagesGrantAuthorization.authorizeMessagesRead({messagesReadMessage:xt.message,messageToRead:Bt,expectedGrantor:At,expectedGrantee:xt.author,permissionGrant:jt,messageStore:Nt})}else throw new DwnError(DwnErrorCode.MessagesReadAuthorizationFailed,"protocol message failed authorization")})}}var __awaiter$2f=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesSubscribe extends AbstractMessage{static parse(At){return __awaiter$2f(this,void 0,void 0,function*(){Message.validateJsonSchema(At),yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor);for(const xt of At.descriptor.filters)"protocol"in xt&&xt.protocol!==void 0&&validateProtocolUrlNormalized(xt.protocol);return Time.validateTimestamp(At.descriptor.messageTimestamp),new MessagesSubscribe(At)})}static create(At){var xt,Bt;return __awaiter$2f(this,void 0,void 0,function*(){const Nt=Time.getCurrentTimestamp(),jt={interface:DwnInterfaceName.Messages,method:DwnMethodName.Subscribe,filters:(xt=At.filters)!==null&&xt!==void 0?xt:[],messageTimestamp:(Bt=At.messageTimestamp)!==null&&Bt!==void 0?Bt:Nt};removeUndefinedProperties$2(jt);const{permissionGrantId:Ut,signer:Lt}=At,Ht=yield Message.createAuthorization({descriptor:jt,signer:Lt,permissionGrantId:Ut}),Vt={descriptor:jt,authorization:Ht};return Message.validateJsonSchema(Vt),new MessagesSubscribe(Vt)})}}var __awaiter$2e=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessagesSubscribeHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.eventStream=Bt}handle({tenant:At,message:xt,subscriptionHandler:Bt}){return __awaiter$2e(this,void 0,void 0,function*(){if(this.eventStream===void 0)return messageReplyFromError(new DwnError(DwnErrorCode.MessagesSubscribeEventStreamUnimplemented,"Subscriptions are not supported"),501);let Nt;try{Nt=yield MessagesSubscribe.parse(xt)}catch(zt){return messageReplyFromError(zt,400)}try{yield authenticate(xt.authorization,this.didResolver),yield MessagesSubscribeHandler.authorizeMessagesSubscribe(At,Nt,this.messageStore)}catch(zt){return messageReplyFromError(zt,401)}const{filters:jt}=xt.descriptor,Ut=Messages.convertFilters(jt),Lt=yield Message.getCid(xt),Ht=(zt,Wt,Jt)=>{At===zt&&FilterUtility.matchAnyFilter(Jt,Ut)&&Bt(Wt)},Vt=yield this.eventStream.subscribe(At,Lt,Ht);return{status:{code:200,detail:"OK"},subscription:Vt}})}static authorizeMessagesSubscribe(At,xt,Bt){return __awaiter$2e(this,void 0,void 0,function*(){if(xt.author!==At)if(xt.author!==void 0&&xt.signaturePayload.permissionGrantId!==void 0){const Nt=yield PermissionsProtocol.fetchGrant(At,Bt,xt.signaturePayload.permissionGrantId);yield MessagesGrantAuthorization.authorizeQueryOrSubscribe({incomingMessage:xt.message,expectedGrantor:At,expectedGrantee:xt.author,permissionGrant:Nt,messageStore:Bt})}else throw new DwnError(DwnErrorCode.MessagesSubscribeAuthorizationFailed,"message failed authorization")})}}var _2020={exports:{}},core$3={},validate={},boolSchema={},errors$1={},codegen={},code$2={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.regexpCode=kt.getEsmExportName=kt.getProperty=kt.safeStringify=kt.stringify=kt.strConcat=kt.addCodeArg=kt.str=kt._=kt.nil=kt._Code=kt.Name=kt.IDENTIFIER=kt._CodeOrName=void 0;class At{}kt._CodeOrName=At,kt.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class xt extends At{constructor(ar){if(super(),!kt.IDENTIFIER.test(ar))throw new Error("CodeGen: name must be a valid identifier");this.str=ar}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}kt.Name=xt;class Bt extends At{constructor(ar){super(),this._items=typeof ar=="string"?[ar]:ar}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const ar=this._items[0];return ar===""||ar==='""'}get str(){var ar;return(ar=this._str)!==null&&ar!==void 0?ar:this._str=this._items.reduce((ir,lr)=>`${ir}${lr}`,"")}get names(){var ar;return(ar=this._names)!==null&&ar!==void 0?ar:this._names=this._items.reduce((ir,lr)=>(lr instanceof xt&&(ir[lr.str]=(ir[lr.str]||0)+1),ir),{})}}kt._Code=Bt,kt.nil=new Bt("");function Nt(nr,...ar){const ir=[nr[0]];let lr=0;for(;lr<ar.length;)Lt(ir,ar[lr]),ir.push(nr[++lr]);return new Bt(ir)}kt._=Nt;const jt=new Bt("+");function Ut(nr,...ar){const ir=[Qt(nr[0])];let lr=0;for(;lr<ar.length;)ir.push(jt),Lt(ir,ar[lr]),ir.push(jt,Qt(nr[++lr]));return Ht(ir),new Bt(ir)}kt.str=Ut;function Lt(nr,ar){ar instanceof Bt?nr.push(...ar._items):ar instanceof xt?nr.push(ar):nr.push(Wt(ar))}kt.addCodeArg=Lt;function Ht(nr){let ar=1;for(;ar<nr.length-1;){if(nr[ar]===jt){const ir=Vt(nr[ar-1],nr[ar+1]);if(ir!==void 0){nr.splice(ar-1,3,ir);continue}nr[ar++]="+"}ar++}}function Vt(nr,ar){if(ar==='""')return nr;if(nr==='""')return ar;if(typeof nr=="string")return ar instanceof xt||nr[nr.length-1]!=='"'?void 0:typeof ar!="string"?`${nr.slice(0,-1)}${ar}"`:ar[0]==='"'?nr.slice(0,-1)+ar.slice(1):void 0;if(typeof ar=="string"&&ar[0]==='"'&&!(nr instanceof xt))return`"${nr}${ar.slice(1)}`}function zt(nr,ar){return ar.emptyStr()?nr:nr.emptyStr()?ar:Ut`${nr}${ar}`}kt.strConcat=zt;function Wt(nr){return typeof nr=="number"||typeof nr=="boolean"||nr===null?nr:Qt(Array.isArray(nr)?nr.join(","):nr)}function Jt(nr){return new Bt(Qt(nr))}kt.stringify=Jt;function Qt(nr){return JSON.stringify(nr).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}kt.safeStringify=Qt;function Xt(nr){return typeof nr=="string"&&kt.IDENTIFIER.test(nr)?new Bt(`.${nr}`):Nt`[${nr}]`}kt.getProperty=Xt;function tr(nr){if(typeof nr=="string"&&kt.IDENTIFIER.test(nr))return new Bt(`${nr}`);throw new Error(`CodeGen: invalid export name: ${nr}, use explicit $id name mapping`)}kt.getEsmExportName=tr;function rr(nr){return new Bt(nr.toString())}kt.regexpCode=rr})(code$2);var scope$1={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.ValueScope=kt.ValueScopeName=kt.Scope=kt.varKinds=kt.UsedValueState=void 0;const At=code$2;class xt extends Error{constructor(Vt){super(`CodeGen: "code" for ${Vt} not defined`),this.value=Vt.value}}var Bt;(function(Ht){Ht[Ht.Started=0]="Started",Ht[Ht.Completed=1]="Completed"})(Bt=kt.UsedValueState||(kt.UsedValueState={})),kt.varKinds={const:new At.Name("const"),let:new At.Name("let"),var:new At.Name("var")};class Nt{constructor({prefixes:Vt,parent:zt}={}){this._names={},this._prefixes=Vt,this._parent=zt}toName(Vt){return Vt instanceof At.Name?Vt:this.name(Vt)}name(Vt){return new At.Name(this._newName(Vt))}_newName(Vt){const zt=this._names[Vt]||this._nameGroup(Vt);return`${Vt}${zt.index++}`}_nameGroup(Vt){var zt,Wt;if(!((Wt=(zt=this._parent)===null||zt===void 0?void 0:zt._prefixes)===null||Wt===void 0)&&Wt.has(Vt)||this._prefixes&&!this._prefixes.has(Vt))throw new Error(`CodeGen: prefix "${Vt}" is not allowed in this scope`);return this._names[Vt]={prefix:Vt,index:0}}}kt.Scope=Nt;class jt extends At.Name{constructor(Vt,zt){super(zt),this.prefix=Vt}setValue(Vt,{property:zt,itemIndex:Wt}){this.value=Vt,this.scopePath=(0,At._)`.${new At.Name(zt)}[${Wt}]`}}kt.ValueScopeName=jt;const Ut=(0,At._)`\n`;class Lt extends Nt{constructor(Vt){super(Vt),this._values={},this._scope=Vt.scope,this.opts={...Vt,_n:Vt.lines?Ut:At.nil}}get(){return this._scope}name(Vt){return new jt(Vt,this._newName(Vt))}value(Vt,zt){var Wt;if(zt.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const Jt=this.toName(Vt),{prefix:Qt}=Jt,Xt=(Wt=zt.key)!==null&&Wt!==void 0?Wt:zt.ref;let tr=this._values[Qt];if(tr){const ar=tr.get(Xt);if(ar)return ar}else tr=this._values[Qt]=new Map;tr.set(Xt,Jt);const rr=this._scope[Qt]||(this._scope[Qt]=[]),nr=rr.length;return rr[nr]=zt.ref,Jt.setValue(zt,{property:Qt,itemIndex:nr}),Jt}getValue(Vt,zt){const Wt=this._values[Vt];if(Wt)return Wt.get(zt)}scopeRefs(Vt,zt=this._values){return this._reduceValues(zt,Wt=>{if(Wt.scopePath===void 0)throw new Error(`CodeGen: name "${Wt}" has no value`);return(0,At._)`${Vt}${Wt.scopePath}`})}scopeCode(Vt=this._values,zt,Wt){return this._reduceValues(Vt,Jt=>{if(Jt.value===void 0)throw new Error(`CodeGen: name "${Jt}" has no value`);return Jt.value.code},zt,Wt)}_reduceValues(Vt,zt,Wt={},Jt){let Qt=At.nil;for(const Xt in Vt){const tr=Vt[Xt];if(!tr)continue;const rr=Wt[Xt]=Wt[Xt]||new Map;tr.forEach(nr=>{if(rr.has(nr))return;rr.set(nr,Bt.Started);let ar=zt(nr);if(ar){const ir=this.opts.es5?kt.varKinds.var:kt.varKinds.const;Qt=(0,At._)`${Qt}${ir} ${nr} = ${ar};${this.opts._n}`}else if(ar=Jt==null?void 0:Jt(nr))Qt=(0,At._)`${Qt}${ar}${this.opts._n}`;else throw new xt(nr);rr.set(nr,Bt.Completed)})}return Qt}}kt.ValueScope=Lt})(scope$1);(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.or=kt.and=kt.not=kt.CodeGen=kt.operators=kt.varKinds=kt.ValueScopeName=kt.ValueScope=kt.Scope=kt.Name=kt.regexpCode=kt.stringify=kt.getProperty=kt.nil=kt.strConcat=kt.str=kt._=void 0;const At=code$2,xt=scope$1;var Bt=code$2;Object.defineProperty(kt,"_",{enumerable:!0,get:function(){return Bt._}}),Object.defineProperty(kt,"str",{enumerable:!0,get:function(){return Bt.str}}),Object.defineProperty(kt,"strConcat",{enumerable:!0,get:function(){return Bt.strConcat}}),Object.defineProperty(kt,"nil",{enumerable:!0,get:function(){return Bt.nil}}),Object.defineProperty(kt,"getProperty",{enumerable:!0,get:function(){return Bt.getProperty}}),Object.defineProperty(kt,"stringify",{enumerable:!0,get:function(){return Bt.stringify}}),Object.defineProperty(kt,"regexpCode",{enumerable:!0,get:function(){return Bt.regexpCode}}),Object.defineProperty(kt,"Name",{enumerable:!0,get:function(){return Bt.Name}});var Nt=scope$1;Object.defineProperty(kt,"Scope",{enumerable:!0,get:function(){return Nt.Scope}}),Object.defineProperty(kt,"ValueScope",{enumerable:!0,get:function(){return Nt.ValueScope}}),Object.defineProperty(kt,"ValueScopeName",{enumerable:!0,get:function(){return Nt.ValueScopeName}}),Object.defineProperty(kt,"varKinds",{enumerable:!0,get:function(){return Nt.varKinds}}),kt.operators={GT:new At._Code(">"),GTE:new At._Code(">="),LT:new At._Code("<"),LTE:new At._Code("<="),EQ:new At._Code("==="),NEQ:new At._Code("!=="),NOT:new At._Code("!"),OR:new At._Code("||"),AND:new At._Code("&&"),ADD:new At._Code("+")};class jt{optimizeNodes(){return this}optimizeNames(Pr,Nr){return this}}class Ut extends jt{constructor(Pr,Nr,Cr){super(),this.varKind=Pr,this.name=Nr,this.rhs=Cr}render({es5:Pr,_n:Nr}){const Cr=Pr?xt.varKinds.var:this.varKind,xr=this.rhs===void 0?"":` = ${this.rhs}`;return`${Cr} ${this.name}${xr};`+Nr}optimizeNames(Pr,Nr){if(Pr[this.name.str])return this.rhs&&(this.rhs=dr(this.rhs,Pr,Nr)),this}get names(){return this.rhs instanceof At._CodeOrName?this.rhs.names:{}}}class Lt extends jt{constructor(Pr,Nr,Cr){super(),this.lhs=Pr,this.rhs=Nr,this.sideEffects=Cr}render({_n:Pr}){return`${this.lhs} = ${this.rhs};`+Pr}optimizeNames(Pr,Nr){if(!(this.lhs instanceof At.Name&&!Pr[this.lhs.str]&&!this.sideEffects))return this.rhs=dr(this.rhs,Pr,Nr),this}get names(){const Pr=this.lhs instanceof At.Name?{}:{...this.lhs.names};return pr(Pr,this.rhs)}}class Ht extends Lt{constructor(Pr,Nr,Cr,xr){super(Pr,Cr,xr),this.op=Nr}render({_n:Pr}){return`${this.lhs} ${this.op}= ${this.rhs};`+Pr}}class Vt extends jt{constructor(Pr){super(),this.label=Pr,this.names={}}render({_n:Pr}){return`${this.label}:`+Pr}}class zt extends jt{constructor(Pr){super(),this.label=Pr,this.names={}}render({_n:Pr}){return`break${this.label?` ${this.label}`:""};`+Pr}}class Wt extends jt{constructor(Pr){super(),this.error=Pr}render({_n:Pr}){return`throw ${this.error};`+Pr}get names(){return this.error.names}}class Jt extends jt{constructor(Pr){super(),this.code=Pr}render({_n:Pr}){return`${this.code};`+Pr}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(Pr,Nr){return this.code=dr(this.code,Pr,Nr),this}get names(){return this.code instanceof At._CodeOrName?this.code.names:{}}}class Qt extends jt{constructor(Pr=[]){super(),this.nodes=Pr}render(Pr){return this.nodes.reduce((Nr,Cr)=>Nr+Cr.render(Pr),"")}optimizeNodes(){const{nodes:Pr}=this;let Nr=Pr.length;for(;Nr--;){const Cr=Pr[Nr].optimizeNodes();Array.isArray(Cr)?Pr.splice(Nr,1,...Cr):Cr?Pr[Nr]=Cr:Pr.splice(Nr,1)}return Pr.length>0?this:void 0}optimizeNames(Pr,Nr){const{nodes:Cr}=this;let xr=Cr.length;for(;xr--;){const Rr=Cr[xr];Rr.optimizeNames(Pr,Nr)||(ur(Pr,Rr.names),Cr.splice(xr,1))}return Cr.length>0?this:void 0}get names(){return this.nodes.reduce((Pr,Nr)=>vr(Pr,Nr.names),{})}}class Xt extends Qt{render(Pr){return"{"+Pr._n+super.render(Pr)+"}"+Pr._n}}class tr extends Qt{}class rr extends Xt{}rr.kind="else";class nr extends Xt{constructor(Pr,Nr){super(Nr),this.condition=Pr}render(Pr){let Nr=`if(${this.condition})`+super.render(Pr);return this.else&&(Nr+="else "+this.else.render(Pr)),Nr}optimizeNodes(){super.optimizeNodes();const Pr=this.condition;if(Pr===!0)return this.nodes;let Nr=this.else;if(Nr){const Cr=Nr.optimizeNodes();Nr=this.else=Array.isArray(Cr)?new rr(Cr):Cr}if(Nr)return Pr===!1?Nr instanceof nr?Nr:Nr.nodes:this.nodes.length?this:new nr($r(Pr),Nr instanceof nr?[Nr]:Nr.nodes);if(!(Pr===!1||!this.nodes.length))return this}optimizeNames(Pr,Nr){var Cr;if(this.else=(Cr=this.else)===null||Cr===void 0?void 0:Cr.optimizeNames(Pr,Nr),!!(super.optimizeNames(Pr,Nr)||this.else))return this.condition=dr(this.condition,Pr,Nr),this}get names(){const Pr=super.names;return pr(Pr,this.condition),this.else&&vr(Pr,this.else.names),Pr}}nr.kind="if";class ar extends Xt{}ar.kind="for";class ir extends ar{constructor(Pr){super(),this.iteration=Pr}render(Pr){return`for(${this.iteration})`+super.render(Pr)}optimizeNames(Pr,Nr){if(super.optimizeNames(Pr,Nr))return this.iteration=dr(this.iteration,Pr,Nr),this}get names(){return vr(super.names,this.iteration.names)}}class lr extends ar{constructor(Pr,Nr,Cr,xr){super(),this.varKind=Pr,this.name=Nr,this.from=Cr,this.to=xr}render(Pr){const Nr=Pr.es5?xt.varKinds.var:this.varKind,{name:Cr,from:xr,to:Rr}=this;return`for(${Nr} ${Cr}=${xr}; ${Cr}<${Rr}; ${Cr}++)`+super.render(Pr)}get names(){const Pr=pr(super.names,this.from);return pr(Pr,this.to)}}class yr extends ar{constructor(Pr,Nr,Cr,xr){super(),this.loop=Pr,this.varKind=Nr,this.name=Cr,this.iterable=xr}render(Pr){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(Pr)}optimizeNames(Pr,Nr){if(super.optimizeNames(Pr,Nr))return this.iterable=dr(this.iterable,Pr,Nr),this}get names(){return vr(super.names,this.iterable.names)}}class Sr extends Xt{constructor(Pr,Nr,Cr){super(),this.name=Pr,this.args=Nr,this.async=Cr}render(Pr){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(Pr)}}Sr.kind="func";class Ar extends Qt{render(Pr){return"return "+super.render(Pr)}}Ar.kind="return";class Dr extends Xt{render(Pr){let Nr="try"+super.render(Pr);return this.catch&&(Nr+=this.catch.render(Pr)),this.finally&&(Nr+=this.finally.render(Pr)),Nr}optimizeNodes(){var Pr,Nr;return super.optimizeNodes(),(Pr=this.catch)===null||Pr===void 0||Pr.optimizeNodes(),(Nr=this.finally)===null||Nr===void 0||Nr.optimizeNodes(),this}optimizeNames(Pr,Nr){var Cr,xr;return super.optimizeNames(Pr,Nr),(Cr=this.catch)===null||Cr===void 0||Cr.optimizeNames(Pr,Nr),(xr=this.finally)===null||xr===void 0||xr.optimizeNames(Pr,Nr),this}get names(){const Pr=super.names;return this.catch&&vr(Pr,this.catch.names),this.finally&&vr(Pr,this.finally.names),Pr}}class Br extends Xt{constructor(Pr){super(),this.error=Pr}render(Pr){return`catch(${this.error})`+super.render(Pr)}}Br.kind="catch";class Lr extends Xt{render(Pr){return"finally"+super.render(Pr)}}Lr.kind="finally";class Or{constructor(Pr,Nr={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...Nr,_n:Nr.lines?`
`:""},this._extScope=Pr,this._scope=new xt.Scope({parent:Pr}),this._nodes=[new tr]}toString(){return this._root.render(this.opts)}name(Pr){return this._scope.name(Pr)}scopeName(Pr){return this._extScope.name(Pr)}scopeValue(Pr,Nr){const Cr=this._extScope.value(Pr,Nr);return(this._values[Cr.prefix]||(this._values[Cr.prefix]=new Set)).add(Cr),Cr}getScopeValue(Pr,Nr){return this._extScope.getValue(Pr,Nr)}scopeRefs(Pr){return this._extScope.scopeRefs(Pr,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Pr,Nr,Cr,xr){const Rr=this._scope.toName(Nr);return Cr!==void 0&&xr&&(this._constants[Rr.str]=Cr),this._leafNode(new Ut(Pr,Rr,Cr)),Rr}const(Pr,Nr,Cr){return this._def(xt.varKinds.const,Pr,Nr,Cr)}let(Pr,Nr,Cr){return this._def(xt.varKinds.let,Pr,Nr,Cr)}var(Pr,Nr,Cr){return this._def(xt.varKinds.var,Pr,Nr,Cr)}assign(Pr,Nr,Cr){return this._leafNode(new Lt(Pr,Nr,Cr))}add(Pr,Nr){return this._leafNode(new Ht(Pr,kt.operators.ADD,Nr))}code(Pr){return typeof Pr=="function"?Pr():Pr!==At.nil&&this._leafNode(new Jt(Pr)),this}object(...Pr){const Nr=["{"];for(const[Cr,xr]of Pr)Nr.length>1&&Nr.push(","),Nr.push(Cr),(Cr!==xr||this.opts.es5)&&(Nr.push(":"),(0,At.addCodeArg)(Nr,xr));return Nr.push("}"),new At._Code(Nr)}if(Pr,Nr,Cr){if(this._blockNode(new nr(Pr)),Nr&&Cr)this.code(Nr).else().code(Cr).endIf();else if(Nr)this.code(Nr).endIf();else if(Cr)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(Pr){return this._elseNode(new nr(Pr))}else(){return this._elseNode(new rr)}endIf(){return this._endBlockNode(nr,rr)}_for(Pr,Nr){return this._blockNode(Pr),Nr&&this.code(Nr).endFor(),this}for(Pr,Nr){return this._for(new ir(Pr),Nr)}forRange(Pr,Nr,Cr,xr,Rr=this.opts.es5?xt.varKinds.var:xt.varKinds.let){const qr=this._scope.toName(Pr);return this._for(new lr(Rr,qr,Nr,Cr),()=>xr(qr))}forOf(Pr,Nr,Cr,xr=xt.varKinds.const){const Rr=this._scope.toName(Pr);if(this.opts.es5){const qr=Nr instanceof At.Name?Nr:this.var("_arr",Nr);return this.forRange("_i",0,(0,At._)`${qr}.length`,Vr=>{this.var(Rr,(0,At._)`${qr}[${Vr}]`),Cr(Rr)})}return this._for(new yr("of",xr,Rr,Nr),()=>Cr(Rr))}forIn(Pr,Nr,Cr,xr=this.opts.es5?xt.varKinds.var:xt.varKinds.const){if(this.opts.ownProperties)return this.forOf(Pr,(0,At._)`Object.keys(${Nr})`,Cr);const Rr=this._scope.toName(Pr);return this._for(new yr("in",xr,Rr,Nr),()=>Cr(Rr))}endFor(){return this._endBlockNode(ar)}label(Pr){return this._leafNode(new Vt(Pr))}break(Pr){return this._leafNode(new zt(Pr))}return(Pr){const Nr=new Ar;if(this._blockNode(Nr),this.code(Pr),Nr.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Ar)}try(Pr,Nr,Cr){if(!Nr&&!Cr)throw new Error('CodeGen: "try" without "catch" and "finally"');const xr=new Dr;if(this._blockNode(xr),this.code(Pr),Nr){const Rr=this.name("e");this._currNode=xr.catch=new Br(Rr),Nr(Rr)}return Cr&&(this._currNode=xr.finally=new Lr,this.code(Cr)),this._endBlockNode(Br,Lr)}throw(Pr){return this._leafNode(new Wt(Pr))}block(Pr,Nr){return this._blockStarts.push(this._nodes.length),Pr&&this.code(Pr).endBlock(Nr),this}endBlock(Pr){const Nr=this._blockStarts.pop();if(Nr===void 0)throw new Error("CodeGen: not in self-balancing block");const Cr=this._nodes.length-Nr;if(Cr<0||Pr!==void 0&&Cr!==Pr)throw new Error(`CodeGen: wrong number of nodes: ${Cr} vs ${Pr} expected`);return this._nodes.length=Nr,this}func(Pr,Nr=At.nil,Cr,xr){return this._blockNode(new Sr(Pr,Nr,Cr)),xr&&this.code(xr).endFunc(),this}endFunc(){return this._endBlockNode(Sr)}optimize(Pr=1){for(;Pr-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Pr){return this._currNode.nodes.push(Pr),this}_blockNode(Pr){this._currNode.nodes.push(Pr),this._nodes.push(Pr)}_endBlockNode(Pr,Nr){const Cr=this._currNode;if(Cr instanceof Pr||Nr&&Cr instanceof Nr)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${Nr?`${Pr.kind}/${Nr.kind}`:Pr.kind}"`)}_elseNode(Pr){const Nr=this._currNode;if(!(Nr instanceof nr))throw new Error('CodeGen: "else" without "if"');return this._currNode=Nr.else=Pr,this}get _root(){return this._nodes[0]}get _currNode(){const Pr=this._nodes;return Pr[Pr.length-1]}set _currNode(Pr){const Nr=this._nodes;Nr[Nr.length-1]=Pr}}kt.CodeGen=Or;function vr(Tr,Pr){for(const Nr in Pr)Tr[Nr]=(Tr[Nr]||0)+(Pr[Nr]||0);return Tr}function pr(Tr,Pr){return Pr instanceof At._CodeOrName?vr(Tr,Pr.names):Tr}function dr(Tr,Pr,Nr){if(Tr instanceof At.Name)return Cr(Tr);if(!xr(Tr))return Tr;return new At._Code(Tr._items.reduce((Rr,qr)=>(qr instanceof At.Name&&(qr=Cr(qr)),qr instanceof At._Code?Rr.push(...qr._items):Rr.push(qr),Rr),[]));function Cr(Rr){const qr=Nr[Rr.str];return qr===void 0||Pr[Rr.str]!==1?Rr:(delete Pr[Rr.str],qr)}function xr(Rr){return Rr instanceof At._Code&&Rr._items.some(qr=>qr instanceof At.Name&&Pr[qr.str]===1&&Nr[qr.str]!==void 0)}}function ur(Tr,Pr){for(const Nr in Pr)Tr[Nr]=(Tr[Nr]||0)-(Pr[Nr]||0)}function $r(Tr){return typeof Tr=="boolean"||typeof Tr=="number"||Tr===null?!Tr:(0,At._)`!${_r(Tr)}`}kt.not=$r;const wr=br(kt.operators.AND);function Er(...Tr){return Tr.reduce(wr)}kt.and=Er;const gr=br(kt.operators.OR);function fr(...Tr){return Tr.reduce(gr)}kt.or=fr;function br(Tr){return(Pr,Nr)=>Pr===At.nil?Nr:Nr===At.nil?Pr:(0,At._)`${_r(Pr)} ${Tr} ${_r(Nr)}`}function _r(Tr){return Tr instanceof At.Name?Tr:(0,At._)`(${Tr})`}})(codegen);var util$1={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.checkStrictMode=kt.getErrorPath=kt.Type=kt.useFunc=kt.setEvaluated=kt.evaluatedPropsToName=kt.mergeEvaluated=kt.eachItem=kt.unescapeJsonPointer=kt.escapeJsonPointer=kt.escapeFragment=kt.unescapeFragment=kt.schemaRefOrVal=kt.schemaHasRulesButRef=kt.schemaHasRules=kt.checkUnknownRules=kt.alwaysValidSchema=kt.toHash=void 0;const At=codegen,xt=code$2;function Bt(Sr){const Ar={};for(const Dr of Sr)Ar[Dr]=!0;return Ar}kt.toHash=Bt;function Nt(Sr,Ar){return typeof Ar=="boolean"?Ar:Object.keys(Ar).length===0?!0:(jt(Sr,Ar),!Ut(Ar,Sr.self.RULES.all))}kt.alwaysValidSchema=Nt;function jt(Sr,Ar=Sr.schema){const{opts:Dr,self:Br}=Sr;if(!Dr.strictSchema||typeof Ar=="boolean")return;const Lr=Br.RULES.keywords;for(const Or in Ar)Lr[Or]||yr(Sr,`unknown keyword: "${Or}"`)}kt.checkUnknownRules=jt;function Ut(Sr,Ar){if(typeof Sr=="boolean")return!Sr;for(const Dr in Sr)if(Ar[Dr])return!0;return!1}kt.schemaHasRules=Ut;function Lt(Sr,Ar){if(typeof Sr=="boolean")return!Sr;for(const Dr in Sr)if(Dr!=="$ref"&&Ar.all[Dr])return!0;return!1}kt.schemaHasRulesButRef=Lt;function Ht({topSchemaRef:Sr,schemaPath:Ar},Dr,Br,Lr){if(!Lr){if(typeof Dr=="number"||typeof Dr=="boolean")return Dr;if(typeof Dr=="string")return(0,At._)`${Dr}`}return(0,At._)`${Sr}${Ar}${(0,At.getProperty)(Br)}`}kt.schemaRefOrVal=Ht;function Vt(Sr){return Jt(decodeURIComponent(Sr))}kt.unescapeFragment=Vt;function zt(Sr){return encodeURIComponent(Wt(Sr))}kt.escapeFragment=zt;function Wt(Sr){return typeof Sr=="number"?`${Sr}`:Sr.replace(/~/g,"~0").replace(/\//g,"~1")}kt.escapeJsonPointer=Wt;function Jt(Sr){return Sr.replace(/~1/g,"/").replace(/~0/g,"~")}kt.unescapeJsonPointer=Jt;function Qt(Sr,Ar){if(Array.isArray(Sr))for(const Dr of Sr)Ar(Dr);else Ar(Sr)}kt.eachItem=Qt;function Xt({mergeNames:Sr,mergeToName:Ar,mergeValues:Dr,resultToName:Br}){return(Lr,Or,vr,pr)=>{const dr=vr===void 0?Or:vr instanceof At.Name?(Or instanceof At.Name?Sr(Lr,Or,vr):Ar(Lr,Or,vr),vr):Or instanceof At.Name?(Ar(Lr,vr,Or),Or):Dr(Or,vr);return pr===At.Name&&!(dr instanceof At.Name)?Br(Lr,dr):dr}}kt.mergeEvaluated={props:Xt({mergeNames:(Sr,Ar,Dr)=>Sr.if((0,At._)`${Dr} !== true && ${Ar} !== undefined`,()=>{Sr.if((0,At._)`${Ar} === true`,()=>Sr.assign(Dr,!0),()=>Sr.assign(Dr,(0,At._)`${Dr} || {}`).code((0,At._)`Object.assign(${Dr}, ${Ar})`))}),mergeToName:(Sr,Ar,Dr)=>Sr.if((0,At._)`${Dr} !== true`,()=>{Ar===!0?Sr.assign(Dr,!0):(Sr.assign(Dr,(0,At._)`${Dr} || {}`),rr(Sr,Dr,Ar))}),mergeValues:(Sr,Ar)=>Sr===!0?!0:{...Sr,...Ar},resultToName:tr}),items:Xt({mergeNames:(Sr,Ar,Dr)=>Sr.if((0,At._)`${Dr} !== true && ${Ar} !== undefined`,()=>Sr.assign(Dr,(0,At._)`${Ar} === true ? true : ${Dr} > ${Ar} ? ${Dr} : ${Ar}`)),mergeToName:(Sr,Ar,Dr)=>Sr.if((0,At._)`${Dr} !== true`,()=>Sr.assign(Dr,Ar===!0?!0:(0,At._)`${Dr} > ${Ar} ? ${Dr} : ${Ar}`)),mergeValues:(Sr,Ar)=>Sr===!0?!0:Math.max(Sr,Ar),resultToName:(Sr,Ar)=>Sr.var("items",Ar)})};function tr(Sr,Ar){if(Ar===!0)return Sr.var("props",!0);const Dr=Sr.var("props",(0,At._)`{}`);return Ar!==void 0&&rr(Sr,Dr,Ar),Dr}kt.evaluatedPropsToName=tr;function rr(Sr,Ar,Dr){Object.keys(Dr).forEach(Br=>Sr.assign((0,At._)`${Ar}${(0,At.getProperty)(Br)}`,!0))}kt.setEvaluated=rr;const nr={};function ar(Sr,Ar){return Sr.scopeValue("func",{ref:Ar,code:nr[Ar.code]||(nr[Ar.code]=new xt._Code(Ar.code))})}kt.useFunc=ar;var ir;(function(Sr){Sr[Sr.Num=0]="Num",Sr[Sr.Str=1]="Str"})(ir=kt.Type||(kt.Type={}));function lr(Sr,Ar,Dr){if(Sr instanceof At.Name){const Br=Ar===ir.Num;return Dr?Br?(0,At._)`"[" + ${Sr} + "]"`:(0,At._)`"['" + ${Sr} + "']"`:Br?(0,At._)`"/" + ${Sr}`:(0,At._)`"/" + ${Sr}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return Dr?(0,At.getProperty)(Sr).toString():"/"+Wt(Sr)}kt.getErrorPath=lr;function yr(Sr,Ar,Dr=Sr.opts.strictSchema){if(Dr){if(Ar=`strict mode: ${Ar}`,Dr===!0)throw new Error(Ar);Sr.self.logger.warn(Ar)}}kt.checkStrictMode=yr})(util$1);var names$1={};Object.defineProperty(names$1,"__esModule",{value:!0});const codegen_1$x=codegen,names={data:new codegen_1$x.Name("data"),valCxt:new codegen_1$x.Name("valCxt"),instancePath:new codegen_1$x.Name("instancePath"),parentData:new codegen_1$x.Name("parentData"),parentDataProperty:new codegen_1$x.Name("parentDataProperty"),rootData:new codegen_1$x.Name("rootData"),dynamicAnchors:new codegen_1$x.Name("dynamicAnchors"),vErrors:new codegen_1$x.Name("vErrors"),errors:new codegen_1$x.Name("errors"),this:new codegen_1$x.Name("this"),self:new codegen_1$x.Name("self"),scope:new codegen_1$x.Name("scope"),json:new codegen_1$x.Name("json"),jsonPos:new codegen_1$x.Name("jsonPos"),jsonLen:new codegen_1$x.Name("jsonLen"),jsonPart:new codegen_1$x.Name("jsonPart")};names$1.default=names;(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.extendErrors=kt.resetErrorsCount=kt.reportExtraError=kt.reportError=kt.keyword$DataError=kt.keywordError=void 0;const At=codegen,xt=util$1,Bt=names$1;kt.keywordError={message:({keyword:rr})=>(0,At.str)`must pass "${rr}" keyword validation`},kt.keyword$DataError={message:({keyword:rr,schemaType:nr})=>nr?(0,At.str)`"${rr}" keyword must be ${nr} ($data)`:(0,At.str)`"${rr}" keyword is invalid ($data)`};function Nt(rr,nr=kt.keywordError,ar,ir){const{it:lr}=rr,{gen:yr,compositeRule:Sr,allErrors:Ar}=lr,Dr=Wt(rr,nr,ar);ir??(Sr||Ar)?Ht(yr,Dr):Vt(lr,(0,At._)`[${Dr}]`)}kt.reportError=Nt;function jt(rr,nr=kt.keywordError,ar){const{it:ir}=rr,{gen:lr,compositeRule:yr,allErrors:Sr}=ir,Ar=Wt(rr,nr,ar);Ht(lr,Ar),yr||Sr||Vt(ir,Bt.default.vErrors)}kt.reportExtraError=jt;function Ut(rr,nr){rr.assign(Bt.default.errors,nr),rr.if((0,At._)`${Bt.default.vErrors} !== null`,()=>rr.if(nr,()=>rr.assign((0,At._)`${Bt.default.vErrors}.length`,nr),()=>rr.assign(Bt.default.vErrors,null)))}kt.resetErrorsCount=Ut;function Lt({gen:rr,keyword:nr,schemaValue:ar,data:ir,errsCount:lr,it:yr}){if(lr===void 0)throw new Error("ajv implementation error");const Sr=rr.name("err");rr.forRange("i",lr,Bt.default.errors,Ar=>{rr.const(Sr,(0,At._)`${Bt.default.vErrors}[${Ar}]`),rr.if((0,At._)`${Sr}.instancePath === undefined`,()=>rr.assign((0,At._)`${Sr}.instancePath`,(0,At.strConcat)(Bt.default.instancePath,yr.errorPath))),rr.assign((0,At._)`${Sr}.schemaPath`,(0,At.str)`${yr.errSchemaPath}/${nr}`),yr.opts.verbose&&(rr.assign((0,At._)`${Sr}.schema`,ar),rr.assign((0,At._)`${Sr}.data`,ir))})}kt.extendErrors=Lt;function Ht(rr,nr){const ar=rr.const("err",nr);rr.if((0,At._)`${Bt.default.vErrors} === null`,()=>rr.assign(Bt.default.vErrors,(0,At._)`[${ar}]`),(0,At._)`${Bt.default.vErrors}.push(${ar})`),rr.code((0,At._)`${Bt.default.errors}++`)}function Vt(rr,nr){const{gen:ar,validateName:ir,schemaEnv:lr}=rr;lr.$async?ar.throw((0,At._)`new ${rr.ValidationError}(${nr})`):(ar.assign((0,At._)`${ir}.errors`,nr),ar.return(!1))}const zt={keyword:new At.Name("keyword"),schemaPath:new At.Name("schemaPath"),params:new At.Name("params"),propertyName:new At.Name("propertyName"),message:new At.Name("message"),schema:new At.Name("schema"),parentSchema:new At.Name("parentSchema")};function Wt(rr,nr,ar){const{createErrors:ir}=rr.it;return ir===!1?(0,At._)`{}`:Jt(rr,nr,ar)}function Jt(rr,nr,ar={}){const{gen:ir,it:lr}=rr,yr=[Qt(lr,ar),Xt(rr,ar)];return tr(rr,nr,yr),ir.object(...yr)}function Qt({errorPath:rr},{instancePath:nr}){const ar=nr?(0,At.str)`${rr}${(0,xt.getErrorPath)(nr,xt.Type.Str)}`:rr;return[Bt.default.instancePath,(0,At.strConcat)(Bt.default.instancePath,ar)]}function Xt({keyword:rr,it:{errSchemaPath:nr}},{schemaPath:ar,parentSchema:ir}){let lr=ir?nr:(0,At.str)`${nr}/${rr}`;return ar&&(lr=(0,At.str)`${lr}${(0,xt.getErrorPath)(ar,xt.Type.Str)}`),[zt.schemaPath,lr]}function tr(rr,{params:nr,message:ar},ir){const{keyword:lr,data:yr,schemaValue:Sr,it:Ar}=rr,{opts:Dr,propertyName:Br,topSchemaRef:Lr,schemaPath:Or}=Ar;ir.push([zt.keyword,lr],[zt.params,typeof nr=="function"?nr(rr):nr||(0,At._)`{}`]),Dr.messages&&ir.push([zt.message,typeof ar=="function"?ar(rr):ar]),Dr.verbose&&ir.push([zt.schema,Sr],[zt.parentSchema,(0,At._)`${Lr}${Or}`],[Bt.default.data,yr]),Br&&ir.push([zt.propertyName,Br])}})(errors$1);Object.defineProperty(boolSchema,"__esModule",{value:!0});boolSchema.boolOrEmptySchema=boolSchema.topBoolOrEmptySchema=void 0;const errors_1$2=errors$1,codegen_1$w=codegen,names_1$9=names$1,boolError={message:"boolean schema is false"};function topBoolOrEmptySchema(kt){const{gen:At,schema:xt,validateName:Bt}=kt;xt===!1?falseSchemaError(kt,!1):typeof xt=="object"&&xt.$async===!0?At.return(names_1$9.default.data):(At.assign((0,codegen_1$w._)`${Bt}.errors`,null),At.return(!0))}boolSchema.topBoolOrEmptySchema=topBoolOrEmptySchema;function boolOrEmptySchema(kt,At){const{gen:xt,schema:Bt}=kt;Bt===!1?(xt.var(At,!1),falseSchemaError(kt)):xt.var(At,!0)}boolSchema.boolOrEmptySchema=boolOrEmptySchema;function falseSchemaError(kt,At){const{gen:xt,data:Bt}=kt,Nt={gen:xt,keyword:"false schema",data:Bt,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:kt};(0,errors_1$2.reportError)(Nt,boolError,void 0,At)}var dataType={},rules={};Object.defineProperty(rules,"__esModule",{value:!0});rules.getRules=rules.isJSONType=void 0;const _jsonTypes=["string","number","integer","boolean","null","object","array"],jsonTypes=new Set(_jsonTypes);function isJSONType(kt){return typeof kt=="string"&&jsonTypes.has(kt)}rules.isJSONType=isJSONType;function getRules(){const kt={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...kt,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},kt.number,kt.string,kt.array,kt.object],post:{rules:[]},all:{},keywords:{}}}rules.getRules=getRules;var applicability={};Object.defineProperty(applicability,"__esModule",{value:!0});applicability.shouldUseRule=applicability.shouldUseGroup=applicability.schemaHasRulesForType=void 0;function schemaHasRulesForType({schema:kt,self:At},xt){const Bt=At.RULES.types[xt];return Bt&&Bt!==!0&&shouldUseGroup(kt,Bt)}applicability.schemaHasRulesForType=schemaHasRulesForType;function shouldUseGroup(kt,At){return At.rules.some(xt=>shouldUseRule(kt,xt))}applicability.shouldUseGroup=shouldUseGroup;function shouldUseRule(kt,At){var xt;return kt[At.keyword]!==void 0||((xt=At.definition.implements)===null||xt===void 0?void 0:xt.some(Bt=>kt[Bt]!==void 0))}applicability.shouldUseRule=shouldUseRule;(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.reportTypeError=kt.checkDataTypes=kt.checkDataType=kt.coerceAndCheckDataType=kt.getJSONTypes=kt.getSchemaTypes=kt.DataType=void 0;const At=rules,xt=applicability,Bt=errors$1,Nt=codegen,jt=util$1;var Ut;(function(ir){ir[ir.Correct=0]="Correct",ir[ir.Wrong=1]="Wrong"})(Ut=kt.DataType||(kt.DataType={}));function Lt(ir){const lr=Ht(ir.type);if(lr.includes("null")){if(ir.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!lr.length&&ir.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');ir.nullable===!0&&lr.push("null")}return lr}kt.getSchemaTypes=Lt;function Ht(ir){const lr=Array.isArray(ir)?ir:ir?[ir]:[];if(lr.every(At.isJSONType))return lr;throw new Error("type must be JSONType or JSONType[]: "+lr.join(","))}kt.getJSONTypes=Ht;function Vt(ir,lr){const{gen:yr,data:Sr,opts:Ar}=ir,Dr=Wt(lr,Ar.coerceTypes),Br=lr.length>0&&!(Dr.length===0&&lr.length===1&&(0,xt.schemaHasRulesForType)(ir,lr[0]));if(Br){const Lr=tr(lr,Sr,Ar.strictNumbers,Ut.Wrong);yr.if(Lr,()=>{Dr.length?Jt(ir,lr,Dr):nr(ir)})}return Br}kt.coerceAndCheckDataType=Vt;const zt=new Set(["string","number","integer","boolean","null"]);function Wt(ir,lr){return lr?ir.filter(yr=>zt.has(yr)||lr==="array"&&yr==="array"):[]}function Jt(ir,lr,yr){const{gen:Sr,data:Ar,opts:Dr}=ir,Br=Sr.let("dataType",(0,Nt._)`typeof ${Ar}`),Lr=Sr.let("coerced",(0,Nt._)`undefined`);Dr.coerceTypes==="array"&&Sr.if((0,Nt._)`${Br} == 'object' && Array.isArray(${Ar}) && ${Ar}.length == 1`,()=>Sr.assign(Ar,(0,Nt._)`${Ar}[0]`).assign(Br,(0,Nt._)`typeof ${Ar}`).if(tr(lr,Ar,Dr.strictNumbers),()=>Sr.assign(Lr,Ar))),Sr.if((0,Nt._)`${Lr} !== undefined`);for(const vr of yr)(zt.has(vr)||vr==="array"&&Dr.coerceTypes==="array")&&Or(vr);Sr.else(),nr(ir),Sr.endIf(),Sr.if((0,Nt._)`${Lr} !== undefined`,()=>{Sr.assign(Ar,Lr),Qt(ir,Lr)});function Or(vr){switch(vr){case"string":Sr.elseIf((0,Nt._)`${Br} == "number" || ${Br} == "boolean"`).assign(Lr,(0,Nt._)`"" + ${Ar}`).elseIf((0,Nt._)`${Ar} === null`).assign(Lr,(0,Nt._)`""`);return;case"number":Sr.elseIf((0,Nt._)`${Br} == "boolean" || ${Ar} === null
              || (${Br} == "string" && ${Ar} && ${Ar} == +${Ar})`).assign(Lr,(0,Nt._)`+${Ar}`);return;case"integer":Sr.elseIf((0,Nt._)`${Br} === "boolean" || ${Ar} === null
              || (${Br} === "string" && ${Ar} && ${Ar} == +${Ar} && !(${Ar} % 1))`).assign(Lr,(0,Nt._)`+${Ar}`);return;case"boolean":Sr.elseIf((0,Nt._)`${Ar} === "false" || ${Ar} === 0 || ${Ar} === null`).assign(Lr,!1).elseIf((0,Nt._)`${Ar} === "true" || ${Ar} === 1`).assign(Lr,!0);return;case"null":Sr.elseIf((0,Nt._)`${Ar} === "" || ${Ar} === 0 || ${Ar} === false`),Sr.assign(Lr,null);return;case"array":Sr.elseIf((0,Nt._)`${Br} === "string" || ${Br} === "number"
              || ${Br} === "boolean" || ${Ar} === null`).assign(Lr,(0,Nt._)`[${Ar}]`)}}}function Qt({gen:ir,parentData:lr,parentDataProperty:yr},Sr){ir.if((0,Nt._)`${lr} !== undefined`,()=>ir.assign((0,Nt._)`${lr}[${yr}]`,Sr))}function Xt(ir,lr,yr,Sr=Ut.Correct){const Ar=Sr===Ut.Correct?Nt.operators.EQ:Nt.operators.NEQ;let Dr;switch(ir){case"null":return(0,Nt._)`${lr} ${Ar} null`;case"array":Dr=(0,Nt._)`Array.isArray(${lr})`;break;case"object":Dr=(0,Nt._)`${lr} && typeof ${lr} == "object" && !Array.isArray(${lr})`;break;case"integer":Dr=Br((0,Nt._)`!(${lr} % 1) && !isNaN(${lr})`);break;case"number":Dr=Br();break;default:return(0,Nt._)`typeof ${lr} ${Ar} ${ir}`}return Sr===Ut.Correct?Dr:(0,Nt.not)(Dr);function Br(Lr=Nt.nil){return(0,Nt.and)((0,Nt._)`typeof ${lr} == "number"`,Lr,yr?(0,Nt._)`isFinite(${lr})`:Nt.nil)}}kt.checkDataType=Xt;function tr(ir,lr,yr,Sr){if(ir.length===1)return Xt(ir[0],lr,yr,Sr);let Ar;const Dr=(0,jt.toHash)(ir);if(Dr.array&&Dr.object){const Br=(0,Nt._)`typeof ${lr} != "object"`;Ar=Dr.null?Br:(0,Nt._)`!${lr} || ${Br}`,delete Dr.null,delete Dr.array,delete Dr.object}else Ar=Nt.nil;Dr.number&&delete Dr.integer;for(const Br in Dr)Ar=(0,Nt.and)(Ar,Xt(Br,lr,yr,Sr));return Ar}kt.checkDataTypes=tr;const rr={message:({schema:ir})=>`must be ${ir}`,params:({schema:ir,schemaValue:lr})=>typeof ir=="string"?(0,Nt._)`{type: ${ir}}`:(0,Nt._)`{type: ${lr}}`};function nr(ir){const lr=ar(ir);(0,Bt.reportError)(lr,rr)}kt.reportTypeError=nr;function ar(ir){const{gen:lr,data:yr,schema:Sr}=ir,Ar=(0,jt.schemaRefOrVal)(ir,Sr,"type");return{gen:lr,keyword:"type",data:yr,schema:Sr.type,schemaCode:Ar,schemaValue:Ar,parentSchema:Sr,params:{},it:ir}}})(dataType);var defaults={};Object.defineProperty(defaults,"__esModule",{value:!0});defaults.assignDefaults=void 0;const codegen_1$v=codegen,util_1$t=util$1;function assignDefaults(kt,At){const{properties:xt,items:Bt}=kt.schema;if(At==="object"&&xt)for(const Nt in xt)assignDefault(kt,Nt,xt[Nt].default);else At==="array"&&Array.isArray(Bt)&&Bt.forEach((Nt,jt)=>assignDefault(kt,jt,Nt.default))}defaults.assignDefaults=assignDefaults;function assignDefault(kt,At,xt){const{gen:Bt,compositeRule:Nt,data:jt,opts:Ut}=kt;if(xt===void 0)return;const Lt=(0,codegen_1$v._)`${jt}${(0,codegen_1$v.getProperty)(At)}`;if(Nt){(0,util_1$t.checkStrictMode)(kt,`default is ignored for: ${Lt}`);return}let Ht=(0,codegen_1$v._)`${Lt} === undefined`;Ut.useDefaults==="empty"&&(Ht=(0,codegen_1$v._)`${Ht} || ${Lt} === null || ${Lt} === ""`),Bt.if(Ht,(0,codegen_1$v._)`${Lt} = ${(0,codegen_1$v.stringify)(xt)}`)}var keyword={},code$1={};Object.defineProperty(code$1,"__esModule",{value:!0});code$1.validateUnion=code$1.validateArray=code$1.usePattern=code$1.callValidateCode=code$1.schemaProperties=code$1.allSchemaProperties=code$1.noPropertyInData=code$1.propertyInData=code$1.isOwnProperty=code$1.hasPropFunc=code$1.reportMissingProp=code$1.checkMissingProp=code$1.checkReportMissingProp=void 0;const codegen_1$u=codegen,util_1$s=util$1,names_1$8=names$1,util_2$1=util$1;function checkReportMissingProp(kt,At){const{gen:xt,data:Bt,it:Nt}=kt;xt.if(noPropertyInData(xt,Bt,At,Nt.opts.ownProperties),()=>{kt.setParams({missingProperty:(0,codegen_1$u._)`${At}`},!0),kt.error()})}code$1.checkReportMissingProp=checkReportMissingProp;function checkMissingProp({gen:kt,data:At,it:{opts:xt}},Bt,Nt){return(0,codegen_1$u.or)(...Bt.map(jt=>(0,codegen_1$u.and)(noPropertyInData(kt,At,jt,xt.ownProperties),(0,codegen_1$u._)`${Nt} = ${jt}`)))}code$1.checkMissingProp=checkMissingProp;function reportMissingProp(kt,At){kt.setParams({missingProperty:At},!0),kt.error()}code$1.reportMissingProp=reportMissingProp;function hasPropFunc(kt){return kt.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,codegen_1$u._)`Object.prototype.hasOwnProperty`})}code$1.hasPropFunc=hasPropFunc;function isOwnProperty(kt,At,xt){return(0,codegen_1$u._)`${hasPropFunc(kt)}.call(${At}, ${xt})`}code$1.isOwnProperty=isOwnProperty;function propertyInData(kt,At,xt,Bt){const Nt=(0,codegen_1$u._)`${At}${(0,codegen_1$u.getProperty)(xt)} !== undefined`;return Bt?(0,codegen_1$u._)`${Nt} && ${isOwnProperty(kt,At,xt)}`:Nt}code$1.propertyInData=propertyInData;function noPropertyInData(kt,At,xt,Bt){const Nt=(0,codegen_1$u._)`${At}${(0,codegen_1$u.getProperty)(xt)} === undefined`;return Bt?(0,codegen_1$u.or)(Nt,(0,codegen_1$u.not)(isOwnProperty(kt,At,xt))):Nt}code$1.noPropertyInData=noPropertyInData;function allSchemaProperties(kt){return kt?Object.keys(kt).filter(At=>At!=="__proto__"):[]}code$1.allSchemaProperties=allSchemaProperties;function schemaProperties(kt,At){return allSchemaProperties(At).filter(xt=>!(0,util_1$s.alwaysValidSchema)(kt,At[xt]))}code$1.schemaProperties=schemaProperties;function callValidateCode({schemaCode:kt,data:At,it:{gen:xt,topSchemaRef:Bt,schemaPath:Nt,errorPath:jt},it:Ut},Lt,Ht,Vt){const zt=Vt?(0,codegen_1$u._)`${kt}, ${At}, ${Bt}${Nt}`:At,Wt=[[names_1$8.default.instancePath,(0,codegen_1$u.strConcat)(names_1$8.default.instancePath,jt)],[names_1$8.default.parentData,Ut.parentData],[names_1$8.default.parentDataProperty,Ut.parentDataProperty],[names_1$8.default.rootData,names_1$8.default.rootData]];Ut.opts.dynamicRef&&Wt.push([names_1$8.default.dynamicAnchors,names_1$8.default.dynamicAnchors]);const Jt=(0,codegen_1$u._)`${zt}, ${xt.object(...Wt)}`;return Ht!==codegen_1$u.nil?(0,codegen_1$u._)`${Lt}.call(${Ht}, ${Jt})`:(0,codegen_1$u._)`${Lt}(${Jt})`}code$1.callValidateCode=callValidateCode;const newRegExp=(0,codegen_1$u._)`new RegExp`;function usePattern({gen:kt,it:{opts:At}},xt){const Bt=At.unicodeRegExp?"u":"",{regExp:Nt}=At.code,jt=Nt(xt,Bt);return kt.scopeValue("pattern",{key:jt.toString(),ref:jt,code:(0,codegen_1$u._)`${Nt.code==="new RegExp"?newRegExp:(0,util_2$1.useFunc)(kt,Nt)}(${xt}, ${Bt})`})}code$1.usePattern=usePattern;function validateArray$1(kt){const{gen:At,data:xt,keyword:Bt,it:Nt}=kt,jt=At.name("valid");if(Nt.allErrors){const Lt=At.let("valid",!0);return Ut(()=>At.assign(Lt,!1)),Lt}return At.var(jt,!0),Ut(()=>At.break()),jt;function Ut(Lt){const Ht=At.const("len",(0,codegen_1$u._)`${xt}.length`);At.forRange("i",0,Ht,Vt=>{kt.subschema({keyword:Bt,dataProp:Vt,dataPropType:util_1$s.Type.Num},jt),At.if((0,codegen_1$u.not)(jt),Lt)})}}code$1.validateArray=validateArray$1;function validateUnion$1(kt){const{gen:At,schema:xt,keyword:Bt,it:Nt}=kt;if(!Array.isArray(xt))throw new Error("ajv implementation error");if(xt.some(Ht=>(0,util_1$s.alwaysValidSchema)(Nt,Ht))&&!Nt.opts.unevaluated)return;const Ut=At.let("valid",!1),Lt=At.name("_valid");At.block(()=>xt.forEach((Ht,Vt)=>{const zt=kt.subschema({keyword:Bt,schemaProp:Vt,compositeRule:!0},Lt);At.assign(Ut,(0,codegen_1$u._)`${Ut} || ${Lt}`),kt.mergeValidEvaluated(zt,Lt)||At.if((0,codegen_1$u.not)(Ut))})),kt.result(Ut,()=>kt.reset(),()=>kt.error(!0))}code$1.validateUnion=validateUnion$1;Object.defineProperty(keyword,"__esModule",{value:!0});keyword.validateKeywordUsage=keyword.validSchemaType=keyword.funcKeywordCode=keyword.macroKeywordCode=void 0;const codegen_1$t=codegen,names_1$7=names$1,code_1$9=code$1,errors_1$1=errors$1;function macroKeywordCode(kt,At){const{gen:xt,keyword:Bt,schema:Nt,parentSchema:jt,it:Ut}=kt,Lt=At.macro.call(Ut.self,Nt,jt,Ut),Ht=useKeyword(xt,Bt,Lt);Ut.opts.validateSchema!==!1&&Ut.self.validateSchema(Lt,!0);const Vt=xt.name("valid");kt.subschema({schema:Lt,schemaPath:codegen_1$t.nil,errSchemaPath:`${Ut.errSchemaPath}/${Bt}`,topSchemaRef:Ht,compositeRule:!0},Vt),kt.pass(Vt,()=>kt.error(!0))}keyword.macroKeywordCode=macroKeywordCode;function funcKeywordCode(kt,At){var xt;const{gen:Bt,keyword:Nt,schema:jt,parentSchema:Ut,$data:Lt,it:Ht}=kt;checkAsyncKeyword(Ht,At);const Vt=!Lt&&At.compile?At.compile.call(Ht.self,jt,Ut,Ht):At.validate,zt=useKeyword(Bt,Nt,Vt),Wt=Bt.let("valid");kt.block$data(Wt,Jt),kt.ok((xt=At.valid)!==null&&xt!==void 0?xt:Wt);function Jt(){if(At.errors===!1)tr(),At.modifying&&modifyData(kt),rr(()=>kt.error());else{const nr=At.async?Qt():Xt();At.modifying&&modifyData(kt),rr(()=>addErrs(kt,nr))}}function Qt(){const nr=Bt.let("ruleErrs",null);return Bt.try(()=>tr((0,codegen_1$t._)`await `),ar=>Bt.assign(Wt,!1).if((0,codegen_1$t._)`${ar} instanceof ${Ht.ValidationError}`,()=>Bt.assign(nr,(0,codegen_1$t._)`${ar}.errors`),()=>Bt.throw(ar))),nr}function Xt(){const nr=(0,codegen_1$t._)`${zt}.errors`;return Bt.assign(nr,null),tr(codegen_1$t.nil),nr}function tr(nr=At.async?(0,codegen_1$t._)`await `:codegen_1$t.nil){const ar=Ht.opts.passContext?names_1$7.default.this:names_1$7.default.self,ir=!("compile"in At&&!Lt||At.schema===!1);Bt.assign(Wt,(0,codegen_1$t._)`${nr}${(0,code_1$9.callValidateCode)(kt,zt,ar,ir)}`,At.modifying)}function rr(nr){var ar;Bt.if((0,codegen_1$t.not)((ar=At.valid)!==null&&ar!==void 0?ar:Wt),nr)}}keyword.funcKeywordCode=funcKeywordCode;function modifyData(kt){const{gen:At,data:xt,it:Bt}=kt;At.if(Bt.parentData,()=>At.assign(xt,(0,codegen_1$t._)`${Bt.parentData}[${Bt.parentDataProperty}]`))}function addErrs(kt,At){const{gen:xt}=kt;xt.if((0,codegen_1$t._)`Array.isArray(${At})`,()=>{xt.assign(names_1$7.default.vErrors,(0,codegen_1$t._)`${names_1$7.default.vErrors} === null ? ${At} : ${names_1$7.default.vErrors}.concat(${At})`).assign(names_1$7.default.errors,(0,codegen_1$t._)`${names_1$7.default.vErrors}.length`),(0,errors_1$1.extendErrors)(kt)},()=>kt.error())}function checkAsyncKeyword({schemaEnv:kt},At){if(At.async&&!kt.$async)throw new Error("async keyword in sync schema")}function useKeyword(kt,At,xt){if(xt===void 0)throw new Error(`keyword "${At}" failed to compile`);return kt.scopeValue("keyword",typeof xt=="function"?{ref:xt}:{ref:xt,code:(0,codegen_1$t.stringify)(xt)})}function validSchemaType(kt,At,xt=!1){return!At.length||At.some(Bt=>Bt==="array"?Array.isArray(kt):Bt==="object"?kt&&typeof kt=="object"&&!Array.isArray(kt):typeof kt==Bt||xt&&typeof kt>"u")}keyword.validSchemaType=validSchemaType;function validateKeywordUsage({schema:kt,opts:At,self:xt,errSchemaPath:Bt},Nt,jt){if(Array.isArray(Nt.keyword)?!Nt.keyword.includes(jt):Nt.keyword!==jt)throw new Error("ajv implementation error");const Ut=Nt.dependencies;if(Ut!=null&&Ut.some(Lt=>!Object.prototype.hasOwnProperty.call(kt,Lt)))throw new Error(`parent schema must have dependencies of ${jt}: ${Ut.join(",")}`);if(Nt.validateSchema&&!Nt.validateSchema(kt[jt])){const Ht=`keyword "${jt}" value is invalid at path "${Bt}": `+xt.errorsText(Nt.validateSchema.errors);if(At.validateSchema==="log")xt.logger.error(Ht);else throw new Error(Ht)}}keyword.validateKeywordUsage=validateKeywordUsage;var subschema={};Object.defineProperty(subschema,"__esModule",{value:!0});subschema.extendSubschemaMode=subschema.extendSubschemaData=subschema.getSubschema=void 0;const codegen_1$s=codegen,util_1$r=util$1;function getSubschema(kt,{keyword:At,schemaProp:xt,schema:Bt,schemaPath:Nt,errSchemaPath:jt,topSchemaRef:Ut}){if(At!==void 0&&Bt!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(At!==void 0){const Lt=kt.schema[At];return xt===void 0?{schema:Lt,schemaPath:(0,codegen_1$s._)`${kt.schemaPath}${(0,codegen_1$s.getProperty)(At)}`,errSchemaPath:`${kt.errSchemaPath}/${At}`}:{schema:Lt[xt],schemaPath:(0,codegen_1$s._)`${kt.schemaPath}${(0,codegen_1$s.getProperty)(At)}${(0,codegen_1$s.getProperty)(xt)}`,errSchemaPath:`${kt.errSchemaPath}/${At}/${(0,util_1$r.escapeFragment)(xt)}`}}if(Bt!==void 0){if(Nt===void 0||jt===void 0||Ut===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:Bt,schemaPath:Nt,topSchemaRef:Ut,errSchemaPath:jt}}throw new Error('either "keyword" or "schema" must be passed')}subschema.getSubschema=getSubschema;function extendSubschemaData(kt,At,{dataProp:xt,dataPropType:Bt,data:Nt,dataTypes:jt,propertyName:Ut}){if(Nt!==void 0&&xt!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:Lt}=At;if(xt!==void 0){const{errorPath:Vt,dataPathArr:zt,opts:Wt}=At,Jt=Lt.let("data",(0,codegen_1$s._)`${At.data}${(0,codegen_1$s.getProperty)(xt)}`,!0);Ht(Jt),kt.errorPath=(0,codegen_1$s.str)`${Vt}${(0,util_1$r.getErrorPath)(xt,Bt,Wt.jsPropertySyntax)}`,kt.parentDataProperty=(0,codegen_1$s._)`${xt}`,kt.dataPathArr=[...zt,kt.parentDataProperty]}if(Nt!==void 0){const Vt=Nt instanceof codegen_1$s.Name?Nt:Lt.let("data",Nt,!0);Ht(Vt),Ut!==void 0&&(kt.propertyName=Ut)}jt&&(kt.dataTypes=jt);function Ht(Vt){kt.data=Vt,kt.dataLevel=At.dataLevel+1,kt.dataTypes=[],At.definedProperties=new Set,kt.parentData=At.data,kt.dataNames=[...At.dataNames,Vt]}}subschema.extendSubschemaData=extendSubschemaData;function extendSubschemaMode(kt,{jtdDiscriminator:At,jtdMetadata:xt,compositeRule:Bt,createErrors:Nt,allErrors:jt}){Bt!==void 0&&(kt.compositeRule=Bt),Nt!==void 0&&(kt.createErrors=Nt),jt!==void 0&&(kt.allErrors=jt),kt.jtdDiscriminator=At,kt.jtdMetadata=xt}subschema.extendSubschemaMode=extendSubschemaMode;var resolve$5={},fastDeepEqual=function kt(At,xt){if(At===xt)return!0;if(At&&xt&&typeof At=="object"&&typeof xt=="object"){if(At.constructor!==xt.constructor)return!1;var Bt,Nt,jt;if(Array.isArray(At)){if(Bt=At.length,Bt!=xt.length)return!1;for(Nt=Bt;Nt--!==0;)if(!kt(At[Nt],xt[Nt]))return!1;return!0}if(At.constructor===RegExp)return At.source===xt.source&&At.flags===xt.flags;if(At.valueOf!==Object.prototype.valueOf)return At.valueOf()===xt.valueOf();if(At.toString!==Object.prototype.toString)return At.toString()===xt.toString();if(jt=Object.keys(At),Bt=jt.length,Bt!==Object.keys(xt).length)return!1;for(Nt=Bt;Nt--!==0;)if(!Object.prototype.hasOwnProperty.call(xt,jt[Nt]))return!1;for(Nt=Bt;Nt--!==0;){var Ut=jt[Nt];if(!kt(At[Ut],xt[Ut]))return!1}return!0}return At!==At&&xt!==xt},jsonSchemaTraverse={exports:{}},traverse$1=jsonSchemaTraverse.exports=function(kt,At,xt){typeof At=="function"&&(xt=At,At={}),xt=At.cb||xt;var Bt=typeof xt=="function"?xt:xt.pre||function(){},Nt=xt.post||function(){};_traverse(At,Bt,Nt,kt,"",kt)};traverse$1.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};traverse$1.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};traverse$1.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};traverse$1.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function _traverse(kt,At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt){if(Bt&&typeof Bt=="object"&&!Array.isArray(Bt)){At(Bt,Nt,jt,Ut,Lt,Ht,Vt);for(var zt in Bt){var Wt=Bt[zt];if(Array.isArray(Wt)){if(zt in traverse$1.arrayKeywords)for(var Jt=0;Jt<Wt.length;Jt++)_traverse(kt,At,xt,Wt[Jt],Nt+"/"+zt+"/"+Jt,jt,Nt,zt,Bt,Jt)}else if(zt in traverse$1.propsKeywords){if(Wt&&typeof Wt=="object")for(var Qt in Wt)_traverse(kt,At,xt,Wt[Qt],Nt+"/"+zt+"/"+escapeJsonPtr(Qt),jt,Nt,zt,Bt,Qt)}else(zt in traverse$1.keywords||kt.allKeys&&!(zt in traverse$1.skipKeywords))&&_traverse(kt,At,xt,Wt,Nt+"/"+zt,jt,Nt,zt,Bt)}xt(Bt,Nt,jt,Ut,Lt,Ht,Vt)}}function escapeJsonPtr(kt){return kt.replace(/~/g,"~0").replace(/\//g,"~1")}var jsonSchemaTraverseExports=jsonSchemaTraverse.exports;Object.defineProperty(resolve$5,"__esModule",{value:!0});resolve$5.getSchemaRefs=resolve$5.resolveUrl=resolve$5.normalizeId=resolve$5._getFullPath=resolve$5.getFullPath=resolve$5.inlineRef=void 0;const util_1$q=util$1,equal$2=fastDeepEqual,traverse=jsonSchemaTraverseExports,SIMPLE_INLINED=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function inlineRef(kt,At=!0){return typeof kt=="boolean"?!0:At===!0?!hasRef(kt):At?countKeys(kt)<=At:!1}resolve$5.inlineRef=inlineRef;const REF_KEYWORDS=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hasRef(kt){for(const At in kt){if(REF_KEYWORDS.has(At))return!0;const xt=kt[At];if(Array.isArray(xt)&&xt.some(hasRef)||typeof xt=="object"&&hasRef(xt))return!0}return!1}function countKeys(kt){let At=0;for(const xt in kt){if(xt==="$ref")return 1/0;if(At++,!SIMPLE_INLINED.has(xt)&&(typeof kt[xt]=="object"&&(0,util_1$q.eachItem)(kt[xt],Bt=>At+=countKeys(Bt)),At===1/0))return 1/0}return At}function getFullPath(kt,At="",xt){xt!==!1&&(At=normalizeId(At));const Bt=kt.parse(At);return _getFullPath(kt,Bt)}resolve$5.getFullPath=getFullPath;function _getFullPath(kt,At){return kt.serialize(At).split("#")[0]+"#"}resolve$5._getFullPath=_getFullPath;const TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(kt){return kt?kt.replace(TRAILING_SLASH_HASH,""):""}resolve$5.normalizeId=normalizeId;function resolveUrl(kt,At,xt){return xt=normalizeId(xt),kt.resolve(At,xt)}resolve$5.resolveUrl=resolveUrl;const ANCHOR=/^[a-z_][-a-z0-9._]*$/i;function getSchemaRefs(kt,At){if(typeof kt=="boolean")return{};const{schemaId:xt,uriResolver:Bt}=this.opts,Nt=normalizeId(kt[xt]||At),jt={"":Nt},Ut=getFullPath(Bt,Nt,!1),Lt={},Ht=new Set;return traverse(kt,{allKeys:!0},(Wt,Jt,Qt,Xt)=>{if(Xt===void 0)return;const tr=Ut+Jt;let rr=jt[Xt];typeof Wt[xt]=="string"&&(rr=nr.call(this,Wt[xt])),ar.call(this,Wt.$anchor),ar.call(this,Wt.$dynamicAnchor),jt[Jt]=rr;function nr(ir){const lr=this.opts.uriResolver.resolve;if(ir=normalizeId(rr?lr(rr,ir):ir),Ht.has(ir))throw zt(ir);Ht.add(ir);let yr=this.refs[ir];return typeof yr=="string"&&(yr=this.refs[yr]),typeof yr=="object"?Vt(Wt,yr.schema,ir):ir!==normalizeId(tr)&&(ir[0]==="#"?(Vt(Wt,Lt[ir],ir),Lt[ir]=Wt):this.refs[ir]=tr),ir}function ar(ir){if(typeof ir=="string"){if(!ANCHOR.test(ir))throw new Error(`invalid anchor "${ir}"`);nr.call(this,`#${ir}`)}}}),Lt;function Vt(Wt,Jt,Qt){if(Jt!==void 0&&!equal$2(Wt,Jt))throw zt(Qt)}function zt(Wt){return new Error(`reference "${Wt}" resolves to more than one schema`)}}resolve$5.getSchemaRefs=getSchemaRefs;Object.defineProperty(validate,"__esModule",{value:!0});validate.getData=validate.KeywordCxt=validate.validateFunctionCode=void 0;const boolSchema_1=boolSchema,dataType_1$1=dataType,applicability_1=applicability,dataType_2=dataType,defaults_1=defaults,keyword_1=keyword,subschema_1=subschema,codegen_1$r=codegen,names_1$6=names$1,resolve_1$2=resolve$5,util_1$p=util$1,errors_1=errors$1;function validateFunctionCode(kt){if(isSchemaObj(kt)&&(checkKeywords(kt),schemaCxtHasRules(kt))){topSchemaObjCode(kt);return}validateFunction$3(kt,()=>(0,boolSchema_1.topBoolOrEmptySchema)(kt))}validate.validateFunctionCode=validateFunctionCode;function validateFunction$3({gen:kt,validateName:At,schema:xt,schemaEnv:Bt,opts:Nt},jt){Nt.code.es5?kt.func(At,(0,codegen_1$r._)`${names_1$6.default.data}, ${names_1$6.default.valCxt}`,Bt.$async,()=>{kt.code((0,codegen_1$r._)`"use strict"; ${funcSourceUrl(xt,Nt)}`),destructureValCxtES5(kt,Nt),kt.code(jt)}):kt.func(At,(0,codegen_1$r._)`${names_1$6.default.data}, ${destructureValCxt(Nt)}`,Bt.$async,()=>kt.code(funcSourceUrl(xt,Nt)).code(jt))}function destructureValCxt(kt){return(0,codegen_1$r._)`{${names_1$6.default.instancePath}="", ${names_1$6.default.parentData}, ${names_1$6.default.parentDataProperty}, ${names_1$6.default.rootData}=${names_1$6.default.data}${kt.dynamicRef?(0,codegen_1$r._)`, ${names_1$6.default.dynamicAnchors}={}`:codegen_1$r.nil}}={}`}function destructureValCxtES5(kt,At){kt.if(names_1$6.default.valCxt,()=>{kt.var(names_1$6.default.instancePath,(0,codegen_1$r._)`${names_1$6.default.valCxt}.${names_1$6.default.instancePath}`),kt.var(names_1$6.default.parentData,(0,codegen_1$r._)`${names_1$6.default.valCxt}.${names_1$6.default.parentData}`),kt.var(names_1$6.default.parentDataProperty,(0,codegen_1$r._)`${names_1$6.default.valCxt}.${names_1$6.default.parentDataProperty}`),kt.var(names_1$6.default.rootData,(0,codegen_1$r._)`${names_1$6.default.valCxt}.${names_1$6.default.rootData}`),At.dynamicRef&&kt.var(names_1$6.default.dynamicAnchors,(0,codegen_1$r._)`${names_1$6.default.valCxt}.${names_1$6.default.dynamicAnchors}`)},()=>{kt.var(names_1$6.default.instancePath,(0,codegen_1$r._)`""`),kt.var(names_1$6.default.parentData,(0,codegen_1$r._)`undefined`),kt.var(names_1$6.default.parentDataProperty,(0,codegen_1$r._)`undefined`),kt.var(names_1$6.default.rootData,names_1$6.default.data),At.dynamicRef&&kt.var(names_1$6.default.dynamicAnchors,(0,codegen_1$r._)`{}`)})}function topSchemaObjCode(kt){const{schema:At,opts:xt,gen:Bt}=kt;validateFunction$3(kt,()=>{xt.$comment&&At.$comment&&commentKeyword(kt),checkNoDefault(kt),Bt.let(names_1$6.default.vErrors,null),Bt.let(names_1$6.default.errors,0),xt.unevaluated&&resetEvaluated(kt),typeAndKeywords(kt),returnResults(kt)})}function resetEvaluated(kt){const{gen:At,validateName:xt}=kt;kt.evaluated=At.const("evaluated",(0,codegen_1$r._)`${xt}.evaluated`),At.if((0,codegen_1$r._)`${kt.evaluated}.dynamicProps`,()=>At.assign((0,codegen_1$r._)`${kt.evaluated}.props`,(0,codegen_1$r._)`undefined`)),At.if((0,codegen_1$r._)`${kt.evaluated}.dynamicItems`,()=>At.assign((0,codegen_1$r._)`${kt.evaluated}.items`,(0,codegen_1$r._)`undefined`))}function funcSourceUrl(kt,At){const xt=typeof kt=="object"&&kt[At.schemaId];return xt&&(At.code.source||At.code.process)?(0,codegen_1$r._)`/*# sourceURL=${xt} */`:codegen_1$r.nil}function subschemaCode(kt,At){if(isSchemaObj(kt)&&(checkKeywords(kt),schemaCxtHasRules(kt))){subSchemaObjCode(kt,At);return}(0,boolSchema_1.boolOrEmptySchema)(kt,At)}function schemaCxtHasRules({schema:kt,self:At}){if(typeof kt=="boolean")return!kt;for(const xt in kt)if(At.RULES.all[xt])return!0;return!1}function isSchemaObj(kt){return typeof kt.schema!="boolean"}function subSchemaObjCode(kt,At){const{schema:xt,gen:Bt,opts:Nt}=kt;Nt.$comment&&xt.$comment&&commentKeyword(kt),updateContext(kt),checkAsyncSchema(kt);const jt=Bt.const("_errs",names_1$6.default.errors);typeAndKeywords(kt,jt),Bt.var(At,(0,codegen_1$r._)`${jt} === ${names_1$6.default.errors}`)}function checkKeywords(kt){(0,util_1$p.checkUnknownRules)(kt),checkRefsAndKeywords(kt)}function typeAndKeywords(kt,At){if(kt.opts.jtd)return schemaKeywords(kt,[],!1,At);const xt=(0,dataType_1$1.getSchemaTypes)(kt.schema),Bt=(0,dataType_1$1.coerceAndCheckDataType)(kt,xt);schemaKeywords(kt,xt,!Bt,At)}function checkRefsAndKeywords(kt){const{schema:At,errSchemaPath:xt,opts:Bt,self:Nt}=kt;At.$ref&&Bt.ignoreKeywordsWithRef&&(0,util_1$p.schemaHasRulesButRef)(At,Nt.RULES)&&Nt.logger.warn(`$ref: keywords ignored in schema at path "${xt}"`)}function checkNoDefault(kt){const{schema:At,opts:xt}=kt;At.default!==void 0&&xt.useDefaults&&xt.strictSchema&&(0,util_1$p.checkStrictMode)(kt,"default is ignored in the schema root")}function updateContext(kt){const At=kt.schema[kt.opts.schemaId];At&&(kt.baseId=(0,resolve_1$2.resolveUrl)(kt.opts.uriResolver,kt.baseId,At))}function checkAsyncSchema(kt){if(kt.schema.$async&&!kt.schemaEnv.$async)throw new Error("async schema in sync schema")}function commentKeyword({gen:kt,schemaEnv:At,schema:xt,errSchemaPath:Bt,opts:Nt}){const jt=xt.$comment;if(Nt.$comment===!0)kt.code((0,codegen_1$r._)`${names_1$6.default.self}.logger.log(${jt})`);else if(typeof Nt.$comment=="function"){const Ut=(0,codegen_1$r.str)`${Bt}/$comment`,Lt=kt.scopeValue("root",{ref:At.root});kt.code((0,codegen_1$r._)`${names_1$6.default.self}.opts.$comment(${jt}, ${Ut}, ${Lt}.schema)`)}}function returnResults(kt){const{gen:At,schemaEnv:xt,validateName:Bt,ValidationError:Nt,opts:jt}=kt;xt.$async?At.if((0,codegen_1$r._)`${names_1$6.default.errors} === 0`,()=>At.return(names_1$6.default.data),()=>At.throw((0,codegen_1$r._)`new ${Nt}(${names_1$6.default.vErrors})`)):(At.assign((0,codegen_1$r._)`${Bt}.errors`,names_1$6.default.vErrors),jt.unevaluated&&assignEvaluated(kt),At.return((0,codegen_1$r._)`${names_1$6.default.errors} === 0`))}function assignEvaluated({gen:kt,evaluated:At,props:xt,items:Bt}){xt instanceof codegen_1$r.Name&&kt.assign((0,codegen_1$r._)`${At}.props`,xt),Bt instanceof codegen_1$r.Name&&kt.assign((0,codegen_1$r._)`${At}.items`,Bt)}function schemaKeywords(kt,At,xt,Bt){const{gen:Nt,schema:jt,data:Ut,allErrors:Lt,opts:Ht,self:Vt}=kt,{RULES:zt}=Vt;if(jt.$ref&&(Ht.ignoreKeywordsWithRef||!(0,util_1$p.schemaHasRulesButRef)(jt,zt))){Nt.block(()=>keywordCode(kt,"$ref",zt.all.$ref.definition));return}Ht.jtd||checkStrictTypes(kt,At),Nt.block(()=>{for(const Jt of zt.rules)Wt(Jt);Wt(zt.post)});function Wt(Jt){(0,applicability_1.shouldUseGroup)(jt,Jt)&&(Jt.type?(Nt.if((0,dataType_2.checkDataType)(Jt.type,Ut,Ht.strictNumbers)),iterateKeywords(kt,Jt),At.length===1&&At[0]===Jt.type&&xt&&(Nt.else(),(0,dataType_2.reportTypeError)(kt)),Nt.endIf()):iterateKeywords(kt,Jt),Lt||Nt.if((0,codegen_1$r._)`${names_1$6.default.errors} === ${Bt||0}`))}}function iterateKeywords(kt,At){const{gen:xt,schema:Bt,opts:{useDefaults:Nt}}=kt;Nt&&(0,defaults_1.assignDefaults)(kt,At.type),xt.block(()=>{for(const jt of At.rules)(0,applicability_1.shouldUseRule)(Bt,jt)&&keywordCode(kt,jt.keyword,jt.definition,At.type)})}function checkStrictTypes(kt,At){kt.schemaEnv.meta||!kt.opts.strictTypes||(checkContextTypes(kt,At),kt.opts.allowUnionTypes||checkMultipleTypes(kt,At),checkKeywordTypes(kt,kt.dataTypes))}function checkContextTypes(kt,At){if(At.length){if(!kt.dataTypes.length){kt.dataTypes=At;return}At.forEach(xt=>{includesType(kt.dataTypes,xt)||strictTypesError(kt,`type "${xt}" not allowed by context "${kt.dataTypes.join(",")}"`)}),narrowSchemaTypes(kt,At)}}function checkMultipleTypes(kt,At){At.length>1&&!(At.length===2&&At.includes("null"))&&strictTypesError(kt,"use allowUnionTypes to allow union type keyword")}function checkKeywordTypes(kt,At){const xt=kt.self.RULES.all;for(const Bt in xt){const Nt=xt[Bt];if(typeof Nt=="object"&&(0,applicability_1.shouldUseRule)(kt.schema,Nt)){const{type:jt}=Nt.definition;jt.length&&!jt.some(Ut=>hasApplicableType(At,Ut))&&strictTypesError(kt,`missing type "${jt.join(",")}" for keyword "${Bt}"`)}}}function hasApplicableType(kt,At){return kt.includes(At)||At==="number"&&kt.includes("integer")}function includesType(kt,At){return kt.includes(At)||At==="integer"&&kt.includes("number")}function narrowSchemaTypes(kt,At){const xt=[];for(const Bt of kt.dataTypes)includesType(At,Bt)?xt.push(Bt):At.includes("integer")&&Bt==="number"&&xt.push("integer");kt.dataTypes=xt}function strictTypesError(kt,At){const xt=kt.schemaEnv.baseId+kt.errSchemaPath;At+=` at "${xt}" (strictTypes)`,(0,util_1$p.checkStrictMode)(kt,At,kt.opts.strictTypes)}class KeywordCxt{constructor(At,xt,Bt){if((0,keyword_1.validateKeywordUsage)(At,xt,Bt),this.gen=At.gen,this.allErrors=At.allErrors,this.keyword=Bt,this.data=At.data,this.schema=At.schema[Bt],this.$data=xt.$data&&At.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,util_1$p.schemaRefOrVal)(At,this.schema,Bt,this.$data),this.schemaType=xt.schemaType,this.parentSchema=At.schema,this.params={},this.it=At,this.def=xt,this.$data)this.schemaCode=At.gen.const("vSchema",getData(this.$data,At));else if(this.schemaCode=this.schemaValue,!(0,keyword_1.validSchemaType)(this.schema,xt.schemaType,xt.allowUndefined))throw new Error(`${Bt} value must be ${JSON.stringify(xt.schemaType)}`);("code"in xt?xt.trackErrors:xt.errors!==!1)&&(this.errsCount=At.gen.const("_errs",names_1$6.default.errors))}result(At,xt,Bt){this.failResult((0,codegen_1$r.not)(At),xt,Bt)}failResult(At,xt,Bt){this.gen.if(At),Bt?Bt():this.error(),xt?(this.gen.else(),xt(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(At,xt){this.failResult((0,codegen_1$r.not)(At),void 0,xt)}fail(At){if(At===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(At),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(At){if(!this.$data)return this.fail(At);const{schemaCode:xt}=this;this.fail((0,codegen_1$r._)`${xt} !== undefined && (${(0,codegen_1$r.or)(this.invalid$data(),At)})`)}error(At,xt,Bt){if(xt){this.setParams(xt),this._error(At,Bt),this.setParams({});return}this._error(At,Bt)}_error(At,xt){(At?errors_1.reportExtraError:errors_1.reportError)(this,this.def.error,xt)}$dataError(){(0,errors_1.reportError)(this,this.def.$dataError||errors_1.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,errors_1.resetErrorsCount)(this.gen,this.errsCount)}ok(At){this.allErrors||this.gen.if(At)}setParams(At,xt){xt?Object.assign(this.params,At):this.params=At}block$data(At,xt,Bt=codegen_1$r.nil){this.gen.block(()=>{this.check$data(At,Bt),xt()})}check$data(At=codegen_1$r.nil,xt=codegen_1$r.nil){if(!this.$data)return;const{gen:Bt,schemaCode:Nt,schemaType:jt,def:Ut}=this;Bt.if((0,codegen_1$r.or)((0,codegen_1$r._)`${Nt} === undefined`,xt)),At!==codegen_1$r.nil&&Bt.assign(At,!0),(jt.length||Ut.validateSchema)&&(Bt.elseIf(this.invalid$data()),this.$dataError(),At!==codegen_1$r.nil&&Bt.assign(At,!1)),Bt.else()}invalid$data(){const{gen:At,schemaCode:xt,schemaType:Bt,def:Nt,it:jt}=this;return(0,codegen_1$r.or)(Ut(),Lt());function Ut(){if(Bt.length){if(!(xt instanceof codegen_1$r.Name))throw new Error("ajv implementation error");const Ht=Array.isArray(Bt)?Bt:[Bt];return(0,codegen_1$r._)`${(0,dataType_2.checkDataTypes)(Ht,xt,jt.opts.strictNumbers,dataType_2.DataType.Wrong)}`}return codegen_1$r.nil}function Lt(){if(Nt.validateSchema){const Ht=At.scopeValue("validate$data",{ref:Nt.validateSchema});return(0,codegen_1$r._)`!${Ht}(${xt})`}return codegen_1$r.nil}}subschema(At,xt){const Bt=(0,subschema_1.getSubschema)(this.it,At);(0,subschema_1.extendSubschemaData)(Bt,this.it,At),(0,subschema_1.extendSubschemaMode)(Bt,At);const Nt={...this.it,...Bt,items:void 0,props:void 0};return subschemaCode(Nt,xt),Nt}mergeEvaluated(At,xt){const{it:Bt,gen:Nt}=this;Bt.opts.unevaluated&&(Bt.props!==!0&&At.props!==void 0&&(Bt.props=util_1$p.mergeEvaluated.props(Nt,At.props,Bt.props,xt)),Bt.items!==!0&&At.items!==void 0&&(Bt.items=util_1$p.mergeEvaluated.items(Nt,At.items,Bt.items,xt)))}mergeValidEvaluated(At,xt){const{it:Bt,gen:Nt}=this;if(Bt.opts.unevaluated&&(Bt.props!==!0||Bt.items!==!0))return Nt.if(xt,()=>this.mergeEvaluated(At,codegen_1$r.Name)),!0}}validate.KeywordCxt=KeywordCxt;function keywordCode(kt,At,xt,Bt){const Nt=new KeywordCxt(kt,xt,At);"code"in xt?xt.code(Nt,Bt):Nt.$data&&xt.validate?(0,keyword_1.funcKeywordCode)(Nt,xt):"macro"in xt?(0,keyword_1.macroKeywordCode)(Nt,xt):(xt.compile||xt.validate)&&(0,keyword_1.funcKeywordCode)(Nt,xt)}const JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/,RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData(kt,{dataLevel:At,dataNames:xt,dataPathArr:Bt}){let Nt,jt;if(kt==="")return names_1$6.default.rootData;if(kt[0]==="/"){if(!JSON_POINTER.test(kt))throw new Error(`Invalid JSON-pointer: ${kt}`);Nt=kt,jt=names_1$6.default.rootData}else{const Vt=RELATIVE_JSON_POINTER.exec(kt);if(!Vt)throw new Error(`Invalid JSON-pointer: ${kt}`);const zt=+Vt[1];if(Nt=Vt[2],Nt==="#"){if(zt>=At)throw new Error(Ht("property/index",zt));return Bt[At-zt]}if(zt>At)throw new Error(Ht("data",zt));if(jt=xt[At-zt],!Nt)return jt}let Ut=jt;const Lt=Nt.split("/");for(const Vt of Lt)Vt&&(jt=(0,codegen_1$r._)`${jt}${(0,codegen_1$r.getProperty)((0,util_1$p.unescapeJsonPointer)(Vt))}`,Ut=(0,codegen_1$r._)`${Ut} && ${jt}`);return Ut;function Ht(Vt,zt){return`Cannot access ${Vt} ${zt} levels up, current level is ${At}`}}validate.getData=getData;var validation_error={};Object.defineProperty(validation_error,"__esModule",{value:!0});class ValidationError extends Error{constructor(At){super("validation failed"),this.errors=At,this.ajv=this.validation=!0}}validation_error.default=ValidationError;var ref_error={};Object.defineProperty(ref_error,"__esModule",{value:!0});const resolve_1$1=resolve$5;class MissingRefError extends Error{constructor(At,xt,Bt,Nt){super(Nt||`can't resolve reference ${Bt} from id ${xt}`),this.missingRef=(0,resolve_1$1.resolveUrl)(At,xt,Bt),this.missingSchema=(0,resolve_1$1.normalizeId)((0,resolve_1$1.getFullPath)(At,this.missingRef))}}ref_error.default=MissingRefError;var compile={};Object.defineProperty(compile,"__esModule",{value:!0});compile.resolveSchema=compile.getCompilingSchema=compile.resolveRef=compile.compileSchema=compile.SchemaEnv=void 0;const codegen_1$q=codegen,validation_error_1=validation_error,names_1$5=names$1,resolve_1=resolve$5,util_1$o=util$1,validate_1$1=validate;class SchemaEnv{constructor(At){var xt;this.refs={},this.dynamicAnchors={};let Bt;typeof At.schema=="object"&&(Bt=At.schema),this.schema=At.schema,this.schemaId=At.schemaId,this.root=At.root||this,this.baseId=(xt=At.baseId)!==null&&xt!==void 0?xt:(0,resolve_1.normalizeId)(Bt==null?void 0:Bt[At.schemaId||"$id"]),this.schemaPath=At.schemaPath,this.localRefs=At.localRefs,this.meta=At.meta,this.$async=Bt==null?void 0:Bt.$async,this.refs={}}}compile.SchemaEnv=SchemaEnv;function compileSchema(kt){const At=getCompilingSchema.call(this,kt);if(At)return At;const xt=(0,resolve_1.getFullPath)(this.opts.uriResolver,kt.root.baseId),{es5:Bt,lines:Nt}=this.opts.code,{ownProperties:jt}=this.opts,Ut=new codegen_1$q.CodeGen(this.scope,{es5:Bt,lines:Nt,ownProperties:jt});let Lt;kt.$async&&(Lt=Ut.scopeValue("Error",{ref:validation_error_1.default,code:(0,codegen_1$q._)`require("ajv/dist/runtime/validation_error").default`}));const Ht=Ut.scopeName("validate");kt.validateName=Ht;const Vt={gen:Ut,allErrors:this.opts.allErrors,data:names_1$5.default.data,parentData:names_1$5.default.parentData,parentDataProperty:names_1$5.default.parentDataProperty,dataNames:[names_1$5.default.data],dataPathArr:[codegen_1$q.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:Ut.scopeValue("schema",this.opts.code.source===!0?{ref:kt.schema,code:(0,codegen_1$q.stringify)(kt.schema)}:{ref:kt.schema}),validateName:Ht,ValidationError:Lt,schema:kt.schema,schemaEnv:kt,rootId:xt,baseId:kt.baseId||xt,schemaPath:codegen_1$q.nil,errSchemaPath:kt.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,codegen_1$q._)`""`,opts:this.opts,self:this};let zt;try{this._compilations.add(kt),(0,validate_1$1.validateFunctionCode)(Vt),Ut.optimize(this.opts.code.optimize);const Wt=Ut.toString();zt=`${Ut.scopeRefs(names_1$5.default.scope)}return ${Wt}`,this.opts.code.process&&(zt=this.opts.code.process(zt,kt));const Qt=new Function(`${names_1$5.default.self}`,`${names_1$5.default.scope}`,zt)(this,this.scope.get());if(this.scope.value(Ht,{ref:Qt}),Qt.errors=null,Qt.schema=kt.schema,Qt.schemaEnv=kt,kt.$async&&(Qt.$async=!0),this.opts.code.source===!0&&(Qt.source={validateName:Ht,validateCode:Wt,scopeValues:Ut._values}),this.opts.unevaluated){const{props:Xt,items:tr}=Vt;Qt.evaluated={props:Xt instanceof codegen_1$q.Name?void 0:Xt,items:tr instanceof codegen_1$q.Name?void 0:tr,dynamicProps:Xt instanceof codegen_1$q.Name,dynamicItems:tr instanceof codegen_1$q.Name},Qt.source&&(Qt.source.evaluated=(0,codegen_1$q.stringify)(Qt.evaluated))}return kt.validate=Qt,kt}catch(Wt){throw delete kt.validate,delete kt.validateName,zt&&this.logger.error("Error compiling schema, function code:",zt),Wt}finally{this._compilations.delete(kt)}}compile.compileSchema=compileSchema;function resolveRef(kt,At,xt){var Bt;xt=(0,resolve_1.resolveUrl)(this.opts.uriResolver,At,xt);const Nt=kt.refs[xt];if(Nt)return Nt;let jt=resolve$4.call(this,kt,xt);if(jt===void 0){const Ut=(Bt=kt.localRefs)===null||Bt===void 0?void 0:Bt[xt],{schemaId:Lt}=this.opts;Ut&&(jt=new SchemaEnv({schema:Ut,schemaId:Lt,root:kt,baseId:At}))}if(jt!==void 0)return kt.refs[xt]=inlineOrCompile.call(this,jt)}compile.resolveRef=resolveRef;function inlineOrCompile(kt){return(0,resolve_1.inlineRef)(kt.schema,this.opts.inlineRefs)?kt.schema:kt.validate?kt:compileSchema.call(this,kt)}function getCompilingSchema(kt){for(const At of this._compilations)if(sameSchemaEnv(At,kt))return At}compile.getCompilingSchema=getCompilingSchema;function sameSchemaEnv(kt,At){return kt.schema===At.schema&&kt.root===At.root&&kt.baseId===At.baseId}function resolve$4(kt,At){let xt;for(;typeof(xt=this.refs[At])=="string";)At=xt;return xt||this.schemas[At]||resolveSchema.call(this,kt,At)}function resolveSchema(kt,At){const xt=this.opts.uriResolver.parse(At),Bt=(0,resolve_1._getFullPath)(this.opts.uriResolver,xt);let Nt=(0,resolve_1.getFullPath)(this.opts.uriResolver,kt.baseId,void 0);if(Object.keys(kt.schema).length>0&&Bt===Nt)return getJsonPointer.call(this,xt,kt);const jt=(0,resolve_1.normalizeId)(Bt),Ut=this.refs[jt]||this.schemas[jt];if(typeof Ut=="string"){const Lt=resolveSchema.call(this,kt,Ut);return typeof(Lt==null?void 0:Lt.schema)!="object"?void 0:getJsonPointer.call(this,xt,Lt)}if(typeof(Ut==null?void 0:Ut.schema)=="object"){if(Ut.validate||compileSchema.call(this,Ut),jt===(0,resolve_1.normalizeId)(At)){const{schema:Lt}=Ut,{schemaId:Ht}=this.opts,Vt=Lt[Ht];return Vt&&(Nt=(0,resolve_1.resolveUrl)(this.opts.uriResolver,Nt,Vt)),new SchemaEnv({schema:Lt,schemaId:Ht,root:kt,baseId:Nt})}return getJsonPointer.call(this,xt,Ut)}}compile.resolveSchema=resolveSchema;const PREVENT_SCOPE_CHANGE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(kt,{baseId:At,schema:xt,root:Bt}){var Nt;if(((Nt=kt.fragment)===null||Nt===void 0?void 0:Nt[0])!=="/")return;for(const Lt of kt.fragment.slice(1).split("/")){if(typeof xt=="boolean")return;const Ht=xt[(0,util_1$o.unescapeFragment)(Lt)];if(Ht===void 0)return;xt=Ht;const Vt=typeof xt=="object"&&xt[this.opts.schemaId];!PREVENT_SCOPE_CHANGE.has(Lt)&&Vt&&(At=(0,resolve_1.resolveUrl)(this.opts.uriResolver,At,Vt))}let jt;if(typeof xt!="boolean"&&xt.$ref&&!(0,util_1$o.schemaHasRulesButRef)(xt,this.RULES)){const Lt=(0,resolve_1.resolveUrl)(this.opts.uriResolver,At,xt.$ref);jt=resolveSchema.call(this,Bt,Lt)}const{schemaId:Ut}=this.opts;if(jt=jt||new SchemaEnv({schema:xt,schemaId:Ut,root:Bt,baseId:At}),jt.schema!==jt.root.schema)return jt}const $id$8="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description="Meta-schema for $data reference (JSON AnySchema extension proposal)",type$8="object",required$1=["$data"],properties$9={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties$1=!1,require$$9={$id:$id$8,description,type:type$8,required:required$1,properties:properties$9,additionalProperties:additionalProperties$1};var uri$1={},uri_all={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(kt,At){(function(xt,Bt){Bt(At)})(commonjsGlobal,function(xt){function Bt(){for(var tn=arguments.length,Xr=Array(tn),sn=0;sn<tn;sn++)Xr[sn]=arguments[sn];if(Xr.length>1){Xr[0]=Xr[0].slice(0,-1);for(var ln=Xr.length-1,un=1;un<ln;++un)Xr[un]=Xr[un].slice(1,-1);return Xr[ln]=Xr[ln].slice(1),Xr.join("")}else return Xr[0]}function Nt(tn){return"(?:"+tn+")"}function jt(tn){return tn===void 0?"undefined":tn===null?"null":Object.prototype.toString.call(tn).split(" ").pop().split("]").shift().toLowerCase()}function Ut(tn){return tn.toUpperCase()}function Lt(tn){return tn!=null?tn instanceof Array?tn:typeof tn.length!="number"||tn.split||tn.setInterval||tn.call?[tn]:Array.prototype.slice.call(tn):[]}function Ht(tn,Xr){var sn=tn;if(Xr)for(var ln in Xr)sn[ln]=Xr[ln];return sn}function Vt(tn){var Xr="[A-Za-z]",sn="[0-9]",ln=Bt(sn,"[A-Fa-f]"),un=Nt(Nt("%[EFef]"+ln+"%"+ln+ln+"%"+ln+ln)+"|"+Nt("%[89A-Fa-f]"+ln+"%"+ln+ln)+"|"+Nt("%"+ln+ln)),wn="[\\:\\/\\?\\#\\[\\]\\@]",gn="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",En=Bt(wn,gn),Dn=tn?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",kn=tn?"[\\uE000-\\uF8FF]":"[]",Cn=Bt(Xr,sn,"[\\-\\.\\_\\~]",Dn);Nt(Xr+Bt(Xr,sn,"[\\+\\-\\.]")+"*"),Nt(Nt(un+"|"+Bt(Cn,gn,"[\\:]"))+"*");var Nn=Nt(Nt("25[0-5]")+"|"+Nt("2[0-4]"+sn)+"|"+Nt("1"+sn+sn)+"|"+Nt("0?[1-9]"+sn)+"|0?0?"+sn),Xn=Nt(Nn+"\\."+Nn+"\\."+Nn+"\\."+Nn),Rn=Nt(ln+"{1,4}"),Yn=Nt(Nt(Rn+"\\:"+Rn)+"|"+Xn),ei=Nt(Nt(Rn+"\\:")+"{6}"+Yn),Zn=Nt("\\:\\:"+Nt(Rn+"\\:")+"{5}"+Yn),pi=Nt(Nt(Rn)+"?\\:\\:"+Nt(Rn+"\\:")+"{4}"+Yn),li=Nt(Nt(Nt(Rn+"\\:")+"{0,1}"+Rn)+"?\\:\\:"+Nt(Rn+"\\:")+"{3}"+Yn),ci=Nt(Nt(Nt(Rn+"\\:")+"{0,2}"+Rn)+"?\\:\\:"+Nt(Rn+"\\:")+"{2}"+Yn),_i=Nt(Nt(Nt(Rn+"\\:")+"{0,3}"+Rn)+"?\\:\\:"+Rn+"\\:"+Yn),vi=Nt(Nt(Nt(Rn+"\\:")+"{0,4}"+Rn)+"?\\:\\:"+Yn),oi=Nt(Nt(Nt(Rn+"\\:")+"{0,5}"+Rn)+"?\\:\\:"+Rn),di=Nt(Nt(Nt(Rn+"\\:")+"{0,6}"+Rn)+"?\\:\\:"),bi=Nt([ei,Zn,pi,li,ci,_i,vi,oi,di].join("|")),fi=Nt(Nt(Cn+"|"+un)+"+");Nt("[vV]"+ln+"+\\."+Bt(Cn,gn,"[\\:]")+"+"),Nt(Nt(un+"|"+Bt(Cn,gn))+"*");var Ti=Nt(un+"|"+Bt(Cn,gn,"[\\:\\@]"));return Nt(Nt(un+"|"+Bt(Cn,gn,"[\\@]"))+"+"),Nt(Nt(Ti+"|"+Bt("[\\/\\?]",kn))+"*"),{NOT_SCHEME:new RegExp(Bt("[^]",Xr,sn,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(Bt("[^\\%\\:]",Cn,gn),"g"),NOT_HOST:new RegExp(Bt("[^\\%\\[\\]\\:]",Cn,gn),"g"),NOT_PATH:new RegExp(Bt("[^\\%\\/\\:\\@]",Cn,gn),"g"),NOT_PATH_NOSCHEME:new RegExp(Bt("[^\\%\\/\\@]",Cn,gn),"g"),NOT_QUERY:new RegExp(Bt("[^\\%]",Cn,gn,"[\\:\\@\\/\\?]",kn),"g"),NOT_FRAGMENT:new RegExp(Bt("[^\\%]",Cn,gn,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(Bt("[^]",Cn,gn),"g"),UNRESERVED:new RegExp(Cn,"g"),OTHER_CHARS:new RegExp(Bt("[^\\%]",Cn,En),"g"),PCT_ENCODED:new RegExp(un,"g"),IPV4ADDRESS:new RegExp("^("+Xn+")$"),IPV6ADDRESS:new RegExp("^\\[?("+bi+")"+Nt(Nt("\\%25|\\%(?!"+ln+"{2})")+"("+fi+")")+"?\\]?$")}}var zt=Vt(!1),Wt=Vt(!0),Jt=function(){function tn(Xr,sn){var ln=[],un=!0,wn=!1,gn=void 0;try{for(var En=Xr[Symbol.iterator](),Dn;!(un=(Dn=En.next()).done)&&(ln.push(Dn.value),!(sn&&ln.length===sn));un=!0);}catch(kn){wn=!0,gn=kn}finally{try{!un&&En.return&&En.return()}finally{if(wn)throw gn}}return ln}return function(Xr,sn){if(Array.isArray(Xr))return Xr;if(Symbol.iterator in Object(Xr))return tn(Xr,sn);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Qt=function(tn){if(Array.isArray(tn)){for(var Xr=0,sn=Array(tn.length);Xr<tn.length;Xr++)sn[Xr]=tn[Xr];return sn}else return Array.from(tn)},Xt=2147483647,tr=36,rr=1,nr=26,ar=38,ir=700,lr=72,yr=128,Sr="-",Ar=/^xn--/,Dr=/[^\0-\x7E]/,Br=/[\x2E\u3002\uFF0E\uFF61]/g,Lr={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Or=tr-rr,vr=Math.floor,pr=String.fromCharCode;function dr(tn){throw new RangeError(Lr[tn])}function ur(tn,Xr){for(var sn=[],ln=tn.length;ln--;)sn[ln]=Xr(tn[ln]);return sn}function $r(tn,Xr){var sn=tn.split("@"),ln="";sn.length>1&&(ln=sn[0]+"@",tn=sn[1]),tn=tn.replace(Br,".");var un=tn.split("."),wn=ur(un,Xr).join(".");return ln+wn}function wr(tn){for(var Xr=[],sn=0,ln=tn.length;sn<ln;){var un=tn.charCodeAt(sn++);if(un>=55296&&un<=56319&&sn<ln){var wn=tn.charCodeAt(sn++);(wn&64512)==56320?Xr.push(((un&1023)<<10)+(wn&1023)+65536):(Xr.push(un),sn--)}else Xr.push(un)}return Xr}var Er=function(Xr){return String.fromCodePoint.apply(String,Qt(Xr))},gr=function(Xr){return Xr-48<10?Xr-22:Xr-65<26?Xr-65:Xr-97<26?Xr-97:tr},fr=function(Xr,sn){return Xr+22+75*(Xr<26)-((sn!=0)<<5)},br=function(Xr,sn,ln){var un=0;for(Xr=ln?vr(Xr/ir):Xr>>1,Xr+=vr(Xr/sn);Xr>Or*nr>>1;un+=tr)Xr=vr(Xr/Or);return vr(un+(Or+1)*Xr/(Xr+ar))},_r=function(Xr){var sn=[],ln=Xr.length,un=0,wn=yr,gn=lr,En=Xr.lastIndexOf(Sr);En<0&&(En=0);for(var Dn=0;Dn<En;++Dn)Xr.charCodeAt(Dn)>=128&&dr("not-basic"),sn.push(Xr.charCodeAt(Dn));for(var kn=En>0?En+1:0;kn<ln;){for(var Cn=un,Nn=1,Xn=tr;;Xn+=tr){kn>=ln&&dr("invalid-input");var Rn=gr(Xr.charCodeAt(kn++));(Rn>=tr||Rn>vr((Xt-un)/Nn))&&dr("overflow"),un+=Rn*Nn;var Yn=Xn<=gn?rr:Xn>=gn+nr?nr:Xn-gn;if(Rn<Yn)break;var ei=tr-Yn;Nn>vr(Xt/ei)&&dr("overflow"),Nn*=ei}var Zn=sn.length+1;gn=br(un-Cn,Zn,Cn==0),vr(un/Zn)>Xt-wn&&dr("overflow"),wn+=vr(un/Zn),un%=Zn,sn.splice(un++,0,wn)}return String.fromCodePoint.apply(String,sn)},Tr=function(Xr){var sn=[];Xr=wr(Xr);var ln=Xr.length,un=yr,wn=0,gn=lr,En=!0,Dn=!1,kn=void 0;try{for(var Cn=Xr[Symbol.iterator](),Nn;!(En=(Nn=Cn.next()).done);En=!0){var Xn=Nn.value;Xn<128&&sn.push(pr(Xn))}}catch(wo){Dn=!0,kn=wo}finally{try{!En&&Cn.return&&Cn.return()}finally{if(Dn)throw kn}}var Rn=sn.length,Yn=Rn;for(Rn&&sn.push(Sr);Yn<ln;){var ei=Xt,Zn=!0,pi=!1,li=void 0;try{for(var ci=Xr[Symbol.iterator](),_i;!(Zn=(_i=ci.next()).done);Zn=!0){var vi=_i.value;vi>=un&&vi<ei&&(ei=vi)}}catch(wo){pi=!0,li=wo}finally{try{!Zn&&ci.return&&ci.return()}finally{if(pi)throw li}}var oi=Yn+1;ei-un>vr((Xt-wn)/oi)&&dr("overflow"),wn+=(ei-un)*oi,un=ei;var di=!0,bi=!1,fi=void 0;try{for(var Ti=Xr[Symbol.iterator](),uo;!(di=(uo=Ti.next()).done);di=!0){var fo=uo.value;if(fo<un&&++wn>Xt&&dr("overflow"),fo==un){for(var Ro=wn,Oo=tr;;Oo+=tr){var Bo=Oo<=gn?rr:Oo>=gn+nr?nr:Oo-gn;if(Ro<Bo)break;var Xo=Ro-Bo,es=tr-Bo;sn.push(pr(fr(Bo+Xo%es,0))),Ro=vr(Xo/es)}sn.push(pr(fr(Ro,0))),gn=br(wn,oi,Yn==Rn),wn=0,++Yn}}}catch(wo){bi=!0,fi=wo}finally{try{!di&&Ti.return&&Ti.return()}finally{if(bi)throw fi}}++wn,++un}return sn.join("")},Pr=function(Xr){return $r(Xr,function(sn){return Ar.test(sn)?_r(sn.slice(4).toLowerCase()):sn})},Nr=function(Xr){return $r(Xr,function(sn){return Dr.test(sn)?"xn--"+Tr(sn):sn})},Cr={version:"2.1.0",ucs2:{decode:wr,encode:Er},decode:_r,encode:Tr,toASCII:Nr,toUnicode:Pr},xr={};function Rr(tn){var Xr=tn.charCodeAt(0),sn=void 0;return Xr<16?sn="%0"+Xr.toString(16).toUpperCase():Xr<128?sn="%"+Xr.toString(16).toUpperCase():Xr<2048?sn="%"+(Xr>>6|192).toString(16).toUpperCase()+"%"+(Xr&63|128).toString(16).toUpperCase():sn="%"+(Xr>>12|224).toString(16).toUpperCase()+"%"+(Xr>>6&63|128).toString(16).toUpperCase()+"%"+(Xr&63|128).toString(16).toUpperCase(),sn}function qr(tn){for(var Xr="",sn=0,ln=tn.length;sn<ln;){var un=parseInt(tn.substr(sn+1,2),16);if(un<128)Xr+=String.fromCharCode(un),sn+=3;else if(un>=194&&un<224){if(ln-sn>=6){var wn=parseInt(tn.substr(sn+4,2),16);Xr+=String.fromCharCode((un&31)<<6|wn&63)}else Xr+=tn.substr(sn,6);sn+=6}else if(un>=224){if(ln-sn>=9){var gn=parseInt(tn.substr(sn+4,2),16),En=parseInt(tn.substr(sn+7,2),16);Xr+=String.fromCharCode((un&15)<<12|(gn&63)<<6|En&63)}else Xr+=tn.substr(sn,9);sn+=9}else Xr+=tn.substr(sn,3),sn+=3}return Xr}function Vr(tn,Xr){function sn(ln){var un=qr(ln);return un.match(Xr.UNRESERVED)?un:ln}return tn.scheme&&(tn.scheme=String(tn.scheme).replace(Xr.PCT_ENCODED,sn).toLowerCase().replace(Xr.NOT_SCHEME,"")),tn.userinfo!==void 0&&(tn.userinfo=String(tn.userinfo).replace(Xr.PCT_ENCODED,sn).replace(Xr.NOT_USERINFO,Rr).replace(Xr.PCT_ENCODED,Ut)),tn.host!==void 0&&(tn.host=String(tn.host).replace(Xr.PCT_ENCODED,sn).toLowerCase().replace(Xr.NOT_HOST,Rr).replace(Xr.PCT_ENCODED,Ut)),tn.path!==void 0&&(tn.path=String(tn.path).replace(Xr.PCT_ENCODED,sn).replace(tn.scheme?Xr.NOT_PATH:Xr.NOT_PATH_NOSCHEME,Rr).replace(Xr.PCT_ENCODED,Ut)),tn.query!==void 0&&(tn.query=String(tn.query).replace(Xr.PCT_ENCODED,sn).replace(Xr.NOT_QUERY,Rr).replace(Xr.PCT_ENCODED,Ut)),tn.fragment!==void 0&&(tn.fragment=String(tn.fragment).replace(Xr.PCT_ENCODED,sn).replace(Xr.NOT_FRAGMENT,Rr).replace(Xr.PCT_ENCODED,Ut)),tn}function Gr(tn){return tn.replace(/^0*(.*)/,"$1")||"0"}function Ur(tn,Xr){var sn=tn.match(Xr.IPV4ADDRESS)||[],ln=Jt(sn,2),un=ln[1];return un?un.split(".").map(Gr).join("."):tn}function kr(tn,Xr){var sn=tn.match(Xr.IPV6ADDRESS)||[],ln=Jt(sn,3),un=ln[1],wn=ln[2];if(un){for(var gn=un.toLowerCase().split("::").reverse(),En=Jt(gn,2),Dn=En[0],kn=En[1],Cn=kn?kn.split(":").map(Gr):[],Nn=Dn.split(":").map(Gr),Xn=Xr.IPV4ADDRESS.test(Nn[Nn.length-1]),Rn=Xn?7:8,Yn=Nn.length-Rn,ei=Array(Rn),Zn=0;Zn<Rn;++Zn)ei[Zn]=Cn[Zn]||Nn[Yn+Zn]||"";Xn&&(ei[Rn-1]=Ur(ei[Rn-1],Xr));var pi=ei.reduce(function(oi,di,bi){if(!di||di==="0"){var fi=oi[oi.length-1];fi&&fi.index+fi.length===bi?fi.length++:oi.push({index:bi,length:1})}return oi},[]),li=pi.sort(function(oi,di){return di.length-oi.length})[0],ci=void 0;if(li&&li.length>1){var _i=ei.slice(0,li.index),vi=ei.slice(li.index+li.length);ci=_i.join(":")+"::"+vi.join(":")}else ci=ei.join(":");return wn&&(ci+="%"+wn),ci}else return tn}var Fr=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Wr="".match(/(){0}/)[1]===void 0;function jr(tn){var Xr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},sn={},ln=Xr.iri!==!1?Wt:zt;Xr.reference==="suffix"&&(tn=(Xr.scheme?Xr.scheme+":":"")+"//"+tn);var un=tn.match(Fr);if(un){Wr?(sn.scheme=un[1],sn.userinfo=un[3],sn.host=un[4],sn.port=parseInt(un[5],10),sn.path=un[6]||"",sn.query=un[7],sn.fragment=un[8],isNaN(sn.port)&&(sn.port=un[5])):(sn.scheme=un[1]||void 0,sn.userinfo=tn.indexOf("@")!==-1?un[3]:void 0,sn.host=tn.indexOf("//")!==-1?un[4]:void 0,sn.port=parseInt(un[5],10),sn.path=un[6]||"",sn.query=tn.indexOf("?")!==-1?un[7]:void 0,sn.fragment=tn.indexOf("#")!==-1?un[8]:void 0,isNaN(sn.port)&&(sn.port=tn.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?un[4]:void 0)),sn.host&&(sn.host=kr(Ur(sn.host,ln),ln)),sn.scheme===void 0&&sn.userinfo===void 0&&sn.host===void 0&&sn.port===void 0&&!sn.path&&sn.query===void 0?sn.reference="same-document":sn.scheme===void 0?sn.reference="relative":sn.fragment===void 0?sn.reference="absolute":sn.reference="uri",Xr.reference&&Xr.reference!=="suffix"&&Xr.reference!==sn.reference&&(sn.error=sn.error||"URI is not a "+Xr.reference+" reference.");var wn=xr[(Xr.scheme||sn.scheme||"").toLowerCase()];if(!Xr.unicodeSupport&&(!wn||!wn.unicodeSupport)){if(sn.host&&(Xr.domainHost||wn&&wn.domainHost))try{sn.host=Cr.toASCII(sn.host.replace(ln.PCT_ENCODED,qr).toLowerCase())}catch(gn){sn.error=sn.error||"Host's domain name can not be converted to ASCII via punycode: "+gn}Vr(sn,zt)}else Vr(sn,ln);wn&&wn.parse&&wn.parse(sn,Xr)}else sn.error=sn.error||"URI can not be parsed.";return sn}function Ir(tn,Xr){var sn=Xr.iri!==!1?Wt:zt,ln=[];return tn.userinfo!==void 0&&(ln.push(tn.userinfo),ln.push("@")),tn.host!==void 0&&ln.push(kr(Ur(String(tn.host),sn),sn).replace(sn.IPV6ADDRESS,function(un,wn,gn){return"["+wn+(gn?"%25"+gn:"")+"]"})),(typeof tn.port=="number"||typeof tn.port=="string")&&(ln.push(":"),ln.push(String(tn.port))),ln.length?ln.join(""):void 0}var Mr=/^\.\.?\//,Hr=/^\/\.(\/|$)/,Qr=/^\/\.\.(\/|$)/,on=/^\/?(?:.|\n)*?(?=\/|$)/;function nn(tn){for(var Xr=[];tn.length;)if(tn.match(Mr))tn=tn.replace(Mr,"");else if(tn.match(Hr))tn=tn.replace(Hr,"/");else if(tn.match(Qr))tn=tn.replace(Qr,"/"),Xr.pop();else if(tn==="."||tn==="..")tn="";else{var sn=tn.match(on);if(sn){var ln=sn[0];tn=tn.slice(ln.length),Xr.push(ln)}else throw new Error("Unexpected dot segment condition")}return Xr.join("")}function fn(tn){var Xr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},sn=Xr.iri?Wt:zt,ln=[],un=xr[(Xr.scheme||tn.scheme||"").toLowerCase()];if(un&&un.serialize&&un.serialize(tn,Xr),tn.host&&!sn.IPV6ADDRESS.test(tn.host)){if(Xr.domainHost||un&&un.domainHost)try{tn.host=Xr.iri?Cr.toUnicode(tn.host):Cr.toASCII(tn.host.replace(sn.PCT_ENCODED,qr).toLowerCase())}catch(En){tn.error=tn.error||"Host's domain name can not be converted to "+(Xr.iri?"Unicode":"ASCII")+" via punycode: "+En}}Vr(tn,sn),Xr.reference!=="suffix"&&tn.scheme&&(ln.push(tn.scheme),ln.push(":"));var wn=Ir(tn,Xr);if(wn!==void 0&&(Xr.reference!=="suffix"&&ln.push("//"),ln.push(wn),tn.path&&tn.path.charAt(0)!=="/"&&ln.push("/")),tn.path!==void 0){var gn=tn.path;!Xr.absolutePath&&(!un||!un.absolutePath)&&(gn=nn(gn)),wn===void 0&&(gn=gn.replace(/^\/\//,"/%2F")),ln.push(gn)}return tn.query!==void 0&&(ln.push("?"),ln.push(tn.query)),tn.fragment!==void 0&&(ln.push("#"),ln.push(tn.fragment)),ln.join("")}function hn(tn,Xr){var sn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ln=arguments[3],un={};return ln||(tn=jr(fn(tn,sn),sn),Xr=jr(fn(Xr,sn),sn)),sn=sn||{},!sn.tolerant&&Xr.scheme?(un.scheme=Xr.scheme,un.userinfo=Xr.userinfo,un.host=Xr.host,un.port=Xr.port,un.path=nn(Xr.path||""),un.query=Xr.query):(Xr.userinfo!==void 0||Xr.host!==void 0||Xr.port!==void 0?(un.userinfo=Xr.userinfo,un.host=Xr.host,un.port=Xr.port,un.path=nn(Xr.path||""),un.query=Xr.query):(Xr.path?(Xr.path.charAt(0)==="/"?un.path=nn(Xr.path):((tn.userinfo!==void 0||tn.host!==void 0||tn.port!==void 0)&&!tn.path?un.path="/"+Xr.path:tn.path?un.path=tn.path.slice(0,tn.path.lastIndexOf("/")+1)+Xr.path:un.path=Xr.path,un.path=nn(un.path)),un.query=Xr.query):(un.path=tn.path,Xr.query!==void 0?un.query=Xr.query:un.query=tn.query),un.userinfo=tn.userinfo,un.host=tn.host,un.port=tn.port),un.scheme=tn.scheme),un.fragment=Xr.fragment,un}function Jr(tn,Xr,sn){var ln=Ht({scheme:"null"},sn);return fn(hn(jr(tn,ln),jr(Xr,ln),ln,!0),ln)}function Yr(tn,Xr){return typeof tn=="string"?tn=fn(jr(tn,Xr),Xr):jt(tn)==="object"&&(tn=jr(fn(tn,Xr),Xr)),tn}function an(tn,Xr,sn){return typeof tn=="string"?tn=fn(jr(tn,sn),sn):jt(tn)==="object"&&(tn=fn(tn,sn)),typeof Xr=="string"?Xr=fn(jr(Xr,sn),sn):jt(Xr)==="object"&&(Xr=fn(Xr,sn)),tn===Xr}function dn(tn,Xr){return tn&&tn.toString().replace(!Xr||!Xr.iri?zt.ESCAPE:Wt.ESCAPE,Rr)}function cn(tn,Xr){return tn&&tn.toString().replace(!Xr||!Xr.iri?zt.PCT_ENCODED:Wt.PCT_ENCODED,qr)}var vn={scheme:"http",domainHost:!0,parse:function(Xr,sn){return Xr.host||(Xr.error=Xr.error||"HTTP URIs must have a host."),Xr},serialize:function(Xr,sn){var ln=String(Xr.scheme).toLowerCase()==="https";return(Xr.port===(ln?443:80)||Xr.port==="")&&(Xr.port=void 0),Xr.path||(Xr.path="/"),Xr}},_n={scheme:"https",domainHost:vn.domainHost,parse:vn.parse,serialize:vn.serialize};function Tn(tn){return typeof tn.secure=="boolean"?tn.secure:String(tn.scheme).toLowerCase()==="wss"}var $n={scheme:"ws",domainHost:!0,parse:function(Xr,sn){var ln=Xr;return ln.secure=Tn(ln),ln.resourceName=(ln.path||"/")+(ln.query?"?"+ln.query:""),ln.path=void 0,ln.query=void 0,ln},serialize:function(Xr,sn){if((Xr.port===(Tn(Xr)?443:80)||Xr.port==="")&&(Xr.port=void 0),typeof Xr.secure=="boolean"&&(Xr.scheme=Xr.secure?"wss":"ws",Xr.secure=void 0),Xr.resourceName){var ln=Xr.resourceName.split("?"),un=Jt(ln,2),wn=un[0],gn=un[1];Xr.path=wn&&wn!=="/"?wn:void 0,Xr.query=gn,Xr.resourceName=void 0}return Xr.fragment=void 0,Xr}},Kn={scheme:"wss",domainHost:$n.domainHost,parse:$n.parse,serialize:$n.serialize},Un={},In="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Mn="[0-9A-Fa-f]",qn=Nt(Nt("%[EFef]"+Mn+"%"+Mn+Mn+"%"+Mn+Mn)+"|"+Nt("%[89A-Fa-f]"+Mn+"%"+Mn+Mn)+"|"+Nt("%"+Mn+Mn)),On="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Hn="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Vn=Bt(Hn,'[\\"\\\\]'),xn="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",zn=new RegExp(In,"g"),Jn=new RegExp(qn,"g"),Bn=new RegExp(Bt("[^]",On,"[\\.]",'[\\"]',Vn),"g"),Qn=new RegExp(Bt("[^]",In,xn),"g"),Zr=Qn;function en(tn){var Xr=qr(tn);return Xr.match(zn)?Xr:tn}var pn={scheme:"mailto",parse:function(Xr,sn){var ln=Xr,un=ln.to=ln.path?ln.path.split(","):[];if(ln.path=void 0,ln.query){for(var wn=!1,gn={},En=ln.query.split("&"),Dn=0,kn=En.length;Dn<kn;++Dn){var Cn=En[Dn].split("=");switch(Cn[0]){case"to":for(var Nn=Cn[1].split(","),Xn=0,Rn=Nn.length;Xn<Rn;++Xn)un.push(Nn[Xn]);break;case"subject":ln.subject=cn(Cn[1],sn);break;case"body":ln.body=cn(Cn[1],sn);break;default:wn=!0,gn[cn(Cn[0],sn)]=cn(Cn[1],sn);break}}wn&&(ln.headers=gn)}ln.query=void 0;for(var Yn=0,ei=un.length;Yn<ei;++Yn){var Zn=un[Yn].split("@");if(Zn[0]=cn(Zn[0]),sn.unicodeSupport)Zn[1]=cn(Zn[1],sn).toLowerCase();else try{Zn[1]=Cr.toASCII(cn(Zn[1],sn).toLowerCase())}catch(pi){ln.error=ln.error||"Email address's domain name can not be converted to ASCII via punycode: "+pi}un[Yn]=Zn.join("@")}return ln},serialize:function(Xr,sn){var ln=Xr,un=Lt(Xr.to);if(un){for(var wn=0,gn=un.length;wn<gn;++wn){var En=String(un[wn]),Dn=En.lastIndexOf("@"),kn=En.slice(0,Dn).replace(Jn,en).replace(Jn,Ut).replace(Bn,Rr),Cn=En.slice(Dn+1);try{Cn=sn.iri?Cr.toUnicode(Cn):Cr.toASCII(cn(Cn,sn).toLowerCase())}catch(Yn){ln.error=ln.error||"Email address's domain name can not be converted to "+(sn.iri?"Unicode":"ASCII")+" via punycode: "+Yn}un[wn]=kn+"@"+Cn}ln.path=un.join(",")}var Nn=Xr.headers=Xr.headers||{};Xr.subject&&(Nn.subject=Xr.subject),Xr.body&&(Nn.body=Xr.body);var Xn=[];for(var Rn in Nn)Nn[Rn]!==Un[Rn]&&Xn.push(Rn.replace(Jn,en).replace(Jn,Ut).replace(Qn,Rr)+"="+Nn[Rn].replace(Jn,en).replace(Jn,Ut).replace(Zr,Rr));return Xn.length&&(ln.query=Xn.join("&")),ln}},mn=/^([^\:]+)\:(.*)/,yn={scheme:"urn",parse:function(Xr,sn){var ln=Xr.path&&Xr.path.match(mn),un=Xr;if(ln){var wn=sn.scheme||un.scheme||"urn",gn=ln[1].toLowerCase(),En=ln[2],Dn=wn+":"+(sn.nid||gn),kn=xr[Dn];un.nid=gn,un.nss=En,un.path=void 0,kn&&(un=kn.parse(un,sn))}else un.error=un.error||"URN can not be parsed.";return un},serialize:function(Xr,sn){var ln=sn.scheme||Xr.scheme||"urn",un=Xr.nid,wn=ln+":"+(sn.nid||un),gn=xr[wn];gn&&(Xr=gn.serialize(Xr,sn));var En=Xr,Dn=Xr.nss;return En.path=(un||sn.nid)+":"+Dn,En}},Ln=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Gn={scheme:"urn:uuid",parse:function(Xr,sn){var ln=Xr;return ln.uuid=ln.nss,ln.nss=void 0,!sn.tolerant&&(!ln.uuid||!ln.uuid.match(Ln))&&(ln.error=ln.error||"UUID is not valid."),ln},serialize:function(Xr,sn){var ln=Xr;return ln.nss=(Xr.uuid||"").toLowerCase(),ln}};xr[vn.scheme]=vn,xr[_n.scheme]=_n,xr[$n.scheme]=$n,xr[Kn.scheme]=Kn,xr[pn.scheme]=pn,xr[yn.scheme]=yn,xr[Gn.scheme]=Gn,xt.SCHEMES=xr,xt.pctEncChar=Rr,xt.pctDecChars=qr,xt.parse=jr,xt.removeDotSegments=nn,xt.serialize=fn,xt.resolveComponents=hn,xt.resolve=Jr,xt.normalize=Yr,xt.equal=an,xt.escapeComponent=dn,xt.unescapeComponent=cn,Object.defineProperty(xt,"__esModule",{value:!0})})})(uri_all,uri_all.exports);var uri_allExports=uri_all.exports;Object.defineProperty(uri$1,"__esModule",{value:!0});const uri=uri_allExports;uri.code='require("ajv/dist/runtime/uri").default';uri$1.default=uri;(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.CodeGen=kt.Name=kt.nil=kt.stringify=kt.str=kt._=kt.KeywordCxt=void 0;var At=validate;Object.defineProperty(kt,"KeywordCxt",{enumerable:!0,get:function(){return At.KeywordCxt}});var xt=codegen;Object.defineProperty(kt,"_",{enumerable:!0,get:function(){return xt._}}),Object.defineProperty(kt,"str",{enumerable:!0,get:function(){return xt.str}}),Object.defineProperty(kt,"stringify",{enumerable:!0,get:function(){return xt.stringify}}),Object.defineProperty(kt,"nil",{enumerable:!0,get:function(){return xt.nil}}),Object.defineProperty(kt,"Name",{enumerable:!0,get:function(){return xt.Name}}),Object.defineProperty(kt,"CodeGen",{enumerable:!0,get:function(){return xt.CodeGen}});const Bt=validation_error,Nt=ref_error,jt=rules,Ut=compile,Lt=codegen,Ht=resolve$5,Vt=dataType,zt=util$1,Wt=require$$9,Jt=uri$1,Qt=(fr,br)=>new RegExp(fr,br);Qt.code="new RegExp";const Xt=["removeAdditional","useDefaults","coerceTypes"],tr=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),rr={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},nr={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},ar=200;function ir(fr){var br,_r,Tr,Pr,Nr,Cr,xr,Rr,qr,Vr,Gr,Ur,kr,Fr,Wr,jr,Ir,Mr,Hr,Qr,on,nn,fn,hn,Jr;const Yr=fr.strict,an=(br=fr.code)===null||br===void 0?void 0:br.optimize,dn=an===!0||an===void 0?1:an||0,cn=(Tr=(_r=fr.code)===null||_r===void 0?void 0:_r.regExp)!==null&&Tr!==void 0?Tr:Qt,vn=(Pr=fr.uriResolver)!==null&&Pr!==void 0?Pr:Jt.default;return{strictSchema:(Cr=(Nr=fr.strictSchema)!==null&&Nr!==void 0?Nr:Yr)!==null&&Cr!==void 0?Cr:!0,strictNumbers:(Rr=(xr=fr.strictNumbers)!==null&&xr!==void 0?xr:Yr)!==null&&Rr!==void 0?Rr:!0,strictTypes:(Vr=(qr=fr.strictTypes)!==null&&qr!==void 0?qr:Yr)!==null&&Vr!==void 0?Vr:"log",strictTuples:(Ur=(Gr=fr.strictTuples)!==null&&Gr!==void 0?Gr:Yr)!==null&&Ur!==void 0?Ur:"log",strictRequired:(Fr=(kr=fr.strictRequired)!==null&&kr!==void 0?kr:Yr)!==null&&Fr!==void 0?Fr:!1,code:fr.code?{...fr.code,optimize:dn,regExp:cn}:{optimize:dn,regExp:cn},loopRequired:(Wr=fr.loopRequired)!==null&&Wr!==void 0?Wr:ar,loopEnum:(jr=fr.loopEnum)!==null&&jr!==void 0?jr:ar,meta:(Ir=fr.meta)!==null&&Ir!==void 0?Ir:!0,messages:(Mr=fr.messages)!==null&&Mr!==void 0?Mr:!0,inlineRefs:(Hr=fr.inlineRefs)!==null&&Hr!==void 0?Hr:!0,schemaId:(Qr=fr.schemaId)!==null&&Qr!==void 0?Qr:"$id",addUsedSchema:(on=fr.addUsedSchema)!==null&&on!==void 0?on:!0,validateSchema:(nn=fr.validateSchema)!==null&&nn!==void 0?nn:!0,validateFormats:(fn=fr.validateFormats)!==null&&fn!==void 0?fn:!0,unicodeRegExp:(hn=fr.unicodeRegExp)!==null&&hn!==void 0?hn:!0,int32range:(Jr=fr.int32range)!==null&&Jr!==void 0?Jr:!0,uriResolver:vn}}class lr{constructor(br={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,br=this.opts={...br,...ir(br)};const{es5:_r,lines:Tr}=this.opts.code;this.scope=new Lt.ValueScope({scope:{},prefixes:tr,es5:_r,lines:Tr}),this.logger=vr(br.logger);const Pr=br.validateFormats;br.validateFormats=!1,this.RULES=(0,jt.getRules)(),yr.call(this,rr,br,"NOT SUPPORTED"),yr.call(this,nr,br,"DEPRECATED","warn"),this._metaOpts=Lr.call(this),br.formats&&Dr.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),br.keywords&&Br.call(this,br.keywords),typeof br.meta=="object"&&this.addMetaSchema(br.meta),Ar.call(this),br.validateFormats=Pr}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:br,meta:_r,schemaId:Tr}=this.opts;let Pr=Wt;Tr==="id"&&(Pr={...Wt},Pr.id=Pr.$id,delete Pr.$id),_r&&br&&this.addMetaSchema(Pr,Pr[Tr],!1)}defaultMeta(){const{meta:br,schemaId:_r}=this.opts;return this.opts.defaultMeta=typeof br=="object"?br[_r]||br:void 0}validate(br,_r){let Tr;if(typeof br=="string"){if(Tr=this.getSchema(br),!Tr)throw new Error(`no schema with key or ref "${br}"`)}else Tr=this.compile(br);const Pr=Tr(_r);return"$async"in Tr||(this.errors=Tr.errors),Pr}compile(br,_r){const Tr=this._addSchema(br,_r);return Tr.validate||this._compileSchemaEnv(Tr)}compileAsync(br,_r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:Tr}=this.opts;return Pr.call(this,br,_r);async function Pr(Vr,Gr){await Nr.call(this,Vr.$schema);const Ur=this._addSchema(Vr,Gr);return Ur.validate||Cr.call(this,Ur)}async function Nr(Vr){Vr&&!this.getSchema(Vr)&&await Pr.call(this,{$ref:Vr},!0)}async function Cr(Vr){try{return this._compileSchemaEnv(Vr)}catch(Gr){if(!(Gr instanceof Nt.default))throw Gr;return xr.call(this,Gr),await Rr.call(this,Gr.missingSchema),Cr.call(this,Vr)}}function xr({missingSchema:Vr,missingRef:Gr}){if(this.refs[Vr])throw new Error(`AnySchema ${Vr} is loaded but ${Gr} cannot be resolved`)}async function Rr(Vr){const Gr=await qr.call(this,Vr);this.refs[Vr]||await Nr.call(this,Gr.$schema),this.refs[Vr]||this.addSchema(Gr,Vr,_r)}async function qr(Vr){const Gr=this._loading[Vr];if(Gr)return Gr;try{return await(this._loading[Vr]=Tr(Vr))}finally{delete this._loading[Vr]}}}addSchema(br,_r,Tr,Pr=this.opts.validateSchema){if(Array.isArray(br)){for(const Cr of br)this.addSchema(Cr,void 0,Tr,Pr);return this}let Nr;if(typeof br=="object"){const{schemaId:Cr}=this.opts;if(Nr=br[Cr],Nr!==void 0&&typeof Nr!="string")throw new Error(`schema ${Cr} must be string`)}return _r=(0,Ht.normalizeId)(_r||Nr),this._checkUnique(_r),this.schemas[_r]=this._addSchema(br,Tr,_r,Pr,!0),this}addMetaSchema(br,_r,Tr=this.opts.validateSchema){return this.addSchema(br,_r,!0,Tr),this}validateSchema(br,_r){if(typeof br=="boolean")return!0;let Tr;if(Tr=br.$schema,Tr!==void 0&&typeof Tr!="string")throw new Error("$schema must be a string");if(Tr=Tr||this.opts.defaultMeta||this.defaultMeta(),!Tr)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const Pr=this.validate(Tr,br);if(!Pr&&_r){const Nr="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(Nr);else throw new Error(Nr)}return Pr}getSchema(br){let _r;for(;typeof(_r=Sr.call(this,br))=="string";)br=_r;if(_r===void 0){const{schemaId:Tr}=this.opts,Pr=new Ut.SchemaEnv({schema:{},schemaId:Tr});if(_r=Ut.resolveSchema.call(this,Pr,br),!_r)return;this.refs[br]=_r}return _r.validate||this._compileSchemaEnv(_r)}removeSchema(br){if(br instanceof RegExp)return this._removeAllSchemas(this.schemas,br),this._removeAllSchemas(this.refs,br),this;switch(typeof br){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const _r=Sr.call(this,br);return typeof _r=="object"&&this._cache.delete(_r.schema),delete this.schemas[br],delete this.refs[br],this}case"object":{const _r=br;this._cache.delete(_r);let Tr=br[this.opts.schemaId];return Tr&&(Tr=(0,Ht.normalizeId)(Tr),delete this.schemas[Tr],delete this.refs[Tr]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(br){for(const _r of br)this.addKeyword(_r);return this}addKeyword(br,_r){let Tr;if(typeof br=="string")Tr=br,typeof _r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),_r.keyword=Tr);else if(typeof br=="object"&&_r===void 0){if(_r=br,Tr=_r.keyword,Array.isArray(Tr)&&!Tr.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(dr.call(this,Tr,_r),!_r)return(0,zt.eachItem)(Tr,Nr=>ur.call(this,Nr)),this;wr.call(this,_r);const Pr={..._r,type:(0,Vt.getJSONTypes)(_r.type),schemaType:(0,Vt.getJSONTypes)(_r.schemaType)};return(0,zt.eachItem)(Tr,Pr.type.length===0?Nr=>ur.call(this,Nr,Pr):Nr=>Pr.type.forEach(Cr=>ur.call(this,Nr,Pr,Cr))),this}getKeyword(br){const _r=this.RULES.all[br];return typeof _r=="object"?_r.definition:!!_r}removeKeyword(br){const{RULES:_r}=this;delete _r.keywords[br],delete _r.all[br];for(const Tr of _r.rules){const Pr=Tr.rules.findIndex(Nr=>Nr.keyword===br);Pr>=0&&Tr.rules.splice(Pr,1)}return this}addFormat(br,_r){return typeof _r=="string"&&(_r=new RegExp(_r)),this.formats[br]=_r,this}errorsText(br=this.errors,{separator:_r=", ",dataVar:Tr="data"}={}){return!br||br.length===0?"No errors":br.map(Pr=>`${Tr}${Pr.instancePath} ${Pr.message}`).reduce((Pr,Nr)=>Pr+_r+Nr)}$dataMetaSchema(br,_r){const Tr=this.RULES.all;br=JSON.parse(JSON.stringify(br));for(const Pr of _r){const Nr=Pr.split("/").slice(1);let Cr=br;for(const xr of Nr)Cr=Cr[xr];for(const xr in Tr){const Rr=Tr[xr];if(typeof Rr!="object")continue;const{$data:qr}=Rr.definition,Vr=Cr[xr];qr&&Vr&&(Cr[xr]=gr(Vr))}}return br}_removeAllSchemas(br,_r){for(const Tr in br){const Pr=br[Tr];(!_r||_r.test(Tr))&&(typeof Pr=="string"?delete br[Tr]:Pr&&!Pr.meta&&(this._cache.delete(Pr.schema),delete br[Tr]))}}_addSchema(br,_r,Tr,Pr=this.opts.validateSchema,Nr=this.opts.addUsedSchema){let Cr;const{schemaId:xr}=this.opts;if(typeof br=="object")Cr=br[xr];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof br!="boolean")throw new Error("schema must be object or boolean")}let Rr=this._cache.get(br);if(Rr!==void 0)return Rr;Tr=(0,Ht.normalizeId)(Cr||Tr);const qr=Ht.getSchemaRefs.call(this,br,Tr);return Rr=new Ut.SchemaEnv({schema:br,schemaId:xr,meta:_r,baseId:Tr,localRefs:qr}),this._cache.set(Rr.schema,Rr),Nr&&!Tr.startsWith("#")&&(Tr&&this._checkUnique(Tr),this.refs[Tr]=Rr),Pr&&this.validateSchema(br,!0),Rr}_checkUnique(br){if(this.schemas[br]||this.refs[br])throw new Error(`schema with key or id "${br}" already exists`)}_compileSchemaEnv(br){if(br.meta?this._compileMetaSchema(br):Ut.compileSchema.call(this,br),!br.validate)throw new Error("ajv implementation error");return br.validate}_compileMetaSchema(br){const _r=this.opts;this.opts=this._metaOpts;try{Ut.compileSchema.call(this,br)}finally{this.opts=_r}}}kt.default=lr,lr.ValidationError=Bt.default,lr.MissingRefError=Nt.default;function yr(fr,br,_r,Tr="error"){for(const Pr in fr){const Nr=Pr;Nr in br&&this.logger[Tr](`${_r}: option ${Pr}. ${fr[Nr]}`)}}function Sr(fr){return fr=(0,Ht.normalizeId)(fr),this.schemas[fr]||this.refs[fr]}function Ar(){const fr=this.opts.schemas;if(fr)if(Array.isArray(fr))this.addSchema(fr);else for(const br in fr)this.addSchema(fr[br],br)}function Dr(){for(const fr in this.opts.formats){const br=this.opts.formats[fr];br&&this.addFormat(fr,br)}}function Br(fr){if(Array.isArray(fr)){this.addVocabulary(fr);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const br in fr){const _r=fr[br];_r.keyword||(_r.keyword=br),this.addKeyword(_r)}}function Lr(){const fr={...this.opts};for(const br of Xt)delete fr[br];return fr}const Or={log(){},warn(){},error(){}};function vr(fr){if(fr===!1)return Or;if(fr===void 0)return console;if(fr.log&&fr.warn&&fr.error)return fr;throw new Error("logger must implement log, warn and error methods")}const pr=/^[a-z_$][a-z0-9_$:-]*$/i;function dr(fr,br){const{RULES:_r}=this;if((0,zt.eachItem)(fr,Tr=>{if(_r.keywords[Tr])throw new Error(`Keyword ${Tr} is already defined`);if(!pr.test(Tr))throw new Error(`Keyword ${Tr} has invalid name`)}),!!br&&br.$data&&!("code"in br||"validate"in br))throw new Error('$data keyword must have "code" or "validate" function')}function ur(fr,br,_r){var Tr;const Pr=br==null?void 0:br.post;if(_r&&Pr)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:Nr}=this;let Cr=Pr?Nr.post:Nr.rules.find(({type:Rr})=>Rr===_r);if(Cr||(Cr={type:_r,rules:[]},Nr.rules.push(Cr)),Nr.keywords[fr]=!0,!br)return;const xr={keyword:fr,definition:{...br,type:(0,Vt.getJSONTypes)(br.type),schemaType:(0,Vt.getJSONTypes)(br.schemaType)}};br.before?$r.call(this,Cr,xr,br.before):Cr.rules.push(xr),Nr.all[fr]=xr,(Tr=br.implements)===null||Tr===void 0||Tr.forEach(Rr=>this.addKeyword(Rr))}function $r(fr,br,_r){const Tr=fr.rules.findIndex(Pr=>Pr.keyword===_r);Tr>=0?fr.rules.splice(Tr,0,br):(fr.rules.push(br),this.logger.warn(`rule ${_r} is not defined`))}function wr(fr){let{metaSchema:br}=fr;br!==void 0&&(fr.$data&&this.opts.$data&&(br=gr(br)),fr.validateSchema=this.compile(br,!0))}const Er={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function gr(fr){return{anyOf:[fr,Er]}}})(core$3);var draft2020={},core$2={},id={};Object.defineProperty(id,"__esModule",{value:!0});const def$B={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};id.default=def$B;var ref={};Object.defineProperty(ref,"__esModule",{value:!0});ref.callRef=ref.getValidate=void 0;const ref_error_1=ref_error,code_1$8=code$1,codegen_1$p=codegen,names_1$4=names$1,compile_1$2=compile,util_1$n=util$1,def$A={keyword:"$ref",schemaType:"string",code(kt){const{gen:At,schema:xt,it:Bt}=kt,{baseId:Nt,schemaEnv:jt,validateName:Ut,opts:Lt,self:Ht}=Bt,{root:Vt}=jt;if((xt==="#"||xt==="#/")&&Nt===Vt.baseId)return Wt();const zt=compile_1$2.resolveRef.call(Ht,Vt,Nt,xt);if(zt===void 0)throw new ref_error_1.default(Bt.opts.uriResolver,Nt,xt);if(zt instanceof compile_1$2.SchemaEnv)return Jt(zt);return Qt(zt);function Wt(){if(jt===Vt)return callRef(kt,Ut,jt,jt.$async);const Xt=At.scopeValue("root",{ref:Vt});return callRef(kt,(0,codegen_1$p._)`${Xt}.validate`,Vt,Vt.$async)}function Jt(Xt){const tr=getValidate(kt,Xt);callRef(kt,tr,Xt,Xt.$async)}function Qt(Xt){const tr=At.scopeValue("schema",Lt.code.source===!0?{ref:Xt,code:(0,codegen_1$p.stringify)(Xt)}:{ref:Xt}),rr=At.name("valid"),nr=kt.subschema({schema:Xt,dataTypes:[],schemaPath:codegen_1$p.nil,topSchemaRef:tr,errSchemaPath:xt},rr);kt.mergeEvaluated(nr),kt.ok(rr)}}};function getValidate(kt,At){const{gen:xt}=kt;return At.validate?xt.scopeValue("validate",{ref:At.validate}):(0,codegen_1$p._)`${xt.scopeValue("wrapper",{ref:At})}.validate`}ref.getValidate=getValidate;function callRef(kt,At,xt,Bt){const{gen:Nt,it:jt}=kt,{allErrors:Ut,schemaEnv:Lt,opts:Ht}=jt,Vt=Ht.passContext?names_1$4.default.this:codegen_1$p.nil;Bt?zt():Wt();function zt(){if(!Lt.$async)throw new Error("async schema referenced by sync schema");const Xt=Nt.let("valid");Nt.try(()=>{Nt.code((0,codegen_1$p._)`await ${(0,code_1$8.callValidateCode)(kt,At,Vt)}`),Qt(At),Ut||Nt.assign(Xt,!0)},tr=>{Nt.if((0,codegen_1$p._)`!(${tr} instanceof ${jt.ValidationError})`,()=>Nt.throw(tr)),Jt(tr),Ut||Nt.assign(Xt,!1)}),kt.ok(Xt)}function Wt(){kt.result((0,code_1$8.callValidateCode)(kt,At,Vt),()=>Qt(At),()=>Jt(At))}function Jt(Xt){const tr=(0,codegen_1$p._)`${Xt}.errors`;Nt.assign(names_1$4.default.vErrors,(0,codegen_1$p._)`${names_1$4.default.vErrors} === null ? ${tr} : ${names_1$4.default.vErrors}.concat(${tr})`),Nt.assign(names_1$4.default.errors,(0,codegen_1$p._)`${names_1$4.default.vErrors}.length`)}function Qt(Xt){var tr;if(!jt.opts.unevaluated)return;const rr=(tr=xt==null?void 0:xt.validate)===null||tr===void 0?void 0:tr.evaluated;if(jt.props!==!0)if(rr&&!rr.dynamicProps)rr.props!==void 0&&(jt.props=util_1$n.mergeEvaluated.props(Nt,rr.props,jt.props));else{const nr=Nt.var("props",(0,codegen_1$p._)`${Xt}.evaluated.props`);jt.props=util_1$n.mergeEvaluated.props(Nt,nr,jt.props,codegen_1$p.Name)}if(jt.items!==!0)if(rr&&!rr.dynamicItems)rr.items!==void 0&&(jt.items=util_1$n.mergeEvaluated.items(Nt,rr.items,jt.items));else{const nr=Nt.var("items",(0,codegen_1$p._)`${Xt}.evaluated.items`);jt.items=util_1$n.mergeEvaluated.items(Nt,nr,jt.items,codegen_1$p.Name)}}}ref.callRef=callRef;ref.default=def$A;Object.defineProperty(core$2,"__esModule",{value:!0});const id_1=id,ref_1$2=ref,core$1=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",id_1.default,ref_1$2.default];core$2.default=core$1;var validation$2={},limitNumber={};Object.defineProperty(limitNumber,"__esModule",{value:!0});const codegen_1$o=codegen,ops=codegen_1$o.operators,KWDs={maximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},minimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},exclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},exclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}},error$k={message:({keyword:kt,schemaCode:At})=>(0,codegen_1$o.str)`must be ${KWDs[kt].okStr} ${At}`,params:({keyword:kt,schemaCode:At})=>(0,codegen_1$o._)`{comparison: ${KWDs[kt].okStr}, limit: ${At}}`},def$z={keyword:Object.keys(KWDs),type:"number",schemaType:"number",$data:!0,error:error$k,code(kt){const{keyword:At,data:xt,schemaCode:Bt}=kt;kt.fail$data((0,codegen_1$o._)`${xt} ${KWDs[At].fail} ${Bt} || isNaN(${xt})`)}};limitNumber.default=def$z;var multipleOf={};Object.defineProperty(multipleOf,"__esModule",{value:!0});const codegen_1$n=codegen,error$j={message:({schemaCode:kt})=>(0,codegen_1$n.str)`must be multiple of ${kt}`,params:({schemaCode:kt})=>(0,codegen_1$n._)`{multipleOf: ${kt}}`},def$y={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:error$j,code(kt){const{gen:At,data:xt,schemaCode:Bt,it:Nt}=kt,jt=Nt.opts.multipleOfPrecision,Ut=At.let("res"),Lt=jt?(0,codegen_1$n._)`Math.abs(Math.round(${Ut}) - ${Ut}) > 1e-${jt}`:(0,codegen_1$n._)`${Ut} !== parseInt(${Ut})`;kt.fail$data((0,codegen_1$n._)`(${Bt} === 0 || (${Ut} = ${xt}/${Bt}, ${Lt}))`)}};multipleOf.default=def$y;var limitLength={},ucs2length$1={};Object.defineProperty(ucs2length$1,"__esModule",{value:!0});function ucs2length(kt){const At=kt.length;let xt=0,Bt=0,Nt;for(;Bt<At;)xt++,Nt=kt.charCodeAt(Bt++),Nt>=55296&&Nt<=56319&&Bt<At&&(Nt=kt.charCodeAt(Bt),(Nt&64512)===56320&&Bt++);return xt}ucs2length$1.default=ucs2length;ucs2length.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(limitLength,"__esModule",{value:!0});const codegen_1$m=codegen,util_1$m=util$1,ucs2length_1=ucs2length$1,error$i={message({keyword:kt,schemaCode:At}){const xt=kt==="maxLength"?"more":"fewer";return(0,codegen_1$m.str)`must NOT have ${xt} than ${At} characters`},params:({schemaCode:kt})=>(0,codegen_1$m._)`{limit: ${kt}}`},def$x={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:error$i,code(kt){const{keyword:At,data:xt,schemaCode:Bt,it:Nt}=kt,jt=At==="maxLength"?codegen_1$m.operators.GT:codegen_1$m.operators.LT,Ut=Nt.opts.unicode===!1?(0,codegen_1$m._)`${xt}.length`:(0,codegen_1$m._)`${(0,util_1$m.useFunc)(kt.gen,ucs2length_1.default)}(${xt})`;kt.fail$data((0,codegen_1$m._)`${Ut} ${jt} ${Bt}`)}};limitLength.default=def$x;var pattern={};Object.defineProperty(pattern,"__esModule",{value:!0});const code_1$7=code$1,codegen_1$l=codegen,error$h={message:({schemaCode:kt})=>(0,codegen_1$l.str)`must match pattern "${kt}"`,params:({schemaCode:kt})=>(0,codegen_1$l._)`{pattern: ${kt}}`},def$w={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:error$h,code(kt){const{data:At,$data:xt,schema:Bt,schemaCode:Nt,it:jt}=kt,Ut=jt.opts.unicodeRegExp?"u":"",Lt=xt?(0,codegen_1$l._)`(new RegExp(${Nt}, ${Ut}))`:(0,code_1$7.usePattern)(kt,Bt);kt.fail$data((0,codegen_1$l._)`!${Lt}.test(${At})`)}};pattern.default=def$w;var limitProperties={};Object.defineProperty(limitProperties,"__esModule",{value:!0});const codegen_1$k=codegen,error$g={message({keyword:kt,schemaCode:At}){const xt=kt==="maxProperties"?"more":"fewer";return(0,codegen_1$k.str)`must NOT have ${xt} than ${At} properties`},params:({schemaCode:kt})=>(0,codegen_1$k._)`{limit: ${kt}}`},def$v={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:error$g,code(kt){const{keyword:At,data:xt,schemaCode:Bt}=kt,Nt=At==="maxProperties"?codegen_1$k.operators.GT:codegen_1$k.operators.LT;kt.fail$data((0,codegen_1$k._)`Object.keys(${xt}).length ${Nt} ${Bt}`)}};limitProperties.default=def$v;var required={};Object.defineProperty(required,"__esModule",{value:!0});const code_1$6=code$1,codegen_1$j=codegen,util_1$l=util$1,error$f={message:({params:{missingProperty:kt}})=>(0,codegen_1$j.str)`must have required property '${kt}'`,params:({params:{missingProperty:kt}})=>(0,codegen_1$j._)`{missingProperty: ${kt}}`},def$u={keyword:"required",type:"object",schemaType:"array",$data:!0,error:error$f,code(kt){const{gen:At,schema:xt,schemaCode:Bt,data:Nt,$data:jt,it:Ut}=kt,{opts:Lt}=Ut;if(!jt&&xt.length===0)return;const Ht=xt.length>=Lt.loopRequired;if(Ut.allErrors?Vt():zt(),Lt.strictRequired){const Qt=kt.parentSchema.properties,{definedProperties:Xt}=kt.it;for(const tr of xt)if((Qt==null?void 0:Qt[tr])===void 0&&!Xt.has(tr)){const rr=Ut.schemaEnv.baseId+Ut.errSchemaPath,nr=`required property "${tr}" is not defined at "${rr}" (strictRequired)`;(0,util_1$l.checkStrictMode)(Ut,nr,Ut.opts.strictRequired)}}function Vt(){if(Ht||jt)kt.block$data(codegen_1$j.nil,Wt);else for(const Qt of xt)(0,code_1$6.checkReportMissingProp)(kt,Qt)}function zt(){const Qt=At.let("missing");if(Ht||jt){const Xt=At.let("valid",!0);kt.block$data(Xt,()=>Jt(Qt,Xt)),kt.ok(Xt)}else At.if((0,code_1$6.checkMissingProp)(kt,xt,Qt)),(0,code_1$6.reportMissingProp)(kt,Qt),At.else()}function Wt(){At.forOf("prop",Bt,Qt=>{kt.setParams({missingProperty:Qt}),At.if((0,code_1$6.noPropertyInData)(At,Nt,Qt,Lt.ownProperties),()=>kt.error())})}function Jt(Qt,Xt){kt.setParams({missingProperty:Qt}),At.forOf(Qt,Bt,()=>{At.assign(Xt,(0,code_1$6.propertyInData)(At,Nt,Qt,Lt.ownProperties)),At.if((0,codegen_1$j.not)(Xt),()=>{kt.error(),At.break()})},codegen_1$j.nil)}}};required.default=def$u;var limitItems={};Object.defineProperty(limitItems,"__esModule",{value:!0});const codegen_1$i=codegen,error$e={message({keyword:kt,schemaCode:At}){const xt=kt==="maxItems"?"more":"fewer";return(0,codegen_1$i.str)`must NOT have ${xt} than ${At} items`},params:({schemaCode:kt})=>(0,codegen_1$i._)`{limit: ${kt}}`},def$t={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:error$e,code(kt){const{keyword:At,data:xt,schemaCode:Bt}=kt,Nt=At==="maxItems"?codegen_1$i.operators.GT:codegen_1$i.operators.LT;kt.fail$data((0,codegen_1$i._)`${xt}.length ${Nt} ${Bt}`)}};limitItems.default=def$t;var uniqueItems={},equal$1={};Object.defineProperty(equal$1,"__esModule",{value:!0});const equal=fastDeepEqual;equal.code='require("ajv/dist/runtime/equal").default';equal$1.default=equal;Object.defineProperty(uniqueItems,"__esModule",{value:!0});const dataType_1=dataType,codegen_1$h=codegen,util_1$k=util$1,equal_1$2=equal$1,error$d={message:({params:{i:kt,j:At}})=>(0,codegen_1$h.str)`must NOT have duplicate items (items ## ${At} and ${kt} are identical)`,params:({params:{i:kt,j:At}})=>(0,codegen_1$h._)`{i: ${kt}, j: ${At}}`},def$s={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:error$d,code(kt){const{gen:At,data:xt,$data:Bt,schema:Nt,parentSchema:jt,schemaCode:Ut,it:Lt}=kt;if(!Bt&&!Nt)return;const Ht=At.let("valid"),Vt=jt.items?(0,dataType_1.getSchemaTypes)(jt.items):[];kt.block$data(Ht,zt,(0,codegen_1$h._)`${Ut} === false`),kt.ok(Ht);function zt(){const Xt=At.let("i",(0,codegen_1$h._)`${xt}.length`),tr=At.let("j");kt.setParams({i:Xt,j:tr}),At.assign(Ht,!0),At.if((0,codegen_1$h._)`${Xt} > 1`,()=>(Wt()?Jt:Qt)(Xt,tr))}function Wt(){return Vt.length>0&&!Vt.some(Xt=>Xt==="object"||Xt==="array")}function Jt(Xt,tr){const rr=At.name("item"),nr=(0,dataType_1.checkDataTypes)(Vt,rr,Lt.opts.strictNumbers,dataType_1.DataType.Wrong),ar=At.const("indices",(0,codegen_1$h._)`{}`);At.for((0,codegen_1$h._)`;${Xt}--;`,()=>{At.let(rr,(0,codegen_1$h._)`${xt}[${Xt}]`),At.if(nr,(0,codegen_1$h._)`continue`),Vt.length>1&&At.if((0,codegen_1$h._)`typeof ${rr} == "string"`,(0,codegen_1$h._)`${rr} += "_"`),At.if((0,codegen_1$h._)`typeof ${ar}[${rr}] == "number"`,()=>{At.assign(tr,(0,codegen_1$h._)`${ar}[${rr}]`),kt.error(),At.assign(Ht,!1).break()}).code((0,codegen_1$h._)`${ar}[${rr}] = ${Xt}`)})}function Qt(Xt,tr){const rr=(0,util_1$k.useFunc)(At,equal_1$2.default),nr=At.name("outer");At.label(nr).for((0,codegen_1$h._)`;${Xt}--;`,()=>At.for((0,codegen_1$h._)`${tr} = ${Xt}; ${tr}--;`,()=>At.if((0,codegen_1$h._)`${rr}(${xt}[${Xt}], ${xt}[${tr}])`,()=>{kt.error(),At.assign(Ht,!1).break(nr)})))}}};uniqueItems.default=def$s;var _const={};Object.defineProperty(_const,"__esModule",{value:!0});const codegen_1$g=codegen,util_1$j=util$1,equal_1$1=equal$1,error$c={message:"must be equal to constant",params:({schemaCode:kt})=>(0,codegen_1$g._)`{allowedValue: ${kt}}`},def$r={keyword:"const",$data:!0,error:error$c,code(kt){const{gen:At,data:xt,$data:Bt,schemaCode:Nt,schema:jt}=kt;Bt||jt&&typeof jt=="object"?kt.fail$data((0,codegen_1$g._)`!${(0,util_1$j.useFunc)(At,equal_1$1.default)}(${xt}, ${Nt})`):kt.fail((0,codegen_1$g._)`${jt} !== ${xt}`)}};_const.default=def$r;var _enum={};Object.defineProperty(_enum,"__esModule",{value:!0});const codegen_1$f=codegen,util_1$i=util$1,equal_1=equal$1,error$b={message:"must be equal to one of the allowed values",params:({schemaCode:kt})=>(0,codegen_1$f._)`{allowedValues: ${kt}}`},def$q={keyword:"enum",schemaType:"array",$data:!0,error:error$b,code(kt){const{gen:At,data:xt,$data:Bt,schema:Nt,schemaCode:jt,it:Ut}=kt;if(!Bt&&Nt.length===0)throw new Error("enum must have non-empty array");const Lt=Nt.length>=Ut.opts.loopEnum;let Ht;const Vt=()=>Ht??(Ht=(0,util_1$i.useFunc)(At,equal_1.default));let zt;if(Lt||Bt)zt=At.let("valid"),kt.block$data(zt,Wt);else{if(!Array.isArray(Nt))throw new Error("ajv implementation error");const Qt=At.const("vSchema",jt);zt=(0,codegen_1$f.or)(...Nt.map((Xt,tr)=>Jt(Qt,tr)))}kt.pass(zt);function Wt(){At.assign(zt,!1),At.forOf("v",jt,Qt=>At.if((0,codegen_1$f._)`${Vt()}(${xt}, ${Qt})`,()=>At.assign(zt,!0).break()))}function Jt(Qt,Xt){const tr=Nt[Xt];return typeof tr=="object"&&tr!==null?(0,codegen_1$f._)`${Vt()}(${xt}, ${Qt}[${Xt}])`:(0,codegen_1$f._)`${xt} === ${tr}`}}};_enum.default=def$q;Object.defineProperty(validation$2,"__esModule",{value:!0});const limitNumber_1=limitNumber,multipleOf_1=multipleOf,limitLength_1=limitLength,pattern_1=pattern,limitProperties_1=limitProperties,required_1=required,limitItems_1=limitItems,uniqueItems_1=uniqueItems,const_1=_const,enum_1=_enum,validation$1=[limitNumber_1.default,multipleOf_1.default,limitLength_1.default,pattern_1.default,limitProperties_1.default,required_1.default,limitItems_1.default,uniqueItems_1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},const_1.default,enum_1.default];validation$2.default=validation$1;var applicator$1={},additionalItems={};Object.defineProperty(additionalItems,"__esModule",{value:!0});additionalItems.validateAdditionalItems=void 0;const codegen_1$e=codegen,util_1$h=util$1,error$a={message:({params:{len:kt}})=>(0,codegen_1$e.str)`must NOT have more than ${kt} items`,params:({params:{len:kt}})=>(0,codegen_1$e._)`{limit: ${kt}}`},def$p={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:error$a,code(kt){const{parentSchema:At,it:xt}=kt,{items:Bt}=At;if(!Array.isArray(Bt)){(0,util_1$h.checkStrictMode)(xt,'"additionalItems" is ignored when "items" is not an array of schemas');return}validateAdditionalItems(kt,Bt)}};function validateAdditionalItems(kt,At){const{gen:xt,schema:Bt,data:Nt,keyword:jt,it:Ut}=kt;Ut.items=!0;const Lt=xt.const("len",(0,codegen_1$e._)`${Nt}.length`);if(Bt===!1)kt.setParams({len:At.length}),kt.pass((0,codegen_1$e._)`${Lt} <= ${At.length}`);else if(typeof Bt=="object"&&!(0,util_1$h.alwaysValidSchema)(Ut,Bt)){const Vt=xt.var("valid",(0,codegen_1$e._)`${Lt} <= ${At.length}`);xt.if((0,codegen_1$e.not)(Vt),()=>Ht(Vt)),kt.ok(Vt)}function Ht(Vt){xt.forRange("i",At.length,Lt,zt=>{kt.subschema({keyword:jt,dataProp:zt,dataPropType:util_1$h.Type.Num},Vt),Ut.allErrors||xt.if((0,codegen_1$e.not)(Vt),()=>xt.break())})}}additionalItems.validateAdditionalItems=validateAdditionalItems;additionalItems.default=def$p;var prefixItems={},items={};Object.defineProperty(items,"__esModule",{value:!0});items.validateTuple=void 0;const codegen_1$d=codegen,util_1$g=util$1,code_1$5=code$1,def$o={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(kt){const{schema:At,it:xt}=kt;if(Array.isArray(At))return validateTuple(kt,"additionalItems",At);xt.items=!0,!(0,util_1$g.alwaysValidSchema)(xt,At)&&kt.ok((0,code_1$5.validateArray)(kt))}};function validateTuple(kt,At,xt=kt.schema){const{gen:Bt,parentSchema:Nt,data:jt,keyword:Ut,it:Lt}=kt;zt(Nt),Lt.opts.unevaluated&&xt.length&&Lt.items!==!0&&(Lt.items=util_1$g.mergeEvaluated.items(Bt,xt.length,Lt.items));const Ht=Bt.name("valid"),Vt=Bt.const("len",(0,codegen_1$d._)`${jt}.length`);xt.forEach((Wt,Jt)=>{(0,util_1$g.alwaysValidSchema)(Lt,Wt)||(Bt.if((0,codegen_1$d._)`${Vt} > ${Jt}`,()=>kt.subschema({keyword:Ut,schemaProp:Jt,dataProp:Jt},Ht)),kt.ok(Ht))});function zt(Wt){const{opts:Jt,errSchemaPath:Qt}=Lt,Xt=xt.length,tr=Xt===Wt.minItems&&(Xt===Wt.maxItems||Wt[At]===!1);if(Jt.strictTuples&&!tr){const rr=`"${Ut}" is ${Xt}-tuple, but minItems or maxItems/${At} are not specified or different at path "${Qt}"`;(0,util_1$g.checkStrictMode)(Lt,rr,Jt.strictTuples)}}}items.validateTuple=validateTuple;items.default=def$o;Object.defineProperty(prefixItems,"__esModule",{value:!0});const items_1$1=items,def$n={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:kt=>(0,items_1$1.validateTuple)(kt,"items")};prefixItems.default=def$n;var items2020={};Object.defineProperty(items2020,"__esModule",{value:!0});const codegen_1$c=codegen,util_1$f=util$1,code_1$4=code$1,additionalItems_1$1=additionalItems,error$9={message:({params:{len:kt}})=>(0,codegen_1$c.str)`must NOT have more than ${kt} items`,params:({params:{len:kt}})=>(0,codegen_1$c._)`{limit: ${kt}}`},def$m={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:error$9,code(kt){const{schema:At,parentSchema:xt,it:Bt}=kt,{prefixItems:Nt}=xt;Bt.items=!0,!(0,util_1$f.alwaysValidSchema)(Bt,At)&&(Nt?(0,additionalItems_1$1.validateAdditionalItems)(kt,Nt):kt.ok((0,code_1$4.validateArray)(kt)))}};items2020.default=def$m;var contains={};Object.defineProperty(contains,"__esModule",{value:!0});const codegen_1$b=codegen,util_1$e=util$1,error$8={message:({params:{min:kt,max:At}})=>At===void 0?(0,codegen_1$b.str)`must contain at least ${kt} valid item(s)`:(0,codegen_1$b.str)`must contain at least ${kt} and no more than ${At} valid item(s)`,params:({params:{min:kt,max:At}})=>At===void 0?(0,codegen_1$b._)`{minContains: ${kt}}`:(0,codegen_1$b._)`{minContains: ${kt}, maxContains: ${At}}`},def$l={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:error$8,code(kt){const{gen:At,schema:xt,parentSchema:Bt,data:Nt,it:jt}=kt;let Ut,Lt;const{minContains:Ht,maxContains:Vt}=Bt;jt.opts.next?(Ut=Ht===void 0?1:Ht,Lt=Vt):Ut=1;const zt=At.const("len",(0,codegen_1$b._)`${Nt}.length`);if(kt.setParams({min:Ut,max:Lt}),Lt===void 0&&Ut===0){(0,util_1$e.checkStrictMode)(jt,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(Lt!==void 0&&Ut>Lt){(0,util_1$e.checkStrictMode)(jt,'"minContains" > "maxContains" is always invalid'),kt.fail();return}if((0,util_1$e.alwaysValidSchema)(jt,xt)){let tr=(0,codegen_1$b._)`${zt} >= ${Ut}`;Lt!==void 0&&(tr=(0,codegen_1$b._)`${tr} && ${zt} <= ${Lt}`),kt.pass(tr);return}jt.items=!0;const Wt=At.name("valid");Lt===void 0&&Ut===1?Qt(Wt,()=>At.if(Wt,()=>At.break())):Ut===0?(At.let(Wt,!0),Lt!==void 0&&At.if((0,codegen_1$b._)`${Nt}.length > 0`,Jt)):(At.let(Wt,!1),Jt()),kt.result(Wt,()=>kt.reset());function Jt(){const tr=At.name("_valid"),rr=At.let("count",0);Qt(tr,()=>At.if(tr,()=>Xt(rr)))}function Qt(tr,rr){At.forRange("i",0,zt,nr=>{kt.subschema({keyword:"contains",dataProp:nr,dataPropType:util_1$e.Type.Num,compositeRule:!0},tr),rr()})}function Xt(tr){At.code((0,codegen_1$b._)`${tr}++`),Lt===void 0?At.if((0,codegen_1$b._)`${tr} >= ${Ut}`,()=>At.assign(Wt,!0).break()):(At.if((0,codegen_1$b._)`${tr} > ${Lt}`,()=>At.assign(Wt,!1).break()),Ut===1?At.assign(Wt,!0):At.if((0,codegen_1$b._)`${tr} >= ${Ut}`,()=>At.assign(Wt,!0)))}}};contains.default=def$l;var dependencies={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.validateSchemaDeps=kt.validatePropertyDeps=kt.error=void 0;const At=codegen,xt=util$1,Bt=code$1;kt.error={message:({params:{property:Ht,depsCount:Vt,deps:zt}})=>{const Wt=Vt===1?"property":"properties";return(0,At.str)`must have ${Wt} ${zt} when property ${Ht} is present`},params:({params:{property:Ht,depsCount:Vt,deps:zt,missingProperty:Wt}})=>(0,At._)`{property: ${Ht},
    missingProperty: ${Wt},
    depsCount: ${Vt},
    deps: ${zt}}`};const Nt={keyword:"dependencies",type:"object",schemaType:"object",error:kt.error,code(Ht){const[Vt,zt]=jt(Ht);Ut(Ht,Vt),Lt(Ht,zt)}};function jt({schema:Ht}){const Vt={},zt={};for(const Wt in Ht){if(Wt==="__proto__")continue;const Jt=Array.isArray(Ht[Wt])?Vt:zt;Jt[Wt]=Ht[Wt]}return[Vt,zt]}function Ut(Ht,Vt=Ht.schema){const{gen:zt,data:Wt,it:Jt}=Ht;if(Object.keys(Vt).length===0)return;const Qt=zt.let("missing");for(const Xt in Vt){const tr=Vt[Xt];if(tr.length===0)continue;const rr=(0,Bt.propertyInData)(zt,Wt,Xt,Jt.opts.ownProperties);Ht.setParams({property:Xt,depsCount:tr.length,deps:tr.join(", ")}),Jt.allErrors?zt.if(rr,()=>{for(const nr of tr)(0,Bt.checkReportMissingProp)(Ht,nr)}):(zt.if((0,At._)`${rr} && (${(0,Bt.checkMissingProp)(Ht,tr,Qt)})`),(0,Bt.reportMissingProp)(Ht,Qt),zt.else())}}kt.validatePropertyDeps=Ut;function Lt(Ht,Vt=Ht.schema){const{gen:zt,data:Wt,keyword:Jt,it:Qt}=Ht,Xt=zt.name("valid");for(const tr in Vt)(0,xt.alwaysValidSchema)(Qt,Vt[tr])||(zt.if((0,Bt.propertyInData)(zt,Wt,tr,Qt.opts.ownProperties),()=>{const rr=Ht.subschema({keyword:Jt,schemaProp:tr},Xt);Ht.mergeValidEvaluated(rr,Xt)},()=>zt.var(Xt,!0)),Ht.ok(Xt))}kt.validateSchemaDeps=Lt,kt.default=Nt})(dependencies);var propertyNames={};Object.defineProperty(propertyNames,"__esModule",{value:!0});const codegen_1$a=codegen,util_1$d=util$1,error$7={message:"property name must be valid",params:({params:kt})=>(0,codegen_1$a._)`{propertyName: ${kt.propertyName}}`},def$k={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:error$7,code(kt){const{gen:At,schema:xt,data:Bt,it:Nt}=kt;if((0,util_1$d.alwaysValidSchema)(Nt,xt))return;const jt=At.name("valid");At.forIn("key",Bt,Ut=>{kt.setParams({propertyName:Ut}),kt.subschema({keyword:"propertyNames",data:Ut,dataTypes:["string"],propertyName:Ut,compositeRule:!0},jt),At.if((0,codegen_1$a.not)(jt),()=>{kt.error(!0),Nt.allErrors||At.break()})}),kt.ok(jt)}};propertyNames.default=def$k;var additionalProperties={};Object.defineProperty(additionalProperties,"__esModule",{value:!0});const code_1$3=code$1,codegen_1$9=codegen,names_1$3=names$1,util_1$c=util$1,error$6={message:"must NOT have additional properties",params:({params:kt})=>(0,codegen_1$9._)`{additionalProperty: ${kt.additionalProperty}}`},def$j={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:error$6,code(kt){const{gen:At,schema:xt,parentSchema:Bt,data:Nt,errsCount:jt,it:Ut}=kt;if(!jt)throw new Error("ajv implementation error");const{allErrors:Lt,opts:Ht}=Ut;if(Ut.props=!0,Ht.removeAdditional!=="all"&&(0,util_1$c.alwaysValidSchema)(Ut,xt))return;const Vt=(0,code_1$3.allSchemaProperties)(Bt.properties),zt=(0,code_1$3.allSchemaProperties)(Bt.patternProperties);Wt(),kt.ok((0,codegen_1$9._)`${jt} === ${names_1$3.default.errors}`);function Wt(){At.forIn("key",Nt,rr=>{!Vt.length&&!zt.length?Xt(rr):At.if(Jt(rr),()=>Xt(rr))})}function Jt(rr){let nr;if(Vt.length>8){const ar=(0,util_1$c.schemaRefOrVal)(Ut,Bt.properties,"properties");nr=(0,code_1$3.isOwnProperty)(At,ar,rr)}else Vt.length?nr=(0,codegen_1$9.or)(...Vt.map(ar=>(0,codegen_1$9._)`${rr} === ${ar}`)):nr=codegen_1$9.nil;return zt.length&&(nr=(0,codegen_1$9.or)(nr,...zt.map(ar=>(0,codegen_1$9._)`${(0,code_1$3.usePattern)(kt,ar)}.test(${rr})`))),(0,codegen_1$9.not)(nr)}function Qt(rr){At.code((0,codegen_1$9._)`delete ${Nt}[${rr}]`)}function Xt(rr){if(Ht.removeAdditional==="all"||Ht.removeAdditional&&xt===!1){Qt(rr);return}if(xt===!1){kt.setParams({additionalProperty:rr}),kt.error(),Lt||At.break();return}if(typeof xt=="object"&&!(0,util_1$c.alwaysValidSchema)(Ut,xt)){const nr=At.name("valid");Ht.removeAdditional==="failing"?(tr(rr,nr,!1),At.if((0,codegen_1$9.not)(nr),()=>{kt.reset(),Qt(rr)})):(tr(rr,nr),Lt||At.if((0,codegen_1$9.not)(nr),()=>At.break()))}}function tr(rr,nr,ar){const ir={keyword:"additionalProperties",dataProp:rr,dataPropType:util_1$c.Type.Str};ar===!1&&Object.assign(ir,{compositeRule:!0,createErrors:!1,allErrors:!1}),kt.subschema(ir,nr)}}};additionalProperties.default=def$j;var properties$8={};Object.defineProperty(properties$8,"__esModule",{value:!0});const validate_1=validate,code_1$2=code$1,util_1$b=util$1,additionalProperties_1$1=additionalProperties,def$i={keyword:"properties",type:"object",schemaType:"object",code(kt){const{gen:At,schema:xt,parentSchema:Bt,data:Nt,it:jt}=kt;jt.opts.removeAdditional==="all"&&Bt.additionalProperties===void 0&&additionalProperties_1$1.default.code(new validate_1.KeywordCxt(jt,additionalProperties_1$1.default,"additionalProperties"));const Ut=(0,code_1$2.allSchemaProperties)(xt);for(const Wt of Ut)jt.definedProperties.add(Wt);jt.opts.unevaluated&&Ut.length&&jt.props!==!0&&(jt.props=util_1$b.mergeEvaluated.props(At,(0,util_1$b.toHash)(Ut),jt.props));const Lt=Ut.filter(Wt=>!(0,util_1$b.alwaysValidSchema)(jt,xt[Wt]));if(Lt.length===0)return;const Ht=At.name("valid");for(const Wt of Lt)Vt(Wt)?zt(Wt):(At.if((0,code_1$2.propertyInData)(At,Nt,Wt,jt.opts.ownProperties)),zt(Wt),jt.allErrors||At.else().var(Ht,!0),At.endIf()),kt.it.definedProperties.add(Wt),kt.ok(Ht);function Vt(Wt){return jt.opts.useDefaults&&!jt.compositeRule&&xt[Wt].default!==void 0}function zt(Wt){kt.subschema({keyword:"properties",schemaProp:Wt,dataProp:Wt},Ht)}}};properties$8.default=def$i;var patternProperties={};Object.defineProperty(patternProperties,"__esModule",{value:!0});const code_1$1=code$1,codegen_1$8=codegen,util_1$a=util$1,util_2=util$1,def$h={keyword:"patternProperties",type:"object",schemaType:"object",code(kt){const{gen:At,schema:xt,data:Bt,parentSchema:Nt,it:jt}=kt,{opts:Ut}=jt,Lt=(0,code_1$1.allSchemaProperties)(xt),Ht=Lt.filter(tr=>(0,util_1$a.alwaysValidSchema)(jt,xt[tr]));if(Lt.length===0||Ht.length===Lt.length&&(!jt.opts.unevaluated||jt.props===!0))return;const Vt=Ut.strictSchema&&!Ut.allowMatchingProperties&&Nt.properties,zt=At.name("valid");jt.props!==!0&&!(jt.props instanceof codegen_1$8.Name)&&(jt.props=(0,util_2.evaluatedPropsToName)(At,jt.props));const{props:Wt}=jt;Jt();function Jt(){for(const tr of Lt)Vt&&Qt(tr),jt.allErrors?Xt(tr):(At.var(zt,!0),Xt(tr),At.if(zt))}function Qt(tr){for(const rr in Vt)new RegExp(tr).test(rr)&&(0,util_1$a.checkStrictMode)(jt,`property ${rr} matches pattern ${tr} (use allowMatchingProperties)`)}function Xt(tr){At.forIn("key",Bt,rr=>{At.if((0,codegen_1$8._)`${(0,code_1$1.usePattern)(kt,tr)}.test(${rr})`,()=>{const nr=Ht.includes(tr);nr||kt.subschema({keyword:"patternProperties",schemaProp:tr,dataProp:rr,dataPropType:util_2.Type.Str},zt),jt.opts.unevaluated&&Wt!==!0?At.assign((0,codegen_1$8._)`${Wt}[${rr}]`,!0):!nr&&!jt.allErrors&&At.if((0,codegen_1$8.not)(zt),()=>At.break())})})}}};patternProperties.default=def$h;var not={};Object.defineProperty(not,"__esModule",{value:!0});const util_1$9=util$1,def$g={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(kt){const{gen:At,schema:xt,it:Bt}=kt;if((0,util_1$9.alwaysValidSchema)(Bt,xt)){kt.fail();return}const Nt=At.name("valid");kt.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},Nt),kt.failResult(Nt,()=>kt.reset(),()=>kt.error())},error:{message:"must NOT be valid"}};not.default=def$g;var anyOf={};Object.defineProperty(anyOf,"__esModule",{value:!0});const code_1=code$1,def$f={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:code_1.validateUnion,error:{message:"must match a schema in anyOf"}};anyOf.default=def$f;var oneOf={};Object.defineProperty(oneOf,"__esModule",{value:!0});const codegen_1$7=codegen,util_1$8=util$1,error$5={message:"must match exactly one schema in oneOf",params:({params:kt})=>(0,codegen_1$7._)`{passingSchemas: ${kt.passing}}`},def$e={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:error$5,code(kt){const{gen:At,schema:xt,parentSchema:Bt,it:Nt}=kt;if(!Array.isArray(xt))throw new Error("ajv implementation error");if(Nt.opts.discriminator&&Bt.discriminator)return;const jt=xt,Ut=At.let("valid",!1),Lt=At.let("passing",null),Ht=At.name("_valid");kt.setParams({passing:Lt}),At.block(Vt),kt.result(Ut,()=>kt.reset(),()=>kt.error(!0));function Vt(){jt.forEach((zt,Wt)=>{let Jt;(0,util_1$8.alwaysValidSchema)(Nt,zt)?At.var(Ht,!0):Jt=kt.subschema({keyword:"oneOf",schemaProp:Wt,compositeRule:!0},Ht),Wt>0&&At.if((0,codegen_1$7._)`${Ht} && ${Ut}`).assign(Ut,!1).assign(Lt,(0,codegen_1$7._)`[${Lt}, ${Wt}]`).else(),At.if(Ht,()=>{At.assign(Ut,!0),At.assign(Lt,Wt),Jt&&kt.mergeEvaluated(Jt,codegen_1$7.Name)})})}}};oneOf.default=def$e;var allOf$1={};Object.defineProperty(allOf$1,"__esModule",{value:!0});const util_1$7=util$1,def$d={keyword:"allOf",schemaType:"array",code(kt){const{gen:At,schema:xt,it:Bt}=kt;if(!Array.isArray(xt))throw new Error("ajv implementation error");const Nt=At.name("valid");xt.forEach((jt,Ut)=>{if((0,util_1$7.alwaysValidSchema)(Bt,jt))return;const Lt=kt.subschema({keyword:"allOf",schemaProp:Ut},Nt);kt.ok(Nt),kt.mergeEvaluated(Lt)})}};allOf$1.default=def$d;var _if={};Object.defineProperty(_if,"__esModule",{value:!0});const codegen_1$6=codegen,util_1$6=util$1,error$4={message:({params:kt})=>(0,codegen_1$6.str)`must match "${kt.ifClause}" schema`,params:({params:kt})=>(0,codegen_1$6._)`{failingKeyword: ${kt.ifClause}}`},def$c={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:error$4,code(kt){const{gen:At,parentSchema:xt,it:Bt}=kt;xt.then===void 0&&xt.else===void 0&&(0,util_1$6.checkStrictMode)(Bt,'"if" without "then" and "else" is ignored');const Nt=hasSchema(Bt,"then"),jt=hasSchema(Bt,"else");if(!Nt&&!jt)return;const Ut=At.let("valid",!0),Lt=At.name("_valid");if(Ht(),kt.reset(),Nt&&jt){const zt=At.let("ifClause");kt.setParams({ifClause:zt}),At.if(Lt,Vt("then",zt),Vt("else",zt))}else Nt?At.if(Lt,Vt("then")):At.if((0,codegen_1$6.not)(Lt),Vt("else"));kt.pass(Ut,()=>kt.error(!0));function Ht(){const zt=kt.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},Lt);kt.mergeEvaluated(zt)}function Vt(zt,Wt){return()=>{const Jt=kt.subschema({keyword:zt},Lt);At.assign(Ut,Lt),kt.mergeValidEvaluated(Jt,Ut),Wt?At.assign(Wt,(0,codegen_1$6._)`${zt}`):kt.setParams({ifClause:zt})}}}};function hasSchema(kt,At){const xt=kt.schema[At];return xt!==void 0&&!(0,util_1$6.alwaysValidSchema)(kt,xt)}_if.default=def$c;var thenElse={};Object.defineProperty(thenElse,"__esModule",{value:!0});const util_1$5=util$1,def$b={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:kt,parentSchema:At,it:xt}){At.if===void 0&&(0,util_1$5.checkStrictMode)(xt,`"${kt}" without "if" is ignored`)}};thenElse.default=def$b;Object.defineProperty(applicator$1,"__esModule",{value:!0});const additionalItems_1=additionalItems,prefixItems_1=prefixItems,items_1=items,items2020_1=items2020,contains_1=contains,dependencies_1$2=dependencies,propertyNames_1=propertyNames,additionalProperties_1=additionalProperties,properties_1=properties$8,patternProperties_1=patternProperties,not_1=not,anyOf_1=anyOf,oneOf_1=oneOf,allOf_1=allOf$1,if_1=_if,thenElse_1=thenElse;function getApplicator(kt=!1){const At=[not_1.default,anyOf_1.default,oneOf_1.default,allOf_1.default,if_1.default,thenElse_1.default,propertyNames_1.default,additionalProperties_1.default,dependencies_1$2.default,properties_1.default,patternProperties_1.default];return kt?At.push(prefixItems_1.default,items2020_1.default):At.push(additionalItems_1.default,items_1.default),At.push(contains_1.default),At}applicator$1.default=getApplicator;var dynamic$1={},dynamicAnchor$1={};Object.defineProperty(dynamicAnchor$1,"__esModule",{value:!0});dynamicAnchor$1.dynamicAnchor=void 0;const codegen_1$5=codegen,names_1$2=names$1,compile_1$1=compile,ref_1$1=ref,def$a={keyword:"$dynamicAnchor",schemaType:"string",code:kt=>dynamicAnchor(kt,kt.schema)};function dynamicAnchor(kt,At){const{gen:xt,it:Bt}=kt;Bt.schemaEnv.root.dynamicAnchors[At]=!0;const Nt=(0,codegen_1$5._)`${names_1$2.default.dynamicAnchors}${(0,codegen_1$5.getProperty)(At)}`,jt=Bt.errSchemaPath==="#"?Bt.validateName:_getValidate(kt);xt.if((0,codegen_1$5._)`!${Nt}`,()=>xt.assign(Nt,jt))}dynamicAnchor$1.dynamicAnchor=dynamicAnchor;function _getValidate(kt){const{schemaEnv:At,schema:xt,self:Bt}=kt.it,{root:Nt,baseId:jt,localRefs:Ut,meta:Lt}=At.root,{schemaId:Ht}=Bt.opts,Vt=new compile_1$1.SchemaEnv({schema:xt,schemaId:Ht,root:Nt,baseId:jt,localRefs:Ut,meta:Lt});return compile_1$1.compileSchema.call(Bt,Vt),(0,ref_1$1.getValidate)(kt,Vt)}dynamicAnchor$1.default=def$a;var dynamicRef$1={};Object.defineProperty(dynamicRef$1,"__esModule",{value:!0});dynamicRef$1.dynamicRef=void 0;const codegen_1$4=codegen,names_1$1=names$1,ref_1=ref,def$9={keyword:"$dynamicRef",schemaType:"string",code:kt=>dynamicRef(kt,kt.schema)};function dynamicRef(kt,At){const{gen:xt,keyword:Bt,it:Nt}=kt;if(At[0]!=="#")throw new Error(`"${Bt}" only supports hash fragment reference`);const jt=At.slice(1);if(Nt.allErrors)Ut();else{const Ht=xt.let("valid",!1);Ut(Ht),kt.ok(Ht)}function Ut(Ht){if(Nt.schemaEnv.root.dynamicAnchors[jt]){const Vt=xt.let("_v",(0,codegen_1$4._)`${names_1$1.default.dynamicAnchors}${(0,codegen_1$4.getProperty)(jt)}`);xt.if(Vt,Lt(Vt,Ht),Lt(Nt.validateName,Ht))}else Lt(Nt.validateName,Ht)()}function Lt(Ht,Vt){return Vt?()=>xt.block(()=>{(0,ref_1.callRef)(kt,Ht),xt.let(Vt,!0)}):()=>(0,ref_1.callRef)(kt,Ht)}}dynamicRef$1.dynamicRef=dynamicRef;dynamicRef$1.default=def$9;var recursiveAnchor={};Object.defineProperty(recursiveAnchor,"__esModule",{value:!0});const dynamicAnchor_1$1=dynamicAnchor$1,util_1$4=util$1,def$8={keyword:"$recursiveAnchor",schemaType:"boolean",code(kt){kt.schema?(0,dynamicAnchor_1$1.dynamicAnchor)(kt,""):(0,util_1$4.checkStrictMode)(kt.it,"$recursiveAnchor: false is ignored")}};recursiveAnchor.default=def$8;var recursiveRef={};Object.defineProperty(recursiveRef,"__esModule",{value:!0});const dynamicRef_1$1=dynamicRef$1,def$7={keyword:"$recursiveRef",schemaType:"string",code:kt=>(0,dynamicRef_1$1.dynamicRef)(kt,kt.schema)};recursiveRef.default=def$7;Object.defineProperty(dynamic$1,"__esModule",{value:!0});const dynamicAnchor_1=dynamicAnchor$1,dynamicRef_1=dynamicRef$1,recursiveAnchor_1=recursiveAnchor,recursiveRef_1=recursiveRef,dynamic=[dynamicAnchor_1.default,dynamicRef_1.default,recursiveAnchor_1.default,recursiveRef_1.default];dynamic$1.default=dynamic;var next$1={},dependentRequired={};Object.defineProperty(dependentRequired,"__esModule",{value:!0});const dependencies_1$1=dependencies,def$6={keyword:"dependentRequired",type:"object",schemaType:"object",error:dependencies_1$1.error,code:kt=>(0,dependencies_1$1.validatePropertyDeps)(kt)};dependentRequired.default=def$6;var dependentSchemas={};Object.defineProperty(dependentSchemas,"__esModule",{value:!0});const dependencies_1=dependencies,def$5={keyword:"dependentSchemas",type:"object",schemaType:"object",code:kt=>(0,dependencies_1.validateSchemaDeps)(kt)};dependentSchemas.default=def$5;var limitContains={};Object.defineProperty(limitContains,"__esModule",{value:!0});const util_1$3=util$1,def$4={keyword:["maxContains","minContains"],type:"array",schemaType:"number",code({keyword:kt,parentSchema:At,it:xt}){At.contains===void 0&&(0,util_1$3.checkStrictMode)(xt,`"${kt}" without "contains" is ignored`)}};limitContains.default=def$4;Object.defineProperty(next$1,"__esModule",{value:!0});const dependentRequired_1=dependentRequired,dependentSchemas_1=dependentSchemas,limitContains_1=limitContains,next=[dependentRequired_1.default,dependentSchemas_1.default,limitContains_1.default];next$1.default=next;var unevaluated$2={},unevaluatedProperties={};Object.defineProperty(unevaluatedProperties,"__esModule",{value:!0});const codegen_1$3=codegen,util_1$2=util$1,names_1=names$1,error$3={message:"must NOT have unevaluated properties",params:({params:kt})=>(0,codegen_1$3._)`{unevaluatedProperty: ${kt.unevaluatedProperty}}`},def$3={keyword:"unevaluatedProperties",type:"object",schemaType:["boolean","object"],trackErrors:!0,error:error$3,code(kt){const{gen:At,schema:xt,data:Bt,errsCount:Nt,it:jt}=kt;if(!Nt)throw new Error("ajv implementation error");const{allErrors:Ut,props:Lt}=jt;Lt instanceof codegen_1$3.Name?At.if((0,codegen_1$3._)`${Lt} !== true`,()=>At.forIn("key",Bt,Wt=>At.if(Vt(Lt,Wt),()=>Ht(Wt)))):Lt!==!0&&At.forIn("key",Bt,Wt=>Lt===void 0?Ht(Wt):At.if(zt(Lt,Wt),()=>Ht(Wt))),jt.props=!0,kt.ok((0,codegen_1$3._)`${Nt} === ${names_1.default.errors}`);function Ht(Wt){if(xt===!1){kt.setParams({unevaluatedProperty:Wt}),kt.error(),Ut||At.break();return}if(!(0,util_1$2.alwaysValidSchema)(jt,xt)){const Jt=At.name("valid");kt.subschema({keyword:"unevaluatedProperties",dataProp:Wt,dataPropType:util_1$2.Type.Str},Jt),Ut||At.if((0,codegen_1$3.not)(Jt),()=>At.break())}}function Vt(Wt,Jt){return(0,codegen_1$3._)`!${Wt} || !${Wt}[${Jt}]`}function zt(Wt,Jt){const Qt=[];for(const Xt in Wt)Wt[Xt]===!0&&Qt.push((0,codegen_1$3._)`${Jt} !== ${Xt}`);return(0,codegen_1$3.and)(...Qt)}}};unevaluatedProperties.default=def$3;var unevaluatedItems={};Object.defineProperty(unevaluatedItems,"__esModule",{value:!0});const codegen_1$2=codegen,util_1$1=util$1,error$2={message:({params:{len:kt}})=>(0,codegen_1$2.str)`must NOT have more than ${kt} items`,params:({params:{len:kt}})=>(0,codegen_1$2._)`{limit: ${kt}}`},def$2={keyword:"unevaluatedItems",type:"array",schemaType:["boolean","object"],error:error$2,code(kt){const{gen:At,schema:xt,data:Bt,it:Nt}=kt,jt=Nt.items||0;if(jt===!0)return;const Ut=At.const("len",(0,codegen_1$2._)`${Bt}.length`);if(xt===!1)kt.setParams({len:jt}),kt.fail((0,codegen_1$2._)`${Ut} > ${jt}`);else if(typeof xt=="object"&&!(0,util_1$1.alwaysValidSchema)(Nt,xt)){const Ht=At.var("valid",(0,codegen_1$2._)`${Ut} <= ${jt}`);At.if((0,codegen_1$2.not)(Ht),()=>Lt(Ht,jt)),kt.ok(Ht)}Nt.items=!0;function Lt(Ht,Vt){At.forRange("i",Vt,Ut,zt=>{kt.subschema({keyword:"unevaluatedItems",dataProp:zt,dataPropType:util_1$1.Type.Num},Ht),Nt.allErrors||At.if((0,codegen_1$2.not)(Ht),()=>At.break())})}}};unevaluatedItems.default=def$2;Object.defineProperty(unevaluated$2,"__esModule",{value:!0});const unevaluatedProperties_1=unevaluatedProperties,unevaluatedItems_1=unevaluatedItems,unevaluated$1=[unevaluatedProperties_1.default,unevaluatedItems_1.default];unevaluated$2.default=unevaluated$1;var format$5={},format$4={};Object.defineProperty(format$4,"__esModule",{value:!0});const codegen_1$1=codegen,error$1={message:({schemaCode:kt})=>(0,codegen_1$1.str)`must match format "${kt}"`,params:({schemaCode:kt})=>(0,codegen_1$1._)`{format: ${kt}}`},def$1={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:error$1,code(kt,At){const{gen:xt,data:Bt,$data:Nt,schema:jt,schemaCode:Ut,it:Lt}=kt,{opts:Ht,errSchemaPath:Vt,schemaEnv:zt,self:Wt}=Lt;if(!Ht.validateFormats)return;Nt?Jt():Qt();function Jt(){const Xt=xt.scopeValue("formats",{ref:Wt.formats,code:Ht.code.formats}),tr=xt.const("fDef",(0,codegen_1$1._)`${Xt}[${Ut}]`),rr=xt.let("fType"),nr=xt.let("format");xt.if((0,codegen_1$1._)`typeof ${tr} == "object" && !(${tr} instanceof RegExp)`,()=>xt.assign(rr,(0,codegen_1$1._)`${tr}.type || "string"`).assign(nr,(0,codegen_1$1._)`${tr}.validate`),()=>xt.assign(rr,(0,codegen_1$1._)`"string"`).assign(nr,tr)),kt.fail$data((0,codegen_1$1.or)(ar(),ir()));function ar(){return Ht.strictSchema===!1?codegen_1$1.nil:(0,codegen_1$1._)`${Ut} && !${nr}`}function ir(){const lr=zt.$async?(0,codegen_1$1._)`(${tr}.async ? await ${nr}(${Bt}) : ${nr}(${Bt}))`:(0,codegen_1$1._)`${nr}(${Bt})`,yr=(0,codegen_1$1._)`(typeof ${nr} == "function" ? ${lr} : ${nr}.test(${Bt}))`;return(0,codegen_1$1._)`${nr} && ${nr} !== true && ${rr} === ${At} && !${yr}`}}function Qt(){const Xt=Wt.formats[jt];if(!Xt){ar();return}if(Xt===!0)return;const[tr,rr,nr]=ir(Xt);tr===At&&kt.pass(lr());function ar(){if(Ht.strictSchema===!1){Wt.logger.warn(yr());return}throw new Error(yr());function yr(){return`unknown format "${jt}" ignored in schema at path "${Vt}"`}}function ir(yr){const Sr=yr instanceof RegExp?(0,codegen_1$1.regexpCode)(yr):Ht.code.formats?(0,codegen_1$1._)`${Ht.code.formats}${(0,codegen_1$1.getProperty)(jt)}`:void 0,Ar=xt.scopeValue("formats",{key:jt,ref:yr,code:Sr});return typeof yr=="object"&&!(yr instanceof RegExp)?[yr.type||"string",yr.validate,(0,codegen_1$1._)`${Ar}.validate`]:["string",yr,Ar]}function lr(){if(typeof Xt=="object"&&!(Xt instanceof RegExp)&&Xt.async){if(!zt.$async)throw new Error("async format in sync schema");return(0,codegen_1$1._)`await ${nr}(${Bt})`}return typeof rr=="function"?(0,codegen_1$1._)`${nr}(${Bt})`:(0,codegen_1$1._)`${nr}.test(${Bt})`}}}};format$4.default=def$1;Object.defineProperty(format$5,"__esModule",{value:!0});const format_1$1=format$4,format$3=[format_1$1.default];format$5.default=format$3;var metadata$1={};Object.defineProperty(metadata$1,"__esModule",{value:!0});metadata$1.contentVocabulary=metadata$1.metadataVocabulary=void 0;metadata$1.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];metadata$1.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(draft2020,"__esModule",{value:!0});const core_1=core$2,validation_1=validation$2,applicator_1=applicator$1,dynamic_1=dynamic$1,next_1=next$1,unevaluated_1=unevaluated$2,format_1=format$5,metadata_1=metadata$1,draft2020Vocabularies=[dynamic_1.default,core_1.default,validation_1.default,(0,applicator_1.default)(!0),format_1.default,metadata_1.metadataVocabulary,metadata_1.contentVocabulary,next_1.default,unevaluated_1.default];draft2020.default=draft2020Vocabularies;var discriminator={},types={};(function(kt){Object.defineProperty(kt,"__esModule",{value:!0}),kt.DiscrError=void 0,function(At){At.Tag="tag",At.Mapping="mapping"}(kt.DiscrError||(kt.DiscrError={}))})(types);Object.defineProperty(discriminator,"__esModule",{value:!0});const codegen_1=codegen,types_1=types,compile_1=compile,util_1=util$1,error={message:({params:{discrError:kt,tagName:At}})=>kt===types_1.DiscrError.Tag?`tag "${At}" must be string`:`value of tag "${At}" must be in oneOf`,params:({params:{discrError:kt,tag:At,tagName:xt}})=>(0,codegen_1._)`{error: ${kt}, tag: ${xt}, tagValue: ${At}}`},def={keyword:"discriminator",type:"object",schemaType:"object",error,code(kt){const{gen:At,data:xt,schema:Bt,parentSchema:Nt,it:jt}=kt,{oneOf:Ut}=Nt;if(!jt.opts.discriminator)throw new Error("discriminator: requires discriminator option");const Lt=Bt.propertyName;if(typeof Lt!="string")throw new Error("discriminator: requires propertyName");if(Bt.mapping)throw new Error("discriminator: mapping is not supported");if(!Ut)throw new Error("discriminator: requires oneOf keyword");const Ht=At.let("valid",!1),Vt=At.const("tag",(0,codegen_1._)`${xt}${(0,codegen_1.getProperty)(Lt)}`);At.if((0,codegen_1._)`typeof ${Vt} == "string"`,()=>zt(),()=>kt.error(!1,{discrError:types_1.DiscrError.Tag,tag:Vt,tagName:Lt})),kt.ok(Ht);function zt(){const Qt=Jt();At.if(!1);for(const Xt in Qt)At.elseIf((0,codegen_1._)`${Vt} === ${Xt}`),At.assign(Ht,Wt(Qt[Xt]));At.else(),kt.error(!1,{discrError:types_1.DiscrError.Mapping,tag:Vt,tagName:Lt}),At.endIf()}function Wt(Qt){const Xt=At.name("valid"),tr=kt.subschema({keyword:"oneOf",schemaProp:Qt},Xt);return kt.mergeEvaluated(tr,codegen_1.Name),Xt}function Jt(){var Qt;const Xt={},tr=nr(Nt);let rr=!0;for(let lr=0;lr<Ut.length;lr++){let yr=Ut[lr];yr!=null&&yr.$ref&&!(0,util_1.schemaHasRulesButRef)(yr,jt.self.RULES)&&(yr=compile_1.resolveRef.call(jt.self,jt.schemaEnv.root,jt.baseId,yr==null?void 0:yr.$ref),yr instanceof compile_1.SchemaEnv&&(yr=yr.schema));const Sr=(Qt=yr==null?void 0:yr.properties)===null||Qt===void 0?void 0:Qt[Lt];if(typeof Sr!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${Lt}"`);rr=rr&&(tr||nr(yr)),ar(Sr,lr)}if(!rr)throw new Error(`discriminator: "${Lt}" must be required`);return Xt;function nr({required:lr}){return Array.isArray(lr)&&lr.includes(Lt)}function ar(lr,yr){if(lr.const)ir(lr.const,yr);else if(lr.enum)for(const Sr of lr.enum)ir(Sr,yr);else throw new Error(`discriminator: "properties/${Lt}" must have "const" or "enum"`)}function ir(lr,yr){if(typeof lr!="string"||lr in Xt)throw new Error(`discriminator: "${Lt}" values must be unique strings`);Xt[lr]=yr}}}};discriminator.default=def;var jsonSchema202012={};const $schema$7="https://json-schema.org/draft/2020-12/schema",$id$7="https://json-schema.org/draft/2020-12/schema",$vocabulary$7={"https://json-schema.org/draft/2020-12/vocab/core":!0,"https://json-schema.org/draft/2020-12/vocab/applicator":!0,"https://json-schema.org/draft/2020-12/vocab/unevaluated":!0,"https://json-schema.org/draft/2020-12/vocab/validation":!0,"https://json-schema.org/draft/2020-12/vocab/meta-data":!0,"https://json-schema.org/draft/2020-12/vocab/format-annotation":!0,"https://json-schema.org/draft/2020-12/vocab/content":!0},$dynamicAnchor$7="meta",title$7="Core and Validation specifications meta-schema",allOf=[{$ref:"meta/core"},{$ref:"meta/applicator"},{$ref:"meta/unevaluated"},{$ref:"meta/validation"},{$ref:"meta/meta-data"},{$ref:"meta/format-annotation"},{$ref:"meta/content"}],type$7=["object","boolean"],$comment="This meta-schema also defines keywords that have appeared in previous drafts in order to prevent incompatible extensions as they remain in common use.",properties$7={definitions:{$comment:'"definitions" has been replaced by "$defs".',type:"object",additionalProperties:{$dynamicRef:"#meta"},deprecated:!0,default:{}},dependencies:{$comment:'"dependencies" has been split and replaced by "dependentSchemas" and "dependentRequired" in order to serve their differing semantics.',type:"object",additionalProperties:{anyOf:[{$dynamicRef:"#meta"},{$ref:"meta/validation#/$defs/stringArray"}]},deprecated:!0,default:{}},$recursiveAnchor:{$comment:'"$recursiveAnchor" has been replaced by "$dynamicAnchor".',$ref:"meta/core#/$defs/anchorString",deprecated:!0},$recursiveRef:{$comment:'"$recursiveRef" has been replaced by "$dynamicRef".',$ref:"meta/core#/$defs/uriReferenceString",deprecated:!0}},require$$0={$schema:$schema$7,$id:$id$7,$vocabulary:$vocabulary$7,$dynamicAnchor:$dynamicAnchor$7,title:title$7,allOf,type:type$7,$comment,properties:properties$7},$schema$6="https://json-schema.org/draft/2020-12/schema",$id$6="https://json-schema.org/draft/2020-12/meta/applicator",$vocabulary$6={"https://json-schema.org/draft/2020-12/vocab/applicator":!0},$dynamicAnchor$6="meta",title$6="Applicator vocabulary meta-schema",type$6=["object","boolean"],properties$6={prefixItems:{$ref:"#/$defs/schemaArray"},items:{$dynamicRef:"#meta"},contains:{$dynamicRef:"#meta"},additionalProperties:{$dynamicRef:"#meta"},properties:{type:"object",additionalProperties:{$dynamicRef:"#meta"},default:{}},patternProperties:{type:"object",additionalProperties:{$dynamicRef:"#meta"},propertyNames:{format:"regex"},default:{}},dependentSchemas:{type:"object",additionalProperties:{$dynamicRef:"#meta"},default:{}},propertyNames:{$dynamicRef:"#meta"},if:{$dynamicRef:"#meta"},then:{$dynamicRef:"#meta"},else:{$dynamicRef:"#meta"},allOf:{$ref:"#/$defs/schemaArray"},anyOf:{$ref:"#/$defs/schemaArray"},oneOf:{$ref:"#/$defs/schemaArray"},not:{$dynamicRef:"#meta"}},$defs$2={schemaArray:{type:"array",minItems:1,items:{$dynamicRef:"#meta"}}},require$$1={$schema:$schema$6,$id:$id$6,$vocabulary:$vocabulary$6,$dynamicAnchor:$dynamicAnchor$6,title:title$6,type:type$6,properties:properties$6,$defs:$defs$2},$schema$5="https://json-schema.org/draft/2020-12/schema",$id$5="https://json-schema.org/draft/2020-12/meta/unevaluated",$vocabulary$5={"https://json-schema.org/draft/2020-12/vocab/unevaluated":!0},$dynamicAnchor$5="meta",title$5="Unevaluated applicator vocabulary meta-schema",type$5=["object","boolean"],properties$5={unevaluatedItems:{$dynamicRef:"#meta"},unevaluatedProperties:{$dynamicRef:"#meta"}},require$$2={$schema:$schema$5,$id:$id$5,$vocabulary:$vocabulary$5,$dynamicAnchor:$dynamicAnchor$5,title:title$5,type:type$5,properties:properties$5},$schema$4="https://json-schema.org/draft/2020-12/schema",$id$4="https://json-schema.org/draft/2020-12/meta/content",$vocabulary$4={"https://json-schema.org/draft/2020-12/vocab/content":!0},$dynamicAnchor$4="meta",title$4="Content vocabulary meta-schema",type$4=["object","boolean"],properties$4={contentEncoding:{type:"string"},contentMediaType:{type:"string"},contentSchema:{$dynamicRef:"#meta"}},require$$3={$schema:$schema$4,$id:$id$4,$vocabulary:$vocabulary$4,$dynamicAnchor:$dynamicAnchor$4,title:title$4,type:type$4,properties:properties$4},$schema$3="https://json-schema.org/draft/2020-12/schema",$id$3="https://json-schema.org/draft/2020-12/meta/core",$vocabulary$3={"https://json-schema.org/draft/2020-12/vocab/core":!0},$dynamicAnchor$3="meta",title$3="Core vocabulary meta-schema",type$3=["object","boolean"],properties$3={$id:{$ref:"#/$defs/uriReferenceString",$comment:"Non-empty fragments not allowed.",pattern:"^[^#]*#?$"},$schema:{$ref:"#/$defs/uriString"},$ref:{$ref:"#/$defs/uriReferenceString"},$anchor:{$ref:"#/$defs/anchorString"},$dynamicRef:{$ref:"#/$defs/uriReferenceString"},$dynamicAnchor:{$ref:"#/$defs/anchorString"},$vocabulary:{type:"object",propertyNames:{$ref:"#/$defs/uriString"},additionalProperties:{type:"boolean"}},$comment:{type:"string"},$defs:{type:"object",additionalProperties:{$dynamicRef:"#meta"}}},$defs$1={anchorString:{type:"string",pattern:"^[A-Za-z_][-A-Za-z0-9._]*$"},uriString:{type:"string",format:"uri"},uriReferenceString:{type:"string",format:"uri-reference"}},require$$4={$schema:$schema$3,$id:$id$3,$vocabulary:$vocabulary$3,$dynamicAnchor:$dynamicAnchor$3,title:title$3,type:type$3,properties:properties$3,$defs:$defs$1},$schema$2="https://json-schema.org/draft/2020-12/schema",$id$2="https://json-schema.org/draft/2020-12/meta/format-annotation",$vocabulary$2={"https://json-schema.org/draft/2020-12/vocab/format-annotation":!0},$dynamicAnchor$2="meta",title$2="Format vocabulary meta-schema for annotation results",type$2=["object","boolean"],properties$2={format:{type:"string"}},require$$5={$schema:$schema$2,$id:$id$2,$vocabulary:$vocabulary$2,$dynamicAnchor:$dynamicAnchor$2,title:title$2,type:type$2,properties:properties$2},$schema$1="https://json-schema.org/draft/2020-12/schema",$id$1="https://json-schema.org/draft/2020-12/meta/meta-data",$vocabulary$1={"https://json-schema.org/draft/2020-12/vocab/meta-data":!0},$dynamicAnchor$1="meta",title$1="Meta-data vocabulary meta-schema",type$1=["object","boolean"],properties$1={title:{type:"string"},description:{type:"string"},default:!0,deprecated:{type:"boolean",default:!1},readOnly:{type:"boolean",default:!1},writeOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0}},require$$6={$schema:$schema$1,$id:$id$1,$vocabulary:$vocabulary$1,$dynamicAnchor:$dynamicAnchor$1,title:title$1,type:type$1,properties:properties$1},$schema="https://json-schema.org/draft/2020-12/schema",$id="https://json-schema.org/draft/2020-12/meta/validation",$vocabulary={"https://json-schema.org/draft/2020-12/vocab/validation":!0},$dynamicAnchor="meta",title="Validation vocabulary meta-schema",type=["object","boolean"],properties={type:{anyOf:[{$ref:"#/$defs/simpleTypes"},{type:"array",items:{$ref:"#/$defs/simpleTypes"},minItems:1,uniqueItems:!0}]},const:!0,enum:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/$defs/nonNegativeInteger"},minLength:{$ref:"#/$defs/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},maxItems:{$ref:"#/$defs/nonNegativeInteger"},minItems:{$ref:"#/$defs/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxContains:{$ref:"#/$defs/nonNegativeInteger"},minContains:{$ref:"#/$defs/nonNegativeInteger",default:1},maxProperties:{$ref:"#/$defs/nonNegativeInteger"},minProperties:{$ref:"#/$defs/nonNegativeIntegerDefault0"},required:{$ref:"#/$defs/stringArray"},dependentRequired:{type:"object",additionalProperties:{$ref:"#/$defs/stringArray"}}},$defs={nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{$ref:"#/$defs/nonNegativeInteger",default:0},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},require$$7={$schema,$id,$vocabulary,$dynamicAnchor,title,type,properties,$defs};Object.defineProperty(jsonSchema202012,"__esModule",{value:!0});const metaSchema=require$$0,applicator=require$$1,unevaluated=require$$2,content=require$$3,core=require$$4,format$2=require$$5,metadata=require$$6,validation=require$$7,META_SUPPORT_DATA=["/properties"];function addMetaSchema2020(kt){return[metaSchema,applicator,unevaluated,content,core,At(this,format$2),metadata,At(this,validation)].forEach(xt=>this.addMetaSchema(xt,void 0,!1)),this;function At(xt,Bt){return kt?xt.$dataMetaSchema(Bt,META_SUPPORT_DATA):Bt}}jsonSchema202012.default=addMetaSchema2020;(function(kt,At){Object.defineProperty(At,"__esModule",{value:!0}),At.MissingRefError=At.ValidationError=At.CodeGen=At.Name=At.nil=At.stringify=At.str=At._=At.KeywordCxt=void 0;const xt=core$3,Bt=draft2020,Nt=discriminator,jt=jsonSchema202012,Ut="https://json-schema.org/draft/2020-12/schema";class Lt extends xt.default{constructor(Qt={}){super({...Qt,dynamicRef:!0,next:!0,unevaluated:!0})}_addVocabularies(){super._addVocabularies(),Bt.default.forEach(Qt=>this.addVocabulary(Qt)),this.opts.discriminator&&this.addKeyword(Nt.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema();const{$data:Qt,meta:Xt}=this.opts;Xt&&(jt.default.call(this,Qt),this.refs["http://json-schema.org/schema"]=Ut)}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Ut)?Ut:void 0)}}kt.exports=At=Lt,Object.defineProperty(At,"__esModule",{value:!0}),At.default=Lt;var Ht=validate;Object.defineProperty(At,"KeywordCxt",{enumerable:!0,get:function(){return Ht.KeywordCxt}});var Vt=codegen;Object.defineProperty(At,"_",{enumerable:!0,get:function(){return Vt._}}),Object.defineProperty(At,"str",{enumerable:!0,get:function(){return Vt.str}}),Object.defineProperty(At,"stringify",{enumerable:!0,get:function(){return Vt.stringify}}),Object.defineProperty(At,"nil",{enumerable:!0,get:function(){return Vt.nil}}),Object.defineProperty(At,"Name",{enumerable:!0,get:function(){return Vt.Name}}),Object.defineProperty(At,"CodeGen",{enumerable:!0,get:function(){return Vt.CodeGen}});var zt=validation_error;Object.defineProperty(At,"ValidationError",{enumerable:!0,get:function(){return zt.default}});var Wt=ref_error;Object.defineProperty(At,"MissingRefError",{enumerable:!0,get:function(){return Wt.default}})})(_2020,_2020.exports);var _2020Exports=_2020.exports;const Ajv=getDefaultExportFromCjs(_2020Exports);var __awaiter$2d=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class ProtocolsGrantAuthorization{static authorizeConfigure(At){return __awaiter$2d(this,void 0,void 0,function*(){const{protocolsConfigureMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:xt,expectedGrantor:Bt,expectedGrantee:Nt,permissionGrant:jt,messageStore:Ut}),ProtocolsGrantAuthorization.verifyScope(xt,jt.scope)})}static authorizeQuery(At){var xt;return __awaiter$2d(this,void 0,void 0,function*(){const{expectedGrantee:Bt,expectedGrantor:Nt,incomingMessage:jt,permissionGrant:Ut,messageStore:Lt}=At;yield GrantAuthorization.performBaseValidation({incomingMessage:jt,expectedGrantor:Nt,expectedGrantee:Bt,permissionGrant:Ut,messageStore:Lt});const Vt=Ut.scope.protocol,zt=(xt=jt.descriptor.filter)===null||xt===void 0?void 0:xt.protocol;if(Vt!==void 0&&zt!==Vt)throw new DwnError(DwnErrorCode.ProtocolsGrantAuthorizationQueryProtocolScopeMismatch,`Grant protocol scope ${Vt} does not match protocol in message ${zt}`)})}static verifyScope(At,xt){if(xt.protocol!==void 0&&xt.protocol!==At.descriptor.definition.protocol)throw new DwnError(DwnErrorCode.ProtocolsGrantAuthorizationScopeProtocolMismatch,"Grant scope specifies different protocol than what appears in the configure message.")}}var ProtocolActor;(function(kt){kt.Anyone="anyone",kt.Author="author",kt.Recipient="recipient"})(ProtocolActor||(ProtocolActor={}));var ProtocolAction;(function(kt){kt.CoDelete="co-delete",kt.CoPrune="co-prune",kt.CoUpdate="co-update",kt.Create="create",kt.Delete="delete",kt.Prune="prune",kt.Query="query",kt.Read="read",kt.Subscribe="subscribe",kt.Update="update"})(ProtocolAction||(ProtocolAction={}));var __awaiter$2c=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$w=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class ProtocolsConfigure extends AbstractMessage{static parse(At){return __awaiter$2c(this,void 0,void 0,function*(){return Message.validateJsonSchema(At),ProtocolsConfigure.validateProtocolDefinition(At.descriptor.definition),yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor),Time.validateTimestamp(At.descriptor.messageTimestamp),new ProtocolsConfigure(At)})}static create(At){var xt;return __awaiter$2c(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Protocols,method:DwnMethodName.Configure,messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Time.getCurrentTimestamp(),definition:ProtocolsConfigure.normalizeDefinition(At.definition)},Nt=yield Message.createAuthorization({descriptor:Bt,signer:At.signer,delegatedGrant:At.delegatedGrant,permissionGrantId:At.permissionGrantId}),jt={descriptor:Bt,authorization:Nt};return Message.validateJsonSchema(jt),ProtocolsConfigure.validateProtocolDefinition(jt.descriptor.definition),new ProtocolsConfigure(jt)})}authorizeAuthorDelegate(At){return __awaiter$2c(this,void 0,void 0,function*(){const xt=yield PermissionGrant$1.parse(this.message.authorization.authorDelegatedGrant);yield ProtocolsGrantAuthorization.authorizeConfigure({protocolsConfigureMessage:this.message,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:xt,messageStore:At})})}static validateProtocolDefinition(At){const{protocol:xt,types:Bt}=At;validateProtocolUrlNormalized(xt);for(const Nt in Bt){const jt=Bt[Nt].schema;jt!==void 0&&validateSchemaUrlNormalized(jt)}ProtocolsConfigure.validateStructure(At)}static validateStructure(At){const xt=Object.keys(At.types),Bt=ProtocolsConfigure.fetchAllRolePathsRecursively("",At.structure,[]);ProtocolsConfigure.validateRuleSetRecursively({ruleSet:At.structure,ruleSetProtocolPath:"",recordTypes:xt,roles:Bt})}static fetchAllRolePathsRecursively(At,xt,Bt){if(At.split("/").length>10)throw new DwnError(DwnErrorCode.ProtocolsConfigureRecordNestingDepthExceeded,"Record nesting depth exceeded 10 levels.");for(const Nt in xt){if(Nt.startsWith("$"))continue;const jt=xt[Nt];let Ut;At===""?Ut=Nt:Ut=`${At}/${Nt}`,jt.$role?Bt.push(Ut):ProtocolsConfigure.fetchAllRolePathsRecursively(Ut,jt,Bt)}return Bt}static validateRuleSetRecursively(At){var xt;const{ruleSet:Bt,ruleSetProtocolPath:Nt,recordTypes:jt,roles:Ut}=At;if(Bt.$size!==void 0){const{min:Ht=0,max:Vt}=Bt.$size;if(Vt!==void 0&&Vt<Ht)throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidSize,`Invalid size range found: max limit ${Vt} less than min limit ${Ht} at protocol path '${Nt}'`)}if(Bt.$tags){const Ht=new Ajv.default,Vt=Bt.$tags,zt=__rest$w(Vt,["$allowUndefinedTags","$requiredTags"]);for(const Wt in zt){const Jt=zt[Wt];if(!Ht.validateSchema(Jt)){const Qt=Ht.errorsText(Ht.errors,{dataVar:`${Nt}/$tags/${Wt}`});throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidTagSchema,`tags schema validation error: ${Qt}`)}}}const Lt=(xt=Bt.$actions)!==null&&xt!==void 0?xt:[];for(let Ht=0;Ht<Lt.length;Ht++){const Vt=Lt[Ht];if(Vt.role!==void 0&&!Ut.includes(Vt.role))throw new DwnError(DwnErrorCode.ProtocolsConfigureRoleDoesNotExistAtGivenPath,`Role in action ${JSON.stringify(Vt)} for rule set ${Nt} does not exist.`);if(Vt.who==="anyone"&&Vt.of)throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidActionOfNotAllowed,`'of' is not allowed at rule set protocol path (${Nt})`);if(Vt.who===ProtocolActor.Recipient&&Vt.of===void 0&&Vt.can.some(Wt=>![ProtocolAction.CoUpdate,ProtocolAction.CoDelete,ProtocolAction.CoPrune].includes(Wt)))throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidRecipientOfAction,"Rules for `recipient` without `of` property must have `can` containing only `co-update`, `co-delete`, and `co-prune`.");if(Vt.who===ProtocolActor.Author&&!Vt.of)throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidActionMissingOf,"'of' is required when 'author' is specified as 'who'");if(Vt.can!==void 0){if(Vt.can.includes(ProtocolAction.Update)&&!Vt.can.includes(ProtocolAction.Create))throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidActionUpdateWithoutCreate,`Action rule ${JSON.stringify(Vt)} contains 'update' action but missing the required 'create' action.`);if(Vt.can.includes(ProtocolAction.Delete)&&!Vt.can.includes(ProtocolAction.Create))throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidActionDeleteWithoutCreate,`Action rule ${JSON.stringify(Vt)} contains 'delete' action but missing the required 'create' action.`)}for(let zt=Ht+1;zt<Lt.length;zt++){const Wt=Lt[zt];if(Vt.who!==void 0){if(Vt.who===Wt.who&&Vt.of===Wt.of)throw new DwnError(DwnErrorCode.ProtocolsConfigureDuplicateActorInRuleSet,`More than one action rule per actor ${Vt.who} of ${Vt.of} not allowed within a rule set: ${JSON.stringify(Vt)}`)}else if(Vt.role===Wt.role)throw new DwnError(DwnErrorCode.ProtocolsConfigureDuplicateRoleInRuleSet,`More than one action rule per role ${Vt.role} not allowed within a rule set: ${JSON.stringify(Vt)}`)}}for(const Ht in Bt){if(Ht.startsWith("$"))continue;if(!jt.includes(Ht))throw new DwnError(DwnErrorCode.ProtocolsConfigureInvalidRuleSetRecordType,`Rule set ${Ht} is not declared as an allowed type in the protocol definition.`);const Vt=Bt[Ht];let zt;Nt===""?zt=Ht:zt=`${Nt}/${Ht}`,ProtocolsConfigure.validateRuleSetRecursively({ruleSet:Vt,ruleSetProtocolPath:zt,recordTypes:jt,roles:Ut})}}static normalizeDefinition(At){const xt=Object.assign({},At.types);for(const Bt in xt){const Nt=xt[Bt].schema;Nt!==void 0&&(xt[Bt].schema=normalizeSchemaUrl(Nt))}return Object.assign(Object.assign({},At),{protocol:normalizeProtocolUrl(At.protocol),types:xt})}}var __awaiter$2b=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$v=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class ProtocolsConfigureHandler{constructor(At,xt,Bt,Nt){this.didResolver=At,this.messageStore=xt,this.eventLog=Bt,this.eventStream=Nt}handle({tenant:At,message:xt}){return __awaiter$2b(this,void 0,void 0,function*(){let Bt;try{Bt=yield ProtocolsConfigure.parse(xt)}catch(zt){return messageReplyFromError(zt,400)}try{yield authenticate(xt.authorization,this.didResolver),yield ProtocolsConfigureHandler.authorizeProtocolsConfigure(At,Bt,this.messageStore)}catch(zt){return messageReplyFromError(zt,401)}const Nt={interface:DwnInterfaceName.Protocols,method:DwnMethodName.Configure,protocol:xt.descriptor.definition.protocol},{messages:jt}=yield this.messageStore.query(At,[Nt]);let Ut=yield Message.getNewestMessage(jt),Lt=!1;(Ut===void 0||(yield Message.isNewer(xt,Ut)))&&(Lt=!0,Ut=xt);let Ht;if(Lt){const zt=ProtocolsConfigureHandler.constructIndexes(Bt);yield this.messageStore.put(At,xt,zt);const Wt=yield Message.getCid(xt);yield this.eventLog.append(At,Wt,zt),this.eventStream!==void 0&&this.eventStream.emit(At,{message:xt},zt),Ht={status:{code:202,detail:"Accepted"}}}else Ht={status:{code:409,detail:"Conflict"}};const Vt=[];for(const zt of jt)if(yield Message.isNewer(Ut,zt)){const Wt=yield Message.getCid(zt);Vt.push(Wt),yield this.messageStore.delete(At,Wt)}return yield this.eventLog.deleteEventsByCid(At,Vt),Ht})}static constructIndexes(At){const xt=At.message.descriptor,{definition:Bt}=xt,Nt=__rest$v(xt,["definition"]),{author:jt}=At;return Object.assign(Object.assign({},Nt),{author:jt,protocol:Bt.protocol,published:Bt.published})}static authorizeProtocolsConfigure(At,xt,Bt){return __awaiter$2b(this,void 0,void 0,function*(){if(xt.isSignedByAuthorDelegate&&(yield xt.authorizeAuthorDelegate(Bt)),xt.author!==At)if(xt.author!==void 0&&xt.signaturePayload.permissionGrantId!==void 0){const Nt=yield PermissionsProtocol.fetchGrant(At,Bt,xt.signaturePayload.permissionGrantId);yield ProtocolsGrantAuthorization.authorizeConfigure({protocolsConfigureMessage:xt.message,expectedGrantor:At,expectedGrantee:xt.author,permissionGrant:Nt,messageStore:Bt})}else throw new DwnError(DwnErrorCode.ProtocolsConfigureAuthorizationFailed,"message failed authorization")})}}var __awaiter$2a=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class ProtocolsQuery extends AbstractMessage{static parse(At){return __awaiter$2a(this,void 0,void 0,function*(){return At.authorization!==void 0&&(yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor)),At.descriptor.filter!==void 0&&validateProtocolUrlNormalized(At.descriptor.filter.protocol),Time.validateTimestamp(At.descriptor.messageTimestamp),new ProtocolsQuery(At)})}static create(At){var xt;return __awaiter$2a(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Protocols,method:DwnMethodName.Query,messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Time.getCurrentTimestamp(),filter:At.filter?ProtocolsQuery.normalizeFilter(At.filter):void 0};removeUndefinedProperties$2(Bt);let Nt;At.signer!==void 0&&(Nt=yield Message.createAuthorization({descriptor:Bt,signer:At.signer,permissionGrantId:At.permissionGrantId}));const jt={descriptor:Bt,authorization:Nt};return Message.validateJsonSchema(jt),new ProtocolsQuery(jt)})}static normalizeFilter(At){return Object.assign(Object.assign({},At),{protocol:normalizeProtocolUrl(At.protocol)})}authorize(At,xt){return __awaiter$2a(this,void 0,void 0,function*(){if(this.author!==At)if(this.author!==void 0&&this.signaturePayload.permissionGrantId){const Bt=yield PermissionsProtocol.fetchGrant(At,xt,this.signaturePayload.permissionGrantId);yield ProtocolsGrantAuthorization.authorizeQuery({expectedGrantor:At,expectedGrantee:this.author,incomingMessage:this.message,permissionGrant:Bt,messageStore:xt})}else throw new DwnError(DwnErrorCode.ProtocolsQueryUnauthorized,"The ProtocolsQuery failed authorization")})}}var __awaiter$29=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class ProtocolsQueryHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.dataStore=Bt}handle({tenant:At,message:xt}){return __awaiter$29(this,void 0,void 0,function*(){let Bt;try{Bt=yield ProtocolsQuery.parse(xt)}catch(Ut){return messageReplyFromError(Ut,400)}try{yield authenticate(xt.authorization,this.didResolver),yield Bt.authorize(At,this.messageStore)}catch(Ut){if(Ut.code===DwnErrorCode.AuthenticateJwsMissing||Ut.code===DwnErrorCode.ProtocolsQueryUnauthorized||Ut.code===DwnErrorCode.ProtocolsGrantAuthorizationQueryProtocolScopeMismatch){const Lt=yield this.fetchPublishedProtocolsConfigure(At,Bt);return{status:{code:200,detail:"OK"},entries:Lt}}else return messageReplyFromError(Ut,401)}const Nt=Object.assign(Object.assign({},xt.descriptor.filter),{interface:DwnInterfaceName.Protocols,method:DwnMethodName.Configure});removeUndefinedProperties$2(Nt);const{messages:jt}=yield this.messageStore.query(At,[Nt]);return{status:{code:200,detail:"OK"},entries:jt}})}fetchPublishedProtocolsConfigure(At,xt){return __awaiter$29(this,void 0,void 0,function*(){const Bt=Object.assign(Object.assign({},xt.message.descriptor.filter),{interface:DwnInterfaceName.Protocols,method:DwnMethodName.Configure,published:!0}),{messages:Nt}=yield this.messageStore.query(At,[Bt]);return Nt})}}var __awaiter$28=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$u=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class ProtocolAuthorization{static validateReferentialIntegrity(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){const Nt=yield ProtocolAuthorization.fetchProtocolDefinition(At,xt.message.descriptor.protocol,Bt);ProtocolAuthorization.verifyType(xt.message,Nt.types),yield ProtocolAuthorization.verifyProtocolPathAndContextId(At,xt,Bt);const jt=ProtocolAuthorization.getRuleSet(xt.message.descriptor.protocolPath,Nt);yield ProtocolAuthorization.verifyAsRoleRecordIfNeeded(At,xt,jt,Bt),ProtocolAuthorization.verifySizeLimit(xt,jt),ProtocolAuthorization.verifyTagsIfNeeded(xt,jt)})}static authorizeWrite(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){const Nt=yield ProtocolAuthorization.fetchInitialWrite(At,xt.message.recordId,Bt);let jt;Nt===void 0?jt=yield ProtocolAuthorization.constructRecordChain(At,xt.message.descriptor.parentId,Bt):jt=yield ProtocolAuthorization.constructRecordChain(At,xt.message.recordId,Bt);const Ut=yield ProtocolAuthorization.fetchProtocolDefinition(At,xt.message.descriptor.protocol,Bt),Lt=ProtocolAuthorization.getRuleSet(xt.message.descriptor.protocolPath,Ut);yield ProtocolAuthorization.verifyInvokedRole(At,xt,xt.message.descriptor.protocol,xt.message.contextId,Ut,Bt),yield ProtocolAuthorization.authorizeAgainstAllowedActions(At,xt,Lt,jt,Bt)})}static authorizeRead(At,xt,Bt,Nt){return __awaiter$28(this,void 0,void 0,function*(){const jt=yield ProtocolAuthorization.constructRecordChain(At,Bt.message.recordId,Nt),Ut=yield ProtocolAuthorization.fetchProtocolDefinition(At,Bt.message.descriptor.protocol,Nt),Lt=ProtocolAuthorization.getRuleSet(Bt.message.descriptor.protocolPath,Ut);yield ProtocolAuthorization.verifyInvokedRole(At,xt,Bt.message.descriptor.protocol,Bt.message.contextId,Ut,Nt),yield ProtocolAuthorization.authorizeAgainstAllowedActions(At,xt,Lt,jt,Nt)})}static authorizeQueryOrSubscribe(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){const{protocol:Nt,protocolPath:jt,contextId:Ut}=xt.message.descriptor.filter,Lt=yield ProtocolAuthorization.fetchProtocolDefinition(At,Nt,Bt),Ht=ProtocolAuthorization.getRuleSet(jt,Lt);yield ProtocolAuthorization.verifyInvokedRole(At,xt,Nt,Ut,Lt,Bt),yield ProtocolAuthorization.authorizeAgainstAllowedActions(At,xt,Ht,[],Bt)})}static authorizeDelete(At,xt,Bt,Nt){return __awaiter$28(this,void 0,void 0,function*(){const jt=yield ProtocolAuthorization.constructRecordChain(At,xt.message.descriptor.recordId,Nt),Ut=yield ProtocolAuthorization.fetchProtocolDefinition(At,Bt.message.descriptor.protocol,Nt),Lt=ProtocolAuthorization.getRuleSet(Bt.message.descriptor.protocolPath,Ut);yield ProtocolAuthorization.verifyInvokedRole(At,xt,Bt.message.descriptor.protocol,Bt.message.contextId,Ut,Nt),yield ProtocolAuthorization.authorizeAgainstAllowedActions(At,xt,Lt,jt,Nt)})}static fetchProtocolDefinition(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){if(xt===PermissionsProtocol.uri)return PermissionsProtocol.definition;const Nt={interface:DwnInterfaceName.Protocols,method:DwnMethodName.Configure,protocol:xt},{messages:jt}=yield Bt.query(At,[Nt]);if(jt.length===0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationProtocolNotFound,`unable to find protocol definition for ${xt}`);return jt[0].descriptor.definition})}static constructRecordChain(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){if(xt===void 0)return[];const Nt=[];let jt=xt;for(;jt!==void 0;){const Ut=yield ProtocolAuthorization.fetchInitialWrite(At,jt,Bt);if(Ut===void 0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationParentNotFoundConstructingRecordChain,`Unexpected error that should never trigger: no parent found with ID ${jt} when constructing record chain.`);Nt.push(Ut),jt=Ut.descriptor.parentId}return Nt.reverse()})}static fetchInitialWrite(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){const Nt={interface:DwnInterfaceName.Records,method:DwnMethodName.Write,recordId:xt},{messages:jt}=yield Bt.query(At,[Nt]);return jt.length===0?void 0:yield RecordsWrite.getInitialWrite(jt)})}static getRuleSet(At,xt){const Bt=ProtocolAuthorization.getRuleSetAtProtocolPath(At,xt);if(Bt===void 0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationMissingRuleSet,`No rule set defined for protocolPath ${At}`);return Bt}static verifyProtocolPathAndContextId(At,xt,Bt){var Nt;return __awaiter$28(this,void 0,void 0,function*(){const jt=xt.message.descriptor.protocolPath,Ut=ProtocolAuthorization.getTypeName(jt),Lt=xt.message.descriptor.parentId;if(Lt===void 0){if(jt!==Ut)throw new DwnError(DwnErrorCode.ProtocolAuthorizationParentlessIncorrectProtocolPath,`Declared protocol path '${jt}' is not valid for records with no parent'.`);return}const Ht=xt.message.descriptor.protocol,Vt={isLatestBaseState:!0,interface:DwnInterfaceName.Records,method:DwnMethodName.Write,protocol:Ht,recordId:Lt},{messages:zt}=yield Bt.query(At,[Vt]),Wt=zt[0];if(`${(Nt=Wt==null?void 0:Wt.descriptor)===null||Nt===void 0?void 0:Nt.protocolPath}/${Ut}`!==jt)throw new DwnError(DwnErrorCode.ProtocolAuthorizationIncorrectProtocolPath,`Could not find matching parent record to verify declared protocol path '${jt}'.`);const Xt=`${Wt.contextId}/${xt.message.recordId}`,tr=xt.message.contextId;if(tr!==Xt)throw new DwnError(DwnErrorCode.ProtocolAuthorizationIncorrectContextId,`Declared contextId '${tr}' is not the same as expected: '${Xt}'.`)})}static verifyType(At,xt){const Bt=Object.keys(xt),Nt=At.descriptor.protocolPath,jt=ProtocolAuthorization.getTypeName(Nt);if(!Bt.includes(jt))throw new DwnError(DwnErrorCode.ProtocolAuthorizationInvalidType,`record with type ${jt} not allowed in protocol`);const Ut=At.descriptor.protocolPath,Lt=ProtocolAuthorization.getTypeName(Ut),Ht=xt[Lt],{schema:Vt}=At.descriptor;if(Ht.schema!==void 0&&Ht.schema!==Vt)throw new DwnError(DwnErrorCode.ProtocolAuthorizationInvalidSchema,`type '${Lt}' must have schema '${Ht.schema}',         instead has '${Vt}'`);const{dataFormat:zt}=At.descriptor;if(Ht.dataFormats!==void 0&&!Ht.dataFormats.includes(zt))throw new DwnError(DwnErrorCode.ProtocolAuthorizationIncorrectDataFormat,`type '${Lt}' must have data format in (${Ht.dataFormats}),         instead has '${zt}'`)}static verifyInvokedRole(At,xt,Bt,Nt,jt,Ut){var Lt;return __awaiter$28(this,void 0,void 0,function*(){const Ht=(Lt=xt.signaturePayload)===null||Lt===void 0?void 0:Lt.protocolRole;if(Ht===void 0)return;const Vt=ProtocolAuthorization.getRuleSetAtProtocolPath(Ht,jt);if(Vt===void 0||!Vt.$role)throw new DwnError(DwnErrorCode.ProtocolAuthorizationNotARole,`Protocol path ${Ht} does not match role record type.`);const zt={interface:DwnInterfaceName.Records,method:DwnMethodName.Write,protocol:Bt,protocolPath:Ht,recipient:xt.author,isLatestBaseState:!0},Wt=Ht.split("/").length-1;if(Nt===void 0&&Wt>0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationMissingContextId,"Could not verify role because contextId is missing.");if(Wt>0){const Xt=Nt.split("/").slice(0,Wt).join("/"),tr=FilterUtility.constructPrefixFilterAsRangeFilter(Xt);zt.contextId=tr}const{messages:Jt}=yield Ut.query(At,[zt]);if(Jt.length===0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationMatchingRoleRecordNotFound,`No matching role record found for protocol path ${Ht}`)})}static getActionsSeekingARuleMatch(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){switch(xt.message.descriptor.method){case DwnMethodName.Delete:const Nt=xt,jt=Nt.message.descriptor.recordId,Ut=yield RecordsWrite.fetchInitialRecordsWrite(Bt,At,jt);if(Ut===void 0)return[];const Lt=[];return Nt.message.descriptor.prune?(Lt.push(ProtocolAction.CoPrune),xt.author===Ut.author&&Lt.push(ProtocolAction.Prune)):(Lt.push(ProtocolAction.CoDelete),xt.author===Ut.author&&Lt.push(ProtocolAction.Delete)),Lt;case DwnMethodName.Query:return[ProtocolAction.Query];case DwnMethodName.Read:return[ProtocolAction.Read];case DwnMethodName.Subscribe:return[ProtocolAction.Subscribe];case DwnMethodName.Write:if(yield xt.isInitialWrite())return[ProtocolAction.Create];{const zt=xt.message.recordId,Wt=yield RecordsWrite.fetchInitialRecordsWrite(Bt,At,zt);return Wt===void 0?[]:xt.author===Wt.author?[ProtocolAction.CoUpdate,ProtocolAction.Update]:[ProtocolAction.CoUpdate]}}return[]})}static authorizeAgainstAllowedActions(At,xt,Bt,Nt,jt){var Ut;return __awaiter$28(this,void 0,void 0,function*(){const Lt=xt.message.descriptor.method,Ht=yield ProtocolAuthorization.getActionsSeekingARuleMatch(At,xt,jt),Vt=xt.author,zt=Bt.$actions;if(zt===void 0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationActionRulesNotFound,`no action rule defined for Records${Lt}, ${Vt} is unauthorized`);const Wt=(Ut=xt.signaturePayload)===null||Ut===void 0?void 0:Ut.protocolRole;for(const Jt of zt){if(!Jt.can.some(tr=>Ht.includes(tr)))continue;if(Jt.who===ProtocolActor.Anyone)return;if(Vt===void 0)continue;if(Wt!==void 0){if(Jt.role===Wt)return;continue}if(Jt.who===ProtocolActor.Recipient&&Jt.of===void 0){let tr;if(xt.message.descriptor.method===DwnMethodName.Write?tr=xt.message:tr=Nt[Nt.length-1],tr.descriptor.recipient===Vt)return;continue}if(yield ProtocolAuthorization.checkActor(Vt,Jt,Nt))return}throw new DwnError(DwnErrorCode.ProtocolAuthorizationActionNotAllowed,`Inbound message action Records${Lt} by author ${xt.author} not allowed.`)})}static verifySizeLimit(At,xt){const{min:Bt=0,max:Nt}=xt.$size||{},jt=At.message.descriptor.dataSize;if(jt<Bt)throw new DwnError(DwnErrorCode.ProtocolAuthorizationMinSizeInvalid,`data size ${jt} is less than allowed ${Bt}`);if(Nt!==void 0&&jt>Nt)throw new DwnError(DwnErrorCode.ProtocolAuthorizationMaxSizeInvalid,`data size ${jt} is more than allowed ${Nt}`)}static verifyTagsIfNeeded(At,xt){if(xt.$tags!==void 0){const{tags:Bt={},protocol:Nt,protocolPath:jt}=At.message.descriptor,Ut=xt.$tags,{$allowUndefinedTags:Lt,$requiredTags:Ht}=Ut,Vt=__rest$u(Ut,["$allowUndefinedTags","$requiredTags"]),zt=Lt||!1,Wt=Ht||[],Jt=new Ajv.default,Qt=Jt.compile({type:"object",properties:Vt,required:Wt,additionalProperties:zt});if(!Qt(Bt)){const tr=Jt.errorsText(Qt.errors,{dataVar:`${Nt}/${jt}/$tags`});throw new DwnError(DwnErrorCode.ProtocolAuthorizationTagsInvalidSchema,`tags schema validation error: ${tr}`)}}}static verifyAsRoleRecordIfNeeded(At,xt,Bt,Nt){return __awaiter$28(this,void 0,void 0,function*(){if(!Bt.$role)return;const jt=xt,Ut=jt.message.descriptor.recipient;if(Ut===void 0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationRoleMissingRecipient,"Role records must have a recipient");const Lt=jt.message.descriptor.protocolPath,Ht={interface:DwnInterfaceName.Records,method:DwnMethodName.Write,isLatestBaseState:!0,protocol:jt.message.descriptor.protocol,protocolPath:Lt,recipient:Ut},Vt=Records.getParentContextFromOfContextId(jt.message.contextId);if(Vt!==""){const Qt=FilterUtility.constructPrefixFilterAsRangeFilter(Vt);Ht.contextId=Qt}const{messages:zt}=yield Nt.query(At,[Ht]);if(zt.filter(Qt=>Qt.recordId!==jt.message.recordId).length>0)throw new DwnError(DwnErrorCode.ProtocolAuthorizationDuplicateRoleRecipient,`DID '${Ut}' is already recipient of a role record at protocol path '${Lt} under the parent context ${Vt}.`)})}static getRuleSetAtProtocolPath(At,xt){const Bt=At.split("/");let Nt=xt.structure,jt=0;for(;jt<Bt.length;){const Ut=Bt[jt],Lt=Nt[Ut];if(Lt===void 0)return;Nt=Lt,jt++}return Nt}static checkActor(At,xt,Bt){return __awaiter$28(this,void 0,void 0,function*(){const Nt=Bt.find(jt=>jt.descriptor.protocolPath===xt.of);if(Nt===void 0)return!1;if(xt.who===ProtocolActor.Recipient)return At===Nt.descriptor.recipient;{const jt=(yield RecordsWrite.parse(Nt)).author;return At===jt}})}static getTypeName(At){return At.split("/").slice(-1)[0]}}var __awaiter$27=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsDelete extends AbstractMessage{static parse(At){return __awaiter$27(this,void 0,void 0,function*(){let xt;return At.authorization!==void 0&&(xt=yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor)),yield Records.validateDelegatedGrantReferentialIntegrity(At,xt),Time.validateTimestamp(At.descriptor.messageTimestamp),new RecordsDelete(At)})}static create(At){var xt,Bt;return __awaiter$27(this,void 0,void 0,function*(){const Nt=At.recordId,jt=Time.getCurrentTimestamp(),Ut={interface:DwnInterfaceName.Records,method:DwnMethodName.Delete,messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:jt,recordId:Nt,prune:(Bt=At.prune)!==null&&Bt!==void 0?Bt:!1},Lt=yield Message.createAuthorization({descriptor:Ut,signer:At.signer,protocolRole:At.protocolRole,delegatedGrant:At.delegatedGrant}),Ht={descriptor:Ut,authorization:Lt};return Message.validateJsonSchema(Ht),new RecordsDelete(Ht)})}constructIndexes(At){const xt=this.message,Bt=Object.assign({},xt.descriptor),{protocol:Nt,protocolPath:jt,recipient:Ut,schema:Lt,parentId:Ht,dateCreated:Vt}=At.descriptor,zt=Object.assign({protocol:Nt,protocolPath:jt,recipient:Ut,schema:Lt,parentId:Ht,dateCreated:Vt,contextId:At.contextId,author:this.author},Bt);return removeUndefinedProperties$2(zt),zt}authorizeDelegate(At,xt){return __awaiter$27(this,void 0,void 0,function*(){const Bt=yield PermissionGrant$1.parse(this.message.authorization.authorDelegatedGrant);yield RecordsGrantAuthorization.authorizeDelete({recordsDeleteMessage:this.message,recordsWriteToDelete:At,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:Bt,messageStore:xt})})}}var __awaiter$26=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},ResumableTaskName;(function(kt){kt.RecordsDelete="RecordsDelete"})(ResumableTaskName||(ResumableTaskName={}));class ResumableTaskManager{constructor(At,xt){this.resumableTaskStore=At,this.resumableTaskBatchSize=100,this.resumableTaskHandlers={[ResumableTaskName.RecordsDelete]:Bt=>__awaiter$26(this,void 0,void 0,function*(){return yield xt.performRecordsDelete(Bt)})}}run(At){return __awaiter$26(this,void 0,void 0,function*(){const xt=ResumableTaskManager.timeoutExtensionFrequencyInSeconds*2,Bt=yield this.resumableTaskStore.register(At,xt);yield this.runWithAutomaticTimeoutExtension(Bt)})}runWithAutomaticTimeoutExtension(At){return __awaiter$26(this,void 0,void 0,function*(){const xt=ResumableTaskManager.timeoutExtensionFrequencyInSeconds*2;let Bt;try{Bt=setInterval(()=>{this.resumableTaskStore.extend(At.id,xt)},ResumableTaskManager.timeoutExtensionFrequencyInSeconds*1e3);const Nt=this.resumableTaskHandlers[At.task.name];yield Nt(At.task.data),yield this.resumableTaskStore.delete(At.id)}finally{ResumableTaskManager.clearTimeoutExtensionTimer(Bt)}})}static clearTimeoutExtensionTimer(At){clearInterval(At)}resumeTasksAndWaitForCompletion(){return __awaiter$26(this,void 0,void 0,function*(){for(;;){const At=yield this.resumableTaskStore.grab(this.resumableTaskBatchSize);if(At===void 0||At.length===0)break;yield this.retryTasksUntilCompletion(At)}})}retryTasksUntilCompletion(At){return __awaiter$26(this,void 0,void 0,function*(){let xt=At;for(;xt.length>0;){const Bt=xt;xt=[];const Nt=Bt.map(jt=>__awaiter$26(this,void 0,void 0,function*(){try{yield this.runWithAutomaticTimeoutExtension(jt)}catch(Ut){console.error("Error while running resumable task:",Ut),console.error("Resumable task:",At),xt.push(jt)}}));yield Promise.all(Nt)}})}}ResumableTaskManager.timeoutExtensionFrequencyInSeconds=30;var __awaiter$25=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsDeleteHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.resumableTaskManager=Bt}handle({tenant:At,message:xt}){return __awaiter$25(this,void 0,void 0,function*(){let Bt;try{Bt=yield RecordsDelete.parse(xt)}catch(Vt){return messageReplyFromError(Vt,400)}try{yield authenticate(xt.authorization,this.didResolver)}catch(Vt){return messageReplyFromError(Vt,401)}const Nt={interface:DwnInterfaceName.Records,recordId:xt.descriptor.recordId},{messages:jt}=yield this.messageStore.query(At,[Nt]),Ut=yield Message.getNewestMessage(jt);if(!Records.canPerformDeleteAgainstRecord(xt,Ut))return{status:{code:404,detail:"Not Found"}};if(!(yield Message.isNewer(xt,Ut)))return{status:{code:409,detail:"Conflict"}};try{const Vt=yield RecordsWrite.fetchInitialRecordsWrite(this.messageStore,At,xt.descriptor.recordId);yield RecordsDeleteHandler.authorizeRecordsDelete(At,Bt,Vt,this.messageStore)}catch(Vt){return messageReplyFromError(Vt,401)}return yield this.resumableTaskManager.run({name:ResumableTaskName.RecordsDelete,data:{tenant:At,message:xt}}),{status:{code:202,detail:"Accepted"}}})}static authorizeRecordsDelete(At,xt,Bt,Nt){return __awaiter$25(this,void 0,void 0,function*(){if(Message.isSignedByAuthorDelegate(xt.message)&&(yield xt.authorizeDelegate(Bt.message,Nt)),xt.author!==At)if(Bt.message.descriptor.protocol!==void 0)yield ProtocolAuthorization.authorizeDelete(At,xt,Bt,Nt);else throw new DwnError(DwnErrorCode.RecordsDeleteAuthorizationFailed,"RecordsDelete message failed authorization")})}}var SortDirection;(function(kt){kt[kt.Descending=-1]="Descending",kt[kt.Ascending=1]="Ascending"})(SortDirection||(SortDirection={}));var __awaiter$24=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsQueryHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.dataStore=Bt}handle({tenant:At,message:xt}){return __awaiter$24(this,void 0,void 0,function*(){let Bt;try{Bt=yield RecordsQuery.parse(xt)}catch(Ut){return messageReplyFromError(Ut,400)}let Nt,jt;if(Records.filterIncludesPublishedRecords(Bt.message.descriptor.filter)&&Bt.author===void 0){const Ut=yield this.fetchPublishedRecords(At,Bt);Nt=Ut.messages,jt=Ut.cursor}else{try{yield authenticate(xt.authorization,this.didResolver),yield RecordsQueryHandler.authorizeRecordsQuery(At,Bt,this.messageStore)}catch(Ut){return messageReplyFromError(Ut,401)}if(Bt.author===At){const Ut=yield this.fetchRecordsAsOwner(At,Bt);Nt=Ut.messages,jt=Ut.cursor}else{const Ut=yield this.fetchRecordsAsNonOwner(At,Bt);Nt=Ut.messages,jt=Ut.cursor}}for(const Ut of Nt)if(!(yield RecordsWrite.isInitialWrite(Ut))){const Ht=(yield this.messageStore.query(At,[{recordId:Ut.recordId,isLatestBaseState:!1,method:DwnMethodName.Write}])).messages[0];delete Ht.encodedData,Ut.initialWrite=Ht}return{status:{code:200,detail:"OK"},entries:Nt,cursor:jt}})}convertDateSort(At){switch(At){case DateSort.CreatedAscending:return{dateCreated:SortDirection.Ascending};case DateSort.CreatedDescending:return{dateCreated:SortDirection.Descending};case DateSort.PublishedAscending:return{datePublished:SortDirection.Ascending};case DateSort.PublishedDescending:return{datePublished:SortDirection.Descending};default:return{dateCreated:SortDirection.Ascending}}}fetchRecordsAsOwner(At,xt){return __awaiter$24(this,void 0,void 0,function*(){const{dateSort:Bt,filter:Nt,pagination:jt}=xt.message.descriptor,Ut=Object.assign(Object.assign({},Records.convertFilter(Nt,Bt)),{interface:DwnInterfaceName.Records,method:DwnMethodName.Write,isLatestBaseState:!0}),Lt=this.convertDateSort(Bt);return this.messageStore.query(At,[Ut],Lt,jt)})}fetchRecordsAsNonOwner(At,xt){return __awaiter$24(this,void 0,void 0,function*(){const{dateSort:Bt,pagination:Nt,filter:jt}=xt.message.descriptor,Ut=[];Records.filterIncludesPublishedRecords(jt)&&Ut.push(RecordsQueryHandler.buildPublishedRecordsFilter(xt)),Records.filterIncludesUnpublishedRecords(jt)&&(Records.shouldBuildUnpublishedAuthorFilter(jt,xt.author)&&Ut.push(RecordsQueryHandler.buildUnpublishedRecordsByQueryAuthorFilter(xt)),Records.shouldProtocolAuthorize(xt.signaturePayload)&&Ut.push(RecordsQueryHandler.buildUnpublishedProtocolAuthorizedRecordsFilter(xt)),Records.shouldBuildUnpublishedRecipientFilter(jt,xt.author)&&Ut.push(RecordsQueryHandler.buildUnpublishedRecordsForQueryAuthorFilter(xt)));const Lt=this.convertDateSort(Bt);return this.messageStore.query(At,Ut,Lt,Nt)})}fetchPublishedRecords(At,xt){return __awaiter$24(this,void 0,void 0,function*(){const{dateSort:Bt,pagination:Nt}=xt.message.descriptor,jt=RecordsQueryHandler.buildPublishedRecordsFilter(xt),Ut=this.convertDateSort(Bt);return this.messageStore.query(At,[jt],Ut,Nt)})}static buildPublishedRecordsFilter(At){const{dateSort:xt,filter:Bt}=At.message.descriptor;return Object.assign(Object.assign({},Records.convertFilter(Bt,xt)),{interface:DwnInterfaceName.Records,method:DwnMethodName.Write,published:!0,isLatestBaseState:!0})}static buildUnpublishedRecordsForQueryAuthorFilter(At){const{dateSort:xt,filter:Bt}=At.message.descriptor;return Object.assign(Object.assign({},Records.convertFilter(Bt,xt)),{interface:DwnInterfaceName.Records,method:DwnMethodName.Write,recipient:At.author,isLatestBaseState:!0,published:!1})}static buildUnpublishedProtocolAuthorizedRecordsFilter(At){const{dateSort:xt,filter:Bt}=At.message.descriptor;return Object.assign(Object.assign({},Records.convertFilter(Bt,xt)),{interface:DwnInterfaceName.Records,method:DwnMethodName.Write,isLatestBaseState:!0,published:!1})}static buildUnpublishedRecordsByQueryAuthorFilter(At){const{dateSort:xt,filter:Bt}=At.message.descriptor;return Object.assign(Object.assign({},Records.convertFilter(Bt,xt)),{author:At.author,interface:DwnInterfaceName.Records,method:DwnMethodName.Write,isLatestBaseState:!0,published:!1})}static authorizeRecordsQuery(At,xt,Bt){return __awaiter$24(this,void 0,void 0,function*(){Message.isSignedByAuthorDelegate(xt.message)&&(yield xt.authorizeDelegate(Bt)),Records.shouldProtocolAuthorize(xt.signaturePayload)&&(yield ProtocolAuthorization.authorizeQueryOrSubscribe(At,xt,Bt))})}}var __awaiter$23=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsRead extends AbstractMessage{static parse(At){return __awaiter$23(this,void 0,void 0,function*(){let xt;return At.authorization!==void 0&&(xt=yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor)),yield Records.validateDelegatedGrantReferentialIntegrity(At,xt),Time.validateTimestamp(At.descriptor.messageTimestamp),new RecordsRead(At)})}static create(At){var xt;return __awaiter$23(this,void 0,void 0,function*(){const{filter:Bt,signer:Nt,permissionGrantId:jt,protocolRole:Ut}=At,Lt=Time.getCurrentTimestamp(),Ht={interface:DwnInterfaceName.Records,method:DwnMethodName.Read,filter:Records.normalizeFilter(Bt),messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Lt};removeUndefinedProperties$2(Ht);let Vt;Nt!==void 0&&(Vt=yield Message.createAuthorization({descriptor:Ht,signer:Nt,permissionGrantId:jt,protocolRole:Ut,delegatedGrant:At.delegatedGrant}));const zt={descriptor:Ht,authorization:Vt};return Message.validateJsonSchema(zt),new RecordsRead(zt)})}authorizeDelegate(At,xt){return __awaiter$23(this,void 0,void 0,function*(){const Bt=yield PermissionGrant$1.parse(this.message.authorization.authorDelegatedGrant);yield RecordsGrantAuthorization.authorizeRead({recordsReadMessage:this.message,recordsWriteMessageToBeRead:At,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:Bt,messageStore:xt})})}}var __awaiter$22=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsReadHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.dataStore=Bt}handle({tenant:At,message:xt}){return __awaiter$22(this,void 0,void 0,function*(){let Bt;try{Bt=yield RecordsRead.parse(xt)}catch(zt){return messageReplyFromError(zt,400)}try{Bt.author!==void 0&&(yield authenticate(xt.authorization,this.didResolver))}catch(zt){return messageReplyFromError(zt,401)}const Nt=Object.assign({interface:DwnInterfaceName.Records,isLatestBaseState:!0},Records.convertFilter(xt.descriptor.filter)),{messages:jt}=yield this.messageStore.query(At,[Nt]);if(jt.length===0)return{status:{code:404,detail:"Not Found"}};if(jt.length>1)return messageReplyFromError(new DwnError(DwnErrorCode.RecordsReadReturnedMultiple,"Multiple records exist for the RecordsRead filter"),400);const Ut=jt[0];try{yield RecordsReadHandler.authorizeRecordsRead(At,Bt,yield RecordsWrite.parse(Ut),this.messageStore)}catch(zt){return messageReplyFromError(zt,401)}let Lt;if(Ut.encodedData!==void 0){const zt=Encoder$4.base64UrlToBytes(Ut.encodedData);Lt=DataStream.fromBytes(zt),delete Ut.encodedData}else{const zt=yield this.dataStore.get(At,Ut.recordId,Ut.descriptor.dataCid);if((zt==null?void 0:zt.dataStream)===void 0)return{status:{code:404,detail:"Not Found"}};Lt=zt.dataStream}const Ht=Object.assign(Object.assign({},Ut),{data:Lt});if(!(yield RecordsWrite.isInitialWrite(Ht))){const Wt=(yield this.messageStore.query(At,[{recordId:Ht.recordId,isLatestBaseState:!1,method:DwnMethodName.Write}])).messages[0];delete Wt.encodedData,Ht.initialWrite=Wt}return{status:{code:200,detail:"OK"},record:Ht}})}static authorizeRecordsRead(At,xt,Bt,Nt){return __awaiter$22(this,void 0,void 0,function*(){Message.isSignedByAuthorDelegate(xt.message)&&(yield xt.authorizeDelegate(Bt.message,Nt));const{descriptor:jt}=Bt.message;if(xt.author!==At){if(jt.published===!0)return;if(xt.author!==void 0&&xt.author===jt.recipient)return;if(xt.author!==void 0&&xt.signaturePayload.permissionGrantId!==void 0){const Ut=yield PermissionsProtocol.fetchGrant(At,Nt,xt.signaturePayload.permissionGrantId);yield RecordsGrantAuthorization.authorizeRead({recordsReadMessage:xt.message,recordsWriteMessageToBeRead:Bt.message,expectedGrantor:At,expectedGrantee:xt.author,permissionGrant:Ut,messageStore:Nt})}else if(jt.protocol!==void 0)yield ProtocolAuthorization.authorizeRead(At,xt,Bt,Nt);else throw new DwnError(DwnErrorCode.RecordsReadAuthorizationFailed,"message failed authorization")}})}}var __awaiter$21=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsSubscribe extends AbstractMessage{static parse(At){return __awaiter$21(this,void 0,void 0,function*(){let xt;if(At.authorization!==void 0&&(xt=yield Message.validateSignatureStructure(At.authorization.signature,At.descriptor)),yield Records.validateDelegatedGrantReferentialIntegrity(At,xt),(xt==null?void 0:xt.protocolRole)!==void 0&&At.descriptor.filter.protocolPath===void 0)throw new DwnError(DwnErrorCode.RecordsSubscribeFilterMissingRequiredProperties,"Role-authorized subscriptions must include `protocolPath` in the filter");return At.descriptor.filter.protocol!==void 0&&validateProtocolUrlNormalized(At.descriptor.filter.protocol),At.descriptor.filter.schema!==void 0&&validateSchemaUrlNormalized(At.descriptor.filter.schema),Time.validateTimestamp(At.descriptor.messageTimestamp),new RecordsSubscribe(At)})}static create(At){var xt;return __awaiter$21(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Records,method:DwnMethodName.Subscribe,messageTimestamp:(xt=At.messageTimestamp)!==null&&xt!==void 0?xt:Time.getCurrentTimestamp(),filter:Records.normalizeFilter(At.filter)};removeUndefinedProperties$2(Bt);const Nt=At.signer;let jt;Nt&&(jt=yield Message.createAuthorization({descriptor:Bt,signer:Nt,protocolRole:At.protocolRole,delegatedGrant:At.delegatedGrant}));const Ut={descriptor:Bt,authorization:jt};return Message.validateJsonSchema(Ut),new RecordsSubscribe(Ut)})}authorizeDelegate(At){return __awaiter$21(this,void 0,void 0,function*(){const xt=yield PermissionGrant$1.parse(this.message.authorization.authorDelegatedGrant);yield RecordsGrantAuthorization.authorizeQueryOrSubscribe({incomingMessage:this.message,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:xt,messageStore:At})})}}var __awaiter$20=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsSubscribeHandler{constructor(At,xt,Bt){this.didResolver=At,this.messageStore=xt,this.eventStream=Bt}handle({tenant:At,message:xt,subscriptionHandler:Bt}){return __awaiter$20(this,void 0,void 0,function*(){if(this.eventStream===void 0)return messageReplyFromError(new DwnError(DwnErrorCode.RecordsSubscribeEventStreamUnimplemented,"Subscriptions are not supported"),501);let Nt;try{Nt=yield RecordsSubscribe.parse(xt)}catch(Vt){return messageReplyFromError(Vt,400)}let jt=[];if(Records.filterIncludesPublishedRecords(Nt.message.descriptor.filter)&&Nt.author===void 0)jt=[RecordsSubscribeHandler.buildPublishedRecordsFilter(Nt)],delete xt.authorization;else{try{yield authenticate(xt.authorization,this.didResolver),yield RecordsSubscribeHandler.authorizeRecordsSubscribe(At,Nt,this.messageStore)}catch(Vt){return messageReplyFromError(Vt,401)}Nt.author===At?jt=yield RecordsSubscribeHandler.filterAsOwner(Nt):jt=yield RecordsSubscribeHandler.filterAsNonOwner(Nt)}const Ut=(Vt,zt,Wt)=>{At===Vt&&FilterUtility.matchAnyFilter(Wt,jt)&&Bt(zt)},Lt=yield Message.getCid(xt),Ht=yield this.eventStream.subscribe(At,Lt,Ut);return{status:{code:200,detail:"OK"},subscription:Ht}})}static filterAsOwner(At){return __awaiter$20(this,void 0,void 0,function*(){const{filter:xt}=At.message.descriptor;return[Object.assign(Object.assign({},Records.convertFilter(xt)),{interface:DwnInterfaceName.Records,method:[DwnMethodName.Write,DwnMethodName.Delete]})]})}static filterAsNonOwner(At){return __awaiter$20(this,void 0,void 0,function*(){const xt=[],{filter:Bt}=At.message.descriptor;return Records.filterIncludesPublishedRecords(Bt)&&xt.push(RecordsSubscribeHandler.buildPublishedRecordsFilter(At)),Records.filterIncludesUnpublishedRecords(Bt)&&(Records.shouldBuildUnpublishedAuthorFilter(Bt,At.author)&&xt.push(RecordsSubscribeHandler.buildUnpublishedRecordsBySubscribeAuthorFilter(At)),Records.shouldProtocolAuthorize(At.signaturePayload)&&xt.push(RecordsSubscribeHandler.buildUnpublishedProtocolAuthorizedRecordsFilter(At)),Records.shouldBuildUnpublishedRecipientFilter(Bt,At.author)&&xt.push(RecordsSubscribeHandler.buildUnpublishedRecordsForSubscribeAuthorFilter(At))),xt})}static buildPublishedRecordsFilter(At){return Object.assign(Object.assign({},Records.convertFilter(At.message.descriptor.filter)),{interface:DwnInterfaceName.Records,method:[DwnMethodName.Write,DwnMethodName.Delete],published:!0})}static buildUnpublishedRecordsForSubscribeAuthorFilter(At){return Object.assign(Object.assign({},Records.convertFilter(At.message.descriptor.filter)),{interface:DwnInterfaceName.Records,method:[DwnMethodName.Write,DwnMethodName.Delete],recipient:At.author,published:!1})}static buildUnpublishedProtocolAuthorizedRecordsFilter(At){return Object.assign(Object.assign({},Records.convertFilter(At.message.descriptor.filter)),{interface:DwnInterfaceName.Records,method:[DwnMethodName.Write,DwnMethodName.Delete],published:!1})}static buildUnpublishedRecordsBySubscribeAuthorFilter(At){return Object.assign(Object.assign({},Records.convertFilter(At.message.descriptor.filter)),{author:At.author,interface:DwnInterfaceName.Records,method:[DwnMethodName.Write,DwnMethodName.Delete],published:!1})}static authorizeRecordsSubscribe(At,xt,Bt){return __awaiter$20(this,void 0,void 0,function*(){Message.isSignedByAuthorDelegate(xt.message)&&(yield xt.authorizeDelegate(Bt)),Records.shouldProtocolAuthorize(xt.signaturePayload)&&(yield ProtocolAuthorization.authorizeQueryOrSubscribe(At,xt,Bt))})}}class DwnConstant{}DwnConstant.maxDataSizeAllowedToBeEncoded=3e4;var __awaiter$1$=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class StorageController{constructor({messageStore:At,dataStore:xt,eventLog:Bt,eventStream:Nt}){this.messageStore=At,this.dataStore=xt,this.eventLog=Bt,this.eventStream=Nt}performRecordsDelete({tenant:At,message:xt}){return __awaiter$1$(this,void 0,void 0,function*(){const Bt={interface:DwnInterfaceName.Records,recordId:xt.descriptor.recordId},{messages:Nt}=yield this.messageStore.query(At,[Bt]),jt=yield Message.getNewestMessage(Nt);if(!Records.canPerformDeleteAgainstRecord(xt,jt))return;const Ut=yield RecordsDelete.parse(xt),Lt=yield RecordsWrite.getInitialWrite(Nt),Ht=Ut.constructIndexes(Lt),Vt=yield Message.getCid(xt);yield this.messageStore.put(At,xt,Ht),yield this.eventLog.append(At,Vt,Ht),this.eventStream!==void 0&&this.eventStream.emit(At,{message:xt,initialWrite:Lt},Ht),xt.descriptor.prune&&(yield StorageController.purgeRecordDescendants(At,xt.descriptor.recordId,this.messageStore,this.dataStore,this.eventLog)),yield StorageController.deleteAllOlderMessagesButKeepInitialWrite(At,Nt,xt,this.messageStore,this.dataStore,this.eventLog)})}static deleteFromDataStoreIfNeeded(At,xt,Bt,Nt){return __awaiter$1$(this,void 0,void 0,function*(){if(Bt.descriptor.method!==DwnMethodName.Write)return;const jt=Bt;jt.descriptor.dataSize<=DwnConstant.maxDataSizeAllowedToBeEncoded||jt.descriptor.dataCid!==Nt.descriptor.dataCid&&(yield At.delete(xt,jt.recordId,jt.descriptor.dataCid))})}static purgeRecordDescendants(At,xt,Bt,Nt,jt){return __awaiter$1$(this,void 0,void 0,function*(){const Ut={interface:DwnInterfaceName.Records,parentId:xt},{messages:Lt}=yield Bt.query(At,[Ut]),Ht=new Map;for(const Vt of Lt){let zt;Records.isRecordsWrite(Vt)?zt=Vt.recordId:zt=Vt.descriptor.recordId,Ht.has(zt)||Ht.set(zt,[]),Ht.get(zt).push(Vt)}for(const Vt of Ht.keys())yield StorageController.purgeRecordDescendants(At,Vt,Bt,Nt,jt);for(const Vt of Ht.keys())yield StorageController.purgeRecordMessages(At,Ht.get(Vt),Bt,Nt,jt)})}static purgeRecordMessages(At,xt,Bt,Nt,jt){return __awaiter$1$(this,void 0,void 0,function*(){const Ut=xt.filter(Vt=>Vt.descriptor.method===DwnMethodName.Write),Lt=yield Message.getNewestMessage(Ut);yield Nt.delete(At,Lt.recordId,Lt.descriptor.dataCid);const Ht=yield Promise.all(xt.map(Vt=>Message.getCid(Vt)));yield jt.deleteEventsByCid(At,Ht),yield Promise.all(Ht.map(Vt=>Bt.delete(At,Vt)))})}static deleteAllOlderMessagesButKeepInitialWrite(At,xt,Bt,Nt,jt,Ut){return __awaiter$1$(this,void 0,void 0,function*(){const Lt=[];for(const Ht of xt){if(yield Message.isOlder(Ht,Bt)){yield StorageController.deleteFromDataStoreIfNeeded(jt,At,Ht,Bt);const zt=yield Message.getCid(Ht);if(yield Nt.delete(At,zt),yield RecordsWrite.isInitialWrite(Ht)){const Xt=yield(yield RecordsWrite.parse(Ht)).constructIndexes(!1),tr=Ht;delete tr.encodedData,yield Nt.put(At,tr,Xt)}else{const Jt=yield Message.getCid(Ht);Lt.push(Jt)}}yield Ut.deleteEventsByCid(At,Lt)}})}}var __awaiter$1_=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class RecordsWriteHandler{constructor(At,xt,Bt,Nt,jt){this.didResolver=At,this.messageStore=xt,this.dataStore=Bt,this.eventLog=Nt,this.eventStream=jt}handle({tenant:At,message:xt,dataStream:Bt}){return __awaiter$1_(this,void 0,void 0,function*(){let Nt;try{Nt=yield RecordsWrite.parse(xt),xt.descriptor.protocol!==void 0&&(yield ProtocolAuthorization.validateReferentialIntegrity(At,Nt,this.messageStore))}catch(Qt){return messageReplyFromError(Qt,400)}try{yield authenticate(xt.authorization,this.didResolver),yield RecordsWriteHandler.authorizeRecordsWrite(At,Nt,this.messageStore)}catch(Qt){return messageReplyFromError(Qt,401)}const jt={interface:DwnInterfaceName.Records,recordId:xt.recordId},{messages:Ut}=yield this.messageStore.query(At,[jt]),Lt=yield Nt.isInitialWrite();let Ht;if(!Lt)try{Ht=yield RecordsWrite.getInitialWrite(Ut),RecordsWrite.verifyEqualityOfImmutableProperties(Ht,xt)}catch(Qt){return messageReplyFromError(Qt,400)}const Vt=yield Message.getNewestMessage(Ut);let zt=!1,Wt;if(Vt===void 0||(yield Message.isNewer(xt,Vt))?(zt=!0,Wt=xt):Wt=Vt,!zt)return{status:{code:409,detail:"Conflict"}};try{if((Vt==null?void 0:Vt.descriptor.method)===DwnMethodName.Delete)throw new DwnError(DwnErrorCode.RecordsWriteNotAllowedAfterDelete,"RecordsWrite is not allowed after a RecordsDelete.");yield this.preProcessingForCoreRecordsWrite(At,xt);let Qt=!1,Xt=xt;if(Bt!==void 0)Xt=yield this.processMessageWithDataStream(At,xt,Bt),Qt=!0;else if(!Lt){const rr=Vt;Xt=yield this.processMessageWithoutDataStream(At,xt,rr),Qt=!0}const tr=yield Nt.constructIndexes(Qt);yield this.messageStore.put(At,Xt,tr),yield this.eventLog.append(At,yield Message.getCid(xt),tr),this.eventStream!==void 0&&Qt&&this.eventStream.emit(At,{message:xt,initialWrite:Ht},tr)}catch(Qt){const Xt=Qt;if(Xt.code!==void 0&&(Xt.code===DwnErrorCode.RecordsWriteMissingEncodedDataInPrevious||Xt.code===DwnErrorCode.RecordsWriteMissingDataInPrevious||Xt.code===DwnErrorCode.RecordsWriteNotAllowedAfterDelete||Xt.code===DwnErrorCode.RecordsWriteDataCidMismatch||Xt.code===DwnErrorCode.RecordsWriteDataSizeMismatch||Xt.code.startsWith("PermissionsProtocolValidate")||Xt.code.startsWith("SchemaValidator")))return messageReplyFromError(Qt,400);throw Qt}const Jt={status:Lt&&Bt===void 0?{code:204,detail:"No Content"}:{code:202,detail:"Accepted"}};return yield StorageController.deleteAllOlderMessagesButKeepInitialWrite(At,Ut,Wt,this.messageStore,this.dataStore,this.eventLog),yield this.postProcessingForCoreRecordsWrite(At,Nt),Jt})}preProcessingForCoreRecordsWrite(At,xt){var Bt;return __awaiter$1_(this,void 0,void 0,function*(){if(xt.descriptor.protocol===PermissionsProtocol.uri&&xt.descriptor.protocolPath===PermissionsProtocol.revocationPath){const Nt=xt.descriptor.parentId,jt=yield PermissionsProtocol.fetchGrant(At,this.messageStore,Nt),Ut=(Bt=xt.descriptor.tags)===null||Bt===void 0?void 0:Bt.protocol,Lt="protocol"in jt.scope?jt.scope.protocol:void 0;if(Lt!==Ut)throw new DwnError(DwnErrorCode.PermissionsProtocolValidateRevocationProtocolTagMismatch,`Revocation protocol ${Ut} does not match grant protocol ${Lt}`)}})}static validateSchemaForCoreRecordsWrite(At,xt){At.descriptor.protocol===PermissionsProtocol.uri&&PermissionsProtocol.validateSchema(At,xt)}postProcessingForCoreRecordsWrite(At,xt){return __awaiter$1_(this,void 0,void 0,function*(){if(xt.message.descriptor.protocol===PermissionsProtocol.uri&&xt.message.descriptor.protocolPath===PermissionsProtocol.revocationPath){const Nt={permissionGrantId:xt.message.descriptor.parentId,dateCreated:{gte:xt.message.descriptor.messageTimestamp}},{messages:jt}=yield this.messageStore.query(At,[Nt]),Ut=[];for(const Lt of jt){const Ht=yield Message.getCid(Lt);yield this.messageStore.delete(At,Ht)}this.eventLog.deleteEventsByCid(At,Ut)}})}cloneAndAddEncodedData(At,xt){return __awaiter$1_(this,void 0,void 0,function*(){const Bt=Object.assign({},At);return Bt.encodedData=Encoder$4.bytesToBase64Url(xt),Bt})}processMessageWithDataStream(At,xt,Bt){return __awaiter$1_(this,void 0,void 0,function*(){let Nt=xt;if(xt.descriptor.dataSize<=DwnConstant.maxDataSizeAllowedToBeEncoded){const jt=yield DataStream.toBytes(Bt),Ut=yield Cid.computeDagPbCidFromBytes(jt);RecordsWriteHandler.validateDataIntegrity(xt.descriptor.dataCid,xt.descriptor.dataSize,Ut,jt.length),RecordsWriteHandler.validateSchemaForCoreRecordsWrite(xt,jt),Nt=yield this.cloneAndAddEncodedData(xt,jt)}else{const[jt,Ut]=DataStream.duplicateDataStream(Bt,2);try{const[Lt,Ht]=yield Promise.all([Cid.computeDagPbCidFromStream(jt),this.dataStore.put(At,xt.recordId,xt.descriptor.dataCid,Ut)]);RecordsWriteHandler.validateDataIntegrity(xt.descriptor.dataCid,xt.descriptor.dataSize,Lt,Ht.dataSize)}catch(Lt){throw yield this.dataStore.delete(At,xt.recordId,xt.descriptor.dataCid),Lt}}return Nt})}processMessageWithoutDataStream(At,xt,Bt){return __awaiter$1_(this,void 0,void 0,function*(){const Nt=Object.assign({},xt),{dataCid:jt,dataSize:Ut}=xt.descriptor;if(RecordsWriteHandler.validateDataIntegrity(jt,Ut,Bt.descriptor.dataCid,Bt.descriptor.dataSize),Ut<=DwnConstant.maxDataSizeAllowedToBeEncoded)if(Bt.encodedData!==void 0)Nt.encodedData=Bt.encodedData;else throw new DwnError(DwnErrorCode.RecordsWriteMissingEncodedDataInPrevious,"No dataStream was provided and unable to get data from previous message");else if((yield this.dataStore.get(At,Bt.recordId,xt.descriptor.dataCid))===void 0)throw new DwnError(DwnErrorCode.RecordsWriteMissingDataInPrevious,"No dataStream was provided and unable to get data from previous message");return Nt})}static validateDataIntegrity(At,xt,Bt,Nt){if(At!==Bt)throw new DwnError(DwnErrorCode.RecordsWriteDataCidMismatch,`actual data CID ${Bt} does not match dataCid in descriptor: ${At}`);if(xt!==Nt)throw new DwnError(DwnErrorCode.RecordsWriteDataSizeMismatch,`actual data size ${Nt} bytes does not match dataSize in descriptor: ${xt}`)}static authorizeRecordsWrite(At,xt,Bt){return __awaiter$1_(this,void 0,void 0,function*(){if(xt.owner!==void 0&&xt.owner!==At)throw new DwnError(DwnErrorCode.RecordsWriteOwnerAndTenantMismatch,`Owner ${xt.owner} must be the same as tenant ${At} when specified.`);if(xt.isSignedByAuthorDelegate&&(yield xt.authorizeAuthorDelegate(Bt)),xt.isSignedByOwnerDelegate&&(yield xt.authorizeOwnerDelegate(Bt)),xt.owner===void 0){if(xt.author===At)return;if(xt.author!==void 0&&xt.signaturePayload.permissionGrantId!==void 0){const Nt=yield PermissionsProtocol.fetchGrant(At,Bt,xt.signaturePayload.permissionGrantId);yield RecordsGrantAuthorization.authorizeWrite({recordsWriteMessage:xt.message,expectedGrantor:At,expectedGrantee:xt.author,permissionGrant:Nt,messageStore:Bt})}else if(xt.message.descriptor.protocol!==void 0)yield ProtocolAuthorization.authorizeWrite(At,xt,Bt);else throw new DwnError(DwnErrorCode.RecordsWriteAuthorizationFailed,"message failed authorization")}})}}var DidVerificationRelationship$2;(function(kt){kt.authentication="authentication",kt.assertionMethod="assertionMethod",kt.keyAgreement="keyAgreement",kt.capabilityInvocation="capabilityInvocation",kt.capabilityDelegation="capabilityDelegation"})(DidVerificationRelationship$2||(DidVerificationRelationship$2={}));const EMPTY_DID_RESOLUTION_RESULT$2={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};let Did$2=class ds{constructor({method:At,id:xt,path:Bt,query:Nt,fragment:jt,params:Ut}){this.uri=`did:${At}:${xt}`,this.method=At,this.id=xt,this.path=Bt,this.query=Nt,this.fragment=jt,this.params=Ut}static parse(At){if(!At)return null;const xt=ds.DID_URI_PATTERN.exec(At);if(!xt||!xt.groups)return null;const{method:Bt,id:Nt,path:jt,query:Ut,fragment:Lt}=xt.groups,Ht={uri:`did:${Bt}:${Nt}`,method:Bt,id:Nt};if(jt&&(Ht.path=jt),Ut&&(Ht.query=Ut.slice(1)),Lt&&(Ht.fragment=Lt.slice(1)),Ut){const Vt={},zt=Ut.slice(1).split("&");for(const Wt of zt){const[Jt,Qt]=Wt.split("=");Vt[Jt]=Qt}Ht.params=Vt}return Ht}};Did$2.METHOD_PATTERN="([a-z0-9]+)";Did$2.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Did$2.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Did$2.PCT_ENCODED_PATTERN})`;Did$2.METHOD_ID_PATTERN=`((?:${Did$2.ID_CHAR_PATTERN}*:)*(${Did$2.ID_CHAR_PATTERN}+))`;Did$2.PATH_PATTERN="(/[^#?]*)?";Did$2.QUERY_PATTERN="([?][^#]*)?";Did$2.FRAGMENT_PATTERN="(#.*)?";Did$2.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Did$2.METHOD_PATTERN}):(?<id>${Did$2.METHOD_ID_PATTERN})(?<path>${Did$2.PATH_PATTERN})(?<query>${Did$2.QUERY_PATTERN})(?<fragment>${Did$2.FRAGMENT_PATTERN})$`);let DidError$2=class us extends Error{constructor(At,xt){super(`${At}: ${xt}`),this.code=At,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,us)}};var DidErrorCode$2;(function(kt){kt.InvalidDid="invalidDid",kt.MethodNotSupported="methodNotSupported",kt.InternalError="internalError",kt.InvalidDidDocument="invalidDidDocument",kt.InvalidDidDocumentLength="invalidDidDocumentLength",kt.InvalidDidUrl="invalidDidUrl",kt.InvalidPreviousDidProof="invalidPreviousDidProof",kt.InvalidPublicKey="invalidPublicKey",kt.InvalidPublicKeyLength="invalidPublicKeyLength",kt.InvalidPublicKeyType="invalidPublicKeyType",kt.InvalidSignature="invalidSignature",kt.NotFound="notFound",kt.RepresentationNotSupported="representationNotSupported",kt.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(DidErrorCode$2||(DidErrorCode$2={}));const perf=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,now=()=>perf.now(),isPosInt=kt=>kt&&kt===Math.floor(kt)&&kt>0&&isFinite(kt),isPosIntOrInf=kt=>kt===1/0||isPosInt(kt);class TTLCache{constructor({max:At=1/0,ttl:xt,updateAgeOnGet:Bt=!1,checkAgeOnGet:Nt=!1,noUpdateTTL:jt=!1,dispose:Ut,noDisposeOnSet:Lt=!1}={}){if(this.expirations=Object.create(null),this.data=new Map,this.expirationMap=new Map,xt!==void 0&&!isPosIntOrInf(xt))throw new TypeError("ttl must be positive integer or Infinity if set");if(!isPosIntOrInf(At))throw new TypeError("max must be positive integer or Infinity");if(this.ttl=xt,this.max=At,this.updateAgeOnGet=!!Bt,this.checkAgeOnGet=!!Nt,this.noUpdateTTL=!!jt,this.noDisposeOnSet=!!Lt,Ut!==void 0){if(typeof Ut!="function")throw new TypeError("dispose must be function if set");this.dispose=Ut}this.timer=void 0,this.timerExpiration=void 0}setTimer(At,xt){if(this.timerExpiration<At)return;this.timer&&clearTimeout(this.timer);const Bt=setTimeout(()=>{this.timer=void 0,this.timerExpiration=void 0,this.purgeStale();for(const Nt in this.expirations){this.setTimer(Nt,Nt-now());break}},xt);Bt.unref&&Bt.unref(),this.timerExpiration=At,this.timer=Bt}cancelTimer(){this.timer&&(clearTimeout(this.timer),this.timerExpiration=void 0,this.timer=void 0)}cancelTimers(){return process$9.emitWarning('TTLCache.cancelTimers has been renamed to TTLCache.cancelTimer (no "s"), and will be removed in the next major version update'),this.cancelTimer()}clear(){const At=this.dispose!==TTLCache.prototype.dispose?[...this]:[];this.data.clear(),this.expirationMap.clear(),this.cancelTimer(),this.expirations=Object.create(null);for(const[xt,Bt]of At)this.dispose(Bt,xt,"delete")}setTTL(At,xt=this.ttl){const Bt=this.expirationMap.get(At);if(Bt!==void 0){const Nt=this.expirations[Bt];!Nt||Nt.length<=1?delete this.expirations[Bt]:this.expirations[Bt]=Nt.filter(jt=>jt!==At)}if(xt!==1/0){const Nt=Math.floor(now()+xt);this.expirationMap.set(At,Nt),this.expirations[Nt]||(this.expirations[Nt]=[],this.setTimer(Nt,xt)),this.expirations[Nt].push(At)}else this.expirationMap.set(At,1/0)}set(At,xt,{ttl:Bt=this.ttl,noUpdateTTL:Nt=this.noUpdateTTL,noDisposeOnSet:jt=this.noDisposeOnSet}={}){if(!isPosIntOrInf(Bt))throw new TypeError("ttl must be positive integer or Infinity");if(this.expirationMap.has(At)){Nt||this.setTTL(At,Bt);const Ut=this.data.get(At);Ut!==xt&&(this.data.set(At,xt),jt||this.dispose(Ut,At,"set"))}else this.setTTL(At,Bt),this.data.set(At,xt);for(;this.size>this.max;)this.purgeToCapacity();return this}has(At){return this.data.has(At)}getRemainingTTL(At){const xt=this.expirationMap.get(At);return xt===1/0?xt:xt!==void 0?Math.max(0,Math.ceil(xt-now())):0}get(At,{updateAgeOnGet:xt=this.updateAgeOnGet,ttl:Bt=this.ttl,checkAgeOnGet:Nt=this.checkAgeOnGet}={}){const jt=this.data.get(At);if(Nt&&this.getRemainingTTL(At)===0){this.delete(At);return}return xt&&this.setTTL(At,Bt),jt}dispose(At,xt){}delete(At){const xt=this.expirationMap.get(At);if(xt!==void 0){const Bt=this.data.get(At);this.data.delete(At),this.expirationMap.delete(At);const Nt=this.expirations[xt];return Nt&&(Nt.length<=1?delete this.expirations[xt]:this.expirations[xt]=Nt.filter(jt=>jt!==At)),this.dispose(Bt,At,"delete"),this.size===0&&this.cancelTimer(),!0}return!1}purgeToCapacity(){for(const At in this.expirations){const xt=this.expirations[At];if(this.size-xt.length>=this.max){delete this.expirations[At];const Bt=[];for(const Nt of xt)Bt.push([Nt,this.data.get(Nt)]),this.data.delete(Nt),this.expirationMap.delete(Nt);for(const[Nt,jt]of Bt)this.dispose(jt,Nt,"evict")}else{const Bt=this.size-this.max,Nt=[];for(const jt of xt.splice(0,Bt))Nt.push([jt,this.data.get(jt)]),this.data.delete(jt),this.expirationMap.delete(jt);for(const[jt,Ut]of Nt)this.dispose(Ut,jt,"evict");return}}}get size(){return this.data.size}purgeStale(){const At=Math.ceil(now());for(const xt in this.expirations){if(xt==="Infinity"||xt>At)return;const Bt=[...this.expirations[xt]||[]],Nt=[];delete this.expirations[xt];for(const jt of Bt)Nt.push([jt,this.data.get(jt)]),this.data.delete(jt),this.expirationMap.delete(jt);for(const[jt,Ut]of Nt)this.dispose(Ut,jt,"stale")}this.size===0&&this.cancelTimer()}*entries(){for(const At in this.expirations)for(const xt of this.expirations[At])yield[xt,this.data.get(xt)]}*keys(){for(const At in this.expirations)for(const xt of this.expirations[At])yield xt}*values(){for(const At in this.expirations)for(const xt of this.expirations[At])yield this.data.get(xt)}[Symbol.iterator](){return this.entries()}}var ttlcache=TTLCache;const TtlCache=getDefaultExportFromCjs(ttlcache);function coerce(kt){if(kt instanceof Uint8Array&&kt.constructor.name==="Uint8Array")return kt;if(kt instanceof ArrayBuffer)return new Uint8Array(kt);if(ArrayBuffer.isView(kt))return new Uint8Array(kt.buffer,kt.byteOffset,kt.byteLength);throw new Error("Unknown type, must be binary type")}function base(kt,At){if(kt.length>=255)throw new TypeError("Alphabet too long");for(var xt=new Uint8Array(256),Bt=0;Bt<xt.length;Bt++)xt[Bt]=255;for(var Nt=0;Nt<kt.length;Nt++){var jt=kt.charAt(Nt),Ut=jt.charCodeAt(0);if(xt[Ut]!==255)throw new TypeError(jt+" is ambiguous");xt[Ut]=Nt}var Lt=kt.length,Ht=kt.charAt(0),Vt=Math.log(Lt)/Math.log(256),zt=Math.log(256)/Math.log(Lt);function Wt(Xt){if(Xt instanceof Uint8Array||(ArrayBuffer.isView(Xt)?Xt=new Uint8Array(Xt.buffer,Xt.byteOffset,Xt.byteLength):Array.isArray(Xt)&&(Xt=Uint8Array.from(Xt))),!(Xt instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Xt.length===0)return"";for(var tr=0,rr=0,nr=0,ar=Xt.length;nr!==ar&&Xt[nr]===0;)nr++,tr++;for(var ir=(ar-nr)*zt+1>>>0,lr=new Uint8Array(ir);nr!==ar;){for(var yr=Xt[nr],Sr=0,Ar=ir-1;(yr!==0||Sr<rr)&&Ar!==-1;Ar--,Sr++)yr+=256*lr[Ar]>>>0,lr[Ar]=yr%Lt>>>0,yr=yr/Lt>>>0;if(yr!==0)throw new Error("Non-zero carry");rr=Sr,nr++}for(var Dr=ir-rr;Dr!==ir&&lr[Dr]===0;)Dr++;for(var Br=Ht.repeat(tr);Dr<ir;++Dr)Br+=kt.charAt(lr[Dr]);return Br}function Jt(Xt){if(typeof Xt!="string")throw new TypeError("Expected String");if(Xt.length===0)return new Uint8Array;var tr=0;if(Xt[tr]!==" "){for(var rr=0,nr=0;Xt[tr]===Ht;)rr++,tr++;for(var ar=(Xt.length-tr)*Vt+1>>>0,ir=new Uint8Array(ar);Xt[tr];){var lr=xt[Xt.charCodeAt(tr)];if(lr===255)return;for(var yr=0,Sr=ar-1;(lr!==0||yr<nr)&&Sr!==-1;Sr--,yr++)lr+=Lt*ir[Sr]>>>0,ir[Sr]=lr%256>>>0,lr=lr/256>>>0;if(lr!==0)throw new Error("Non-zero carry");nr=yr,tr++}if(Xt[tr]!==" "){for(var Ar=ar-nr;Ar!==ar&&ir[Ar]===0;)Ar++;for(var Dr=new Uint8Array(rr+(ar-Ar)),Br=rr;Ar!==ar;)Dr[Br++]=ir[Ar++];return Dr}}}function Qt(Xt){var tr=Jt(Xt);if(tr)return tr;throw new Error(`Non-${At} character`)}return{encode:Wt,decodeUnsafe:Jt,decode:Qt}}var src=base,_brrp__multiformats_scope_baseX=src;let Encoder$1=class{name;prefix;baseEncode;constructor(At,xt,Bt){this.name=At,this.prefix=xt,this.baseEncode=Bt}encode(At){if(At instanceof Uint8Array)return`${this.prefix}${this.baseEncode(At)}`;throw Error("Unknown type, must be binary type")}};class Decoder{name;prefix;baseDecode;prefixCodePoint;constructor(At,xt,Bt){if(this.name=At,this.prefix=xt,xt.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=xt.codePointAt(0),this.baseDecode=Bt}decode(At){if(typeof At=="string"){if(At.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(At)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(At.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(At){return or(this,At)}}class ComposedDecoder{decoders;constructor(At){this.decoders=At}or(At){return or(this,At)}decode(At){const xt=At[0],Bt=this.decoders[xt];if(Bt!=null)return Bt.decode(At);throw RangeError(`Unable to decode multibase string ${JSON.stringify(At)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function or(kt,At){return new ComposedDecoder({...kt.decoders??{[kt.prefix]:kt},...At.decoders??{[At.prefix]:At}})}class Codec{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(At,xt,Bt,Nt){this.name=At,this.prefix=xt,this.baseEncode=Bt,this.baseDecode=Nt,this.encoder=new Encoder$1(At,xt,Bt),this.decoder=new Decoder(At,xt,Nt)}encode(At){return this.encoder.encode(At)}decode(At){return this.decoder.decode(At)}}function from$3({name:kt,prefix:At,encode:xt,decode:Bt}){return new Codec(kt,At,xt,Bt)}function baseX({name:kt,prefix:At,alphabet:xt}){const{encode:Bt,decode:Nt}=_brrp__multiformats_scope_baseX(xt,kt);return from$3({prefix:At,name:kt,encode:Bt,decode:jt=>coerce(Nt(jt))})}function decode$7(kt,At,xt,Bt){const Nt={};for(let zt=0;zt<At.length;++zt)Nt[At[zt]]=zt;let jt=kt.length;for(;kt[jt-1]==="=";)--jt;const Ut=new Uint8Array(jt*xt/8|0);let Lt=0,Ht=0,Vt=0;for(let zt=0;zt<jt;++zt){const Wt=Nt[kt[zt]];if(Wt===void 0)throw new SyntaxError(`Non-${Bt} character`);Ht=Ht<<xt|Wt,Lt+=xt,Lt>=8&&(Lt-=8,Ut[Vt++]=255&Ht>>Lt)}if(Lt>=xt||255&Ht<<8-Lt)throw new SyntaxError("Unexpected end of data");return Ut}function encode$7(kt,At,xt){const Bt=At[At.length-1]==="=",Nt=(1<<xt)-1;let jt="",Ut=0,Lt=0;for(let Ht=0;Ht<kt.length;++Ht)for(Lt=Lt<<8|kt[Ht],Ut+=8;Ut>xt;)Ut-=xt,jt+=At[Nt&Lt>>Ut];if(Ut!==0&&(jt+=At[Nt&Lt<<xt-Ut]),Bt)for(;jt.length*xt&7;)jt+="=";return jt}function rfc4648({name:kt,prefix:At,bitsPerChar:xt,alphabet:Bt}){return from$3({prefix:At,name:kt,encode(Nt){return encode$7(Nt,Bt,xt)},decode(Nt){return decode$7(Nt,Bt,xt,kt)}})}rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function isArrayBufferSlice$2(kt){return kt.byteOffset!==0||kt.byteLength!==kt.buffer.byteLength}function isAsyncIterable$7(kt){return typeof kt!="object"||kt===null?!1:typeof kt[Symbol.asyncIterator]=="function"}function universalTypeOf$2(kt){const xt=Object.prototype.toString.call(kt).match(/\s([a-zA-Z0-9]+)/),[Bt,Nt]=xt;return Nt}var __awaiter$1Z=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$8=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};const textEncoder$4=new TextEncoder,textDecoder$3=new TextDecoder;let Convert$2=class $i{constructor(At,xt){this.data=At,this.format=xt}static arrayBuffer(At){return new $i(At,"ArrayBuffer")}static asyncIterable(At){if(!isAsyncIterable$7(At))throw new TypeError("Input must be of type AsyncIterable.");return new $i(At,"AsyncIterable")}static base32Z(At){return new $i(At,"Base32Z")}static base58Btc(At){return new $i(At,"Base58Btc")}static base64Url(At){return new $i(At,"Base64Url")}static bufferSource(At){return new $i(At,"BufferSource")}static hex(At){if(typeof At!="string")throw new TypeError("Hex input must be a string.");if(At.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new $i(At,"Hex")}static multibase(At){return new $i(At,"Multibase")}static object(At){return new $i(At,"Object")}static string(At){return new $i(At,"String")}static uint8Array(At){return new $i(At,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return base58btc.baseDecode(this.data).buffer;case"Base64Url":return base64url.baseDecode(this.data).buffer;case"BufferSource":{if(universalTypeOf$2(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return isArrayBufferSlice$2(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return __awaiter$1Z(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return base32z.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const At=new Uint8Array(this.data);return base58btc.baseEncode(At)}case"Multibase":return this.data.substring(1);case"Uint8Array":return base58btc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const At=new Uint8Array(this.data);return base64url.baseEncode(At)}case"BufferSource":{const At=this.toUint8Array();return base64url.baseEncode(At)}case"Object":{const At=JSON.stringify(this.data),xt=textEncoder$4.encode(At);return base64url.baseEncode(xt)}case"String":{const At=textEncoder$4.encode(this.data);return base64url.baseEncode(At)}case"Uint8Array":return base64url.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return __awaiter$1Z(this,void 0,void 0,function*(){var At,xt,Bt,Nt;switch(this.format){case"AsyncIterable":{const Ht=[];try{for(var jt=!0,Ut=__asyncValues$8(this.data),Lt;Lt=yield Ut.next(),At=Lt.done,!At;jt=!0){Nt=Lt.value,jt=!1;const zt=Nt;Ht.push(zt)}}catch(zt){xt={error:zt}}finally{try{!jt&&!At&&(Bt=Ut.return)&&(yield Bt.call(Ut))}finally{if(xt)throw xt.error}}return new Blob(Ht)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const At=Array.from({length:256},(xt,Bt)=>Bt.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const xt=this.toUint8Array();return $i.uint8Array(xt).toHex()}case"Base64Url":{const xt=this.toUint8Array();return $i.uint8Array(xt).toHex()}case"Uint8Array":{let xt="";for(let Bt=0;Bt<this.data.length;Bt++)xt+=At[this.data[Bt]];return xt}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const At=base64url.baseDecode(this.data),xt=textDecoder$3.decode(At);return JSON.parse(xt)}case"String":return JSON.parse(this.data);case"Uint8Array":{const At=textDecoder$3.decode(this.data);return JSON.parse(At)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return __awaiter$1Z(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const At=yield this.toStringAsync();return JSON.parse(At)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return textDecoder$3.decode(this.data);case"Base64Url":{const At=base64url.baseDecode(this.data);return textDecoder$3.decode(At)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return textDecoder$3.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return __awaiter$1Z(this,void 0,void 0,function*(){var At,xt,Bt,Nt;switch(this.format){case"AsyncIterable":{let Ht="";try{for(var jt=!0,Ut=__asyncValues$8(this.data),Lt;Lt=yield Ut.next(),At=Lt.done,!At;jt=!0){Nt=Lt.value,jt=!1;const Vt=Nt;typeof Vt=="string"?Ht+=Vt:Ht+=textDecoder$3.decode(Vt,{stream:!0})}}catch(Vt){xt={error:Vt}}finally{try{!jt&&!At&&(Bt=Ut.return)&&(yield Bt.call(Ut))}finally{if(xt)throw xt.error}}return Ht+=textDecoder$3.decode(void 0,{stream:!1}),Ht}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return base32z.baseDecode(this.data);case"Base58Btc":return base58btc.baseDecode(this.data);case"Base64Url":return base64url.baseDecode(this.data);case"BufferSource":{const At=universalTypeOf$2(this.data);if(At==="Uint8Array")return this.data;if(At==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const At=new Uint8Array(this.data.length/2);for(let xt=0;xt<this.data.length;xt+=2){const Bt=parseInt(this.data.substring(xt,xt+2),16);if(isNaN(Bt))throw new TypeError("Input is not a valid hexadecimal string.");At[xt/2]=Bt}return At}case"Object":{const At=JSON.stringify(this.data);return textEncoder$4.encode(At)}case"String":return textEncoder$4.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return __awaiter$1Z(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const At=yield this.toArrayBufferAsync();return new Uint8Array(At)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var encode_1=encode$6,MSB=128,REST=127,MSBALL=~REST,INT=Math.pow(2,31);function encode$6(kt,At,xt){At=At||[],xt=xt||0;for(var Bt=xt;kt>=INT;)At[xt++]=kt&255|MSB,kt/=128;for(;kt&MSBALL;)At[xt++]=kt&255|MSB,kt>>>=7;return At[xt]=kt|0,encode$6.bytes=xt-Bt+1,At}var decode$6=read,MSB$1=128,REST$1=127;function read(kt,Bt){var xt=0,Bt=Bt||0,Nt=0,jt=Bt,Ut,Lt=kt.length;do{if(jt>=Lt)throw read.bytes=0,new RangeError("Could not decode varint");Ut=kt[jt++],xt+=Nt<28?(Ut&REST$1)<<Nt:(Ut&REST$1)*Math.pow(2,Nt),Nt+=7}while(Ut>=MSB$1);return read.bytes=jt-Bt,xt}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(kt){return kt<N1?1:kt<N2?2:kt<N3?3:kt<N4?4:kt<N5?5:kt<N6?6:kt<N7?7:kt<N8?8:kt<N9?9:10},varint={encode:encode_1,decode:decode$6,encodingLength:length},_brrp_varint=varint;function decode$5(kt,At=0){return[_brrp_varint.decode(kt,At),_brrp_varint.decode.bytes]}function encodeTo(kt,At,xt=0){return _brrp_varint.encode(kt,At,xt),At}function encodingLength$4(kt){return _brrp_varint.encodingLength(kt)}let Multicodec$2=class Ji{static addPrefix(At){var xt;let{code:Bt,data:Nt,name:jt}=At;if(!(jt?!Bt:Bt))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(Bt=Ji.codeToName.has(Bt)?Bt:Ji.nameToCode.get(jt),Bt===void 0)throw new Error(`Unsupported multicodec: ${(xt=At.name)!==null&&xt!==void 0?xt:At.code}`);const Ut=encodingLength$4(Bt),Lt=new Uint8Array(Ut+Nt.byteLength);return Lt.set(Nt,Ut),encodeTo(Bt,Lt),Lt}static getCodeFromData(At){const{prefixedData:xt}=At,[Bt,Nt]=decode$5(xt);return Bt}static getCodeFromName(At){const{name:xt}=At,Bt=Ji.nameToCode.get(xt);if(Bt===void 0)throw new Error(`Unsupported multicodec: ${xt}`);return Bt}static getNameFromCode(At){const{code:xt}=At,Bt=Ji.codeToName.get(xt);if(Bt===void 0)throw new Error(`Unsupported multicodec: ${xt}`);return Bt}static registerCodec(At){Ji.codeToName.set(At.code,At.name),Ji.nameToCode.set(At.name,At.code)}static removePrefix(At){const{prefixedData:xt}=At,[Bt,Nt]=decode$5(xt),jt=Ji.codeToName.get(Bt);if(jt===void 0)throw new Error(`Unsupported multicodec: ${Bt}`);return{code:Bt,data:xt.slice(Nt),name:jt}}};Multicodec$2.codeToName=new Map;Multicodec$2.nameToCode=new Map;Multicodec$2.registerCodec({code:237,name:"ed25519-pub"});Multicodec$2.registerCodec({code:4864,name:"ed25519-priv"});Multicodec$2.registerCodec({code:236,name:"x25519-pub"});Multicodec$2.registerCodec({code:4866,name:"x25519-priv"});Multicodec$2.registerCodec({code:231,name:"secp256k1-pub"});Multicodec$2.registerCodec({code:4865,name:"secp256k1-priv"});function removeUndefinedProperties$1(kt){Object.keys(kt).forEach(At=>{kt[At]===void 0?delete kt[At]:typeof kt[At]=="object"&&removeUndefinedProperties$1(kt[At])})}var browserLevel={},abstractLevel$1={},abstractLevel={},levelSupports={};levelSupports.supports=function kt(...At){const xt=At.reduce((Bt,Nt)=>Object.assign(Bt,Nt),{});return Object.assign(xt,{snapshots:xt.snapshots||!1,permanence:xt.permanence||!1,seek:xt.seek||!1,clear:xt.clear||!1,getMany:xt.getMany||!1,keyIterator:xt.keyIterator||!1,valueIterator:xt.valueIterator||!1,iteratorNextv:xt.iteratorNextv||!1,iteratorAll:xt.iteratorAll||!1,status:xt.status||!1,createIfMissing:xt.createIfMissing||!1,errorIfExists:xt.errorIfExists||!1,deferredOpen:xt.deferredOpen||!1,promises:xt.promises||!1,streams:xt.streams||!1,encodings:Object.assign({},xt.encodings),events:Object.assign({},xt.events),additionalMethods:Object.assign({},xt.additionalMethods)})};var levelTranscoder={},moduleError=class extends Error{constructor(At,xt){super(At||""),typeof xt=="object"&&xt!==null&&(xt.code&&(this.code=String(xt.code)),xt.expected&&(this.expected=!0),xt.transient&&(this.transient=!0),xt.cause&&(this.cause=xt.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},encodings$1={};let lazy=null;var textEndec$1=function(){return lazy===null&&(lazy={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),lazy},formats$2={},encoding={};const ModuleError$8=moduleError,formats$1=new Set(["buffer","view","utf8"]);let Encoding$2=class{constructor(At){if(this.encode=At.encode||this.encode,this.decode=At.decode||this.decode,this.name=At.name||this.name,this.format=At.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!formats$1.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");At.createViewTranscoder&&(this.createViewTranscoder=At.createViewTranscoder),At.createBufferTranscoder&&(this.createBufferTranscoder=At.createBufferTranscoder),At.createUTF8Transcoder&&(this.createUTF8Transcoder=At.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};encoding.Encoding=Encoding$2;const{Buffer:Buffer$3}=buffer$2||{},{Encoding:Encoding$1}=encoding,textEndec=textEndec$1;let BufferFormat$2=class extends Encoding$1{constructor(At){super({...At,format:"buffer"})}createViewTranscoder(){return new ViewFormat$2({encode:this.encode,decode:At=>this.decode(Buffer$3.from(At.buffer,At.byteOffset,At.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ViewFormat$2=class extends Encoding$1{constructor(At){super({...At,format:"view"})}createBufferTranscoder(){return new BufferFormat$2({encode:At=>{const xt=this.encode(At);return Buffer$3.from(xt.buffer,xt.byteOffset,xt.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},UTF8Format$2=class extends Encoding$1{constructor(At){super({...At,format:"utf8"})}createBufferTranscoder(){return new BufferFormat$2({encode:At=>Buffer$3.from(this.encode(At),"utf8"),decode:At=>this.decode(At.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:At,textDecoder:xt}=textEndec();return new ViewFormat$2({encode:Bt=>At.encode(this.encode(Bt)),decode:Bt=>this.decode(xt.decode(Bt)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};formats$2.BufferFormat=BufferFormat$2;formats$2.ViewFormat=ViewFormat$2;formats$2.UTF8Format=UTF8Format$2;const{Buffer:Buffer$2}=buffer$2||{Buffer:{isBuffer:()=>!1}},{textEncoder:textEncoder$3,textDecoder:textDecoder$2}=textEndec$1(),{BufferFormat:BufferFormat$1,ViewFormat:ViewFormat$1,UTF8Format:UTF8Format$1}=formats$2,identity$1=kt=>kt;encodings$1.utf8=new UTF8Format$1({encode:function(kt){return Buffer$2.isBuffer(kt)?kt.toString("utf8"):ArrayBuffer.isView(kt)?textDecoder$2.decode(kt):String(kt)},decode:identity$1,name:"utf8",createViewTranscoder(){return new ViewFormat$1({encode:function(kt){return ArrayBuffer.isView(kt)?kt:textEncoder$3.encode(kt)},decode:function(kt){return textDecoder$2.decode(kt)},name:`${this.name}+view`})},createBufferTranscoder(){return new BufferFormat$1({encode:function(kt){return Buffer$2.isBuffer(kt)?kt:ArrayBuffer.isView(kt)?Buffer$2.from(kt.buffer,kt.byteOffset,kt.byteLength):Buffer$2.from(String(kt),"utf8")},decode:function(kt){return kt.toString("utf8")},name:`${this.name}+buffer`})}});encodings$1.json=new UTF8Format$1({encode:JSON.stringify,decode:JSON.parse,name:"json"});encodings$1.buffer=new BufferFormat$1({encode:function(kt){return Buffer$2.isBuffer(kt)?kt:ArrayBuffer.isView(kt)?Buffer$2.from(kt.buffer,kt.byteOffset,kt.byteLength):Buffer$2.from(String(kt),"utf8")},decode:identity$1,name:"buffer",createViewTranscoder(){return new ViewFormat$1({encode:function(kt){return ArrayBuffer.isView(kt)?kt:Buffer$2.from(String(kt),"utf8")},decode:function(kt){return Buffer$2.from(kt.buffer,kt.byteOffset,kt.byteLength)},name:`${this.name}+view`})}});encodings$1.view=new ViewFormat$1({encode:function(kt){return ArrayBuffer.isView(kt)?kt:textEncoder$3.encode(kt)},decode:identity$1,name:"view",createBufferTranscoder(){return new BufferFormat$1({encode:function(kt){return Buffer$2.isBuffer(kt)?kt:ArrayBuffer.isView(kt)?Buffer$2.from(kt.buffer,kt.byteOffset,kt.byteLength):Buffer$2.from(String(kt),"utf8")},decode:identity$1,name:`${this.name}+buffer`})}});encodings$1.hex=new BufferFormat$1({encode:function(kt){return Buffer$2.isBuffer(kt)?kt:Buffer$2.from(String(kt),"hex")},decode:function(kt){return kt.toString("hex")},name:"hex"});encodings$1.base64=new BufferFormat$1({encode:function(kt){return Buffer$2.isBuffer(kt)?kt:Buffer$2.from(String(kt),"base64")},decode:function(kt){return kt.toString("base64")},name:"base64"});const ModuleError$7=moduleError,encodings=encodings$1,{Encoding}=encoding,{BufferFormat,ViewFormat,UTF8Format}=formats$2,kFormats=Symbol("formats"),kEncodings=Symbol("encodings"),validFormats=new Set(["buffer","view","utf8"]);let Transcoder$1=class{constructor(At){if(Array.isArray(At)){if(!At.every(xt=>validFormats.has(xt)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[kEncodings]=new Map,this[kFormats]=new Set(At);for(const xt in encodings)try{this.encoding(xt)}catch(Bt){if(Bt.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw Bt}}encodings(){return Array.from(new Set(this[kEncodings].values()))}encoding(At){let xt=this[kEncodings].get(At);if(xt===void 0){if(typeof At=="string"&&At!==""){if(xt=lookup$1[At],!xt)throw new ModuleError$7(`Encoding '${At}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof At!="object"||At===null)throw new TypeError("First argument 'encoding' must be a string or object");xt=from$2(At)}const{name:Bt,format:Nt}=xt;if(!this[kFormats].has(Nt))if(this[kFormats].has("view"))xt=xt.createViewTranscoder();else if(this[kFormats].has("buffer"))xt=xt.createBufferTranscoder();else if(this[kFormats].has("utf8"))xt=xt.createUTF8Transcoder();else throw new ModuleError$7(`Encoding '${Bt}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const jt of[At,Bt,xt.name,xt.commonName])this[kEncodings].set(jt,xt)}return xt}};levelTranscoder.Transcoder=Transcoder$1;function from$2(kt){if(kt instanceof Encoding)return kt;const At="type"in kt&&typeof kt.type=="string"?kt.type:void 0,xt=kt.name||At||`anonymous-${anonymousCount++}`;switch(detectFormat(kt)){case"view":return new ViewFormat({...kt,name:xt});case"utf8":return new UTF8Format({...kt,name:xt});case"buffer":return new BufferFormat({...kt,name:xt});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function detectFormat(kt){return"format"in kt&&kt.format!==void 0?kt.format:"buffer"in kt&&typeof kt.buffer=="boolean"?kt.buffer?"buffer":"utf8":"code"in kt&&Number.isInteger(kt.code)?"view":"buffer"}const aliases={binary:encodings.buffer,"utf-8":encodings.utf8},lookup$1={...encodings,...aliases};let anonymousCount=0;var catering={},nextTickBrowser$1=typeof queueMicrotask=="function"?queueMicrotask:kt=>Promise.resolve().then(kt),nextTick$1=nextTickBrowser$1;catering.fromCallback=function(kt,At){if(kt===void 0){var xt=new Promise(function(Bt,Nt){kt=function(jt,Ut){jt?Nt(jt):Bt(Ut)}});kt[At!==void 0?At:"promise"]=xt}else if(typeof kt!="function")throw new TypeError("Callback must be a function");return kt};catering.fromPromise=function(kt,At){if(At===void 0)return kt;kt.then(function(xt){nextTick$1(()=>At(null,xt))}).catch(function(xt){nextTick$1(()=>At(xt))})};var abstractIterator={},common={};common.getCallback=function(kt,At){return typeof kt=="function"?kt:At};common.getOptions=function(kt,At){return typeof kt=="object"&&kt!==null?kt:At!==void 0?At:{}};const{fromCallback:fromCallback$3}=catering,ModuleError$6=moduleError,{getOptions:getOptions$2,getCallback:getCallback$2}=common,kPromise$3=Symbol("promise"),kCallback$2=Symbol("callback"),kWorking=Symbol("working"),kHandleOne$1=Symbol("handleOne"),kHandleMany$1=Symbol("handleMany"),kAutoClose=Symbol("autoClose"),kFinishWork=Symbol("finishWork"),kReturnMany=Symbol("returnMany"),kClosing=Symbol("closing"),kHandleClose=Symbol("handleClose"),kClosed=Symbol("closed"),kCloseCallbacks$1=Symbol("closeCallbacks"),kKeyEncoding$1=Symbol("keyEncoding"),kValueEncoding$1=Symbol("valueEncoding"),kAbortOnClose=Symbol("abortOnClose"),kLegacy=Symbol("legacy"),kKeys=Symbol("keys"),kValues=Symbol("values"),kLimit=Symbol("limit"),kCount=Symbol("count"),emptyOptions$1=Object.freeze({}),noop$1=()=>{};let warnedEnd=!1;class CommonIterator{constructor(At,xt,Bt){if(typeof At!="object"||At===null){const Nt=At===null?"null":typeof At;throw new TypeError(`The first argument must be an abstract-level database, received ${Nt}`)}if(typeof xt!="object"||xt===null)throw new TypeError("The second argument must be an options object");this[kClosed]=!1,this[kCloseCallbacks$1]=[],this[kWorking]=!1,this[kClosing]=!1,this[kAutoClose]=!1,this[kCallback$2]=null,this[kHandleOne$1]=this[kHandleOne$1].bind(this),this[kHandleMany$1]=this[kHandleMany$1].bind(this),this[kHandleClose]=this[kHandleClose].bind(this),this[kKeyEncoding$1]=xt[kKeyEncoding$1],this[kValueEncoding$1]=xt[kValueEncoding$1],this[kLegacy]=Bt,this[kLimit]=Number.isInteger(xt.limit)&&xt.limit>=0?xt.limit:1/0,this[kCount]=0,this[kAbortOnClose]=!!xt.abortOnClose,this.db=At,this.db.attachResource(this),this.nextTick=At.nextTick}get count(){return this[kCount]}get limit(){return this[kLimit]}next(At){let xt;if(At===void 0)xt=new Promise((Bt,Nt)=>{At=(jt,Ut,Lt)=>{jt?Nt(jt):this[kLegacy]?Ut===void 0&&Lt===void 0?Bt():Bt([Ut,Lt]):Bt(Ut)}});else if(typeof At!="function")throw new TypeError("Callback must be a function");return this[kClosing]?this.nextTick(At,new ModuleError$6("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(At,new ModuleError$6("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$2]=At,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleOne$1],null):this._next(this[kHandleOne$1])),xt}_next(At){this.nextTick(At)}nextv(At,xt,Bt){return Bt=getCallback$2(xt,Bt),Bt=fromCallback$3(Bt,kPromise$3),xt=getOptions$2(xt,emptyOptions$1),Number.isInteger(At)?(this[kClosing]?this.nextTick(Bt,new ModuleError$6("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(Bt,new ModuleError$6("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(At<1&&(At=1),this[kLimit]<1/0&&(At=Math.min(At,this[kLimit]-this[kCount])),this[kWorking]=!0,this[kCallback$2]=Bt,At<=0?this.nextTick(this[kHandleMany$1],null,[]):this._nextv(At,xt,this[kHandleMany$1])),Bt[kPromise$3]):(this.nextTick(Bt,new TypeError("The first argument 'size' must be an integer")),Bt[kPromise$3])}_nextv(At,xt,Bt){const Nt=[],jt=(Ut,Lt,Ht)=>{if(Ut)return Bt(Ut);if(this[kLegacy]?Lt===void 0&&Ht===void 0:Lt===void 0)return Bt(null,Nt);Nt.push(this[kLegacy]?[Lt,Ht]:Lt),Nt.length===At?Bt(null,Nt):this._next(jt)};this._next(jt)}all(At,xt){return xt=getCallback$2(At,xt),xt=fromCallback$3(xt,kPromise$3),At=getOptions$2(At,emptyOptions$1),this[kClosing]?this.nextTick(xt,new ModuleError$6("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(xt,new ModuleError$6("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$2]=xt,this[kAutoClose]=!0,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleMany$1],null,[]):this._all(At,this[kHandleMany$1])),xt[kPromise$3]}_all(At,xt){let Bt=this[kCount];const Nt=[],jt=()=>{const Lt=this[kLimit]<1/0?Math.min(1e3,this[kLimit]-Bt):1e3;Lt<=0?this.nextTick(xt,null,Nt):this._nextv(Lt,emptyOptions$1,Ut)},Ut=(Lt,Ht)=>{Lt?xt(Lt):Ht.length===0?xt(null,Nt):(Nt.push.apply(Nt,Ht),Bt+=Ht.length,jt())};jt()}[kFinishWork](){const At=this[kCallback$2];return this[kAbortOnClose]&&At===null?noop$1:(this[kWorking]=!1,this[kCallback$2]=null,this[kClosing]&&this._close(this[kHandleClose]),At)}[kReturnMany](At,xt,Bt){this[kAutoClose]?this.close(At.bind(null,xt,Bt)):At(xt,Bt)}seek(At,xt){if(xt=getOptions$2(xt,emptyOptions$1),!this[kClosing]){if(this[kWorking])throw new ModuleError$6("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const Bt=this.db.keyEncoding(xt.keyEncoding||this[kKeyEncoding$1]),Nt=Bt.format;xt.keyEncoding!==Nt&&(xt={...xt,keyEncoding:Nt});const jt=this.db.prefixKey(Bt.encode(At),Nt);this._seek(jt,xt)}}}_seek(At,xt){throw new ModuleError$6("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(At){return At=fromCallback$3(At,kPromise$3),this[kClosed]?this.nextTick(At):this[kClosing]?this[kCloseCallbacks$1].push(At):(this[kClosing]=!0,this[kCloseCallbacks$1].push(At),this[kWorking]?this[kAbortOnClose]&&this[kFinishWork]()(new ModuleError$6("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[kHandleClose])),At[kPromise$3]}_close(At){this.nextTick(At)}[kHandleClose](){this[kClosed]=!0,this.db.detachResource(this);const At=this[kCloseCallbacks$1];this[kCloseCallbacks$1]=[];for(const xt of At)xt()}async*[Symbol.asyncIterator](){try{let At;for(;(At=await this.next())!==void 0;)yield At}finally{this[kClosed]||await this.close()}}}let AbstractIterator$3=class extends CommonIterator{constructor(At,xt){super(At,xt,!0),this[kKeys]=xt.keys!==!1,this[kValues]=xt.values!==!1}[kHandleOne$1](At,xt,Bt){const Nt=this[kFinishWork]();if(At)return Nt(At);try{xt=this[kKeys]&&xt!==void 0?this[kKeyEncoding$1].decode(xt):void 0,Bt=this[kValues]&&Bt!==void 0?this[kValueEncoding$1].decode(Bt):void 0}catch(jt){return Nt(new IteratorDecodeError("entry",jt))}xt===void 0&&Bt===void 0||this[kCount]++,Nt(null,xt,Bt)}[kHandleMany$1](At,xt){const Bt=this[kFinishWork]();if(At)return this[kReturnMany](Bt,At);try{for(const Nt of xt){const jt=Nt[0],Ut=Nt[1];Nt[0]=this[kKeys]&&jt!==void 0?this[kKeyEncoding$1].decode(jt):void 0,Nt[1]=this[kValues]&&Ut!==void 0?this[kValueEncoding$1].decode(Ut):void 0}}catch(Nt){return this[kReturnMany](Bt,new IteratorDecodeError("entries",Nt))}this[kCount]+=xt.length,this[kReturnMany](Bt,null,xt)}end(At){return!warnedEnd&&typeof console<"u"&&(warnedEnd=!0,console.warn(new ModuleError$6("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(At)}},AbstractKeyIterator$2=class extends CommonIterator{constructor(At,xt){super(At,xt,!1)}[kHandleOne$1](At,xt){const Bt=this[kFinishWork]();if(At)return Bt(At);try{xt=xt!==void 0?this[kKeyEncoding$1].decode(xt):void 0}catch(Nt){return Bt(new IteratorDecodeError("key",Nt))}xt!==void 0&&this[kCount]++,Bt(null,xt)}[kHandleMany$1](At,xt){const Bt=this[kFinishWork]();if(At)return this[kReturnMany](Bt,At);try{for(let Nt=0;Nt<xt.length;Nt++){const jt=xt[Nt];xt[Nt]=jt!==void 0?this[kKeyEncoding$1].decode(jt):void 0}}catch(Nt){return this[kReturnMany](Bt,new IteratorDecodeError("keys",Nt))}this[kCount]+=xt.length,this[kReturnMany](Bt,null,xt)}},AbstractValueIterator$2=class extends CommonIterator{constructor(At,xt){super(At,xt,!1)}[kHandleOne$1](At,xt){const Bt=this[kFinishWork]();if(At)return Bt(At);try{xt=xt!==void 0?this[kValueEncoding$1].decode(xt):void 0}catch(Nt){return Bt(new IteratorDecodeError("value",Nt))}xt!==void 0&&this[kCount]++,Bt(null,xt)}[kHandleMany$1](At,xt){const Bt=this[kFinishWork]();if(At)return this[kReturnMany](Bt,At);try{for(let Nt=0;Nt<xt.length;Nt++){const jt=xt[Nt];xt[Nt]=jt!==void 0?this[kValueEncoding$1].decode(jt):void 0}}catch(Nt){return this[kReturnMany](Bt,new IteratorDecodeError("values",Nt))}this[kCount]+=xt.length,this[kReturnMany](Bt,null,xt)}};class IteratorDecodeError extends ModuleError$6{constructor(At,xt){super(`Iterator could not decode ${At}`,{code:"LEVEL_DECODE_ERROR",cause:xt})}}for(const kt of["_ended property","_nexting property","_end method"])Object.defineProperty(AbstractIterator$3.prototype,kt.split(" ")[0],{get(){throw new ModuleError$6(`The ${kt} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new ModuleError$6(`The ${kt} has been removed`,{code:"LEVEL_LEGACY"})}});AbstractIterator$3.keyEncoding=kKeyEncoding$1;AbstractIterator$3.valueEncoding=kValueEncoding$1;abstractIterator.AbstractIterator=AbstractIterator$3;abstractIterator.AbstractKeyIterator=AbstractKeyIterator$2;abstractIterator.AbstractValueIterator=AbstractValueIterator$2;var defaultKvIterator={};const{AbstractKeyIterator:AbstractKeyIterator$1,AbstractValueIterator:AbstractValueIterator$1}=abstractIterator,kIterator=Symbol("iterator"),kCallback$1=Symbol("callback"),kHandleOne=Symbol("handleOne"),kHandleMany=Symbol("handleMany");let DefaultKeyIterator$1=class extends AbstractKeyIterator$1{constructor(At,xt){super(At,xt),this[kIterator]=At.iterator({...xt,keys:!0,values:!1}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}},DefaultValueIterator$1=class extends AbstractValueIterator$1{constructor(At,xt){super(At,xt),this[kIterator]=At.iterator({...xt,keys:!1,values:!0}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}};for(const kt of[DefaultKeyIterator$1,DefaultValueIterator$1]){const At=kt===DefaultKeyIterator$1,xt=At?Bt=>Bt[0]:Bt=>Bt[1];kt.prototype._next=function(Bt){this[kCallback$1]=Bt,this[kIterator].next(this[kHandleOne])},kt.prototype[kHandleOne]=function(Bt,Nt,jt){const Ut=this[kCallback$1];Bt?Ut(Bt):Ut(null,At?Nt:jt)},kt.prototype._nextv=function(Bt,Nt,jt){this[kCallback$1]=jt,this[kIterator].nextv(Bt,Nt,this[kHandleMany])},kt.prototype._all=function(Bt,Nt){this[kCallback$1]=Nt,this[kIterator].all(Bt,this[kHandleMany])},kt.prototype[kHandleMany]=function(Bt,Nt){const jt=this[kCallback$1];Bt?jt(Bt):jt(null,Nt.map(xt))},kt.prototype._seek=function(Bt,Nt){this[kIterator].seek(Bt,Nt)},kt.prototype._close=function(Bt){this[kIterator].close(Bt)}}defaultKvIterator.DefaultKeyIterator=DefaultKeyIterator$1;defaultKvIterator.DefaultValueIterator=DefaultValueIterator$1;var deferredIterator={};const{AbstractIterator:AbstractIterator$2,AbstractKeyIterator,AbstractValueIterator}=abstractIterator,ModuleError$5=moduleError,kNut=Symbol("nut"),kUndefer$1=Symbol("undefer"),kFactory=Symbol("factory");let DeferredIterator$1=class extends AbstractIterator$2{constructor(At,xt){super(At,xt),this[kNut]=null,this[kFactory]=()=>At.iterator(xt),this.db.defer(()=>this[kUndefer$1]())}},DeferredKeyIterator$1=class extends AbstractKeyIterator{constructor(At,xt){super(At,xt),this[kNut]=null,this[kFactory]=()=>At.keys(xt),this.db.defer(()=>this[kUndefer$1]())}},DeferredValueIterator$1=class extends AbstractValueIterator{constructor(At,xt){super(At,xt),this[kNut]=null,this[kFactory]=()=>At.values(xt),this.db.defer(()=>this[kUndefer$1]())}};for(const kt of[DeferredIterator$1,DeferredKeyIterator$1,DeferredValueIterator$1])kt.prototype[kUndefer$1]=function(){this.db.status==="open"&&(this[kNut]=this[kFactory]())},kt.prototype._next=function(At){this[kNut]!==null?this[kNut].next(At):this.db.status==="opening"?this.db.defer(()=>this._next(At)):this.nextTick(At,new ModuleError$5("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},kt.prototype._nextv=function(At,xt,Bt){this[kNut]!==null?this[kNut].nextv(At,xt,Bt):this.db.status==="opening"?this.db.defer(()=>this._nextv(At,xt,Bt)):this.nextTick(Bt,new ModuleError$5("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},kt.prototype._all=function(At,xt){this[kNut]!==null?this[kNut].all(xt):this.db.status==="opening"?this.db.defer(()=>this._all(At,xt)):this.nextTick(xt,new ModuleError$5("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},kt.prototype._seek=function(At,xt){this[kNut]!==null?this[kNut]._seek(At,xt):this.db.status==="opening"&&this.db.defer(()=>this._seek(At,xt))},kt.prototype._close=function(At){this[kNut]!==null?this[kNut].close(At):this.db.status==="opening"?this.db.defer(()=>this._close(At)):this.nextTick(At)};deferredIterator.DeferredIterator=DeferredIterator$1;deferredIterator.DeferredKeyIterator=DeferredKeyIterator$1;deferredIterator.DeferredValueIterator=DeferredValueIterator$1;var defaultChainedBatch={},abstractChainedBatch={};const{fromCallback:fromCallback$2}=catering,ModuleError$4=moduleError,{getCallback:getCallback$1,getOptions:getOptions$1}=common,kPromise$2=Symbol("promise"),kStatus$1=Symbol("status"),kOperations$1=Symbol("operations"),kFinishClose=Symbol("finishClose"),kCloseCallbacks=Symbol("closeCallbacks");let AbstractChainedBatch$1=class{constructor(At){if(typeof At!="object"||At===null){const xt=At===null?"null":typeof At;throw new TypeError(`The first argument must be an abstract-level database, received ${xt}`)}this[kOperations$1]=[],this[kCloseCallbacks]=[],this[kStatus$1]="open",this[kFinishClose]=this[kFinishClose].bind(this),this.db=At,this.db.attachResource(this),this.nextTick=At.nextTick}get length(){return this[kOperations$1].length}put(At,xt,Bt){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const Nt=this.db._checkKey(At)||this.db._checkValue(xt);if(Nt)throw Nt;const jt=Bt&&Bt.sublevel!=null?Bt.sublevel:this.db,Ut=Bt,Lt=jt.keyEncoding(Bt&&Bt.keyEncoding),Ht=jt.valueEncoding(Bt&&Bt.valueEncoding),Vt=Lt.format;Bt={...Bt,keyEncoding:Vt,valueEncoding:Ht.format},jt!==this.db&&(Bt.sublevel=null);const zt=jt.prefixKey(Lt.encode(At),Vt),Wt=Ht.encode(xt);return this._put(zt,Wt,Bt),this[kOperations$1].push({...Ut,type:"put",key:At,value:xt}),this}_put(At,xt,Bt){}del(At,xt){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const Bt=this.db._checkKey(At);if(Bt)throw Bt;const Nt=xt&&xt.sublevel!=null?xt.sublevel:this.db,jt=xt,Ut=Nt.keyEncoding(xt&&xt.keyEncoding),Lt=Ut.format;return xt={...xt,keyEncoding:Lt},Nt!==this.db&&(xt.sublevel=null),this._del(Nt.prefixKey(Ut.encode(At),Lt),xt),this[kOperations$1].push({...jt,type:"del",key:At}),this}_del(At,xt){}clear(){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[kOperations$1]=[],this}_clear(){}write(At,xt){return xt=getCallback$1(At,xt),xt=fromCallback$2(xt,kPromise$2),At=getOptions$1(At),this[kStatus$1]!=="open"?this.nextTick(xt,new ModuleError$4("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(xt):(this[kStatus$1]="writing",this._write(At,Bt=>{this[kStatus$1]="closing",this[kCloseCallbacks].push(()=>xt(Bt)),Bt||this.db.emit("batch",this[kOperations$1]),this._close(this[kFinishClose])})),xt[kPromise$2]}_write(At,xt){}close(At){return At=fromCallback$2(At,kPromise$2),this[kStatus$1]==="closing"?this[kCloseCallbacks].push(At):this[kStatus$1]==="closed"?this.nextTick(At):(this[kCloseCallbacks].push(At),this[kStatus$1]!=="writing"&&(this[kStatus$1]="closing",this._close(this[kFinishClose]))),At[kPromise$2]}_close(At){this.nextTick(At)}[kFinishClose](){this[kStatus$1]="closed",this.db.detachResource(this);const At=this[kCloseCallbacks];this[kCloseCallbacks]=[];for(const xt of At)xt()}};abstractChainedBatch.AbstractChainedBatch=AbstractChainedBatch$1;const{AbstractChainedBatch}=abstractChainedBatch,ModuleError$3=moduleError,kEncoded=Symbol("encoded");let DefaultChainedBatch$1=class extends AbstractChainedBatch{constructor(At){super(At),this[kEncoded]=[]}_put(At,xt,Bt){this[kEncoded].push({...Bt,type:"put",key:At,value:xt})}_del(At,xt){this[kEncoded].push({...xt,type:"del",key:At})}_clear(){this[kEncoded]=[]}_write(At,xt){this.db.status==="opening"?this.db.defer(()=>this._write(At,xt)):this.db.status==="open"?this[kEncoded].length===0?this.nextTick(xt):this.db._batch(this[kEncoded],At,xt):this.nextTick(xt,new ModuleError$3("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};defaultChainedBatch.DefaultChainedBatch=DefaultChainedBatch$1;const ModuleError$2=moduleError,hasOwnProperty=Object.prototype.hasOwnProperty,rangeOptions$1=new Set(["lt","lte","gt","gte"]);var rangeOptions_1=function(kt,At){const xt={};for(const Bt in kt)if(hasOwnProperty.call(kt,Bt)&&!(Bt==="keyEncoding"||Bt==="valueEncoding")){if(Bt==="start"||Bt==="end")throw new ModuleError$2(`The legacy range option '${Bt}' has been removed`,{code:"LEVEL_LEGACY"});if(Bt==="encoding")throw new ModuleError$2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});rangeOptions$1.has(Bt)?xt[Bt]=At.encode(kt[Bt]):xt[Bt]=kt[Bt]}return xt.reverse=!!xt.reverse,xt.limit=Number.isInteger(xt.limit)&&xt.limit>=0?xt.limit:-1,xt};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):kt=>(promise||(promise=Promise.resolve())).then(kt).catch(At=>setTimeout(()=>{throw At},0)),nextTickBrowser,hasRequiredNextTickBrowser;function requireNextTickBrowser(){if(hasRequiredNextTickBrowser)return nextTickBrowser;hasRequiredNextTickBrowser=1;const kt=queueMicrotask_1;return nextTickBrowser=function(At,...xt){xt.length===0?kt(At):kt(()=>At(...xt))},nextTickBrowser}var abstractSublevelIterator={},hasRequiredAbstractSublevelIterator;function requireAbstractSublevelIterator(){if(hasRequiredAbstractSublevelIterator)return abstractSublevelIterator;hasRequiredAbstractSublevelIterator=1;const{AbstractIterator:kt,AbstractKeyIterator:At,AbstractValueIterator:xt}=abstractIterator,Bt=Symbol("unfix"),Nt=Symbol("iterator"),jt=Symbol("handleOne"),Ut=Symbol("handleMany"),Lt=Symbol("callback");class Ht extends kt{constructor(Jt,Qt,Xt,tr){super(Jt,Qt),this[Nt]=Xt,this[Bt]=tr,this[jt]=this[jt].bind(this),this[Ut]=this[Ut].bind(this),this[Lt]=null}[jt](Jt,Qt,Xt){const tr=this[Lt];if(Jt)return tr(Jt);Qt!==void 0&&(Qt=this[Bt](Qt)),tr(Jt,Qt,Xt)}[Ut](Jt,Qt){const Xt=this[Lt];if(Jt)return Xt(Jt);for(const tr of Qt){const rr=tr[0];rr!==void 0&&(tr[0]=this[Bt](rr))}Xt(Jt,Qt)}}class Vt extends At{constructor(Jt,Qt,Xt,tr){super(Jt,Qt),this[Nt]=Xt,this[Bt]=tr,this[jt]=this[jt].bind(this),this[Ut]=this[Ut].bind(this),this[Lt]=null}[jt](Jt,Qt){const Xt=this[Lt];if(Jt)return Xt(Jt);Qt!==void 0&&(Qt=this[Bt](Qt)),Xt(Jt,Qt)}[Ut](Jt,Qt){const Xt=this[Lt];if(Jt)return Xt(Jt);for(let tr=0;tr<Qt.length;tr++){const rr=Qt[tr];rr!==void 0&&(Qt[tr]=this[Bt](rr))}Xt(Jt,Qt)}}class zt extends xt{constructor(Jt,Qt,Xt){super(Jt,Qt),this[Nt]=Xt}}for(const Wt of[Ht,Vt])Wt.prototype._next=function(Jt){this[Lt]=Jt,this[Nt].next(this[jt])},Wt.prototype._nextv=function(Jt,Qt,Xt){this[Lt]=Xt,this[Nt].nextv(Jt,Qt,this[Ut])},Wt.prototype._all=function(Jt,Qt){this[Lt]=Qt,this[Nt].all(Jt,this[Ut])};for(const Wt of[zt])Wt.prototype._next=function(Jt){this[Nt].next(Jt)},Wt.prototype._nextv=function(Jt,Qt,Xt){this[Nt].nextv(Jt,Qt,Xt)},Wt.prototype._all=function(Jt,Qt){this[Nt].all(Jt,Qt)};for(const Wt of[Ht,Vt,zt])Wt.prototype._seek=function(Jt,Qt){this[Nt].seek(Jt,Qt)},Wt.prototype._close=function(Jt){this[Nt].close(Jt)};return abstractSublevelIterator.AbstractSublevelIterator=Ht,abstractSublevelIterator.AbstractSublevelKeyIterator=Vt,abstractSublevelIterator.AbstractSublevelValueIterator=zt,abstractSublevelIterator}var abstractSublevel,hasRequiredAbstractSublevel;function requireAbstractSublevel(){if(hasRequiredAbstractSublevel)return abstractSublevel;hasRequiredAbstractSublevel=1;const kt=moduleError,{Buffer:At}=buffer$2||{},{AbstractSublevelIterator:xt,AbstractSublevelKeyIterator:Bt,AbstractSublevelValueIterator:Nt}=requireAbstractSublevelIterator(),jt=Symbol("prefix"),Ut=Symbol("upperBound"),Lt=Symbol("prefixRange"),Ht=Symbol("parent"),Vt=Symbol("unfix"),zt=new TextEncoder,Wt={separator:"!"};abstractSublevel=function({AbstractLevel:nr}){class ar extends nr{static defaults(lr){if(typeof lr=="string")throw new kt("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(lr&&lr.open)throw new kt("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return lr==null?Wt:lr.separator?lr:{...lr,separator:"!"}}constructor(lr,yr,Sr){const{separator:Ar,manifest:Dr,...Br}=ar.defaults(Sr);yr=rr(yr,Ar);const Lr=Ar.charCodeAt(0)+1,Or=lr[Ht]||lr;if(!zt.encode(yr).every(dr=>dr>Lr&&dr<127))throw new kt(`Prefix must use bytes > ${Lr} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(Jt(Or,Dr),Br);const vr=(lr.prefix||"")+Ar+yr+Ar,pr=vr.slice(0,-1)+String.fromCharCode(Lr);this[Ht]=Or,this[jt]=new Xt(vr),this[Ut]=new Xt(pr),this[Vt]=new tr,this.nextTick=Or.nextTick}prefixKey(lr,yr){if(yr==="utf8")return this[jt].utf8+lr;if(lr.byteLength===0)return this[jt][yr];if(yr==="view"){const Sr=this[jt].view,Ar=new Uint8Array(Sr.byteLength+lr.byteLength);return Ar.set(Sr,0),Ar.set(lr,Sr.byteLength),Ar}else{const Sr=this[jt].buffer;return At.concat([Sr,lr],Sr.byteLength+lr.byteLength)}}[Lt](lr,yr){lr.gte!==void 0?lr.gte=this.prefixKey(lr.gte,yr):lr.gt!==void 0?lr.gt=this.prefixKey(lr.gt,yr):lr.gte=this[jt][yr],lr.lte!==void 0?lr.lte=this.prefixKey(lr.lte,yr):lr.lt!==void 0?lr.lt=this.prefixKey(lr.lt,yr):lr.lte=this[Ut][yr]}get prefix(){return this[jt].utf8}get db(){return this[Ht]}_open(lr,yr){this[Ht].open({passive:!0},yr)}_put(lr,yr,Sr,Ar){this[Ht].put(lr,yr,Sr,Ar)}_get(lr,yr,Sr){this[Ht].get(lr,yr,Sr)}_getMany(lr,yr,Sr){this[Ht].getMany(lr,yr,Sr)}_del(lr,yr,Sr){this[Ht].del(lr,yr,Sr)}_batch(lr,yr,Sr){this[Ht].batch(lr,yr,Sr)}_clear(lr,yr){this[Lt](lr,lr.keyEncoding),this[Ht].clear(lr,yr)}_iterator(lr){this[Lt](lr,lr.keyEncoding);const yr=this[Ht].iterator(lr),Sr=this[Vt].get(this[jt].utf8.length,lr.keyEncoding);return new xt(this,lr,yr,Sr)}_keys(lr){this[Lt](lr,lr.keyEncoding);const yr=this[Ht].keys(lr),Sr=this[Vt].get(this[jt].utf8.length,lr.keyEncoding);return new Bt(this,lr,yr,Sr)}_values(lr){this[Lt](lr,lr.keyEncoding);const yr=this[Ht].values(lr);return new Nt(this,lr,yr)}}return{AbstractSublevel:ar}};const Jt=function(nr,ar){return{...nr.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...ar,encodings:{utf8:Qt(nr,"utf8"),buffer:Qt(nr,"buffer"),view:Qt(nr,"view")}}},Qt=function(nr,ar){return nr.supports.encodings[ar]?nr.keyEncoding(ar).name===ar:!1};class Xt{constructor(ar){this.utf8=ar,this.view=zt.encode(ar),this.buffer=At?At.from(this.view.buffer,0,this.view.byteLength):{}}}class tr{constructor(){this.cache=new Map}get(ar,ir){let lr=this.cache.get(ir);return lr===void 0&&(ir==="view"?lr=(function(yr,Sr){return Sr.subarray(yr)}).bind(null,ar):lr=(function(yr,Sr){return Sr.slice(yr)}).bind(null,ar),this.cache.set(ir,lr)),lr}}const rr=function(nr,ar){let ir=0,lr=nr.length;for(;ir<lr&&nr[ir]===ar;)ir++;for(;lr>ir&&nr[lr-1]===ar;)lr--;return nr.slice(ir,lr)};return abstractSublevel}const{supports}=levelSupports,{Transcoder}=levelTranscoder,{EventEmitter:EventEmitter$1}=eventsExports,{fromCallback:fromCallback$1}=catering,ModuleError$1=moduleError,{AbstractIterator:AbstractIterator$1}=abstractIterator,{DefaultKeyIterator,DefaultValueIterator}=defaultKvIterator,{DeferredIterator,DeferredKeyIterator,DeferredValueIterator}=deferredIterator,{DefaultChainedBatch}=defaultChainedBatch,{getCallback,getOptions}=common,rangeOptions=rangeOptions_1,kPromise$1=Symbol("promise"),kLanded=Symbol("landed"),kResources=Symbol("resources"),kCloseResources=Symbol("closeResources"),kOperations=Symbol("operations"),kUndefer=Symbol("undefer"),kDeferOpen=Symbol("deferOpen"),kOptions$1=Symbol("options"),kStatus=Symbol("status"),kDefaultOptions=Symbol("defaultOptions"),kTranscoder=Symbol("transcoder"),kKeyEncoding=Symbol("keyEncoding"),kValueEncoding=Symbol("valueEncoding"),noop=()=>{};let AbstractLevel$1=class extends EventEmitter$1{constructor(At,xt){if(super(),typeof At!="object"||At===null)throw new TypeError("The first argument 'manifest' must be an object");xt=getOptions(xt);const{keyEncoding:Bt,valueEncoding:Nt,passive:jt,...Ut}=xt;this[kResources]=new Set,this[kOperations]=[],this[kDeferOpen]=!0,this[kOptions$1]=Ut,this[kStatus]="opening",this.supports=supports(At,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:At.snapshots!==!1,permanence:At.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:At.encodings||{},events:Object.assign({},At.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[kTranscoder]=new Transcoder(formats(this)),this[kKeyEncoding]=this[kTranscoder].encoding(Bt||"utf8"),this[kValueEncoding]=this[kTranscoder].encoding(Nt||"utf8");for(const Lt of this[kTranscoder].encodings())this.supports.encodings[Lt.commonName]||(this.supports.encodings[Lt.commonName]=!0);this[kDefaultOptions]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[kKeyEncoding].commonName,valueEncoding:this[kValueEncoding].commonName}),key:Object.freeze({keyEncoding:this[kKeyEncoding].commonName})},this.nextTick(()=>{this[kDeferOpen]&&this.open({passive:!1},noop)})}get status(){return this[kStatus]}keyEncoding(At){return this[kTranscoder].encoding(At??this[kKeyEncoding])}valueEncoding(At){return this[kTranscoder].encoding(At??this[kValueEncoding])}open(At,xt){xt=getCallback(At,xt),xt=fromCallback$1(xt,kPromise$1),At={...this[kOptions$1],...getOptions(At)},At.createIfMissing=At.createIfMissing!==!1,At.errorIfExists=!!At.errorIfExists;const Bt=Nt=>{this[kStatus]==="closing"||this[kStatus]==="opening"?this.once(kLanded,Nt?()=>Bt(Nt):Bt):this[kStatus]!=="open"?xt(new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:Nt})):xt()};return At.passive?this[kStatus]==="opening"?this.once(kLanded,Bt):this.nextTick(Bt):this[kStatus]==="closed"||this[kDeferOpen]?(this[kDeferOpen]=!1,this[kStatus]="opening",this.emit("opening"),this._open(At,Nt=>{if(Nt){this[kStatus]="closed",this[kCloseResources](()=>{this.emit(kLanded),Bt(Nt)}),this[kUndefer]();return}this[kStatus]="open",this[kUndefer](),this.emit(kLanded),this[kStatus]==="open"&&this.emit("open"),this[kStatus]==="open"&&this.emit("ready"),Bt()})):this[kStatus]==="open"?this.nextTick(Bt):this.once(kLanded,()=>this.open(At,xt)),xt[kPromise$1]}_open(At,xt){this.nextTick(xt)}close(At){At=fromCallback$1(At,kPromise$1);const xt=Bt=>{this[kStatus]==="opening"||this[kStatus]==="closing"?this.once(kLanded,Bt?xt(Bt):xt):this[kStatus]!=="closed"?At(new ModuleError$1("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:Bt})):At()};if(this[kStatus]==="open"){this[kStatus]="closing",this.emit("closing");const Bt=Nt=>{this[kStatus]="open",this[kUndefer](),this.emit(kLanded),xt(Nt)};this[kCloseResources](()=>{this._close(Nt=>{if(Nt)return Bt(Nt);this[kStatus]="closed",this[kUndefer](),this.emit(kLanded),this[kStatus]==="closed"&&this.emit("closed"),xt()})})}else this[kStatus]==="closed"?this.nextTick(xt):this.once(kLanded,()=>this.close(At));return At[kPromise$1]}[kCloseResources](At){if(this[kResources].size===0)return this.nextTick(At);let xt=this[kResources].size,Bt=!0;const Nt=()=>{--xt===0&&(Bt?this.nextTick(At):At())};for(const jt of this[kResources])jt.close(Nt);Bt=!1,this[kResources].clear()}_close(At){this.nextTick(At)}get(At,xt,Bt){if(Bt=getCallback(xt,Bt),Bt=fromCallback$1(Bt,kPromise$1),xt=getOptions(xt,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.get(At,xt,Bt)),Bt[kPromise$1];if(maybeError(this,Bt))return Bt[kPromise$1];const Nt=this._checkKey(At);if(Nt)return this.nextTick(Bt,Nt),Bt[kPromise$1];const jt=this.keyEncoding(xt.keyEncoding),Ut=this.valueEncoding(xt.valueEncoding),Lt=jt.format,Ht=Ut.format;return(xt.keyEncoding!==Lt||xt.valueEncoding!==Ht)&&(xt=Object.assign({},xt,{keyEncoding:Lt,valueEncoding:Ht})),this._get(this.prefixKey(jt.encode(At),Lt),xt,(Vt,zt)=>{if(Vt)return(Vt.code==="LEVEL_NOT_FOUND"||Vt.notFound||/NotFound/i.test(Vt))&&(Vt.code||(Vt.code="LEVEL_NOT_FOUND"),Vt.notFound||(Vt.notFound=!0),Vt.status||(Vt.status=404)),Bt(Vt);try{zt=Ut.decode(zt)}catch(Wt){return Bt(new ModuleError$1("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:Wt}))}Bt(null,zt)}),Bt[kPromise$1]}_get(At,xt,Bt){this.nextTick(Bt,new Error("NotFound"))}getMany(At,xt,Bt){if(Bt=getCallback(xt,Bt),Bt=fromCallback$1(Bt,kPromise$1),xt=getOptions(xt,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.getMany(At,xt,Bt)),Bt[kPromise$1];if(maybeError(this,Bt))return Bt[kPromise$1];if(!Array.isArray(At))return this.nextTick(Bt,new TypeError("The first argument 'keys' must be an array")),Bt[kPromise$1];if(At.length===0)return this.nextTick(Bt,null,[]),Bt[kPromise$1];const Nt=this.keyEncoding(xt.keyEncoding),jt=this.valueEncoding(xt.valueEncoding),Ut=Nt.format,Lt=jt.format;(xt.keyEncoding!==Ut||xt.valueEncoding!==Lt)&&(xt=Object.assign({},xt,{keyEncoding:Ut,valueEncoding:Lt}));const Ht=new Array(At.length);for(let Vt=0;Vt<At.length;Vt++){const zt=At[Vt],Wt=this._checkKey(zt);if(Wt)return this.nextTick(Bt,Wt),Bt[kPromise$1];Ht[Vt]=this.prefixKey(Nt.encode(zt),Ut)}return this._getMany(Ht,xt,(Vt,zt)=>{if(Vt)return Bt(Vt);try{for(let Wt=0;Wt<zt.length;Wt++)zt[Wt]!==void 0&&(zt[Wt]=jt.decode(zt[Wt]))}catch(Wt){return Bt(new ModuleError$1(`Could not decode one or more of ${zt.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:Wt}))}Bt(null,zt)}),Bt[kPromise$1]}_getMany(At,xt,Bt){this.nextTick(Bt,null,new Array(At.length).fill(void 0))}put(At,xt,Bt,Nt){if(Nt=getCallback(Bt,Nt),Nt=fromCallback$1(Nt,kPromise$1),Bt=getOptions(Bt,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.put(At,xt,Bt,Nt)),Nt[kPromise$1];if(maybeError(this,Nt))return Nt[kPromise$1];const jt=this._checkKey(At)||this._checkValue(xt);if(jt)return this.nextTick(Nt,jt),Nt[kPromise$1];const Ut=this.keyEncoding(Bt.keyEncoding),Lt=this.valueEncoding(Bt.valueEncoding),Ht=Ut.format,Vt=Lt.format;(Bt.keyEncoding!==Ht||Bt.valueEncoding!==Vt)&&(Bt=Object.assign({},Bt,{keyEncoding:Ht,valueEncoding:Vt}));const zt=this.prefixKey(Ut.encode(At),Ht),Wt=Lt.encode(xt);return this._put(zt,Wt,Bt,Jt=>{if(Jt)return Nt(Jt);this.emit("put",At,xt),Nt()}),Nt[kPromise$1]}_put(At,xt,Bt,Nt){this.nextTick(Nt)}del(At,xt,Bt){if(Bt=getCallback(xt,Bt),Bt=fromCallback$1(Bt,kPromise$1),xt=getOptions(xt,this[kDefaultOptions].key),this[kStatus]==="opening")return this.defer(()=>this.del(At,xt,Bt)),Bt[kPromise$1];if(maybeError(this,Bt))return Bt[kPromise$1];const Nt=this._checkKey(At);if(Nt)return this.nextTick(Bt,Nt),Bt[kPromise$1];const jt=this.keyEncoding(xt.keyEncoding),Ut=jt.format;return xt.keyEncoding!==Ut&&(xt=Object.assign({},xt,{keyEncoding:Ut})),this._del(this.prefixKey(jt.encode(At),Ut),xt,Lt=>{if(Lt)return Bt(Lt);this.emit("del",At),Bt()}),Bt[kPromise$1]}_del(At,xt,Bt){this.nextTick(Bt)}batch(At,xt,Bt){if(!arguments.length){if(this[kStatus]==="opening")return new DefaultChainedBatch(this);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof At=="function"?Bt=At:Bt=getCallback(xt,Bt),Bt=fromCallback$1(Bt,kPromise$1),xt=getOptions(xt,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.batch(At,xt,Bt)),Bt[kPromise$1];if(maybeError(this,Bt))return Bt[kPromise$1];if(!Array.isArray(At))return this.nextTick(Bt,new TypeError("The first argument 'operations' must be an array")),Bt[kPromise$1];if(At.length===0)return this.nextTick(Bt),Bt[kPromise$1];const Nt=new Array(At.length),{keyEncoding:jt,valueEncoding:Ut,...Lt}=xt;for(let Ht=0;Ht<At.length;Ht++){if(typeof At[Ht]!="object"||At[Ht]===null)return this.nextTick(Bt,new TypeError("A batch operation must be an object")),Bt[kPromise$1];const Vt=Object.assign({},At[Ht]);if(Vt.type!=="put"&&Vt.type!=="del")return this.nextTick(Bt,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),Bt[kPromise$1];const zt=this._checkKey(Vt.key);if(zt)return this.nextTick(Bt,zt),Bt[kPromise$1];const Wt=Vt.sublevel!=null?Vt.sublevel:this,Jt=Wt.keyEncoding(Vt.keyEncoding||jt),Qt=Jt.format;if(Vt.key=Wt.prefixKey(Jt.encode(Vt.key),Qt),Vt.keyEncoding=Qt,Vt.type==="put"){const Xt=this._checkValue(Vt.value);if(Xt)return this.nextTick(Bt,Xt),Bt[kPromise$1];const tr=Wt.valueEncoding(Vt.valueEncoding||Ut);Vt.value=tr.encode(Vt.value),Vt.valueEncoding=tr.format}Wt!==this&&(Vt.sublevel=null),Nt[Ht]=Vt}return this._batch(Nt,Lt,Ht=>{if(Ht)return Bt(Ht);this.emit("batch",At),Bt()}),Bt[kPromise$1]}_batch(At,xt,Bt){this.nextTick(Bt)}sublevel(At,xt){return this._sublevel(At,AbstractSublevel.defaults(xt))}_sublevel(At,xt){return new AbstractSublevel(this,At,xt)}prefixKey(At,xt){return At}clear(At,xt){if(xt=getCallback(At,xt),xt=fromCallback$1(xt,kPromise$1),At=getOptions(At,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.clear(At,xt)),xt[kPromise$1];if(maybeError(this,xt))return xt[kPromise$1];const Bt=At,Nt=this.keyEncoding(At.keyEncoding);return At=rangeOptions(At,Nt),At.keyEncoding=Nt.format,At.limit===0?this.nextTick(xt):this._clear(At,jt=>{if(jt)return xt(jt);this.emit("clear",Bt),xt()}),xt[kPromise$1]}_clear(At,xt){this.nextTick(xt)}iterator(At){const xt=this.keyEncoding(At&&At.keyEncoding),Bt=this.valueEncoding(At&&At.valueEncoding);if(At=rangeOptions(At,xt),At.keys=At.keys!==!1,At.values=At.values!==!1,At[AbstractIterator$1.keyEncoding]=xt,At[AbstractIterator$1.valueEncoding]=Bt,At.keyEncoding=xt.format,At.valueEncoding=Bt.format,this[kStatus]==="opening")return new DeferredIterator(this,At);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(At)}_iterator(At){return new AbstractIterator$1(this,At)}keys(At){const xt=this.keyEncoding(At&&At.keyEncoding),Bt=this.valueEncoding(At&&At.valueEncoding);if(At=rangeOptions(At,xt),At[AbstractIterator$1.keyEncoding]=xt,At[AbstractIterator$1.valueEncoding]=Bt,At.keyEncoding=xt.format,At.valueEncoding=Bt.format,this[kStatus]==="opening")return new DeferredKeyIterator(this,At);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(At)}_keys(At){return new DefaultKeyIterator(this,At)}values(At){const xt=this.keyEncoding(At&&At.keyEncoding),Bt=this.valueEncoding(At&&At.valueEncoding);if(At=rangeOptions(At,xt),At[AbstractIterator$1.keyEncoding]=xt,At[AbstractIterator$1.valueEncoding]=Bt,At.keyEncoding=xt.format,At.valueEncoding=Bt.format,this[kStatus]==="opening")return new DeferredValueIterator(this,At);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(At)}_values(At){return new DefaultValueIterator(this,At)}defer(At){if(typeof At!="function")throw new TypeError("The first argument must be a function");this[kOperations].push(At)}[kUndefer](){if(this[kOperations].length===0)return;const At=this[kOperations];this[kOperations]=[];for(const xt of At)xt()}attachResource(At){if(typeof At!="object"||At===null||typeof At.close!="function")throw new TypeError("The first argument must be a resource object");this[kResources].add(At)}detachResource(At){this[kResources].delete(At)}_chainedBatch(){return new DefaultChainedBatch(this)}_checkKey(At){if(At==null)return new ModuleError$1("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(At){if(At==null)return new ModuleError$1("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};AbstractLevel$1.prototype.nextTick=requireNextTickBrowser();const{AbstractSublevel}=requireAbstractSublevel()({AbstractLevel:AbstractLevel$1});abstractLevel.AbstractLevel=AbstractLevel$1;abstractLevel.AbstractSublevel=AbstractSublevel;const maybeError=function(kt,At){return kt[kStatus]!=="open"?(kt.nextTick(At,new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},formats=function(kt){return Object.keys(kt.supports.encodings).filter(At=>!!kt.supports.encodings[At])};abstractLevel$1.AbstractLevel=abstractLevel.AbstractLevel;abstractLevel$1.AbstractSublevel=abstractLevel.AbstractSublevel;abstractLevel$1.AbstractIterator=abstractIterator.AbstractIterator;abstractLevel$1.AbstractKeyIterator=abstractIterator.AbstractKeyIterator;abstractLevel$1.AbstractValueIterator=abstractIterator.AbstractValueIterator;abstractLevel$1.AbstractChainedBatch=abstractChainedBatch.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var runParallelLimit_1=runParallelLimit;const queueMicrotask$1=queueMicrotask_1;function runParallelLimit(kt,At,xt){if(typeof At!="number")throw new Error("second argument must be a Number");let Bt,Nt,jt,Ut,Lt,Ht=!0,Vt;Array.isArray(kt)?(Bt=[],jt=Nt=kt.length):(Ut=Object.keys(kt),Bt={},jt=Nt=Ut.length);function zt(Jt){function Qt(){xt&&xt(Jt,Bt),xt=null}Ht?queueMicrotask$1(Qt):Qt()}function Wt(Jt,Qt,Xt){if(Bt[Jt]=Xt,Qt&&(Lt=!0),--jt===0||Qt)zt(Qt);else if(!Lt&&Vt<Nt){let tr;Ut?(tr=Ut[Vt],Vt+=1,kt[tr](function(rr,nr){Wt(tr,rr,nr)})):(tr=Vt,Vt+=1,kt[tr](function(rr,nr){Wt(tr,rr,nr)}))}}Vt=At,jt?Ut?Ut.some(function(Jt,Qt){return kt[Jt](function(Xt,tr){Wt(Jt,Xt,tr)}),Qt===At-1}):kt.some(function(Jt,Qt){return Jt(function(Xt,tr){Wt(Qt,Xt,tr)}),Qt===At-1}):zt(null),Ht=!1}var iterator={},keyRange=function kt(At){const xt=At.gte!==void 0?At.gte:At.gt!==void 0?At.gt:void 0,Bt=At.lte!==void 0?At.lte:At.lt!==void 0?At.lt:void 0,Nt=At.gte===void 0,jt=At.lte===void 0;return xt!==void 0&&Bt!==void 0?IDBKeyRange.bound(xt,Bt,Nt,jt):xt!==void 0?IDBKeyRange.lowerBound(xt,Nt):Bt!==void 0?IDBKeyRange.upperBound(Bt,jt):null};const textEncoder$2=new TextEncoder;var deserialize$2=function(kt){return kt instanceof Uint8Array?kt:kt instanceof ArrayBuffer?new Uint8Array(kt):textEncoder$2.encode(kt)};const{AbstractIterator}=abstractLevel$1,createKeyRange$1=keyRange,deserialize$1=deserialize$2,kCache=Symbol("cache"),kFinished=Symbol("finished"),kOptions=Symbol("options"),kCurrentOptions=Symbol("currentOptions"),kPosition=Symbol("position"),kLocation$1=Symbol("location"),kFirst=Symbol("first"),emptyOptions={};let Iterator$1=class extends AbstractIterator{constructor(At,xt,Bt){super(At,Bt),this[kCache]=[],this[kFinished]=this.limit===0,this[kOptions]=Bt,this[kCurrentOptions]={...Bt},this[kPosition]=void 0,this[kLocation$1]=xt,this[kFirst]=!0}_nextv(At,xt,Bt){if(this[kFirst]=!1,this[kFinished])return this.nextTick(Bt,null,[]);if(this[kCache].length>0)return At=Math.min(At,this[kCache].length),this.nextTick(Bt,null,this[kCache].splice(0,At));this[kPosition]!==void 0&&(this[kOptions].reverse?(this[kCurrentOptions].lt=this[kPosition],this[kCurrentOptions].lte=void 0):(this[kCurrentOptions].gt=this[kPosition],this[kCurrentOptions].gte=void 0));let Nt;try{Nt=createKeyRange$1(this[kCurrentOptions])}catch{return this[kFinished]=!0,this.nextTick(Bt,null,[])}const jt=this.db.db.transaction([this[kLocation$1]],"readonly"),Ut=jt.objectStore(this[kLocation$1]),Lt=[];if(this[kOptions].reverse){const Ht=!this[kOptions].values&&Ut.openKeyCursor?"openKeyCursor":"openCursor";Ut[Ht](Nt,"prev").onsuccess=Vt=>{const zt=Vt.target.result;if(zt){const{key:Wt,value:Jt}=zt;this[kPosition]=Wt,Lt.push([this[kOptions].keys&&Wt!==void 0?deserialize$1(Wt):void 0,this[kOptions].values&&Jt!==void 0?deserialize$1(Jt):void 0]),Lt.length<At?zt.continue():maybeCommit(jt)}else this[kFinished]=!0}}else{let Ht,Vt;const zt=()=>{if(Ht===void 0||Vt===void 0)return;const Wt=Math.max(Ht.length,Vt.length);Wt===0||At===1/0?this[kFinished]=!0:this[kPosition]=Ht[Wt-1],Lt.length=Wt;for(let Jt=0;Jt<Wt;Jt++){const Qt=Ht[Jt],Xt=Vt[Jt];Lt[Jt]=[this[kOptions].keys&&Qt!==void 0?deserialize$1(Qt):void 0,this[kOptions].values&&Xt!==void 0?deserialize$1(Xt):void 0]}maybeCommit(jt)};this[kOptions].keys||At<1/0?Ut.getAllKeys(Nt,At<1/0?At:void 0).onsuccess=Wt=>{Ht=Wt.target.result,zt()}:(Ht=[],this.nextTick(zt)),this[kOptions].values?Ut.getAll(Nt,At<1/0?At:void 0).onsuccess=Wt=>{Vt=Wt.target.result,zt()}:(Vt=[],this.nextTick(zt))}jt.onabort=()=>{Bt(jt.error||new Error("aborted by user")),Bt=null},jt.oncomplete=()=>{Bt(null,Lt),Bt=null}}_next(At){if(this[kCache].length>0){const[xt,Bt]=this[kCache].shift();this.nextTick(At,null,xt,Bt)}else if(this[kFinished])this.nextTick(At);else{let xt=Math.min(100,this.limit-this.count);this[kFirst]&&(this[kFirst]=!1,xt=1),this._nextv(xt,emptyOptions,(Bt,Nt)=>{if(Bt)return At(Bt);this[kCache]=Nt,this._next(At)})}}_all(At,xt){this[kFirst]=!1;const Bt=this[kCache].splice(0,this[kCache].length),Nt=this.limit-this.count-Bt.length;if(Nt<=0)return this.nextTick(xt,null,Bt);this._nextv(Nt,emptyOptions,(jt,Ut)=>{if(jt)return xt(jt);Bt.length>0&&(Ut=Bt.concat(Ut)),xt(null,Ut)})}_seek(At,xt){this[kFirst]=!0,this[kCache]=[],this[kFinished]=!1,this[kPosition]=void 0,this[kCurrentOptions]={...this[kOptions]};let Bt;try{Bt=createKeyRange$1(this[kOptions])}catch{this[kFinished]=!0;return}Bt!==null&&!Bt.includes(At)?this[kFinished]=!0:this[kOptions].reverse?this[kCurrentOptions].lte=At:this[kCurrentOptions].gte=At}};iterator.Iterator=Iterator$1;function maybeCommit(kt){typeof kt.commit=="function"&&kt.commit()}var clear$1=function kt(At,xt,Bt,Nt,jt){if(Nt.limit===0)return At.nextTick(jt);const Ut=At.db.transaction([xt],"readwrite"),Lt=Ut.objectStore(xt);let Ht=0;Ut.oncomplete=function(){jt()},Ut.onabort=function(){jt(Ut.error||new Error("aborted by user"))};const Vt=Lt.openKeyCursor?"openKeyCursor":"openCursor",zt=Nt.reverse?"prev":"next";Lt[Vt](Bt,zt).onsuccess=function(Wt){const Jt=Wt.target.result;Jt&&(Lt.delete(Jt.key).onsuccess=function(){(Nt.limit<=0||++Ht<Nt.limit)&&Jt.continue()})}};const{AbstractLevel}=abstractLevel$1,ModuleError=moduleError,parallel$1=runParallelLimit_1,{fromCallback}=catering,{Iterator}=iterator,deserialize=deserialize$2,clear=clear$1,createKeyRange=keyRange,DEFAULT_PREFIX="level-js-",kIDB=Symbol("idb"),kNamePrefix=Symbol("namePrefix"),kLocation=Symbol("location"),kVersion=Symbol("version"),kStore=Symbol("store"),kOnComplete=Symbol("onComplete"),kPromise=Symbol("promise");class BrowserLevel extends AbstractLevel{constructor(At,xt,Bt){if(typeof xt=="function"||typeof Bt=="function")throw new ModuleError("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:Nt,version:jt,...Ut}=xt||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},Ut),typeof At!="string")throw new Error("constructor requires a location string argument");this[kLocation]=At,this[kNamePrefix]=Nt??DEFAULT_PREFIX,this[kVersion]=parseInt(jt||1,10),this[kIDB]=null}get location(){return this[kLocation]}get namePrefix(){return this[kNamePrefix]}get version(){return this[kVersion]}get db(){return this[kIDB]}get type(){return"browser-level"}_open(At,xt){const Bt=indexedDB.open(this[kNamePrefix]+this[kLocation],this[kVersion]);Bt.onerror=function(){xt(Bt.error||new Error("unknown error"))},Bt.onsuccess=()=>{this[kIDB]=Bt.result,xt()},Bt.onupgradeneeded=Nt=>{const jt=Nt.target.result;jt.objectStoreNames.contains(this[kLocation])||jt.createObjectStore(this[kLocation])}}[kStore](At){return this[kIDB].transaction([this[kLocation]],At).objectStore(this[kLocation])}[kOnComplete](At,xt){const Bt=At.transaction;Bt.onabort=function(){xt(Bt.error||new Error("aborted by user"))},Bt.oncomplete=function(){xt(null,At.result)}}_get(At,xt,Bt){const Nt=this[kStore]("readonly");let jt;try{jt=Nt.get(At)}catch(Ut){return this.nextTick(Bt,Ut)}this[kOnComplete](jt,function(Ut,Lt){if(Ut)return Bt(Ut);if(Lt===void 0)return Bt(new ModuleError("Entry not found",{code:"LEVEL_NOT_FOUND"}));Bt(null,deserialize(Lt))})}_getMany(At,xt,Bt){const Nt=this[kStore]("readonly"),jt=At.map(Ut=>Lt=>{let Ht;try{Ht=Nt.get(Ut)}catch(Vt){return Lt(Vt)}Ht.onsuccess=()=>{const Vt=Ht.result;Lt(null,Vt===void 0?Vt:deserialize(Vt))},Ht.onerror=Vt=>{Vt.stopPropagation(),Lt(Ht.error)}});parallel$1(jt,16,Bt)}_del(At,xt,Bt){const Nt=this[kStore]("readwrite");let jt;try{jt=Nt.delete(At)}catch(Ut){return this.nextTick(Bt,Ut)}this[kOnComplete](jt,Bt)}_put(At,xt,Bt,Nt){const jt=this[kStore]("readwrite");let Ut;try{Ut=jt.put(xt,At)}catch(Lt){return this.nextTick(Nt,Lt)}this[kOnComplete](Ut,Nt)}_iterator(At){return new Iterator(this,this[kLocation],At)}_batch(At,xt,Bt){const Nt=this[kStore]("readwrite"),jt=Nt.transaction;let Ut=0,Lt;jt.onabort=function(){Bt(Lt||jt.error||new Error("aborted by user"))},jt.oncomplete=function(){Bt()};function Ht(){const Vt=At[Ut++],zt=Vt.key;let Wt;try{Wt=Vt.type==="del"?Nt.delete(zt):Nt.put(Vt.value,zt)}catch(Jt){Lt=Jt,jt.abort();return}Ut<At.length?Wt.onsuccess=Ht:typeof jt.commit=="function"&&jt.commit()}Ht()}_clear(At,xt){let Bt,Nt;try{Bt=createKeyRange(At)}catch{return this.nextTick(xt)}if(At.limit>=0)return clear(this,this[kLocation],Bt,At,xt);try{const jt=this[kStore]("readwrite");Nt=Bt?jt.delete(Bt):jt.clear()}catch(jt){return this.nextTick(xt,jt)}this[kOnComplete](Nt,xt)}_close(At){this[kIDB].close(),this.nextTick(At)}}BrowserLevel.destroy=function(kt,At,xt){typeof At=="function"&&(xt=At,At=DEFAULT_PREFIX),xt=fromCallback(xt,kPromise);const Bt=indexedDB.deleteDatabase(At+kt);return Bt.onsuccess=function(){xt()},Bt.onerror=function(Nt){xt(Nt)},xt[kPromise]};browserLevel.BrowserLevel=BrowserLevel;var Level$1=browserLevel.BrowserLevel,__awaiter$1Y=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let MemoryStore$1=class{constructor(){this.store=new Map}clear(){return __awaiter$1Y(this,void 0,void 0,function*(){this.store.clear()})}close(){return __awaiter$1Y(this,void 0,void 0,function*(){})}delete(At){return __awaiter$1Y(this,void 0,void 0,function*(){return this.store.delete(At)})}get(At){return __awaiter$1Y(this,void 0,void 0,function*(){return this.store.get(At)})}has(At){return __awaiter$1Y(this,void 0,void 0,function*(){return this.store.has(At)})}list(){return __awaiter$1Y(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(At,xt){return __awaiter$1Y(this,void 0,void 0,function*(){this.store.set(At,xt)})}};var __await$5=function(kt){return this instanceof __await$5?(this.v=kt,this):new __await$5(kt)},browser={exports:{}},stream={exports:{}},primordials={ArrayIsArray(kt){return Array.isArray(kt)},ArrayPrototypeIncludes(kt,At){return kt.includes(At)},ArrayPrototypeIndexOf(kt,At){return kt.indexOf(At)},ArrayPrototypeJoin(kt,At){return kt.join(At)},ArrayPrototypeMap(kt,At){return kt.map(At)},ArrayPrototypePop(kt,At){return kt.pop(At)},ArrayPrototypePush(kt,At){return kt.push(At)},ArrayPrototypeSlice(kt,At,xt){return kt.slice(At,xt)},Error,FunctionPrototypeCall(kt,At,...xt){return kt.call(At,...xt)},FunctionPrototypeSymbolHasInstance(kt,At){return Function.prototype[Symbol.hasInstance].call(kt,At)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(kt,At){return Object.defineProperties(kt,At)},ObjectDefineProperty(kt,At,xt){return Object.defineProperty(kt,At,xt)},ObjectGetOwnPropertyDescriptor(kt,At){return Object.getOwnPropertyDescriptor(kt,At)},ObjectKeys(kt){return Object.keys(kt)},ObjectSetPrototypeOf(kt,At){return Object.setPrototypeOf(kt,At)},Promise,PromisePrototypeCatch(kt,At){return kt.catch(At)},PromisePrototypeThen(kt,At,xt){return kt.then(At,xt)},PromiseReject(kt){return Promise.reject(kt)},ReflectApply:Reflect.apply,RegExpPrototypeTest(kt,At){return kt.test(At)},SafeSet:Set,String,StringPrototypeSlice(kt,At,xt){return kt.slice(At,xt)},StringPrototypeToLowerCase(kt){return kt.toLowerCase()},StringPrototypeToUpperCase(kt){return kt.toUpperCase()},StringPrototypeTrim(kt){return kt.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(kt,At,xt){return kt.set(At,xt)},Uint8Array},util={exports:{}};(function(kt){const At=buffer$2,xt=Object.getPrototypeOf(async function(){}).constructor,Bt=globalThis.Blob||At.Blob,Nt=typeof Bt<"u"?function(Lt){return Lt instanceof Bt}:function(Lt){return!1};class jt extends Error{constructor(Lt){if(!Array.isArray(Lt))throw new TypeError(`Expected input to be an Array, got ${typeof Lt}`);let Ht="";for(let Vt=0;Vt<Lt.length;Vt++)Ht+=`    ${Lt[Vt].stack}
`;super(Ht),this.name="AggregateError",this.errors=Lt}}kt.exports={AggregateError:jt,kEmptyObject:Object.freeze({}),once(Ut){let Lt=!1;return function(...Ht){Lt||(Lt=!0,Ut.apply(this,Ht))}},createDeferredPromise:function(){let Ut,Lt;return{promise:new Promise((Vt,zt)=>{Ut=Vt,Lt=zt}),resolve:Ut,reject:Lt}},promisify(Ut){return new Promise((Lt,Ht)=>{Ut((Vt,...zt)=>Vt?Ht(Vt):Lt(...zt))})},debuglog(){return function(){}},format(Ut,...Lt){return Ut.replace(/%([sdifj])/g,function(...[Ht,Vt]){const zt=Lt.shift();return Vt==="f"?zt.toFixed(6):Vt==="j"?JSON.stringify(zt):Vt==="s"&&typeof zt=="object"?`${zt.constructor!==Object?zt.constructor.name:""} {}`.trim():zt.toString()})},inspect(Ut){switch(typeof Ut){case"string":if(Ut.includes("'"))if(Ut.includes('"')){if(!Ut.includes("`")&&!Ut.includes("${"))return`\`${Ut}\``}else return`"${Ut}"`;return`'${Ut}'`;case"number":return isNaN(Ut)?"NaN":Object.is(Ut,-0)?String(Ut):Ut;case"bigint":return`${String(Ut)}n`;case"boolean":case"undefined":return String(Ut);case"object":return"{}"}},types:{isAsyncFunction(Ut){return Ut instanceof xt},isArrayBufferView(Ut){return ArrayBuffer.isView(Ut)}},isBlob:Nt},kt.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(util);var utilExports=util.exports,operators={};const{format:format$1,inspect:inspect$1,AggregateError:CustomAggregateError}=utilExports,AggregateError$1=globalThis.AggregateError||CustomAggregateError,kIsNodeError=Symbol("kIsNodeError"),kTypes=["string","function","number","object","Function","Object","boolean","bigint","symbol"],classRegExp=/^([A-Z][a-z0-9]*)+$/,nodeInternalPrefix="__node_internal_",codes$1={};function assert(kt,At){if(!kt)throw new codes$1.ERR_INTERNAL_ASSERTION(At)}function addNumericalSeparator(kt){let At="",xt=kt.length;const Bt=kt[0]==="-"?1:0;for(;xt>=Bt+4;xt-=3)At=`_${kt.slice(xt-3,xt)}${At}`;return`${kt.slice(0,xt)}${At}`}function getMessage(kt,At,xt){if(typeof At=="function")return assert(At.length<=xt.length,`Code: ${kt}; The provided arguments length (${xt.length}) does not match the required ones (${At.length}).`),At(...xt);const Bt=(At.match(/%[dfijoOs]/g)||[]).length;return assert(Bt===xt.length,`Code: ${kt}; The provided arguments length (${xt.length}) does not match the required ones (${Bt}).`),xt.length===0?At:format$1(At,...xt)}function E(kt,At,xt){xt||(xt=Error);class Bt extends xt{constructor(...jt){super(getMessage(kt,At,jt))}toString(){return`${this.name} [${kt}]: ${this.message}`}}Object.defineProperties(Bt.prototype,{name:{value:xt.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${kt}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),Bt.prototype.code=kt,Bt.prototype[kIsNodeError]=!0,codes$1[kt]=Bt}function hideStackFrames$1(kt){const At=nodeInternalPrefix+kt.name;return Object.defineProperty(kt,"name",{value:At}),kt}function aggregateTwoErrors$2(kt,At){if(kt&&At&&kt!==At){if(Array.isArray(At.errors))return At.errors.push(kt),At;const xt=new AggregateError$1([At,kt],At.message);return xt.code=At.code,xt}return kt||At}let AbortError$8=class extends Error{constructor(At="The operation was aborted",xt=void 0){if(xt!==void 0&&typeof xt!="object")throw new codes$1.ERR_INVALID_ARG_TYPE("options","Object",xt);super(At,xt),this.code="ABORT_ERR",this.name="AbortError"}};E("ERR_ASSERTION","%s",Error);E("ERR_INVALID_ARG_TYPE",(kt,At,xt)=>{assert(typeof kt=="string","'name' must be a string"),Array.isArray(At)||(At=[At]);let Bt="The ";kt.endsWith(" argument")?Bt+=`${kt} `:Bt+=`"${kt}" ${kt.includes(".")?"property":"argument"} `,Bt+="must be ";const Nt=[],jt=[],Ut=[];for(const Ht of At)assert(typeof Ht=="string","All expected entries have to be of type string"),kTypes.includes(Ht)?Nt.push(Ht.toLowerCase()):classRegExp.test(Ht)?jt.push(Ht):(assert(Ht!=="object",'The value "object" should be written as "Object"'),Ut.push(Ht));if(jt.length>0){const Ht=Nt.indexOf("object");Ht!==-1&&(Nt.splice(Nt,Ht,1),jt.push("Object"))}if(Nt.length>0){switch(Nt.length){case 1:Bt+=`of type ${Nt[0]}`;break;case 2:Bt+=`one of type ${Nt[0]} or ${Nt[1]}`;break;default:{const Ht=Nt.pop();Bt+=`one of type ${Nt.join(", ")}, or ${Ht}`}}(jt.length>0||Ut.length>0)&&(Bt+=" or ")}if(jt.length>0){switch(jt.length){case 1:Bt+=`an instance of ${jt[0]}`;break;case 2:Bt+=`an instance of ${jt[0]} or ${jt[1]}`;break;default:{const Ht=jt.pop();Bt+=`an instance of ${jt.join(", ")}, or ${Ht}`}}Ut.length>0&&(Bt+=" or ")}switch(Ut.length){case 0:break;case 1:Ut[0].toLowerCase()!==Ut[0]&&(Bt+="an "),Bt+=`${Ut[0]}`;break;case 2:Bt+=`one of ${Ut[0]} or ${Ut[1]}`;break;default:{const Ht=Ut.pop();Bt+=`one of ${Ut.join(", ")}, or ${Ht}`}}if(xt==null)Bt+=`. Received ${xt}`;else if(typeof xt=="function"&&xt.name)Bt+=`. Received function ${xt.name}`;else if(typeof xt=="object"){var Lt;if((Lt=xt.constructor)!==null&&Lt!==void 0&&Lt.name)Bt+=`. Received an instance of ${xt.constructor.name}`;else{const Ht=inspect$1(xt,{depth:-1});Bt+=`. Received ${Ht}`}}else{let Ht=inspect$1(xt,{colors:!1});Ht.length>25&&(Ht=`${Ht.slice(0,25)}...`),Bt+=`. Received type ${typeof xt} (${Ht})`}return Bt},TypeError);E("ERR_INVALID_ARG_VALUE",(kt,At,xt="is invalid")=>{let Bt=inspect$1(At);return Bt.length>128&&(Bt=Bt.slice(0,128)+"..."),`The ${kt.includes(".")?"property":"argument"} '${kt}' ${xt}. Received ${Bt}`},TypeError);E("ERR_INVALID_RETURN_VALUE",(kt,At,xt)=>{var Bt;const Nt=xt!=null&&(Bt=xt.constructor)!==null&&Bt!==void 0&&Bt.name?`instance of ${xt.constructor.name}`:`type ${typeof xt}`;return`Expected ${kt} to be returned from the "${At}" function but got ${Nt}.`},TypeError);E("ERR_MISSING_ARGS",(...kt)=>{assert(kt.length>0,"At least one arg needs to be specified");let At;const xt=kt.length;switch(kt=(Array.isArray(kt)?kt:[kt]).map(Bt=>`"${Bt}"`).join(" or "),xt){case 1:At+=`The ${kt[0]} argument`;break;case 2:At+=`The ${kt[0]} and ${kt[1]} arguments`;break;default:{const Bt=kt.pop();At+=`The ${kt.join(", ")}, and ${Bt} arguments`}break}return`${At} must be specified`},TypeError);E("ERR_OUT_OF_RANGE",(kt,At,xt)=>{assert(At,'Missing "range" argument');let Bt;return Number.isInteger(xt)&&Math.abs(xt)>2**32?Bt=addNumericalSeparator(String(xt)):typeof xt=="bigint"?(Bt=String(xt),(xt>2n**32n||xt<-(2n**32n))&&(Bt=addNumericalSeparator(Bt)),Bt+="n"):Bt=inspect$1(xt),`The value of "${kt}" is out of range. It must be ${At}. Received ${Bt}`},RangeError);E("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);E("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);E("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);E("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);E("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);E("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);E("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);E("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);E("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);E("ERR_STREAM_WRITE_AFTER_END","write after end",Error);E("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var errors={AbortError:AbortError$8,aggregateTwoErrors:hideStackFrames$1(aggregateTwoErrors$2),hideStackFrames:hideStackFrames$1,codes:codes$1};const{ArrayIsArray:ArrayIsArray$2,ArrayPrototypeIncludes,ArrayPrototypeJoin,ArrayPrototypeMap,NumberIsInteger:NumberIsInteger$1,NumberIsNaN:NumberIsNaN$1,NumberMAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER,NumberParseInt,ObjectPrototypeHasOwnProperty,RegExpPrototypeExec,String:String$1,StringPrototypeToUpperCase,StringPrototypeTrim}=primordials,{hideStackFrames,codes:{ERR_SOCKET_BAD_PORT,ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$5,ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$3,ERR_OUT_OF_RANGE:ERR_OUT_OF_RANGE$1,ERR_UNKNOWN_SIGNAL}}=errors,{normalizeEncoding}=utilExports,{isAsyncFunction,isArrayBufferView}=utilExports.types,signals={};function isInt32(kt){return kt===(kt|0)}function isUint32(kt){return kt===kt>>>0}const octalReg=/^[0-7]+$/,modeDesc="must be a 32-bit unsigned integer or an octal string";function parseFileMode(kt,At,xt){if(typeof kt>"u"&&(kt=xt),typeof kt=="string"){if(RegExpPrototypeExec(octalReg,kt)===null)throw new ERR_INVALID_ARG_VALUE$3(At,kt,modeDesc);kt=NumberParseInt(kt,8)}return validateUint32(kt,At),kt}const validateInteger$1=hideStackFrames((kt,At,xt=NumberMIN_SAFE_INTEGER,Bt=NumberMAX_SAFE_INTEGER)=>{if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$5(At,"number",kt);if(!NumberIsInteger$1(kt))throw new ERR_OUT_OF_RANGE$1(At,"an integer",kt);if(kt<xt||kt>Bt)throw new ERR_OUT_OF_RANGE$1(At,`>= ${xt} && <= ${Bt}`,kt)}),validateInt32=hideStackFrames((kt,At,xt=-2147483648,Bt=2147483647)=>{if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$5(At,"number",kt);if(!NumberIsInteger$1(kt))throw new ERR_OUT_OF_RANGE$1(At,"an integer",kt);if(kt<xt||kt>Bt)throw new ERR_OUT_OF_RANGE$1(At,`>= ${xt} && <= ${Bt}`,kt)}),validateUint32=hideStackFrames((kt,At,xt=!1)=>{if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$5(At,"number",kt);if(!NumberIsInteger$1(kt))throw new ERR_OUT_OF_RANGE$1(At,"an integer",kt);const Bt=xt?1:0,Nt=4294967295;if(kt<Bt||kt>Nt)throw new ERR_OUT_OF_RANGE$1(At,`>= ${Bt} && <= ${Nt}`,kt)});function validateString(kt,At){if(typeof kt!="string")throw new ERR_INVALID_ARG_TYPE$5(At,"string",kt)}function validateNumber(kt,At,xt=void 0,Bt){if(typeof kt!="number")throw new ERR_INVALID_ARG_TYPE$5(At,"number",kt);if(xt!=null&&kt<xt||Bt!=null&&kt>Bt||(xt!=null||Bt!=null)&&NumberIsNaN$1(kt))throw new ERR_OUT_OF_RANGE$1(At,`${xt!=null?`>= ${xt}`:""}${xt!=null&&Bt!=null?" && ":""}${Bt!=null?`<= ${Bt}`:""}`,kt)}const validateOneOf=hideStackFrames((kt,At,xt)=>{if(!ArrayPrototypeIncludes(xt,kt)){const Nt="must be one of: "+ArrayPrototypeJoin(ArrayPrototypeMap(xt,jt=>typeof jt=="string"?`'${jt}'`:String$1(jt)),", ");throw new ERR_INVALID_ARG_VALUE$3(At,kt,Nt)}});function validateBoolean$1(kt,At){if(typeof kt!="boolean")throw new ERR_INVALID_ARG_TYPE$5(At,"boolean",kt)}function getOwnPropertyValueOrDefault(kt,At,xt){return kt==null||!ObjectPrototypeHasOwnProperty(kt,At)?xt:kt[At]}const validateObject$3=hideStackFrames((kt,At,xt=null)=>{const Bt=getOwnPropertyValueOrDefault(xt,"allowArray",!1),Nt=getOwnPropertyValueOrDefault(xt,"allowFunction",!1);if(!getOwnPropertyValueOrDefault(xt,"nullable",!1)&&kt===null||!Bt&&ArrayIsArray$2(kt)||typeof kt!="object"&&(!Nt||typeof kt!="function"))throw new ERR_INVALID_ARG_TYPE$5(At,"Object",kt)}),validateDictionary=hideStackFrames((kt,At)=>{if(kt!=null&&typeof kt!="object"&&typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$5(At,"a dictionary",kt)}),validateArray=hideStackFrames((kt,At,xt=0)=>{if(!ArrayIsArray$2(kt))throw new ERR_INVALID_ARG_TYPE$5(At,"Array",kt);if(kt.length<xt){const Bt=`must be longer than ${xt}`;throw new ERR_INVALID_ARG_VALUE$3(At,kt,Bt)}});function validateStringArray(kt,At){validateArray(kt,At);for(let xt=0;xt<kt.length;xt++)validateString(kt[xt],`${At}[${xt}]`)}function validateBooleanArray(kt,At){validateArray(kt,At);for(let xt=0;xt<kt.length;xt++)validateBoolean$1(kt[xt],`${At}[${xt}]`)}function validateSignalName(kt,At="signal"){if(validateString(kt,At),signals[kt]===void 0)throw signals[StringPrototypeToUpperCase(kt)]!==void 0?new ERR_UNKNOWN_SIGNAL(kt+" (signals must use all capital letters)"):new ERR_UNKNOWN_SIGNAL(kt)}const validateBuffer=hideStackFrames((kt,At="buffer")=>{if(!isArrayBufferView(kt))throw new ERR_INVALID_ARG_TYPE$5(At,["Buffer","TypedArray","DataView"],kt)});function validateEncoding(kt,At){const xt=normalizeEncoding(At),Bt=kt.length;if(xt==="hex"&&Bt%2!==0)throw new ERR_INVALID_ARG_VALUE$3("encoding",At,`is invalid for data of length ${Bt}`)}function validatePort(kt,At="Port",xt=!0){if(typeof kt!="number"&&typeof kt!="string"||typeof kt=="string"&&StringPrototypeTrim(kt).length===0||+kt!==+kt>>>0||kt>65535||kt===0&&!xt)throw new ERR_SOCKET_BAD_PORT(At,kt,xt);return kt|0}const validateAbortSignal$3=hideStackFrames((kt,At)=>{if(kt!==void 0&&(kt===null||typeof kt!="object"||!("aborted"in kt)))throw new ERR_INVALID_ARG_TYPE$5(At,"AbortSignal",kt)}),validateFunction$2=hideStackFrames((kt,At)=>{if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$5(At,"Function",kt)}),validatePlainFunction=hideStackFrames((kt,At)=>{if(typeof kt!="function"||isAsyncFunction(kt))throw new ERR_INVALID_ARG_TYPE$5(At,"Function",kt)}),validateUndefined=hideStackFrames((kt,At)=>{if(kt!==void 0)throw new ERR_INVALID_ARG_TYPE$5(At,"undefined",kt)});function validateUnion(kt,At,xt){if(!ArrayPrototypeIncludes(xt,kt))throw new ERR_INVALID_ARG_TYPE$5(At,`('${ArrayPrototypeJoin(xt,"|")}')`,kt)}const linkValueRegExp=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function validateLinkHeaderFormat(kt,At){if(typeof kt>"u"||!RegExpPrototypeExec(linkValueRegExp,kt))throw new ERR_INVALID_ARG_VALUE$3(At,kt,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function validateLinkHeaderValue(kt){if(typeof kt=="string")return validateLinkHeaderFormat(kt,"hints"),kt;if(ArrayIsArray$2(kt)){const At=kt.length;let xt="";if(At===0)return xt;for(let Bt=0;Bt<At;Bt++){const Nt=kt[Bt];validateLinkHeaderFormat(Nt,"hints"),xt+=Nt,Bt!==At-1&&(xt+=", ")}return xt}throw new ERR_INVALID_ARG_VALUE$3("hints",kt,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var validators={isInt32,isUint32,parseFileMode,validateArray,validateStringArray,validateBooleanArray,validateBoolean:validateBoolean$1,validateBuffer,validateDictionary,validateEncoding,validateFunction:validateFunction$2,validateInt32,validateInteger:validateInteger$1,validateNumber,validateObject:validateObject$3,validateOneOf,validatePlainFunction,validatePort,validateSignalName,validateString,validateUint32,validateUndefined,validateUnion,validateAbortSignal:validateAbortSignal$3,validateLinkHeaderValue},endOfStream={exports:{}};const{Symbol:Symbol$4,SymbolAsyncIterator:SymbolAsyncIterator$2,SymbolIterator:SymbolIterator$2,SymbolFor}=primordials,kDestroyed$1=Symbol$4("kDestroyed"),kIsErrored=Symbol$4("kIsErrored"),kIsReadable=Symbol$4("kIsReadable"),kIsDisturbed=Symbol$4("kIsDisturbed"),kIsClosedPromise$1=SymbolFor("nodejs.webstream.isClosedPromise"),kControllerErrorFunction=SymbolFor("nodejs.webstream.controllerErrorFunction");function isReadableNodeStream$2(kt,At=!1){var xt;return!!(kt&&typeof kt.pipe=="function"&&typeof kt.on=="function"&&(!At||typeof kt.pause=="function"&&typeof kt.resume=="function")&&(!kt._writableState||((xt=kt._readableState)===null||xt===void 0?void 0:xt.readable)!==!1)&&(!kt._writableState||kt._readableState))}function isWritableNodeStream$1(kt){var At;return!!(kt&&typeof kt.write=="function"&&typeof kt.on=="function"&&(!kt._readableState||((At=kt._writableState)===null||At===void 0?void 0:At.writable)!==!1))}function isDuplexNodeStream(kt){return!!(kt&&typeof kt.pipe=="function"&&kt._readableState&&typeof kt.on=="function"&&typeof kt.write=="function")}function isNodeStream$4(kt){return kt&&(kt._readableState||kt._writableState||typeof kt.write=="function"&&typeof kt.on=="function"||typeof kt.pipe=="function"&&typeof kt.on=="function")}function isReadableStream$3(kt){return!!(kt&&!isNodeStream$4(kt)&&typeof kt.pipeThrough=="function"&&typeof kt.getReader=="function"&&typeof kt.cancel=="function")}function isWritableStream$2(kt){return!!(kt&&!isNodeStream$4(kt)&&typeof kt.getWriter=="function"&&typeof kt.abort=="function")}function isTransformStream$2(kt){return!!(kt&&!isNodeStream$4(kt)&&typeof kt.readable=="object"&&typeof kt.writable=="object")}function isWebStream$2(kt){return isReadableStream$3(kt)||isWritableStream$2(kt)||isTransformStream$2(kt)}function isIterable$2(kt,At){return kt==null?!1:At===!0?typeof kt[SymbolAsyncIterator$2]=="function":At===!1?typeof kt[SymbolIterator$2]=="function":typeof kt[SymbolAsyncIterator$2]=="function"||typeof kt[SymbolIterator$2]=="function"}function isDestroyed$1(kt){if(!isNodeStream$4(kt))return null;const At=kt._writableState,xt=kt._readableState,Bt=At||xt;return!!(kt.destroyed||kt[kDestroyed$1]||Bt!=null&&Bt.destroyed)}function isWritableEnded(kt){if(!isWritableNodeStream$1(kt))return null;if(kt.writableEnded===!0)return!0;const At=kt._writableState;return At!=null&&At.errored?!1:typeof(At==null?void 0:At.ended)!="boolean"?null:At.ended}function isWritableFinished$1(kt,At){if(!isWritableNodeStream$1(kt))return null;if(kt.writableFinished===!0)return!0;const xt=kt._writableState;return xt!=null&&xt.errored?!1:typeof(xt==null?void 0:xt.finished)!="boolean"?null:!!(xt.finished||At===!1&&xt.ended===!0&&xt.length===0)}function isReadableEnded$1(kt){if(!isReadableNodeStream$2(kt))return null;if(kt.readableEnded===!0)return!0;const At=kt._readableState;return!At||At.errored?!1:typeof(At==null?void 0:At.ended)!="boolean"?null:At.ended}function isReadableFinished$1(kt,At){if(!isReadableNodeStream$2(kt))return null;const xt=kt._readableState;return xt!=null&&xt.errored?!1:typeof(xt==null?void 0:xt.endEmitted)!="boolean"?null:!!(xt.endEmitted||At===!1&&xt.ended===!0&&xt.length===0)}function isReadable$3(kt){return kt&&kt[kIsReadable]!=null?kt[kIsReadable]:typeof(kt==null?void 0:kt.readable)!="boolean"?null:isDestroyed$1(kt)?!1:isReadableNodeStream$2(kt)&&kt.readable&&!isReadableFinished$1(kt)}function isWritable$3(kt){return typeof(kt==null?void 0:kt.writable)!="boolean"?null:isDestroyed$1(kt)?!1:isWritableNodeStream$1(kt)&&kt.writable&&!isWritableEnded(kt)}function isFinished$1(kt,At){return isNodeStream$4(kt)?isDestroyed$1(kt)?!0:!((At==null?void 0:At.readable)!==!1&&isReadable$3(kt)||(At==null?void 0:At.writable)!==!1&&isWritable$3(kt)):null}function isWritableErrored$1(kt){var At,xt;return isNodeStream$4(kt)?kt.writableErrored?kt.writableErrored:(At=(xt=kt._writableState)===null||xt===void 0?void 0:xt.errored)!==null&&At!==void 0?At:null:null}function isReadableErrored$1(kt){var At,xt;return isNodeStream$4(kt)?kt.readableErrored?kt.readableErrored:(At=(xt=kt._readableState)===null||xt===void 0?void 0:xt.errored)!==null&&At!==void 0?At:null:null}function isClosed$1(kt){if(!isNodeStream$4(kt))return null;if(typeof kt.closed=="boolean")return kt.closed;const At=kt._writableState,xt=kt._readableState;return typeof(At==null?void 0:At.closed)=="boolean"||typeof(xt==null?void 0:xt.closed)=="boolean"?(At==null?void 0:At.closed)||(xt==null?void 0:xt.closed):typeof kt._closed=="boolean"&&isOutgoingMessage(kt)?kt._closed:null}function isOutgoingMessage(kt){return typeof kt._closed=="boolean"&&typeof kt._defaultKeepAlive=="boolean"&&typeof kt._removedConnection=="boolean"&&typeof kt._removedContLen=="boolean"}function isServerResponse(kt){return typeof kt._sent100=="boolean"&&isOutgoingMessage(kt)}function isServerRequest$1(kt){var At;return typeof kt._consuming=="boolean"&&typeof kt._dumped=="boolean"&&((At=kt.req)===null||At===void 0?void 0:At.upgradeOrConnect)===void 0}function willEmitClose(kt){if(!isNodeStream$4(kt))return null;const At=kt._writableState,xt=kt._readableState,Bt=At||xt;return!Bt&&isServerResponse(kt)||!!(Bt&&Bt.autoDestroy&&Bt.emitClose&&Bt.closed===!1)}function isDisturbed(kt){var At;return!!(kt&&((At=kt[kIsDisturbed])!==null&&At!==void 0?At:kt.readableDidRead||kt.readableAborted))}function isErrored(kt){var At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt;return!!(kt&&((At=(xt=(Bt=(Nt=(jt=(Ut=kt[kIsErrored])!==null&&Ut!==void 0?Ut:kt.readableErrored)!==null&&jt!==void 0?jt:kt.writableErrored)!==null&&Nt!==void 0?Nt:(Lt=kt._readableState)===null||Lt===void 0?void 0:Lt.errorEmitted)!==null&&Bt!==void 0?Bt:(Ht=kt._writableState)===null||Ht===void 0?void 0:Ht.errorEmitted)!==null&&xt!==void 0?xt:(Vt=kt._readableState)===null||Vt===void 0?void 0:Vt.errored)!==null&&At!==void 0?At:!((zt=kt._writableState)===null||zt===void 0)&&zt.errored))}var utils$1={kDestroyed:kDestroyed$1,isDisturbed,kIsDisturbed,isErrored,kIsErrored,isReadable:isReadable$3,kIsReadable,kIsClosedPromise:kIsClosedPromise$1,kControllerErrorFunction,isClosed:isClosed$1,isDestroyed:isDestroyed$1,isDuplexNodeStream,isFinished:isFinished$1,isIterable:isIterable$2,isReadableNodeStream:isReadableNodeStream$2,isReadableStream:isReadableStream$3,isReadableEnded:isReadableEnded$1,isReadableFinished:isReadableFinished$1,isReadableErrored:isReadableErrored$1,isNodeStream:isNodeStream$4,isWebStream:isWebStream$2,isWritable:isWritable$3,isWritableNodeStream:isWritableNodeStream$1,isWritableStream:isWritableStream$2,isWritableEnded,isWritableFinished:isWritableFinished$1,isWritableErrored:isWritableErrored$1,isServerRequest:isServerRequest$1,isServerResponse,willEmitClose,isTransformStream:isTransformStream$2};const process$3=browserExports$3,{AbortError:AbortError$7,codes}=errors,{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$4,ERR_STREAM_PREMATURE_CLOSE:ERR_STREAM_PREMATURE_CLOSE$1}=codes,{kEmptyObject,once:once$1}=utilExports,{validateAbortSignal:validateAbortSignal$2,validateFunction:validateFunction$1,validateObject:validateObject$2,validateBoolean}=validators,{Promise:Promise$3,PromisePrototypeThen:PromisePrototypeThen$2}=primordials,{isClosed,isReadable:isReadable$2,isReadableNodeStream:isReadableNodeStream$1,isReadableStream:isReadableStream$2,isReadableFinished,isReadableErrored,isWritable:isWritable$2,isWritableNodeStream,isWritableStream:isWritableStream$1,isWritableFinished,isWritableErrored,isNodeStream:isNodeStream$3,willEmitClose:_willEmitClose,kIsClosedPromise}=utils$1;function isRequest$1(kt){return kt.setHeader&&typeof kt.abort=="function"}const nop=()=>{};function eos$2(kt,At,xt){var Bt,Nt;if(arguments.length===2?(xt=At,At=kEmptyObject):At==null?At=kEmptyObject:validateObject$2(At,"options"),validateFunction$1(xt,"callback"),validateAbortSignal$2(At.signal,"options.signal"),xt=once$1(xt),isReadableStream$2(kt)||isWritableStream$1(kt))return eosWeb(kt,At,xt);if(!isNodeStream$3(kt))throw new ERR_INVALID_ARG_TYPE$4("stream",["ReadableStream","WritableStream","Stream"],kt);const jt=(Bt=At.readable)!==null&&Bt!==void 0?Bt:isReadableNodeStream$1(kt),Ut=(Nt=At.writable)!==null&&Nt!==void 0?Nt:isWritableNodeStream(kt),Lt=kt._writableState,Ht=kt._readableState,Vt=()=>{kt.writable||Jt()};let zt=_willEmitClose(kt)&&isReadableNodeStream$1(kt)===jt&&isWritableNodeStream(kt)===Ut,Wt=isWritableFinished(kt,!1);const Jt=()=>{Wt=!0,kt.destroyed&&(zt=!1),!(zt&&(!kt.readable||jt))&&(!jt||Qt)&&xt.call(kt)};let Qt=isReadableFinished(kt,!1);const Xt=()=>{Qt=!0,kt.destroyed&&(zt=!1),!(zt&&(!kt.writable||Ut))&&(!Ut||Wt)&&xt.call(kt)},tr=yr=>{xt.call(kt,yr)};let rr=isClosed(kt);const nr=()=>{rr=!0;const yr=isWritableErrored(kt)||isReadableErrored(kt);if(yr&&typeof yr!="boolean")return xt.call(kt,yr);if(jt&&!Qt&&isReadableNodeStream$1(kt,!0)&&!isReadableFinished(kt,!1))return xt.call(kt,new ERR_STREAM_PREMATURE_CLOSE$1);if(Ut&&!Wt&&!isWritableFinished(kt,!1))return xt.call(kt,new ERR_STREAM_PREMATURE_CLOSE$1);xt.call(kt)},ar=()=>{rr=!0;const yr=isWritableErrored(kt)||isReadableErrored(kt);if(yr&&typeof yr!="boolean")return xt.call(kt,yr);xt.call(kt)},ir=()=>{kt.req.on("finish",Jt)};isRequest$1(kt)?(kt.on("complete",Jt),zt||kt.on("abort",nr),kt.req?ir():kt.on("request",ir)):Ut&&!Lt&&(kt.on("end",Vt),kt.on("close",Vt)),!zt&&typeof kt.aborted=="boolean"&&kt.on("aborted",nr),kt.on("end",Xt),kt.on("finish",Jt),At.error!==!1&&kt.on("error",tr),kt.on("close",nr),rr?process$3.nextTick(nr):Lt!=null&&Lt.errorEmitted||Ht!=null&&Ht.errorEmitted?zt||process$3.nextTick(ar):(!jt&&(!zt||isReadable$2(kt))&&(Wt||isWritable$2(kt)===!1)||!Ut&&(!zt||isWritable$2(kt))&&(Qt||isReadable$2(kt)===!1)||Ht&&kt.req&&kt.aborted)&&process$3.nextTick(ar);const lr=()=>{xt=nop,kt.removeListener("aborted",nr),kt.removeListener("complete",Jt),kt.removeListener("abort",nr),kt.removeListener("request",ir),kt.req&&kt.req.removeListener("finish",Jt),kt.removeListener("end",Vt),kt.removeListener("close",Vt),kt.removeListener("finish",Jt),kt.removeListener("end",Xt),kt.removeListener("error",tr),kt.removeListener("close",nr)};if(At.signal&&!rr){const yr=()=>{const Sr=xt;lr(),Sr.call(kt,new AbortError$7(void 0,{cause:At.signal.reason}))};if(At.signal.aborted)process$3.nextTick(yr);else{const Sr=xt;xt=once$1((...Ar)=>{At.signal.removeEventListener("abort",yr),Sr.apply(kt,Ar)}),At.signal.addEventListener("abort",yr)}}return lr}function eosWeb(kt,At,xt){let Bt=!1,Nt=nop;if(At.signal)if(Nt=()=>{Bt=!0,xt.call(kt,new AbortError$7(void 0,{cause:At.signal.reason}))},At.signal.aborted)process$3.nextTick(Nt);else{const Ut=xt;xt=once$1((...Lt)=>{At.signal.removeEventListener("abort",Nt),Ut.apply(kt,Lt)}),At.signal.addEventListener("abort",Nt)}const jt=(...Ut)=>{Bt||process$3.nextTick(()=>xt.apply(kt,Ut))};return PromisePrototypeThen$2(kt[kIsClosedPromise].promise,jt,jt),nop}function finished$1(kt,At){var xt;let Bt=!1;return At===null&&(At=kEmptyObject),(xt=At)!==null&&xt!==void 0&&xt.cleanup&&(validateBoolean(At.cleanup,"cleanup"),Bt=At.cleanup),new Promise$3((Nt,jt)=>{const Ut=eos$2(kt,At,Lt=>{Bt&&Ut(),Lt?jt(Lt):Nt()})})}endOfStream.exports=eos$2;endOfStream.exports.finished=finished$1;var endOfStreamExports=endOfStream.exports;const process$2=browserExports$3,{aggregateTwoErrors:aggregateTwoErrors$1,codes:{ERR_MULTIPLE_CALLBACK},AbortError:AbortError$6}=errors,{Symbol:Symbol$3}=primordials,{kDestroyed,isDestroyed,isFinished,isServerRequest}=utils$1,kDestroy=Symbol$3("kDestroy"),kConstruct=Symbol$3("kConstruct");function checkError(kt,At,xt){kt&&(kt.stack,At&&!At.errored&&(At.errored=kt),xt&&!xt.errored&&(xt.errored=kt))}function destroy(kt,At){const xt=this._readableState,Bt=this._writableState,Nt=Bt||xt;return Bt!=null&&Bt.destroyed||xt!=null&&xt.destroyed?(typeof At=="function"&&At(),this):(checkError(kt,Bt,xt),Bt&&(Bt.destroyed=!0),xt&&(xt.destroyed=!0),Nt.constructed?_destroy(this,kt,At):this.once(kDestroy,function(jt){_destroy(this,aggregateTwoErrors$1(jt,kt),At)}),this)}function _destroy(kt,At,xt){let Bt=!1;function Nt(jt){if(Bt)return;Bt=!0;const Ut=kt._readableState,Lt=kt._writableState;checkError(jt,Lt,Ut),Lt&&(Lt.closed=!0),Ut&&(Ut.closed=!0),typeof xt=="function"&&xt(jt),jt?process$2.nextTick(emitErrorCloseNT,kt,jt):process$2.nextTick(emitCloseNT,kt)}try{kt._destroy(At||null,Nt)}catch(jt){Nt(jt)}}function emitErrorCloseNT(kt,At){emitErrorNT(kt,At),emitCloseNT(kt)}function emitCloseNT(kt){const At=kt._readableState,xt=kt._writableState;xt&&(xt.closeEmitted=!0),At&&(At.closeEmitted=!0),(xt!=null&&xt.emitClose||At!=null&&At.emitClose)&&kt.emit("close")}function emitErrorNT(kt,At){const xt=kt._readableState,Bt=kt._writableState;Bt!=null&&Bt.errorEmitted||xt!=null&&xt.errorEmitted||(Bt&&(Bt.errorEmitted=!0),xt&&(xt.errorEmitted=!0),kt.emit("error",At))}function undestroy(){const kt=this._readableState,At=this._writableState;kt&&(kt.constructed=!0,kt.closed=!1,kt.closeEmitted=!1,kt.destroyed=!1,kt.errored=null,kt.errorEmitted=!1,kt.reading=!1,kt.ended=kt.readable===!1,kt.endEmitted=kt.readable===!1),At&&(At.constructed=!0,At.destroyed=!1,At.closed=!1,At.closeEmitted=!1,At.errored=null,At.errorEmitted=!1,At.finalCalled=!1,At.prefinished=!1,At.ended=At.writable===!1,At.ending=At.writable===!1,At.finished=At.writable===!1)}function errorOrDestroy(kt,At,xt){const Bt=kt._readableState,Nt=kt._writableState;if(Nt!=null&&Nt.destroyed||Bt!=null&&Bt.destroyed)return this;Bt!=null&&Bt.autoDestroy||Nt!=null&&Nt.autoDestroy?kt.destroy(At):At&&(At.stack,Nt&&!Nt.errored&&(Nt.errored=At),Bt&&!Bt.errored&&(Bt.errored=At),xt?process$2.nextTick(emitErrorNT,kt,At):emitErrorNT(kt,At))}function construct(kt,At){if(typeof kt._construct!="function")return;const xt=kt._readableState,Bt=kt._writableState;xt&&(xt.constructed=!1),Bt&&(Bt.constructed=!1),kt.once(kConstruct,At),!(kt.listenerCount(kConstruct)>1)&&process$2.nextTick(constructNT,kt)}function constructNT(kt){let At=!1;function xt(Bt){if(At){errorOrDestroy(kt,Bt??new ERR_MULTIPLE_CALLBACK);return}At=!0;const Nt=kt._readableState,jt=kt._writableState,Ut=jt||Nt;Nt&&(Nt.constructed=!0),jt&&(jt.constructed=!0),Ut.destroyed?kt.emit(kDestroy,Bt):Bt?errorOrDestroy(kt,Bt,!0):process$2.nextTick(emitConstructNT,kt)}try{kt._construct(Bt=>{process$2.nextTick(xt,Bt)})}catch(Bt){process$2.nextTick(xt,Bt)}}function emitConstructNT(kt){kt.emit(kConstruct)}function isRequest(kt){return(kt==null?void 0:kt.setHeader)&&typeof kt.abort=="function"}function emitCloseLegacy(kt){kt.emit("close")}function emitErrorCloseLegacy(kt,At){kt.emit("error",At),process$2.nextTick(emitCloseLegacy,kt)}function destroyer$2(kt,At){!kt||isDestroyed(kt)||(!At&&!isFinished(kt)&&(At=new AbortError$6),isServerRequest(kt)?(kt.socket=null,kt.destroy(At)):isRequest(kt)?kt.abort():isRequest(kt.req)?kt.req.abort():typeof kt.destroy=="function"?kt.destroy(At):typeof kt.close=="function"?kt.close():At?process$2.nextTick(emitErrorCloseLegacy,kt,At):process$2.nextTick(emitCloseLegacy,kt),kt.destroyed||(kt[kDestroyed]=!0))}var destroy_1={construct,destroyer:destroyer$2,destroy,undestroy,errorOrDestroy};const{ArrayIsArray:ArrayIsArray$1,ObjectSetPrototypeOf:ObjectSetPrototypeOf$2}=primordials,{EventEmitter:EE}=eventsExports;function Stream$1(kt){EE.call(this,kt)}ObjectSetPrototypeOf$2(Stream$1.prototype,EE.prototype);ObjectSetPrototypeOf$2(Stream$1,EE);Stream$1.prototype.pipe=function(kt,At){const xt=this;function Bt(zt){kt.writable&&kt.write(zt)===!1&&xt.pause&&xt.pause()}xt.on("data",Bt);function Nt(){xt.readable&&xt.resume&&xt.resume()}kt.on("drain",Nt),!kt._isStdio&&(!At||At.end!==!1)&&(xt.on("end",Ut),xt.on("close",Lt));let jt=!1;function Ut(){jt||(jt=!0,kt.end())}function Lt(){jt||(jt=!0,typeof kt.destroy=="function"&&kt.destroy())}function Ht(zt){Vt(),EE.listenerCount(this,"error")===0&&this.emit("error",zt)}prependListener(xt,"error",Ht),prependListener(kt,"error",Ht);function Vt(){xt.removeListener("data",Bt),kt.removeListener("drain",Nt),xt.removeListener("end",Ut),xt.removeListener("close",Lt),xt.removeListener("error",Ht),kt.removeListener("error",Ht),xt.removeListener("end",Vt),xt.removeListener("close",Vt),kt.removeListener("close",Vt)}return xt.on("end",Vt),xt.on("close",Vt),kt.on("close",Vt),kt.emit("pipe",xt),kt};function prependListener(kt,At,xt){if(typeof kt.prependListener=="function")return kt.prependListener(At,xt);!kt._events||!kt._events[At]?kt.on(At,xt):ArrayIsArray$1(kt._events[At])?kt._events[At].unshift(xt):kt._events[At]=[xt,kt._events[At]]}var legacy={Stream:Stream$1,prependListener},addAbortSignal={exports:{}};(function(kt){const{AbortError:At,codes:xt}=errors,{isNodeStream:Bt,isWebStream:Nt,kControllerErrorFunction:jt}=utils$1,Ut=endOfStreamExports,{ERR_INVALID_ARG_TYPE:Lt}=xt,Ht=(Vt,zt)=>{if(typeof Vt!="object"||!("aborted"in Vt))throw new Lt(zt,"AbortSignal",Vt)};kt.exports.addAbortSignal=function(zt,Wt){if(Ht(zt,"signal"),!Bt(Wt)&&!Nt(Wt))throw new Lt("stream",["ReadableStream","WritableStream","Stream"],Wt);return kt.exports.addAbortSignalNoValidate(zt,Wt)},kt.exports.addAbortSignalNoValidate=function(Vt,zt){if(typeof Vt!="object"||!("aborted"in Vt))return zt;const Wt=Bt(zt)?()=>{zt.destroy(new At(void 0,{cause:Vt.reason}))}:()=>{zt[jt](new At(void 0,{cause:Vt.reason}))};return Vt.aborted?Wt():(Vt.addEventListener("abort",Wt),Ut(zt,()=>Vt.removeEventListener("abort",Wt))),zt}})(addAbortSignal);var addAbortSignalExports=addAbortSignal.exports;const{StringPrototypeSlice,SymbolIterator:SymbolIterator$1,TypedArrayPrototypeSet,Uint8Array:Uint8Array$1}=primordials,{Buffer:Buffer$1}=buffer$2,{inspect}=utilExports;var buffer_list=class{constructor(){this.head=null,this.tail=null,this.length=0}push(At){const xt={data:At,next:null};this.length>0?this.tail.next=xt:this.head=xt,this.tail=xt,++this.length}unshift(At){const xt={data:At,next:this.head};this.length===0&&(this.tail=xt),this.head=xt,++this.length}shift(){if(this.length===0)return;const At=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,At}clear(){this.head=this.tail=null,this.length=0}join(At){if(this.length===0)return"";let xt=this.head,Bt=""+xt.data;for(;(xt=xt.next)!==null;)Bt+=At+xt.data;return Bt}concat(At){if(this.length===0)return Buffer$1.alloc(0);const xt=Buffer$1.allocUnsafe(At>>>0);let Bt=this.head,Nt=0;for(;Bt;)TypedArrayPrototypeSet(xt,Bt.data,Nt),Nt+=Bt.data.length,Bt=Bt.next;return xt}consume(At,xt){const Bt=this.head.data;if(At<Bt.length){const Nt=Bt.slice(0,At);return this.head.data=Bt.slice(At),Nt}return At===Bt.length?this.shift():xt?this._getString(At):this._getBuffer(At)}first(){return this.head.data}*[SymbolIterator$1](){for(let At=this.head;At;At=At.next)yield At.data}_getString(At){let xt="",Bt=this.head,Nt=0;do{const jt=Bt.data;if(At>jt.length)xt+=jt,At-=jt.length;else{At===jt.length?(xt+=jt,++Nt,Bt.next?this.head=Bt.next:this.head=this.tail=null):(xt+=StringPrototypeSlice(jt,0,At),this.head=Bt,Bt.data=StringPrototypeSlice(jt,At));break}++Nt}while((Bt=Bt.next)!==null);return this.length-=Nt,xt}_getBuffer(At){const xt=Buffer$1.allocUnsafe(At),Bt=At;let Nt=this.head,jt=0;do{const Ut=Nt.data;if(At>Ut.length)TypedArrayPrototypeSet(xt,Ut,Bt-At),At-=Ut.length;else{At===Ut.length?(TypedArrayPrototypeSet(xt,Ut,Bt-At),++jt,Nt.next?this.head=Nt.next:this.head=this.tail=null):(TypedArrayPrototypeSet(xt,new Uint8Array$1(Ut.buffer,Ut.byteOffset,At),Bt-At),this.head=Nt,Nt.data=Ut.slice(At));break}++jt}while((Nt=Nt.next)!==null);return this.length-=jt,xt}[Symbol.for("nodejs.util.inspect.custom")](At,xt){return inspect(this,{...xt,depth:0,customInspect:!1})}};const{MathFloor:MathFloor$1,NumberIsInteger}=primordials,{ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$2}=errors.codes;function highWaterMarkFrom(kt,At,xt){return kt.highWaterMark!=null?kt.highWaterMark:At?kt[xt]:null}function getDefaultHighWaterMark(kt){return kt?16:16*1024}function getHighWaterMark$1(kt,At,xt,Bt){const Nt=highWaterMarkFrom(At,Bt,xt);if(Nt!=null){if(!NumberIsInteger(Nt)||Nt<0){const jt=Bt?`options.${xt}`:"options.highWaterMark";throw new ERR_INVALID_ARG_VALUE$2(jt,Nt)}return MathFloor$1(Nt)}return getDefaultHighWaterMark(kt.objectMode)}var state={getHighWaterMark:getHighWaterMark$1,getDefaultHighWaterMark};const process$1=browserExports$3,{PromisePrototypeThen:PromisePrototypeThen$1,SymbolAsyncIterator:SymbolAsyncIterator$1,SymbolIterator}=primordials,{Buffer}=buffer$2,{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$3,ERR_STREAM_NULL_VALUES}=errors.codes;function from$1(kt,At,xt){let Bt;if(typeof At=="string"||At instanceof Buffer)return new kt({objectMode:!0,...xt,read(){this.push(At),this.push(null)}});let Nt;if(At&&At[SymbolAsyncIterator$1])Nt=!0,Bt=At[SymbolAsyncIterator$1]();else if(At&&At[SymbolIterator])Nt=!1,Bt=At[SymbolIterator]();else throw new ERR_INVALID_ARG_TYPE$3("iterable",["Iterable"],At);const jt=new kt({objectMode:!0,highWaterMark:1,...xt});let Ut=!1;jt._read=function(){Ut||(Ut=!0,Ht())},jt._destroy=function(Vt,zt){PromisePrototypeThen$1(Lt(Vt),()=>process$1.nextTick(zt,Vt),Wt=>process$1.nextTick(zt,Wt||Vt))};async function Lt(Vt){const zt=Vt!=null,Wt=typeof Bt.throw=="function";if(zt&&Wt){const{value:Jt,done:Qt}=await Bt.throw(Vt);if(await Jt,Qt)return}if(typeof Bt.return=="function"){const{value:Jt}=await Bt.return();await Jt}}async function Ht(){for(;;){try{const{value:Vt,done:zt}=Nt?await Bt.next():Bt.next();if(zt)jt.push(null);else{const Wt=Vt&&typeof Vt.then=="function"?await Vt:Vt;if(Wt===null)throw Ut=!1,new ERR_STREAM_NULL_VALUES;if(jt.push(Wt))continue;Ut=!1}}catch(Vt){jt.destroy(Vt)}break}}return jt}var from_1=from$1,readable,hasRequiredReadable;function requireReadable(){if(hasRequiredReadable)return readable;hasRequiredReadable=1;const kt=browserExports$3,{ArrayPrototypeIndexOf:At,NumberIsInteger:xt,NumberIsNaN:Bt,NumberParseInt:Nt,ObjectDefineProperties:jt,ObjectKeys:Ut,ObjectSetPrototypeOf:Lt,Promise:Ht,SafeSet:Vt,SymbolAsyncIterator:zt,Symbol:Wt}=primordials;readable=fr,fr.ReadableState=gr;const{EventEmitter:Jt}=eventsExports,{Stream:Qt,prependListener:Xt}=legacy,{Buffer:tr}=buffer$2,{addAbortSignal:rr}=addAbortSignalExports,nr=endOfStreamExports;let ar=utilExports.debuglog("stream",Jr=>{ar=Jr});const ir=buffer_list,lr=destroy_1,{getHighWaterMark:yr,getDefaultHighWaterMark:Sr}=state,{aggregateTwoErrors:Ar,codes:{ERR_INVALID_ARG_TYPE:Dr,ERR_METHOD_NOT_IMPLEMENTED:Br,ERR_OUT_OF_RANGE:Lr,ERR_STREAM_PUSH_AFTER_EOF:Or,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:vr}}=errors,{validateObject:pr}=validators,dr=Wt("kPaused"),{StringDecoder:ur}=requireString_decoder(),$r=from_1;Lt(fr.prototype,Qt.prototype),Lt(fr,Qt);const wr=()=>{},{errorOrDestroy:Er}=lr;function gr(Jr,Yr,an){typeof an!="boolean"&&(an=Yr instanceof requireDuplex()),this.objectMode=!!(Jr&&Jr.objectMode),an&&(this.objectMode=this.objectMode||!!(Jr&&Jr.readableObjectMode)),this.highWaterMark=Jr?yr(this,Jr,"readableHighWaterMark",an):Sr(!1),this.buffer=new ir,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[dr]=null,this.errorEmitted=!1,this.emitClose=!Jr||Jr.emitClose!==!1,this.autoDestroy=!Jr||Jr.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=Jr&&Jr.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,Jr&&Jr.encoding&&(this.decoder=new ur(Jr.encoding),this.encoding=Jr.encoding)}function fr(Jr){if(!(this instanceof fr))return new fr(Jr);const Yr=this instanceof requireDuplex();this._readableState=new gr(Jr,this,Yr),Jr&&(typeof Jr.read=="function"&&(this._read=Jr.read),typeof Jr.destroy=="function"&&(this._destroy=Jr.destroy),typeof Jr.construct=="function"&&(this._construct=Jr.construct),Jr.signal&&!Yr&&rr(Jr.signal,this)),Qt.call(this,Jr),lr.construct(this,()=>{this._readableState.needReadable&&qr(this,this._readableState)})}fr.prototype.destroy=lr.destroy,fr.prototype._undestroy=lr.undestroy,fr.prototype._destroy=function(Jr,Yr){Yr(Jr)},fr.prototype[Jt.captureRejectionSymbol]=function(Jr){this.destroy(Jr)},fr.prototype.push=function(Jr,Yr){return br(this,Jr,Yr,!1)},fr.prototype.unshift=function(Jr,Yr){return br(this,Jr,Yr,!0)};function br(Jr,Yr,an,dn){ar("readableAddChunk",Yr);const cn=Jr._readableState;let vn;if(cn.objectMode||(typeof Yr=="string"?(an=an||cn.defaultEncoding,cn.encoding!==an&&(dn&&cn.encoding?Yr=tr.from(Yr,an).toString(cn.encoding):(Yr=tr.from(Yr,an),an=""))):Yr instanceof tr?an="":Qt._isUint8Array(Yr)?(Yr=Qt._uint8ArrayToBuffer(Yr),an=""):Yr!=null&&(vn=new Dr("chunk",["string","Buffer","Uint8Array"],Yr))),vn)Er(Jr,vn);else if(Yr===null)cn.reading=!1,Cr(Jr,cn);else if(cn.objectMode||Yr&&Yr.length>0)if(dn)if(cn.endEmitted)Er(Jr,new vr);else{if(cn.destroyed||cn.errored)return!1;_r(Jr,cn,Yr,!0)}else if(cn.ended)Er(Jr,new Or);else{if(cn.destroyed||cn.errored)return!1;cn.reading=!1,cn.decoder&&!an?(Yr=cn.decoder.write(Yr),cn.objectMode||Yr.length!==0?_r(Jr,cn,Yr,!1):qr(Jr,cn)):_r(Jr,cn,Yr,!1)}else dn||(cn.reading=!1,qr(Jr,cn));return!cn.ended&&(cn.length<cn.highWaterMark||cn.length===0)}function _r(Jr,Yr,an,dn){Yr.flowing&&Yr.length===0&&!Yr.sync&&Jr.listenerCount("data")>0?(Yr.multiAwaitDrain?Yr.awaitDrainWriters.clear():Yr.awaitDrainWriters=null,Yr.dataEmitted=!0,Jr.emit("data",an)):(Yr.length+=Yr.objectMode?1:an.length,dn?Yr.buffer.unshift(an):Yr.buffer.push(an),Yr.needReadable&&xr(Jr)),qr(Jr,Yr)}fr.prototype.isPaused=function(){const Jr=this._readableState;return Jr[dr]===!0||Jr.flowing===!1},fr.prototype.setEncoding=function(Jr){const Yr=new ur(Jr);this._readableState.decoder=Yr,this._readableState.encoding=this._readableState.decoder.encoding;const an=this._readableState.buffer;let dn="";for(const cn of an)dn+=Yr.write(cn);return an.clear(),dn!==""&&an.push(dn),this._readableState.length=dn.length,this};const Tr=1073741824;function Pr(Jr){if(Jr>Tr)throw new Lr("size","<= 1GiB",Jr);return Jr--,Jr|=Jr>>>1,Jr|=Jr>>>2,Jr|=Jr>>>4,Jr|=Jr>>>8,Jr|=Jr>>>16,Jr++,Jr}function Nr(Jr,Yr){return Jr<=0||Yr.length===0&&Yr.ended?0:Yr.objectMode?1:Bt(Jr)?Yr.flowing&&Yr.length?Yr.buffer.first().length:Yr.length:Jr<=Yr.length?Jr:Yr.ended?Yr.length:0}fr.prototype.read=function(Jr){ar("read",Jr),Jr===void 0?Jr=NaN:xt(Jr)||(Jr=Nt(Jr,10));const Yr=this._readableState,an=Jr;if(Jr>Yr.highWaterMark&&(Yr.highWaterMark=Pr(Jr)),Jr!==0&&(Yr.emittedReadable=!1),Jr===0&&Yr.needReadable&&((Yr.highWaterMark!==0?Yr.length>=Yr.highWaterMark:Yr.length>0)||Yr.ended))return ar("read: emitReadable",Yr.length,Yr.ended),Yr.length===0&&Yr.ended?Qr(this):xr(this),null;if(Jr=Nr(Jr,Yr),Jr===0&&Yr.ended)return Yr.length===0&&Qr(this),null;let dn=Yr.needReadable;if(ar("need readable",dn),(Yr.length===0||Yr.length-Jr<Yr.highWaterMark)&&(dn=!0,ar("length less than watermark",dn)),Yr.ended||Yr.reading||Yr.destroyed||Yr.errored||!Yr.constructed)dn=!1,ar("reading, ended or constructing",dn);else if(dn){ar("do read"),Yr.reading=!0,Yr.sync=!0,Yr.length===0&&(Yr.needReadable=!0);try{this._read(Yr.highWaterMark)}catch(vn){Er(this,vn)}Yr.sync=!1,Yr.reading||(Jr=Nr(an,Yr))}let cn;return Jr>0?cn=Hr(Jr,Yr):cn=null,cn===null?(Yr.needReadable=Yr.length<=Yr.highWaterMark,Jr=0):(Yr.length-=Jr,Yr.multiAwaitDrain?Yr.awaitDrainWriters.clear():Yr.awaitDrainWriters=null),Yr.length===0&&(Yr.ended||(Yr.needReadable=!0),an!==Jr&&Yr.ended&&Qr(this)),cn!==null&&!Yr.errorEmitted&&!Yr.closeEmitted&&(Yr.dataEmitted=!0,this.emit("data",cn)),cn};function Cr(Jr,Yr){if(ar("onEofChunk"),!Yr.ended){if(Yr.decoder){const an=Yr.decoder.end();an&&an.length&&(Yr.buffer.push(an),Yr.length+=Yr.objectMode?1:an.length)}Yr.ended=!0,Yr.sync?xr(Jr):(Yr.needReadable=!1,Yr.emittedReadable=!0,Rr(Jr))}}function xr(Jr){const Yr=Jr._readableState;ar("emitReadable",Yr.needReadable,Yr.emittedReadable),Yr.needReadable=!1,Yr.emittedReadable||(ar("emitReadable",Yr.flowing),Yr.emittedReadable=!0,kt.nextTick(Rr,Jr))}function Rr(Jr){const Yr=Jr._readableState;ar("emitReadable_",Yr.destroyed,Yr.length,Yr.ended),!Yr.destroyed&&!Yr.errored&&(Yr.length||Yr.ended)&&(Jr.emit("readable"),Yr.emittedReadable=!1),Yr.needReadable=!Yr.flowing&&!Yr.ended&&Yr.length<=Yr.highWaterMark,jr(Jr)}function qr(Jr,Yr){!Yr.readingMore&&Yr.constructed&&(Yr.readingMore=!0,kt.nextTick(Vr,Jr,Yr))}function Vr(Jr,Yr){for(;!Yr.reading&&!Yr.ended&&(Yr.length<Yr.highWaterMark||Yr.flowing&&Yr.length===0);){const an=Yr.length;if(ar("maybeReadMore read 0"),Jr.read(0),an===Yr.length)break}Yr.readingMore=!1}fr.prototype._read=function(Jr){throw new Br("_read()")},fr.prototype.pipe=function(Jr,Yr){const an=this,dn=this._readableState;dn.pipes.length===1&&(dn.multiAwaitDrain||(dn.multiAwaitDrain=!0,dn.awaitDrainWriters=new Vt(dn.awaitDrainWriters?[dn.awaitDrainWriters]:[]))),dn.pipes.push(Jr),ar("pipe count=%d opts=%j",dn.pipes.length,Yr);const vn=(!Yr||Yr.end!==!1)&&Jr!==kt.stdout&&Jr!==kt.stderr?Tn:Vn;dn.endEmitted?kt.nextTick(vn):an.once("end",vn),Jr.on("unpipe",_n);function _n(xn,zn){ar("onunpipe"),xn===an&&zn&&zn.hasUnpiped===!1&&(zn.hasUnpiped=!0,Un())}function Tn(){ar("onend"),Jr.end()}let $n,Kn=!1;function Un(){ar("cleanup"),Jr.removeListener("close",On),Jr.removeListener("finish",Hn),$n&&Jr.removeListener("drain",$n),Jr.removeListener("error",qn),Jr.removeListener("unpipe",_n),an.removeListener("end",Tn),an.removeListener("end",Vn),an.removeListener("data",Mn),Kn=!0,$n&&dn.awaitDrainWriters&&(!Jr._writableState||Jr._writableState.needDrain)&&$n()}function In(){Kn||(dn.pipes.length===1&&dn.pipes[0]===Jr?(ar("false write response, pause",0),dn.awaitDrainWriters=Jr,dn.multiAwaitDrain=!1):dn.pipes.length>1&&dn.pipes.includes(Jr)&&(ar("false write response, pause",dn.awaitDrainWriters.size),dn.awaitDrainWriters.add(Jr)),an.pause()),$n||($n=Gr(an,Jr),Jr.on("drain",$n))}an.on("data",Mn);function Mn(xn){ar("ondata");const zn=Jr.write(xn);ar("dest.write",zn),zn===!1&&In()}function qn(xn){if(ar("onerror",xn),Vn(),Jr.removeListener("error",qn),Jr.listenerCount("error")===0){const zn=Jr._writableState||Jr._readableState;zn&&!zn.errorEmitted?Er(Jr,xn):Jr.emit("error",xn)}}Xt(Jr,"error",qn);function On(){Jr.removeListener("finish",Hn),Vn()}Jr.once("close",On);function Hn(){ar("onfinish"),Jr.removeListener("close",On),Vn()}Jr.once("finish",Hn);function Vn(){ar("unpipe"),an.unpipe(Jr)}return Jr.emit("pipe",an),Jr.writableNeedDrain===!0?dn.flowing&&In():dn.flowing||(ar("pipe resume"),an.resume()),Jr};function Gr(Jr,Yr){return function(){const dn=Jr._readableState;dn.awaitDrainWriters===Yr?(ar("pipeOnDrain",1),dn.awaitDrainWriters=null):dn.multiAwaitDrain&&(ar("pipeOnDrain",dn.awaitDrainWriters.size),dn.awaitDrainWriters.delete(Yr)),(!dn.awaitDrainWriters||dn.awaitDrainWriters.size===0)&&Jr.listenerCount("data")&&Jr.resume()}}fr.prototype.unpipe=function(Jr){const Yr=this._readableState,an={hasUnpiped:!1};if(Yr.pipes.length===0)return this;if(!Jr){const cn=Yr.pipes;Yr.pipes=[],this.pause();for(let vn=0;vn<cn.length;vn++)cn[vn].emit("unpipe",this,{hasUnpiped:!1});return this}const dn=At(Yr.pipes,Jr);return dn===-1?this:(Yr.pipes.splice(dn,1),Yr.pipes.length===0&&this.pause(),Jr.emit("unpipe",this,an),this)},fr.prototype.on=function(Jr,Yr){const an=Qt.prototype.on.call(this,Jr,Yr),dn=this._readableState;return Jr==="data"?(dn.readableListening=this.listenerCount("readable")>0,dn.flowing!==!1&&this.resume()):Jr==="readable"&&!dn.endEmitted&&!dn.readableListening&&(dn.readableListening=dn.needReadable=!0,dn.flowing=!1,dn.emittedReadable=!1,ar("on readable",dn.length,dn.reading),dn.length?xr(this):dn.reading||kt.nextTick(kr,this)),an},fr.prototype.addListener=fr.prototype.on,fr.prototype.removeListener=function(Jr,Yr){const an=Qt.prototype.removeListener.call(this,Jr,Yr);return Jr==="readable"&&kt.nextTick(Ur,this),an},fr.prototype.off=fr.prototype.removeListener,fr.prototype.removeAllListeners=function(Jr){const Yr=Qt.prototype.removeAllListeners.apply(this,arguments);return(Jr==="readable"||Jr===void 0)&&kt.nextTick(Ur,this),Yr};function Ur(Jr){const Yr=Jr._readableState;Yr.readableListening=Jr.listenerCount("readable")>0,Yr.resumeScheduled&&Yr[dr]===!1?Yr.flowing=!0:Jr.listenerCount("data")>0?Jr.resume():Yr.readableListening||(Yr.flowing=null)}function kr(Jr){ar("readable nexttick read 0"),Jr.read(0)}fr.prototype.resume=function(){const Jr=this._readableState;return Jr.flowing||(ar("resume"),Jr.flowing=!Jr.readableListening,Fr(this,Jr)),Jr[dr]=!1,this};function Fr(Jr,Yr){Yr.resumeScheduled||(Yr.resumeScheduled=!0,kt.nextTick(Wr,Jr,Yr))}function Wr(Jr,Yr){ar("resume",Yr.reading),Yr.reading||Jr.read(0),Yr.resumeScheduled=!1,Jr.emit("resume"),jr(Jr),Yr.flowing&&!Yr.reading&&Jr.read(0)}fr.prototype.pause=function(){return ar("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(ar("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[dr]=!0,this};function jr(Jr){const Yr=Jr._readableState;for(ar("flow",Yr.flowing);Yr.flowing&&Jr.read()!==null;);}fr.prototype.wrap=function(Jr){let Yr=!1;Jr.on("data",dn=>{!this.push(dn)&&Jr.pause&&(Yr=!0,Jr.pause())}),Jr.on("end",()=>{this.push(null)}),Jr.on("error",dn=>{Er(this,dn)}),Jr.on("close",()=>{this.destroy()}),Jr.on("destroy",()=>{this.destroy()}),this._read=()=>{Yr&&Jr.resume&&(Yr=!1,Jr.resume())};const an=Ut(Jr);for(let dn=1;dn<an.length;dn++){const cn=an[dn];this[cn]===void 0&&typeof Jr[cn]=="function"&&(this[cn]=Jr[cn].bind(Jr))}return this},fr.prototype[zt]=function(){return Ir(this)},fr.prototype.iterator=function(Jr){return Jr!==void 0&&pr(Jr,"options"),Ir(this,Jr)};function Ir(Jr,Yr){typeof Jr.read!="function"&&(Jr=fr.wrap(Jr,{objectMode:!0}));const an=Mr(Jr,Yr);return an.stream=Jr,an}async function*Mr(Jr,Yr){let an=wr;function dn(_n){this===Jr?(an(),an=wr):an=_n}Jr.on("readable",dn);let cn;const vn=nr(Jr,{writable:!1},_n=>{cn=_n?Ar(cn,_n):null,an(),an=wr});try{for(;;){const _n=Jr.destroyed?null:Jr.read();if(_n!==null)yield _n;else{if(cn)throw cn;if(cn===null)return;await new Ht(dn)}}}catch(_n){throw cn=Ar(cn,_n),cn}finally{(cn||(Yr==null?void 0:Yr.destroyOnReturn)!==!1)&&(cn===void 0||Jr._readableState.autoDestroy)?lr.destroyer(Jr,null):(Jr.off("readable",dn),vn())}}jt(fr.prototype,{readable:{__proto__:null,get(){const Jr=this._readableState;return!!Jr&&Jr.readable!==!1&&!Jr.destroyed&&!Jr.errorEmitted&&!Jr.endEmitted},set(Jr){this._readableState&&(this._readableState.readable=!!Jr)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(Jr){this._readableState&&(this._readableState.flowing=Jr)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(Jr){this._readableState&&(this._readableState.destroyed=Jr)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),jt(gr.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[dr]!==!1},set(Jr){this[dr]=!!Jr}}}),fr._fromList=Hr;function Hr(Jr,Yr){if(Yr.length===0)return null;let an;return Yr.objectMode?an=Yr.buffer.shift():!Jr||Jr>=Yr.length?(Yr.decoder?an=Yr.buffer.join(""):Yr.buffer.length===1?an=Yr.buffer.first():an=Yr.buffer.concat(Yr.length),Yr.buffer.clear()):an=Yr.buffer.consume(Jr,Yr.decoder),an}function Qr(Jr){const Yr=Jr._readableState;ar("endReadable",Yr.endEmitted),Yr.endEmitted||(Yr.ended=!0,kt.nextTick(on,Yr,Jr))}function on(Jr,Yr){if(ar("endReadableNT",Jr.endEmitted,Jr.length),!Jr.errored&&!Jr.closeEmitted&&!Jr.endEmitted&&Jr.length===0){if(Jr.endEmitted=!0,Yr.emit("end"),Yr.writable&&Yr.allowHalfOpen===!1)kt.nextTick(nn,Yr);else if(Jr.autoDestroy){const an=Yr._writableState;(!an||an.autoDestroy&&(an.finished||an.writable===!1))&&Yr.destroy()}}}function nn(Jr){Jr.writable&&!Jr.writableEnded&&!Jr.destroyed&&Jr.end()}fr.from=function(Jr,Yr){return $r(fr,Jr,Yr)};let fn;function hn(){return fn===void 0&&(fn={}),fn}return fr.fromWeb=function(Jr,Yr){return hn().newStreamReadableFromReadableStream(Jr,Yr)},fr.toWeb=function(Jr,Yr){return hn().newReadableStreamFromStreamReadable(Jr,Yr)},fr.wrap=function(Jr,Yr){var an,dn;return new fr({objectMode:(an=(dn=Jr.readableObjectMode)!==null&&dn!==void 0?dn:Jr.objectMode)!==null&&an!==void 0?an:!0,...Yr,destroy(cn,vn){lr.destroyer(Jr,cn),vn(cn)}}).wrap(Jr)},readable}var writable,hasRequiredWritable;function requireWritable(){if(hasRequiredWritable)return writable;hasRequiredWritable=1;const kt=browserExports$3,{ArrayPrototypeSlice:At,Error:xt,FunctionPrototypeSymbolHasInstance:Bt,ObjectDefineProperty:Nt,ObjectDefineProperties:jt,ObjectSetPrototypeOf:Ut,StringPrototypeToLowerCase:Lt,Symbol:Ht,SymbolHasInstance:Vt}=primordials;writable=ur,ur.WritableState=pr;const{EventEmitter:zt}=eventsExports,Wt=legacy.Stream,{Buffer:Jt}=buffer$2,Qt=destroy_1,{addAbortSignal:Xt}=addAbortSignalExports,{getHighWaterMark:tr,getDefaultHighWaterMark:rr}=state,{ERR_INVALID_ARG_TYPE:nr,ERR_METHOD_NOT_IMPLEMENTED:ar,ERR_MULTIPLE_CALLBACK:ir,ERR_STREAM_CANNOT_PIPE:lr,ERR_STREAM_DESTROYED:yr,ERR_STREAM_ALREADY_FINISHED:Sr,ERR_STREAM_NULL_VALUES:Ar,ERR_STREAM_WRITE_AFTER_END:Dr,ERR_UNKNOWN_ENCODING:Br}=errors.codes,{errorOrDestroy:Lr}=Qt;Ut(ur.prototype,Wt.prototype),Ut(ur,Wt);function Or(){}const vr=Ht("kOnFinished");function pr(kr,Fr,Wr){typeof Wr!="boolean"&&(Wr=Fr instanceof requireDuplex()),this.objectMode=!!(kr&&kr.objectMode),Wr&&(this.objectMode=this.objectMode||!!(kr&&kr.writableObjectMode)),this.highWaterMark=kr?tr(this,kr,"writableHighWaterMark",Wr):rr(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const jr=!!(kr&&kr.decodeStrings===!1);this.decodeStrings=!jr,this.defaultEncoding=kr&&kr.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=fr.bind(void 0,Fr),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,dr(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!kr||kr.emitClose!==!1,this.autoDestroy=!kr||kr.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[vr]=[]}function dr(kr){kr.buffered=[],kr.bufferedIndex=0,kr.allBuffers=!0,kr.allNoop=!0}pr.prototype.getBuffer=function(){return At(this.buffered,this.bufferedIndex)},Nt(pr.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function ur(kr){const Fr=this instanceof requireDuplex();if(!Fr&&!Bt(ur,this))return new ur(kr);this._writableState=new pr(kr,this,Fr),kr&&(typeof kr.write=="function"&&(this._write=kr.write),typeof kr.writev=="function"&&(this._writev=kr.writev),typeof kr.destroy=="function"&&(this._destroy=kr.destroy),typeof kr.final=="function"&&(this._final=kr.final),typeof kr.construct=="function"&&(this._construct=kr.construct),kr.signal&&Xt(kr.signal,this)),Wt.call(this,kr),Qt.construct(this,()=>{const Wr=this._writableState;Wr.writing||Pr(this,Wr),Rr(this,Wr)})}Nt(ur,Vt,{__proto__:null,value:function(kr){return Bt(this,kr)?!0:this!==ur?!1:kr&&kr._writableState instanceof pr}}),ur.prototype.pipe=function(){Lr(this,new lr)};function $r(kr,Fr,Wr,jr){const Ir=kr._writableState;if(typeof Wr=="function")jr=Wr,Wr=Ir.defaultEncoding;else{if(!Wr)Wr=Ir.defaultEncoding;else if(Wr!=="buffer"&&!Jt.isEncoding(Wr))throw new Br(Wr);typeof jr!="function"&&(jr=Or)}if(Fr===null)throw new Ar;if(!Ir.objectMode)if(typeof Fr=="string")Ir.decodeStrings!==!1&&(Fr=Jt.from(Fr,Wr),Wr="buffer");else if(Fr instanceof Jt)Wr="buffer";else if(Wt._isUint8Array(Fr))Fr=Wt._uint8ArrayToBuffer(Fr),Wr="buffer";else throw new nr("chunk",["string","Buffer","Uint8Array"],Fr);let Mr;return Ir.ending?Mr=new Dr:Ir.destroyed&&(Mr=new yr("write")),Mr?(kt.nextTick(jr,Mr),Lr(kr,Mr,!0),Mr):(Ir.pendingcb++,wr(kr,Ir,Fr,Wr,jr))}ur.prototype.write=function(kr,Fr,Wr){return $r(this,kr,Fr,Wr)===!0},ur.prototype.cork=function(){this._writableState.corked++},ur.prototype.uncork=function(){const kr=this._writableState;kr.corked&&(kr.corked--,kr.writing||Pr(this,kr))},ur.prototype.setDefaultEncoding=function(Fr){if(typeof Fr=="string"&&(Fr=Lt(Fr)),!Jt.isEncoding(Fr))throw new Br(Fr);return this._writableState.defaultEncoding=Fr,this};function wr(kr,Fr,Wr,jr,Ir){const Mr=Fr.objectMode?1:Wr.length;Fr.length+=Mr;const Hr=Fr.length<Fr.highWaterMark;return Hr||(Fr.needDrain=!0),Fr.writing||Fr.corked||Fr.errored||!Fr.constructed?(Fr.buffered.push({chunk:Wr,encoding:jr,callback:Ir}),Fr.allBuffers&&jr!=="buffer"&&(Fr.allBuffers=!1),Fr.allNoop&&Ir!==Or&&(Fr.allNoop=!1)):(Fr.writelen=Mr,Fr.writecb=Ir,Fr.writing=!0,Fr.sync=!0,kr._write(Wr,jr,Fr.onwrite),Fr.sync=!1),Hr&&!Fr.errored&&!Fr.destroyed}function Er(kr,Fr,Wr,jr,Ir,Mr,Hr){Fr.writelen=jr,Fr.writecb=Hr,Fr.writing=!0,Fr.sync=!0,Fr.destroyed?Fr.onwrite(new yr("write")):Wr?kr._writev(Ir,Fr.onwrite):kr._write(Ir,Mr,Fr.onwrite),Fr.sync=!1}function gr(kr,Fr,Wr,jr){--Fr.pendingcb,jr(Wr),Tr(Fr),Lr(kr,Wr)}function fr(kr,Fr){const Wr=kr._writableState,jr=Wr.sync,Ir=Wr.writecb;if(typeof Ir!="function"){Lr(kr,new ir);return}Wr.writing=!1,Wr.writecb=null,Wr.length-=Wr.writelen,Wr.writelen=0,Fr?(Fr.stack,Wr.errored||(Wr.errored=Fr),kr._readableState&&!kr._readableState.errored&&(kr._readableState.errored=Fr),jr?kt.nextTick(gr,kr,Wr,Fr,Ir):gr(kr,Wr,Fr,Ir)):(Wr.buffered.length>Wr.bufferedIndex&&Pr(kr,Wr),jr?Wr.afterWriteTickInfo!==null&&Wr.afterWriteTickInfo.cb===Ir?Wr.afterWriteTickInfo.count++:(Wr.afterWriteTickInfo={count:1,cb:Ir,stream:kr,state:Wr},kt.nextTick(br,Wr.afterWriteTickInfo)):_r(kr,Wr,1,Ir))}function br({stream:kr,state:Fr,count:Wr,cb:jr}){return Fr.afterWriteTickInfo=null,_r(kr,Fr,Wr,jr)}function _r(kr,Fr,Wr,jr){for(!Fr.ending&&!kr.destroyed&&Fr.length===0&&Fr.needDrain&&(Fr.needDrain=!1,kr.emit("drain"));Wr-- >0;)Fr.pendingcb--,jr();Fr.destroyed&&Tr(Fr),Rr(kr,Fr)}function Tr(kr){if(kr.writing)return;for(let Ir=kr.bufferedIndex;Ir<kr.buffered.length;++Ir){var Fr;const{chunk:Mr,callback:Hr}=kr.buffered[Ir],Qr=kr.objectMode?1:Mr.length;kr.length-=Qr,Hr((Fr=kr.errored)!==null&&Fr!==void 0?Fr:new yr("write"))}const Wr=kr[vr].splice(0);for(let Ir=0;Ir<Wr.length;Ir++){var jr;Wr[Ir]((jr=kr.errored)!==null&&jr!==void 0?jr:new yr("end"))}dr(kr)}function Pr(kr,Fr){if(Fr.corked||Fr.bufferProcessing||Fr.destroyed||!Fr.constructed)return;const{buffered:Wr,bufferedIndex:jr,objectMode:Ir}=Fr,Mr=Wr.length-jr;if(!Mr)return;let Hr=jr;if(Fr.bufferProcessing=!0,Mr>1&&kr._writev){Fr.pendingcb-=Mr-1;const Qr=Fr.allNoop?Or:nn=>{for(let fn=Hr;fn<Wr.length;++fn)Wr[fn].callback(nn)},on=Fr.allNoop&&Hr===0?Wr:At(Wr,Hr);on.allBuffers=Fr.allBuffers,Er(kr,Fr,!0,Fr.length,on,"",Qr),dr(Fr)}else{do{const{chunk:Qr,encoding:on,callback:nn}=Wr[Hr];Wr[Hr++]=null;const fn=Ir?1:Qr.length;Er(kr,Fr,!1,fn,Qr,on,nn)}while(Hr<Wr.length&&!Fr.writing);Hr===Wr.length?dr(Fr):Hr>256?(Wr.splice(0,Hr),Fr.bufferedIndex=0):Fr.bufferedIndex=Hr}Fr.bufferProcessing=!1}ur.prototype._write=function(kr,Fr,Wr){if(this._writev)this._writev([{chunk:kr,encoding:Fr}],Wr);else throw new ar("_write()")},ur.prototype._writev=null,ur.prototype.end=function(kr,Fr,Wr){const jr=this._writableState;typeof kr=="function"?(Wr=kr,kr=null,Fr=null):typeof Fr=="function"&&(Wr=Fr,Fr=null);let Ir;if(kr!=null){const Mr=$r(this,kr,Fr);Mr instanceof xt&&(Ir=Mr)}return jr.corked&&(jr.corked=1,this.uncork()),Ir||(!jr.errored&&!jr.ending?(jr.ending=!0,Rr(this,jr,!0),jr.ended=!0):jr.finished?Ir=new Sr("end"):jr.destroyed&&(Ir=new yr("end"))),typeof Wr=="function"&&(Ir||jr.finished?kt.nextTick(Wr,Ir):jr[vr].push(Wr)),this};function Nr(kr){return kr.ending&&!kr.destroyed&&kr.constructed&&kr.length===0&&!kr.errored&&kr.buffered.length===0&&!kr.finished&&!kr.writing&&!kr.errorEmitted&&!kr.closeEmitted}function Cr(kr,Fr){let Wr=!1;function jr(Ir){if(Wr){Lr(kr,Ir??ir());return}if(Wr=!0,Fr.pendingcb--,Ir){const Mr=Fr[vr].splice(0);for(let Hr=0;Hr<Mr.length;Hr++)Mr[Hr](Ir);Lr(kr,Ir,Fr.sync)}else Nr(Fr)&&(Fr.prefinished=!0,kr.emit("prefinish"),Fr.pendingcb++,kt.nextTick(qr,kr,Fr))}Fr.sync=!0,Fr.pendingcb++;try{kr._final(jr)}catch(Ir){jr(Ir)}Fr.sync=!1}function xr(kr,Fr){!Fr.prefinished&&!Fr.finalCalled&&(typeof kr._final=="function"&&!Fr.destroyed?(Fr.finalCalled=!0,Cr(kr,Fr)):(Fr.prefinished=!0,kr.emit("prefinish")))}function Rr(kr,Fr,Wr){Nr(Fr)&&(xr(kr,Fr),Fr.pendingcb===0&&(Wr?(Fr.pendingcb++,kt.nextTick((jr,Ir)=>{Nr(Ir)?qr(jr,Ir):Ir.pendingcb--},kr,Fr)):Nr(Fr)&&(Fr.pendingcb++,qr(kr,Fr))))}function qr(kr,Fr){Fr.pendingcb--,Fr.finished=!0;const Wr=Fr[vr].splice(0);for(let jr=0;jr<Wr.length;jr++)Wr[jr]();if(kr.emit("finish"),Fr.autoDestroy){const jr=kr._readableState;(!jr||jr.autoDestroy&&(jr.endEmitted||jr.readable===!1))&&kr.destroy()}}jt(ur.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(kr){this._writableState&&(this._writableState.destroyed=kr)}},writable:{__proto__:null,get(){const kr=this._writableState;return!!kr&&kr.writable!==!1&&!kr.destroyed&&!kr.errored&&!kr.ending&&!kr.ended},set(kr){this._writableState&&(this._writableState.writable=!!kr)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const kr=this._writableState;return kr?!kr.destroyed&&!kr.ending&&kr.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Vr=Qt.destroy;ur.prototype.destroy=function(kr,Fr){const Wr=this._writableState;return!Wr.destroyed&&(Wr.bufferedIndex<Wr.buffered.length||Wr[vr].length)&&kt.nextTick(Tr,Wr),Vr.call(this,kr,Fr),this},ur.prototype._undestroy=Qt.undestroy,ur.prototype._destroy=function(kr,Fr){Fr(kr)},ur.prototype[zt.captureRejectionSymbol]=function(kr){this.destroy(kr)};let Gr;function Ur(){return Gr===void 0&&(Gr={}),Gr}return ur.fromWeb=function(kr,Fr){return Ur().newStreamWritableFromWritableStream(kr,Fr)},ur.toWeb=function(kr){return Ur().newWritableStreamFromStreamWritable(kr)},writable}var duplexify,hasRequiredDuplexify;function requireDuplexify(){if(hasRequiredDuplexify)return duplexify;hasRequiredDuplexify=1;const kt=browserExports$3,At=buffer$2,{isReadable:xt,isWritable:Bt,isIterable:Nt,isNodeStream:jt,isReadableNodeStream:Ut,isWritableNodeStream:Lt,isDuplexNodeStream:Ht}=utils$1,Vt=endOfStreamExports,{AbortError:zt,codes:{ERR_INVALID_ARG_TYPE:Wt,ERR_INVALID_RETURN_VALUE:Jt}}=errors,{destroyer:Qt}=destroy_1,Xt=requireDuplex(),tr=requireReadable(),{createDeferredPromise:rr}=utilExports,nr=from_1,ar=globalThis.Blob||At.Blob,ir=typeof ar<"u"?function(Lr){return Lr instanceof ar}:function(Lr){return!1},lr=globalThis.AbortController||requireBrowser().AbortController,{FunctionPrototypeCall:yr}=primordials;class Sr extends Xt{constructor(Lr){super(Lr),(Lr==null?void 0:Lr.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(Lr==null?void 0:Lr.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}duplexify=function Br(Lr,Or){if(Ht(Lr))return Lr;if(Ut(Lr))return Dr({readable:Lr});if(Lt(Lr))return Dr({writable:Lr});if(jt(Lr))return Dr({writable:!1,readable:!1});if(typeof Lr=="function"){const{value:pr,write:dr,final:ur,destroy:$r}=Ar(Lr);if(Nt(pr))return nr(Sr,pr,{objectMode:!0,write:dr,final:ur,destroy:$r});const wr=pr==null?void 0:pr.then;if(typeof wr=="function"){let Er;const gr=yr(wr,pr,fr=>{if(fr!=null)throw new Jt("nully","body",fr)},fr=>{Qt(Er,fr)});return Er=new Sr({objectMode:!0,readable:!1,write:dr,final(fr){ur(async()=>{try{await gr,kt.nextTick(fr,null)}catch(br){kt.nextTick(fr,br)}})},destroy:$r})}throw new Jt("Iterable, AsyncIterable or AsyncFunction",Or,pr)}if(ir(Lr))return Br(Lr.arrayBuffer());if(Nt(Lr))return nr(Sr,Lr,{objectMode:!0,writable:!1});if(typeof(Lr==null?void 0:Lr.writable)=="object"||typeof(Lr==null?void 0:Lr.readable)=="object"){const pr=Lr!=null&&Lr.readable?Ut(Lr==null?void 0:Lr.readable)?Lr==null?void 0:Lr.readable:Br(Lr.readable):void 0,dr=Lr!=null&&Lr.writable?Lt(Lr==null?void 0:Lr.writable)?Lr==null?void 0:Lr.writable:Br(Lr.writable):void 0;return Dr({readable:pr,writable:dr})}const vr=Lr==null?void 0:Lr.then;if(typeof vr=="function"){let pr;return yr(vr,Lr,dr=>{dr!=null&&pr.push(dr),pr.push(null)},dr=>{Qt(pr,dr)}),pr=new Sr({objectMode:!0,writable:!1,read(){}})}throw new Wt(Or,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],Lr)};function Ar(Br){let{promise:Lr,resolve:Or}=rr();const vr=new lr,pr=vr.signal;return{value:Br(async function*(){for(;;){const ur=Lr;Lr=null;const{chunk:$r,done:wr,cb:Er}=await ur;if(kt.nextTick(Er),wr)return;if(pr.aborted)throw new zt(void 0,{cause:pr.reason});({promise:Lr,resolve:Or}=rr()),yield $r}}(),{signal:pr}),write(ur,$r,wr){const Er=Or;Or=null,Er({chunk:ur,done:!1,cb:wr})},final(ur){const $r=Or;Or=null,$r({done:!0,cb:ur})},destroy(ur,$r){vr.abort(),$r(ur)}}}function Dr(Br){const Lr=Br.readable&&typeof Br.readable.read!="function"?tr.wrap(Br.readable):Br.readable,Or=Br.writable;let vr=!!xt(Lr),pr=!!Bt(Or),dr,ur,$r,wr,Er;function gr(fr){const br=wr;wr=null,br?br(fr):fr&&Er.destroy(fr)}return Er=new Sr({readableObjectMode:!!(Lr!=null&&Lr.readableObjectMode),writableObjectMode:!!(Or!=null&&Or.writableObjectMode),readable:vr,writable:pr}),pr&&(Vt(Or,fr=>{pr=!1,fr&&Qt(Lr,fr),gr(fr)}),Er._write=function(fr,br,_r){Or.write(fr,br)?_r():dr=_r},Er._final=function(fr){Or.end(),ur=fr},Or.on("drain",function(){if(dr){const fr=dr;dr=null,fr()}}),Or.on("finish",function(){if(ur){const fr=ur;ur=null,fr()}})),vr&&(Vt(Lr,fr=>{vr=!1,fr&&Qt(Lr,fr),gr(fr)}),Lr.on("readable",function(){if($r){const fr=$r;$r=null,fr()}}),Lr.on("end",function(){Er.push(null)}),Er._read=function(){for(;;){const fr=Lr.read();if(fr===null){$r=Er._read;return}if(!Er.push(fr))return}}),Er._destroy=function(fr,br){!fr&&wr!==null&&(fr=new zt),$r=null,dr=null,ur=null,wr===null?br(fr):(wr=br,Qt(Or,fr),Qt(Lr,fr))},Er}return duplexify}var duplex,hasRequiredDuplex;function requireDuplex(){if(hasRequiredDuplex)return duplex;hasRequiredDuplex=1;const{ObjectDefineProperties:kt,ObjectGetOwnPropertyDescriptor:At,ObjectKeys:xt,ObjectSetPrototypeOf:Bt}=primordials;duplex=Ut;const Nt=requireReadable(),jt=requireWritable();Bt(Ut.prototype,Nt.prototype),Bt(Ut,Nt);{const zt=xt(jt.prototype);for(let Wt=0;Wt<zt.length;Wt++){const Jt=zt[Wt];Ut.prototype[Jt]||(Ut.prototype[Jt]=jt.prototype[Jt])}}function Ut(zt){if(!(this instanceof Ut))return new Ut(zt);Nt.call(this,zt),jt.call(this,zt),zt?(this.allowHalfOpen=zt.allowHalfOpen!==!1,zt.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),zt.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}kt(Ut.prototype,{writable:{__proto__:null,...At(jt.prototype,"writable")},writableHighWaterMark:{__proto__:null,...At(jt.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...At(jt.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...At(jt.prototype,"writableBuffer")},writableLength:{__proto__:null,...At(jt.prototype,"writableLength")},writableFinished:{__proto__:null,...At(jt.prototype,"writableFinished")},writableCorked:{__proto__:null,...At(jt.prototype,"writableCorked")},writableEnded:{__proto__:null,...At(jt.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...At(jt.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(zt){this._readableState&&this._writableState&&(this._readableState.destroyed=zt,this._writableState.destroyed=zt)}}});let Lt;function Ht(){return Lt===void 0&&(Lt={}),Lt}Ut.fromWeb=function(zt,Wt){return Ht().newStreamDuplexFromReadableWritablePair(zt,Wt)},Ut.toWeb=function(zt){return Ht().newReadableWritablePairFromDuplex(zt)};let Vt;return Ut.from=function(zt){return Vt||(Vt=requireDuplexify()),Vt(zt,"body")},duplex}const{ObjectSetPrototypeOf:ObjectSetPrototypeOf$1,Symbol:Symbol$2}=primordials;var transform=Transform$1;const{ERR_METHOD_NOT_IMPLEMENTED}=errors.codes,Duplex$2=requireDuplex(),{getHighWaterMark}=state;ObjectSetPrototypeOf$1(Transform$1.prototype,Duplex$2.prototype);ObjectSetPrototypeOf$1(Transform$1,Duplex$2);const kCallback=Symbol$2("kCallback");function Transform$1(kt){if(!(this instanceof Transform$1))return new Transform$1(kt);const At=kt?getHighWaterMark(this,kt,"readableHighWaterMark",!0):null;At===0&&(kt={...kt,highWaterMark:null,readableHighWaterMark:At,writableHighWaterMark:kt.writableHighWaterMark||0}),Duplex$2.call(this,kt),this._readableState.sync=!1,this[kCallback]=null,kt&&(typeof kt.transform=="function"&&(this._transform=kt.transform),typeof kt.flush=="function"&&(this._flush=kt.flush)),this.on("prefinish",prefinish)}function final(kt){typeof this._flush=="function"&&!this.destroyed?this._flush((At,xt)=>{if(At){kt?kt(At):this.destroy(At);return}xt!=null&&this.push(xt),this.push(null),kt&&kt()}):(this.push(null),kt&&kt())}function prefinish(){this._final!==final&&final.call(this)}Transform$1.prototype._final=final;Transform$1.prototype._transform=function(kt,At,xt){throw new ERR_METHOD_NOT_IMPLEMENTED("_transform()")};Transform$1.prototype._write=function(kt,At,xt){const Bt=this._readableState,Nt=this._writableState,jt=Bt.length;this._transform(kt,At,(Ut,Lt)=>{if(Ut){xt(Ut);return}Lt!=null&&this.push(Lt),Nt.ended||jt===Bt.length||Bt.length<Bt.highWaterMark?xt():this[kCallback]=xt})};Transform$1.prototype._read=function(){if(this[kCallback]){const kt=this[kCallback];this[kCallback]=null,kt()}};const{ObjectSetPrototypeOf}=primordials;var passthrough=PassThrough$1;const Transform=transform;ObjectSetPrototypeOf(PassThrough$1.prototype,Transform.prototype);ObjectSetPrototypeOf(PassThrough$1,Transform);function PassThrough$1(kt){if(!(this instanceof PassThrough$1))return new PassThrough$1(kt);Transform.call(this,kt)}PassThrough$1.prototype._transform=function(kt,At,xt){xt(null,kt)};const process=browserExports$3,{ArrayIsArray,Promise:Promise$2,SymbolAsyncIterator}=primordials,eos$1=endOfStreamExports,{once}=utilExports,destroyImpl=destroy_1,Duplex$1=requireDuplex(),{aggregateTwoErrors,codes:{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$2,ERR_INVALID_RETURN_VALUE,ERR_MISSING_ARGS:ERR_MISSING_ARGS$2,ERR_STREAM_DESTROYED,ERR_STREAM_PREMATURE_CLOSE},AbortError:AbortError$5}=errors,{validateFunction,validateAbortSignal:validateAbortSignal$1}=validators,{isIterable:isIterable$1,isReadable:isReadable$1,isReadableNodeStream,isNodeStream:isNodeStream$2,isTransformStream:isTransformStream$1,isWebStream:isWebStream$1,isReadableStream:isReadableStream$1,isReadableEnded}=utils$1,AbortController$1=globalThis.AbortController||requireBrowser().AbortController;let PassThrough,Readable;function destroyer$1(kt,At,xt){let Bt=!1;kt.on("close",()=>{Bt=!0});const Nt=eos$1(kt,{readable:At,writable:xt},jt=>{Bt=!jt});return{destroy:jt=>{Bt||(Bt=!0,destroyImpl.destroyer(kt,jt||new ERR_STREAM_DESTROYED("pipe")))},cleanup:Nt}}function popCallback(kt){return validateFunction(kt[kt.length-1],"streams[stream.length - 1]"),kt.pop()}function makeAsyncIterable(kt){if(isIterable$1(kt))return kt;if(isReadableNodeStream(kt))return fromReadable(kt);throw new ERR_INVALID_ARG_TYPE$2("val",["Readable","Iterable","AsyncIterable"],kt)}async function*fromReadable(kt){Readable||(Readable=requireReadable()),yield*Readable.prototype[SymbolAsyncIterator].call(kt)}async function pumpToNode(kt,At,xt,{end:Bt}){let Nt,jt=null;const Ut=Vt=>{if(Vt&&(Nt=Vt),jt){const zt=jt;jt=null,zt()}},Lt=()=>new Promise$2((Vt,zt)=>{Nt?zt(Nt):jt=()=>{Nt?zt(Nt):Vt()}});At.on("drain",Ut);const Ht=eos$1(At,{readable:!1},Ut);try{At.writableNeedDrain&&await Lt();for await(const Vt of kt)At.write(Vt)||await Lt();Bt&&At.end(),await Lt(),xt()}catch(Vt){xt(Nt!==Vt?aggregateTwoErrors(Nt,Vt):Vt)}finally{Ht(),At.off("drain",Ut)}}async function pumpToWeb(kt,At,xt,{end:Bt}){isTransformStream$1(At)&&(At=At.writable);const Nt=At.getWriter();try{for await(const jt of kt)await Nt.ready,Nt.write(jt).catch(()=>{});await Nt.ready,Bt&&await Nt.close(),xt()}catch(jt){try{await Nt.abort(jt),xt(jt)}catch(Ut){xt(Ut)}}}function pipeline$1(...kt){return pipelineImpl(kt,once(popCallback(kt)))}function pipelineImpl(kt,At,xt){if(kt.length===1&&ArrayIsArray(kt[0])&&(kt=kt[0]),kt.length<2)throw new ERR_MISSING_ARGS$2("streams");const Bt=new AbortController$1,Nt=Bt.signal,jt=xt==null?void 0:xt.signal,Ut=[];validateAbortSignal$1(jt,"options.signal");function Lt(){Qt(new AbortError$5)}jt==null||jt.addEventListener("abort",Lt);let Ht,Vt;const zt=[];let Wt=0;function Jt(nr){Qt(nr,--Wt===0)}function Qt(nr,ar){if(nr&&(!Ht||Ht.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Ht=nr),!(!Ht&&!ar)){for(;zt.length;)zt.shift()(Ht);jt==null||jt.removeEventListener("abort",Lt),Bt.abort(),ar&&(Ht||Ut.forEach(ir=>ir()),process.nextTick(At,Ht,Vt))}}let Xt;for(let nr=0;nr<kt.length;nr++){const ar=kt[nr],ir=nr<kt.length-1,lr=nr>0,yr=ir||(xt==null?void 0:xt.end)!==!1,Sr=nr===kt.length-1;if(isNodeStream$2(ar)){let Ar=function(Dr){Dr&&Dr.name!=="AbortError"&&Dr.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Jt(Dr)};if(yr){const{destroy:Dr,cleanup:Br}=destroyer$1(ar,ir,lr);zt.push(Dr),isReadable$1(ar)&&Sr&&Ut.push(Br)}ar.on("error",Ar),isReadable$1(ar)&&Sr&&Ut.push(()=>{ar.removeListener("error",Ar)})}if(nr===0)if(typeof ar=="function"){if(Xt=ar({signal:Nt}),!isIterable$1(Xt))throw new ERR_INVALID_RETURN_VALUE("Iterable, AsyncIterable or Stream","source",Xt)}else isIterable$1(ar)||isReadableNodeStream(ar)||isTransformStream$1(ar)?Xt=ar:Xt=Duplex$1.from(ar);else if(typeof ar=="function"){if(isTransformStream$1(Xt)){var tr;Xt=makeAsyncIterable((tr=Xt)===null||tr===void 0?void 0:tr.readable)}else Xt=makeAsyncIterable(Xt);if(Xt=ar(Xt,{signal:Nt}),ir){if(!isIterable$1(Xt,!0))throw new ERR_INVALID_RETURN_VALUE("AsyncIterable",`transform[${nr-1}]`,Xt)}else{var rr;PassThrough||(PassThrough=passthrough);const Ar=new PassThrough({objectMode:!0}),Dr=(rr=Xt)===null||rr===void 0?void 0:rr.then;if(typeof Dr=="function")Wt++,Dr.call(Xt,Or=>{Vt=Or,Or!=null&&Ar.write(Or),yr&&Ar.end(),process.nextTick(Jt)},Or=>{Ar.destroy(Or),process.nextTick(Jt,Or)});else if(isIterable$1(Xt,!0))Wt++,pumpToNode(Xt,Ar,Jt,{end:yr});else if(isReadableStream$1(Xt)||isTransformStream$1(Xt)){const Or=Xt.readable||Xt;Wt++,pumpToNode(Or,Ar,Jt,{end:yr})}else throw new ERR_INVALID_RETURN_VALUE("AsyncIterable or Promise","destination",Xt);Xt=Ar;const{destroy:Br,cleanup:Lr}=destroyer$1(Xt,!1,!0);zt.push(Br),Sr&&Ut.push(Lr)}}else if(isNodeStream$2(ar)){if(isReadableNodeStream(Xt)){Wt+=2;const Ar=pipe$1(Xt,ar,Jt,{end:yr});isReadable$1(ar)&&Sr&&Ut.push(Ar)}else if(isTransformStream$1(Xt)||isReadableStream$1(Xt)){const Ar=Xt.readable||Xt;Wt++,pumpToNode(Ar,ar,Jt,{end:yr})}else if(isIterable$1(Xt))Wt++,pumpToNode(Xt,ar,Jt,{end:yr});else throw new ERR_INVALID_ARG_TYPE$2("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],Xt);Xt=ar}else if(isWebStream$1(ar)){if(isReadableNodeStream(Xt))Wt++,pumpToWeb(makeAsyncIterable(Xt),ar,Jt,{end:yr});else if(isReadableStream$1(Xt)||isIterable$1(Xt))Wt++,pumpToWeb(Xt,ar,Jt,{end:yr});else if(isTransformStream$1(Xt))Wt++,pumpToWeb(Xt.readable,ar,Jt,{end:yr});else throw new ERR_INVALID_ARG_TYPE$2("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],Xt);Xt=ar}else Xt=Duplex$1.from(ar)}return(Nt!=null&&Nt.aborted||jt!=null&&jt.aborted)&&process.nextTick(Lt),Xt}function pipe$1(kt,At,xt,{end:Bt}){let Nt=!1;if(At.on("close",()=>{Nt||xt(new ERR_STREAM_PREMATURE_CLOSE)}),kt.pipe(At,{end:!1}),Bt){let jt=function(){Nt=!0,At.end()};isReadableEnded(kt)?process.nextTick(jt):kt.once("end",jt)}else xt();return eos$1(kt,{readable:!0,writable:!1},jt=>{const Ut=kt._readableState;jt&&jt.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ut&&Ut.ended&&!Ut.errored&&!Ut.errorEmitted?kt.once("end",xt).once("error",xt):xt(jt)}),eos$1(At,{readable:!1,writable:!0},xt)}var pipeline_1={pipelineImpl,pipeline:pipeline$1};const{pipeline}=pipeline_1,Duplex=requireDuplex(),{destroyer}=destroy_1,{isNodeStream:isNodeStream$1,isReadable,isWritable:isWritable$1,isWebStream,isTransformStream,isWritableStream,isReadableStream}=utils$1,{AbortError:AbortError$4,codes:{ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE$1,ERR_MISSING_ARGS:ERR_MISSING_ARGS$1}}=errors,eos=endOfStreamExports;var compose$1=function kt(...At){if(At.length===0)throw new ERR_MISSING_ARGS$1("streams");if(At.length===1)return Duplex.from(At[0]);const xt=[...At];if(typeof At[0]=="function"&&(At[0]=Duplex.from(At[0])),typeof At[At.length-1]=="function"){const Qt=At.length-1;At[Qt]=Duplex.from(At[Qt])}for(let Qt=0;Qt<At.length;++Qt)if(!(!isNodeStream$1(At[Qt])&&!isWebStream(At[Qt]))){if(Qt<At.length-1&&!(isReadable(At[Qt])||isReadableStream(At[Qt])||isTransformStream(At[Qt])))throw new ERR_INVALID_ARG_VALUE$1(`streams[${Qt}]`,xt[Qt],"must be readable");if(Qt>0&&!(isWritable$1(At[Qt])||isWritableStream(At[Qt])||isTransformStream(At[Qt])))throw new ERR_INVALID_ARG_VALUE$1(`streams[${Qt}]`,xt[Qt],"must be writable")}let Bt,Nt,jt,Ut,Lt;function Ht(Qt){const Xt=Ut;Ut=null,Xt?Xt(Qt):Qt?Lt.destroy(Qt):!Jt&&!Wt&&Lt.destroy()}const Vt=At[0],zt=pipeline(At,Ht),Wt=!!(isWritable$1(Vt)||isWritableStream(Vt)||isTransformStream(Vt)),Jt=!!(isReadable(zt)||isReadableStream(zt)||isTransformStream(zt));if(Lt=new Duplex({writableObjectMode:!!(Vt!=null&&Vt.writableObjectMode),readableObjectMode:!!(zt!=null&&zt.writableObjectMode),writable:Wt,readable:Jt}),Wt){if(isNodeStream$1(Vt))Lt._write=function(Xt,tr,rr){Vt.write(Xt,tr)?rr():Bt=rr},Lt._final=function(Xt){Vt.end(),Nt=Xt},Vt.on("drain",function(){if(Bt){const Xt=Bt;Bt=null,Xt()}});else if(isWebStream(Vt)){const tr=(isTransformStream(Vt)?Vt.writable:Vt).getWriter();Lt._write=async function(rr,nr,ar){try{await tr.ready,tr.write(rr).catch(()=>{}),ar()}catch(ir){ar(ir)}},Lt._final=async function(rr){try{await tr.ready,tr.close().catch(()=>{}),Nt=rr}catch(nr){rr(nr)}}}const Qt=isTransformStream(zt)?zt.readable:zt;eos(Qt,()=>{if(Nt){const Xt=Nt;Nt=null,Xt()}})}if(Jt){if(isNodeStream$1(zt))zt.on("readable",function(){if(jt){const Qt=jt;jt=null,Qt()}}),zt.on("end",function(){Lt.push(null)}),Lt._read=function(){for(;;){const Qt=zt.read();if(Qt===null){jt=Lt._read;return}if(!Lt.push(Qt))return}};else if(isWebStream(zt)){const Xt=(isTransformStream(zt)?zt.readable:zt).getReader();Lt._read=async function(){for(;;)try{const{value:tr,done:rr}=await Xt.read();if(!Lt.push(tr))return;if(rr){Lt.push(null);return}}catch{return}}}}return Lt._destroy=function(Qt,Xt){!Qt&&Ut!==null&&(Qt=new AbortError$4),jt=null,Bt=null,Nt=null,Ut===null?Xt(Qt):(Ut=Xt,isNodeStream$1(zt)&&destroyer(zt,Qt))},Lt};const AbortController=globalThis.AbortController||requireBrowser().AbortController,{codes:{ERR_INVALID_ARG_VALUE,ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE$1,ERR_MISSING_ARGS,ERR_OUT_OF_RANGE},AbortError:AbortError$3}=errors,{validateAbortSignal,validateInteger,validateObject:validateObject$1}=validators,kWeakHandler=primordials.Symbol("kWeak"),{finished}=endOfStreamExports,staticCompose=compose$1,{addAbortSignalNoValidate}=addAbortSignalExports,{isWritable,isNodeStream}=utils$1,{ArrayPrototypePush,MathFloor,Number:Number$1,NumberIsNaN,Promise:Promise$1,PromiseReject,PromisePrototypeThen,Symbol:Symbol$1}=primordials,kEmpty=Symbol$1("kEmpty"),kEof=Symbol$1("kEof");function compose(kt,At){if(At!=null&&validateObject$1(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal(At.signal,"options.signal"),isNodeStream(kt)&&!isWritable(kt))throw new ERR_INVALID_ARG_VALUE("stream",kt,"must be writable");const xt=staticCompose(this,kt);return At!=null&&At.signal&&addAbortSignalNoValidate(At.signal,xt),xt}function map$1(kt,At){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$1("fn",["Function","AsyncFunction"],kt);At!=null&&validateObject$1(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal(At.signal,"options.signal");let xt=1;return(At==null?void 0:At.concurrency)!=null&&(xt=MathFloor(At.concurrency)),validateInteger(xt,"concurrency",1),(async function*(){var Nt,jt;const Ut=new AbortController,Lt=this,Ht=[],Vt=Ut.signal,zt={signal:Vt},Wt=()=>Ut.abort();At!=null&&(Nt=At.signal)!==null&&Nt!==void 0&&Nt.aborted&&Wt(),At==null||(jt=At.signal)===null||jt===void 0||jt.addEventListener("abort",Wt);let Jt,Qt,Xt=!1;function tr(){Xt=!0}async function rr(){try{for await(let ir of Lt){var nr;if(Xt)return;if(Vt.aborted)throw new AbortError$3;try{ir=kt(ir,zt)}catch(lr){ir=PromiseReject(lr)}ir!==kEmpty&&(typeof((nr=ir)===null||nr===void 0?void 0:nr.catch)=="function"&&ir.catch(tr),Ht.push(ir),Jt&&(Jt(),Jt=null),!Xt&&Ht.length&&Ht.length>=xt&&await new Promise$1(lr=>{Qt=lr}))}Ht.push(kEof)}catch(ir){const lr=PromiseReject(ir);PromisePrototypeThen(lr,void 0,tr),Ht.push(lr)}finally{var ar;Xt=!0,Jt&&(Jt(),Jt=null),At==null||(ar=At.signal)===null||ar===void 0||ar.removeEventListener("abort",Wt)}}rr();try{for(;;){for(;Ht.length>0;){const nr=await Ht[0];if(nr===kEof)return;if(Vt.aborted)throw new AbortError$3;nr!==kEmpty&&(yield nr),Ht.shift(),Qt&&(Qt(),Qt=null)}await new Promise$1(nr=>{Jt=nr})}}finally{Ut.abort(),Xt=!0,Qt&&(Qt(),Qt=null)}}).call(this)}function asIndexedPairs(kt=void 0){return kt!=null&&validateObject$1(kt,"options"),(kt==null?void 0:kt.signal)!=null&&validateAbortSignal(kt.signal,"options.signal"),(async function*(){let xt=0;for await(const Nt of this){var Bt;if(kt!=null&&(Bt=kt.signal)!==null&&Bt!==void 0&&Bt.aborted)throw new AbortError$3({cause:kt.signal.reason});yield[xt++,Nt]}}).call(this)}async function some(kt,At=void 0){for await(const xt of filter$1.call(this,kt,At))return!0;return!1}async function every(kt,At=void 0){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$1("fn",["Function","AsyncFunction"],kt);return!await some.call(this,async(...xt)=>!await kt(...xt),At)}async function find(kt,At){for await(const xt of filter$1.call(this,kt,At))return xt}async function forEach(kt,At){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$1("fn",["Function","AsyncFunction"],kt);async function xt(Bt,Nt){return await kt(Bt,Nt),kEmpty}for await(const Bt of map$1.call(this,xt,At));}function filter$1(kt,At){if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$1("fn",["Function","AsyncFunction"],kt);async function xt(Bt,Nt){return await kt(Bt,Nt)?Bt:kEmpty}return map$1.call(this,xt,At)}class ReduceAwareErrMissingArgs extends ERR_MISSING_ARGS{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function reduce(kt,At,xt){var Bt;if(typeof kt!="function")throw new ERR_INVALID_ARG_TYPE$1("reducer",["Function","AsyncFunction"],kt);xt!=null&&validateObject$1(xt,"options"),(xt==null?void 0:xt.signal)!=null&&validateAbortSignal(xt.signal,"options.signal");let Nt=arguments.length>1;if(xt!=null&&(Bt=xt.signal)!==null&&Bt!==void 0&&Bt.aborted){const Vt=new AbortError$3(void 0,{cause:xt.signal.reason});throw this.once("error",()=>{}),await finished(this.destroy(Vt)),Vt}const jt=new AbortController,Ut=jt.signal;if(xt!=null&&xt.signal){const Vt={once:!0,[kWeakHandler]:this};xt.signal.addEventListener("abort",()=>jt.abort(),Vt)}let Lt=!1;try{for await(const Vt of this){var Ht;if(Lt=!0,xt!=null&&(Ht=xt.signal)!==null&&Ht!==void 0&&Ht.aborted)throw new AbortError$3;Nt?At=await kt(At,Vt,{signal:Ut}):(At=Vt,Nt=!0)}if(!Lt&&!Nt)throw new ReduceAwareErrMissingArgs}finally{jt.abort()}return At}async function toArray(kt){kt!=null&&validateObject$1(kt,"options"),(kt==null?void 0:kt.signal)!=null&&validateAbortSignal(kt.signal,"options.signal");const At=[];for await(const Bt of this){var xt;if(kt!=null&&(xt=kt.signal)!==null&&xt!==void 0&&xt.aborted)throw new AbortError$3(void 0,{cause:kt.signal.reason});ArrayPrototypePush(At,Bt)}return At}function flatMap(kt,At){const xt=map$1.call(this,kt,At);return(async function*(){for await(const Nt of xt)yield*Nt}).call(this)}function toIntegerOrInfinity(kt){if(kt=Number$1(kt),NumberIsNaN(kt))return 0;if(kt<0)throw new ERR_OUT_OF_RANGE("number",">= 0",kt);return kt}function drop(kt,At=void 0){return At!=null&&validateObject$1(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal(At.signal,"options.signal"),kt=toIntegerOrInfinity(kt),(async function*(){var Bt;if(At!=null&&(Bt=At.signal)!==null&&Bt!==void 0&&Bt.aborted)throw new AbortError$3;for await(const jt of this){var Nt;if(At!=null&&(Nt=At.signal)!==null&&Nt!==void 0&&Nt.aborted)throw new AbortError$3;kt--<=0&&(yield jt)}}).call(this)}function take(kt,At=void 0){return At!=null&&validateObject$1(At,"options"),(At==null?void 0:At.signal)!=null&&validateAbortSignal(At.signal,"options.signal"),kt=toIntegerOrInfinity(kt),(async function*(){var Bt;if(At!=null&&(Bt=At.signal)!==null&&Bt!==void 0&&Bt.aborted)throw new AbortError$3;for await(const jt of this){var Nt;if(At!=null&&(Nt=At.signal)!==null&&Nt!==void 0&&Nt.aborted)throw new AbortError$3;if(kt-- >0)yield jt;else return}}).call(this)}operators.streamReturningOperators={asIndexedPairs,drop,filter:filter$1,flatMap,map:map$1,take,compose};operators.promiseReturningOperators={every,forEach,reduce,toArray,some,find};var promises,hasRequiredPromises;function requirePromises(){if(hasRequiredPromises)return promises;hasRequiredPromises=1;const{ArrayPrototypePop:kt,Promise:At}=primordials,{isIterable:xt,isNodeStream:Bt,isWebStream:Nt}=utils$1,{pipelineImpl:jt}=pipeline_1,{finished:Ut}=endOfStreamExports;requireStream();function Lt(...Ht){return new At((Vt,zt)=>{let Wt,Jt;const Qt=Ht[Ht.length-1];if(Qt&&typeof Qt=="object"&&!Bt(Qt)&&!xt(Qt)&&!Nt(Qt)){const Xt=kt(Ht);Wt=Xt.signal,Jt=Xt.end}jt(Ht,(Xt,tr)=>{Xt?zt(Xt):Vt(tr)},{signal:Wt,end:Jt})})}return promises={finished:Ut,pipeline:Lt},promises}var hasRequiredStream;function requireStream(){if(hasRequiredStream)return stream.exports;hasRequiredStream=1;const{Buffer:kt}=buffer$2,{ObjectDefineProperty:At,ObjectKeys:xt,ReflectApply:Bt}=primordials,{promisify:{custom:Nt}}=utilExports,{streamReturningOperators:jt,promiseReturningOperators:Ut}=operators,{codes:{ERR_ILLEGAL_CONSTRUCTOR:Lt}}=errors,Ht=compose$1,{pipeline:Vt}=pipeline_1,{destroyer:zt}=destroy_1,Wt=endOfStreamExports,Jt=requirePromises(),Qt=utils$1,Xt=stream.exports=legacy.Stream;Xt.isDisturbed=Qt.isDisturbed,Xt.isErrored=Qt.isErrored,Xt.isReadable=Qt.isReadable,Xt.Readable=requireReadable();for(const rr of xt(jt)){let ar=function(...ir){if(new.target)throw Lt();return Xt.Readable.from(Bt(nr,this,ir))};const nr=jt[rr];At(ar,"name",{__proto__:null,value:nr.name}),At(ar,"length",{__proto__:null,value:nr.length}),At(Xt.Readable.prototype,rr,{__proto__:null,value:ar,enumerable:!1,configurable:!0,writable:!0})}for(const rr of xt(Ut)){let ar=function(...ir){if(new.target)throw Lt();return Bt(nr,this,ir)};const nr=Ut[rr];At(ar,"name",{__proto__:null,value:nr.name}),At(ar,"length",{__proto__:null,value:nr.length}),At(Xt.Readable.prototype,rr,{__proto__:null,value:ar,enumerable:!1,configurable:!0,writable:!0})}Xt.Writable=requireWritable(),Xt.Duplex=requireDuplex(),Xt.Transform=transform,Xt.PassThrough=passthrough,Xt.pipeline=Vt;const{addAbortSignal:tr}=addAbortSignalExports;return Xt.addAbortSignal=tr,Xt.finished=Wt,Xt.destroy=zt,Xt.compose=Ht,At(Xt,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return Jt}}),At(Vt,Nt,{__proto__:null,enumerable:!0,get(){return Jt.pipeline}}),At(Wt,Nt,{__proto__:null,enumerable:!0,get(){return Jt.finished}}),Xt.Stream=Xt,Xt._isUint8Array=function(nr){return nr instanceof Uint8Array},Xt._uint8ArrayToBuffer=function(nr){return kt.from(nr.buffer,nr.byteOffset,nr.byteLength)},stream.exports}(function(kt){const At=requireStream(),xt=requirePromises(),Bt=At.Readable.destroy;kt.exports=At.Readable,kt.exports._uint8ArrayToBuffer=At._uint8ArrayToBuffer,kt.exports._isUint8Array=At._isUint8Array,kt.exports.isDisturbed=At.isDisturbed,kt.exports.isErrored=At.isErrored,kt.exports.isReadable=At.isReadable,kt.exports.Readable=At.Readable,kt.exports.Writable=At.Writable,kt.exports.Duplex=At.Duplex,kt.exports.Transform=At.Transform,kt.exports.PassThrough=At.PassThrough,kt.exports.addAbortSignal=At.addAbortSignal,kt.exports.finished=At.finished,kt.exports.destroy=At.destroy,kt.exports.destroy=Bt,kt.exports.pipeline=At.pipeline,kt.exports.compose=At.compose,Object.defineProperty(At,"promises",{configurable:!0,enumerable:!0,get(){return xt}}),kt.exports.Stream=At.Stream,kt.exports.default=kt.exports})(browser);var browserExports=browser.exports,__awaiter$1X=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let Sha256$2=class{static digest(At){return __awaiter$1X(this,arguments,void 0,function*({data:xt}){return sha256$5(xt)})}},CryptoAlgorithm$2=class{};var __awaiter$1W=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let Sha2Algorithm$2=class extends CryptoAlgorithm$2{digest(At){return __awaiter$1W(this,arguments,void 0,function*({algorithm:xt,data:Bt}){switch(xt){case"SHA-256":return yield Sha256$2.digest({data:Bt})}})}};function number(kt){if(!Number.isSafeInteger(kt)||kt<0)throw new Error(`Wrong positive integer: ${kt}`)}function isBytes$5(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}function bytes$1(kt,...At){if(!isBytes$5(kt))throw new Error("Expected Uint8Array");if(At.length>0&&!At.includes(kt.length))throw new Error(`Expected Uint8Array of length ${At}, not of length=${kt.length}`)}function hash(kt){if(typeof kt!="function"||typeof kt.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number(kt.outputLen),number(kt.blockLen)}function exists$1(kt,At=!0){if(kt.destroyed)throw new Error("Hash instance has been destroyed");if(At&&kt.finished)throw new Error("Hash#digest() has already been called")}function output$1(kt,At){bytes$1(kt);const xt=At.outputLen;if(kt.length<xt)throw new Error(`digestInto() expects output buffer of length at least ${xt}`)}const crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$4(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}const createView=kt=>new DataView(kt.buffer,kt.byteOffset,kt.byteLength),rotr=(kt,At)=>kt<<32-At|kt>>>At,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(kt,At)=>At.toString(16).padStart(2,"0"));function bytesToHex$1(kt){if(!isBytes$4(kt))throw new Error("Uint8Array expected");let At="";for(let xt=0;xt<kt.length;xt++)At+=hexes$1[kt[xt]];return At}const asciis$1={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$1(kt){if(kt>=asciis$1._0&&kt<=asciis$1._9)return kt-asciis$1._0;if(kt>=asciis$1._A&&kt<=asciis$1._F)return kt-(asciis$1._A-10);if(kt>=asciis$1._a&&kt<=asciis$1._f)return kt-(asciis$1._a-10)}function hexToBytes$1(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);const At=kt.length,xt=At/2;if(At%2)throw new Error("padded hex string expected, got unpadded hex of length "+At);const Bt=new Uint8Array(xt);for(let Nt=0,jt=0;Nt<xt;Nt++,jt+=2){const Ut=asciiToBase16$1(kt.charCodeAt(jt)),Lt=asciiToBase16$1(kt.charCodeAt(jt+1));if(Ut===void 0||Lt===void 0){const Ht=kt[jt]+kt[jt+1];throw new Error('hex string expected, got non-hex character "'+Ht+'" at index '+jt)}Bt[Nt]=Ut*16+Lt}return Bt}const nextTick=async()=>{};async function asyncLoop(kt,At,xt){let Bt=Date.now();for(let Nt=0;Nt<kt;Nt++){xt(Nt);const jt=Date.now()-Bt;jt>=0&&jt<At||(await nextTick(),Bt+=jt)}}function utf8ToBytes$2(kt){if(typeof kt!="string")throw new Error(`utf8ToBytes expected string, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function toBytes$1(kt){if(typeof kt=="string"&&(kt=utf8ToBytes$2(kt)),!isBytes$4(kt))throw new Error(`expected Uint8Array, got ${typeof kt}`);return kt}function concatBytes$1(...kt){let At=0;for(let Bt=0;Bt<kt.length;Bt++){const Nt=kt[Bt];if(!isBytes$4(Nt))throw new Error("Uint8Array expected");At+=Nt.length}const xt=new Uint8Array(At);for(let Bt=0,Nt=0;Bt<kt.length;Bt++){const jt=kt[Bt];xt.set(jt,Nt),Nt+=jt.length}return xt}class Hash{clone(){return this._cloneInto()}}const toStr={}.toString;function checkOpts(kt,At){if(At!==void 0&&toStr.call(At)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(kt,At)}function wrapConstructor(kt){const At=Bt=>kt().update(toBytes$1(Bt)).digest(),xt=kt();return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=()=>kt(),At}function randomBytes$2(kt=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(kt));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(kt,At,xt,Bt){if(typeof kt.setBigUint64=="function")return kt.setBigUint64(At,xt,Bt);const Nt=BigInt(32),jt=BigInt(4294967295),Ut=Number(xt>>Nt&jt),Lt=Number(xt&jt),Ht=Bt?4:0,Vt=Bt?0:4;kt.setUint32(At+Ht,Ut,Bt),kt.setUint32(At+Vt,Lt,Bt)}class SHA2 extends Hash{constructor(At,xt,Bt,Nt){super(),this.blockLen=At,this.outputLen=xt,this.padOffset=Bt,this.isLE=Nt,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(At),this.view=createView(this.buffer)}update(At){exists$1(this);const{view:xt,buffer:Bt,blockLen:Nt}=this;At=toBytes$1(At);const jt=At.length;for(let Ut=0;Ut<jt;){const Lt=Math.min(Nt-this.pos,jt-Ut);if(Lt===Nt){const Ht=createView(At);for(;Nt<=jt-Ut;Ut+=Nt)this.process(Ht,Ut);continue}Bt.set(At.subarray(Ut,Ut+Lt),this.pos),this.pos+=Lt,Ut+=Lt,this.pos===Nt&&(this.process(xt,0),this.pos=0)}return this.length+=At.length,this.roundClean(),this}digestInto(At){exists$1(this),output$1(At,this),this.finished=!0;const{buffer:xt,view:Bt,blockLen:Nt,isLE:jt}=this;let{pos:Ut}=this;xt[Ut++]=128,this.buffer.subarray(Ut).fill(0),this.padOffset>Nt-Ut&&(this.process(Bt,0),Ut=0);for(let Wt=Ut;Wt<Nt;Wt++)xt[Wt]=0;setBigUint64(Bt,Nt-8,BigInt(this.length*8),jt),this.process(Bt,0);const Lt=createView(At),Ht=this.outputLen;if(Ht%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Vt=Ht/4,zt=this.get();if(Vt>zt.length)throw new Error("_sha2: outputLen bigger than state");for(let Wt=0;Wt<Vt;Wt++)Lt.setUint32(4*Wt,zt[Wt],jt)}digest(){const{buffer:At,outputLen:xt}=this;this.digestInto(At);const Bt=At.slice(0,xt);return this.destroy(),Bt}_cloneInto(At){At||(At=new this.constructor),At.set(...this.get());const{blockLen:xt,buffer:Bt,length:Nt,finished:jt,destroyed:Ut,pos:Lt}=this;return At.length=Nt,At.pos=Lt,At.finished=jt,At.destroyed=Ut,Nt%xt&&At.buffer.set(Bt),At}}const Chi=(kt,At,xt)=>kt&At^~kt&xt,Maj=(kt,At,xt)=>kt&At^kt&xt^At&xt,SHA256_K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W=new Uint32Array(64);class SHA256 extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:At,B:xt,C:Bt,D:Nt,E:jt,F:Ut,G:Lt,H:Ht}=this;return[At,xt,Bt,Nt,jt,Ut,Lt,Ht]}set(At,xt,Bt,Nt,jt,Ut,Lt,Ht){this.A=At|0,this.B=xt|0,this.C=Bt|0,this.D=Nt|0,this.E=jt|0,this.F=Ut|0,this.G=Lt|0,this.H=Ht|0}process(At,xt){for(let Wt=0;Wt<16;Wt++,xt+=4)SHA256_W[Wt]=At.getUint32(xt,!1);for(let Wt=16;Wt<64;Wt++){const Jt=SHA256_W[Wt-15],Qt=SHA256_W[Wt-2],Xt=rotr(Jt,7)^rotr(Jt,18)^Jt>>>3,tr=rotr(Qt,17)^rotr(Qt,19)^Qt>>>10;SHA256_W[Wt]=tr+SHA256_W[Wt-7]+Xt+SHA256_W[Wt-16]|0}let{A:Bt,B:Nt,C:jt,D:Ut,E:Lt,F:Ht,G:Vt,H:zt}=this;for(let Wt=0;Wt<64;Wt++){const Jt=rotr(Lt,6)^rotr(Lt,11)^rotr(Lt,25),Qt=zt+Jt+Chi(Lt,Ht,Vt)+SHA256_K[Wt]+SHA256_W[Wt]|0,tr=(rotr(Bt,2)^rotr(Bt,13)^rotr(Bt,22))+Maj(Bt,Nt,jt)|0;zt=Vt,Vt=Ht,Ht=Lt,Lt=Ut+Qt|0,Ut=jt,jt=Nt,Nt=Bt,Bt=Qt+tr|0}Bt=Bt+this.A|0,Nt=Nt+this.B|0,jt=jt+this.C|0,Ut=Ut+this.D|0,Lt=Lt+this.E|0,Ht=Ht+this.F|0,Vt=Vt+this.G|0,zt=zt+this.H|0,this.set(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt)}roundClean(){SHA256_W.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const sha256=wrapConstructor(()=>new SHA256);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$5=BigInt(0),_1n$7=BigInt(1),_2n$4=BigInt(2);function isBytes$3(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}const hexes=Array.from({length:256},(kt,At)=>At.toString(16).padStart(2,"0"));function bytesToHex(kt){if(!isBytes$3(kt))throw new Error("Uint8Array expected");let At="";for(let xt=0;xt<kt.length;xt++)At+=hexes[kt[xt]];return At}function numberToHexUnpadded(kt){const At=kt.toString(16);return At.length&1?`0${At}`:At}function hexToNumber(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);return BigInt(kt===""?"0":`0x${kt}`)}const asciis={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16(kt){if(kt>=asciis._0&&kt<=asciis._9)return kt-asciis._0;if(kt>=asciis._A&&kt<=asciis._F)return kt-(asciis._A-10);if(kt>=asciis._a&&kt<=asciis._f)return kt-(asciis._a-10)}function hexToBytes(kt){if(typeof kt!="string")throw new Error("hex string expected, got "+typeof kt);const At=kt.length,xt=At/2;if(At%2)throw new Error("padded hex string expected, got unpadded hex of length "+At);const Bt=new Uint8Array(xt);for(let Nt=0,jt=0;Nt<xt;Nt++,jt+=2){const Ut=asciiToBase16(kt.charCodeAt(jt)),Lt=asciiToBase16(kt.charCodeAt(jt+1));if(Ut===void 0||Lt===void 0){const Ht=kt[jt]+kt[jt+1];throw new Error('hex string expected, got non-hex character "'+Ht+'" at index '+jt)}Bt[Nt]=Ut*16+Lt}return Bt}function bytesToNumberBE(kt){return hexToNumber(bytesToHex(kt))}function bytesToNumberLE(kt){if(!isBytes$3(kt))throw new Error("Uint8Array expected");return hexToNumber(bytesToHex(Uint8Array.from(kt).reverse()))}function numberToBytesBE(kt,At){return hexToBytes(kt.toString(16).padStart(At*2,"0"))}function numberToBytesLE(kt,At){return numberToBytesBE(kt,At).reverse()}function numberToVarBytesBE(kt){return hexToBytes(numberToHexUnpadded(kt))}function ensureBytes$2(kt,At,xt){let Bt;if(typeof At=="string")try{Bt=hexToBytes(At)}catch(jt){throw new Error(`${kt} must be valid hex string, got "${At}". Cause: ${jt}`)}else if(isBytes$3(At))Bt=Uint8Array.from(At);else throw new Error(`${kt} must be hex string or Uint8Array`);const Nt=Bt.length;if(typeof xt=="number"&&Nt!==xt)throw new Error(`${kt} expected ${xt} bytes, got ${Nt}`);return Bt}function concatBytes(...kt){let At=0;for(let Nt=0;Nt<kt.length;Nt++){const jt=kt[Nt];if(!isBytes$3(jt))throw new Error("Uint8Array expected");At+=jt.length}let xt=new Uint8Array(At),Bt=0;for(let Nt=0;Nt<kt.length;Nt++){const jt=kt[Nt];xt.set(jt,Bt),Bt+=jt.length}return xt}function equalBytes(kt,At){if(kt.length!==At.length)return!1;let xt=0;for(let Bt=0;Bt<kt.length;Bt++)xt|=kt[Bt]^At[Bt];return xt===0}function utf8ToBytes$1(kt){if(typeof kt!="string")throw new Error(`utf8ToBytes expected string, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function bitLen(kt){let At;for(At=0;kt>_0n$5;kt>>=_1n$7,At+=1);return At}function bitGet(kt,At){return kt>>BigInt(At)&_1n$7}const bitSet=(kt,At,xt)=>kt|(xt?_1n$7:_0n$5)<<BigInt(At),bitMask=kt=>(_2n$4<<BigInt(kt-1))-_1n$7,u8n=kt=>new Uint8Array(kt),u8fr=kt=>Uint8Array.from(kt);function createHmacDrbg(kt,At,xt){if(typeof kt!="number"||kt<2)throw new Error("hashLen must be a number");if(typeof At!="number"||At<2)throw new Error("qByteLen must be a number");if(typeof xt!="function")throw new Error("hmacFn must be a function");let Bt=u8n(kt),Nt=u8n(kt),jt=0;const Ut=()=>{Bt.fill(1),Nt.fill(0),jt=0},Lt=(...Wt)=>xt(Nt,Bt,...Wt),Ht=(Wt=u8n())=>{Nt=Lt(u8fr([0]),Wt),Bt=Lt(),Wt.length!==0&&(Nt=Lt(u8fr([1]),Wt),Bt=Lt())},Vt=()=>{if(jt++>=1e3)throw new Error("drbg: tried 1000 values");let Wt=0;const Jt=[];for(;Wt<At;){Bt=Lt();const Qt=Bt.slice();Jt.push(Qt),Wt+=Bt.length}return concatBytes(...Jt)};return(Wt,Jt)=>{Ut(),Ht(Wt);let Qt;for(;!(Qt=Jt(Vt()));)Ht();return Ut(),Qt}}const validatorFns={bigint:kt=>typeof kt=="bigint",function:kt=>typeof kt=="function",boolean:kt=>typeof kt=="boolean",string:kt=>typeof kt=="string",stringOrUint8Array:kt=>typeof kt=="string"||isBytes$3(kt),isSafeInteger:kt=>Number.isSafeInteger(kt),array:kt=>Array.isArray(kt),field:(kt,At)=>At.Fp.isValid(kt),hash:kt=>typeof kt=="function"&&Number.isSafeInteger(kt.outputLen)};function validateObject(kt,At,xt={}){const Bt=(Nt,jt,Ut)=>{const Lt=validatorFns[jt];if(typeof Lt!="function")throw new Error(`Invalid validator "${jt}", expected function`);const Ht=kt[Nt];if(!(Ut&&Ht===void 0)&&!Lt(Ht,kt))throw new Error(`Invalid param ${String(Nt)}=${Ht} (${typeof Ht}), expected ${jt}`)};for(const[Nt,jt]of Object.entries(At))Bt(Nt,jt,!1);for(const[Nt,jt]of Object.entries(xt))Bt(Nt,jt,!0);return kt}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen,bitMask,bitSet,bytesToHex,bytesToNumberBE,bytesToNumberLE,concatBytes,createHmacDrbg,ensureBytes:ensureBytes$2,equalBytes,hexToBytes,hexToNumber,isBytes:isBytes$3,numberToBytesBE,numberToBytesLE,numberToHexUnpadded,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$1,validateObject},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$4=BigInt(0),_1n$6=BigInt(1),_2n$3=BigInt(2),_3n$1=BigInt(3),_4n=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod(kt,At){const xt=kt%At;return xt>=_0n$4?xt:At+xt}function pow(kt,At,xt){if(xt<=_0n$4||At<_0n$4)throw new Error("Expected power/modulo > 0");if(xt===_1n$6)return _0n$4;let Bt=_1n$6;for(;At>_0n$4;)At&_1n$6&&(Bt=Bt*kt%xt),kt=kt*kt%xt,At>>=_1n$6;return Bt}function pow2(kt,At,xt){let Bt=kt;for(;At-- >_0n$4;)Bt*=Bt,Bt%=xt;return Bt}function invert(kt,At){if(kt===_0n$4||At<=_0n$4)throw new Error(`invert: expected positive integers, got n=${kt} mod=${At}`);let xt=mod(kt,At),Bt=At,Nt=_0n$4,jt=_1n$6;for(;xt!==_0n$4;){const Lt=Bt/xt,Ht=Bt%xt,Vt=Nt-jt*Lt;Bt=xt,xt=Ht,Nt=jt,jt=Vt}if(Bt!==_1n$6)throw new Error("invert: does not exist");return mod(Nt,At)}function tonelliShanks(kt){const At=(kt-_1n$6)/_2n$3;let xt,Bt,Nt;for(xt=kt-_1n$6,Bt=0;xt%_2n$3===_0n$4;xt/=_2n$3,Bt++);for(Nt=_2n$3;Nt<kt&&pow(Nt,At,kt)!==kt-_1n$6;Nt++);if(Bt===1){const Ut=(kt+_1n$6)/_4n;return function(Ht,Vt){const zt=Ht.pow(Vt,Ut);if(!Ht.eql(Ht.sqr(zt),Vt))throw new Error("Cannot find square root");return zt}}const jt=(xt+_1n$6)/_2n$3;return function(Lt,Ht){if(Lt.pow(Ht,At)===Lt.neg(Lt.ONE))throw new Error("Cannot find square root");let Vt=Bt,zt=Lt.pow(Lt.mul(Lt.ONE,Nt),xt),Wt=Lt.pow(Ht,jt),Jt=Lt.pow(Ht,xt);for(;!Lt.eql(Jt,Lt.ONE);){if(Lt.eql(Jt,Lt.ZERO))return Lt.ZERO;let Qt=1;for(let tr=Lt.sqr(Jt);Qt<Vt&&!Lt.eql(tr,Lt.ONE);Qt++)tr=Lt.sqr(tr);const Xt=Lt.pow(zt,_1n$6<<BigInt(Vt-Qt-1));zt=Lt.sqr(Xt),Wt=Lt.mul(Wt,Xt),Jt=Lt.mul(Jt,zt),Vt=Qt}return Wt}}function FpSqrt(kt){if(kt%_4n===_3n$1){const At=(kt+_1n$6)/_4n;return function(Bt,Nt){const jt=Bt.pow(Nt,At);if(!Bt.eql(Bt.sqr(jt),Nt))throw new Error("Cannot find square root");return jt}}if(kt%_8n$1===_5n$1){const At=(kt-_5n$1)/_8n$1;return function(Bt,Nt){const jt=Bt.mul(Nt,_2n$3),Ut=Bt.pow(jt,At),Lt=Bt.mul(Nt,Ut),Ht=Bt.mul(Bt.mul(Lt,_2n$3),Ut),Vt=Bt.mul(Lt,Bt.sub(Ht,Bt.ONE));if(!Bt.eql(Bt.sqr(Vt),Nt))throw new Error("Cannot find square root");return Vt}}return tonelliShanks(kt)}const isNegativeLE=(kt,At)=>(mod(kt,At)&_1n$6)===_1n$6,FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(kt){const At={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},xt=FIELD_FIELDS.reduce((Bt,Nt)=>(Bt[Nt]="function",Bt),At);return validateObject(kt,xt)}function FpPow(kt,At,xt){if(xt<_0n$4)throw new Error("Expected power > 0");if(xt===_0n$4)return kt.ONE;if(xt===_1n$6)return At;let Bt=kt.ONE,Nt=At;for(;xt>_0n$4;)xt&_1n$6&&(Bt=kt.mul(Bt,Nt)),Nt=kt.sqr(Nt),xt>>=_1n$6;return Bt}function FpInvertBatch(kt,At){const xt=new Array(At.length),Bt=At.reduce((jt,Ut,Lt)=>kt.is0(Ut)?jt:(xt[Lt]=jt,kt.mul(jt,Ut)),kt.ONE),Nt=kt.inv(Bt);return At.reduceRight((jt,Ut,Lt)=>kt.is0(Ut)?jt:(xt[Lt]=kt.mul(jt,xt[Lt]),kt.mul(jt,Ut)),Nt),xt}function nLength(kt,At){const xt=At!==void 0?At:kt.toString(2).length,Bt=Math.ceil(xt/8);return{nBitLength:xt,nByteLength:Bt}}function Field(kt,At,xt=!1,Bt={}){if(kt<=_0n$4)throw new Error(`Expected Field ORDER > 0, got ${kt}`);const{nBitLength:Nt,nByteLength:jt}=nLength(kt,At);if(jt>2048)throw new Error("Field lengths over 2048 bytes are not supported");const Ut=FpSqrt(kt),Lt=Object.freeze({ORDER:kt,BITS:Nt,BYTES:jt,MASK:bitMask(Nt),ZERO:_0n$4,ONE:_1n$6,create:Ht=>mod(Ht,kt),isValid:Ht=>{if(typeof Ht!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof Ht}`);return _0n$4<=Ht&&Ht<kt},is0:Ht=>Ht===_0n$4,isOdd:Ht=>(Ht&_1n$6)===_1n$6,neg:Ht=>mod(-Ht,kt),eql:(Ht,Vt)=>Ht===Vt,sqr:Ht=>mod(Ht*Ht,kt),add:(Ht,Vt)=>mod(Ht+Vt,kt),sub:(Ht,Vt)=>mod(Ht-Vt,kt),mul:(Ht,Vt)=>mod(Ht*Vt,kt),pow:(Ht,Vt)=>FpPow(Lt,Ht,Vt),div:(Ht,Vt)=>mod(Ht*invert(Vt,kt),kt),sqrN:Ht=>Ht*Ht,addN:(Ht,Vt)=>Ht+Vt,subN:(Ht,Vt)=>Ht-Vt,mulN:(Ht,Vt)=>Ht*Vt,inv:Ht=>invert(Ht,kt),sqrt:Bt.sqrt||(Ht=>Ut(Lt,Ht)),invertBatch:Ht=>FpInvertBatch(Lt,Ht),cmov:(Ht,Vt,zt)=>zt?Vt:Ht,toBytes:Ht=>xt?numberToBytesLE(Ht,jt):numberToBytesBE(Ht,jt),fromBytes:Ht=>{if(Ht.length!==jt)throw new Error(`Fp.fromBytes: expected ${jt}, got ${Ht.length}`);return xt?bytesToNumberLE(Ht):bytesToNumberBE(Ht)}});return Object.freeze(Lt)}function FpSqrtEven(kt,At){if(!kt.isOdd)throw new Error("Field doesn't have isOdd");const xt=kt.sqrt(At);return kt.isOdd(xt)?kt.neg(xt):xt}function getFieldBytesLength(kt){if(typeof kt!="bigint")throw new Error("field order must be bigint");const At=kt.toString(2).length;return Math.ceil(At/8)}function getMinHashLength(kt){const At=getFieldBytesLength(kt);return At+Math.ceil(At/2)}function mapHashToField(kt,At,xt=!1){const Bt=kt.length,Nt=getFieldBytesLength(At),jt=getMinHashLength(At);if(Bt<16||Bt<jt||Bt>1024)throw new Error(`expected ${jt}-1024 bytes of input, got ${Bt}`);const Ut=xt?bytesToNumberBE(kt):bytesToNumberLE(kt),Lt=mod(Ut,At-_1n$6)+_1n$6;return xt?numberToBytesLE(Lt,Nt):numberToBytesBE(Lt,Nt)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$5=BigInt(1);function wNAF(kt,At){const xt=(Nt,jt)=>{const Ut=jt.negate();return Nt?Ut:jt},Bt=Nt=>{const jt=Math.ceil(At/Nt)+1,Ut=2**(Nt-1);return{windows:jt,windowSize:Ut}};return{constTimeNegate:xt,unsafeLadder(Nt,jt){let Ut=kt.ZERO,Lt=Nt;for(;jt>_0n$3;)jt&_1n$5&&(Ut=Ut.add(Lt)),Lt=Lt.double(),jt>>=_1n$5;return Ut},precomputeWindow(Nt,jt){const{windows:Ut,windowSize:Lt}=Bt(jt),Ht=[];let Vt=Nt,zt=Vt;for(let Wt=0;Wt<Ut;Wt++){zt=Vt,Ht.push(zt);for(let Jt=1;Jt<Lt;Jt++)zt=zt.add(Vt),Ht.push(zt);Vt=zt.double()}return Ht},wNAF(Nt,jt,Ut){const{windows:Lt,windowSize:Ht}=Bt(Nt);let Vt=kt.ZERO,zt=kt.BASE;const Wt=BigInt(2**Nt-1),Jt=2**Nt,Qt=BigInt(Nt);for(let Xt=0;Xt<Lt;Xt++){const tr=Xt*Ht;let rr=Number(Ut&Wt);Ut>>=Qt,rr>Ht&&(rr-=Jt,Ut+=_1n$5);const nr=tr,ar=tr+Math.abs(rr)-1,ir=Xt%2!==0,lr=rr<0;rr===0?zt=zt.add(xt(ir,jt[nr])):Vt=Vt.add(xt(lr,jt[ar]))}return{p:Vt,f:zt}},wNAFCached(Nt,jt,Ut,Lt){const Ht=Nt._WINDOW_SIZE||1;let Vt=jt.get(Nt);return Vt||(Vt=this.precomputeWindow(Nt,Ht),Ht!==1&&jt.set(Nt,Lt(Vt))),this.wNAF(Ht,Vt,Ut)}}}function validateBasic(kt){return validateField(kt.Fp),validateObject(kt,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(kt.n,kt.nBitLength),...kt,p:kt.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts(kt){const At=validateBasic(kt);validateObject(At,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:xt,Fp:Bt,a:Nt}=At;if(xt){if(!Bt.eql(Nt,Bt.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof xt!="object"||typeof xt.beta!="bigint"||typeof xt.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...At})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER={Err:class extends Error{constructor(At=""){super(At)}},_parseInt(kt){const{Err:At}=DER;if(kt.length<2||kt[0]!==2)throw new At("Invalid signature integer tag");const xt=kt[1],Bt=kt.subarray(2,xt+2);if(!xt||Bt.length!==xt)throw new At("Invalid signature integer: wrong length");if(Bt[0]&128)throw new At("Invalid signature integer: negative");if(Bt[0]===0&&!(Bt[1]&128))throw new At("Invalid signature integer: unnecessary leading zero");return{d:b2n(Bt),l:kt.subarray(xt+2)}},toSig(kt){const{Err:At}=DER,xt=typeof kt=="string"?h2b(kt):kt;if(!isBytes$3(xt))throw new Error("ui8a expected");let Bt=xt.length;if(Bt<2||xt[0]!=48)throw new At("Invalid signature tag");if(xt[1]!==Bt-2)throw new At("Invalid signature: incorrect length");const{d:Nt,l:jt}=DER._parseInt(xt.subarray(2)),{d:Ut,l:Lt}=DER._parseInt(jt);if(Lt.length)throw new At("Invalid signature: left bytes after parsing");return{r:Nt,s:Ut}},hexFromSig(kt){const At=Vt=>Number.parseInt(Vt[0],16)&8?"00"+Vt:Vt,xt=Vt=>{const zt=Vt.toString(16);return zt.length&1?`0${zt}`:zt},Bt=At(xt(kt.s)),Nt=At(xt(kt.r)),jt=Bt.length/2,Ut=Nt.length/2,Lt=xt(jt),Ht=xt(Ut);return`30${xt(Ut+jt+4)}02${Ht}${Nt}02${Lt}${Bt}`}},_0n$2=BigInt(0),_1n$4=BigInt(1);BigInt(2);const _3n=BigInt(3);BigInt(4);function weierstrassPoints(kt){const At=validatePointOpts(kt),{Fp:xt}=At,Bt=At.toBytes||((Xt,tr,rr)=>{const nr=tr.toAffine();return concatBytes(Uint8Array.from([4]),xt.toBytes(nr.x),xt.toBytes(nr.y))}),Nt=At.fromBytes||(Xt=>{const tr=Xt.subarray(1),rr=xt.fromBytes(tr.subarray(0,xt.BYTES)),nr=xt.fromBytes(tr.subarray(xt.BYTES,2*xt.BYTES));return{x:rr,y:nr}});function jt(Xt){const{a:tr,b:rr}=At,nr=xt.sqr(Xt),ar=xt.mul(nr,Xt);return xt.add(xt.add(ar,xt.mul(Xt,tr)),rr)}if(!xt.eql(xt.sqr(At.Gy),jt(At.Gx)))throw new Error("bad generator point: equation left != right");function Ut(Xt){return typeof Xt=="bigint"&&_0n$2<Xt&&Xt<At.n}function Lt(Xt){if(!Ut(Xt))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function Ht(Xt){const{allowedPrivateKeyLengths:tr,nByteLength:rr,wrapPrivateKey:nr,n:ar}=At;if(tr&&typeof Xt!="bigint"){if(isBytes$3(Xt)&&(Xt=bytesToHex(Xt)),typeof Xt!="string"||!tr.includes(Xt.length))throw new Error("Invalid key");Xt=Xt.padStart(rr*2,"0")}let ir;try{ir=typeof Xt=="bigint"?Xt:bytesToNumberBE(ensureBytes$2("private key",Xt,rr))}catch{throw new Error(`private key must be ${rr} bytes, hex or bigint, not ${typeof Xt}`)}return nr&&(ir=mod(ir,ar)),Lt(ir),ir}const Vt=new Map;function zt(Xt){if(!(Xt instanceof Wt))throw new Error("ProjectivePoint expected")}class Wt{constructor(tr,rr,nr){if(this.px=tr,this.py=rr,this.pz=nr,tr==null||!xt.isValid(tr))throw new Error("x required");if(rr==null||!xt.isValid(rr))throw new Error("y required");if(nr==null||!xt.isValid(nr))throw new Error("z required")}static fromAffine(tr){const{x:rr,y:nr}=tr||{};if(!tr||!xt.isValid(rr)||!xt.isValid(nr))throw new Error("invalid affine point");if(tr instanceof Wt)throw new Error("projective point not allowed");const ar=ir=>xt.eql(ir,xt.ZERO);return ar(rr)&&ar(nr)?Wt.ZERO:new Wt(rr,nr,xt.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(tr){const rr=xt.invertBatch(tr.map(nr=>nr.pz));return tr.map((nr,ar)=>nr.toAffine(rr[ar])).map(Wt.fromAffine)}static fromHex(tr){const rr=Wt.fromAffine(Nt(ensureBytes$2("pointHex",tr)));return rr.assertValidity(),rr}static fromPrivateKey(tr){return Wt.BASE.multiply(Ht(tr))}_setWindowSize(tr){this._WINDOW_SIZE=tr,Vt.delete(this)}assertValidity(){if(this.is0()){if(At.allowInfinityPoint&&!xt.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:tr,y:rr}=this.toAffine();if(!xt.isValid(tr)||!xt.isValid(rr))throw new Error("bad point: x or y not FE");const nr=xt.sqr(rr),ar=jt(tr);if(!xt.eql(nr,ar))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:tr}=this.toAffine();if(xt.isOdd)return!xt.isOdd(tr);throw new Error("Field doesn't support isOdd")}equals(tr){zt(tr);const{px:rr,py:nr,pz:ar}=this,{px:ir,py:lr,pz:yr}=tr,Sr=xt.eql(xt.mul(rr,yr),xt.mul(ir,ar)),Ar=xt.eql(xt.mul(nr,yr),xt.mul(lr,ar));return Sr&&Ar}negate(){return new Wt(this.px,xt.neg(this.py),this.pz)}double(){const{a:tr,b:rr}=At,nr=xt.mul(rr,_3n),{px:ar,py:ir,pz:lr}=this;let yr=xt.ZERO,Sr=xt.ZERO,Ar=xt.ZERO,Dr=xt.mul(ar,ar),Br=xt.mul(ir,ir),Lr=xt.mul(lr,lr),Or=xt.mul(ar,ir);return Or=xt.add(Or,Or),Ar=xt.mul(ar,lr),Ar=xt.add(Ar,Ar),yr=xt.mul(tr,Ar),Sr=xt.mul(nr,Lr),Sr=xt.add(yr,Sr),yr=xt.sub(Br,Sr),Sr=xt.add(Br,Sr),Sr=xt.mul(yr,Sr),yr=xt.mul(Or,yr),Ar=xt.mul(nr,Ar),Lr=xt.mul(tr,Lr),Or=xt.sub(Dr,Lr),Or=xt.mul(tr,Or),Or=xt.add(Or,Ar),Ar=xt.add(Dr,Dr),Dr=xt.add(Ar,Dr),Dr=xt.add(Dr,Lr),Dr=xt.mul(Dr,Or),Sr=xt.add(Sr,Dr),Lr=xt.mul(ir,lr),Lr=xt.add(Lr,Lr),Dr=xt.mul(Lr,Or),yr=xt.sub(yr,Dr),Ar=xt.mul(Lr,Br),Ar=xt.add(Ar,Ar),Ar=xt.add(Ar,Ar),new Wt(yr,Sr,Ar)}add(tr){zt(tr);const{px:rr,py:nr,pz:ar}=this,{px:ir,py:lr,pz:yr}=tr;let Sr=xt.ZERO,Ar=xt.ZERO,Dr=xt.ZERO;const Br=At.a,Lr=xt.mul(At.b,_3n);let Or=xt.mul(rr,ir),vr=xt.mul(nr,lr),pr=xt.mul(ar,yr),dr=xt.add(rr,nr),ur=xt.add(ir,lr);dr=xt.mul(dr,ur),ur=xt.add(Or,vr),dr=xt.sub(dr,ur),ur=xt.add(rr,ar);let $r=xt.add(ir,yr);return ur=xt.mul(ur,$r),$r=xt.add(Or,pr),ur=xt.sub(ur,$r),$r=xt.add(nr,ar),Sr=xt.add(lr,yr),$r=xt.mul($r,Sr),Sr=xt.add(vr,pr),$r=xt.sub($r,Sr),Dr=xt.mul(Br,ur),Sr=xt.mul(Lr,pr),Dr=xt.add(Sr,Dr),Sr=xt.sub(vr,Dr),Dr=xt.add(vr,Dr),Ar=xt.mul(Sr,Dr),vr=xt.add(Or,Or),vr=xt.add(vr,Or),pr=xt.mul(Br,pr),ur=xt.mul(Lr,ur),vr=xt.add(vr,pr),pr=xt.sub(Or,pr),pr=xt.mul(Br,pr),ur=xt.add(ur,pr),Or=xt.mul(vr,ur),Ar=xt.add(Ar,Or),Or=xt.mul($r,ur),Sr=xt.mul(dr,Sr),Sr=xt.sub(Sr,Or),Or=xt.mul(dr,vr),Dr=xt.mul($r,Dr),Dr=xt.add(Dr,Or),new Wt(Sr,Ar,Dr)}subtract(tr){return this.add(tr.negate())}is0(){return this.equals(Wt.ZERO)}wNAF(tr){return Qt.wNAFCached(this,Vt,tr,rr=>{const nr=xt.invertBatch(rr.map(ar=>ar.pz));return rr.map((ar,ir)=>ar.toAffine(nr[ir])).map(Wt.fromAffine)})}multiplyUnsafe(tr){const rr=Wt.ZERO;if(tr===_0n$2)return rr;if(Lt(tr),tr===_1n$4)return this;const{endo:nr}=At;if(!nr)return Qt.unsafeLadder(this,tr);let{k1neg:ar,k1:ir,k2neg:lr,k2:yr}=nr.splitScalar(tr),Sr=rr,Ar=rr,Dr=this;for(;ir>_0n$2||yr>_0n$2;)ir&_1n$4&&(Sr=Sr.add(Dr)),yr&_1n$4&&(Ar=Ar.add(Dr)),Dr=Dr.double(),ir>>=_1n$4,yr>>=_1n$4;return ar&&(Sr=Sr.negate()),lr&&(Ar=Ar.negate()),Ar=new Wt(xt.mul(Ar.px,nr.beta),Ar.py,Ar.pz),Sr.add(Ar)}multiply(tr){Lt(tr);let rr=tr,nr,ar;const{endo:ir}=At;if(ir){const{k1neg:lr,k1:yr,k2neg:Sr,k2:Ar}=ir.splitScalar(rr);let{p:Dr,f:Br}=this.wNAF(yr),{p:Lr,f:Or}=this.wNAF(Ar);Dr=Qt.constTimeNegate(lr,Dr),Lr=Qt.constTimeNegate(Sr,Lr),Lr=new Wt(xt.mul(Lr.px,ir.beta),Lr.py,Lr.pz),nr=Dr.add(Lr),ar=Br.add(Or)}else{const{p:lr,f:yr}=this.wNAF(rr);nr=lr,ar=yr}return Wt.normalizeZ([nr,ar])[0]}multiplyAndAddUnsafe(tr,rr,nr){const ar=Wt.BASE,ir=(yr,Sr)=>Sr===_0n$2||Sr===_1n$4||!yr.equals(ar)?yr.multiplyUnsafe(Sr):yr.multiply(Sr),lr=ir(this,rr).add(ir(tr,nr));return lr.is0()?void 0:lr}toAffine(tr){const{px:rr,py:nr,pz:ar}=this,ir=this.is0();tr==null&&(tr=ir?xt.ONE:xt.inv(ar));const lr=xt.mul(rr,tr),yr=xt.mul(nr,tr),Sr=xt.mul(ar,tr);if(ir)return{x:xt.ZERO,y:xt.ZERO};if(!xt.eql(Sr,xt.ONE))throw new Error("invZ was invalid");return{x:lr,y:yr}}isTorsionFree(){const{h:tr,isTorsionFree:rr}=At;if(tr===_1n$4)return!0;if(rr)return rr(Wt,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:tr,clearCofactor:rr}=At;return tr===_1n$4?this:rr?rr(Wt,this):this.multiplyUnsafe(At.h)}toRawBytes(tr=!0){return this.assertValidity(),Bt(Wt,this,tr)}toHex(tr=!0){return bytesToHex(this.toRawBytes(tr))}}Wt.BASE=new Wt(At.Gx,At.Gy,xt.ONE),Wt.ZERO=new Wt(xt.ZERO,xt.ONE,xt.ZERO);const Jt=At.nBitLength,Qt=wNAF(Wt,At.endo?Math.ceil(Jt/2):Jt);return{CURVE:At,ProjectivePoint:Wt,normPrivateKeyToScalar:Ht,weierstrassEquation:jt,isWithinCurveOrder:Ut}}function validateOpts$2(kt){const At=validateBasic(kt);return validateObject(At,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...At})}function weierstrass(kt){const At=validateOpts$2(kt),{Fp:xt,n:Bt}=At,Nt=xt.BYTES+1,jt=2*xt.BYTES+1;function Ut(ur){return _0n$2<ur&&ur<xt.ORDER}function Lt(ur){return mod(ur,Bt)}function Ht(ur){return invert(ur,Bt)}const{ProjectivePoint:Vt,normPrivateKeyToScalar:zt,weierstrassEquation:Wt,isWithinCurveOrder:Jt}=weierstrassPoints({...At,toBytes(ur,$r,wr){const Er=$r.toAffine(),gr=xt.toBytes(Er.x),fr=concatBytes;return wr?fr(Uint8Array.from([$r.hasEvenY()?2:3]),gr):fr(Uint8Array.from([4]),gr,xt.toBytes(Er.y))},fromBytes(ur){const $r=ur.length,wr=ur[0],Er=ur.subarray(1);if($r===Nt&&(wr===2||wr===3)){const gr=bytesToNumberBE(Er);if(!Ut(gr))throw new Error("Point is not on curve");const fr=Wt(gr);let br=xt.sqrt(fr);const _r=(br&_1n$4)===_1n$4;return(wr&1)===1!==_r&&(br=xt.neg(br)),{x:gr,y:br}}else if($r===jt&&wr===4){const gr=xt.fromBytes(Er.subarray(0,xt.BYTES)),fr=xt.fromBytes(Er.subarray(xt.BYTES,2*xt.BYTES));return{x:gr,y:fr}}else throw new Error(`Point of length ${$r} was invalid. Expected ${Nt} compressed bytes or ${jt} uncompressed bytes`)}}),Qt=ur=>bytesToHex(numberToBytesBE(ur,At.nByteLength));function Xt(ur){const $r=Bt>>_1n$4;return ur>$r}function tr(ur){return Xt(ur)?Lt(-ur):ur}const rr=(ur,$r,wr)=>bytesToNumberBE(ur.slice($r,wr));class nr{constructor($r,wr,Er){this.r=$r,this.s=wr,this.recovery=Er,this.assertValidity()}static fromCompact($r){const wr=At.nByteLength;return $r=ensureBytes$2("compactSignature",$r,wr*2),new nr(rr($r,0,wr),rr($r,wr,2*wr))}static fromDER($r){const{r:wr,s:Er}=DER.toSig(ensureBytes$2("DER",$r));return new nr(wr,Er)}assertValidity(){if(!Jt(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!Jt(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit($r){return new nr(this.r,this.s,$r)}recoverPublicKey($r){const{r:wr,s:Er,recovery:gr}=this,fr=Ar(ensureBytes$2("msgHash",$r));if(gr==null||![0,1,2,3].includes(gr))throw new Error("recovery id invalid");const br=gr===2||gr===3?wr+At.n:wr;if(br>=xt.ORDER)throw new Error("recovery id 2 or 3 invalid");const _r=gr&1?"03":"02",Tr=Vt.fromHex(_r+Qt(br)),Pr=Ht(br),Nr=Lt(-fr*Pr),Cr=Lt(Er*Pr),xr=Vt.BASE.multiplyAndAddUnsafe(Tr,Nr,Cr);if(!xr)throw new Error("point at infinify");return xr.assertValidity(),xr}hasHighS(){return Xt(this.s)}normalizeS(){return this.hasHighS()?new nr(this.r,Lt(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes(this.toDERHex())}toDERHex(){return DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes(this.toCompactHex())}toCompactHex(){return Qt(this.r)+Qt(this.s)}}const ar={isValidPrivateKey(ur){try{return zt(ur),!0}catch{return!1}},normPrivateKeyToScalar:zt,randomPrivateKey:()=>{const ur=getMinHashLength(At.n);return mapHashToField(At.randomBytes(ur),At.n)},precompute(ur=8,$r=Vt.BASE){return $r._setWindowSize(ur),$r.multiply(BigInt(3)),$r}};function ir(ur,$r=!0){return Vt.fromPrivateKey(ur).toRawBytes($r)}function lr(ur){const $r=isBytes$3(ur),wr=typeof ur=="string",Er=($r||wr)&&ur.length;return $r?Er===Nt||Er===jt:wr?Er===2*Nt||Er===2*jt:ur instanceof Vt}function yr(ur,$r,wr=!0){if(lr(ur))throw new Error("first arg must be private key");if(!lr($r))throw new Error("second arg must be public key");return Vt.fromHex($r).multiply(zt(ur)).toRawBytes(wr)}const Sr=At.bits2int||function(ur){const $r=bytesToNumberBE(ur),wr=ur.length*8-At.nBitLength;return wr>0?$r>>BigInt(wr):$r},Ar=At.bits2int_modN||function(ur){return Lt(Sr(ur))},Dr=bitMask(At.nBitLength);function Br(ur){if(typeof ur!="bigint")throw new Error("bigint expected");if(!(_0n$2<=ur&&ur<Dr))throw new Error(`bigint expected < 2^${At.nBitLength}`);return numberToBytesBE(ur,At.nByteLength)}function Lr(ur,$r,wr=Or){if(["recovered","canonical"].some(qr=>qr in wr))throw new Error("sign() legacy options not supported");const{hash:Er,randomBytes:gr}=At;let{lowS:fr,prehash:br,extraEntropy:_r}=wr;fr==null&&(fr=!0),ur=ensureBytes$2("msgHash",ur),br&&(ur=ensureBytes$2("prehashed msgHash",Er(ur)));const Tr=Ar(ur),Pr=zt($r),Nr=[Br(Pr),Br(Tr)];if(_r!=null){const qr=_r===!0?gr(xt.BYTES):_r;Nr.push(ensureBytes$2("extraEntropy",qr))}const Cr=concatBytes(...Nr),xr=Tr;function Rr(qr){const Vr=Sr(qr);if(!Jt(Vr))return;const Gr=Ht(Vr),Ur=Vt.BASE.multiply(Vr).toAffine(),kr=Lt(Ur.x);if(kr===_0n$2)return;const Fr=Lt(Gr*Lt(xr+kr*Pr));if(Fr===_0n$2)return;let Wr=(Ur.x===kr?0:2)|Number(Ur.y&_1n$4),jr=Fr;return fr&&Xt(Fr)&&(jr=tr(Fr),Wr^=1),new nr(kr,jr,Wr)}return{seed:Cr,k2sig:Rr}}const Or={lowS:At.lowS,prehash:!1},vr={lowS:At.lowS,prehash:!1};function pr(ur,$r,wr=Or){const{seed:Er,k2sig:gr}=Lr(ur,$r,wr),fr=At;return createHmacDrbg(fr.hash.outputLen,fr.nByteLength,fr.hmac)(Er,gr)}Vt.BASE._setWindowSize(8);function dr(ur,$r,wr,Er=vr){var Ur;const gr=ur;if($r=ensureBytes$2("msgHash",$r),wr=ensureBytes$2("publicKey",wr),"strict"in Er)throw new Error("options.strict was renamed to lowS");const{lowS:fr,prehash:br}=Er;let _r,Tr;try{if(typeof gr=="string"||isBytes$3(gr))try{_r=nr.fromDER(gr)}catch(kr){if(!(kr instanceof DER.Err))throw kr;_r=nr.fromCompact(gr)}else if(typeof gr=="object"&&typeof gr.r=="bigint"&&typeof gr.s=="bigint"){const{r:kr,s:Fr}=gr;_r=new nr(kr,Fr)}else throw new Error("PARSE");Tr=Vt.fromHex(wr)}catch(kr){if(kr.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(fr&&_r.hasHighS())return!1;br&&($r=At.hash($r));const{r:Pr,s:Nr}=_r,Cr=Ar($r),xr=Ht(Nr),Rr=Lt(Cr*xr),qr=Lt(Pr*xr),Vr=(Ur=Vt.BASE.multiplyAndAddUnsafe(Tr,Rr,qr))==null?void 0:Ur.toAffine();return Vr?Lt(Vr.x)===Pr:!1}return{CURVE:At,getPublicKey:ir,getSharedSecret:yr,sign:pr,verify:dr,ProjectivePoint:Vt,Signature:nr,utils:ar}}class HMAC extends Hash{constructor(At,xt){super(),this.finished=!1,this.destroyed=!1,hash(At);const Bt=toBytes$1(xt);if(this.iHash=At.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const Nt=this.blockLen,jt=new Uint8Array(Nt);jt.set(Bt.length>Nt?At.create().update(Bt).digest():Bt);for(let Ut=0;Ut<jt.length;Ut++)jt[Ut]^=54;this.iHash.update(jt),this.oHash=At.create();for(let Ut=0;Ut<jt.length;Ut++)jt[Ut]^=106;this.oHash.update(jt),jt.fill(0)}update(At){return exists$1(this),this.iHash.update(At),this}digestInto(At){exists$1(this),bytes$1(At,this.outputLen),this.finished=!0,this.iHash.digestInto(At),this.oHash.update(At),this.oHash.digestInto(At),this.destroy()}digest(){const At=new Uint8Array(this.oHash.outputLen);return this.digestInto(At),At}_cloneInto(At){At||(At=Object.create(Object.getPrototypeOf(this),{}));const{oHash:xt,iHash:Bt,finished:Nt,destroyed:jt,blockLen:Ut,outputLen:Lt}=this;return At=At,At.finished=Nt,At.destroyed=jt,At.blockLen=Ut,At.outputLen=Lt,At.oHash=xt._cloneInto(At.oHash),At.iHash=Bt._cloneInto(At.iHash),At}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(kt,At,xt)=>new HMAC(kt,At).update(xt).digest();hmac.create=(kt,At)=>new HMAC(kt,At);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(kt){return{hash:kt,hmac:(At,...xt)=>hmac(kt,At,concatBytes$1(...xt)),randomBytes:randomBytes$2}}function createCurve(kt,At){const xt=Bt=>weierstrass({...kt,...getHash(Bt)});return Object.freeze({...xt(At),create:xt})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$3=BigInt(1),_2n$2=BigInt(2),divNearest=(kt,At)=>(kt+At/_2n$2)/At;function sqrtMod(kt){const At=secp256k1P,xt=BigInt(3),Bt=BigInt(6),Nt=BigInt(11),jt=BigInt(22),Ut=BigInt(23),Lt=BigInt(44),Ht=BigInt(88),Vt=kt*kt*kt%At,zt=Vt*Vt*kt%At,Wt=pow2(zt,xt,At)*zt%At,Jt=pow2(Wt,xt,At)*zt%At,Qt=pow2(Jt,_2n$2,At)*Vt%At,Xt=pow2(Qt,Nt,At)*Qt%At,tr=pow2(Xt,jt,At)*Xt%At,rr=pow2(tr,Lt,At)*tr%At,nr=pow2(rr,Ht,At)*rr%At,ar=pow2(nr,Lt,At)*tr%At,ir=pow2(ar,xt,At)*zt%At,lr=pow2(ir,Ut,At)*Xt%At,yr=pow2(lr,Bt,At)*Vt%At,Sr=pow2(yr,_2n$2,At);if(!Fp$2.eql(Fp$2.sqr(Sr),kt))throw new Error("Cannot find square root");return Sr}const Fp$2=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1=createCurve({a:BigInt(0),b:BigInt(7),Fp:Fp$2,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:kt=>{const At=secp256k1N,xt=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),Bt=-_1n$3*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),Nt=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),jt=xt,Ut=BigInt("0x100000000000000000000000000000000"),Lt=divNearest(jt*kt,At),Ht=divNearest(-Bt*kt,At);let Vt=mod(kt-Lt*xt-Ht*Nt,At),zt=mod(-Lt*Bt-Ht*jt,At);const Wt=Vt>Ut,Jt=zt>Ut;if(Wt&&(Vt=At-Vt),Jt&&(zt=At-zt),Vt>Ut||zt>Ut)throw new Error("splitScalar: Endomorphism failed, k="+kt);return{k1neg:Wt,k1:Vt,k2neg:Jt,k2:zt}}}},sha256);BigInt(0);secp256k1.ProjectivePoint;function canonicalize$5(kt){const At=Bt=>{if(Bt!==null&&typeof Bt=="object"&&!Array.isArray(Bt)){const Nt=Object.keys(Bt).sort(),jt={};for(const Ut of Nt)jt[Ut]=At(Bt[Ut]);return jt}return Bt},xt=At(kt);return JSON.stringify(xt)}var __awaiter$1V=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const KEY_URI_PREFIX_JWK$2="urn:jwk:";function computeJwkThumbprint$2(kt){return __awaiter$1V(this,arguments,void 0,function*({jwk:At}){const xt=At.kty;let Bt;if(xt==="EC")Bt={crv:At.crv,kty:At.kty,x:At.x,y:At.y};else if(xt==="oct")Bt={k:At.k,kty:At.kty};else if(xt==="OKP")Bt={crv:At.crv,kty:At.kty,x:At.x};else if(xt==="RSA")Bt={e:At.e,kty:At.kty,n:At.n};else throw new Error(`Unsupported key type: ${xt}`);removeUndefinedProperties$1(Bt);const Nt=canonicalize$5(Bt),jt=Convert$2.string(Nt).toUint8Array(),Ut=yield Sha256$2.digest({data:jt});return Convert$2.uint8Array(Ut).toBase64Url()})}function isEcPrivateJwk$2(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt&&"d"in kt)||kt.kty!=="EC"||typeof kt.d!="string"||typeof kt.x!="string")}function isEcPublicJwk$2(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt)||"d"in kt||kt.kty!=="EC"||typeof kt.x!="string")}function isOkpPrivateJwk$2(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt&&"d"in kt)||kt.kty!=="OKP"||typeof kt.d!="string"||typeof kt.x!="string")}function isOkpPublicJwk$2(kt){return!(!kt||typeof kt!="object"||"d"in kt||!("kty"in kt&&"crv"in kt&&"x"in kt)||kt.kty!=="OKP"||typeof kt.x!="string")}function isPrivateJwk$2(kt){if(!kt||typeof kt!="object")return!1;switch(kt.kty){case"EC":case"OKP":case"RSA":return"d"in kt;case"oct":return"k"in kt;default:return!1}}var __awaiter$1U=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$t=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Secp256k1$2=class Bi{static adjustSignatureToLowS(At){return __awaiter$1U(this,arguments,void 0,function*({signature:xt}){const Bt=secp256k1.Signature.fromCompact(xt);return Bt.hasHighS()?Bt.normalizeS().toCompactRawBytes():xt})}static bytesToPrivateKey(At){return __awaiter$1U(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=yield Bi.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"secp256k1",d:Convert$2.uint8Array(xt).toBase64Url(),x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1U(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt=yield Bi.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"secp256k1",x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}),Nt})}static compressPublicKey(At){return __awaiter$1U(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256k1.ProjectivePoint.fromHex(xt).toRawBytes(!0)})}static computePublicKey(At){return __awaiter$1U(this,arguments,void 0,function*({key:xt}){const Bt=yield Bi.privateKeyToBytes({privateKey:xt}),Nt=yield Bi.getCurvePoint({keyBytes:Bt}),jt={kty:"EC",crv:"secp256k1",x:Convert$2.uint8Array(Nt.x).toBase64Url(),y:Convert$2.uint8Array(Nt.y).toBase64Url()};return jt.kid=yield computeJwkThumbprint$2({jwk:jt}),jt})}static convertDerToCompactSignature(At){return __awaiter$1U(this,arguments,void 0,function*({derSignature:xt}){return secp256k1.Signature.fromDER(xt).toCompactRawBytes()})}static decompressPublicKey(At){return __awaiter$1U(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256k1.ProjectivePoint.fromHex(xt).toRawBytes(!1)})}static generateKey(){return __awaiter$1U(this,void 0,void 0,function*(){const At=secp256k1.utils.randomPrivateKey(),xt=yield Bi.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$2({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1U(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isEcPrivateJwk$2(xt)&&xt.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let Nt=__rest$t(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$2({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1U(this,arguments,void 0,function*({privateKey:xt}){if(!isEcPrivateJwk$2(xt))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1U(this,arguments,void 0,function*({publicKey:xt}){if(!(isEcPublicJwk$2(xt)&&xt.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const Bt=new Uint8Array([4]),Nt=Convert$2.base64Url(xt.x).toUint8Array(),jt=Convert$2.base64Url(xt.y).toUint8Array();return new Uint8Array([...Bt,...Nt,...jt])})}static sharedSecret(At){return __awaiter$1U(this,arguments,void 0,function*({privateKeyA:xt,publicKeyB:Bt}){if("x"in xt&&"x"in Bt&&xt.x===Bt.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Nt=yield Bi.privateKeyToBytes({privateKey:xt}),jt=yield Bi.publicKeyToBytes({publicKey:Bt});return secp256k1.getSharedSecret(Nt,jt,!0).slice(1)})}static sign(At){return __awaiter$1U(this,arguments,void 0,function*({data:xt,key:Bt}){const Nt=yield Bi.privateKeyToBytes({privateKey:Bt}),jt=sha256$5(xt);return secp256k1.sign(jt,Nt).toCompactRawBytes()})}static validatePrivateKey(At){return __awaiter$1U(this,arguments,void 0,function*({privateKeyBytes:xt}){return secp256k1.utils.isValidPrivateKey(xt)})}static validatePublicKey(At){return __awaiter$1U(this,arguments,void 0,function*({publicKeyBytes:xt}){try{secp256k1.ProjectivePoint.fromHex(xt).assertValidity()}catch{return!1}return!0})}static verify(At){return __awaiter$1U(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=yield Bi.publicKeyToBytes({publicKey:xt}),Ut=sha256$5(Nt);return secp256k1.verify(Bt,Ut,jt,{lowS:!1})})}static getCurvePoint(At){return __awaiter$1U(this,arguments,void 0,function*({keyBytes:xt}){xt.byteLength===32&&(xt=secp256k1.getPublicKey(xt));const Bt=secp256k1.ProjectivePoint.fromHex(xt),Nt=numberToBytesBE(Bt.x,32),jt=numberToBytesBE(Bt.y,32);return{x:Nt,y:jt}})}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fp$1=Field(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),CURVE_A=Fp$1.create(BigInt("-3")),CURVE_B=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),p256=createCurve({a:CURVE_A,b:CURVE_B,Fp:Fp$1,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},sha256),secp256r1=p256;var __awaiter$1T=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$s=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Secp256r1$2=class Mi{static adjustSignatureToLowS(At){return __awaiter$1T(this,arguments,void 0,function*({signature:xt}){const Bt=secp256r1.Signature.fromCompact(xt);return Bt.hasHighS()?Bt.normalizeS().toCompactRawBytes():xt})}static bytesToPrivateKey(At){return __awaiter$1T(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=yield Mi.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"P-256",d:Convert$2.uint8Array(xt).toBase64Url(),x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1T(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt=yield Mi.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"P-256",x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}),Nt})}static compressPublicKey(At){return __awaiter$1T(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256r1.ProjectivePoint.fromHex(xt).toRawBytes(!0)})}static computePublicKey(At){return __awaiter$1T(this,arguments,void 0,function*({key:xt}){const Bt=yield Mi.privateKeyToBytes({privateKey:xt}),Nt=yield Mi.getCurvePoint({keyBytes:Bt}),jt={kty:"EC",crv:"P-256",x:Convert$2.uint8Array(Nt.x).toBase64Url(),y:Convert$2.uint8Array(Nt.y).toBase64Url()};return jt.kid=yield computeJwkThumbprint$2({jwk:jt}),jt})}static convertDerToCompactSignature(At){return __awaiter$1T(this,arguments,void 0,function*({derSignature:xt}){return secp256r1.Signature.fromDER(xt).toCompactRawBytes()})}static decompressPublicKey(At){return __awaiter$1T(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256r1.ProjectivePoint.fromHex(xt).toRawBytes(!1)})}static generateKey(){return __awaiter$1T(this,void 0,void 0,function*(){const At=secp256r1.utils.randomPrivateKey(),xt=yield Mi.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$2({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1T(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isEcPrivateJwk$2(xt)&&xt.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let Nt=__rest$s(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$2({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1T(this,arguments,void 0,function*({privateKey:xt}){if(!isEcPrivateJwk$2(xt))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1T(this,arguments,void 0,function*({publicKey:xt}){if(!(isEcPublicJwk$2(xt)&&xt.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const Bt=new Uint8Array([4]),Nt=Convert$2.base64Url(xt.x).toUint8Array(),jt=Convert$2.base64Url(xt.y).toUint8Array();return new Uint8Array([...Bt,...Nt,...jt])})}static sharedSecret(At){return __awaiter$1T(this,arguments,void 0,function*({privateKeyA:xt,publicKeyB:Bt}){if("x"in xt&&"x"in Bt&&xt.x===Bt.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Nt=yield Mi.privateKeyToBytes({privateKey:xt}),jt=yield Mi.publicKeyToBytes({publicKey:Bt});return secp256r1.getSharedSecret(Nt,jt,!0).slice(1)})}static sign(At){return __awaiter$1T(this,arguments,void 0,function*({data:xt,key:Bt}){const Nt=yield Mi.privateKeyToBytes({privateKey:Bt}),jt=sha256$5(xt);return secp256r1.sign(jt,Nt).toCompactRawBytes()})}static validatePrivateKey(At){return __awaiter$1T(this,arguments,void 0,function*({privateKeyBytes:xt}){return secp256r1.utils.isValidPrivateKey(xt)})}static validatePublicKey(At){return __awaiter$1T(this,arguments,void 0,function*({publicKeyBytes:xt}){try{secp256r1.ProjectivePoint.fromHex(xt).assertValidity()}catch{return!1}return!0})}static verify(At){return __awaiter$1T(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=yield Mi.publicKeyToBytes({publicKey:xt}),Ut=sha256$5(Nt);return secp256r1.verify(Bt,Ut,jt,{lowS:!1})})}static getCurvePoint(At){return __awaiter$1T(this,arguments,void 0,function*({keyBytes:xt}){xt.byteLength===32&&(xt=secp256r1.getPublicKey(xt));const Bt=secp256r1.ProjectivePoint.fromHex(xt),Nt=numberToBytesBE(Bt.x,32),jt=numberToBytesBE(Bt.y,32);return{x:Nt,y:jt}})}};var __awaiter$1S=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let EcdsaAlgorithm$3=class extends CryptoAlgorithm$2{computePublicKey(At){return __awaiter$1S(this,arguments,void 0,function*({key:xt}){if(!isEcPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(xt.crv){case"secp256k1":{const Bt=yield Secp256k1$2.computePublicKey({key:xt});return Bt.alg="ES256K",Bt}case"P-256":{const Bt=yield Secp256r1$2.computePublicKey({key:xt});return Bt.alg="ES256",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}generateKey(At){return __awaiter$1S(this,arguments,void 0,function*({algorithm:xt}){switch(xt){case"ES256K":case"secp256k1":{const Bt=yield Secp256k1$2.generateKey();return Bt.alg="ES256K",Bt}case"ES256":case"secp256r1":{const Bt=yield Secp256r1$2.generateKey();return Bt.alg="ES256",Bt}}})}getPublicKey(At){return __awaiter$1S(this,arguments,void 0,function*({key:xt}){if(!isEcPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(xt.crv){case"secp256k1":{const Bt=yield Secp256k1$2.getPublicKey({key:xt});return Bt.alg="ES256K",Bt}case"P-256":{const Bt=yield Secp256r1$2.getPublicKey({key:xt});return Bt.alg="ES256",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}sign(At){return __awaiter$1S(this,arguments,void 0,function*({key:xt,data:Bt}){if(!isEcPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(xt.crv){case"secp256k1":return yield Secp256k1$2.sign({key:xt,data:Bt});case"P-256":return yield Secp256r1$2.sign({key:xt,data:Bt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}verify(At){return __awaiter$1S(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){if(!isEcPublicJwk$2(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(xt.crv){case"secp256k1":return yield Secp256k1$2.verify({key:xt,signature:Bt,data:Nt});case"P-256":return yield Secp256r1$2.verify({key:xt,signature:Bt,data:Nt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}};const U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(kt,At=!1){return At?{h:Number(kt&U32_MASK64),l:Number(kt>>_32n&U32_MASK64)}:{h:Number(kt>>_32n&U32_MASK64)|0,l:Number(kt&U32_MASK64)|0}}function split(kt,At=!1){let xt=new Uint32Array(kt.length),Bt=new Uint32Array(kt.length);for(let Nt=0;Nt<kt.length;Nt++){const{h:jt,l:Ut}=fromBig(kt[Nt],At);[xt[Nt],Bt[Nt]]=[jt,Ut]}return[xt,Bt]}const toBig=(kt,At)=>BigInt(kt>>>0)<<_32n|BigInt(At>>>0),shrSH=(kt,At,xt)=>kt>>>xt,shrSL=(kt,At,xt)=>kt<<32-xt|At>>>xt,rotrSH=(kt,At,xt)=>kt>>>xt|At<<32-xt,rotrSL=(kt,At,xt)=>kt<<32-xt|At>>>xt,rotrBH=(kt,At,xt)=>kt<<64-xt|At>>>xt-32,rotrBL=(kt,At,xt)=>kt>>>xt-32|At<<64-xt,rotr32H=(kt,At)=>At,rotr32L=(kt,At)=>kt,rotlSH=(kt,At,xt)=>kt<<xt|At>>>32-xt,rotlSL=(kt,At,xt)=>At<<xt|kt>>>32-xt,rotlBH=(kt,At,xt)=>At<<xt-32|kt>>>64-xt,rotlBL=(kt,At,xt)=>kt<<xt-32|At>>>64-xt;function add$1(kt,At,xt,Bt){const Nt=(At>>>0)+(Bt>>>0);return{h:kt+xt+(Nt/2**32|0)|0,l:Nt|0}}const add3L=(kt,At,xt)=>(kt>>>0)+(At>>>0)+(xt>>>0),add3H=(kt,At,xt,Bt)=>At+xt+Bt+(kt/2**32|0)|0,add4L=(kt,At,xt,Bt)=>(kt>>>0)+(At>>>0)+(xt>>>0)+(Bt>>>0),add4H=(kt,At,xt,Bt,Nt)=>At+xt+Bt+Nt+(kt/2**32|0)|0,add5L=(kt,At,xt,Bt,Nt)=>(kt>>>0)+(At>>>0)+(xt>>>0)+(Bt>>>0)+(Nt>>>0),add5H=(kt,At,xt,Bt,Nt,jt)=>At+xt+Bt+Nt+jt+(kt/2**32|0)|0,u64={fromBig,split,toBig,shrSH,shrSL,rotrSH,rotrSL,rotrBH,rotrBL,rotr32H,rotr32L,rotlSH,rotlSL,rotlBH,rotlBL,add:add$1,add3L,add3H,add4L,add4H,add5H,add5L},[SHA512_Kh,SHA512_Kl]=u64.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(kt=>BigInt(kt))),SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA512 extends SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:At,Al:xt,Bh:Bt,Bl:Nt,Ch:jt,Cl:Ut,Dh:Lt,Dl:Ht,Eh:Vt,El:zt,Fh:Wt,Fl:Jt,Gh:Qt,Gl:Xt,Hh:tr,Hl:rr}=this;return[At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr]}set(At,xt,Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr){this.Ah=At|0,this.Al=xt|0,this.Bh=Bt|0,this.Bl=Nt|0,this.Ch=jt|0,this.Cl=Ut|0,this.Dh=Lt|0,this.Dl=Ht|0,this.Eh=Vt|0,this.El=zt|0,this.Fh=Wt|0,this.Fl=Jt|0,this.Gh=Qt|0,this.Gl=Xt|0,this.Hh=tr|0,this.Hl=rr|0}process(At,xt){for(let ir=0;ir<16;ir++,xt+=4)SHA512_W_H[ir]=At.getUint32(xt),SHA512_W_L[ir]=At.getUint32(xt+=4);for(let ir=16;ir<80;ir++){const lr=SHA512_W_H[ir-15]|0,yr=SHA512_W_L[ir-15]|0,Sr=u64.rotrSH(lr,yr,1)^u64.rotrSH(lr,yr,8)^u64.shrSH(lr,yr,7),Ar=u64.rotrSL(lr,yr,1)^u64.rotrSL(lr,yr,8)^u64.shrSL(lr,yr,7),Dr=SHA512_W_H[ir-2]|0,Br=SHA512_W_L[ir-2]|0,Lr=u64.rotrSH(Dr,Br,19)^u64.rotrBH(Dr,Br,61)^u64.shrSH(Dr,Br,6),Or=u64.rotrSL(Dr,Br,19)^u64.rotrBL(Dr,Br,61)^u64.shrSL(Dr,Br,6),vr=u64.add4L(Ar,Or,SHA512_W_L[ir-7],SHA512_W_L[ir-16]),pr=u64.add4H(vr,Sr,Lr,SHA512_W_H[ir-7],SHA512_W_H[ir-16]);SHA512_W_H[ir]=pr|0,SHA512_W_L[ir]=vr|0}let{Ah:Bt,Al:Nt,Bh:jt,Bl:Ut,Ch:Lt,Cl:Ht,Dh:Vt,Dl:zt,Eh:Wt,El:Jt,Fh:Qt,Fl:Xt,Gh:tr,Gl:rr,Hh:nr,Hl:ar}=this;for(let ir=0;ir<80;ir++){const lr=u64.rotrSH(Wt,Jt,14)^u64.rotrSH(Wt,Jt,18)^u64.rotrBH(Wt,Jt,41),yr=u64.rotrSL(Wt,Jt,14)^u64.rotrSL(Wt,Jt,18)^u64.rotrBL(Wt,Jt,41),Sr=Wt&Qt^~Wt&tr,Ar=Jt&Xt^~Jt&rr,Dr=u64.add5L(ar,yr,Ar,SHA512_Kl[ir],SHA512_W_L[ir]),Br=u64.add5H(Dr,nr,lr,Sr,SHA512_Kh[ir],SHA512_W_H[ir]),Lr=Dr|0,Or=u64.rotrSH(Bt,Nt,28)^u64.rotrBH(Bt,Nt,34)^u64.rotrBH(Bt,Nt,39),vr=u64.rotrSL(Bt,Nt,28)^u64.rotrBL(Bt,Nt,34)^u64.rotrBL(Bt,Nt,39),pr=Bt&jt^Bt&Lt^jt&Lt,dr=Nt&Ut^Nt&Ht^Ut&Ht;nr=tr|0,ar=rr|0,tr=Qt|0,rr=Xt|0,Qt=Wt|0,Xt=Jt|0,{h:Wt,l:Jt}=u64.add(Vt|0,zt|0,Br|0,Lr|0),Vt=Lt|0,zt=Ht|0,Lt=jt|0,Ht=Ut|0,jt=Bt|0,Ut=Nt|0;const ur=u64.add3L(Lr,vr,dr);Bt=u64.add3H(ur,Br,Or,pr),Nt=ur|0}({h:Bt,l:Nt}=u64.add(this.Ah|0,this.Al|0,Bt|0,Nt|0)),{h:jt,l:Ut}=u64.add(this.Bh|0,this.Bl|0,jt|0,Ut|0),{h:Lt,l:Ht}=u64.add(this.Ch|0,this.Cl|0,Lt|0,Ht|0),{h:Vt,l:zt}=u64.add(this.Dh|0,this.Dl|0,Vt|0,zt|0),{h:Wt,l:Jt}=u64.add(this.Eh|0,this.El|0,Wt|0,Jt|0),{h:Qt,l:Xt}=u64.add(this.Fh|0,this.Fl|0,Qt|0,Xt|0),{h:tr,l:rr}=u64.add(this.Gh|0,this.Gl|0,tr|0,rr|0),{h:nr,l:ar}=u64.add(this.Hh|0,this.Hl|0,nr|0,ar|0),this.set(Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar)}roundClean(){SHA512_W_H.fill(0),SHA512_W_L.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sha512=wrapConstructor(()=>new SHA512);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$1=BigInt(0),_1n$2=BigInt(1),_2n$1=BigInt(2),_8n=BigInt(8),VERIFY_DEFAULT={zip215:!0};function validateOpts$1(kt){const At=validateBasic(kt);return validateObject(kt,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...At})}function twistedEdwards(kt){const At=validateOpts$1(kt),{Fp:xt,n:Bt,prehash:Nt,hash:jt,randomBytes:Ut,nByteLength:Lt,h:Ht}=At,Vt=_2n$1<<BigInt(Lt*8)-_1n$2,zt=xt.create,Wt=At.uvRatio||((Er,gr)=>{try{return{isValid:!0,value:xt.sqrt(Er*xt.inv(gr))}}catch{return{isValid:!1,value:_0n$1}}}),Jt=At.adjustScalarBytes||(Er=>Er),Qt=At.domain||((Er,gr,fr)=>{if(gr.length||fr)throw new Error("Contexts/pre-hash are not supported");return Er}),Xt=Er=>typeof Er=="bigint"&&_0n$1<Er,tr=(Er,gr)=>Xt(Er)&&Xt(gr)&&Er<gr,rr=Er=>Er===_0n$1||tr(Er,Vt);function nr(Er,gr){if(tr(Er,gr))return Er;throw new Error(`Expected valid scalar < ${gr}, got ${typeof Er} ${Er}`)}function ar(Er){return Er===_0n$1?Er:nr(Er,Bt)}const ir=new Map;function lr(Er){if(!(Er instanceof yr))throw new Error("ExtendedPoint expected")}class yr{constructor(gr,fr,br,_r){if(this.ex=gr,this.ey=fr,this.ez=br,this.et=_r,!rr(gr))throw new Error("x required");if(!rr(fr))throw new Error("y required");if(!rr(br))throw new Error("z required");if(!rr(_r))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(gr){if(gr instanceof yr)throw new Error("extended point not allowed");const{x:fr,y:br}=gr||{};if(!rr(fr)||!rr(br))throw new Error("invalid affine point");return new yr(fr,br,_1n$2,zt(fr*br))}static normalizeZ(gr){const fr=xt.invertBatch(gr.map(br=>br.ez));return gr.map((br,_r)=>br.toAffine(fr[_r])).map(yr.fromAffine)}_setWindowSize(gr){this._WINDOW_SIZE=gr,ir.delete(this)}assertValidity(){const{a:gr,d:fr}=At;if(this.is0())throw new Error("bad point: ZERO");const{ex:br,ey:_r,ez:Tr,et:Pr}=this,Nr=zt(br*br),Cr=zt(_r*_r),xr=zt(Tr*Tr),Rr=zt(xr*xr),qr=zt(Nr*gr),Vr=zt(xr*zt(qr+Cr)),Gr=zt(Rr+zt(fr*zt(Nr*Cr)));if(Vr!==Gr)throw new Error("bad point: equation left != right (1)");const Ur=zt(br*_r),kr=zt(Tr*Pr);if(Ur!==kr)throw new Error("bad point: equation left != right (2)")}equals(gr){lr(gr);const{ex:fr,ey:br,ez:_r}=this,{ex:Tr,ey:Pr,ez:Nr}=gr,Cr=zt(fr*Nr),xr=zt(Tr*_r),Rr=zt(br*Nr),qr=zt(Pr*_r);return Cr===xr&&Rr===qr}is0(){return this.equals(yr.ZERO)}negate(){return new yr(zt(-this.ex),this.ey,this.ez,zt(-this.et))}double(){const{a:gr}=At,{ex:fr,ey:br,ez:_r}=this,Tr=zt(fr*fr),Pr=zt(br*br),Nr=zt(_2n$1*zt(_r*_r)),Cr=zt(gr*Tr),xr=fr+br,Rr=zt(zt(xr*xr)-Tr-Pr),qr=Cr+Pr,Vr=qr-Nr,Gr=Cr-Pr,Ur=zt(Rr*Vr),kr=zt(qr*Gr),Fr=zt(Rr*Gr),Wr=zt(Vr*qr);return new yr(Ur,kr,Wr,Fr)}add(gr){lr(gr);const{a:fr,d:br}=At,{ex:_r,ey:Tr,ez:Pr,et:Nr}=this,{ex:Cr,ey:xr,ez:Rr,et:qr}=gr;if(fr===BigInt(-1)){const nn=zt((Tr-_r)*(xr+Cr)),fn=zt((Tr+_r)*(xr-Cr)),hn=zt(fn-nn);if(hn===_0n$1)return this.double();const Jr=zt(Pr*_2n$1*qr),Yr=zt(Nr*_2n$1*Rr),an=Yr+Jr,dn=fn+nn,cn=Yr-Jr,vn=zt(an*hn),_n=zt(dn*cn),Tn=zt(an*cn),$n=zt(hn*dn);return new yr(vn,_n,$n,Tn)}const Vr=zt(_r*Cr),Gr=zt(Tr*xr),Ur=zt(Nr*br*qr),kr=zt(Pr*Rr),Fr=zt((_r+Tr)*(Cr+xr)-Vr-Gr),Wr=kr-Ur,jr=kr+Ur,Ir=zt(Gr-fr*Vr),Mr=zt(Fr*Wr),Hr=zt(jr*Ir),Qr=zt(Fr*Ir),on=zt(Wr*jr);return new yr(Mr,Hr,on,Qr)}subtract(gr){return this.add(gr.negate())}wNAF(gr){return Dr.wNAFCached(this,ir,gr,yr.normalizeZ)}multiply(gr){const{p:fr,f:br}=this.wNAF(nr(gr,Bt));return yr.normalizeZ([fr,br])[0]}multiplyUnsafe(gr){let fr=ar(gr);return fr===_0n$1?Ar:this.equals(Ar)||fr===_1n$2?this:this.equals(Sr)?this.wNAF(fr).p:Dr.unsafeLadder(this,fr)}isSmallOrder(){return this.multiplyUnsafe(Ht).is0()}isTorsionFree(){return Dr.unsafeLadder(this,Bt).is0()}toAffine(gr){const{ex:fr,ey:br,ez:_r}=this,Tr=this.is0();gr==null&&(gr=Tr?_8n:xt.inv(_r));const Pr=zt(fr*gr),Nr=zt(br*gr),Cr=zt(_r*gr);if(Tr)return{x:_0n$1,y:_1n$2};if(Cr!==_1n$2)throw new Error("invZ was invalid");return{x:Pr,y:Nr}}clearCofactor(){const{h:gr}=At;return gr===_1n$2?this:this.multiplyUnsafe(gr)}static fromHex(gr,fr=!1){const{d:br,a:_r}=At,Tr=xt.BYTES;gr=ensureBytes$2("pointHex",gr,Tr);const Pr=gr.slice(),Nr=gr[Tr-1];Pr[Tr-1]=Nr&-129;const Cr=bytesToNumberLE(Pr);Cr===_0n$1||(fr?nr(Cr,Vt):nr(Cr,xt.ORDER));const xr=zt(Cr*Cr),Rr=zt(xr-_1n$2),qr=zt(br*xr-_r);let{isValid:Vr,value:Gr}=Wt(Rr,qr);if(!Vr)throw new Error("Point.fromHex: invalid y coordinate");const Ur=(Gr&_1n$2)===_1n$2,kr=(Nr&128)!==0;if(!fr&&Gr===_0n$1&&kr)throw new Error("Point.fromHex: x=0 and x_0=1");return kr!==Ur&&(Gr=zt(-Gr)),yr.fromAffine({x:Gr,y:Cr})}static fromPrivateKey(gr){return Or(gr).point}toRawBytes(){const{x:gr,y:fr}=this.toAffine(),br=numberToBytesLE(fr,xt.BYTES);return br[br.length-1]|=gr&_1n$2?128:0,br}toHex(){return bytesToHex(this.toRawBytes())}}yr.BASE=new yr(At.Gx,At.Gy,_1n$2,zt(At.Gx*At.Gy)),yr.ZERO=new yr(_0n$1,_1n$2,_1n$2,_0n$1);const{BASE:Sr,ZERO:Ar}=yr,Dr=wNAF(yr,Lt*8);function Br(Er){return mod(Er,Bt)}function Lr(Er){return Br(bytesToNumberLE(Er))}function Or(Er){const gr=Lt;Er=ensureBytes$2("private key",Er,gr);const fr=ensureBytes$2("hashed private key",jt(Er),2*gr),br=Jt(fr.slice(0,gr)),_r=fr.slice(gr,2*gr),Tr=Lr(br),Pr=Sr.multiply(Tr),Nr=Pr.toRawBytes();return{head:br,prefix:_r,scalar:Tr,point:Pr,pointBytes:Nr}}function vr(Er){return Or(Er).pointBytes}function pr(Er=new Uint8Array,...gr){const fr=concatBytes(...gr);return Lr(jt(Qt(fr,ensureBytes$2("context",Er),!!Nt)))}function dr(Er,gr,fr={}){Er=ensureBytes$2("message",Er),Nt&&(Er=Nt(Er));const{prefix:br,scalar:_r,pointBytes:Tr}=Or(gr),Pr=pr(fr.context,br,Er),Nr=Sr.multiply(Pr).toRawBytes(),Cr=pr(fr.context,Nr,Tr,Er),xr=Br(Pr+Cr*_r);ar(xr);const Rr=concatBytes(Nr,numberToBytesLE(xr,xt.BYTES));return ensureBytes$2("result",Rr,Lt*2)}const ur=VERIFY_DEFAULT;function $r(Er,gr,fr,br=ur){const{context:_r,zip215:Tr}=br,Pr=xt.BYTES;Er=ensureBytes$2("signature",Er,2*Pr),gr=ensureBytes$2("message",gr),Nt&&(gr=Nt(gr));const Nr=bytesToNumberLE(Er.slice(Pr,2*Pr));let Cr,xr,Rr;try{Cr=yr.fromHex(fr,Tr),xr=yr.fromHex(Er.slice(0,Pr),Tr),Rr=Sr.multiplyUnsafe(Nr)}catch{return!1}if(!Tr&&Cr.isSmallOrder())return!1;const qr=pr(_r,xr.toRawBytes(),Cr.toRawBytes(),gr);return xr.add(Cr.multiplyUnsafe(qr)).subtract(Rr).clearCofactor().equals(yr.ZERO)}return Sr._setWindowSize(8),{CURVE:At,getPublicKey:vr,sign:dr,verify:$r,ExtendedPoint:yr,utils:{getExtendedPublicKey:Or,randomPrivateKey:()=>Ut(xt.BYTES),precompute(Er=8,gr=yr.BASE){return gr._setWindowSize(Er),gr.multiply(BigInt(3)),gr}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n=BigInt(0),_1n$1=BigInt(1);function validateOpts(kt){return validateObject(kt,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...kt})}function montgomery(kt){const At=validateOpts(kt),{P:xt}=At,Bt=ir=>mod(ir,xt),Nt=At.montgomeryBits,jt=Math.ceil(Nt/8),Ut=At.nByteLength,Lt=At.adjustScalarBytes||(ir=>ir),Ht=At.powPminus2||(ir=>pow(ir,xt-BigInt(2),xt));function Vt(ir,lr,yr){const Sr=Bt(ir*(lr-yr));return lr=Bt(lr-Sr),yr=Bt(yr+Sr),[lr,yr]}function zt(ir){if(typeof ir=="bigint"&&_0n<=ir&&ir<xt)return ir;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const Wt=(At.a-BigInt(2))/BigInt(4);function Jt(ir,lr){const yr=zt(ir),Sr=zt(lr),Ar=yr;let Dr=_1n$1,Br=_0n,Lr=yr,Or=_1n$1,vr=_0n,pr;for(let ur=BigInt(Nt-1);ur>=_0n;ur--){const $r=Sr>>ur&_1n$1;vr^=$r,pr=Vt(vr,Dr,Lr),Dr=pr[0],Lr=pr[1],pr=Vt(vr,Br,Or),Br=pr[0],Or=pr[1],vr=$r;const wr=Dr+Br,Er=Bt(wr*wr),gr=Dr-Br,fr=Bt(gr*gr),br=Er-fr,_r=Lr+Or,Tr=Lr-Or,Pr=Bt(Tr*wr),Nr=Bt(_r*gr),Cr=Pr+Nr,xr=Pr-Nr;Lr=Bt(Cr*Cr),Or=Bt(Ar*Bt(xr*xr)),Dr=Bt(Er*fr),Br=Bt(br*(Er+Bt(Wt*br)))}pr=Vt(vr,Dr,Lr),Dr=pr[0],Lr=pr[1],pr=Vt(vr,Br,Or),Br=pr[0],Or=pr[1];const dr=Ht(Br);return Bt(Dr*dr)}function Qt(ir){return numberToBytesLE(Bt(ir),jt)}function Xt(ir){const lr=ensureBytes$2("u coordinate",ir,jt);return Ut===32&&(lr[31]&=127),bytesToNumberLE(lr)}function tr(ir){const lr=ensureBytes$2("scalar",ir),yr=lr.length;if(yr!==jt&&yr!==Ut)throw new Error(`Expected ${jt} or ${Ut} bytes, got ${yr}`);return bytesToNumberLE(Lt(lr))}function rr(ir,lr){const yr=Xt(lr),Sr=tr(ir),Ar=Jt(yr,Sr);if(Ar===_0n)throw new Error("Invalid private or public key received");return Qt(Ar)}const nr=Qt(At.Gu);function ar(ir){return rr(ir,nr)}return{scalarMult:rr,scalarMultBase:ar,getSharedSecret:(ir,lr)=>rr(ir,lr),getPublicKey:ir=>ar(ir),utils:{randomPrivateKey:()=>At.randomBytes(At.nByteLength)},GuBytes:nr}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ED25519_P=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ED25519_SQRT_M1=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const _1n=BigInt(1),_2n=BigInt(2),_5n=BigInt(5),_10n=BigInt(10),_20n=BigInt(20),_40n=BigInt(40),_80n=BigInt(80);function ed25519_pow_2_252_3(kt){const At=ED25519_P,Bt=kt*kt%At*kt%At,Nt=pow2(Bt,_2n,At)*Bt%At,jt=pow2(Nt,_1n,At)*kt%At,Ut=pow2(jt,_5n,At)*jt%At,Lt=pow2(Ut,_10n,At)*Ut%At,Ht=pow2(Lt,_20n,At)*Lt%At,Vt=pow2(Ht,_40n,At)*Ht%At,zt=pow2(Vt,_80n,At)*Vt%At,Wt=pow2(zt,_80n,At)*Vt%At,Jt=pow2(Wt,_10n,At)*Ut%At;return{pow_p_5_8:pow2(Jt,_2n,At)*kt%At,b2:Bt}}function adjustScalarBytes(kt){return kt[0]&=248,kt[31]&=127,kt[31]|=64,kt}function uvRatio(kt,At){const xt=ED25519_P,Bt=mod(At*At*At,xt),Nt=mod(Bt*Bt*At,xt),jt=ed25519_pow_2_252_3(kt*Nt).pow_p_5_8;let Ut=mod(kt*Bt*jt,xt);const Lt=mod(At*Ut*Ut,xt),Ht=Ut,Vt=mod(Ut*ED25519_SQRT_M1,xt),zt=Lt===kt,Wt=Lt===mod(-kt,xt),Jt=Lt===mod(-kt*ED25519_SQRT_M1,xt);return zt&&(Ut=Ht),(Wt||Jt)&&(Ut=Vt),isNegativeLE(Ut,xt)&&(Ut=mod(-Ut,xt)),{isValid:zt||Wt,value:Ut}}const Fp=Field(ED25519_P,void 0,!0),ed25519Defaults={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:sha512,randomBytes:randomBytes$2,adjustScalarBytes,uvRatio},ed25519=twistedEdwards(ed25519Defaults);function ed25519_domain(kt,At,xt){if(At.length>255)throw new Error("Context is too big");return concatBytes$1(utf8ToBytes$2("SigEd25519 no Ed25519 collisions"),new Uint8Array([xt?1:0,At.length]),At,kt)}({...ed25519Defaults});({...ed25519Defaults});const x25519=montgomery({P:ED25519_P,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:kt=>{const At=ED25519_P,{pow_p_5_8:xt,b2:Bt}=ed25519_pow_2_252_3(kt);return mod(pow2(xt,BigInt(3),At)*Bt,At)},adjustScalarBytes,randomBytes:randomBytes$2});function edwardsToMontgomeryPub(kt){const{y:At}=ed25519.ExtendedPoint.fromHex(kt),xt=BigInt(1);return Fp.toBytes(Fp.create((xt+At)*Fp.inv(xt-At)))}function edwardsToMontgomeryPriv(kt){const At=ed25519Defaults.hash(kt.subarray(0,32));return ed25519Defaults.adjustScalarBytes(At).subarray(0,32)}const ELL2_C1=(Fp.ORDER+BigInt(3))/BigInt(8);Fp.pow(_2n,ELL2_C1);Fp.sqrt(Fp.neg(Fp.ONE));(Fp.ORDER-BigInt(5))/BigInt(8);BigInt(486662);FpSqrtEven(Fp,Fp.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var __awaiter$1R=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$r=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Ed25519$2=class Yi{static bytesToPrivateKey(At){return __awaiter$1R(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=ed25519.getPublicKey(xt),Nt={crv:"Ed25519",d:Convert$2.uint8Array(xt).toBase64Url(),kty:"OKP",x:Convert$2.uint8Array(Bt).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1R(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt={kty:"OKP",crv:"Ed25519",x:Convert$2.uint8Array(xt).toBase64Url()};return Bt.kid=yield computeJwkThumbprint$2({jwk:Bt}),Bt})}static computePublicKey(At){return __awaiter$1R(this,arguments,void 0,function*({key:xt}){const Bt=yield Yi.privateKeyToBytes({privateKey:xt}),Nt=ed25519.getPublicKey(Bt),jt={kty:"OKP",crv:"Ed25519",x:Convert$2.uint8Array(Nt).toBase64Url()};return jt.kid=yield computeJwkThumbprint$2({jwk:jt}),jt})}static convertPrivateKeyToX25519(At){return __awaiter$1R(this,arguments,void 0,function*({privateKey:xt}){const Bt=yield Yi.privateKeyToBytes({privateKey:xt}),Nt=edwardsToMontgomeryPriv(Bt),jt=x25519.getPublicKey(Nt),Ut={kty:"OKP",crv:"X25519",d:Convert$2.uint8Array(Nt).toBase64Url(),x:Convert$2.uint8Array(jt).toBase64Url()};return Ut.kid=yield computeJwkThumbprint$2({jwk:Ut}),Ut})}static convertPublicKeyToX25519(At){return __awaiter$1R(this,arguments,void 0,function*({publicKey:xt}){const Bt=yield Yi.publicKeyToBytes({publicKey:xt});if(!(yield Yi.validatePublicKey({publicKeyBytes:Bt})))throw new Error("Ed25519: Invalid public key.");const jt=edwardsToMontgomeryPub(Bt),Ut={kty:"OKP",crv:"X25519",x:Convert$2.uint8Array(jt).toBase64Url()};return Ut.kid=yield computeJwkThumbprint$2({jwk:Ut}),Ut})}static generateKey(){return __awaiter$1R(this,void 0,void 0,function*(){const At=ed25519.utils.randomPrivateKey(),xt=yield Yi.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$2({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1R(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isOkpPrivateJwk$2(xt)&&xt.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let Nt=__rest$r(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$2({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1R(this,arguments,void 0,function*({privateKey:xt}){if(!isOkpPrivateJwk$2(xt))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1R(this,arguments,void 0,function*({publicKey:xt}){if(!isOkpPublicJwk$2(xt))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Convert$2.base64Url(xt.x).toUint8Array()})}static sign(At){return __awaiter$1R(this,arguments,void 0,function*({key:xt,data:Bt}){const Nt=yield Yi.privateKeyToBytes({privateKey:xt});return ed25519.sign(Bt,Nt)})}static validatePublicKey(At){return __awaiter$1R(this,arguments,void 0,function*({publicKeyBytes:xt}){try{ed25519.ExtendedPoint.fromHex(xt).assertValidity()}catch{return!1}return!0})}static verify(At){return __awaiter$1R(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=yield Yi.publicKeyToBytes({publicKey:xt});return ed25519.verify(Bt,Nt,jt)})}};var __awaiter$1Q=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let EdDsaAlgorithm$3=class extends CryptoAlgorithm$2{computePublicKey(At){return __awaiter$1Q(this,arguments,void 0,function*({key:xt}){if(!isOkpPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(xt.crv){case"Ed25519":{const Bt=yield Ed25519$2.computePublicKey({key:xt});return Bt.alg="EdDSA",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}generateKey(At){return __awaiter$1Q(this,arguments,void 0,function*({algorithm:xt}){switch(xt){case"Ed25519":{const Bt=yield Ed25519$2.generateKey();return Bt.alg="EdDSA",Bt}}})}getPublicKey(At){return __awaiter$1Q(this,arguments,void 0,function*({key:xt}){if(!isOkpPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(xt.crv){case"Ed25519":{const Bt=yield Ed25519$2.getPublicKey({key:xt});return Bt.alg="EdDSA",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}sign(At){return __awaiter$1Q(this,arguments,void 0,function*({key:xt,data:Bt}){if(!isOkpPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(xt.crv){case"Ed25519":return yield Ed25519$2.sign({key:xt,data:Bt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}verify(At){return __awaiter$1Q(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){if(!isOkpPublicJwk$2(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(xt.crv){case"Ed25519":return yield Ed25519$2.verify({key:xt,signature:Bt,data:Nt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}};var __awaiter$1P=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const supportedAlgorithms$4={Ed25519:{implementation:EdDsaAlgorithm$3,names:["Ed25519"]},secp256k1:{implementation:EcdsaAlgorithm$3,names:["ES256K","secp256k1"]},secp256r1:{implementation:EcdsaAlgorithm$3,names:["ES256","secp256r1"]},"SHA-256":{implementation:Sha2Algorithm$2,names:["SHA-256"]}};let LocalKeyManager$3=class{constructor(At){var xt;this._algorithmInstances=new Map,this._keyStore=(xt=At==null?void 0:At.keyStore)!==null&&xt!==void 0?xt:new MemoryStore$1}digest(At){return __awaiter$1P(this,arguments,void 0,function*({algorithm:xt,data:Bt}){return yield this.getAlgorithm({algorithm:xt}).digest({algorithm:xt,data:Bt})})}exportKey(At){return __awaiter$1P(this,arguments,void 0,function*({keyUri:xt}){return yield this.getPrivateKey({keyUri:xt})})}generateKey(At){return __awaiter$1P(this,arguments,void 0,function*({algorithm:xt}){const Nt=yield this.getAlgorithm({algorithm:xt}).generateKey({algorithm:xt});if((Nt==null?void 0:Nt.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const jt=`${KEY_URI_PREFIX_JWK$2}${Nt.kid}`;return yield this._keyStore.set(jt,Nt),jt})}getKeyUri(At){return __awaiter$1P(this,arguments,void 0,function*({key:xt}){const Bt=yield computeJwkThumbprint$2({jwk:xt});return`${KEY_URI_PREFIX_JWK$2}${Bt}`})}getPublicKey(At){return __awaiter$1P(this,arguments,void 0,function*({keyUri:xt}){const Bt=yield this.getPrivateKey({keyUri:xt}),Nt=this.getAlgorithmName({key:Bt});return yield this.getAlgorithm({algorithm:Nt}).getPublicKey({key:Bt})})}importKey(At){return __awaiter$1P(this,arguments,void 0,function*({key:xt}){var Bt;if(!isPrivateJwk$2(xt))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const Nt=structuredClone(xt);(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}));const jt=yield this.getKeyUri({key:Nt});return yield this._keyStore.set(jt,Nt),jt})}sign(At){return __awaiter$1P(this,arguments,void 0,function*({keyUri:xt,data:Bt}){const Nt=yield this.getPrivateKey({keyUri:xt}),jt=this.getAlgorithmName({key:Nt});return this.getAlgorithm({algorithm:jt}).sign({data:Bt,key:Nt})})}verify(At){return __awaiter$1P(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=this.getAlgorithmName({key:xt});return this.getAlgorithm({algorithm:jt}).verify({key:xt,signature:Bt,data:Nt})})}getAlgorithm({algorithm:At}){var xt;const Bt=(xt=supportedAlgorithms$4[At])===null||xt===void 0?void 0:xt.implementation;if(!Bt)throw new Error(`Algorithm not supported: ${At}`);return this._algorithmInstances.has(Bt)||this._algorithmInstances.set(Bt,new Bt),this._algorithmInstances.get(Bt)}getAlgorithmName({key:At}){const xt=At.alg,Bt=At.crv;for(const Nt in supportedAlgorithms$4){const jt=supportedAlgorithms$4[Nt];if(xt&&jt.names.includes(xt))return Nt;if(Bt&&jt.names.includes(Bt))return Nt}throw new Error(`Unable to determine algorithm based on provided input: alg=${xt}, crv=${Bt}`)}getPrivateKey(At){return __awaiter$1P(this,arguments,void 0,function*({keyUri:xt}){const Bt=yield this._keyStore.get(xt);if(!Bt)throw new Error(`Key not found: ${xt}`);return Bt})}};function getJoseSignatureAlgorithmFromPublicKey$3(kt){const At={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(kt.alg&&Object.values(At).includes(kt.alg))return kt.alg;if(kt.crv&&Object.keys(At).includes(kt.crv))return At[kt.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${kt.alg}, crv=${kt.crv}. Supported 'alg' values: ${Object.values(At).join(", ")}. Supported 'crv' values: ${Object.keys(At).join(", ")}.`)}var __awaiter$1O=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$q=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let X25519$2=class $o{static bytesToPrivateKey(At){return __awaiter$1O(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=x25519.getPublicKey(xt),Nt={kty:"OKP",crv:"X25519",d:Convert$2.uint8Array(xt).toBase64Url(),x:Convert$2.uint8Array(Bt).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$2({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1O(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt={kty:"OKP",crv:"X25519",x:Convert$2.uint8Array(xt).toBase64Url()};return Bt.kid=yield computeJwkThumbprint$2({jwk:Bt}),Bt})}static computePublicKey(At){return __awaiter$1O(this,arguments,void 0,function*({key:xt}){const Bt=yield $o.privateKeyToBytes({privateKey:xt}),Nt=x25519.getPublicKey(Bt),jt={kty:"OKP",crv:"X25519",x:Convert$2.uint8Array(Nt).toBase64Url()};return jt.kid=yield computeJwkThumbprint$2({jwk:jt}),jt})}static generateKey(){return __awaiter$1O(this,void 0,void 0,function*(){const At=x25519.utils.randomPrivateKey(),xt=yield $o.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$2({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1O(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isOkpPrivateJwk$2(xt)&&xt.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let Nt=__rest$q(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$2({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1O(this,arguments,void 0,function*({privateKey:xt}){if(!isOkpPrivateJwk$2(xt))throw new Error("X25519: The provided key is not a valid OKP private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1O(this,arguments,void 0,function*({publicKey:xt}){if(!isOkpPublicJwk$2(xt))throw new Error("X25519: The provided key is not a valid OKP public key.");return Convert$2.base64Url(xt.x).toUint8Array()})}static sharedSecret(At){return __awaiter$1O(this,arguments,void 0,function*({privateKeyA:xt,publicKeyB:Bt}){if("x"in xt&&"x"in Bt&&xt.x===Bt.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Nt=yield $o.privateKeyToBytes({privateKey:xt}),jt=yield $o.publicKeyToBytes({publicKey:Bt});return x25519.getSharedSecret(Nt,jt)})}};const u8to16$1=(kt,At)=>kt[At++]&255|(kt[At++]&255)<<8;let Poly1305$1=class{constructor(At){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,At=toBytes$2(At),bytes$2(At,32);const xt=u8to16$1(At,0),Bt=u8to16$1(At,2),Nt=u8to16$1(At,4),jt=u8to16$1(At,6),Ut=u8to16$1(At,8),Lt=u8to16$1(At,10),Ht=u8to16$1(At,12),Vt=u8to16$1(At,14);this.r[0]=xt&8191,this.r[1]=(xt>>>13|Bt<<3)&8191,this.r[2]=(Bt>>>10|Nt<<6)&7939,this.r[3]=(Nt>>>7|jt<<9)&8191,this.r[4]=(jt>>>4|Ut<<12)&255,this.r[5]=Ut>>>1&8190,this.r[6]=(Ut>>>14|Lt<<2)&8191,this.r[7]=(Lt>>>11|Ht<<5)&8065,this.r[8]=(Ht>>>8|Vt<<8)&8191,this.r[9]=Vt>>>5&127;for(let zt=0;zt<8;zt++)this.pad[zt]=u8to16$1(At,16+2*zt)}process(At,xt,Bt=!1){const Nt=Bt?0:2048,{h:jt,r:Ut}=this,Lt=Ut[0],Ht=Ut[1],Vt=Ut[2],zt=Ut[3],Wt=Ut[4],Jt=Ut[5],Qt=Ut[6],Xt=Ut[7],tr=Ut[8],rr=Ut[9],nr=u8to16$1(At,xt+0),ar=u8to16$1(At,xt+2),ir=u8to16$1(At,xt+4),lr=u8to16$1(At,xt+6),yr=u8to16$1(At,xt+8),Sr=u8to16$1(At,xt+10),Ar=u8to16$1(At,xt+12),Dr=u8to16$1(At,xt+14);let Br=jt[0]+(nr&8191),Lr=jt[1]+((nr>>>13|ar<<3)&8191),Or=jt[2]+((ar>>>10|ir<<6)&8191),vr=jt[3]+((ir>>>7|lr<<9)&8191),pr=jt[4]+((lr>>>4|yr<<12)&8191),dr=jt[5]+(yr>>>1&8191),ur=jt[6]+((yr>>>14|Sr<<2)&8191),$r=jt[7]+((Sr>>>11|Ar<<5)&8191),wr=jt[8]+((Ar>>>8|Dr<<8)&8191),Er=jt[9]+(Dr>>>5|Nt),gr=0,fr=gr+Br*Lt+Lr*(5*rr)+Or*(5*tr)+vr*(5*Xt)+pr*(5*Qt);gr=fr>>>13,fr&=8191,fr+=dr*(5*Jt)+ur*(5*Wt)+$r*(5*zt)+wr*(5*Vt)+Er*(5*Ht),gr+=fr>>>13,fr&=8191;let br=gr+Br*Ht+Lr*Lt+Or*(5*rr)+vr*(5*tr)+pr*(5*Xt);gr=br>>>13,br&=8191,br+=dr*(5*Qt)+ur*(5*Jt)+$r*(5*Wt)+wr*(5*zt)+Er*(5*Vt),gr+=br>>>13,br&=8191;let _r=gr+Br*Vt+Lr*Ht+Or*Lt+vr*(5*rr)+pr*(5*tr);gr=_r>>>13,_r&=8191,_r+=dr*(5*Xt)+ur*(5*Qt)+$r*(5*Jt)+wr*(5*Wt)+Er*(5*zt),gr+=_r>>>13,_r&=8191;let Tr=gr+Br*zt+Lr*Vt+Or*Ht+vr*Lt+pr*(5*rr);gr=Tr>>>13,Tr&=8191,Tr+=dr*(5*tr)+ur*(5*Xt)+$r*(5*Qt)+wr*(5*Jt)+Er*(5*Wt),gr+=Tr>>>13,Tr&=8191;let Pr=gr+Br*Wt+Lr*zt+Or*Vt+vr*Ht+pr*Lt;gr=Pr>>>13,Pr&=8191,Pr+=dr*(5*rr)+ur*(5*tr)+$r*(5*Xt)+wr*(5*Qt)+Er*(5*Jt),gr+=Pr>>>13,Pr&=8191;let Nr=gr+Br*Jt+Lr*Wt+Or*zt+vr*Vt+pr*Ht;gr=Nr>>>13,Nr&=8191,Nr+=dr*Lt+ur*(5*rr)+$r*(5*tr)+wr*(5*Xt)+Er*(5*Qt),gr+=Nr>>>13,Nr&=8191;let Cr=gr+Br*Qt+Lr*Jt+Or*Wt+vr*zt+pr*Vt;gr=Cr>>>13,Cr&=8191,Cr+=dr*Ht+ur*Lt+$r*(5*rr)+wr*(5*tr)+Er*(5*Xt),gr+=Cr>>>13,Cr&=8191;let xr=gr+Br*Xt+Lr*Qt+Or*Jt+vr*Wt+pr*zt;gr=xr>>>13,xr&=8191,xr+=dr*Vt+ur*Ht+$r*Lt+wr*(5*rr)+Er*(5*tr),gr+=xr>>>13,xr&=8191;let Rr=gr+Br*tr+Lr*Xt+Or*Qt+vr*Jt+pr*Wt;gr=Rr>>>13,Rr&=8191,Rr+=dr*zt+ur*Vt+$r*Ht+wr*Lt+Er*(5*rr),gr+=Rr>>>13,Rr&=8191;let qr=gr+Br*rr+Lr*tr+Or*Xt+vr*Qt+pr*Jt;gr=qr>>>13,qr&=8191,qr+=dr*Wt+ur*zt+$r*Vt+wr*Ht+Er*Lt,gr+=qr>>>13,qr&=8191,gr=(gr<<2)+gr|0,gr=gr+fr|0,fr=gr&8191,gr=gr>>>13,br+=gr,jt[0]=fr,jt[1]=br,jt[2]=_r,jt[3]=Tr,jt[4]=Pr,jt[5]=Nr,jt[6]=Cr,jt[7]=xr,jt[8]=Rr,jt[9]=qr}finalize(){const{h:At,pad:xt}=this,Bt=new Uint16Array(10);let Nt=At[1]>>>13;At[1]&=8191;for(let Lt=2;Lt<10;Lt++)At[Lt]+=Nt,Nt=At[Lt]>>>13,At[Lt]&=8191;At[0]+=Nt*5,Nt=At[0]>>>13,At[0]&=8191,At[1]+=Nt,Nt=At[1]>>>13,At[1]&=8191,At[2]+=Nt,Bt[0]=At[0]+5,Nt=Bt[0]>>>13,Bt[0]&=8191;for(let Lt=1;Lt<10;Lt++)Bt[Lt]=At[Lt]+Nt,Nt=Bt[Lt]>>>13,Bt[Lt]&=8191;Bt[9]-=8192;let jt=(Nt^1)-1;for(let Lt=0;Lt<10;Lt++)Bt[Lt]&=jt;jt=~jt;for(let Lt=0;Lt<10;Lt++)At[Lt]=At[Lt]&jt|Bt[Lt];At[0]=(At[0]|At[1]<<13)&65535,At[1]=(At[1]>>>3|At[2]<<10)&65535,At[2]=(At[2]>>>6|At[3]<<7)&65535,At[3]=(At[3]>>>9|At[4]<<4)&65535,At[4]=(At[4]>>>12|At[5]<<1|At[6]<<14)&65535,At[5]=(At[6]>>>2|At[7]<<11)&65535,At[6]=(At[7]>>>5|At[8]<<8)&65535,At[7]=(At[8]>>>8|At[9]<<5)&65535;let Ut=At[0]+xt[0];At[0]=Ut&65535;for(let Lt=1;Lt<8;Lt++)Ut=(At[Lt]+xt[Lt]|0)+(Ut>>>16)|0,At[Lt]=Ut&65535}update(At){exists$2(this);const{buffer:xt,blockLen:Bt}=this;At=toBytes$2(At);const Nt=At.length;for(let jt=0;jt<Nt;){const Ut=Math.min(Bt-this.pos,Nt-jt);if(Ut===Bt){for(;Bt<=Nt-jt;jt+=Bt)this.process(At,jt);continue}xt.set(At.subarray(jt,jt+Ut),this.pos),this.pos+=Ut,jt+=Ut,this.pos===Bt&&(this.process(xt,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(At){exists$2(this),output$2(At,this),this.finished=!0;const{buffer:xt,h:Bt}=this;let{pos:Nt}=this;if(Nt){for(xt[Nt++]=1;Nt<16;Nt++)xt[Nt]=0;this.process(xt,0,!0)}this.finalize();let jt=0;for(let Ut=0;Ut<8;Ut++)At[jt++]=Bt[Ut]>>>0,At[jt++]=Bt[Ut]>>>8;return At}digest(){const{buffer:At,outputLen:xt}=this;this.digestInto(At);const Bt=At.slice(0,xt);return this.destroy(),Bt}};function wrapConstructorWithKey$1(kt){const At=(Bt,Nt)=>kt(Nt).update(toBytes$2(Bt)).digest(),xt=kt(new Uint8Array(32));return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=Bt=>kt(Bt),At}const poly1305=wrapConstructorWithKey$1(kt=>new Poly1305$1(kt)),_utf8ToBytes=kt=>Uint8Array.from(kt.split("").map(At=>At.charCodeAt(0))),sigma16$1=_utf8ToBytes("expand 16-byte k"),sigma32$1=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32$1(sigma16$1),sigma32_32=u32$1(sigma32$1);sigma32_32.slice();function rotl$1(kt,At){return kt<<At|kt>>>32-At}function isAligned32(kt){return kt.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(kt,At,xt,Bt,Nt,jt,Ut,Lt){const Ht=Nt.length,Vt=new Uint8Array(BLOCK_LEN),zt=u32$1(Vt),Wt=isAligned32(Nt)&&isAligned32(jt),Jt=Wt?u32$1(Nt):U32_EMPTY,Qt=Wt?u32$1(jt):U32_EMPTY;for(let Xt=0;Xt<Ht;Ut++){if(kt(At,xt,Bt,zt,Ut,Lt),Ut>=MAX_COUNTER)throw new Error("arx: counter overflow");const tr=Math.min(BLOCK_LEN,Ht-Xt);if(Wt&&tr===BLOCK_LEN){const rr=Xt/4;if(Xt%4!==0)throw new Error("arx: invalid block position");for(let nr=0,ar;nr<BLOCK_LEN32;nr++)ar=rr+nr,Qt[ar]=Jt[ar]^zt[nr];Xt+=BLOCK_LEN;continue}for(let rr=0,nr;rr<tr;rr++)nr=Xt+rr,jt[nr]=Nt[nr]^Vt[rr];Xt+=tr}}function createCipher(kt,At){const{allowShortKeys:xt,extendNonceFn:Bt,counterLength:Nt,counterRight:jt,rounds:Ut}=checkOpts$1({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},At);if(typeof kt!="function")throw new Error("core must be a function");return number$1(Nt),number$1(Ut),bool(jt),bool(xt),(Lt,Ht,Vt,zt,Wt=0)=>{bytes$2(Lt),bytes$2(Ht),bytes$2(Vt);const Jt=Vt.length;if(zt||(zt=new Uint8Array(Jt)),bytes$2(zt),number$1(Wt),Wt<0||Wt>=MAX_COUNTER)throw new Error("arx: counter overflow");if(zt.length<Jt)throw new Error(`arx: output (${zt.length}) is shorter than data (${Jt})`);const Qt=[];let Xt=Lt.length,tr,rr;if(Xt===32)tr=Lt.slice(),Qt.push(tr),rr=sigma32_32;else if(Xt===16&&xt)tr=new Uint8Array(32),tr.set(Lt),tr.set(Lt,16),rr=sigma16_32,Qt.push(tr);else throw new Error(`arx: invalid 32-byte key, got length=${Xt}`);isAligned32(Ht)||(Ht=Ht.slice(),Qt.push(Ht));const nr=u32$1(tr);if(Bt){if(Ht.length!==24)throw new Error("arx: extended nonce must be 24 bytes");Bt(rr,nr,u32$1(Ht.subarray(0,16)),nr),Ht=Ht.subarray(16)}const ar=16-Nt;if(ar!==Ht.length)throw new Error(`arx: nonce must be ${ar} or 16 bytes`);if(ar!==12){const lr=new Uint8Array(12);lr.set(Ht,jt?0:12-Ht.length),Ht=lr,Qt.push(Ht)}const ir=u32$1(Ht);for(runCipher(kt,rr,nr,ir,Vt,zt,Wt,Ut);Qt.length>0;)Qt.pop().fill(0);return zt}}function chachaCore(kt,At,xt,Bt,Nt,jt=20){let Ut=kt[0],Lt=kt[1],Ht=kt[2],Vt=kt[3],zt=At[0],Wt=At[1],Jt=At[2],Qt=At[3],Xt=At[4],tr=At[5],rr=At[6],nr=At[7],ar=Nt,ir=xt[0],lr=xt[1],yr=xt[2],Sr=Ut,Ar=Lt,Dr=Ht,Br=Vt,Lr=zt,Or=Wt,vr=Jt,pr=Qt,dr=Xt,ur=tr,$r=rr,wr=nr,Er=ar,gr=ir,fr=lr,br=yr;for(let Tr=0;Tr<jt;Tr+=2)Sr=Sr+Lr|0,Er=rotl$1(Er^Sr,16),dr=dr+Er|0,Lr=rotl$1(Lr^dr,12),Sr=Sr+Lr|0,Er=rotl$1(Er^Sr,8),dr=dr+Er|0,Lr=rotl$1(Lr^dr,7),Ar=Ar+Or|0,gr=rotl$1(gr^Ar,16),ur=ur+gr|0,Or=rotl$1(Or^ur,12),Ar=Ar+Or|0,gr=rotl$1(gr^Ar,8),ur=ur+gr|0,Or=rotl$1(Or^ur,7),Dr=Dr+vr|0,fr=rotl$1(fr^Dr,16),$r=$r+fr|0,vr=rotl$1(vr^$r,12),Dr=Dr+vr|0,fr=rotl$1(fr^Dr,8),$r=$r+fr|0,vr=rotl$1(vr^$r,7),Br=Br+pr|0,br=rotl$1(br^Br,16),wr=wr+br|0,pr=rotl$1(pr^wr,12),Br=Br+pr|0,br=rotl$1(br^Br,8),wr=wr+br|0,pr=rotl$1(pr^wr,7),Sr=Sr+Or|0,br=rotl$1(br^Sr,16),$r=$r+br|0,Or=rotl$1(Or^$r,12),Sr=Sr+Or|0,br=rotl$1(br^Sr,8),$r=$r+br|0,Or=rotl$1(Or^$r,7),Ar=Ar+vr|0,Er=rotl$1(Er^Ar,16),wr=wr+Er|0,vr=rotl$1(vr^wr,12),Ar=Ar+vr|0,Er=rotl$1(Er^Ar,8),wr=wr+Er|0,vr=rotl$1(vr^wr,7),Dr=Dr+pr|0,gr=rotl$1(gr^Dr,16),dr=dr+gr|0,pr=rotl$1(pr^dr,12),Dr=Dr+pr|0,gr=rotl$1(gr^Dr,8),dr=dr+gr|0,pr=rotl$1(pr^dr,7),Br=Br+Lr|0,fr=rotl$1(fr^Br,16),ur=ur+fr|0,Lr=rotl$1(Lr^ur,12),Br=Br+Lr|0,fr=rotl$1(fr^Br,8),ur=ur+fr|0,Lr=rotl$1(Lr^ur,7);let _r=0;Bt[_r++]=Ut+Sr|0,Bt[_r++]=Lt+Ar|0,Bt[_r++]=Ht+Dr|0,Bt[_r++]=Vt+Br|0,Bt[_r++]=zt+Lr|0,Bt[_r++]=Wt+Or|0,Bt[_r++]=Jt+vr|0,Bt[_r++]=Qt+pr|0,Bt[_r++]=Xt+dr|0,Bt[_r++]=tr+ur|0,Bt[_r++]=rr+$r|0,Bt[_r++]=nr+wr|0,Bt[_r++]=ar+Er|0,Bt[_r++]=ir+gr|0,Bt[_r++]=lr+fr|0,Bt[_r++]=yr+br|0}function hchacha(kt,At,xt,Bt){let Nt=kt[0],jt=kt[1],Ut=kt[2],Lt=kt[3],Ht=At[0],Vt=At[1],zt=At[2],Wt=At[3],Jt=At[4],Qt=At[5],Xt=At[6],tr=At[7],rr=xt[0],nr=xt[1],ar=xt[2],ir=xt[3];for(let yr=0;yr<20;yr+=2)Nt=Nt+Ht|0,rr=rotl$1(rr^Nt,16),Jt=Jt+rr|0,Ht=rotl$1(Ht^Jt,12),Nt=Nt+Ht|0,rr=rotl$1(rr^Nt,8),Jt=Jt+rr|0,Ht=rotl$1(Ht^Jt,7),jt=jt+Vt|0,nr=rotl$1(nr^jt,16),Qt=Qt+nr|0,Vt=rotl$1(Vt^Qt,12),jt=jt+Vt|0,nr=rotl$1(nr^jt,8),Qt=Qt+nr|0,Vt=rotl$1(Vt^Qt,7),Ut=Ut+zt|0,ar=rotl$1(ar^Ut,16),Xt=Xt+ar|0,zt=rotl$1(zt^Xt,12),Ut=Ut+zt|0,ar=rotl$1(ar^Ut,8),Xt=Xt+ar|0,zt=rotl$1(zt^Xt,7),Lt=Lt+Wt|0,ir=rotl$1(ir^Lt,16),tr=tr+ir|0,Wt=rotl$1(Wt^tr,12),Lt=Lt+Wt|0,ir=rotl$1(ir^Lt,8),tr=tr+ir|0,Wt=rotl$1(Wt^tr,7),Nt=Nt+Vt|0,ir=rotl$1(ir^Nt,16),Xt=Xt+ir|0,Vt=rotl$1(Vt^Xt,12),Nt=Nt+Vt|0,ir=rotl$1(ir^Nt,8),Xt=Xt+ir|0,Vt=rotl$1(Vt^Xt,7),jt=jt+zt|0,rr=rotl$1(rr^jt,16),tr=tr+rr|0,zt=rotl$1(zt^tr,12),jt=jt+zt|0,rr=rotl$1(rr^jt,8),tr=tr+rr|0,zt=rotl$1(zt^tr,7),Ut=Ut+Wt|0,nr=rotl$1(nr^Ut,16),Jt=Jt+nr|0,Wt=rotl$1(Wt^Jt,12),Ut=Ut+Wt|0,nr=rotl$1(nr^Ut,8),Jt=Jt+nr|0,Wt=rotl$1(Wt^Jt,7),Lt=Lt+Ht|0,ar=rotl$1(ar^Lt,16),Qt=Qt+ar|0,Ht=rotl$1(Ht^Qt,12),Lt=Lt+Ht|0,ar=rotl$1(ar^Lt,8),Qt=Qt+ar|0,Ht=rotl$1(Ht^Qt,7);let lr=0;Bt[lr++]=Nt,Bt[lr++]=jt,Bt[lr++]=Ut,Bt[lr++]=Lt,Bt[lr++]=rr,Bt[lr++]=nr,Bt[lr++]=ar,Bt[lr++]=ir}const xchacha20=createCipher(chachaCore,{counterRight:!1,counterLength:8,extendNonceFn:hchacha,allowShortKeys:!1}),ZEROS16=new Uint8Array(16),updatePadded=(kt,At)=>{kt.update(At);const xt=At.length%16;xt&&kt.update(ZEROS16.subarray(xt))},ZEROS32=new Uint8Array(32);function computeTag(kt,At,xt,Bt,Nt){const jt=kt(At,xt,ZEROS32),Ut=poly1305.create(jt);Nt&&updatePadded(Ut,Nt),updatePadded(Ut,Bt);const Lt=new Uint8Array(16),Ht=createView$1(Lt);setBigUint64$1(Ht,0,BigInt(Nt?Nt.length:0),!0),setBigUint64$1(Ht,8,BigInt(Bt.length),!0),Ut.update(Lt);const Vt=Ut.digest();return jt.fill(0),Vt}const _poly1305_aead=kt=>(At,xt,Bt)=>(bytes$2(At,32),bytes$2(xt),{encrypt:(jt,Ut)=>{const Lt=jt.length,Ht=Lt+16;Ut?bytes$2(Ut,Ht):Ut=new Uint8Array(Ht),kt(At,xt,jt,Ut,1);const Vt=computeTag(kt,At,xt,Ut.subarray(0,-16),Bt);return Ut.set(Vt,Lt),Ut},decrypt:(jt,Ut)=>{const Lt=jt.length,Ht=Lt-16;if(Lt<16)throw new Error("encrypted data must be at least 16 bytes");Ut?bytes$2(Ut,Ht):Ut=new Uint8Array(Ht);const Vt=jt.subarray(0,-16),zt=jt.subarray(-16),Wt=computeTag(kt,At,xt,Vt,Bt);if(!equalBytes$1(zt,Wt))throw new Error("invalid tag");return kt(At,xt,Vt,Ut,1),Ut}}),xchacha20poly1305=wrapCipher({blockSize:64,nonceLength:24,tagLength:16},_poly1305_aead(xchacha20));function isArrayBufferSlice$1(kt){return kt.byteOffset!==0||kt.byteLength!==kt.buffer.byteLength}function isAsyncIterable$6(kt){return typeof kt!="object"||kt===null?!1:typeof kt[Symbol.asyncIterator]=="function"}function universalTypeOf$1(kt){const xt=Object.prototype.toString.call(kt).match(/\s([a-zA-Z0-9]+)/),[Bt,Nt]=xt;return Nt}var __awaiter$1N=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$7=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};const textEncoder$1=new TextEncoder,textDecoder$1=new TextDecoder;let Convert$1=class Si{constructor(At,xt){this.data=At,this.format=xt}static arrayBuffer(At){return new Si(At,"ArrayBuffer")}static asyncIterable(At){if(!isAsyncIterable$6(At))throw new TypeError("Input must be of type AsyncIterable.");return new Si(At,"AsyncIterable")}static base32Z(At){return new Si(At,"Base32Z")}static base58Btc(At){return new Si(At,"Base58Btc")}static base64Url(At){return new Si(At,"Base64Url")}static bufferSource(At){return new Si(At,"BufferSource")}static hex(At){if(typeof At!="string")throw new TypeError("Hex input must be a string.");if(At.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Si(At,"Hex")}static multibase(At){return new Si(At,"Multibase")}static object(At){return new Si(At,"Object")}static string(At){return new Si(At,"String")}static uint8Array(At){return new Si(At,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return base58btc$1.baseDecode(this.data).buffer;case"Base64Url":return base64url$3.baseDecode(this.data).buffer;case"BufferSource":{if(universalTypeOf$1(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return isArrayBufferSlice$1(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return __awaiter$1N(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return base32z$1.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const At=new Uint8Array(this.data);return base58btc$1.baseEncode(At)}case"Multibase":return this.data.substring(1);case"Uint8Array":return base58btc$1.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const At=new Uint8Array(this.data);return base64url$3.baseEncode(At)}case"BufferSource":{const At=this.toUint8Array();return base64url$3.baseEncode(At)}case"Object":{const At=JSON.stringify(this.data),xt=textEncoder$1.encode(At);return base64url$3.baseEncode(xt)}case"String":{const At=textEncoder$1.encode(this.data);return base64url$3.baseEncode(At)}case"Uint8Array":return base64url$3.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var At,xt,Bt,Nt;return __awaiter$1N(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const Ht=[];try{for(var jt=!0,Ut=__asyncValues$7(this.data),Lt;Lt=yield Ut.next(),At=Lt.done,!At;jt=!0){Nt=Lt.value,jt=!1;const zt=Nt;Ht.push(zt)}}catch(zt){xt={error:zt}}finally{try{!jt&&!At&&(Bt=Ut.return)&&(yield Bt.call(Ut))}finally{if(xt)throw xt.error}}return new Blob(Ht)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const At=Array.from({length:256},(xt,Bt)=>Bt.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const xt=this.toUint8Array();return Si.uint8Array(xt).toHex()}case"Base64Url":{const xt=this.toUint8Array();return Si.uint8Array(xt).toHex()}case"Uint8Array":{let xt="";for(let Bt=0;Bt<this.data.length;Bt++)xt+=At[this.data[Bt]];return xt}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const At=base64url$3.baseDecode(this.data),xt=textDecoder$1.decode(At);return JSON.parse(xt)}case"String":return JSON.parse(this.data);case"Uint8Array":{const At=textDecoder$1.decode(this.data);return JSON.parse(At)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return __awaiter$1N(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const At=yield this.toStringAsync();return JSON.parse(At)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return textDecoder$1.decode(this.data);case"Base64Url":{const At=base64url$3.baseDecode(this.data);return textDecoder$1.decode(At)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return textDecoder$1.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var At,xt,Bt,Nt;return __awaiter$1N(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let Ht="";try{for(var jt=!0,Ut=__asyncValues$7(this.data),Lt;Lt=yield Ut.next(),At=Lt.done,!At;jt=!0){Nt=Lt.value,jt=!1;const Vt=Nt;typeof Vt=="string"?Ht+=Vt:Ht+=textDecoder$1.decode(Vt,{stream:!0})}}catch(Vt){xt={error:Vt}}finally{try{!jt&&!At&&(Bt=Ut.return)&&(yield Bt.call(Ut))}finally{if(xt)throw xt.error}}return Ht+=textDecoder$1.decode(void 0,{stream:!1}),Ht}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return base32z$1.baseDecode(this.data);case"Base58Btc":return base58btc$1.baseDecode(this.data);case"Base64Url":return base64url$3.baseDecode(this.data);case"BufferSource":{const At=universalTypeOf$1(this.data);if(At==="Uint8Array")return this.data;if(At==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const At=new Uint8Array(this.data.length/2);for(let xt=0;xt<this.data.length;xt+=2){const Bt=parseInt(this.data.substring(xt,xt+2),16);if(isNaN(Bt))throw new TypeError("Input is not a valid hexadecimal string.");At[xt/2]=Bt}return At}case"Object":{const At=JSON.stringify(this.data);return textEncoder$1.encode(At)}case"String":return textEncoder$1.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return __awaiter$1N(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const At=yield this.toArrayBufferAsync();return new Uint8Array(At)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}},Multicodec$1=class Zi{static addPrefix(At){var xt;let{code:Bt,data:Nt,name:jt}=At;if(!(jt?!Bt:Bt))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(Bt=Zi.codeToName.has(Bt)?Bt:Zi.nameToCode.get(jt),Bt===void 0)throw new Error(`Unsupported multicodec: ${(xt=At.name)!==null&&xt!==void 0?xt:At.code}`);const Ut=encodingLength$8(Bt),Lt=new Uint8Array(Ut+Nt.byteLength);return Lt.set(Nt,Ut),encodeTo$3(Bt,Lt),Lt}static getCodeFromData(At){const{prefixedData:xt}=At,[Bt,Nt]=decode$n(xt);return Bt}static getCodeFromName(At){const{name:xt}=At,Bt=Zi.nameToCode.get(xt);if(Bt===void 0)throw new Error(`Unsupported multicodec: ${xt}`);return Bt}static getNameFromCode(At){const{code:xt}=At,Bt=Zi.codeToName.get(xt);if(Bt===void 0)throw new Error(`Unsupported multicodec: ${xt}`);return Bt}static registerCodec(At){Zi.codeToName.set(At.code,At.name),Zi.nameToCode.set(At.name,At.code)}static removePrefix(At){const{prefixedData:xt}=At,[Bt,Nt]=decode$n(xt),jt=Zi.codeToName.get(Bt);if(jt===void 0)throw new Error(`Unsupported multicodec: ${Bt}`);return{code:Bt,data:xt.slice(Nt),name:jt}}};Multicodec$1.codeToName=new Map;Multicodec$1.nameToCode=new Map;Multicodec$1.registerCodec({code:237,name:"ed25519-pub"});Multicodec$1.registerCodec({code:4864,name:"ed25519-priv"});Multicodec$1.registerCodec({code:236,name:"x25519-pub"});Multicodec$1.registerCodec({code:4866,name:"x25519-priv"});Multicodec$1.registerCodec({code:231,name:"secp256k1-pub"});Multicodec$1.registerCodec({code:4865,name:"secp256k1-priv"});function isEmptyObject(kt){return typeof kt!="object"||kt===null||Object.getOwnPropertySymbols(kt).length>0?!1:Object.keys(kt).length===0}function removeUndefinedProperties(kt){Object.keys(kt).forEach(At=>{kt[At]===void 0?delete kt[At]:typeof kt[At]=="object"&&removeUndefinedProperties(kt[At])})}var Level=browserLevel.BrowserLevel,__awaiter$1M=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class LevelStore{constructor({db:At,location:xt="DATASTORE"}={}){this.store=At??new Level(xt)}clear(){return __awaiter$1M(this,void 0,void 0,function*(){yield this.store.clear()})}close(){return __awaiter$1M(this,void 0,void 0,function*(){yield this.store.close()})}delete(At){return __awaiter$1M(this,void 0,void 0,function*(){yield this.store.del(At)})}get(At){return __awaiter$1M(this,void 0,void 0,function*(){try{return yield this.store.get(At)}catch(xt){if(xt.notFound)return;throw xt}})}set(At,xt){return __awaiter$1M(this,void 0,void 0,function*(){yield this.store.put(At,xt)})}}class MemoryStore{constructor(){this.store=new Map}clear(){return __awaiter$1M(this,void 0,void 0,function*(){this.store.clear()})}close(){return __awaiter$1M(this,void 0,void 0,function*(){})}delete(At){return __awaiter$1M(this,void 0,void 0,function*(){return this.store.delete(At)})}get(At){return __awaiter$1M(this,void 0,void 0,function*(){return this.store.get(At)})}has(At){return __awaiter$1M(this,void 0,void 0,function*(){return this.store.has(At)})}list(){return __awaiter$1M(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(At,xt){return __awaiter$1M(this,void 0,void 0,function*(){this.store.set(At,xt)})}}var __awaiter$1L=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__await$4=function(kt){return this instanceof __await$4?(this.v=kt,this):new __await$4(kt)},__asyncGenerator$3=function(kt,At,xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Bt=xt.apply(kt,At||[]),Nt,jt=[];return Nt={},Ut("next"),Ut("throw"),Ut("return"),Nt[Symbol.asyncIterator]=function(){return this},Nt;function Ut(Jt){Bt[Jt]&&(Nt[Jt]=function(Qt){return new Promise(function(Xt,tr){jt.push([Jt,Qt,Xt,tr])>1||Lt(Jt,Qt)})})}function Lt(Jt,Qt){try{Ht(Bt[Jt](Qt))}catch(Xt){Wt(jt[0][3],Xt)}}function Ht(Jt){Jt.value instanceof __await$4?Promise.resolve(Jt.value.v).then(Vt,zt):Wt(jt[0][2],Jt)}function Vt(Jt){Lt("next",Jt)}function zt(Jt){Lt("throw",Jt)}function Wt(Jt,Qt){Jt(Qt),jt.shift(),jt.length&&Lt(jt[0][0],jt[0][1])}};class Stream{static asAsyncIterator(At){return __asyncGenerator$3(this,arguments,function*(){const Bt=At.getReader();try{for(;;){const{done:Nt,value:jt}=yield __await$4(Bt.read());if(Nt)break;yield yield __await$4(jt)}}finally{Bt.releaseLock()}})}static consumeToArrayBuffer({readableStream:At}){return __awaiter$1L(this,void 0,void 0,function*(){const xt=Stream.asAsyncIterator(At);return yield Convert$1.asyncIterable(xt).toArrayBufferAsync()})}static consumeToBlob({readableStream:At}){return __awaiter$1L(this,void 0,void 0,function*(){const xt=Stream.asAsyncIterator(At);return yield Convert$1.asyncIterable(xt).toBlobAsync()})}static consumeToBytes({readableStream:At}){return __awaiter$1L(this,void 0,void 0,function*(){const xt=Stream.asAsyncIterator(At);return yield Convert$1.asyncIterable(xt).toUint8ArrayAsync()})}static consumeToJson({readableStream:At}){return __awaiter$1L(this,void 0,void 0,function*(){const xt=Stream.asAsyncIterator(At);return yield Convert$1.asyncIterable(xt).toObjectAsync()})}static consumeToText({readableStream:At}){return __awaiter$1L(this,void 0,void 0,function*(){const xt=Stream.asAsyncIterator(At);return yield Convert$1.asyncIterable(xt).toStringAsync()})}static generateByteStream({streamLength:At,chunkLength:xt,fillValue:Bt}){let Nt=At??1/0,jt;function Ut(){const Lt=Math.min(Nt,xt??1/0);Nt-=Lt;let Ht;if(typeof Bt=="number")Ht=new Uint8Array(Lt).fill(Bt);else if(Array.isArray(Bt)){Ht=new Uint8Array(Lt);const[Vt,zt]=Bt,Wt=zt-Vt+1;for(let Jt=0;Jt<Lt;Jt++)Ht[Jt]=Math.floor(Math.random()*Wt)+Vt}else Ht=new Uint8Array(Lt);jt.enqueue(Ht),Nt<=0&&jt.close()}return new ReadableStream({start(Lt){jt=Lt,Ut()},pull(){Ut()}})}static isReadable({readableStream:At}){if(!Stream.isReadableStream(At)||At.locked)return!1;try{return At.getReader().releaseLock(),!0}catch{return!1}}static isReadableStream(At){return typeof At=="object"&&At!==null&&"getReader"in At&&typeof At.getReader=="function"}static isStream(At){return Stream.isReadableStream(At)||Stream.isWritableStream(At)||Stream.isTransformStream(At)}static isTransformStream(At){return typeof At=="object"&&At!==null&&"readable"in At&&typeof At.readable=="object"&&"writable"in At&&typeof At.writable=="object"}static isWritableStream(At){return typeof At=="object"&&At!==null&&"getWriter"in At&&typeof At.getWriter=="function"&&"abort"in At&&typeof At.abort=="function"}}var __awaiter$1K=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class NodeStream{static consumeToArrayBuffer({readable:At}){return __awaiter$1K(this,void 0,void 0,function*(){return yield Convert$1.asyncIterable(At).toArrayBufferAsync()})}static consumeToBlob({readable:At}){return __awaiter$1K(this,void 0,void 0,function*(){return yield Convert$1.asyncIterable(At).toBlobAsync()})}static consumeToBytes({readable:At}){return __awaiter$1K(this,void 0,void 0,function*(){return yield Convert$1.asyncIterable(At).toUint8ArrayAsync()})}static consumeToJson({readable:At}){return __awaiter$1K(this,void 0,void 0,function*(){return yield Convert$1.asyncIterable(At).toObjectAsync()})}static consumeToText({readable:At}){return __awaiter$1K(this,void 0,void 0,function*(){return yield Convert$1.asyncIterable(At).toStringAsync()})}static fromWebReadable({readableStream:At,readableOptions:xt}){if(!Stream.isReadableStream(At))throw new TypeError("NodeStream.fromWebReadable: 'readableStream' is not a Web ReadableStream.");const Bt=At.getReader();let Nt=!1;const jt=new browserExports.Readable(Object.assign(Object.assign({},xt),{read:function(){Bt.read().then(({done:Ut,value:Lt})=>{if(Ut)this.push(null);else if(!this.push(Lt))return}).catch(Ut=>{this.destroy(Ut)})},destroy:function(Ut,Lt){function Ht(){Lt(Ut)}if(!Nt){Bt.cancel(Ut).then(Ht).catch(Ht);return}Ht()}}));return Bt.closed.then(()=>{Nt=!0}).catch(Ut=>{Nt=!0,jt.destroy(Ut)}),jt}static isDestroyed({stream:At}){if(!NodeStream.isStream(At))throw new TypeError("NodeStream.isDestroyed: 'stream' is not a Node stream.");const xt="_writableState"in At?At._writableState:void 0,Bt=At._readableState,Nt=xt||Bt;return!!(At.destroyed||Nt.destroyed)}static isReadable({readable:At}){return NodeStream.isReadableStream(At)?At.readable&&typeof At._readableState.ended=="boolean"&&!At._readableState.ended&&typeof At._readableState.endEmitted=="boolean"&&!At._readableState.endEmitted&&!At.destroyed&&!At.isPaused():!1}static isReadableStream(At){return typeof At=="object"&&At!==null&&"pipe"in At&&typeof At.pipe=="function"&&"on"in At&&typeof At.on=="function"&&!("_writableState"in At)&&"_readableState"in At}static isStream(At){return typeof At=="object"&&At!==null&&("_readableState"in At||"_writableState"in At)}static toWebReadable({readable:At}){if(!NodeStream.isReadableStream(At))throw new TypeError("NodeStream.toWebReadable: 'readable' is not a Node Readable stream.");if(NodeStream.isDestroyed({stream:At})){const xt=new ReadableStream;return xt.cancel(),xt}return new ReadableStream({start(xt){At.on("data",Bt=>{xt.enqueue(Bt)}),At.on("end",()=>{xt.close()}),At.on("error",Bt=>{xt.error(Bt)})},cancel(){At.destroy()}})}}function extractDidFragment$2(kt){if(typeof kt=="string"&&kt.length!==0)return kt.split("#").pop()}function getVerificationMethods$2({didDocument:kt}){var At,xt;if(!kt)throw new TypeError("Required parameter missing: 'didDocument'");const Bt=[];return Bt.push(...(xt=(At=kt.verificationMethod)===null||At===void 0?void 0:At.filter(isDidVerificationMethod$2))!==null&&xt!==void 0?xt:[]),Object.keys(DidVerificationRelationship$2).forEach(Nt=>{var jt,Ut;Bt.push(...(Ut=(jt=kt[Nt])===null||jt===void 0?void 0:jt.filter(isDidVerificationMethod$2))!==null&&Ut!==void 0?Ut:[])}),Bt}function getVerificationMethodTypes$2({didDocument:kt}){const xt=getVerificationMethods$2({didDocument:kt}).map(Bt=>Bt.type);return[...new Set(xt)]}function getVerificationRelationshipsById$2({didDocument:kt,methodId:At}){const xt=[];return Object.keys(DidVerificationRelationship$2).forEach(Bt=>{if(Array.isArray(kt[Bt])){const Nt=kt[Bt],jt=extractDidFragment$2(At);Nt.some(Lt=>{const Ht=extractDidFragment$2(Lt)===jt,Vt=isDidVerificationMethod$2(Lt)&&extractDidFragment$2(Lt.id)===jt;return Ht||Vt})&&xt.push(Bt)}}),xt}function isDidVerificationMethod$2(kt){return!(!kt||typeof kt!="object"||kt===null||!("id"in kt&&"type"in kt&&"controller"in kt)||typeof kt.id!="string"||typeof kt.type!="string"||typeof kt.controller!="string")}function keyBytesToMultibaseId$2({keyBytes:kt,multicodecCode:At,multicodecName:xt}){const Bt=Multicodec$1.addPrefix({code:At,data:kt,name:xt}),Nt=Convert$1.uint8Array(Bt).toBase58Btc();return Convert$1.base58Btc(Nt).toMultibase()}function multibaseIdToKeyBytes$2({multibaseKeyId:kt}){try{const At=Convert$1.multibase(kt).toBase58Btc(),xt=Convert$1.base58Btc(At).toUint8Array(),{code:Bt,data:Nt,name:jt}=Multicodec$1.removePrefix({prefixedData:xt});return{keyBytes:Nt,multicodecCode:Bt,multicodecName:jt}}catch{throw new DidError$2(DidErrorCode$2.InvalidDid,`Invalid multibase identifier: ${kt}`)}}var __awaiter$1J=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let BearerDid$2=class fs{constructor({uri:At,document:xt,metadata:Bt,keyManager:Nt}){this.uri=At,this.document=xt,this.metadata=Bt,this.keyManager=Nt}export(){return __awaiter$1J(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let At={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const xt=[];for(let Bt of this.document.verificationMethod){if(!Bt.publicKeyJwk)throw new Error(`Verification method '${Bt.id}' does not contain a public key in JWK format`);const Nt=yield this.keyManager.getKeyUri({key:Bt.publicKeyJwk}),jt=yield this.keyManager.exportKey({keyUri:Nt});xt.push(Object.assign({},jt))}At.privateKeys=xt}return At})}getSigner(At){return __awaiter$1J(this,void 0,void 0,function*(){var xt;const Bt=(xt=this.document.verificationMethod)===null||xt===void 0?void 0:xt.find(Ht=>{var Vt,zt;return extractDidFragment$2(Ht.id)===((Vt=extractDidFragment$2(At==null?void 0:At.methodId))!==null&&Vt!==void 0?Vt:extractDidFragment$2((zt=this.document.assertionMethod)===null||zt===void 0?void 0:zt[0]))});if(!(Bt&&Bt.publicKeyJwk))throw new DidError$2(DidErrorCode$2.InternalError,"A verification method intended for signing could not be determined from the DID Document");const Nt=yield this.keyManager.getKeyUri({key:Bt.publicKeyJwk}),jt=yield this.keyManager.getPublicKey({keyUri:Nt}),Ut=this.keyManager;return{algorithm:getJoseSignatureAlgorithmFromPublicKey$3(jt),keyId:Bt.id,sign(Ht){return __awaiter$1J(this,arguments,void 0,function*({data:Vt}){return yield Ut.sign({data:Vt,keyUri:Nt})})},verify(Ht){return __awaiter$1J(this,arguments,void 0,function*({data:Vt,signature:zt}){return yield Ut.verify({data:Vt,key:jt,signature:zt})})}}})}static import(At){return __awaiter$1J(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$3}){var Nt;const jt=getVerificationMethods$2({didDocument:xt.document});if(jt.length===0)throw new DidError$2(DidErrorCode$2.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let Lt of(Nt=xt.privateKeys)!==null&&Nt!==void 0?Nt:[])yield Bt.importKey({key:Lt});for(let Lt of jt){if(!Lt.publicKeyJwk)throw new Error(`Verification method '${Lt.id}' does not contain a public key in JWK format`);const Ht=yield Bt.getKeyUri({key:Lt.publicKeyJwk});yield Bt.getPublicKey({keyUri:Ht})}return new fs({uri:xt.uri,document:xt.document,metadata:xt.metadata,keyManager:Bt})})}};/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wrting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const alphabet$1="0123456789abcdef",encodeLookup=[];for(let kt=0;kt<256;kt++)encodeLookup[kt]=alphabet$1[kt>>4&15]+alphabet$1[kt&15];const arr2hex=kt=>{const At=kt.length;let xt="",Bt=0;for(;Bt<At;)xt+=encodeLookup[kt[Bt++]];return xt},concat=(kt,At=0)=>{const xt=kt.length||0;if(!At){let Ut=xt;for(;Ut--;)At+=kt[Ut].length}const Bt=new Uint8Array(At);let Nt=At,jt=xt;for(;jt--;)Nt-=kt[jt].length,Bt.set(kt[jt],Nt);return Bt};var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$2=0;i$2<chars.length;i$2++)lookup[chars.charCodeAt(i$2)]=i$2;const decoder=new TextDecoder,arr2text=(kt,At)=>decoder.decode(kt),encoder=new TextEncoder,text2arr=kt=>encoder.encode(kt),scope=typeof window<"u"?window:self,crypto$1=scope.crypto||scope.msCrypto||{};crypto$1.subtle||crypto$1.webkitSubtle;function digitCount(kt){const At=kt<0?1:0;return kt=Math.abs(Number(kt||1)),Math.floor(Math.log10(kt))+1+At}function getType(kt){return ArrayBuffer.isView(kt)?"arraybufferview":Array.isArray(kt)?"array":kt instanceof Number?"number":kt instanceof Boolean?"boolean":kt instanceof Set?"set":kt instanceof Map?"map":kt instanceof String?"string":kt instanceof ArrayBuffer?"arraybuffer":typeof kt}function encode$5(kt,At,xt){const Bt=[];let Nt=null;return encode$5._encode(Bt,kt),Nt=concat(Bt),encode$5.bytes=Nt.length,ArrayBuffer.isView(At)?(At.set(Nt,xt),At):Nt}encode$5.bytes=-1;encode$5._floatConversionDetected=!1;encode$5._encode=function(kt,At){if(At!=null)switch(getType(At)){case"object":encode$5.dict(kt,At);break;case"map":encode$5.dictMap(kt,At);break;case"array":encode$5.list(kt,At);break;case"set":encode$5.listSet(kt,At);break;case"string":encode$5.string(kt,At);break;case"number":encode$5.number(kt,At);break;case"boolean":encode$5.number(kt,At);break;case"arraybufferview":encode$5.buffer(kt,new Uint8Array(At.buffer,At.byteOffset,At.byteLength));break;case"arraybuffer":encode$5.buffer(kt,new Uint8Array(At));break}};const buffE=new Uint8Array([101]),buffD=new Uint8Array([100]),buffL=new Uint8Array([108]);encode$5.buffer=function(kt,At){kt.push(text2arr(At.length+":"),At)};encode$5.string=function(kt,At){kt.push(text2arr(text2arr(At).byteLength+":"+At))};encode$5.number=function(kt,At){if(Number.isInteger(At))return kt.push(text2arr("i"+BigInt(At)+"e"));const xt=2147483648,Bt=At/xt<<0,Nt=At%xt<<0,jt=Bt*xt+Nt;kt.push(text2arr("i"+jt+"e")),jt!==At&&!encode$5._floatConversionDetected&&(encode$5._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+At+'":','Bencoding only defines support for integers, value was converted to "'+jt+'"'),console.trace())};encode$5.dict=function(kt,At){kt.push(buffD);let xt=0,Bt;const Nt=Object.keys(At).sort(),jt=Nt.length;for(;xt<jt;xt++)Bt=Nt[xt],At[Bt]!=null&&(encode$5.string(kt,Bt),encode$5._encode(kt,At[Bt]));kt.push(buffE)};encode$5.dictMap=function(kt,At){kt.push(buffD);const xt=Array.from(At.keys()).sort();for(const Bt of xt)At.get(Bt)!=null&&(ArrayBuffer.isView(Bt)?encode$5._encode(kt,Bt):encode$5.string(kt,String(Bt)),encode$5._encode(kt,At.get(Bt)));kt.push(buffE)};encode$5.list=function(kt,At){let xt=0;const Bt=At.length;for(kt.push(buffL);xt<Bt;xt++)At[xt]!=null&&encode$5._encode(kt,At[xt]);kt.push(buffE)};encode$5.listSet=function(kt,At){kt.push(buffL);for(const xt of At)xt!=null&&encode$5._encode(kt,xt);kt.push(buffE)};const INTEGER_START=105,STRING_DELIM=58,DICTIONARY_START=100,LIST_START=108,END_OF_TYPE=101;function getIntFromBuffer(kt,At,xt){let Bt=0,Nt=1;for(let jt=At;jt<xt;jt++){const Ut=kt[jt];if(Ut<58&&Ut>=48){Bt=Bt*10+(Ut-48);continue}if(!(jt===At&&Ut===43)){if(jt===At&&Ut===45){Nt=-1;continue}if(Ut===46)break;throw new Error("not a number: buffer["+jt+"] = "+Ut)}}return Bt*Nt}function decode$4(kt,At,xt,Bt){return kt==null||kt.length===0?null:(typeof At!="number"&&Bt==null&&(Bt=At,At=void 0),typeof xt!="number"&&Bt==null&&(Bt=xt,xt=void 0),decode$4.position=0,decode$4.encoding=Bt||null,decode$4.data=ArrayBuffer.isView(kt)?new Uint8Array(kt.slice(At,xt)):text2arr(kt),decode$4.bytes=decode$4.data.length,decode$4.next())}decode$4.bytes=0;decode$4.position=0;decode$4.data=null;decode$4.encoding=null;decode$4.next=function(){switch(decode$4.data[decode$4.position]){case DICTIONARY_START:return decode$4.dictionary();case LIST_START:return decode$4.list();case INTEGER_START:return decode$4.integer();default:return decode$4.buffer()}};decode$4.find=function(kt){let At=decode$4.position;const xt=decode$4.data.length,Bt=decode$4.data;for(;At<xt;){if(Bt[At]===kt)return At;At++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(kt)+'" [0x'+kt.toString(16)+"]")};decode$4.dictionary=function(){decode$4.position++;const kt={};for(;decode$4.data[decode$4.position]!==END_OF_TYPE;){const At=decode$4.buffer();let xt=arr2text(At);xt.includes("")&&(xt=arr2hex(At)),kt[xt]=decode$4.next()}return decode$4.position++,kt};decode$4.list=function(){decode$4.position++;const kt=[];for(;decode$4.data[decode$4.position]!==END_OF_TYPE;)kt.push(decode$4.next());return decode$4.position++,kt};decode$4.integer=function(){const kt=decode$4.find(END_OF_TYPE),At=getIntFromBuffer(decode$4.data,decode$4.position+1,kt);return decode$4.position+=kt+1-decode$4.position,At};decode$4.buffer=function(){let kt=decode$4.find(STRING_DELIM);const At=getIntFromBuffer(decode$4.data,decode$4.position,kt),xt=++kt+At;return decode$4.position=xt,decode$4.encoding?arr2text(decode$4.data.slice(kt,xt)):decode$4.data.slice(kt,xt)};function listLength(kt){let At=2;for(const xt of kt)At+=encodingLength$3(xt);return At}function mapLength(kt){let At=2;for(const[xt,Bt]of kt){const Nt=text2arr(xt).byteLength;At+=digitCount(Nt)+1+Nt,At+=encodingLength$3(Bt)}return At}function objectLength(kt){let At=2;const xt=Object.keys(kt);for(let Bt=0;Bt<xt.length;Bt++){const Nt=text2arr(xt[Bt]).byteLength;At+=digitCount(Nt)+1+Nt,At+=encodingLength$3(kt[xt[Bt]])}return At}function stringLength(kt){const At=text2arr(kt).byteLength;return digitCount(At)+1+At}function arrayBufferLength(kt){const At=kt.byteLength-kt.byteOffset;return digitCount(At)+1+At}function encodingLength$3(kt){if(kt==null)return 0;const xt=getType(kt);switch(xt){case"arraybufferview":return arrayBufferLength(kt);case"string":return stringLength(kt);case"array":case"set":return listLength(kt);case"number":return 1+digitCount(Math.floor(kt))+1;case"bigint":return 1+kt.toString().length+1;case"object":return objectLength(kt);case"map":return mapLength(kt);default:throw new TypeError(`Unsupported value of type "${xt}"`)}}const encodingLength$2=encodingLength$3,bencode={encode:encode$5,decode:decode$4,byteLength:encodingLength$3,encodingLength:encodingLength$2},v4Regex=/^(\d{1,3}\.){3,3}\d{1,3}$/,v4Size=4,v6Regex=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,v6Size=16,v4={name:"v4",size:v4Size,isFormat:kt=>v4Regex.test(kt),encode(kt,At,xt){xt=~~xt,At=At||new Uint8Array(xt+v4Size);const Bt=kt.length;let Nt=0;for(let jt=0;jt<Bt;){const Ut=kt.charCodeAt(jt++);Ut===46?(At[xt++]=Nt,Nt=0):Nt=Nt*10+(Ut-48)}return At[xt]=Nt,At},decode(kt,At){return At=~~At,`${kt[At++]}.${kt[At++]}.${kt[At++]}.${kt[At]}`}},v6={name:"v6",size:v6Size,isFormat:kt=>kt.length>0&&v6Regex.test(kt),encode(kt,At,xt){xt=~~xt;let Bt=xt+v6Size,Nt=-1,jt=0,Ut=0,Lt=!0,Ht=!1;At=At||new Uint8Array(xt+v6Size);for(let Vt=0;Vt<kt.length;Vt++){let zt=kt.charCodeAt(Vt);zt===58?(Lt?Nt!==-1?(xt<Bt&&(At[xt]=0),xt<Bt-1&&(At[xt+1]=0),xt+=2):xt<Bt&&(Nt=xt):(Ht===!0?(xt<Bt&&(At[xt]=Ut),xt++):(xt<Bt&&(At[xt]=jt>>8),xt<Bt-1&&(At[xt+1]=jt&255),xt+=2),jt=0,Ut=0),Lt=!0,Ht=!1):zt===46?(xt<Bt&&(At[xt]=Ut),xt++,Ut=0,jt=0,Lt=!1,Ht=!0):(Lt=!1,zt>=97?zt-=87:zt>=65?zt-=55:(zt-=48,Ut=Ut*10+zt),jt=(jt<<4)+zt)}if(Lt===!1)Ht===!0?(xt<Bt&&(At[xt]=Ut),xt++):(xt<Bt&&(At[xt]=jt>>8),xt<Bt-1&&(At[xt+1]=jt&255),xt+=2);else if(Nt===0)xt<Bt&&(At[xt]=0),xt<Bt-1&&(At[xt+1]=0),xt+=2;else if(Nt!==-1){xt+=2;for(let Vt=Math.min(xt-1,Bt-1);Vt>=Nt+2;Vt--)At[Vt]=At[Vt-2];At[Nt]=0,At[Nt+1]=0,Nt=xt}if(Nt!==xt&&Nt!==-1)for(xt>Bt-2&&(xt=Bt-2);Bt>Nt;)At[--Bt]=xt<Bt&&xt>Nt?At[--xt]:0;else for(;xt<Bt;)At[xt++]=0;return At},decode(kt,At){At=~~At;let xt="";for(let Bt=0;Bt<v6Size;Bt+=2)Bt!==0&&(xt+=":"),xt+=(kt[At+Bt]<<8|kt[At+Bt+1]).toString(16);return xt.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function sizeOf(kt){if(v4.isFormat(kt))return v4.size;if(v6.isFormat(kt))return v6.size;throw Error(`Invalid ip address: ${kt}`)}function familyOf(kt){return sizeOf(kt)===v4.size?1:2}function encode$4(kt,At,xt){xt=~~xt;const Bt=sizeOf(kt);return typeof At=="function"&&(At=At(xt+Bt)),Bt===v4.size?v4.encode(kt,At,xt):v6.encode(kt,At,xt)}function decode$3(kt,At,xt){if(At=~~At,xt=xt||kt.length-At,xt===v4.size)return v4.decode(kt,At,xt);if(xt===v6.size)return v6.decode(kt,At,xt);throw Error(`Invalid buffer size needs to be ${v4.size} for v4 or ${v6.size} for v6.`)}function toString$4(kt){switch(kt){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+kt}function toType(kt){switch(kt.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return kt.toUpperCase().startsWith("UNKNOWN_")?parseInt(kt.slice(8)):0}function toString$3(kt){switch(kt){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+kt}function toString$2(kt){switch(kt){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+kt}function toString$1(kt){switch(kt){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+kt}function toClass(kt){switch(kt.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}function toString(kt){switch(kt){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return kt<0?null:`OPTION_${kt}`}function toCode(kt){if(typeof kt=="number")return kt;if(!kt)return-1;switch(kt.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const At=kt.match(/_(\d+)$/);return At?parseInt(At[1],10):-1}const SURROGATE_A=55296,SURROGATE_B=56320;function encodingLength$1(kt){let At=0;const xt=kt.length;for(let Bt=0;Bt<xt;Bt+=1){const Nt=kt.charCodeAt(Bt);if(Nt<=127)At+=1;else if(Nt<=2047)At+=2;else if((Nt&63488)!==SURROGATE_A)At+=3;else{const jt=Bt+1;jt===xt||Nt>=SURROGATE_B||(kt.charCodeAt(jt)&64512)!==SURROGATE_B?At+=3:(Bt=jt,At+=4)}}return At}function encode$3(kt,At,xt){const Bt=kt.length;xt==null&&(xt=0),At===void 0&&(At=new Uint8Array(encodingLength$1(kt)+xt));let Nt=xt;for(let jt=0;jt<Bt;jt+=1){let Ut=kt.charCodeAt(jt);if(Ut<=127)At[Nt++]=Ut;else if(Ut<=2047)At[Nt++]=192|(Ut&1984)>>6,At[Nt++]=128|Ut&63;else if((Ut&63488)!==SURROGATE_A)At[Nt++]=224|(Ut&61440)>>12,At[Nt++]=128|(Ut&4032)>>6,At[Nt++]=128|Ut&63;else{const Lt=jt+1;if(Lt===Bt||Ut>=SURROGATE_B)At[Nt++]=239,At[Nt++]=191,At[Nt++]=189;else{const Ht=kt.charCodeAt(Lt);(Ht&64512)!==SURROGATE_B?(At[Nt++]=239,At[Nt++]=191,At[Nt++]=189):(jt=Lt,Ut=65536|(Ut&1023)<<10|Ht&1023,At[Nt++]=240|(Ut&1835008)>>18,At[Nt++]=128|(Ut&258048)>>12,At[Nt++]=128|(Ut&4032)>>6,At[Nt++]=128|Ut&63)}}}return encode$3.bytes=Nt-xt,At}encode$3.bytes=0;function decode$2(kt,At,xt){let Bt="";At==null&&(At=0),xt==null&&(xt=kt.length);for(let Nt=At;Nt<xt;){const jt=kt[Nt++];let Ut;if(jt<=128)Ut=jt;else if(jt>191&&jt<224)Ut=(jt&31)<<6|kt[Nt++]&63;else if(jt>239&&jt<365){Ut=((jt&7)<<18|(kt[Nt++]&63)<<12|(kt[Nt++]&63)<<6|kt[Nt++]&63)-65536;const Lt=SURROGATE_A|Ut>>10&1023;Bt+=String.fromCharCode(Lt),Ut=SURROGATE_B|Ut&1023}else Ut=(jt&15)<<12|(kt[Nt++]&63)<<6|kt[Nt++]&63;Bt+=String.fromCharCode(Ut)}return decode$2.bytes=xt-At,Bt}decode$2.bytes=0;const isU8Arr=kt=>kt instanceof Uint8Array;function bytelength(kt){return typeof kt=="string"?encodingLength$1(kt):kt.byteLength}function from(kt){return kt instanceof Uint8Array?kt:Array.isArray(kt)?new Uint8Array(kt):encode$3(kt)}function write(kt,At,xt){if(typeof At!="string")throw new Error("unknown input type");return encode$3(At,kt,xt),encode$3.bytes}const hexNum={},numHex=new Array(255);for(let kt=0;kt<=15;kt+=1){const At=kt.toString(16),xt=At.toUpperCase();for(let Bt=0;Bt<=15;Bt+=1){const Nt=Bt.toString(16),jt=Nt.toUpperCase(),Ut=kt<<4|Bt,Lt=`${At}${Nt}`;numHex[Ut]=Lt,hexNum[Lt]=Ut,hexNum[`${xt}${Nt}`]=Ut,hexNum[`${At}${jt}`]=Ut,hexNum[`${xt}${jt}`]=Ut}}function toHex(kt,At,xt){let Bt="";for(let Nt=At;Nt<xt;){const jt=kt[Nt++];Bt+=numHex[jt]}return Bt}function hexLength(kt){return kt.length>>>1}function writeHex(kt,At,xt,Bt){let Nt=0;for(;xt<Bt;){const jt=At.substr(Nt,2),Ut=hexNum[jt];if(Ut===void 0)return;kt[xt++]=Ut,Nt+=2}return kt}const P_24=Math.pow(2,24),P_16=Math.pow(2,16),P_8=Math.pow(2,8),readUInt32BE=(kt,At)=>kt[At]*P_24+kt[At+1]*P_16+kt[At+2]*P_8+kt[At+3],readUInt16BE=(kt,At)=>kt[At]<<8|kt[At+1],writeUInt32BE=(kt,At,xt)=>(At=+At,kt[xt+3]=At,At=At>>>8,kt[xt+2]=At,At=At>>>8,kt[xt+1]=At,At=At>>>8,kt[xt]=At,xt+4),writeUInt16BE=(kt,At,xt)=>(kt[xt]=At>>8,kt[xt+1]=At&255,xt+2);function copy(kt,At,xt,Bt,Nt){return xt<0&&(Bt-=xt,xt=0),Bt<0&&(Bt=0),Nt<0?new Uint8Array(0):xt>=At.length||Bt>=Nt?0:_copyActual(kt,At,xt,Bt,Nt)}function _copyActual(kt,At,xt,Bt,Nt){Nt-Bt>At.length-xt&&(Nt=Bt+At.length-xt);let jt=Nt-Bt;const Ut=kt.length-Bt;return jt>Ut&&(jt=Ut),(Bt!==0||Nt<kt.length)&&(kt=new Uint8Array(kt.buffer,kt.byteOffset+Bt,jt)),At.set(kt,xt),jt}const QUERY_FLAG=0,RESPONSE_FLAG=32768,FLUSH_MASK=32768,NOT_FLUSH_MASK=~FLUSH_MASK,QU_MASK=32768,NOT_QU_MASK=~QU_MASK;function codec({bytes:kt=0,encode:At,decode:xt,encodingLength:Bt}){return At.bytes=kt,xt.bytes=kt,{encode:At,decode:xt,encodingLength:Bt||(()=>kt)}}const name$1=codec({encode(kt,At,xt){At||(At=new Uint8Array(name$1.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=kt.replace(/^\.|\.$/gm,"");if(Nt.length){const jt=Nt.split(".");for(let Ut=0;Ut<jt.length;Ut++){const Lt=write(At,jt[Ut],xt+1);At[xt]=Lt,xt+=Lt+1}}return At[xt++]=0,name$1.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=[];let Bt=At,Nt=0,jt=0,Ut=!1;for(;;){if(At>=kt.length)throw new Error("Cannot decode name (buffer overflow)");const Lt=kt[At++];if(jt+=Ut?0:1,Lt===0)break;if(Lt&192)if((Lt&192)===192){if(At+1>kt.length)throw new Error("Cannot decode name (buffer overflow)");const Ht=readUInt16BE(kt,At-1)-49152;if(Ht>=Bt)throw new Error("Cannot decode name (bad pointer)");At=Ht,Bt=Ht,jt+=Ut?0:1,Ut=!0}else throw new Error("Cannot decode name (bad label)");else{if(At+Lt>kt.length)throw new Error("Cannot decode name (buffer overflow)");if(Nt+=Lt+1,Nt>254)throw new Error("Cannot decode name (name too long)");xt.push(decode$2(kt,At,At+Lt)),At+=Lt,jt+=Ut?0:Lt}}return name$1.decode.bytes=jt,xt.length===0?".":xt.join(".")},encodingLength(kt){return kt==="."||kt===".."?1:bytelength(kt.replace(/^\.|\.$/gm,""))+2}}),string=codec({encode(kt,At,xt){At||(At=new Uint8Array(string.encodingLength(kt))),xt||(xt=0);const Bt=write(At,kt,xt+1);return At[xt]=Bt,string.encode.bytes=Bt+1,At},decode(kt,At){At||(At=0);const xt=kt[At],Bt=decode$2(kt,At+1,At+1+xt);return string.decode.bytes=xt+1,Bt},encodingLength(kt){return bytelength(kt)+1}}),header=codec({bytes:12,encode(kt,At,xt){At||(At=new Uint8Array(header.encodingLength(kt))),xt||(xt=0);const Bt=(kt.flags||0)&32767,Nt=kt.type==="response"?RESPONSE_FLAG:QUERY_FLAG;return writeUInt16BE(At,kt.id||0,xt),writeUInt16BE(At,Bt|Nt,xt+2),writeUInt16BE(At,kt.questions.length,xt+4),writeUInt16BE(At,kt.answers.length,xt+6),writeUInt16BE(At,kt.authorities.length,xt+8),writeUInt16BE(At,kt.additionals.length,xt+10),At},decode(kt,At){if(At||(At=0),kt.length<12)throw new Error("Header must be 12 bytes");const xt=readUInt16BE(kt,At+2);return{id:readUInt16BE(kt,At),type:xt&RESPONSE_FLAG?"response":"query",flags:xt&32767,flag_qr:(xt>>15&1)===1,opcode:toString$2(xt>>11&15),flag_aa:(xt>>10&1)===1,flag_tc:(xt>>9&1)===1,flag_rd:(xt>>8&1)===1,flag_ra:(xt>>7&1)===1,flag_z:(xt>>6&1)===1,flag_ad:(xt>>5&1)===1,flag_cd:(xt>>4&1)===1,rcode:toString$3(xt&15),questions:new Array(readUInt16BE(kt,At+4)),answers:new Array(readUInt16BE(kt,At+6)),authorities:new Array(readUInt16BE(kt,At+8)),additionals:new Array(readUInt16BE(kt,At+10))}},encodingLength(){return 12}}),runknown=codec({encode(kt,At,xt){At||(At=new Uint8Array(runknown.encodingLength(kt))),xt||(xt=0);const Bt=kt.length;return writeUInt16BE(At,Bt,xt),copy(kt,At,xt+2,0,Bt),runknown.encode.bytes=Bt+2,At},decode(kt,At){At||(At=0);const xt=readUInt16BE(kt,At),Bt=kt.slice(At+2,At+2+xt);return runknown.decode.bytes=xt+2,Bt},encodingLength(kt){return kt.length+2}}),rns=codec({encode(kt,At,xt){return At||(At=new Uint8Array(rns.encodingLength(kt))),xt||(xt=0),name$1.encode(kt,At,xt+2),writeUInt16BE(At,name$1.encode.bytes,xt),rns.encode.bytes=name$1.encode.bytes+2,At},decode(kt,At){At||(At=0);const xt=readUInt16BE(kt,At),Bt=name$1.decode(kt,At+2);return rns.decode.bytes=xt+2,Bt},encodingLength(kt){return name$1.encodingLength(kt)+2}}),rsoa=codec({encode(kt,At,xt){At||(At=new Uint8Array(rsoa.encodingLength(kt))),xt||(xt=0);const Bt=xt;return xt+=2,name$1.encode(kt.mname,At,xt),xt+=name$1.encode.bytes,name$1.encode(kt.rname,At,xt),xt+=name$1.encode.bytes,writeUInt32BE(At,kt.serial||0,xt),xt+=4,writeUInt32BE(At,kt.refresh||0,xt),xt+=4,writeUInt32BE(At,kt.retry||0,xt),xt+=4,writeUInt32BE(At,kt.expire||0,xt),xt+=4,writeUInt32BE(At,kt.minimum||0,xt),xt+=4,writeUInt16BE(At,xt-Bt-2,Bt),rsoa.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=At,Bt={};return At+=2,Bt.mname=name$1.decode(kt,At),At+=name$1.decode.bytes,Bt.rname=name$1.decode(kt,At),At+=name$1.decode.bytes,Bt.serial=readUInt32BE(kt,At),At+=4,Bt.refresh=readUInt32BE(kt,At),At+=4,Bt.retry=readUInt32BE(kt,At),At+=4,Bt.expire=readUInt32BE(kt,At),At+=4,Bt.minimum=readUInt32BE(kt,At),At+=4,rsoa.decode.bytes=At-xt,Bt},encodingLength(kt){return 22+name$1.encodingLength(kt.mname)+name$1.encodingLength(kt.rname)}}),rtxt=codec({encode(kt,At,xt){Array.isArray(kt)||(kt=[kt]);for(let Nt=0;Nt<kt.length;Nt++)if(typeof kt[Nt]=="string"&&(kt[Nt]=from(kt[Nt])),!isU8Arr(kt[Nt]))throw new Error("Must be a Buffer");At||(At=new Uint8Array(rtxt.encodingLength(kt))),xt||(xt=0);const Bt=xt;return xt+=2,kt.forEach(function(Nt){At[xt++]=Nt.length,copy(Nt,At,xt,0,Nt.length),xt+=Nt.length}),writeUInt16BE(At,xt-Bt-2,Bt),rtxt.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=At;let Bt=readUInt16BE(kt,At);At+=2;const Nt=[];for(;Bt>0;){const jt=kt[At++];if(--Bt,Bt<jt)throw new Error("Buffer overflow");Nt.push(kt.slice(At,At+jt)),At+=jt,Bt-=jt}return rtxt.decode.bytes=At-xt,Nt},encodingLength(kt){Array.isArray(kt)||(kt=[kt]);let At=2;return kt.forEach(function(xt){typeof xt=="string"?At+=bytelength(xt)+1:At+=xt.length+1}),At}}),rnull=codec({encode(kt,At,xt){At||(At=new Uint8Array(rnull.encodingLength(kt))),xt||(xt=0),typeof kt=="string"&&(kt=from(kt)),kt||(kt=new Uint8Array(0));const Bt=xt;xt+=2;const Nt=kt.length;return copy(kt,At,xt,0,Nt),xt+=Nt,writeUInt16BE(At,xt-Bt-2,Bt),rnull.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=At,Bt=readUInt16BE(kt,At);At+=2;const Nt=kt.slice(At,At+Bt);return At+=Bt,rnull.decode.bytes=At-xt,Nt},encodingLength(kt){return kt?(isU8Arr(kt)?kt.length:bytelength(kt))+2:2}}),rhinfo=codec({encode(kt,At,xt){At||(At=new Uint8Array(rhinfo.encodingLength(kt))),xt||(xt=0);const Bt=xt;return xt+=2,string.encode(kt.cpu,At,xt),xt+=string.encode.bytes,string.encode(kt.os,At,xt),xt+=string.encode.bytes,writeUInt16BE(At,xt-Bt-2,Bt),rhinfo.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=At,Bt={};return At+=2,Bt.cpu=string.decode(kt,At),At+=string.decode.bytes,Bt.os=string.decode(kt,At),At+=string.decode.bytes,rhinfo.decode.bytes=At-xt,Bt},encodingLength(kt){return string.encodingLength(kt.cpu)+string.encodingLength(kt.os)+2}}),rptr=codec({encode(kt,At,xt){return At||(At=new Uint8Array(rptr.encodingLength(kt))),xt||(xt=0),name$1.encode(kt,At,xt+2),writeUInt16BE(At,name$1.encode.bytes,xt),rptr.encode.bytes=name$1.encode.bytes+2,At},decode(kt,At){At||(At=0);const xt=name$1.decode(kt,At+2);return rptr.decode.bytes=name$1.decode.bytes+2,xt},encodingLength(kt){return name$1.encodingLength(kt)+2}}),rsrv=codec({encode(kt,At,xt){At||(At=new Uint8Array(rsrv.encodingLength(kt))),xt||(xt=0),writeUInt16BE(At,kt.priority||0,xt+2),writeUInt16BE(At,kt.weight||0,xt+4),writeUInt16BE(At,kt.port||0,xt+6),name$1.encode(kt.target,At,xt+8);const Bt=name$1.encode.bytes+6;return writeUInt16BE(At,Bt,xt),rsrv.encode.bytes=Bt+2,At},decode(kt,At){At||(At=0);const xt=readUInt16BE(kt,At),Bt={};return Bt.priority=readUInt16BE(kt,At+2),Bt.weight=readUInt16BE(kt,At+4),Bt.port=readUInt16BE(kt,At+6),Bt.target=name$1.decode(kt,At+8),rsrv.decode.bytes=xt+2,Bt},encodingLength(kt){return 8+name$1.encodingLength(kt.target)}}),rcaa=codec({encode(kt,At,xt){const Bt=rcaa.encodingLength(kt);return At||(At=new Uint8Array(rcaa.encodingLength(kt))),xt||(xt=0),kt.issuerCritical&&(kt.flags=rcaa.ISSUER_CRITICAL),writeUInt16BE(At,Bt-2,xt),xt+=2,At[xt]=kt.flags||0,xt+=1,string.encode(kt.tag,At,xt),xt+=string.encode.bytes,write(At,kt.value,xt),xt+=bytelength(kt.value),rcaa.encode.bytes=Bt,At},decode(kt,At){At||(At=0);const xt=readUInt16BE(kt,At);At+=2;const Bt=At,Nt={};return Nt.flags=kt[At],At+=1,Nt.tag=string.decode(kt,At),At+=string.decode.bytes,Nt.value=decode$2(kt,At,Bt+xt),Nt.issuerCritical=!!(Nt.flags&rcaa.ISSUER_CRITICAL),rcaa.decode.bytes=xt+2,Nt},encodingLength(kt){return string.encodingLength(kt.tag)+string.encodingLength(kt.value)+2}});rcaa.ISSUER_CRITICAL=128;const rmx=codec({encode(kt,At,xt){At||(At=new Uint8Array(rmx.encodingLength(kt))),xt||(xt=0);const Bt=xt;return xt+=2,writeUInt16BE(At,kt.preference||0,xt),xt+=2,name$1.encode(kt.exchange,At,xt),xt+=name$1.encode.bytes,writeUInt16BE(At,xt-Bt-2,Bt),rmx.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=At,Bt={};return At+=2,Bt.preference=readUInt16BE(kt,At),At+=2,Bt.exchange=name$1.decode(kt,At),At+=name$1.decode.bytes,rmx.decode.bytes=At-xt,Bt},encodingLength(kt){return 4+name$1.encodingLength(kt.exchange)}}),ra=codec({encode(kt,At,xt){return At||(At=new Uint8Array(ra.encodingLength(kt))),xt||(xt=0),writeUInt16BE(At,4,xt),xt+=2,v4.encode(kt,At,xt),At},decode(kt,At){return At||(At=0),At+=2,v4.decode(kt,At)},bytes:6}),raaaa=codec({encode(kt,At,xt){return At||(At=new Uint8Array(raaaa.encodingLength(kt))),xt||(xt=0),writeUInt16BE(At,16,xt),xt+=2,v6.encode(kt,At,xt),raaaa.encode.bytes=18,At},decode(kt,At){At||(At=0),At+=2;const xt=v6.decode(kt,At);return raaaa.decode.bytes=18,xt},bytes:18}),alloc=kt=>new Uint8Array(kt),roption=codec({encode(kt,At,xt){At||(At=new Uint8Array(roption.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=toCode(kt.code);if(writeUInt16BE(At,Nt,xt),xt+=2,kt.data)writeUInt16BE(At,kt.data.length,xt),xt+=2,copy(kt.data,At,xt),xt+=kt.data.length;else switch(Nt){case 8:{const jt=kt.sourcePrefixLength||0,Ut=kt.family||familyOf(kt.ip),Lt=encode$4(kt.ip,alloc),Ht=Math.ceil(jt/8);writeUInt16BE(At,Ht+4,xt),xt+=2,writeUInt16BE(At,Ut,xt),xt+=2,At[xt++]=jt,At[xt++]=kt.scopePrefixLength||0,copy(Lt,At,xt,0,Ht),xt+=Ht}break;case 11:kt.timeout?(writeUInt16BE(At,2,xt),xt+=2,writeUInt16BE(At,kt.timeout,xt),xt+=2):(writeUInt16BE(At,0,xt),xt+=2);break;case 12:{const jt=kt.length||0;writeUInt16BE(At,jt,xt),xt+=2,At.fill(0,xt,xt+jt),xt+=jt}break;case 14:{const jt=kt.tags.length*2;writeUInt16BE(At,jt,xt),xt+=2;for(const Ut of kt.tags)writeUInt16BE(At,Ut,xt),xt+=2}break;default:throw new Error(`Unknown roption code: ${kt.code}`)}return roption.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt={};xt.code=readUInt16BE(kt,At),xt.type=toString(xt.code),At+=2;const Bt=readUInt16BE(kt,At);switch(At+=2,xt.data=kt.slice(At,At+Bt),xt.code){case 8:xt.family=readUInt16BE(kt,At),At+=2,xt.sourcePrefixLength=kt[At++],xt.scopePrefixLength=kt[At++];{const Nt=new Uint8Array(xt.family===1?4:16);copy(kt,Nt,0,At,At+Bt-4),xt.ip=decode$3(Nt)}break;case 11:Bt>0&&(xt.timeout=readUInt16BE(kt,At),At+=2);break;case 14:xt.tags=[];for(let Nt=0;Nt<Bt;Nt+=2)xt.tags.push(readUInt16BE(kt,At)),At+=2}return roption.decode.bytes=Bt+4,xt},encodingLength(kt){if(kt.data)return kt.data.length+4;switch(toCode(kt.code)){case 8:{const xt=kt.sourcePrefixLength||0;return Math.ceil(xt/8)+8}case 11:return typeof kt.timeout=="number"?6:4;case 12:return kt.length+4;case 14:return 4+kt.tags.length*2}throw new Error(`Unknown roption code: ${kt.code}`)}}),ropt=codec({encode(kt,At,xt){At||(At=new Uint8Array(ropt.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=encodingLengthList(kt,roption);return writeUInt16BE(At,Nt,xt),xt=encodeList(kt,roption,At,xt+2),ropt.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt=At,Bt=[];let Nt=readUInt16BE(kt,At);At+=2;let jt=0;for(;Nt>0;)Bt[jt++]=roption.decode(kt,At),At+=roption.decode.bytes,Nt-=roption.decode.bytes;return ropt.decode.bytes=At-xt,Bt},encodingLength(kt){return 2+encodingLengthList(kt||[],roption)}}),rdnskey=codec({encode(kt,At,xt){At||(At=new Uint8Array(rdnskey.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=kt.key;if(!isU8Arr(Nt))throw new Error("Key must be a Buffer");return xt+=2,writeUInt16BE(At,kt.flags,xt),xt+=2,At[xt]=rdnskey.PROTOCOL_DNSSEC,xt+=1,At[xt]=kt.algorithm,xt+=1,copy(Nt,At,xt,0,Nt.length),xt+=Nt.length,rdnskey.encode.bytes=xt-Bt,writeUInt16BE(At,rdnskey.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={},Nt=readUInt16BE(kt,At);if(At+=2,Bt.flags=readUInt16BE(kt,At),At+=2,kt[At]!==rdnskey.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return At+=1,Bt.algorithm=kt[At],At+=1,Bt.key=kt.slice(At,xt+Nt+2),At+=Bt.key.length,rdnskey.decode.bytes=At-xt,Bt},encodingLength(kt){return 6+bytelength(kt.key)}});rdnskey.PROTOCOL_DNSSEC=3;rdnskey.ZONE_KEY=128;rdnskey.SECURE_ENTRYPOINT=32768;const rrrsig=codec({encode(kt,At,xt){At||(At=new Uint8Array(rrrsig.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=kt.signature;if(!isU8Arr(Nt))throw new Error("Signature must be a Buffer");return xt+=2,writeUInt16BE(At,toType(kt.typeCovered),xt),xt+=2,At[xt]=kt.algorithm,xt+=1,At[xt]=kt.labels,xt+=1,writeUInt32BE(At,kt.originalTTL,xt),xt+=4,writeUInt32BE(At,kt.expiration,xt),xt+=4,writeUInt32BE(At,kt.inception,xt),xt+=4,writeUInt16BE(At,kt.keyTag,xt),xt+=2,name$1.encode(kt.signersName,At,xt),xt+=name$1.encode.bytes,copy(Nt,At,xt,0,Nt.length),xt+=Nt.length,rrrsig.encode.bytes=xt-Bt,writeUInt16BE(At,rrrsig.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={},Nt=readUInt16BE(kt,At);return At+=2,Bt.typeCovered=toString$4(readUInt16BE(kt,At)),At+=2,Bt.algorithm=kt[At],At+=1,Bt.labels=kt[At],At+=1,Bt.originalTTL=readUInt32BE(kt,At),At+=4,Bt.expiration=readUInt32BE(kt,At),At+=4,Bt.inception=readUInt32BE(kt,At),At+=4,Bt.keyTag=readUInt16BE(kt,At),At+=2,Bt.signersName=name$1.decode(kt,At),At+=name$1.decode.bytes,Bt.signature=kt.slice(At,xt+Nt+2),At+=Bt.signature.length,rrrsig.decode.bytes=At-xt,Bt},encodingLength(kt){return 20+name$1.encodingLength(kt.signersName)+bytelength(kt.signature)}}),rrp=codec({encode(kt,At,xt){At||(At=new Uint8Array(rrp.encodingLength(kt))),xt||(xt=0);const Bt=xt;return xt+=2,name$1.encode(kt.mbox||".",At,xt),xt+=name$1.encode.bytes,name$1.encode(kt.txt||".",At,xt),xt+=name$1.encode.bytes,rrp.encode.bytes=xt-Bt,writeUInt16BE(At,rrp.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={};return At+=2,Bt.mbox=name$1.decode(kt,At)||".",At+=name$1.decode.bytes,Bt.txt=name$1.decode(kt,At)||".",At+=name$1.decode.bytes,rrp.decode.bytes=At-xt,Bt},encodingLength(kt){return 2+name$1.encodingLength(kt.mbox||".")+name$1.encodingLength(kt.txt||".")}}),typebitmap=codec({encode(kt,At,xt){At||(At=new Uint8Array(typebitmap.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=[];for(let jt=0;jt<kt.length;jt++){const Ut=toType(kt[jt]);Nt[Ut>>8]===void 0&&(Nt[Ut>>8]=[]),Nt[Ut>>8][Ut>>3&31]|=1<<7-(Ut&7)}for(let jt=0;jt<Nt.length;jt++)if(Nt[jt]!==void 0){const Ut=from(Nt[jt]);At[xt]=jt,xt+=1,At[xt]=Ut.length,xt+=1,copy(Ut,At,xt,0,Ut.length),xt+=Ut.length}return typebitmap.encode.bytes=xt-Bt,At},decode(kt,At,xt){At||(At=0);const Bt=At,Nt=[];for(;At-Bt<xt;){const jt=kt[At];At+=1;const Ut=kt[At];At+=1;for(let Lt=0;Lt<Ut;Lt++){const Ht=kt[At+Lt];for(let Vt=0;Vt<8;Vt++)if(Ht&1<<7-Vt){const zt=toString$4(jt<<8|Lt<<3|Vt);Nt.push(zt)}}At+=Ut}return typebitmap.decode.bytes=At-Bt,Nt},encodingLength(kt){const At=[];for(let Bt=0;Bt<kt.length;Bt++){const Nt=toType(kt[Bt]);At[Nt>>8]=Math.max(At[Nt>>8]||0,Nt&255)}let xt=0;for(let Bt=0;Bt<At.length;Bt++)At[Bt]!==void 0&&(xt+=2+Math.ceil((At[Bt]+1)/8));return xt}}),rnsec=codec({encode(kt,At,xt){At||(At=new Uint8Array(rnsec.encodingLength(kt))),xt||(xt=0);const Bt=xt;return xt+=2,name$1.encode(kt.nextDomain,At,xt),xt+=name$1.encode.bytes,typebitmap.encode(kt.rrtypes,At,xt),xt+=typebitmap.encode.bytes,rnsec.encode.bytes=xt-Bt,writeUInt16BE(At,rnsec.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={},Nt=readUInt16BE(kt,At);return At+=2,Bt.nextDomain=name$1.decode(kt,At),At+=name$1.decode.bytes,Bt.rrtypes=typebitmap.decode(kt,At,Nt-(At-xt)),At+=typebitmap.decode.bytes,rnsec.decode.bytes=At-xt,Bt},encodingLength(kt){return 2+name$1.encodingLength(kt.nextDomain)+typebitmap.encodingLength(kt.rrtypes)}}),rnsec3=codec({encode(kt,At,xt){At||(At=new Uint8Array(rnsec3.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=kt.salt;if(!isU8Arr(Nt))throw new Error("salt must be a Buffer");const jt=kt.nextDomain;if(!isU8Arr(jt))throw new Error("nextDomain must be a Buffer");return xt+=2,At[xt]=kt.algorithm,xt+=1,At[xt]=kt.flags,xt+=1,writeUInt16BE(At,kt.iterations,xt),xt+=2,At[xt]=Nt.length,xt+=1,copy(Nt,At,xt,0,Nt.length),xt+=Nt.length,At[xt]=jt.length,xt+=1,copy(jt,At,xt,0,jt.length),xt+=jt.length,typebitmap.encode(kt.rrtypes,At,xt),xt+=typebitmap.encode.bytes,rnsec3.encode.bytes=xt-Bt,writeUInt16BE(At,rnsec3.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={},Nt=readUInt16BE(kt,At);At+=2,Bt.algorithm=kt[At],At+=1,Bt.flags=kt[At],At+=1,Bt.iterations=readUInt16BE(kt,At),At+=2;const jt=kt[At];At+=1,Bt.salt=kt.slice(At,At+jt),At+=jt;const Ut=kt[At];return At+=1,Bt.nextDomain=kt.slice(At,At+Ut),At+=Ut,Bt.rrtypes=typebitmap.decode(kt,At,Nt-(At-xt)),At+=typebitmap.decode.bytes,rnsec3.decode.bytes=At-xt,Bt},encodingLength(kt){return 8+kt.salt.length+kt.nextDomain.length+typebitmap.encodingLength(kt.rrtypes)}}),rds=codec({encode(kt,At,xt){At||(At=new Uint8Array(rds.encodingLength(kt))),xt||(xt=0);const Bt=xt,Nt=kt.digest;if(!isU8Arr(Nt))throw new Error("Digest must be a Buffer");return xt+=2,writeUInt16BE(At,kt.keyTag,xt),xt+=2,At[xt]=kt.algorithm,xt+=1,At[xt]=kt.digestType,xt+=1,copy(Nt,At,xt,0,Nt.length),xt+=Nt.length,rds.encode.bytes=xt-Bt,writeUInt16BE(At,rds.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={},Nt=readUInt16BE(kt,At);return At+=2,Bt.keyTag=readUInt16BE(kt,At),At+=2,Bt.algorithm=kt[At],At+=1,Bt.digestType=kt[At],At+=1,Bt.digest=kt.slice(At,xt+Nt+2),At+=Bt.digest.length,rds.decode.bytes=At-xt,Bt},encodingLength(kt){return 6+bytelength(kt.digest)}}),rsshfp=codec({encode(kt,At,xt){At||(At=new Uint8Array(rsshfp.encodingLength(kt))),xt||(xt=0);const Bt=xt;xt+=2,At[xt]=kt.algorithm,xt+=1,At[xt]=kt.hash,xt+=1;const Nt=hexLength(kt.fingerprint),jt=getFingerprintLengthForHashType(kt.hash);if(Nt!==jt)throw new Error(`Invalid length of fingerprint "${kt.fingerprint}" for hashType=${kt.hash}: ${Nt} != ${jt}`);return writeHex(At,kt.fingerprint,xt,xt+=Nt),rsshfp.encode.bytes=xt-Bt,writeUInt16BE(At,rsshfp.encode.bytes-2,Bt),At},decode(kt,At){At||(At=0);const xt=At,Bt={};At+=2,Bt.algorithm=kt[At],At+=1,Bt.hash=kt[At],At+=1;const Nt=getFingerprintLengthForHashType(Bt.hash);return Bt.fingerprint=toHex(kt,At,At+Nt),At+=Nt,rsshfp.decode.bytes=At-xt,Bt},encodingLength(kt){return 4+hexLength(kt.fingerprint)}});function getFingerprintLengthForHashType(kt){if(kt===1)return 20;if(kt===2)return 32;throw new Error(`Invalid hashType=${kt}, supported=1,2`)}rsshfp.getFingerprintLengthForHashType=getFingerprintLengthForHashType;function renc(kt){switch(kt.toUpperCase()){case"A":return ra;case"PTR":return rptr;case"CNAME":return rptr;case"DNAME":return rptr;case"TXT":return rtxt;case"NULL":return rnull;case"AAAA":return raaaa;case"SRV":return rsrv;case"HINFO":return rhinfo;case"CAA":return rcaa;case"NS":return rns;case"SOA":return rsoa;case"MX":return rmx;case"OPT":return ropt;case"DNSKEY":return rdnskey;case"RRSIG":return rrrsig;case"RP":return rrp;case"NSEC":return rnsec;case"NSEC3":return rnsec3;case"SSHFP":return rsshfp;case"DS":return rds}return runknown}const answer=codec({encode(kt,At,xt){At||(At=new Uint8Array(answer.encodingLength(kt))),xt||(xt=0);const Bt=xt;if(name$1.encode(kt.name,At,xt),xt+=name$1.encode.bytes,writeUInt16BE(At,toType(kt.type),xt),kt.type.toUpperCase()==="OPT"){if(kt.name!==".")throw new Error("OPT name must be root.");writeUInt16BE(At,kt.udpPayloadSize||4096,xt+2),At[xt+4]=kt.extendedRcode||0,At[xt+5]=kt.ednsVersion||0,writeUInt16BE(At,kt.flags||0,xt+6),xt+=8,ropt.encode(kt.options||[],At,xt),xt+=ropt.encode.bytes}else{let Nt=toClass(kt.class===void 0?"IN":kt.class);kt.flush&&(Nt|=FLUSH_MASK),writeUInt16BE(At,Nt,xt+2),writeUInt32BE(At,kt.ttl||0,xt+4),xt+=8;const jt=renc(kt.type);jt.encode(kt.data,At,xt),xt+=jt.encode.bytes}return answer.encode.bytes=xt-Bt,At},decode(kt,At){At||(At=0);const xt={},Bt=At;if(xt.name=name$1.decode(kt,At),At+=name$1.decode.bytes,xt.type=toString$4(readUInt16BE(kt,At)),xt.type==="OPT")xt.udpPayloadSize=readUInt16BE(kt,At+2),xt.extendedRcode=kt[At+4],xt.ednsVersion=kt[At+5],xt.flags=readUInt16BE(kt,At+6),xt.flag_do=(xt.flags>>15&1)===1,xt.options=ropt.decode(kt,At+8),At+=8+ropt.decode.bytes;else{const Nt=readUInt16BE(kt,At+2);xt.ttl=readUInt32BE(kt,At+4),xt.class=toString$1(Nt&NOT_FLUSH_MASK),xt.flush=!!(Nt&FLUSH_MASK);const jt=renc(xt.type);xt.data=jt.decode(kt,At+8),At+=8+jt.decode.bytes}return answer.decode.bytes=At-Bt,xt},encodingLength(kt){const At=kt.data!==null&&kt.data!==void 0?kt.data:kt.options;return name$1.encodingLength(kt.name)+8+renc(kt.type).encodingLength(At)}}),question=codec({encode(kt,At,xt){At||(At=new Uint8Array(question.encodingLength(kt))),xt||(xt=0);const Bt=xt;return name$1.encode(kt.name,At,xt),xt+=name$1.encode.bytes,writeUInt16BE(At,toType(kt.type),xt),xt+=2,writeUInt16BE(At,toClass(kt.class===void 0?"IN":kt.class),xt),xt+=2,question.encode.bytes=xt-Bt,kt},decode(kt,At){At||(At=0);const xt=At,Bt={};return Bt.name=name$1.decode(kt,At),At+=name$1.decode.bytes,Bt.type=toString$4(readUInt16BE(kt,At)),At+=2,Bt.class=toString$1(readUInt16BE(kt,At)),At+=2,!!(Bt.class&QU_MASK)&&(Bt.class&=NOT_QU_MASK),question.decode.bytes=At-xt,Bt},encodingLength(kt){return name$1.encodingLength(kt.name)+4}}),AUTHORITATIVE_ANSWER=1024,packet={encode:function(kt,At,xt){const Bt=!At;Bt&&(At=new Uint8Array(encodingLength(kt))),xt||(xt=0);const Nt=xt;return kt.questions||(kt.questions=[]),kt.answers||(kt.answers=[]),kt.authorities||(kt.authorities=[]),kt.additionals||(kt.additionals=[]),header.encode(kt,At,xt),xt+=header.encode.bytes,xt=encodeList(kt.questions,question,At,xt),xt=encodeList(kt.answers,answer,At,xt),xt=encodeList(kt.authorities,answer,At,xt),xt=encodeList(kt.additionals,answer,At,xt),packet.encode.bytes=xt-Nt,Bt&&encode$2.bytes!==At.length?At.slice(0,encode$2.bytes):At},decode:function(kt,At){At||(At=0);const xt=At,Bt=header.decode(kt,At);return At+=header.decode.bytes,At=decodeList(Bt.questions,question,kt,At),At=decodeList(Bt.answers,answer,kt,At),At=decodeList(Bt.authorities,answer,kt,At),At=decodeList(Bt.additionals,answer,kt,At),packet.decode.bytes=At-xt,Bt},encodingLength:function(kt){return header.encodingLength(kt)+encodingLengthList(kt.questions||[],question)+encodingLengthList(kt.answers||[],answer)+encodingLengthList(kt.authorities||[],answer)+encodingLengthList(kt.additionals||[],answer)}};packet.encode.bytes=0;packet.decode.bytes=0;const encode$2=packet.encode,decode$1=packet.decode,encodingLength=packet.encodingLength;function encodingLengthList(kt,At){let xt=0;for(let Bt=0;Bt<kt.length;Bt++)xt+=At.encodingLength(kt[Bt]);return xt}function encodeList(kt,At,xt,Bt){for(let Nt=0;Nt<kt.length;Nt++)At.encode(kt[Nt],xt,Bt),Bt+=At.encode.bytes;return Bt}function decodeList(kt,At,xt,Bt){for(let Nt=0;Nt<kt.length;Nt++)kt[Nt]=At.decode(xt,Bt),Bt+=At.decode.bytes;return Bt}var __awaiter$1I=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidMethod$2=class{static getSigningMethod(At){return __awaiter$1I(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(At,xt){return __awaiter$1I(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var __awaiter$1H=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$p=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const DEFAULT_GATEWAY_URI$5="https://diddht.tbddev.org",DID_DHT_SPECIFICATION_VERSION$2=0,DNS_RECORD_TTL$2=7200,PROPERTY_SEPARATOR$2=";",VALUE_SEPARATOR$2=",";var DidDhtRegisteredDidType$2;(function(kt){kt[kt.Discoverable=0]="Discoverable",kt[kt.Organization=1]="Organization",kt[kt.Government=2]="Government",kt[kt.Corporation=3]="Corporation",kt[kt.LocalBusiness=4]="LocalBusiness",kt[kt.SoftwarePackage=5]="SoftwarePackage",kt[kt.WebApp=6]="WebApp",kt[kt.FinancialInstitution=7]="FinancialInstitution"})(DidDhtRegisteredDidType$2||(DidDhtRegisteredDidType$2={}));var DidDhtRegisteredKeyType$2;(function(kt){kt[kt.Ed25519=0]="Ed25519",kt[kt.secp256k1=1]="secp256k1",kt[kt.secp256r1=2]="secp256r1",kt[kt.X25519=3]="X25519"})(DidDhtRegisteredKeyType$2||(DidDhtRegisteredKeyType$2={}));var DidDhtVerificationRelationship$2;(function(kt){kt.authentication="auth",kt.assertionMethod="asm",kt.capabilityDelegation="del",kt.capabilityInvocation="inv",kt.keyAgreement="agm"})(DidDhtVerificationRelationship$2||(DidDhtVerificationRelationship$2={}));const AlgorithmToKeyTypeMap$8={Ed25519:DidDhtRegisteredKeyType$2.Ed25519,ES256K:DidDhtRegisteredKeyType$2.secp256k1,ES256:DidDhtRegisteredKeyType$2.secp256r1,"P-256":DidDhtRegisteredKeyType$2.secp256r1,secp256k1:DidDhtRegisteredKeyType$2.secp256k1,secp256r1:DidDhtRegisteredKeyType$2.secp256r1,X25519:DidDhtRegisteredKeyType$2.X25519},KeyTypeToDefaultAlgorithmMap$2={[DidDhtRegisteredKeyType$2.Ed25519]:"EdDSA",[DidDhtRegisteredKeyType$2.secp256k1]:"ES256K",[DidDhtRegisteredKeyType$2.secp256r1]:"ES256",[DidDhtRegisteredKeyType$2.X25519]:"ECDH-ES+A256KW"};let DidDht$2=class Vo extends DidMethod$2{static create(){return __awaiter$1H(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$3,options:xt={}}={}){var Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt;if(!((Bt=xt.verificationMethods)===null||Bt===void 0)&&Bt.some(yr=>!(yr.algorithm in AlgorithmToKeyTypeMap$8)))throw new Error("One or more verification method algorithms are not supported");const Xt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt.filter(yr=>"id"in yr).map(yr=>yr.id);if(Xt&&Xt.length!==new Set(Xt).size)throw new Error("One or more verification method IDs are not unique");if(!((jt=xt.services)===null||jt===void 0)&&jt.some(yr=>!yr.id||!yr.type||!yr.serviceEndpoint))throw new Error("One or more services are missing required properties");const tr=yield At.generateKey({algorithm:"Ed25519"}),rr=yield At.getPublicKey({keyUri:tr}),nr=yield DidDhtUtils$2.identityKeyToIdentifier({identityKey:rr}),ar=Object.assign(Object.assign({id:nr},xt.alsoKnownAs&&{alsoKnownAs:xt.alsoKnownAs}),xt.controllers&&{controller:xt.controllers}),ir=[...(Ut=xt.verificationMethods)!==null&&Ut!==void 0?Ut:[]];ir!=null&&ir.some(yr=>{var Sr;return((Sr=yr.id)===null||Sr===void 0?void 0:Sr.split("#").pop())==="0"})||ir.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const yr of ir){const Sr=yr.id&&yr.id.split("#").pop()==="0"?tr:yield At.generateKey({algorithm:yr.algorithm}),Ar=yield At.getPublicKey({keyUri:Sr});let Dr=(Ht=(Lt=yr.id)!==null&&Lt!==void 0?Lt:Ar.kid)!==null&&Ht!==void 0?Ht:yield computeJwkThumbprint$2({jwk:Ar});Dr=`${nr}#${extractDidFragment$2(Dr)}`,(Vt=ar.verificationMethod)!==null&&Vt!==void 0||(ar.verificationMethod=[]),ar.verificationMethod.push({id:Dr,type:"JsonWebKey",controller:(zt=yr.controller)!==null&&zt!==void 0?zt:nr,publicKeyJwk:Ar});for(const Br of(Wt=yr.purposes)!==null&&Wt!==void 0?Wt:[])ar[Br]||(ar[Br]=[]),ar[Br].push(Dr)}(Jt=xt.services)===null||Jt===void 0||Jt.forEach(yr=>{var Sr;(Sr=ar.service)!==null&&Sr!==void 0||(ar.service=[]),yr.id=`${nr}#${yr.id.split("#").pop()}`,ar.service.push(yr)});const lr=new BearerDid$2({uri:nr,document:ar,metadata:Object.assign({published:!1},xt.types&&{types:xt.types}),keyManager:At});if(!((Qt=xt.publish)!==null&&Qt!==void 0)||Qt){const yr=yield Vo.publish({did:lr,gatewayUri:xt.gatewayUri});lr.metadata=yr.didDocumentMetadata}return lr})}static import(At){return __awaiter$1H(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$3}){var Nt;const jt=Did$2.parse(xt.uri);if((jt==null?void 0:jt.method)!==Vo.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,"Method not supported");const Ut=yield BearerDid$2.import({portableDid:xt,keyManager:Bt});if(!(!((Nt=Ut.document.verificationMethod)===null||Nt===void 0)&&Nt.some(Lt=>{var Ht;return((Ht=Lt.id)===null||Ht===void 0?void 0:Ht.split("#").pop())==="0"})))throw new DidError$2(DidErrorCode$2.InvalidDidDocument,"DID document must contain an Identity Key");return Ut})}static getSigningMethod(At){return __awaiter$1H(this,arguments,void 0,function*({didDocument:xt,methodId:Bt="#0"}){var Nt;const jt=Did$2.parse(xt.id);if(jt&&jt.method!==this.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,`Method not supported: ${jt.method}`);const Ut=(Nt=xt.verificationMethod)===null||Nt===void 0?void 0:Nt.find(Lt=>{var Ht,Vt;return extractDidFragment$2(Lt.id)===((Ht=extractDidFragment$2(Bt))!==null&&Ht!==void 0?Ht:extractDidFragment$2((Vt=xt.assertionMethod)===null||Vt===void 0?void 0:Vt[0]))});if(!(Ut&&Ut.publicKeyJwk))throw new DidError$2(DidErrorCode$2.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static publish(At){return __awaiter$1H(this,arguments,void 0,function*({did:xt,gatewayUri:Bt=DEFAULT_GATEWAY_URI$5}){return yield DidDhtDocument$2.put({did:xt,gatewayUri:Bt})})}static resolve(At){return __awaiter$1H(this,arguments,void 0,function*(xt,Bt={}){var Nt;const jt=(Nt=Bt==null?void 0:Bt.gatewayUri)!==null&&Nt!==void 0?Nt:DEFAULT_GATEWAY_URI$5;try{yield DidDhtUtils$2.identifierToIdentityKey({didUri:xt});const{didDocument:Ut,didDocumentMetadata:Lt}=yield DidDhtDocument$2.get({didUri:xt,gatewayUri:jt});return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didDocument:Ut,didDocumentMetadata:Lt})}catch(Ut){if(!(Ut instanceof DidError$2))throw new Error(Ut);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:Object.assign({error:Ut.code},Ut.message&&{errorMessage:Ut.message})})}})}};DidDht$2.methodName="dht";let DidDhtDocument$2=class ro{static get(At){return __awaiter$1H(this,arguments,void 0,function*({didUri:xt,gatewayUri:Bt}){const Nt=DidDhtUtils$2.identifierToIdentityKeyBytes({didUri:xt}),jt=yield ro.pkarrGet({gatewayUri:Bt,publicKeyBytes:Nt}),Ut=yield DidDhtUtils$2.parseBep44GetMessage({bep44Message:jt}),Lt=yield ro.fromDnsPacket({didUri:xt,dnsPacket:Ut});return Lt.didDocumentMetadata.versionId=jt.seq.toString(),Lt})}static put(At){return __awaiter$1H(this,arguments,void 0,function*({did:xt,gatewayUri:Bt}){const Nt=yield ro.toDnsPacket({didDocument:xt.document,didMetadata:xt.metadata,authoritativeGatewayUris:[Bt]}),jt=yield DidDhtUtils$2.createBep44PutMessage({dnsPacket:Nt,publicKeyBytes:DidDhtUtils$2.identifierToIdentityKeyBytes({didUri:xt.uri}),signer:yield xt.getSigner({methodId:"0"})}),Ut=yield ro.pkarrPut({gatewayUri:Bt,bep44Message:jt});return{didDocument:xt.document,didDocumentMetadata:Object.assign(Object.assign({},xt.metadata),{published:Ut,versionId:jt.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(At){return __awaiter$1H(this,arguments,void 0,function*({gatewayUri:xt,publicKeyBytes:Bt}){const Nt=Convert$1.uint8Array(Bt).toBase32Z(),jt=new URL(Nt,xt).href;let Ut;try{if(Ut=yield fetch(jt,{method:"GET"}),!Ut.ok)throw new DidError$2(DidErrorCode$2.NotFound,`Pkarr record not found for: ${Nt}`)}catch(Vt){throw Vt instanceof DidError$2?Vt:new DidError$2(DidErrorCode$2.InternalError,`Failed to fetch Pkarr record: ${Vt.message}`)}const Lt=yield Ut.arrayBuffer();if(!Lt)throw new DidError$2(DidErrorCode$2.NotFound,`Pkarr record not found for: ${Nt}`);if(Lt.byteLength<72)throw new DidError$2(DidErrorCode$2.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${Lt.byteLength}`);if(Lt.byteLength>1072)throw new DidError$2(DidErrorCode$2.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${Lt.byteLength}`);return{k:Bt,seq:Number(new DataView(Lt).getBigUint64(64)),sig:new Uint8Array(Lt,0,64),v:new Uint8Array(Lt,72)}})}static pkarrPut(At){return __awaiter$1H(this,arguments,void 0,function*({gatewayUri:xt,bep44Message:Bt}){const Nt=Convert$1.uint8Array(Bt.k).toBase32Z(),jt=new URL(Nt,xt).href,Ut=new Uint8Array(Bt.v.length+72);Ut.set(Bt.sig,0),new DataView(Ut.buffer).setBigUint64(Bt.sig.length,BigInt(Bt.seq)),Ut.set(Bt.v,Bt.sig.length+8);let Lt;try{Lt=yield fetch(jt,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:Ut})}catch(Ht){throw new DidError$2(DidErrorCode$2.InternalError,`Failed to put Pkarr record for identifier ${Nt}: ${Ht.message}`)}return Lt.ok})}static fromDnsPacket(At){return __awaiter$1H(this,arguments,void 0,function*({didUri:xt,dnsPacket:Bt}){var Nt,jt,Ut;const Lt={id:xt},Ht={published:!0},Vt=new Map;for(const zt of(Nt=Bt==null?void 0:Bt.answers)!==null&&Nt!==void 0?Nt:[]){if(zt.type!=="TXT")continue;const Wt=zt.name.split(".")[0].substring(1);switch(!0){case Wt.startsWith("aka"):{const Jt=DidDhtUtils$2.parseTxtDataToString(zt.data);Lt.alsoKnownAs=Jt.split(VALUE_SEPARATOR$2);break}case Wt.startsWith("cnt"):{const Jt=DidDhtUtils$2.parseTxtDataToString(zt.data);Lt.controller=Jt.includes(VALUE_SEPARATOR$2)?Jt.split(VALUE_SEPARATOR$2):Jt;break}case Wt.startsWith("k"):{const{id:Jt,t:Qt,k:Xt,c:tr,a:rr}=DidDhtUtils$2.parseTxtDataToObject(zt.data),nr=Convert$1.base64Url(Xt).toUint8Array(),ar=DidDhtRegisteredKeyType$2[Number(Qt)];let ir=yield DidDhtUtils$2.keyConverter(ar).bytesToPublicKey({publicKeyBytes:nr});ir.alg=rr||KeyTypeToDefaultAlgorithmMap$2[Number(Qt)];const lr=Wt==="k0"?"0":Jt!==void 0?Jt:yield computeJwkThumbprint$2({jwk:ir});(jt=Lt.verificationMethod)!==null&&jt!==void 0||(Lt.verificationMethod=[]);const yr=`${xt}#${lr}`;Lt.verificationMethod.push({id:yr,type:"JsonWebKey",controller:tr??xt,publicKeyJwk:ir}),Vt.set(Wt,yr);break}case Wt.startsWith("s"):{const Jt=DidDhtUtils$2.parseTxtDataToObject(zt.data),{id:Qt,t:Xt,se:tr}=Jt,rr=__rest$p(Jt,["id","t","se"]),nr=tr.includes(VALUE_SEPARATOR$2)?tr.split(VALUE_SEPARATOR$2):[tr],ar=Object.fromEntries(Object.entries(rr).map(([ir,lr])=>[ir,lr.includes(VALUE_SEPARATOR$2)?lr.split(VALUE_SEPARATOR$2):lr]));(Ut=Lt.service)!==null&&Ut!==void 0||(Lt.service=[]),Lt.service.push(Object.assign(Object.assign({},ar),{id:`${xt}#${Qt}`,type:Xt,serviceEndpoint:nr}));break}case Wt.startsWith("typ"):{const{id:Jt}=DidDhtUtils$2.parseTxtDataToObject(zt.data);Ht.types=Jt.split(VALUE_SEPARATOR$2).map(Qt=>Number(Qt));break}case Wt.startsWith("did"):{const Jt=ar=>ar.split(VALUE_SEPARATOR$2).map(ir=>Vt.get(ir)).filter(ir=>typeof ir=="string"),{auth:Qt,asm:Xt,del:tr,inv:rr,agm:nr}=DidDhtUtils$2.parseTxtDataToObject(zt.data);Qt&&(Lt.authentication=Jt(Qt)),Xt&&(Lt.assertionMethod=Jt(Xt)),tr&&(Lt.capabilityDelegation=Jt(tr)),rr&&(Lt.capabilityInvocation=Jt(rr)),nr&&(Lt.keyAgreement=Jt(nr));break}}}return{didDocument:Lt,didDocumentMetadata:Ht,didResolutionMetadata:{}}})}static toDnsPacket(At){return __awaiter$1H(this,arguments,void 0,function*({didDocument:xt,didMetadata:Bt,authoritativeGatewayUris:Nt,previousDidProof:jt}){var Ut,Lt,Ht,Vt,zt;const Wt=[],Jt=[],Qt=new Map,Xt=[],tr=[];if(jt!==void 0){const{signature:ar,previousDid:ir}=jt;yield DidDhtUtils$2.validatePreviousDidProof({newDid:xt.id,previousDidProof:jt}),Wt.push({type:"TXT",name:"_prv._did.",ttl:DNS_RECORD_TTL$2,data:`id=${ir};s=${ar}`})}if(xt.alsoKnownAs&&Wt.push({type:"TXT",name:"_aka._did.",ttl:DNS_RECORD_TTL$2,data:xt.alsoKnownAs.join(VALUE_SEPARATOR$2)}),xt.controller){const ar=Array.isArray(xt.controller)?xt.controller.join(VALUE_SEPARATOR$2):xt.controller;Wt.push({type:"TXT",name:"_cnt._did.",ttl:DNS_RECORD_TTL$2,data:ar})}for(const[ar,ir]of(Lt=(Ut=xt.verificationMethod)===null||Ut===void 0?void 0:Ut.entries())!==null&&Lt!==void 0?Lt:[]){const lr=`k${ar}`;tr.push(lr);let yr=ir.id.split("#").pop();Qt.set(yr,lr);const Sr=ir.publicKeyJwk;if(!(Sr!=null&&Sr.crv&&Sr.crv in AlgorithmToKeyTypeMap$8))throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Verification method '${ir.id}' contains an unsupported key type: ${(Ht=Sr==null?void 0:Sr.crv)!==null&&Ht!==void 0?Ht:"undefined"}`);const Ar=DidDhtRegisteredKeyType$2[Sr.crv],Dr=yield DidDhtUtils$2.keyConverter(Sr.crv).publicKeyToBytes({publicKey:Sr}),Br=Convert$1.uint8Array(Dr).toBase64Url(),Lr=[`t=${Ar}`,`k=${Br}`];yr!=="0"&&(yield computeJwkThumbprint$2({jwk:Sr}))!==yr&&Lr.unshift(`id=${yr}`),Sr.alg!==KeyTypeToDefaultAlgorithmMap$2[Ar]&&Lr.push(`a=${Sr.alg}`),ir.controller!==xt.id&&Lr.push(`c=${ir.controller}`),Wt.push({type:"TXT",name:`_${lr}._did.`,ttl:DNS_RECORD_TTL$2,data:Lr.join(PROPERTY_SEPARATOR$2)})}(Vt=xt.service)===null||Vt===void 0||Vt.forEach((ar,ir)=>{const lr=`s${ir}`;Xt.push(lr);let{id:yr,type:Sr,serviceEndpoint:Ar}=ar,Dr=__rest$p(ar,["id","type","serviceEndpoint"]);yr=extractDidFragment$2(yr),Ar=Array.isArray(Ar)?Ar.join(","):Ar;const Lr=Object.entries(Object.assign({id:yr,t:Sr,se:Ar},Dr)).map(([vr,pr])=>`${vr}=${pr}`).join(PROPERTY_SEPARATOR$2),Or=DidDhtUtils$2.chunkDataIfNeeded(Lr);Wt.push({type:"TXT",name:`_${lr}._did.`,ttl:DNS_RECORD_TTL$2,data:Or})});const rr=[`v=${DID_DHT_SPECIFICATION_VERSION$2}`];if(tr.length&&rr.push(`vm=${tr.join(VALUE_SEPARATOR$2)}`),Object.keys(DidVerificationRelationship$2).forEach(ar=>{var ir;const lr=(ir=xt[ar])===null||ir===void 0?void 0:ir.map(yr=>Qt.get(yr.split("#").pop()));if(lr){const yr=DidDhtVerificationRelationship$2[ar];rr.push(`${yr}=${lr.join(VALUE_SEPARATOR$2)}`)}}),Xt.length&&rr.push(`svc=${Xt.join(VALUE_SEPARATOR$2)}`),!((zt=Bt.types)===null||zt===void 0)&&zt.length){const ir=Bt.types.map(lr=>typeof lr=="string"?DidDhtRegisteredDidType$2[lr]:lr);Wt.push({type:"TXT",name:"_typ._did.",ttl:DNS_RECORD_TTL$2,data:`id=${ir.join(VALUE_SEPARATOR$2)}`})}Wt.push({type:"TXT",name:"_did."+ro.getUniqueDidSuffix(xt.id)+".",ttl:DNS_RECORD_TTL$2,data:rr.join(PROPERTY_SEPARATOR$2)});for(const ar of Nt||[])Jt.push({type:"NS",name:"_did."+ro.getUniqueDidSuffix(xt.id)+".",ttl:DNS_RECORD_TTL$2,data:ar+"."});return{id:0,type:"response",flags:AUTHORITATIVE_ANSWER,answers:[...Wt,...Jt]}})}static getUniqueDidSuffix(At){return At.split(":")[2]}},DidDhtUtils$2=class Uo{static createBep44PutMessage(At){return __awaiter$1H(this,arguments,void 0,function*({dnsPacket:xt,publicKeyBytes:Bt,signer:Nt}){const jt=Math.ceil(Date.now()/1e3),Ut=encode$2(xt),Lt=bencode.encode({seq:jt,v:Ut}).subarray(1,-1);if(Lt.length>1e3)throw new DidError$2(DidErrorCode$2.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${Lt.length} bytes`);const Ht=yield Nt.sign({data:Lt});return{k:Bt,seq:jt,sig:Ht,v:Ut}})}static identifierToIdentityKey(At){return __awaiter$1H(this,arguments,void 0,function*({didUri:xt}){let Bt=Uo.identifierToIdentityKeyBytes({didUri:xt});return yield Ed25519$2.bytesToPublicKey({publicKeyBytes:Bt})})}static identifierToIdentityKeyBytes({didUri:At}){const xt=Did$2.parse(At);if(!xt)throw new DidError$2(DidErrorCode$2.InvalidDid,`Invalid DID URI: ${At}`);if(xt.method!==DidDht$2.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,`Method not supported: ${xt.method}`);let Bt;try{Bt=Convert$1.base32Z(xt.id).toUint8Array()}catch{throw new DidError$2(DidErrorCode$2.InvalidPublicKey,"Failed to decode method-specific identifier")}if(Bt.length!==32)throw new DidError$2(DidErrorCode$2.InvalidPublicKeyLength,`Invalid public key length: ${Bt.length}`);return Bt}static identityKeyToIdentifier(At){return __awaiter$1H(this,arguments,void 0,function*({identityKey:xt}){const Bt=yield Ed25519$2.publicKeyToBytes({publicKey:xt}),Nt=Convert$1.uint8Array(Bt).toBase32Z();return`did:${DidDht$2.methodName}:${Nt}`})}static keyConverter(At){const Bt={Ed25519:Ed25519$2,"P-256":{publicKeyToBytes:Nt=>__awaiter$1H(this,[Nt],void 0,function*({publicKey:jt}){const Ut=yield Secp256r1$2.publicKeyToBytes({publicKey:jt});return yield Secp256r1$2.compressPublicKey({publicKeyBytes:Ut})}),bytesToPublicKey:Secp256r1$2.bytesToPublicKey,privateKeyToBytes:Secp256r1$2.privateKeyToBytes,bytesToPrivateKey:Secp256r1$2.bytesToPrivateKey},secp256k1:{publicKeyToBytes:Nt=>__awaiter$1H(this,[Nt],void 0,function*({publicKey:jt}){const Ut=yield Secp256k1$2.publicKeyToBytes({publicKey:jt});return yield Secp256k1$2.compressPublicKey({publicKeyBytes:Ut})}),bytesToPublicKey:Secp256k1$2.bytesToPublicKey,privateKeyToBytes:Secp256k1$2.privateKeyToBytes,bytesToPrivateKey:Secp256k1$2.bytesToPrivateKey},X25519:X25519$2}[At];if(!Bt)throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static parseBep44GetMessage(At){return __awaiter$1H(this,arguments,void 0,function*({bep44Message:xt}){const Bt=yield Ed25519$2.bytesToPublicKey({publicKeyBytes:xt.k}),Nt=bencode.encode({seq:xt.seq,v:xt.v}).subarray(1,-1);if(!(yield Ed25519$2.verify({key:Bt,signature:xt.sig,data:Nt})))throw new DidError$2(DidErrorCode$2.InvalidSignature,"Invalid signature for DHT BEP44 message");return decode$1(xt.v)})}static parseTxtDataToObject(At){return this.parseTxtDataToString(At).split(PROPERTY_SEPARATOR$2).reduce((xt,Bt)=>{const[Nt,jt]=Bt.split("=");return xt[Nt]=jt,xt},{})}static parseTxtDataToString(At){if(typeof At=="string")return At;if(At instanceof Uint8Array)return Convert$1.uint8Array(At).toString();if(Array.isArray(At))return At.map(xt=>this.parseTxtDataToString(xt)).join("");throw new DidError$2(DidErrorCode$2.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(At){return __awaiter$1H(this,arguments,void 0,function*({newDid:xt,previousDidProof:Bt}){const Nt=yield Uo.identifierToIdentityKey({didUri:Bt.previousDid}),jt=Uo.identifierToIdentityKeyBytes({didUri:xt}),Ut=Convert$1.base64Url(Bt.signature).toUint8Array();if(!(yield Ed25519$2.verify({key:Nt,data:jt,signature:Ut})))throw new DidError$2(DidErrorCode$2.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(At){if(At.length<=255)return At;const xt=[];for(let Bt=0;Bt<At.length;Bt+=255)xt.push(At.slice(Bt,Bt+255));return xt}};const ErrorCode={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};class IonError extends Error{constructor(At,xt){super(`${At}: ${xt}`),this.code=At,Object.setPrototypeOf(this,new.target.prototype)}}class Encoder{static encode(At){return base64url$1.baseEncode(At)}static decodeAsBytes(At,xt){if(!Encoder.isBase64UrlString(At))throw new IonError(ErrorCode.EncodedStringIncorrectEncoding,`Given ${xt} must be base64url string.`);return base64url$1.baseDecode(At)}static decodeAsString(At,xt){const Bt=Encoder.decodeAsBytes(At,xt);return Encoder.bytesToString(Bt)}static isBase64UrlString(At){return/^[A-Za-z0-9_-]+$/.test(At)}static stringToBytes(At){return new TextEncoder().encode(At)}static bytesToString(At){return new TextDecoder().decode(At)}}var OperationKeyType;(function(kt){kt.Public="public",kt.Private="private"})(OperationKeyType||(OperationKeyType={}));const OperationKeyType$1=OperationKeyType;class InputValidator{static validateEs256kOperationKey(At,xt){const Bt=new Set(["kty","crv","x","y"]);xt===OperationKeyType$1.Private&&Bt.add("d");for(const Nt in At)if(!Bt.has(Nt))throw new IonError(ErrorCode.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${Nt}'.`);if(At.crv!=="secp256k1")throw new IonError(ErrorCode.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${At.crv}.'`);if(At.kty!=="EC")throw new IonError(ErrorCode.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${At.kty}.'`);if(At.x.length!==43)throw new IonError(ErrorCode.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(At.y.length!==43)throw new IonError(ErrorCode.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(xt===OperationKeyType$1.Private&&(At.d===void 0||At.d.length!==43))throw new IonError(ErrorCode.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(At){if(At.length>50)throw new IonError(ErrorCode.IdTooLong,`Key ID length ${At.length} exceed max allowed length of 50.`);if(!Encoder.isBase64UrlString(At))throw new IonError(ErrorCode.IdNotUsingBase64UrlCharacterSet,`Key ID '${At}' is not a Base64URL string.`)}static validatePublicKeyPurposes(At){if(At===void 0)return;const xt=new Set;for(const Bt of At){if(xt.has(Bt))throw new IonError(ErrorCode.PublicKeyPurposeDuplicated,`Public key purpose '${Bt}' already specified.`);xt.add(Bt)}}}class IonSdkConfig{}IonSdkConfig.hashAlgorithmInMultihashCode=18;IonSdkConfig.maxCanonicalizedDeltaSizeInBytes=1e3;var canonicalize$3=function kt(At){if(typeof At=="number"&&isNaN(At))throw new Error("NaN is not allowed");if(typeof At=="number"&&!isFinite(At))throw new Error("Infinity is not allowed");return At===null||typeof At!="object"?JSON.stringify(At):At.toJSON instanceof Function?kt(At.toJSON()):Array.isArray(At)?`[${At.reduce((Nt,jt,Ut)=>`${Nt}${Ut===0?"":","}${kt(jt===void 0||typeof jt=="symbol"?null:jt)}`,"")}]`:`{${Object.keys(At).sort().reduce((Bt,Nt)=>{if(At[Nt]===void 0||typeof At[Nt]=="symbol")return Bt;const jt=Bt.length===0?"":",";return`${Bt}${jt}${kt(Nt)}:${kt(At[Nt])}`},"")}}`};const canonicalize$4=getDefaultExportFromCjs(canonicalize$3);class JsonCanonicalizer{static canonicalizeAsBytes(At){const xt=JsonCanonicalizer.removeAllUndefinedProperties(At),Bt=canonicalize$4(xt);return Encoder.stringToBytes(Bt)}static removeAllUndefinedProperties(At){for(const xt in At)typeof At[xt]=="object"?JsonCanonicalizer.removeAllUndefinedProperties(At[xt]):At[xt]===void 0&&delete At[xt];return At}}var __awaiter$1G=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Multihash{static hash(At,xt){return __awaiter$1G(this,void 0,void 0,function*(){let Bt;switch(xt){case 18:Bt=(yield sha256$4.digest(At)).bytes;break;default:throw new IonError(ErrorCode.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${xt} is not supported.`)}return Bt})}static hashAsNonMultihashBytes(At,xt){return __awaiter$1G(this,void 0,void 0,function*(){let Bt;switch(xt){case 18:Bt=yield sha256$4.encode(At);break;default:throw new IonError(ErrorCode.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${xt} is not supported.`)}return Bt})}static canonicalizeThenHashThenEncode(At,xt){return __awaiter$1G(this,void 0,void 0,function*(){const Bt=JsonCanonicalizer.canonicalizeAsBytes(At);return yield Multihash.hashThenEncode(Bt,xt)})}static canonicalizeThenDoubleHashThenEncode(At,xt){return __awaiter$1G(this,void 0,void 0,function*(){const Bt=JsonCanonicalizer.canonicalizeAsBytes(At),Nt=yield Multihash.hashAsNonMultihashBytes(Bt,xt);return yield Multihash.hashThenEncode(Nt,xt)})}static hashThenEncode(At,xt){return __awaiter$1G(this,void 0,void 0,function*(){const Bt=yield Multihash.hash(At,xt);return Encoder.encode(Bt)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(At,xt){let Bt;const Nt=Encoder.decodeAsBytes(At,xt);try{Bt=decode$c(Nt)}catch{throw new IonError(ErrorCode.MultihashStringNotAMultihash,`Given ${xt} string '${At}' is not a multihash after decoding.`)}const jt=IonSdkConfig.hashAlgorithmInMultihashCode;if(jt!==Bt.code)throw new IonError(ErrorCode.MultihashUnsupportedHashAlgorithm,`Given ${xt} uses unsupported multihash algorithm with code ${Bt.code}, should use ${jt} or change IonSdkConfig to desired hashing algorithm.`)}}var OperationType;(function(kt){kt.Create="create",kt.Update="update",kt.Deactivate="deactivate",kt.Recover="recover"})(OperationType||(OperationType={}));const OperationType$1=OperationType;var PatchAction;(function(kt){kt.Replace="replace",kt.AddPublicKeys="add-public-keys",kt.RemovePublicKeys="remove-public-keys",kt.AddServices="add-services",kt.RemoveServices="remove-services"})(PatchAction||(PatchAction={}));const PatchAction$1=PatchAction;var __awaiter$1F=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class IonRequest{static createCreateRequest(At){return __awaiter$1F(this,void 0,void 0,function*(){const xt=At.recoveryKey,Bt=At.updateKey,Nt=At.document.publicKeys,jt=At.document.services;InputValidator.validateEs256kOperationKey(xt,OperationKeyType$1.Public),InputValidator.validateEs256kOperationKey(Bt,OperationKeyType$1.Public),IonRequest.validateDidDocumentKeys(Nt),IonRequest.validateServices(jt);const Ut=IonSdkConfig.hashAlgorithmInMultihashCode,Lt=[{action:PatchAction$1.Replace,document:At.document}],Ht={updateCommitment:yield Multihash.canonicalizeThenDoubleHashThenEncode(Bt,Ut),patches:Lt};IonRequest.validateDeltaSize(Ht);const zt={deltaHash:yield Multihash.canonicalizeThenHashThenEncode(Ht,Ut),recoveryCommitment:yield Multihash.canonicalizeThenDoubleHashThenEncode(xt,Ut)};return{type:OperationType$1.Create,suffixData:zt,delta:Ht}})}static createDeactivateRequest(At){return __awaiter$1F(this,void 0,void 0,function*(){IonRequest.validateDidSuffix(At.didSuffix),InputValidator.validateEs256kOperationKey(At.recoveryPublicKey,OperationKeyType$1.Public);const xt=IonSdkConfig.hashAlgorithmInMultihashCode,Bt=yield Multihash.canonicalizeThenHashThenEncode(At.recoveryPublicKey,xt),Nt={didSuffix:At.didSuffix,recoveryKey:At.recoveryPublicKey},jt=yield At.signer.sign({alg:"ES256K"},Nt);return{type:OperationType$1.Deactivate,didSuffix:At.didSuffix,revealValue:Bt,signedData:jt}})}static createRecoverRequest(At){return __awaiter$1F(this,void 0,void 0,function*(){IonRequest.validateDidSuffix(At.didSuffix),InputValidator.validateEs256kOperationKey(At.recoveryPublicKey,OperationKeyType$1.Public),InputValidator.validateEs256kOperationKey(At.nextRecoveryPublicKey,OperationKeyType$1.Public),InputValidator.validateEs256kOperationKey(At.nextUpdatePublicKey,OperationKeyType$1.Public),IonRequest.validateDidDocumentKeys(At.document.publicKeys),IonRequest.validateServices(At.document.services);const xt=IonSdkConfig.hashAlgorithmInMultihashCode,Bt=yield Multihash.canonicalizeThenHashThenEncode(At.recoveryPublicKey,xt),Nt=[{action:PatchAction$1.Replace,document:At.document}],jt=yield Multihash.canonicalizeThenDoubleHashThenEncode(At.nextUpdatePublicKey,xt),Ut={patches:Nt,updateCommitment:jt},Lt=yield Multihash.canonicalizeThenHashThenEncode(Ut,xt),Vt={recoveryCommitment:yield Multihash.canonicalizeThenDoubleHashThenEncode(At.nextRecoveryPublicKey,xt),recoveryKey:At.recoveryPublicKey,deltaHash:Lt},zt=yield At.signer.sign({alg:"ES256K"},Vt);return{type:OperationType$1.Recover,didSuffix:At.didSuffix,revealValue:Bt,delta:Ut,signedData:zt}})}static createUpdateRequest(At){return __awaiter$1F(this,void 0,void 0,function*(){if(IonRequest.validateDidSuffix(At.didSuffix),InputValidator.validateEs256kOperationKey(At.updatePublicKey,OperationKeyType$1.Public),InputValidator.validateEs256kOperationKey(At.nextUpdatePublicKey,OperationKeyType$1.Public),IonRequest.validateServices(At.servicesToAdd),IonRequest.validateDidDocumentKeys(At.publicKeysToAdd),At.idsOfServicesToRemove!==void 0)for(const Xt of At.idsOfServicesToRemove)InputValidator.validateId(Xt);if(At.idsOfPublicKeysToRemove!==void 0)for(const Xt of At.idsOfPublicKeysToRemove)InputValidator.validateId(Xt);const xt=[],Bt=At.servicesToAdd;if(Bt!==void 0&&Bt.length>0){const Xt={action:PatchAction$1.AddServices,services:Bt};xt.push(Xt)}const Nt=At.idsOfServicesToRemove;if(Nt!==void 0&&Nt.length>0){const Xt={action:PatchAction$1.RemoveServices,ids:Nt};xt.push(Xt)}const jt=At.publicKeysToAdd;if(jt!==void 0&&jt.length>0){const Xt={action:PatchAction$1.AddPublicKeys,publicKeys:jt};xt.push(Xt)}const Ut=At.idsOfPublicKeysToRemove;if(Ut!==void 0&&Ut.length>0){const Xt={action:PatchAction$1.RemovePublicKeys,ids:Ut};xt.push(Xt)}const Lt=IonSdkConfig.hashAlgorithmInMultihashCode,Ht=yield Multihash.canonicalizeThenHashThenEncode(At.updatePublicKey,Lt),Vt=yield Multihash.canonicalizeThenDoubleHashThenEncode(At.nextUpdatePublicKey,Lt),zt={patches:xt,updateCommitment:Vt},Wt=yield Multihash.canonicalizeThenHashThenEncode(zt,Lt),Jt={updateKey:At.updatePublicKey,deltaHash:Wt},Qt=yield At.signer.sign({alg:"ES256K"},Jt);return{type:OperationType$1.Update,didSuffix:At.didSuffix,revealValue:Ht,delta:zt,signedData:Qt}})}static validateDidSuffix(At){Multihash.validateEncodedHashComputedUsingSupportedHashAlgorithm(At,"didSuffix")}static validateDidDocumentKeys(At){if(At===void 0)return;const xt=new Set;for(const Bt of At){if(Array.isArray(Bt.publicKeyJwk))throw new IonError(ErrorCode.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(InputValidator.validateId(Bt.id),xt.has(Bt.id))throw new IonError(ErrorCode.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${Bt.id}' already exists.`);xt.add(Bt.id),InputValidator.validatePublicKeyPurposes(Bt.purposes)}}static validateServices(At){if(At!==void 0&&At.length!==0){const xt=new Set;for(const Bt of At){if(IonRequest.validateService(Bt),xt.has(Bt.id))throw new IonError(ErrorCode.DidDocumentServiceIdDuplicated,"Service id has to be unique");xt.add(Bt.id)}}}static validateService(At){InputValidator.validateId(At.id);const xt=30;if(At.type.length>xt){const Bt=`Service endpoint type length ${At.type.length} exceeds max allowed length of ${xt}.`;throw new IonError(ErrorCode.ServiceTypeTooLong,Bt)}if(Array.isArray(At.serviceEndpoint)){const Bt="Service endpoint value cannot be an array.";throw new IonError(ErrorCode.ServiceEndpointCannotBeAnArray,Bt)}if(typeof At.serviceEndpoint=="string"&&uri_allExports.parse(At.serviceEndpoint).error!==void 0)throw new IonError(ErrorCode.ServiceEndpointStringNotValidUri,`Service endpoint string '${At.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(At){const xt=JsonCanonicalizer.canonicalizeAsBytes(At);if(xt.length>IonSdkConfig.maxCanonicalizedDeltaSizeInBytes){const Bt=`Delta of ${xt.length} bytes exceeded limit of ${IonSdkConfig.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new IonError(ErrorCode.DeltaExceedsMaximumSize,Bt)}}}var __awaiter$1E=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class IonDid{static createLongFormDid(At){return __awaiter$1E(this,void 0,void 0,function*(){const xt=yield IonRequest.createCreateRequest(At),Bt=yield IonDid.computeDidUniqueSuffix(xt.suffixData);let Nt;IonSdkConfig.network===void 0||IonSdkConfig.network==="mainnet"?Nt=`did:ion:${Bt}`:Nt=`did:ion:${IonSdkConfig.network}:${Bt}`;const jt={suffixData:xt.suffixData,delta:xt.delta},Ut=JsonCanonicalizer.canonicalizeAsBytes(jt),Lt=Encoder.encode(Ut);return`${Nt}:${Lt}`})}static computeDidUniqueSuffix(At){return __awaiter$1E(this,void 0,void 0,function*(){const xt=JsonCanonicalizer.canonicalizeAsBytes(At),Bt=yield Multihash.hash(xt,IonSdkConfig.hashAlgorithmInMultihashCode);return Encoder.encode(Bt)})}}var IonNetwork;(function(kt){kt.Mainnet="mainnet",kt.Testnet="test"})(IonNetwork||(IonNetwork={}));var IonPublicKeyPurpose;(function(kt){kt.Authentication="authentication",kt.AssertionMethod="assertionMethod",kt.CapabilityInvocation="capabilityInvocation",kt.CapabilityDelegation="capabilityDelegation",kt.KeyAgreement="keyAgreement"})(IonPublicKeyPurpose||(IonPublicKeyPurpose={}));var __awaiter$1D=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidIonRegisteredKeyType$2;(function(kt){kt.Ed25519="Ed25519",kt.secp256k1="secp256k1",kt.secp256r1="secp256r1",kt.X25519="X25519"})(DidIonRegisteredKeyType$2||(DidIonRegisteredKeyType$2={}));const AlgorithmToKeyTypeMap$7={Ed25519:DidIonRegisteredKeyType$2.Ed25519,ES256K:DidIonRegisteredKeyType$2.secp256k1,ES256:DidIonRegisteredKeyType$2.secp256r1,"P-256":DidIonRegisteredKeyType$2.secp256r1,secp256k1:DidIonRegisteredKeyType$2.secp256k1,secp256r1:DidIonRegisteredKeyType$2.secp256r1},DEFAULT_GATEWAY_URI$4="https://ion.tbd.engineering";let DidIon$2=class So extends DidMethod$2{static create(){return __awaiter$1D(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$3,options:xt={}}={}){var Bt,Nt,jt,Ut,Lt,Ht,Vt;if(!((Bt=xt.verificationMethods)===null||Bt===void 0)&&Bt.some(yr=>!(yr.algorithm in AlgorithmToKeyTypeMap$7)))throw new Error("One or more verification method algorithms are not supported");const zt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt.filter(yr=>"id"in yr).map(yr=>yr.id);if(zt&&zt.length!==new Set(zt).size)throw new Error("One or more verification method IDs are not unique");if(!((jt=xt.services)===null||jt===void 0)&&jt.some(yr=>!yr.id||!yr.type||!yr.serviceEndpoint))throw new Error("One or more services are missing required properties");const Wt={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},Jt=[];for(const yr of(Ut=xt.verificationMethods)!==null&&Ut!==void 0?Ut:[Wt]){const Sr=yield At.generateKey({algorithm:yr.algorithm}),Ar=yield At.getPublicKey({keyUri:Sr});Jt.push({id:yr.id,publicKeyJwk:Ar,purposes:(Lt=yr.purposes)!==null&&Lt!==void 0?Lt:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const Qt=yield At.generateKey({algorithm:DidIonRegisteredKeyType$2.secp256k1}),Xt=yield At.getPublicKey({keyUri:Qt}),tr=yield At.generateKey({algorithm:DidIonRegisteredKeyType$2.secp256k1}),rr=yield At.getPublicKey({keyUri:tr}),nr=yield DidIonUtils$2.computeLongFormDidUri({recoveryKey:Xt,updateKey:rr,services:(Ht=xt.services)!==null&&Ht!==void 0?Ht:[],verificationMethods:Jt}),{didDocument:ar,didResolutionMetadata:ir}=yield So.resolve(nr,{gatewayUri:xt.gatewayUri});if(ar===null)throw new Error(`Unable to resolve DID during creation: ${ir==null?void 0:ir.error}`);const lr=new BearerDid$2({uri:nr,document:ar,metadata:{published:!1,canonicalId:nr.split(":",3).join(":"),recoveryKey:Xt,updateKey:rr},keyManager:At});if(!((Vt=xt.publish)!==null&&Vt!==void 0)||Vt){const yr=yield So.publish({did:lr,gatewayUri:xt.gatewayUri});lr.metadata=yr.didDocumentMetadata}return lr})}static getSigningMethod(At){return __awaiter$1D(this,arguments,void 0,function*({didDocument:xt,methodId:Bt}){var Nt;const jt=Did$2.parse(xt.id);if(jt&&jt.method!==this.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,`Method not supported: ${jt.method}`);const Ut=(Nt=xt.verificationMethod)===null||Nt===void 0?void 0:Nt.find(Lt=>{var Ht;return Lt.id===(Bt??((Ht=xt.assertionMethod)===null||Ht===void 0?void 0:Ht[0]))});if(!(Ut&&Ut.publicKeyJwk))throw new DidError$2(DidErrorCode$2.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static import(At){return __awaiter$1D(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$3}){const Nt=Did$2.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==So.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,"Method not supported");return yield BearerDid$2.import({portableDid:xt,keyManager:Bt})})}static publish(At){return __awaiter$1D(this,arguments,void 0,function*({did:xt,gatewayUri:Bt=DEFAULT_GATEWAY_URI$4}){var Nt,jt,Ut;const Lt=(jt=(Nt=xt.document.verificationMethod)===null||Nt===void 0?void 0:Nt.map(zt=>({id:zt.id,publicKeyJwk:zt.publicKeyJwk,purposes:getVerificationRelationshipsById$2({didDocument:xt.document,methodId:zt.id})})))!==null&&jt!==void 0?jt:[],Ht=yield DidIonUtils$2.createIonDocument({services:(Ut=xt.document.service)!==null&&Ut!==void 0?Ut:[],verificationMethods:Lt}),Vt=yield DidIonUtils$2.constructCreateRequest({ionDocument:Ht,recoveryKey:xt.metadata.recoveryKey,updateKey:xt.metadata.updateKey});try{const zt=DidIonUtils$2.appendPathToUrl({baseUrl:Bt,path:"/operations"}),Wt=yield fetch(zt,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(Vt)});return{didDocument:xt.document,didDocumentMetadata:Object.assign(Object.assign({},xt.metadata),{published:Wt.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:DidErrorCode$2.InternalError,errorMessage:`Failed to publish DID document for: ${xt.uri}`}}}})}static resolve(At){return __awaiter$1D(this,arguments,void 0,function*(xt,Bt={}){var Nt,jt;const Ut=Did$2.parse(xt);if(!Ut)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"invalidDid"}});if(Ut.method!==So.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"methodNotSupported"}});const Lt=(Nt=Bt==null?void 0:Bt.gatewayUri)!==null&&Nt!==void 0?Nt:DEFAULT_GATEWAY_URI$4;try{const Ht=DidIonUtils$2.appendPathToUrl({baseUrl:Lt,path:`/identifiers/${xt}`}),Vt=yield fetch(Ht);if(!Vt.ok)throw new DidError$2(DidErrorCode$2.NotFound,`Unable to find DID document for: ${xt}`);const{didDocument:zt,didDocumentMetadata:Wt}=yield Vt.json();return Object.assign(Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),zt&&{didDocument:zt}),{didDocumentMetadata:Object.assign({published:(jt=Wt==null?void 0:Wt.method)===null||jt===void 0?void 0:jt.published},Wt)})}catch(Ht){if(!(Ht instanceof DidError$2))throw new Error(Ht);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:Object.assign({error:Ht.code},Ht.message&&{errorMessage:Ht.message})})}})}};DidIon$2.methodName="ion";let DidIonUtils$2=class no{static appendPathToUrl({baseUrl:At,path:xt}){const Bt=new URL(At);return Bt.pathname=Bt.pathname.endsWith("/")?Bt.pathname:Bt.pathname+"/",Bt.pathname+=xt.startsWith("/")?xt.substring(1):xt,Bt.toString()}static computeLongFormDidUri(At){return __awaiter$1D(this,arguments,void 0,function*({recoveryKey:xt,updateKey:Bt,services:Nt,verificationMethods:jt}){const Ut=yield no.createIonDocument({services:Nt,verificationMethods:jt}),Lt=no.normalizeJwk(xt),Ht=no.normalizeJwk(Bt);return yield IonDid.createLongFormDid({document:Ut,recoveryKey:Lt,updateKey:Ht})})}static constructCreateRequest(At){return __awaiter$1D(this,arguments,void 0,function*({ionDocument:xt,recoveryKey:Bt,updateKey:Nt}){return yield IonRequest.createCreateRequest({document:xt,recoveryKey:no.normalizeJwk(Bt),updateKey:no.normalizeJwk(Nt)})})}static createIonDocument(At){return __awaiter$1D(this,arguments,void 0,function*({services:xt,verificationMethods:Bt}){var Nt,jt;const Ut=[];for(const Vt of Bt){let zt=(jt=(Nt=Vt.id)!==null&&Nt!==void 0?Nt:Vt.publicKeyJwk.kid)!==null&&jt!==void 0?jt:yield computeJwkThumbprint$2({jwk:Vt.publicKeyJwk});zt=`${zt.split("#").pop()}`;const Wt={id:zt,publicKeyJwk:no.normalizeJwk(Vt.publicKeyJwk),purposes:Vt.purposes,type:"JsonWebKey2020"};Ut.push(Wt)}const Lt=xt.map(Vt=>Object.assign(Object.assign({},Vt),{id:`${Vt.id.split("#").pop()}`}));return{publicKeys:Ut,services:Lt}})}static normalizeJwk(At){const xt=At.kty;let Bt;if(xt==="EC")Bt={crv:At.crv,kty:At.kty,x:At.x,y:At.y};else if(xt==="oct")Bt={k:At.k,kty:At.kty};else if(xt==="OKP")Bt={crv:At.crv,kty:At.kty,x:At.x};else if(xt==="RSA")Bt={e:At.e,kty:At.kty,n:At.n};else throw new Error(`Unsupported key type: ${xt}`);return Bt}};var __awaiter$1C=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidJwk$2=class Eo extends DidMethod$2{static create(){return __awaiter$1C(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$3,options:xt={}}={}){var Bt,Nt,jt,Ut;if(xt.algorithm&&xt.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(xt.verificationMethods&&xt.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const Lt=(Ut=(Bt=xt.algorithm)!==null&&Bt!==void 0?Bt:(jt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt[0])===null||jt===void 0?void 0:jt.algorithm)!==null&&Ut!==void 0?Ut:"Ed25519",Ht=yield At.generateKey({algorithm:Lt}),Vt=yield At.getPublicKey({keyUri:Ht}),zt=Convert$1.object(Vt).toBase64Url(),Wt=`did:${Eo.methodName}:${zt}`,Qt=(yield Eo.resolve(Wt)).didDocument;return new BearerDid$2({uri:Wt,document:Qt,metadata:{},keyManager:At})})}static getSigningMethod(At){return __awaiter$1C(this,arguments,void 0,function*({didDocument:xt}){var Bt;const Nt=Did$2.parse(xt.id);if(Nt&&Nt.method!==this.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,`Method not supported: ${Nt.method}`);const[jt]=(Bt=xt.verificationMethod)!==null&&Bt!==void 0?Bt:[];if(!(jt&&jt.publicKeyJwk))throw new DidError$2(DidErrorCode$2.InternalError,"A verification method intended for signing could not be determined from the DID Document");return jt})}static import(At){return __awaiter$1C(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$3}){const Nt=Did$2.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==Eo.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,"Method not supported");const jt=yield BearerDid$2.import({portableDid:xt,keyManager:Bt});if(jt.document.verificationMethod.length!==1)throw new DidError$2(DidErrorCode$2.InvalidDidDocument,"DID document must contain exactly one verification method");return jt})}static resolve(At,xt){return __awaiter$1C(this,void 0,void 0,function*(){const Bt=Did$2.parse(At);let Nt;try{Nt=Convert$1.base64Url(Bt.id).toObject()}catch{}if(!Bt||!Nt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"invalidDid"}});if(Bt.method!==Eo.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"methodNotSupported"}});const jt={"@context":["https://www.w3.org/ns/did/v1"],id:Bt.uri},Ut=`${jt.id}#0`;switch(jt.verificationMethod=[{id:Ut,type:"JsonWebKey",controller:jt.id,publicKeyJwk:Nt}],jt.authentication=[Ut],jt.assertionMethod=[Ut],jt.capabilityInvocation=[Ut],jt.capabilityDelegation=[Ut],jt.keyAgreement=[Ut],Nt.use){case"sig":{delete jt.keyAgreement;break}case"enc":{delete jt.authentication,delete jt.assertionMethod,delete jt.capabilityInvocation,delete jt.capabilityDelegation;break}}return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didDocument:jt})})}};DidJwk$2.methodName="jwk";var __awaiter$1B=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidKeyRegisteredKeyType$2;(function(kt){kt.Ed25519="Ed25519",kt.secp256k1="secp256k1",kt.secp256r1="secp256r1",kt.X25519="X25519"})(DidKeyRegisteredKeyType$2||(DidKeyRegisteredKeyType$2={}));const DidKeyVerificationMethodType$2={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},AlgorithmToKeyTypeMap$6={Ed25519:DidKeyRegisteredKeyType$2.Ed25519,ES256K:DidKeyRegisteredKeyType$2.secp256k1,ES256:DidKeyRegisteredKeyType$2.secp256r1,"P-256":DidKeyRegisteredKeyType$2.secp256r1,secp256k1:DidKeyRegisteredKeyType$2.secp256k1,secp256r1:DidKeyRegisteredKeyType$2.secp256r1,X25519:DidKeyRegisteredKeyType$2.X25519};let DidKey$2=class Fi extends DidMethod$2{static create(){return __awaiter$1B(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$3,options:xt={}}={}){var Bt,Nt,jt,Ut;if(xt.algorithm&&xt.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(xt.verificationMethods&&xt.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const Lt=(Ut=(Bt=xt.algorithm)!==null&&Bt!==void 0?Bt:(jt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt[0])===null||jt===void 0?void 0:jt.algorithm)!==null&&Ut!==void 0?Ut:"Ed25519",Ht=yield At.generateKey({algorithm:Lt}),Vt=yield At.getPublicKey({keyUri:Ht}),zt=yield DidKeyUtils$2.publicKeyToMultibaseId({publicKey:Vt}),Wt=`did:${Fi.methodName}:${zt}`,Qt=(yield Fi.resolve(Wt,xt)).didDocument;return new BearerDid$2({uri:Wt,document:Qt,metadata:{},keyManager:At})})}static getSigningMethod(At){return __awaiter$1B(this,arguments,void 0,function*({didDocument:xt}){var Bt;const Nt=Did$2.parse(xt.id);if(Nt&&Nt.method!==this.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,`Method not supported: ${Nt.method}`);const[jt]=xt.assertionMethod||[],Ut=(Bt=xt.verificationMethod)===null||Bt===void 0?void 0:Bt.find(Lt=>Lt.id===jt);if(!(Ut&&Ut.publicKeyJwk))throw new DidError$2(DidErrorCode$2.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static import(At){return __awaiter$1B(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$3}){const Nt=Did$2.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==Fi.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,"Method not supported");const jt=yield BearerDid$2.import({portableDid:xt,keyManager:Bt});if(jt.document.verificationMethod.length!==1)throw new DidError$2(DidErrorCode$2.InvalidDidDocument,"DID document must contain exactly one verification method");return jt})}static resolve(At,xt){return __awaiter$1B(this,void 0,void 0,function*(){try{const Bt=yield Fi.createDocument({didUri:At,options:xt});return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didDocument:Bt})}catch(Bt){if(!(Bt instanceof DidError$2))throw new Error(Bt);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:Object.assign({error:Bt.code},Bt.message&&{errorMessage:Bt.message})})}})}static createDocument(At){return __awaiter$1B(this,arguments,void 0,function*({didUri:xt,options:Bt={}}){const{defaultContext:Nt="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:jt=!1,enableExperimentalPublicKeyTypes:Ut=!1,publicKeyFormat:Lt="JsonWebKey2020"}=Bt,Ht={id:""},Vt=Did$2.parse(xt);if(!Vt)throw new DidError$2(DidErrorCode$2.InvalidDid,`Invalid DID URI: ${xt}`);const zt=Vt.id;if(Vt.method!==Fi.methodName)throw new DidError$2(DidErrorCode$2.MethodNotSupported,`Method not supported: ${Vt.method}`);if(!Fi.validateIdentifier(Vt))throw new DidError$2(DidErrorCode$2.InvalidDid,`Invalid DID URI: ${xt}`);const Wt=yield Fi.createSignatureMethod({didUri:xt,multibaseValue:zt,options:{enableExperimentalPublicKeyTypes:Ut,publicKeyFormat:Lt}});if(Ht.id=Vt.uri,Ht.verificationMethod=[Wt],Ht.authentication=[Wt.id],Ht.assertionMethod=[Wt.id],Ht.capabilityInvocation=[Wt.id],Ht.capabilityDelegation=[Wt.id],jt===!0){const Xt=Lt==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",tr=yield this.createEncryptionMethod({didUri:xt,multibaseValue:zt,options:{enableExperimentalPublicKeyTypes:Ut,publicKeyFormat:Xt}});Ht.verificationMethod.push(tr),Ht.keyAgreement=[tr.id]}const Jt=[Nt];return getVerificationMethodTypes$2({didDocument:Ht}).forEach(Xt=>{const tr=DidKeyVerificationMethodType$2[Xt];Jt.push(tr)}),Ht["@context"]=Jt,Ht})}static createEncryptionMethod(At){return __awaiter$1B(this,arguments,void 0,function*({didUri:xt,multibaseValue:Bt,options:Nt}){const{enableExperimentalPublicKeyTypes:jt,publicKeyFormat:Ut}=Nt,Lt={id:"",type:"",controller:""},{keyBytes:Ht,multicodecCode:Vt}=yield Fi.deriveEncryptionKey({multibaseValue:Bt}),zt=Ht.byteLength,Wt=DidKeyUtils$2.MULTICODEC_PUBLIC_KEY_LENGTH[Vt];if(zt!==Wt)throw new DidError$2(DidErrorCode$2.InvalidPublicKeyLength,`Expected ${zt} bytes. Actual: ${Wt}`);const Jt=keyBytesToMultibaseId$2({keyBytes:Ht,multicodecCode:Vt});Lt.id=`${xt}#${Jt}`;try{new URL(Lt.id)}catch{throw new DidError$2(DidErrorCode$2.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(Ut in DidKeyVerificationMethodType$2))throw new DidError$2(DidErrorCode$2.UnsupportedPublicKeyType,`Unsupported format: ${Ut}`);if(jt===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(Ut))throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Specified '${Ut}' without setting enableExperimentalPublicKeyTypes to true.`);if(Lt.type=Ut,Lt.controller=xt,Ut==="X25519KeyAgreementKey2020"&&(Lt.publicKeyMultibase=Jt),Ut==="JsonWebKey2020"){const{crv:Xt}=yield DidKeyUtils$2.multicodecToJwk({code:Vt});Lt.publicKeyJwk=yield DidKeyUtils$2.keyConverter(Xt).bytesToPublicKey({publicKeyBytes:Ht})}return Lt})}static createSignatureMethod(At){return __awaiter$1B(this,arguments,void 0,function*({didUri:xt,multibaseValue:Bt,options:Nt}){const{enableExperimentalPublicKeyTypes:jt,publicKeyFormat:Ut}=Nt,Lt={id:"",type:"",controller:""},{keyBytes:Ht,multicodecCode:Vt,multicodecName:zt}=multibaseIdToKeyBytes$2({multibaseKeyId:Bt}),Wt=Ht.byteLength,Jt=DidKeyUtils$2.MULTICODEC_PUBLIC_KEY_LENGTH[Vt];if(Wt!==Jt)throw new DidError$2(DidErrorCode$2.InvalidPublicKeyLength,`Expected ${Wt} bytes. Actual: ${Jt}`);let Qt=!1;switch(zt){case"secp256k1-pub":Qt=yield Secp256k1$2.validatePublicKey({publicKeyBytes:Ht});break;case"ed25519-pub":Qt=yield Ed25519$2.validatePublicKey({publicKeyBytes:Ht});break;case"x25519-pub":Qt=!0;break}if(!Qt)throw new DidError$2(DidErrorCode$2.InvalidPublicKey,"Invalid public key detected.");Lt.id=`${xt}#${Bt}`;try{new URL(Lt.id)}catch{throw new DidError$2(DidErrorCode$2.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(Ut in DidKeyVerificationMethodType$2))throw new DidError$2(DidErrorCode$2.UnsupportedPublicKeyType,`Unsupported format: ${Ut}`);if(jt===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(Ut))throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Specified '${Ut}' without setting enableExperimentalPublicKeyTypes to true.`);if(Lt.type=Ut,Lt.controller=xt,Ut==="Ed25519VerificationKey2020"&&(Lt.publicKeyMultibase=Bt),Ut==="JsonWebKey2020"){const{crv:tr}=yield DidKeyUtils$2.multicodecToJwk({code:Vt});Lt.publicKeyJwk=yield DidKeyUtils$2.keyConverter(tr).bytesToPublicKey({publicKeyBytes:Ht})}return Lt})}static deriveEncryptionKey(At){return __awaiter$1B(this,arguments,void 0,function*({multibaseValue:xt}){let Bt={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:Nt,multicodecCode:jt}=multibaseIdToKeyBytes$2({multibaseKeyId:xt});if(jt===237){const Ut=yield DidKeyUtils$2.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:Nt}),Lt=yield Ed25519$2.convertPublicKeyToX25519({publicKey:Ut});Bt={keyBytes:yield DidKeyUtils$2.keyConverter("Ed25519").publicKeyToBytes({publicKey:Lt}),multicodecCode:236}}return Bt})}static validateIdentifier(At){const{method:xt,id:Bt}=At,[Nt]=At.uri.split(":",1);return Nt==="did"&&xt==="key"&&Number("1")>0&&universalTypeOf$1(Bt)==="String"&&Bt.startsWith("z")}};DidKey$2.methodName="key";let DidKeyUtils$2=class mo{static jwkToMulticodec(At){return __awaiter$1B(this,arguments,void 0,function*({jwk:xt}){const Bt=[];xt.crv&&(Bt.push(xt.crv),xt.d?Bt.push("private"):Bt.push("public"));const Nt=Bt.join(":"),jt=mo.JWK_TO_MULTICODEC[Nt];if(jt===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${Nt}'`);return{code:Multicodec$1.getCodeFromName({name:jt}),name:jt}})}static keyCompressor(At){const Bt={"P-256":Secp256r1$2.compressPublicKey,secp256k1:Secp256k1$2.compressPublicKey}[At];if(!Bt)throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static keyConverter(At){const Bt={Ed25519:Ed25519$2,"P-256":Secp256r1$2,secp256k1:Secp256k1$2,X25519:X25519$2}[At];if(!Bt)throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static multicodecToJwk(At){return __awaiter$1B(this,arguments,void 0,function*({code:xt,name:Bt}){if(!(Bt?!xt:xt))throw new Error("Either 'name' or 'code' must be defined, but not both.");Bt=Bt===void 0?Multicodec$1.getNameFromCode({code:xt}):Bt;const Nt=Bt,jt=mo.MULTICODEC_TO_JWK[Nt];if(jt===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},jt)})}static publicKeyToMultibaseId(At){return __awaiter$1B(this,arguments,void 0,function*({publicKey:xt}){var Bt;if(!(xt!=null&&xt.crv&&xt.crv in AlgorithmToKeyTypeMap$6))throw new DidError$2(DidErrorCode$2.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(Bt=xt==null?void 0:xt.crv)!==null&&Bt!==void 0?Bt:"undefined"}`);let Nt=yield mo.keyConverter(xt.crv).publicKeyToBytes({publicKey:xt});/^(secp256k1|P-256|P-384|P-521)$/.test(xt.crv)&&(Nt=yield mo.keyCompressor(xt.crv)({publicKeyBytes:Nt}));const{name:jt}=yield mo.jwkToMulticodec({jwk:xt});return keyBytesToMultibaseId$2({keyBytes:Nt,multicodecName:jt})})}};DidKeyUtils$2.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};DidKeyUtils$2.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};DidKeyUtils$2.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var __awaiter$1A=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidWeb$2=class hs extends DidMethod$2{static resolve(At,xt){return __awaiter$1A(this,void 0,void 0,function*(){const Bt=Did$2.parse(At);if(!Bt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"invalidDid"}});if(Bt.method!==hs.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"methodNotSupported"}});let Nt=`https://${Bt.id.replace(/:/g,"/")}`;Nt=decodeURIComponent(Nt);const jt=Bt.id.includes(":")?`${Nt}/did.json`:`${Nt}/.well-known/did.json`;try{const Ut=yield fetch(jt);if(!Ut.ok)throw new Error("HTTP error status code returned");const Lt=yield Ut.json();return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didDocument:Lt})}catch{return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:"notFound"}})}})}};DidWeb$2.methodName="web";var s$1=1e3,m=s$1*60,h=m*60,d=h*24,w=d*7,y=d*365.25,ms=function(kt,At){At=At||{};var xt=typeof kt;if(xt==="string"&&kt.length>0)return parse(kt);if(xt==="number"&&isFinite(kt))return At.long?fmtLong(kt):fmtShort(kt);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(kt))};function parse(kt){if(kt=String(kt),!(kt.length>100)){var At=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(kt);if(At){var xt=parseFloat(At[1]),Bt=(At[2]||"ms").toLowerCase();switch(Bt){case"years":case"year":case"yrs":case"yr":case"y":return xt*y;case"weeks":case"week":case"w":return xt*w;case"days":case"day":case"d":return xt*d;case"hours":case"hour":case"hrs":case"hr":case"h":return xt*h;case"minutes":case"minute":case"mins":case"min":case"m":return xt*m;case"seconds":case"second":case"secs":case"sec":case"s":return xt*s$1;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return xt;default:return}}}}function fmtShort(kt){var At=Math.abs(kt);return At>=d?Math.round(kt/d)+"d":At>=h?Math.round(kt/h)+"h":At>=m?Math.round(kt/m)+"m":At>=s$1?Math.round(kt/s$1)+"s":kt+"ms"}function fmtLong(kt){var At=Math.abs(kt);return At>=d?plural(kt,At,d,"day"):At>=h?plural(kt,At,h,"hour"):At>=m?plural(kt,At,m,"minute"):At>=s$1?plural(kt,At,s$1,"second"):kt+" ms"}function plural(kt,At,xt,Bt){var Nt=At>=xt*1.5;return Math.round(kt/xt)+" "+Bt+(Nt?"s":"")}const ms$1=getDefaultExportFromCjs(ms);var __awaiter$1z=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidResolverCacheLevel$1=class{constructor({db:At,location:xt="DATA/DID_RESOLVERCACHE",ttl:Bt="15m"}={}){this.cache=At??new Level$1(xt),this.ttl=ms$1(Bt)}get(At){return __awaiter$1z(this,void 0,void 0,function*(){try{const xt=yield this.cache.get(At),Bt=JSON.parse(xt);if(Date.now()>=Bt.ttlMillis){this.cache.nextTick(()=>this.cache.del(At));return}else return Bt.value}catch(xt){if(xt.notFound)return;throw xt}})}set(At,xt){const Bt={ttlMillis:Date.now()+this.ttl,value:xt},Nt=JSON.stringify(Bt);return this.cache.put(At,Nt)}delete(At){return this.cache.del(At)}clear(){return this.cache.clear()}close(){return this.cache.close()}};const DidResolverCacheNoop$2={get:function(kt){return null},set:function(kt,At){return null},delete:function(kt){return null},clear:function(){return null},close:function(){return null}};var __awaiter$1y=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let UniversalResolver$2=class{constructor({cache:At,didResolvers:xt}){this.didResolvers=new Map,this.cache=At||DidResolverCacheNoop$2;for(const Bt of xt)this.didResolvers.set(Bt.methodName,Bt)}resolve(At,xt){return __awaiter$1y(this,void 0,void 0,function*(){const Bt=Did$2.parse(At);if(!Bt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:DidErrorCode$2.InvalidDid,errorMessage:`Invalid DID URI: ${At}`}});const Nt=this.didResolvers.get(Bt.method);if(!Nt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$2),{didResolutionMetadata:{error:DidErrorCode$2.MethodNotSupported,errorMessage:`Method not supported: ${Bt.method}`}});const jt=yield this.cache.get(Bt.uri);if(jt)return jt;{const Ut=yield Nt.resolve(Bt.uri,xt);return Ut.didResolutionMetadata.error||(yield this.cache.set(Bt.uri,Ut)),Ut}})}dereference(At,xt){return __awaiter$1y(this,void 0,void 0,function*(){const Bt=Did$2.parse(At);if(!Bt)return{dereferencingMetadata:{error:DidErrorCode$2.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:Nt,didResolutionMetadata:jt,didDocumentMetadata:Ut}=yield this.resolve(Bt.uri);if(!Nt)return{dereferencingMetadata:{error:jt.error},contentStream:null,contentMetadata:{}};if(!Bt.fragment||Bt.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:Nt,contentMetadata:Ut};const{service:Lt=[],verificationMethod:Ht=[]}=Nt,Vt=new Set([At,Bt.fragment,`#${Bt.fragment}`]);let zt;for(let Wt of Ht)if(Vt.has(Wt.id)){zt=Wt;break}for(let Wt of Lt)if(Vt.has(Wt.id)){zt=Wt;break}return zt?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:zt,contentMetadata:jt}:{dereferencingMetadata:{error:DidErrorCode$2.NotFound},contentStream:null,contentMetadata:{}}})}};var __awaiter$1x=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Dwn{constructor(At){this.didResolver=At.didResolver,this.tenantGate=At.tenantGate,this.eventStream=At.eventStream,this.messageStore=At.messageStore,this.dataStore=At.dataStore,this.resumableTaskStore=At.resumableTaskStore,this.eventLog=At.eventLog,this.eventStream=At.eventStream,this.storageController=new StorageController({messageStore:this.messageStore,dataStore:this.dataStore,eventLog:this.eventLog,eventStream:this.eventStream}),this.resumableTaskManager=new ResumableTaskManager(At.resumableTaskStore,this.storageController),this.methodHandlers={[DwnInterfaceName.Messages+DwnMethodName.Query]:new MessagesQueryHandler(this.didResolver,this.messageStore,this.eventLog),[DwnInterfaceName.Messages+DwnMethodName.Read]:new MessagesReadHandler(this.didResolver,this.messageStore,this.dataStore),[DwnInterfaceName.Messages+DwnMethodName.Subscribe]:new MessagesSubscribeHandler(this.didResolver,this.messageStore,this.eventStream),[DwnInterfaceName.Protocols+DwnMethodName.Configure]:new ProtocolsConfigureHandler(this.didResolver,this.messageStore,this.eventLog,this.eventStream),[DwnInterfaceName.Protocols+DwnMethodName.Query]:new ProtocolsQueryHandler(this.didResolver,this.messageStore,this.dataStore),[DwnInterfaceName.Records+DwnMethodName.Delete]:new RecordsDeleteHandler(this.didResolver,this.messageStore,this.resumableTaskManager),[DwnInterfaceName.Records+DwnMethodName.Query]:new RecordsQueryHandler(this.didResolver,this.messageStore,this.dataStore),[DwnInterfaceName.Records+DwnMethodName.Read]:new RecordsReadHandler(this.didResolver,this.messageStore,this.dataStore),[DwnInterfaceName.Records+DwnMethodName.Subscribe]:new RecordsSubscribeHandler(this.didResolver,this.messageStore,this.eventStream),[DwnInterfaceName.Records+DwnMethodName.Write]:new RecordsWriteHandler(this.didResolver,this.messageStore,this.dataStore,this.eventLog,this.eventStream)}}static create(At){var xt,Bt;return __awaiter$1x(this,void 0,void 0,function*(){(xt=At.didResolver)!==null&&xt!==void 0||(At.didResolver=new UniversalResolver$2({didResolvers:[DidDht$2,DidJwk$2,DidKey$2],cache:new DidResolverCacheLevel$1({location:"RESOLVERCACHE"})})),(Bt=At.tenantGate)!==null&&Bt!==void 0||(At.tenantGate=new AllowAllTenantGate);const Nt=new Dwn(At);return yield Nt.open(),Nt})}open(){var At;return __awaiter$1x(this,void 0,void 0,function*(){yield this.messageStore.open(),yield this.dataStore.open(),yield this.resumableTaskStore.open(),yield this.eventLog.open(),yield(At=this.eventStream)===null||At===void 0?void 0:At.open(),yield this.resumableTaskManager.resumeTasksAndWaitForCompletion()})}close(){var At;return __awaiter$1x(this,void 0,void 0,function*(){yield(At=this.eventStream)===null||At===void 0?void 0:At.close(),yield this.messageStore.close(),yield this.dataStore.close(),yield this.resumableTaskStore.close(),yield this.eventLog.close()})}processMessage(At,xt,Bt={}){var Nt;return __awaiter$1x(this,void 0,void 0,function*(){const jt=(Nt=yield this.validateTenant(At))!==null&&Nt!==void 0?Nt:yield this.validateMessageIntegrity(xt);if(jt!==void 0)return jt;const{dataStream:Ut,subscriptionHandler:Lt}=Bt,Ht=xt.descriptor.interface+xt.descriptor.method;return yield this.methodHandlers[Ht].handle({tenant:At,message:xt,dataStream:Ut,subscriptionHandler:Lt})})}validateTenant(At){var xt;return __awaiter$1x(this,void 0,void 0,function*(){const Bt=yield this.tenantGate.isActiveTenant(At);if(!Bt.isActiveTenant)return{status:{code:401,detail:(xt=Bt.detail)!==null&&xt!==void 0?xt:`DID ${At} is not an active tenant.`}}})}validateMessageIntegrity(At){var xt,Bt;return __awaiter$1x(this,void 0,void 0,function*(){const Nt=(xt=At==null?void 0:At.descriptor)===null||xt===void 0?void 0:xt.interface,jt=(Bt=At==null?void 0:At.descriptor)===null||Bt===void 0?void 0:Bt.method;if(Nt===void 0||jt===void 0)return{status:{code:400,detail:`Both interface and method must be present, interface: ${Nt}, method: ${jt}`}};try{Message.validateJsonSchema(At)}catch(Ut){return messageReplyFromError(Ut,400)}})}}var __awaiter$1w=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function promisifySignal(kt){return new Promise((At,xt)=>{if(kt.aborted){xt(kt.reason);return}kt.addEventListener("abort",()=>{xt(kt.reason)})})}function executeUnlessAborted(kt,At){return __awaiter$1w(this,void 0,void 0,function*(){return At?Promise.race([kt,promisifySignal(At)]):kt})}var __awaiter$1v=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__await$3=function(kt){return this instanceof __await$3?(this.v=kt,this):new __await$3(kt)},__asyncValues$6=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}},__asyncGenerator$2=function(kt,At,xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Bt=xt.apply(kt,At||[]),Nt,jt=[];return Nt={},Ut("next"),Ut("throw"),Ut("return"),Nt[Symbol.asyncIterator]=function(){return this},Nt;function Ut(Jt){Bt[Jt]&&(Nt[Jt]=function(Qt){return new Promise(function(Xt,tr){jt.push([Jt,Qt,Xt,tr])>1||Lt(Jt,Qt)})})}function Lt(Jt,Qt){try{Ht(Bt[Jt](Qt))}catch(Xt){Wt(jt[0][3],Xt)}}function Ht(Jt){Jt.value instanceof __await$3?Promise.resolve(Jt.value.v).then(Vt,zt):Wt(jt[0][2],Jt)}function Vt(Jt){Lt("next",Jt)}function zt(Jt){Lt("throw",Jt)}function Wt(Jt,Qt){Jt(Qt),jt.shift(),jt.length&&Lt(jt[0][0],jt[0][1])}};function createLevelDatabase(kt,At){return __awaiter$1v(this,void 0,void 0,function*(){return new Level(kt,Object.assign(Object.assign({},At),{keyEncoding:"utf8"}))})}class LevelWrapper{constructor(At,xt){this.config=Object.assign({createLevelDatabase},At),this.db=xt}open(){return __awaiter$1v(this,void 0,void 0,function*(){switch(yield this.createLevelDatabase(),this.db.status){case"open":return;case"opening":return new Promise(At=>{this.db.once("open",At)});case"closing":return new Promise((At,xt)=>{const Bt=()=>{this.db.open().then(At).catch(xt)};this.db.once("closed",Bt)});case"closed":return this.db.open()}})}close(){return __awaiter$1v(this,void 0,void 0,function*(){if(this.db)switch(this.db.status){case"open":return this.db.close();case"opening":return new Promise((At,xt)=>{const Bt=()=>{this.db.close().then(At).catch(xt)};this.db.once("open",Bt)});case"closing":return new Promise(At=>{this.db.once("closed",At)});case"closed":return}})}partition(At){return __awaiter$1v(this,void 0,void 0,function*(){return yield this.createLevelDatabase(),new LevelWrapper(this.config,this.db.sublevel(At,{keyEncoding:"utf8",valueEncoding:this.config.valueEncoding}))})}get(At,xt){var Bt;return __awaiter$1v(this,void 0,void 0,function*(){(Bt=xt==null?void 0:xt.signal)===null||Bt===void 0||Bt.throwIfAborted(),yield executeUnlessAborted(this.createLevelDatabase(),xt==null?void 0:xt.signal);try{return yield executeUnlessAborted(this.db.get(String(At)),xt==null?void 0:xt.signal)}catch(Nt){if(Nt.code==="LEVEL_NOT_FOUND")return;throw Nt}})}has(At,xt){return __awaiter$1v(this,void 0,void 0,function*(){return!!(yield this.get(At,xt))})}keys(At){var xt,Bt;return __asyncGenerator$2(this,arguments,function*(){var jt,Ut,Lt,Ht;(xt=At==null?void 0:At.signal)===null||xt===void 0||xt.throwIfAborted(),yield __await$3(executeUnlessAborted(this.createLevelDatabase(),At==null?void 0:At.signal));try{for(var Vt=!0,zt=__asyncValues$6(this.db.keys()),Wt;Wt=yield __await$3(zt.next()),jt=Wt.done,!jt;Vt=!0){Ht=Wt.value,Vt=!1;const Jt=Ht;(Bt=At==null?void 0:At.signal)===null||Bt===void 0||Bt.throwIfAborted(),yield yield __await$3(Jt)}}catch(Jt){Ut={error:Jt}}finally{try{!Vt&&!jt&&(Lt=zt.return)&&(yield __await$3(Lt.call(zt)))}finally{if(Ut)throw Ut.error}}})}iterator(At,xt){var Bt,Nt;return __asyncGenerator$2(this,arguments,function*(){var Ut,Lt,Ht,Vt;(Bt=xt==null?void 0:xt.signal)===null||Bt===void 0||Bt.throwIfAborted(),yield __await$3(executeUnlessAborted(this.createLevelDatabase(),xt==null?void 0:xt.signal));try{for(var zt=!0,Wt=__asyncValues$6(this.db.iterator(At)),Jt;Jt=yield __await$3(Wt.next()),Ut=Jt.done,!Ut;zt=!0){Vt=Jt.value,zt=!1;const Qt=Vt;(Nt=xt==null?void 0:xt.signal)===null||Nt===void 0||Nt.throwIfAborted(),yield yield __await$3(Qt)}}catch(Qt){Lt={error:Qt}}finally{try{!zt&&!Ut&&(Ht=Wt.return)&&(yield __await$3(Ht.call(Wt)))}finally{if(Lt)throw Lt.error}}})}put(At,xt,Bt){var Nt;return __awaiter$1v(this,void 0,void 0,function*(){return(Nt=Bt==null?void 0:Bt.signal)===null||Nt===void 0||Nt.throwIfAborted(),yield executeUnlessAborted(this.createLevelDatabase(),Bt==null?void 0:Bt.signal),executeUnlessAborted(this.db.put(String(At),xt),Bt==null?void 0:Bt.signal)})}delete(At,xt){var Bt;return __awaiter$1v(this,void 0,void 0,function*(){return(Bt=xt==null?void 0:xt.signal)===null||Bt===void 0||Bt.throwIfAborted(),yield executeUnlessAborted(this.createLevelDatabase(),xt==null?void 0:xt.signal),executeUnlessAborted(this.db.del(String(At)),xt==null?void 0:xt.signal)})}isEmpty(At){var xt,Bt,Nt,jt;return __awaiter$1v(this,void 0,void 0,function*(){try{for(var Ut=!0,Lt=__asyncValues$6(this.keys(At)),Ht;Ht=yield Lt.next(),xt=Ht.done,!xt;Ut=!0){jt=Ht.value,Ut=!1;const Vt=jt;return!1}}catch(Vt){Bt={error:Vt}}finally{try{!Ut&&!xt&&(Nt=Lt.return)&&(yield Nt.call(Lt))}finally{if(Bt)throw Bt.error}}return!0})}clear(){return __awaiter$1v(this,void 0,void 0,function*(){yield this.createLevelDatabase(),yield this.db.clear(),yield this.compactUnderlyingStorage()})}batch(At,xt){var Bt;return __awaiter$1v(this,void 0,void 0,function*(){return(Bt=xt==null?void 0:xt.signal)===null||Bt===void 0||Bt.throwIfAborted(),yield executeUnlessAborted(this.createLevelDatabase(),xt==null?void 0:xt.signal),executeUnlessAborted(this.db.batch(At),xt==null?void 0:xt.signal)})}createPartitionOperation(At,xt){return Object.assign(Object.assign({},xt),{sublevel:this.db.sublevel(At,{keyEncoding:"utf8",valueEncoding:this.config.valueEncoding})})}compactUnderlyingStorage(At){var xt,Bt,Nt;return __awaiter$1v(this,void 0,void 0,function*(){(xt=At==null?void 0:At.signal)===null||xt===void 0||xt.throwIfAborted(),yield executeUnlessAborted(this.createLevelDatabase(),At==null?void 0:At.signal);const jt=this.sublevelRange;if(!jt)return;const Ut=this.root;if(Ut.db.supports.additionalMethods.compactRange)return executeUnlessAborted((Nt=(Bt=Ut.db).compactRange)===null||Nt===void 0?void 0:Nt.call(Bt,...jt),At==null?void 0:At.signal)})}get sublevelRange(){const At=this.db.prefix;if(!At)return;const xt=At.slice(0,-1)+String.fromCharCode(At.charCodeAt(At.length-1)+1);return[At,xt]}get root(){let At=this.db;for(const xt=At.db;xt&&xt!==At;)At=xt;return new LevelWrapper(this.config,At)}createLevelDatabase(){var At;return __awaiter$1v(this,void 0,void 0,function*(){(At=this.db)!==null&&At!==void 0||(this.db=yield this.config.createLevelDatabase(this.config.location,{keyEncoding:"utf8",valueEncoding:this.config.valueEncoding}))})}}var __awaiter$1u=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$5=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}},__await$2=function(kt){return this instanceof __await$2?(this.v=kt,this):new __await$2(kt)},__asyncGenerator$1=function(kt,At,xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Bt=xt.apply(kt,At||[]),Nt,jt=[];return Nt={},Ut("next"),Ut("throw"),Ut("return"),Nt[Symbol.asyncIterator]=function(){return this},Nt;function Ut(Jt){Bt[Jt]&&(Nt[Jt]=function(Qt){return new Promise(function(Xt,tr){jt.push([Jt,Qt,Xt,tr])>1||Lt(Jt,Qt)})})}function Lt(Jt,Qt){try{Ht(Bt[Jt](Qt))}catch(Xt){Wt(jt[0][3],Xt)}}function Ht(Jt){Jt.value instanceof __await$2?Promise.resolve(Jt.value.v).then(Vt,zt):Wt(jt[0][2],Jt)}function Vt(Jt){Lt("next",Jt)}function zt(Jt){Lt("throw",Jt)}function Wt(Jt,Qt){Jt(Qt),jt.shift(),jt.length&&Lt(jt[0][0],jt[0][1])}};class BlockstoreLevel{constructor(At,xt){this.config=Object.assign({createLevelDatabase},At),this.db=xt??new LevelWrapper(Object.assign(Object.assign({},this.config),{valueEncoding:"binary"}))}open(){return __awaiter$1u(this,void 0,void 0,function*(){return this.db.open()})}close(){return __awaiter$1u(this,void 0,void 0,function*(){return this.db.close()})}partition(At){return __awaiter$1u(this,void 0,void 0,function*(){const xt=yield this.db.partition(At);return new BlockstoreLevel(Object.assign(Object.assign({},this.config),{location:""}),xt)})}put(At,xt,Bt){return __awaiter$1u(this,void 0,void 0,function*(){return yield this.db.put(String(At),xt,Bt),CID.parse(At.toString())})}get(At,xt){return __awaiter$1u(this,void 0,void 0,function*(){return yield this.db.get(String(At),xt)})}has(At,xt){return __awaiter$1u(this,void 0,void 0,function*(){return this.db.has(String(At),xt)})}delete(At,xt){return __awaiter$1u(this,void 0,void 0,function*(){return this.db.delete(String(At),xt)})}isEmpty(At){return __awaiter$1u(this,void 0,void 0,function*(){return this.db.isEmpty(At)})}putMany(At,xt){return __asyncGenerator$1(this,arguments,function*(){var Nt,jt,Ut,Lt;try{for(var Ht=!0,Vt=__asyncValues$5(At),zt;zt=yield __await$2(Vt.next()),Nt=zt.done,!Nt;Ht=!0){Lt=zt.value,Ht=!1;const Wt=Lt;yield __await$2(this.put(Wt.cid,Wt.block,xt)),yield yield __await$2(Wt.cid)}}catch(Wt){jt={error:Wt}}finally{try{!Ht&&!Nt&&(Ut=Vt.return)&&(yield __await$2(Ut.call(Vt)))}finally{if(jt)throw jt.error}}})}getMany(At,xt){return __asyncGenerator$1(this,arguments,function*(){var Nt,jt,Ut,Lt;try{for(var Ht=!0,Vt=__asyncValues$5(At),zt;zt=yield __await$2(Vt.next()),Nt=zt.done,!Nt;Ht=!0){Lt=zt.value,Ht=!1;const Wt=Lt;yield yield __await$2({cid:Wt,block:yield __await$2(this.get(Wt,xt))})}}catch(Wt){jt={error:Wt}}finally{try{!Ht&&!Nt&&(Ut=Vt.return)&&(yield __await$2(Ut.call(Vt)))}finally{if(jt)throw jt.error}}})}getAll(At){return __asyncGenerator$1(this,arguments,function*(){var Bt,Nt,jt,Ut;const Lt=this.db.iterator({keys:!0,keyEncoding:"buffer"},At);try{for(var Ht=!0,Vt=__asyncValues$5(Lt),zt;zt=yield __await$2(Vt.next()),Bt=zt.done,!Bt;Ht=!0){Ut=zt.value,Ht=!1;const[Wt,Jt]=Ut;yield yield __await$2({cid:CID.decode(Wt),block:Jt})}}catch(Wt){Nt={error:Wt}}finally{try{!Ht&&!Bt&&(jt=Vt.return)&&(yield __await$2(jt.call(Vt)))}finally{if(Nt)throw Nt.error}}})}deleteMany(At,xt){return __asyncGenerator$1(this,arguments,function*(){var Nt,jt,Ut,Lt;try{for(var Ht=!0,Vt=__asyncValues$5(At),zt;zt=yield __await$2(Vt.next()),Nt=zt.done,!Nt;Ht=!0){Lt=zt.value,Ht=!1;const Wt=Lt;yield __await$2(this.delete(Wt,xt)),yield yield __await$2(Wt)}}catch(Wt){jt={error:Wt}}finally{try{!Ht&&!Nt&&(Ut=Vt.return)&&(yield __await$2(Ut.call(Vt)))}finally{if(jt)throw jt.error}}})}clear(){return __awaiter$1u(this,void 0,void 0,function*(){return this.db.clear()})}}function isAsyncIterable$5(kt){return kt[Symbol.asyncIterator]!=null}function last(kt){if(isAsyncIterable$5(kt))return(async()=>{let xt;for await(const Bt of kt)xt=Bt;return xt})();let At;for(const xt of kt)At=xt;return At}const code=0,name="identity",encode$1=coerce$3,digest=kt=>create$2(code,encode$1(kt)),identity={code,name,encode:encode$1,digest},resolve$3=async(kt,At,xt,Bt,Nt,jt,Ut,Lt)=>{const Ht=await Ut.get(kt,Lt),Vt=decode$b(Ht);let zt=Vt,Wt=xt;for(;Bt.length>0;){const Jt=Bt[0];if(Jt in zt){Bt.shift(),Wt=`${Wt}/${Jt}`;const Qt=CID.asCID(zt[Jt]);if(Qt!=null)return{entry:{type:"object",name:At,path:xt,cid:kt,node:Ht,depth:jt,size:BigInt(Ht.length),content:async function*(){yield Vt}},next:{cid:Qt,name:Jt,path:Wt,toResolve:Bt}};zt=zt[Jt]}else throw errCode$1(new Error(`No property named ${Jt} found in cbor node ${kt}`),"ERR_NO_PROP")}return{entry:{type:"object",name:At,path:xt,cid:kt,node:Ht,depth:jt,size:BigInt(Ht.length),content:async function*(){yield Vt}}}};function extractDataFromBlock(kt,At,xt,Bt){const Nt=BigInt(kt.length),jt=BigInt(At+Nt);return xt>=jt||Bt<At?new Uint8Array(0):(Bt>=At&&Bt<jt&&(kt=kt.subarray(0,Number(Bt-At))),xt>=At&&xt<jt&&(kt=kt.subarray(Number(xt-At))),kt)}const validateOffsetAndLength=(kt,At=0,xt=kt)=>{const Bt=BigInt(kt),Nt=BigInt(At??0);let jt=BigInt(xt);if(jt!==Bt&&(jt=Nt+jt),jt>Bt&&(jt=Bt),Nt<0n)throw errCode$1(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(Nt>Bt)throw errCode$1(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(jt<0n)throw errCode$1(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(jt>Bt)throw errCode$1(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:Nt,end:jt}},rawContent$1=kt=>{async function*At(xt={}){var Ut;const{start:Bt,end:Nt}=validateOffsetAndLength(kt.length,xt.offset,xt.length),jt=extractDataFromBlock(kt,0n,Bt,Nt);(Ut=xt.onProgress)==null||Ut.call(xt,new CustomProgressEvent("unixfs:exporter:progress:identity",{bytesRead:BigInt(jt.byteLength),totalBytes:Nt-Bt,fileSize:BigInt(kt.byteLength)})),yield jt}return At},resolve$2=async(kt,At,xt,Bt,Nt,jt,Ut,Lt)=>{if(Bt.length>0)throw errCode$1(new Error(`No link named ${xt} found in raw node ${kt}`),"ERR_NOT_FOUND");const Ht=decode$m(kt.multihash.bytes);return{entry:{type:"identity",name:At,path:xt,cid:kt,content:rawContent$1(Ht.digest),depth:jt,size:BigInt(Ht.digest.length),node:Ht.digest}}},rawContent=kt=>{async function*At(xt={}){var Ut;const{start:Bt,end:Nt}=validateOffsetAndLength(kt.length,xt.offset,xt.length),jt=extractDataFromBlock(kt,0n,Bt,Nt);(Ut=xt.onProgress)==null||Ut.call(xt,new CustomProgressEvent("unixfs:exporter:progress:raw",{bytesRead:BigInt(jt.byteLength),totalBytes:Nt-Bt,fileSize:BigInt(kt.byteLength)})),yield jt}return At},resolve$1=async(kt,At,xt,Bt,Nt,jt,Ut,Lt)=>{if(Bt.length>0)throw errCode$1(new Error(`No link named ${xt} found in raw node ${kt}`),"ERR_NOT_FOUND");const Ht=await Ut.get(kt,Lt);return{entry:{type:"raw",name:At,path:xt,cid:kt,content:rawContent(Ht),depth:jt,size:BigInt(Ht.length),node:Ht}}},hashFn=async function(kt){return(await murmur3128.encode(kt)).slice(0,8).reverse()},addLinksToHamtBucket=async(kt,At,xt)=>{await Promise.all(kt.map(async Bt=>{if(Bt.Name==null)throw new Error("Unexpected Link without a Name");if(Bt.Name.length===2){const Nt=parseInt(Bt.Name,16);At._putObjectAt(Nt,new Bucket({hash:xt._options.hash,bits:xt._options.bits},At,Nt));return}await xt.put(Bt.Name.substring(2),!0)}))},toPrefix=kt=>kt.toString(16).toUpperCase().padStart(2,"0").substring(0,2),toBucketPath=kt=>{let At=kt.bucket;const xt=[];for(;At._parent!=null;)xt.push(At),At=At._parent;return xt.push(At),xt.reverse()},findShardCid=async(kt,At,xt,Bt,Nt)=>{if(Bt==null){const zt=createHAMT({hashFn});Bt={rootBucket:zt,hamtDepth:1,lastBucket:zt}}await addLinksToHamtBucket(kt.Links,Bt.lastBucket,Bt.rootBucket);const jt=await Bt.rootBucket._findNewBucketAndPos(At);let Ut=toPrefix(jt.pos);const Lt=toBucketPath(jt);Lt.length>Bt.hamtDepth&&(Bt.lastBucket=Lt[Bt.hamtDepth],Ut=toPrefix(Bt.lastBucket._posAtParent));const Ht=kt.Links.find(zt=>{if(zt.Name==null)return!1;const Wt=zt.Name.substring(0,2),Jt=zt.Name.substring(2);return!(Wt!==Ut||Jt!==""&&Jt!==At)});if(Ht==null)return;if(Ht.Name!=null&&Ht.Name.substring(2)===At)return Ht.Hash;Bt.hamtDepth++;const Vt=await xt.get(Ht.Hash,Nt);return kt=decode$a(Vt),findShardCid(kt,At,xt,Bt,Nt)};function peekable(kt){const[At,xt]=kt[Symbol.asyncIterator]!=null?[kt[Symbol.asyncIterator](),Symbol.asyncIterator]:[kt[Symbol.iterator](),Symbol.iterator],Bt=[];return{peek:()=>At.next(),push:Nt=>{Bt.push(Nt)},next:()=>Bt.length>0?{done:!1,value:Bt.shift()}:At.next(),[xt](){return this}}}function isAsyncIterable$4(kt){return kt[Symbol.asyncIterator]!=null}function filter(kt,At){let xt=0;if(isAsyncIterable$4(kt))return async function*(){for await(const Ht of kt)await At(Ht,xt++)&&(yield Ht)}();const Bt=peekable(kt),{value:Nt,done:jt}=Bt.next();if(jt===!0)return function*(){}();const Ut=At(Nt,xt++);if(typeof Ut.then=="function")return async function*(){await Ut&&(yield Nt);for await(const Ht of Bt)await At(Ht,xt++)&&(yield Ht)}();const Lt=At;return function*(){Ut===!0&&(yield Nt);for(const Ht of Bt)Lt(Ht,xt++)&&(yield Ht)}()}function isAsyncIterable$3(kt){return kt[Symbol.asyncIterator]!=null}function map(kt,At){let xt=0;if(isAsyncIterable$3(kt))return async function*(){for await(const Ht of kt)yield At(Ht,xt++)}();const Bt=peekable(kt),{value:Nt,done:jt}=Bt.next();if(jt===!0)return function*(){}();const Ut=At(Nt,xt++);if(typeof Ut.then=="function")return async function*(){yield await Ut;for await(const Ht of Bt)yield At(Ht,xt++)}();const Lt=At;return function*(){yield Ut;for(const Ht of Bt)yield Lt(Ht,xt++)}()}function pDefer(){const kt={};return kt.promise=new Promise((At,xt)=>{kt.resolve=At,kt.reject=xt}),kt}const CustomEvent$1=globalThis.CustomEvent??Event;async function*parallel(kt,At={}){let xt=At.concurrency??1/0;xt<1&&(xt=1/0);const Bt=At.ordered==null?!1:At.ordered,Nt=new EventTarget,jt=[];let Ut=pDefer(),Lt=pDefer(),Ht=!1,Vt,zt=!1;Nt.addEventListener("task-complete",()=>{Lt.resolve()}),Promise.resolve().then(async()=>{try{for await(const Xt of kt){if(jt.length===xt&&(Ut=pDefer(),await Ut.promise),zt)break;const tr={done:!1};jt.push(tr),Xt().then(rr=>{tr.done=!0,tr.ok=!0,tr.value=rr,Nt.dispatchEvent(new CustomEvent$1("task-complete"))},rr=>{tr.done=!0,tr.err=rr,Nt.dispatchEvent(new CustomEvent$1("task-complete"))})}Ht=!0,Nt.dispatchEvent(new CustomEvent$1("task-complete"))}catch(Xt){Vt=Xt,Nt.dispatchEvent(new CustomEvent$1("task-complete"))}});function Wt(){var Xt;return Bt?(Xt=jt[0])==null?void 0:Xt.done:!!jt.find(tr=>tr.done)}function*Jt(){for(;jt.length>0&&jt[0].done;){const Xt=jt[0];if(jt.shift(),Xt.ok)yield Xt.value;else throw zt=!0,Ut.resolve(),Xt.err;Ut.resolve()}}function*Qt(){for(;Wt();)for(let Xt=0;Xt<jt.length;Xt++)if(jt[Xt].done){const tr=jt[Xt];if(jt.splice(Xt,1),Xt--,tr.ok)yield tr.value;else throw zt=!0,Ut.resolve(),tr.err;Ut.resolve()}}for(;;){if(Wt()||(Lt=pDefer(),await Lt.promise),Vt!=null)throw Vt;if(Bt?yield*Jt():yield*Qt(),Ht&&jt.length===0)break}}class FixedFIFO{buffer;mask;top;btm;next;constructor(At){if(!(At>0)||At-1&At)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(At),this.mask=At-1,this.top=0,this.btm=0,this.next=null}push(At){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=At,this.top=this.top+1&this.mask,!0)}shift(){const At=this.buffer[this.btm];if(At!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,At}isEmpty(){return this.buffer[this.btm]===void 0}}class FIFO{size;hwm;head;tail;constructor(At={}){this.hwm=At.splitLimit??16,this.head=new FixedFIFO(this.hwm),this.tail=this.head,this.size=0}calculateSize(At){return(At==null?void 0:At.byteLength)!=null?At.byteLength:1}push(At){if((At==null?void 0:At.value)!=null&&(this.size+=this.calculateSize(At.value)),!this.head.push(At)){const xt=this.head;this.head=xt.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(At)}}shift(){let At=this.tail.shift();if(At===void 0&&this.tail.next!=null){const xt=this.tail.next;this.tail.next=null,this.tail=xt,At=this.tail.shift()}return(At==null?void 0:At.value)!=null&&(this.size-=this.calculateSize(At.value)),At}isEmpty(){return this.head.isEmpty()}}let AbortError$2=class extends Error{type;code;constructor(At,xt){super(At??"The operation was aborted"),this.type="aborted",this.code=xt??"ABORT_ERR"}};function pushable(kt={}){return _pushable(xt=>{const Bt=xt.shift();if(Bt==null)return{done:!0};if(Bt.error!=null)throw Bt.error;return{done:Bt.done===!0,value:Bt.value}},kt)}function _pushable(kt,At){At=At??{};let xt=At.onEnd,Bt=new FIFO,Nt,jt,Ut,Lt=pDefer();const Ht=async()=>{try{return Bt.isEmpty()?Ut?{done:!0}:await new Promise((rr,nr)=>{jt=ar=>{jt=null,Bt.push(ar);try{rr(kt(Bt))}catch(ir){nr(ir)}return Nt}}):kt(Bt)}finally{Bt.isEmpty()&&queueMicrotask(()=>{Lt.resolve(),Lt=pDefer()})}},Vt=rr=>jt!=null?jt(rr):(Bt.push(rr),Nt),zt=rr=>(Bt=new FIFO,jt!=null?jt({error:rr}):(Bt.push({error:rr}),Nt)),Wt=rr=>{if(Ut)return Nt;if((At==null?void 0:At.objectMode)!==!0&&(rr==null?void 0:rr.byteLength)==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return Vt({done:!1,value:rr})},Jt=rr=>Ut?Nt:(Ut=!0,rr!=null?zt(rr):Vt({done:!0})),Qt=()=>(Bt=new FIFO,Jt(),{done:!0}),Xt=rr=>(Jt(rr),{done:!0});if(Nt={[Symbol.asyncIterator](){return this},next:Ht,return:Qt,throw:Xt,push:Wt,end:Jt,get readableLength(){return Bt.size},onEmpty:async rr=>{const nr=rr==null?void 0:rr.signal;if(nr==null||nr.throwIfAborted(),Bt.isEmpty())return;let ar,ir;nr!=null&&(ar=new Promise((lr,yr)=>{ir=()=>{yr(new AbortError$2)},nr.addEventListener("abort",ir)}));try{await Promise.race([Lt.promise,ar])}finally{ir!=null&&nr!=null&&(nr==null||nr.removeEventListener("abort",ir))}}},xt==null)return Nt;const tr=Nt;return Nt={[Symbol.asyncIterator](){return this},next(){return tr.next()},throw(rr){return tr.throw(rr),xt!=null&&(xt(rr),xt=void 0),{done:!0}},return(){return tr.return(),xt!=null&&(xt(),xt=void 0),{done:!0}},push:Wt,end(rr){return tr.end(rr),xt!=null&&(xt(rr),xt=void 0),Nt},get readableLength(){return tr.readableLength},onEmpty:rr=>tr.onEmpty(rr)},Nt}function isAsyncIterable$2(kt){return kt[Symbol.asyncIterator]!=null}function merge(...kt){const At=[];for(const xt of kt)isAsyncIterable$2(xt)||At.push(xt);return At.length===kt.length?function*(){for(const xt of At)yield*xt}():async function*(){const xt=pushable({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(kt.map(async Bt=>{for await(const Nt of Bt)xt.push(Nt)})),xt.end()}catch(Bt){xt.end(Bt)}}),yield*xt}()}function pipe(kt,...At){if(kt==null)throw new Error("Empty pipeline");if(isDuplex(kt)){const Bt=kt;kt=()=>Bt.source}else if(isIterable(kt)||isAsyncIterable$1(kt)){const Bt=kt;kt=()=>Bt}const xt=[kt,...At];if(xt.length>1&&isDuplex(xt[xt.length-1])&&(xt[xt.length-1]=xt[xt.length-1].sink),xt.length>2)for(let Bt=1;Bt<xt.length-1;Bt++)isDuplex(xt[Bt])&&(xt[Bt]=duplexPipelineFn(xt[Bt]));return rawPipe(...xt)}const rawPipe=(...kt)=>{let At;for(;kt.length>0;)At=kt.shift()(At);return At},isAsyncIterable$1=kt=>(kt==null?void 0:kt[Symbol.asyncIterator])!=null,isIterable=kt=>(kt==null?void 0:kt[Symbol.iterator])!=null,isDuplex=kt=>kt==null?!1:kt.sink!=null&&kt.source!=null,duplexPipelineFn=kt=>At=>{const xt=kt.sink(At);if((xt==null?void 0:xt.then)!=null){const Bt=pushable({objectMode:!0});xt.then(()=>{Bt.end()},Ut=>{Bt.end(Ut)});let Nt;const jt=kt.source;if(isAsyncIterable$1(jt))Nt=async function*(){yield*jt,Bt.end()};else if(isIterable(jt))Nt=function*(){yield*jt,Bt.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return merge(Bt,Nt())}return kt.source},directoryContent=(kt,At,xt,Bt,Nt,jt,Ut)=>{async function*Lt(Ht={}){var Jt;const Vt=Ht.offset??0,zt=Ht.length??At.Links.length,Wt=At.Links.slice(Vt,zt);(Jt=Ht.onProgress)==null||Jt.call(Ht,new CustomProgressEvent("unixfs:exporter:walk:directory",{cid:kt})),yield*pipe(Wt,Qt=>map(Qt,Xt=>async()=>{const tr=Xt.Name??"",rr=`${Bt}/${tr}`;return(await Nt(Xt.Hash,tr,rr,[],jt+1,Ut,Ht)).entry}),Qt=>parallel(Qt,{ordered:!0}),Qt=>filter(Qt,Xt=>Xt!=null))}return Lt};var eventemitter3={exports:{}};(function(kt){var At=Object.prototype.hasOwnProperty,xt="~";function Bt(){}Object.create&&(Bt.prototype=Object.create(null),new Bt().__proto__||(xt=!1));function Nt(Ht,Vt,zt){this.fn=Ht,this.context=Vt,this.once=zt||!1}function jt(Ht,Vt,zt,Wt,Jt){if(typeof zt!="function")throw new TypeError("The listener must be a function");var Qt=new Nt(zt,Wt||Ht,Jt),Xt=xt?xt+Vt:Vt;return Ht._events[Xt]?Ht._events[Xt].fn?Ht._events[Xt]=[Ht._events[Xt],Qt]:Ht._events[Xt].push(Qt):(Ht._events[Xt]=Qt,Ht._eventsCount++),Ht}function Ut(Ht,Vt){--Ht._eventsCount===0?Ht._events=new Bt:delete Ht._events[Vt]}function Lt(){this._events=new Bt,this._eventsCount=0}Lt.prototype.eventNames=function(){var Vt=[],zt,Wt;if(this._eventsCount===0)return Vt;for(Wt in zt=this._events)At.call(zt,Wt)&&Vt.push(xt?Wt.slice(1):Wt);return Object.getOwnPropertySymbols?Vt.concat(Object.getOwnPropertySymbols(zt)):Vt},Lt.prototype.listeners=function(Vt){var zt=xt?xt+Vt:Vt,Wt=this._events[zt];if(!Wt)return[];if(Wt.fn)return[Wt.fn];for(var Jt=0,Qt=Wt.length,Xt=new Array(Qt);Jt<Qt;Jt++)Xt[Jt]=Wt[Jt].fn;return Xt},Lt.prototype.listenerCount=function(Vt){var zt=xt?xt+Vt:Vt,Wt=this._events[zt];return Wt?Wt.fn?1:Wt.length:0},Lt.prototype.emit=function(Vt,zt,Wt,Jt,Qt,Xt){var tr=xt?xt+Vt:Vt;if(!this._events[tr])return!1;var rr=this._events[tr],nr=arguments.length,ar,ir;if(rr.fn){switch(rr.once&&this.removeListener(Vt,rr.fn,void 0,!0),nr){case 1:return rr.fn.call(rr.context),!0;case 2:return rr.fn.call(rr.context,zt),!0;case 3:return rr.fn.call(rr.context,zt,Wt),!0;case 4:return rr.fn.call(rr.context,zt,Wt,Jt),!0;case 5:return rr.fn.call(rr.context,zt,Wt,Jt,Qt),!0;case 6:return rr.fn.call(rr.context,zt,Wt,Jt,Qt,Xt),!0}for(ir=1,ar=new Array(nr-1);ir<nr;ir++)ar[ir-1]=arguments[ir];rr.fn.apply(rr.context,ar)}else{var lr=rr.length,yr;for(ir=0;ir<lr;ir++)switch(rr[ir].once&&this.removeListener(Vt,rr[ir].fn,void 0,!0),nr){case 1:rr[ir].fn.call(rr[ir].context);break;case 2:rr[ir].fn.call(rr[ir].context,zt);break;case 3:rr[ir].fn.call(rr[ir].context,zt,Wt);break;case 4:rr[ir].fn.call(rr[ir].context,zt,Wt,Jt);break;default:if(!ar)for(yr=1,ar=new Array(nr-1);yr<nr;yr++)ar[yr-1]=arguments[yr];rr[ir].fn.apply(rr[ir].context,ar)}}return!0},Lt.prototype.on=function(Vt,zt,Wt){return jt(this,Vt,zt,Wt,!1)},Lt.prototype.once=function(Vt,zt,Wt){return jt(this,Vt,zt,Wt,!0)},Lt.prototype.removeListener=function(Vt,zt,Wt,Jt){var Qt=xt?xt+Vt:Vt;if(!this._events[Qt])return this;if(!zt)return Ut(this,Qt),this;var Xt=this._events[Qt];if(Xt.fn)Xt.fn===zt&&(!Jt||Xt.once)&&(!Wt||Xt.context===Wt)&&Ut(this,Qt);else{for(var tr=0,rr=[],nr=Xt.length;tr<nr;tr++)(Xt[tr].fn!==zt||Jt&&!Xt[tr].once||Wt&&Xt[tr].context!==Wt)&&rr.push(Xt[tr]);rr.length?this._events[Qt]=rr.length===1?rr[0]:rr:Ut(this,Qt)}return this},Lt.prototype.removeAllListeners=function(Vt){var zt;return Vt?(zt=xt?xt+Vt:Vt,this._events[zt]&&Ut(this,zt)):(this._events=new Bt,this._eventsCount=0),this},Lt.prototype.off=Lt.prototype.removeListener,Lt.prototype.addListener=Lt.prototype.on,Lt.prefixed=xt,Lt.EventEmitter=Lt,kt.exports=Lt})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);class TimeoutError extends Error{constructor(At){super(At),this.name="TimeoutError"}}let AbortError$1=class extends Error{constructor(At){super(),this.name="AbortError",this.message=At}};const getDOMException=kt=>globalThis.DOMException===void 0?new AbortError$1(kt):new DOMException(kt),getAbortedReason=kt=>{const At=kt.reason===void 0?getDOMException("This operation was aborted."):kt.reason;return At instanceof Error?At:getDOMException(At)};function pTimeout(kt,At,xt,Bt){let Nt;const jt=new Promise((Ut,Lt)=>{if(typeof At!="number"||Math.sign(At)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${At}\``);if(At===Number.POSITIVE_INFINITY){Ut(kt);return}if(Bt={customTimers:{setTimeout,clearTimeout},...Bt},Bt.signal){const{signal:Ht}=Bt;Ht.aborted&&Lt(getAbortedReason(Ht)),Ht.addEventListener("abort",()=>{Lt(getAbortedReason(Ht))})}Nt=Bt.customTimers.setTimeout.call(void 0,()=>{const Ht=`Promise timed out after ${At} milliseconds`,Vt=xt instanceof Error?xt:new TimeoutError(Ht);typeof kt.cancel=="function"&&kt.cancel(),Lt(Vt)},At),(async()=>{try{Ut(await kt)}catch(Ht){Lt(Ht)}finally{Bt.customTimers.clearTimeout.call(void 0,Nt)}})()});return jt.clear=()=>{clearTimeout(Nt),Nt=void 0},jt}function lowerBound(kt,At,xt){let Bt=0,Nt=kt.length;for(;Nt>0;){const jt=Math.trunc(Nt/2);let Ut=Bt+jt;xt(kt[Ut],At)<=0?(Bt=++Ut,Nt-=jt+1):Nt=jt}return Bt}var __classPrivateFieldGet$1=function(kt,At,xt,Bt){if(xt==="a"&&!Bt)throw new TypeError("Private accessor was defined without a getter");if(typeof At=="function"?kt!==At||!Bt:!At.has(kt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return xt==="m"?Bt:xt==="a"?Bt.call(kt):Bt?Bt.value:At.get(kt)},_PriorityQueue_queue;class PriorityQueue{constructor(){_PriorityQueue_queue.set(this,[])}enqueue(At,xt){xt={priority:0,...xt};const Bt={priority:xt.priority,run:At};if(this.size&&__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f")[this.size-1].priority>=xt.priority){__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").push(Bt);return}const Nt=lowerBound(__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f"),Bt,(jt,Ut)=>Ut.priority-jt.priority);__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").splice(Nt,0,Bt)}dequeue(){const At=__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").shift();return At==null?void 0:At.run}filter(At){return __classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").filter(xt=>xt.priority===At.priority).map(xt=>xt.run)}get size(){return __classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").length}}_PriorityQueue_queue=new WeakMap;var __classPrivateFieldSet=function(kt,At,xt,Bt,Nt){if(Bt==="m")throw new TypeError("Private method is not writable");if(Bt==="a"&&!Nt)throw new TypeError("Private accessor was defined without a setter");if(typeof At=="function"?kt!==At||!Nt:!At.has(kt))throw new TypeError("Cannot write private member to an object whose class did not declare it");return Bt==="a"?Nt.call(kt,xt):Nt?Nt.value=xt:At.set(kt,xt),xt},__classPrivateFieldGet=function(kt,At,xt,Bt){if(xt==="a"&&!Bt)throw new TypeError("Private accessor was defined without a getter");if(typeof At=="function"?kt!==At||!Bt:!At.has(kt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return xt==="m"?Bt:xt==="a"?Bt.call(kt):Bt?Bt.value:At.get(kt)},_PQueue_instances,_PQueue_carryoverConcurrencyCount,_PQueue_isIntervalIgnored,_PQueue_intervalCount,_PQueue_intervalCap,_PQueue_interval,_PQueue_intervalEnd,_PQueue_intervalId,_PQueue_timeoutId,_PQueue_queue,_PQueue_queueClass,_PQueue_pending,_PQueue_concurrency,_PQueue_isPaused,_PQueue_throwOnTimeout,_PQueue_doesIntervalAllowAnother_get,_PQueue_doesConcurrentAllowAnother_get,_PQueue_next,_PQueue_onResumeInterval,_PQueue_isIntervalPaused_get,_PQueue_tryToStartAnother,_PQueue_initializeIntervalIfNeeded,_PQueue_onInterval,_PQueue_processQueue,_PQueue_throwOnAbort,_PQueue_onEvent;class AbortError extends Error{}class PQueue extends EventEmitter{constructor(At){var xt,Bt,Nt,jt;if(super(),_PQueue_instances.add(this),_PQueue_carryoverConcurrencyCount.set(this,void 0),_PQueue_isIntervalIgnored.set(this,void 0),_PQueue_intervalCount.set(this,0),_PQueue_intervalCap.set(this,void 0),_PQueue_interval.set(this,void 0),_PQueue_intervalEnd.set(this,0),_PQueue_intervalId.set(this,void 0),_PQueue_timeoutId.set(this,void 0),_PQueue_queue.set(this,void 0),_PQueue_queueClass.set(this,void 0),_PQueue_pending.set(this,0),_PQueue_concurrency.set(this,void 0),_PQueue_isPaused.set(this,void 0),_PQueue_throwOnTimeout.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),At={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...At},!(typeof At.intervalCap=="number"&&At.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(Bt=(xt=At.intervalCap)===null||xt===void 0?void 0:xt.toString())!==null&&Bt!==void 0?Bt:""}\` (${typeof At.intervalCap})`);if(At.interval===void 0||!(Number.isFinite(At.interval)&&At.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(jt=(Nt=At.interval)===null||Nt===void 0?void 0:Nt.toString())!==null&&jt!==void 0?jt:""}\` (${typeof At.interval})`);__classPrivateFieldSet(this,_PQueue_carryoverConcurrencyCount,At.carryoverConcurrencyCount,"f"),__classPrivateFieldSet(this,_PQueue_isIntervalIgnored,At.intervalCap===Number.POSITIVE_INFINITY||At.interval===0,"f"),__classPrivateFieldSet(this,_PQueue_intervalCap,At.intervalCap,"f"),__classPrivateFieldSet(this,_PQueue_interval,At.interval,"f"),__classPrivateFieldSet(this,_PQueue_queue,new At.queueClass,"f"),__classPrivateFieldSet(this,_PQueue_queueClass,At.queueClass,"f"),this.concurrency=At.concurrency,this.timeout=At.timeout,__classPrivateFieldSet(this,_PQueue_throwOnTimeout,At.throwOnTimeout===!0,"f"),__classPrivateFieldSet(this,_PQueue_isPaused,At.autoStart===!1,"f")}get concurrency(){return __classPrivateFieldGet(this,_PQueue_concurrency,"f")}set concurrency(At){if(!(typeof At=="number"&&At>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${At}\` (${typeof At})`);__classPrivateFieldSet(this,_PQueue_concurrency,At,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)}async add(At,xt={}){return xt={timeout:this.timeout,throwOnTimeout:__classPrivateFieldGet(this,_PQueue_throwOnTimeout,"f"),...xt},new Promise((Bt,Nt)=>{__classPrivateFieldGet(this,_PQueue_queue,"f").enqueue(async()=>{var jt,Ut,Lt;__classPrivateFieldSet(this,_PQueue_pending,(Ut=__classPrivateFieldGet(this,_PQueue_pending,"f"),Ut++,Ut),"f"),__classPrivateFieldSet(this,_PQueue_intervalCount,(Lt=__classPrivateFieldGet(this,_PQueue_intervalCount,"f"),Lt++,Lt),"f");try{if(!((jt=xt.signal)===null||jt===void 0)&&jt.aborted)throw new AbortError("The task was aborted.");let Ht=At({signal:xt.signal});xt.timeout&&(Ht=pTimeout(Promise.resolve(Ht),xt.timeout)),xt.signal&&(Ht=Promise.race([Ht,__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_throwOnAbort).call(this,xt.signal)]));const Vt=await Ht;Bt(Vt),this.emit("completed",Vt)}catch(Ht){if(Ht instanceof TimeoutError&&!xt.throwOnTimeout){Bt();return}Nt(Ht),this.emit("error",Ht)}finally{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_next).call(this)}},xt),this.emit("add"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this)})}async addAll(At,xt){return Promise.all(At.map(async Bt=>this.add(Bt,xt)))}start(){return __classPrivateFieldGet(this,_PQueue_isPaused,"f")?(__classPrivateFieldSet(this,_PQueue_isPaused,!1,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this),this):this}pause(){__classPrivateFieldSet(this,_PQueue_isPaused,!0,"f")}clear(){__classPrivateFieldSet(this,_PQueue_queue,new(__classPrivateFieldGet(this,_PQueue_queueClass,"f")),"f")}async onEmpty(){__classPrivateFieldGet(this,_PQueue_queue,"f").size!==0&&await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"empty")}async onSizeLessThan(At){__classPrivateFieldGet(this,_PQueue_queue,"f").size<At||await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"next",()=>__classPrivateFieldGet(this,_PQueue_queue,"f").size<At)}async onIdle(){__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet(this,_PQueue_queue,"f").size===0||await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"idle")}get size(){return __classPrivateFieldGet(this,_PQueue_queue,"f").size}sizeBy(At){return __classPrivateFieldGet(this,_PQueue_queue,"f").filter(At).length}get pending(){return __classPrivateFieldGet(this,_PQueue_pending,"f")}get isPaused(){return __classPrivateFieldGet(this,_PQueue_isPaused,"f")}}_PQueue_carryoverConcurrencyCount=new WeakMap,_PQueue_isIntervalIgnored=new WeakMap,_PQueue_intervalCount=new WeakMap,_PQueue_intervalCap=new WeakMap,_PQueue_interval=new WeakMap,_PQueue_intervalEnd=new WeakMap,_PQueue_intervalId=new WeakMap,_PQueue_timeoutId=new WeakMap,_PQueue_queue=new WeakMap,_PQueue_queueClass=new WeakMap,_PQueue_pending=new WeakMap,_PQueue_concurrency=new WeakMap,_PQueue_isPaused=new WeakMap,_PQueue_throwOnTimeout=new WeakMap,_PQueue_instances=new WeakSet,_PQueue_doesIntervalAllowAnother_get=function kt(){return __classPrivateFieldGet(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet(this,_PQueue_intervalCount,"f")<__classPrivateFieldGet(this,_PQueue_intervalCap,"f")},_PQueue_doesConcurrentAllowAnother_get=function kt(){return __classPrivateFieldGet(this,_PQueue_pending,"f")<__classPrivateFieldGet(this,_PQueue_concurrency,"f")},_PQueue_next=function kt(){var At;__classPrivateFieldSet(this,_PQueue_pending,(At=__classPrivateFieldGet(this,_PQueue_pending,"f"),At--,At),"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("next")},_PQueue_onResumeInterval=function kt(){__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onInterval).call(this),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),__classPrivateFieldSet(this,_PQueue_timeoutId,void 0,"f")},_PQueue_isIntervalPaused_get=function kt(){const At=Date.now();if(__classPrivateFieldGet(this,_PQueue_intervalId,"f")===void 0){const xt=__classPrivateFieldGet(this,_PQueue_intervalEnd,"f")-At;if(xt<0)__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet(this,_PQueue_pending,"f"):0,"f");else return __classPrivateFieldGet(this,_PQueue_timeoutId,"f")===void 0&&__classPrivateFieldSet(this,_PQueue_timeoutId,setTimeout(()=>{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onResumeInterval).call(this)},xt),"f"),!0}return!1},_PQueue_tryToStartAnother=function kt(){if(__classPrivateFieldGet(this,_PQueue_queue,"f").size===0)return __classPrivateFieldGet(this,_PQueue_intervalId,"f")&&clearInterval(__classPrivateFieldGet(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f"),this.emit("empty"),__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&this.emit("idle"),!1;if(!__classPrivateFieldGet(this,_PQueue_isPaused,"f")){const At=!__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_isIntervalPaused_get);if(__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_doesIntervalAllowAnother_get)&&__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_doesConcurrentAllowAnother_get)){const xt=__classPrivateFieldGet(this,_PQueue_queue,"f").dequeue();return xt?(this.emit("active"),xt(),At&&__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),!0):!1}}return!1},_PQueue_initializeIntervalIfNeeded=function kt(){__classPrivateFieldGet(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet(this,_PQueue_intervalId,"f")!==void 0||(__classPrivateFieldSet(this,_PQueue_intervalId,setInterval(()=>{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onInterval).call(this)},__classPrivateFieldGet(this,_PQueue_interval,"f")),"f"),__classPrivateFieldSet(this,_PQueue_intervalEnd,Date.now()+__classPrivateFieldGet(this,_PQueue_interval,"f"),"f"))},_PQueue_onInterval=function kt(){__classPrivateFieldGet(this,_PQueue_intervalCount,"f")===0&&__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet(this,_PQueue_intervalId,"f")&&(clearInterval(__classPrivateFieldGet(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f")),__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet(this,_PQueue_pending,"f"):0,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)},_PQueue_processQueue=function kt(){for(;__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this););},_PQueue_throwOnAbort=async function kt(At){return new Promise((xt,Bt)=>{At.addEventListener("abort",()=>{Bt(new AbortError("The task was aborted."))},{once:!0})})},_PQueue_onEvent=async function kt(At,xt){return new Promise(Bt=>{const Nt=()=>{xt&&!xt()||(this.off(At,Nt),Bt())};this.on(At,Nt)})};async function walkDAG(kt,At,xt,Bt,Nt,jt,Ut){if(At instanceof Uint8Array){const Vt=extractDataFromBlock(At,Bt,Nt,jt);xt.push(Vt);return}if(At.Data==null)throw errCode$1(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let Lt;try{Lt=UnixFS.unmarshal(At.Data)}catch(Vt){throw errCode$1(Vt,"ERR_NOT_UNIXFS")}if(Lt.data!=null){const Vt=Lt.data,zt=extractDataFromBlock(Vt,Bt,Nt,jt);xt.push(zt),Bt+=BigInt(zt.byteLength)}const Ht=[];if(At.Links.length!==Lt.blockSizes.length)throw errCode$1(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");for(let Vt=0;Vt<At.Links.length;Vt++){const zt=At.Links[Vt],Wt=Bt,Jt=Wt+Lt.blockSizes[Vt];if((Nt>=Wt&&Nt<Jt||jt>=Wt&&jt<=Jt||Nt<Wt&&jt>Jt)&&Ht.push({link:zt,blockStart:Bt}),Bt=Jt,Bt>jt)break}await pipe(Ht,Vt=>map(Vt,zt=>async()=>{const Wt=await kt.get(zt.link.Hash,Ut);return{...zt,block:Wt}}),Vt=>parallel(Vt,{ordered:!0}),async Vt=>{for await(const{link:zt,block:Wt,blockStart:Jt}of Vt){let Qt;switch(zt.Hash.code){case code$4:Qt=decode$a(Wt);break;case code$3:Qt=Wt;break;default:xt.end(errCode$1(new Error(`Unsupported codec: ${zt.Hash.code}`),"ERR_NOT_UNIXFS"));return}const Xt=new PQueue({concurrency:1});Xt.on("error",tr=>{xt.end(tr)}),Xt.add(async()=>{var tr;(tr=Ut.onProgress)==null||tr.call(Ut,new CustomProgressEvent("unixfs:exporter:walk:file",{cid:zt.Hash})),await walkDAG(kt,Qt,xt,Jt,Nt,jt,Ut)}),await Xt.onIdle()}}),Bt>=jt&&xt.end()}const fileContent=(kt,At,xt,Bt,Nt,jt,Ut)=>{async function*Lt(Ht={}){var tr,rr;const Vt=xt.fileSize();if(Vt===void 0)throw new Error("File was a directory");const{start:zt,end:Wt}=validateOffsetAndLength(Vt,Ht.offset,Ht.length);if(Wt===0n)return;let Jt=0n;const Qt=Wt-zt,Xt=pushable();(tr=Ht.onProgress)==null||tr.call(Ht,new CustomProgressEvent("unixfs:exporter:walk:file",{cid:kt})),walkDAG(Ut,At,Xt,0n,zt,Wt,Ht).catch(nr=>{Xt.end(nr)});for await(const nr of Xt)if(nr!=null){if(Jt+=BigInt(nr.byteLength),Jt>Qt)throw Xt.end(),errCode$1(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");Jt===Qt&&Xt.end(),(rr=Ht.onProgress)==null||rr.call(Ht,new CustomProgressEvent("unixfs:exporter:progress:unixfs:file",{bytesRead:Jt,totalBytes:Qt,fileSize:Vt})),yield nr}if(Jt<Qt)throw errCode$1(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ")}return Lt},hamtShardedDirectoryContent=(kt,At,xt,Bt,Nt,jt,Ut)=>{function Lt(Ht={}){var Vt;return(Vt=Ht.onProgress)==null||Vt.call(Ht,new CustomProgressEvent("unixfs:exporter:walk:hamt-sharded-directory",{cid:kt})),listDirectory(At,Bt,Nt,jt,Ut,Ht)}return Lt};async function*listDirectory(kt,At,xt,Bt,Nt,jt){const Ut=kt.Links,Lt=pipe(Ut,Ht=>map(Ht,Vt=>async()=>{var Wt;const zt=Vt.Name!=null?Vt.Name.substring(2):null;if(zt!=null&&zt!==""){const Jt=await xt(Vt.Hash,zt,`${At}/${zt}`,[],Bt+1,Nt,jt);return{entries:Jt.entry==null?[]:[Jt.entry]}}else{const Jt=await Nt.get(Vt.Hash,jt);return kt=decode$a(Jt),(Wt=jt.onProgress)==null||Wt.call(jt,new CustomProgressEvent("unixfs:exporter:walk:hamt-sharded-directory",{cid:Vt.Hash})),{entries:listDirectory(kt,At,xt,Bt,Nt,jt)}}}),Ht=>parallel(Ht,{ordered:!0}));for await(const{entries:Ht}of Lt)yield*Ht}const findLinkCid=(kt,At)=>{const xt=kt.Links.find(Bt=>Bt.Name===At);return xt==null?void 0:xt.Hash},contentExporters={raw:fileContent,file:fileContent,directory:directoryContent,"hamt-sharded-directory":hamtShardedDirectoryContent,metadata:(kt,At,xt,Bt,Nt,jt,Ut)=>()=>[],symlink:(kt,At,xt,Bt,Nt,jt,Ut)=>()=>[]},unixFsResolver=async(kt,At,xt,Bt,Nt,jt,Ut,Lt)=>{const Ht=await Ut.get(kt,Lt),Vt=decode$a(Ht);let zt,Wt;if(At==null&&(At=kt.toString()),Vt.Data==null)throw errCode$1(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{zt=UnixFS.unmarshal(Vt.Data)}catch(Qt){throw errCode$1(Qt,"ERR_NOT_UNIXFS")}if(xt==null&&(xt=At),Bt.length>0){let Qt;if((zt==null?void 0:zt.type)==="hamt-sharded-directory"?Qt=await findShardCid(Vt,Bt[0],Ut):Qt=findLinkCid(Vt,Bt[0]),Qt==null)throw errCode$1(new Error("file does not exist"),"ERR_NOT_FOUND");const Xt=Bt.shift(),tr=`${xt}/${Xt}`;Wt={cid:Qt,toResolve:Bt,name:Xt??"",path:tr}}const Jt=contentExporters[zt.type](kt,Vt,zt,xt,Nt,jt,Ut);if(Jt==null)throw errCode$1(new Error("could not find content exporter"),"ERR_NOT_FOUND");return zt.isDirectory()?{entry:{type:"directory",name:At,path:xt,cid:kt,content:Jt,unixfs:zt,depth:jt,node:Vt,size:zt.fileSize()},next:Wt}:{entry:{type:"file",name:At,path:xt,cid:kt,content:Jt,unixfs:zt,depth:jt,node:Vt,size:zt.fileSize()},next:Wt}},resolvers={[code$4]:unixFsResolver,[code$3]:resolve$1,[code$5]:resolve$3,[identity.code]:resolve$2},resolve=async(kt,At,xt,Bt,Nt,jt,Ut)=>{const Lt=resolvers[kt.code];if(Lt==null)throw errCode$1(new Error(`No resolver for code ${kt.code}`),"ERR_NO_RESOLVER");return Lt(kt,At,xt,Bt,resolve,Nt,jt,Ut)},toPathComponents=(kt="")=>(kt.trim().match(/([^\\^/]|\\\/)+/g)??[]).filter(Boolean),cidAndRest=kt=>{if(kt instanceof Uint8Array)return{cid:CID.decode(kt),toResolve:[]};const At=CID.asCID(kt);if(At!=null)return{cid:At,toResolve:[]};if(typeof kt=="string"){kt.indexOf("/ipfs/")===0&&(kt=kt.substring(6));const xt=toPathComponents(kt);return{cid:CID.parse(xt[0]),toResolve:xt.slice(1)}}throw errCode$1(new Error(`Unknown path type ${kt}`),"ERR_BAD_PATH")};async function*walkPath(kt,At,xt={}){let{cid:Bt,toResolve:Nt}=cidAndRest(kt),jt=Bt.toString(),Ut=jt;const Lt=Nt.length;for(;;){const Ht=await resolve(Bt,jt,Ut,Nt,Lt,At,xt);if(Ht.entry==null&&Ht.next==null)throw errCode$1(new Error(`Could not resolve ${kt}`),"ERR_NOT_FOUND");if(Ht.entry!=null&&(yield Ht.entry),Ht.next==null)return;Nt=Ht.next.toResolve,Bt=Ht.next.cid,jt=Ht.next.name,Ut=Ht.next.path}}async function exporter(kt,At,xt={}){const Bt=await last(walkPath(kt,At,xt));if(Bt==null)throw errCode$1(new Error(`Could not resolve ${kt}`),"ERR_NOT_FOUND");return Bt}var __awaiter$1t=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$4=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};class DataStoreLevel{constructor(At={}){this.config=Object.assign({blockstoreLocation:"DATASTORE",createLevelDatabase},At),this.blockstore=new BlockstoreLevel({location:this.config.blockstoreLocation,createLevelDatabase:this.config.createLevelDatabase})}open(){return __awaiter$1t(this,void 0,void 0,function*(){yield this.blockstore.open()})}close(){return __awaiter$1t(this,void 0,void 0,function*(){yield this.blockstore.close()})}put(At,xt,Bt,Nt){var jt,Ut,Lt,Ht,Vt,zt;return __awaiter$1t(this,void 0,void 0,function*(){const Wt=yield this.getBlockstoreForStoringData(At,xt,Bt),Jt=importer([{content:Nt}],Wt,{cidVersion:1});let Qt;try{for(var Xt=!0,tr=__asyncValues$4(Jt),rr;rr=yield tr.next(),jt=rr.done,!jt;Xt=!0)Ht=rr.value,Xt=!1,Qt=Ht}catch(nr){Ut={error:nr}}finally{try{!Xt&&!jt&&(Lt=tr.return)&&(yield Lt.call(tr))}finally{if(Ut)throw Ut.error}}return{dataSize:Number((zt=(Vt=Qt.unixfs)===null||Vt===void 0?void 0:Vt.fileSize())!==null&&zt!==void 0?zt:Qt.size)}})}get(At,xt,Bt){return __awaiter$1t(this,void 0,void 0,function*(){const Nt=yield this.getBlockstoreForStoringData(At,xt,Bt);if(!(yield Nt.has(Bt)))return;const Ut=yield exporter(Bt,Nt),Lt=Ut.content(),Ht=new browserExports$1.Readable({read(){return __awaiter$1t(this,void 0,void 0,function*(){const zt=yield Lt.next();zt.done?this.push(null):this.push(zt.value)})}});let Vt=Ut.size;return(Ut.type==="file"||Ut.type==="directory")&&(Vt=Ut.unixfs.fileSize()),{dataSize:Number(Vt),dataStream:Ht}})}delete(At,xt,Bt){return __awaiter$1t(this,void 0,void 0,function*(){yield(yield this.getBlockstoreForStoringData(At,xt,Bt)).clear()})}clear(){return __awaiter$1t(this,void 0,void 0,function*(){yield this.blockstore.clear()})}getBlockstoreForStoringData(At,xt,Bt){return __awaiter$1t(this,void 0,void 0,function*(){return yield(yield(yield(yield this.blockstore.partition("data")).partition(At)).partition(xt)).partition(Bt)})}}var __awaiter$1s=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$3=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}},__await$1=function(kt){return this instanceof __await$1?(this.v=kt,this):new __await$1(kt)},__asyncGenerator=function(kt,At,xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Bt=xt.apply(kt,At||[]),Nt,jt=[];return Nt={},Ut("next"),Ut("throw"),Ut("return"),Nt[Symbol.asyncIterator]=function(){return this},Nt;function Ut(Jt){Bt[Jt]&&(Nt[Jt]=function(Qt){return new Promise(function(Xt,tr){jt.push([Jt,Qt,Xt,tr])>1||Lt(Jt,Qt)})})}function Lt(Jt,Qt){try{Ht(Bt[Jt](Qt))}catch(Xt){Wt(jt[0][3],Xt)}}function Ht(Jt){Jt.value instanceof __await$1?Promise.resolve(Jt.value.v).then(Vt,zt):Wt(jt[0][2],Jt)}function Vt(Jt){Lt("next",Jt)}function zt(Jt){Lt("throw",Jt)}function Wt(Jt,Qt){Jt(Qt),jt.shift(),jt.length&&Lt(jt[0][0],jt[0][1])}};const INDEX_SUBLEVEL_NAME="index";class IndexLevel{constructor(At){this.config=Object.assign({createLevelDatabase},At),this.db=new LevelWrapper({location:this.config.location,createLevelDatabase:this.config.createLevelDatabase,keyEncoding:"utf8"})}open(){return __awaiter$1s(this,void 0,void 0,function*(){yield this.db.open()})}close(){return __awaiter$1s(this,void 0,void 0,function*(){yield this.db.close()})}clear(){return __awaiter$1s(this,void 0,void 0,function*(){yield this.db.clear()})}put(At,xt,Bt,Nt){return __awaiter$1s(this,void 0,void 0,function*(){if(isEmptyObject$1(Bt))throw new DwnError(DwnErrorCode.IndexMissingIndexableProperty,"Index must include at least one valid indexable property");const jt={messageCid:xt,indexes:Bt},Ut=[];for(const zt in Bt){const Wt=Bt[zt];if(Array.isArray(Wt))for(const Jt of Wt){const Qt=this.createPutIndexedItemOperation(At,jt,zt,Jt);Ut.push(Qt)}else{const Jt=this.createPutIndexedItemOperation(At,jt,zt,Wt);Ut.push(Jt)}}const Lt=this.createOperationForIndexesLookupPartition(At,{type:"put",key:xt,value:JSON.stringify(Bt)});Ut.push(Lt);const Ht=yield Promise.all(Ut);yield(yield this.db.partition(At)).batch(Ht,Nt)})}delete(At,xt,Bt){return __awaiter$1s(this,void 0,void 0,function*(){const Nt=[],jt=yield this.getIndexes(At,xt);if(jt===void 0)return;const Ut=this.createOperationForIndexesLookupPartition(At,{type:"del",key:xt});Nt.push(Ut);for(const Vt in jt){const zt=jt[Vt];if(Array.isArray(zt))for(const Wt of zt){const Jt=this.createDeleteIndexedItemOperation(At,xt,Vt,Wt);Nt.push(Jt)}else{const Wt=this.createDeleteIndexedItemOperation(At,xt,Vt,zt);Nt.push(Wt)}}const Lt=yield Promise.all(Nt);yield(yield this.db.partition(At)).batch(Lt,Bt)})}createPutIndexedItemOperation(At,xt,Bt,Nt){return __awaiter$1s(this,void 0,void 0,function*(){const{messageCid:jt}=xt,Ut=IndexLevel.keySegmentJoin(IndexLevel.encodeValue(Nt),jt);return this.createOperationForIndexPartition(At,Bt,{type:"put",key:Ut,value:JSON.stringify(xt)})})}createDeleteIndexedItemOperation(At,xt,Bt,Nt){return __awaiter$1s(this,void 0,void 0,function*(){const jt=IndexLevel.keySegmentJoin(IndexLevel.encodeValue(Nt),xt);return this.createOperationForIndexPartition(At,Bt,{type:"del",key:jt})})}createOperationForIndexPartition(At,xt,Bt){return __awaiter$1s(this,void 0,void 0,function*(){const Nt=yield this.db.partition(At),jt=IndexLevel.getIndexPartitionName(xt);return Nt.createPartitionOperation(jt,Bt)})}createOperationForIndexesLookupPartition(At,xt){return __awaiter$1s(this,void 0,void 0,function*(){return(yield this.db.partition(At)).createPartitionOperation(INDEX_SUBLEVEL_NAME,xt)})}static getIndexPartitionName(At){return`__${At}__`}getIndexPartition(At,xt){return __awaiter$1s(this,void 0,void 0,function*(){const Bt=IndexLevel.getIndexPartitionName(xt);return(yield this.db.partition(At)).partition(Bt)})}getIndexesLookupPartition(At){return __awaiter$1s(this,void 0,void 0,function*(){return(yield this.db.partition(At)).partition(INDEX_SUBLEVEL_NAME)})}query(At,xt,Bt,Nt){return __awaiter$1s(this,void 0,void 0,function*(){return IndexLevel.shouldQueryWithInMemoryPaging(xt,Bt)?this.queryWithInMemoryPaging(At,xt,Bt,Nt):this.queryWithIteratorPaging(At,xt,Bt,Nt)})}queryWithIteratorPaging(At,xt,Bt,Nt){var jt,Ut,Lt,Ht;return __awaiter$1s(this,void 0,void 0,function*(){const{cursor:Vt,limit:zt}=Bt,Wt=Vt?this.createStartingKeyFromCursor(Vt):"",Jt=[];try{for(var Qt=!0,Xt=__asyncValues$3(this.getIndexIterator(At,Wt,Bt,Nt)),tr;tr=yield Xt.next(),jt=tr.done,!jt;Qt=!0){Ht=tr.value,Qt=!1;const rr=Ht;if(zt!==void 0&&zt===Jt.length)break;const{indexes:nr}=rr;FilterUtility.matchAnyFilter(nr,xt)&&Jt.push(rr)}}catch(rr){Ut={error:rr}}finally{try{!Qt&&!jt&&(Lt=Xt.return)&&(yield Lt.call(Xt))}finally{if(Ut)throw Ut.error}}return Jt})}getIndexIterator(At,xt,Bt,Nt){return __asyncGenerator(this,arguments,function*(){var Ut,Lt,Ht,Vt;const{sortProperty:zt,sortDirection:Wt=SortDirection.Ascending,cursor:Jt}=Bt,Qt={gt:xt};Wt===SortDirection.Descending&&(Qt.reverse=!0,Jt!==void 0&&(Qt.lt=xt,delete Qt.gt));const Xt=yield __await$1(this.getIndexPartition(At,zt));try{for(var tr=!0,rr=__asyncValues$3(Xt.iterator(Qt,Nt)),nr;nr=yield __await$1(rr.next()),Ut=nr.done,!Ut;tr=!0){Vt=nr.value,tr=!1;const[ar,ir]=Vt,{indexes:lr,messageCid:yr}=JSON.parse(ir);yield yield __await$1({indexes:lr,messageCid:yr})}}catch(ar){Lt={error:ar}}finally{try{!tr&&!Ut&&(Ht=rr.return)&&(yield __await$1(Ht.call(rr)))}finally{if(Lt)throw Lt.error}}})}createStartingKeyFromCursor(At){const{messageCid:xt,value:Bt}=At;return IndexLevel.keySegmentJoin(IndexLevel.encodeValue(Bt),xt)}static createCursorFromLastArrayItem(At,xt){if(At.length>0)return this.createCursorFromItem(At.at(-1),xt)}static createCursorFromItem(At,xt){const{messageCid:Bt,indexes:Nt}=At,jt=Nt[xt];if(jt===void 0)throw new DwnError(DwnErrorCode.IndexInvalidCursorSortProperty,`the sort property '${xt}' is not defined within the given item.`);if(typeof jt=="boolean"||Array.isArray(jt))throw new DwnError(DwnErrorCode.IndexInvalidCursorValueType,`only string or number values are supported for cursors, a(n) ${typeof jt} was given.`);return{messageCid:Bt,value:jt}}queryWithInMemoryPaging(At,xt,Bt,Nt){return __awaiter$1s(this,void 0,void 0,function*(){const{sortProperty:jt,sortDirection:Ut=SortDirection.Ascending,cursor:Lt,limit:Ht}=Bt,Vt=Lt?this.createStartingKeyFromCursor(Lt):void 0,zt=new Map;xt.length===0&&(xt=[{}]);try{yield Promise.all(xt.map(Xt=>this.executeSingleFilterQuery(At,Xt,jt,zt,Nt)))}catch(Xt){if(Xt.code===DwnErrorCode.IndexInvalidSortPropertyInMemory)return[]}const Wt=[...zt.values()].sort((Xt,tr)=>this.sortItems(Xt,tr,jt,Ut)),Jt=Vt!==void 0?this.findCursorStartingIndex(Wt,Ut,jt,Vt):0;if(Jt<0)return[];const Qt=Ht!==void 0?Jt+Ht:void 0;return Wt.slice(Jt,Qt)})}executeSingleFilterQuery(At,xt,Bt,Nt,jt){return __awaiter$1s(this,void 0,void 0,function*(){const Ut=[];if(isEmptyObject$1(xt)){const Ht=this.getAllItems(At,Bt);Ut.push(Ht)}const Lt=FilterSelector.reduceFilter(xt);for(const Ht in Lt){const Vt=Lt[Ht];if(FilterUtility.isEqualFilter(Vt)){const zt=this.filterExactMatches(At,Ht,Vt,jt);Ut.push(zt)}else if(FilterUtility.isOneOfFilter(Vt))for(const zt of new Set(Vt)){const Wt=this.filterExactMatches(At,Ht,zt,jt);Ut.push(Wt)}else if(FilterUtility.isRangeFilter(Vt)){const zt=this.filterRangeMatches(At,Ht,Vt,jt);Ut.push(zt)}}for(const Ht of Ut){const Vt=yield Ht;for(const zt of Vt)if(!(Nt.has(zt.messageCid)||!FilterUtility.matchFilter(zt.indexes,xt))){if(zt.indexes[Bt]===void 0)throw new DwnError(DwnErrorCode.IndexInvalidSortPropertyInMemory,`invalid sort property ${Bt}`);Nt.set(zt.messageCid,zt)}}})}getAllItems(At,xt){var Bt,Nt,jt,Ut;return __awaiter$1s(this,void 0,void 0,function*(){const Lt=yield this.getIndexPartition(At,xt),Ht=[];try{for(var Vt=!0,zt=__asyncValues$3(Lt.iterator()),Wt;Wt=yield zt.next(),Bt=Wt.done,!Bt;Vt=!0){Ut=Wt.value,Vt=!1;const[Jt,Qt]=Ut;Ht.push(JSON.parse(Qt))}}catch(Jt){Nt={error:Jt}}finally{try{!Vt&&!Bt&&(jt=zt.return)&&(yield jt.call(zt))}finally{if(Nt)throw Nt.error}}return Ht})}filterExactMatches(At,xt,Bt,Nt){var jt,Ut,Lt,Ht;return __awaiter$1s(this,void 0,void 0,function*(){const Vt=IndexLevel.keySegmentJoin(IndexLevel.encodeValue(Bt)),zt={gt:Vt},Wt=yield this.getIndexPartition(At,xt),Jt=[];try{for(var Qt=!0,Xt=__asyncValues$3(Wt.iterator(zt,Nt)),tr;tr=yield Xt.next(),jt=tr.done,!jt;Qt=!0){Ht=tr.value,Qt=!1;const[rr,nr]=Ht;if(!rr.startsWith(Vt))break;Jt.push(JSON.parse(nr))}}catch(rr){Ut={error:rr}}finally{try{!Qt&&!jt&&(Lt=Xt.return)&&(yield Lt.call(Xt))}finally{if(Ut)throw Ut.error}}return Jt})}filterRangeMatches(At,xt,Bt,Nt){var jt,Ut,Lt,Ht;return __awaiter$1s(this,void 0,void 0,function*(){const Vt={};for(const tr in Bt){const rr=tr;Vt[rr]=IndexLevel.encodeValue(Bt[rr])}Vt.gt===void 0&&Vt.gte===void 0&&(Vt.reverse=!0);const zt=[],Wt=yield this.getIndexPartition(At,xt);try{for(var Jt=!0,Qt=__asyncValues$3(Wt.iterator(Vt,Nt)),Xt;Xt=yield Qt.next(),jt=Xt.done,!jt;Jt=!0){Ht=Xt.value,Jt=!1;const[tr,rr]=Ht;"gt"in Bt&&this.extractIndexValueFromKey(tr)===IndexLevel.encodeValue(Bt.gt)||zt.push(JSON.parse(rr))}}catch(tr){Ut={error:tr}}finally{try{!Jt&&!jt&&(Lt=Qt.return)&&(yield Lt.call(Qt))}finally{if(Ut)throw Ut.error}}if("lte"in Bt)for(const tr of yield this.filterExactMatches(At,xt,Bt.lte,Nt))zt.push(tr);return zt})}sortItems(At,xt,Bt,Nt){const jt=At.indexes[Bt],Ut=xt.indexes[Bt],Lt=IndexLevel.encodeValue(jt)+At.messageCid,Ht=IndexLevel.encodeValue(Ut)+xt.messageCid;return Nt===SortDirection.Ascending?lexicographicalCompare(Lt,Ht):lexicographicalCompare(Ht,Lt)}findCursorStartingIndex(At,xt,Bt,Nt){const jt=Ut=>{const{messageCid:Lt,indexes:Ht}=Ut,Vt=Ht[Bt],zt=IndexLevel.keySegmentJoin(IndexLevel.encodeValue(Vt),Lt);return xt===SortDirection.Ascending?zt>Nt:zt<Nt};return At.findIndex(jt)}getIndexes(At,xt){return __awaiter$1s(this,void 0,void 0,function*(){const Nt=yield(yield this.getIndexesLookupPartition(At)).get(xt);if(Nt!==void 0)return JSON.parse(Nt)})}extractIndexValueFromKey(At){const[xt]=At.split(IndexLevel.delimiter);return xt}static keySegmentJoin(...At){return At.join(IndexLevel.delimiter)}static encodeNumberValue(At){const xt=Number.MAX_SAFE_INTEGER,Bt="!",Nt=String(Number.MAX_SAFE_INTEGER).length,jt=At<0?Bt:"",Ut=At<0?xt:0;return jt+String(At+Ut).padStart(Nt,"0")}static encodeValue(At){switch(typeof At){case"number":return this.encodeNumberValue(At);default:return JSON.stringify(At)}}static shouldQueryWithInMemoryPaging(At,xt){for(const Bt of At)if(!IndexLevel.isFilterConcise(Bt,xt))return!1;return!0}static isFilterConcise(At,xt){return At.recordId!==void 0?!0:xt.cursor!==void 0?!1:At.protocolPath!==void 0||At.contextId!==void 0||At.parentId!==void 0||At.schema!==void 0}}IndexLevel.delimiter="\0";function assertError(kt){if(!isError(kt))throw new Error("Parameter was not an error")}function isError(kt){return objectToString(kt)==="[object Error]"||kt instanceof Error}function objectToString(kt){return Object.prototype.toString.call(kt)}function parseArguments(kt){let At,xt="";if(kt.length===0)At={};else if(isError(kt[0]))At={cause:kt[0]},xt=kt.slice(1).join(" ")||"";else if(kt[0]&&typeof kt[0]=="object")At=Object.assign({},kt[0]),xt=kt.slice(1).join(" ")||"";else if(typeof kt[0]=="string")At={},xt=xt=kt.join(" ")||"";else throw new Error("Invalid arguments passed to Layerr");return{options:At,shortMessage:xt}}class Layerr extends Error{constructor(At,xt){const Bt=[...arguments],{options:Nt,shortMessage:jt}=parseArguments(Bt);let Ut=jt;if(Nt.cause&&(Ut=`${Ut}: ${Nt.cause.message}`),super(Ut),this.message=Ut,Nt.name&&typeof Nt.name=="string"?this.name=Nt.name:this.name="Layerr",Nt.cause&&Object.defineProperty(this,"_cause",{value:Nt.cause}),Object.defineProperty(this,"_info",{value:{}}),Nt.info&&typeof Nt.info=="object"&&Object.assign(this._info,Nt.info),Error.captureStackTrace){const Lt=Nt.constructorOpt||this.constructor;Error.captureStackTrace(this,Lt)}}static cause(At){return assertError(At),At._cause&&isError(At._cause)?At._cause:null}static fullStack(At){assertError(At);const xt=Layerr.cause(At);return xt?`${At.stack}
caused by: ${Layerr.fullStack(xt)}`:At.stack}static info(At){assertError(At);const xt={},Bt=Layerr.cause(At);return Bt&&Object.assign(xt,Layerr.info(Bt)),At._info&&Object.assign(xt,At._info),xt}cause(){return Layerr.cause(this)}toString(){let At=this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(At=`${At}: ${this.message}`),At}}const ENCODING="0123456789ABCDEFGHJKMNPQRSTVWXYZ",ENCODING_LEN=32,TIME_MAX=0xffffffffffff,TIME_LEN=10,RANDOM_LEN=16,ERROR_INFO=Object.freeze({source:"ulid"});function detectPRNG(kt){const At=detectRoot(),xt=At&&(At.crypto||At.msCrypto)||null;if(typeof(xt==null?void 0:xt.getRandomValues)=="function")return()=>{const Bt=new Uint8Array(1);return xt.getRandomValues(Bt),Bt[0]/255};if(typeof(xt==null?void 0:xt.randomBytes)=="function")return()=>xt.randomBytes(1).readUInt8()/255;throw new Layerr({info:{code:"PRNG_DETECT",...ERROR_INFO}},"Failed to find a reliable PRNG")}function detectRoot(){return inWebWorker()?self:typeof window<"u"?window:typeof globalThis<"u"||typeof globalThis<"u"?globalThis:null}function encodeRandom(kt,At){let xt="";for(;kt>0;kt--)xt=randomChar(At)+xt;return xt}function encodeTime(kt,At){if(isNaN(kt))throw new Layerr({info:{code:"ENC_TIME_NAN",...ERROR_INFO}},`Time must be a number: ${kt}`);if(kt>TIME_MAX)throw new Layerr({info:{code:"ENC_TIME_SIZE_EXCEED",...ERROR_INFO}},`Cannot encode a time larger than ${TIME_MAX}: ${kt}`);if(kt<0)throw new Layerr({info:{code:"ENC_TIME_NEG",...ERROR_INFO}},`Time must be positive: ${kt}`);if(Number.isInteger(kt)===!1)throw new Layerr({info:{code:"ENC_TIME_TYPE",...ERROR_INFO}},`Time must be an integer: ${kt}`);let xt,Bt="";for(let Nt=At;Nt>0;Nt--)xt=kt%ENCODING_LEN,Bt=ENCODING.charAt(xt)+Bt,kt=(kt-xt)/ENCODING_LEN;return Bt}function incrementBase32(kt){let At,xt=kt.length,Bt,Nt,jt=kt;const Ut=ENCODING_LEN-1;for(;!At&&xt-->=0;){if(Bt=jt[xt],Nt=ENCODING.indexOf(Bt),Nt===-1)throw new Layerr({info:{code:"B32_INC_ENC",...ERROR_INFO}},"Incorrectly encoded string");if(Nt===Ut){jt=replaceCharAt(jt,xt,ENCODING[0]);continue}At=replaceCharAt(jt,xt,ENCODING[Nt+1])}if(typeof At=="string")return At;throw new Layerr({info:{code:"B32_INC_INVALID",...ERROR_INFO}},"Failed incrementing string")}function inWebWorker(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function monotonicFactory(kt){const At=detectPRNG();let xt=0,Bt;return function(jt){const Ut=isNaN(jt)?Date.now():jt;if(Ut<=xt){const Ht=Bt=incrementBase32(Bt);return encodeTime(xt,TIME_LEN)+Ht}xt=Ut;const Lt=Bt=encodeRandom(RANDOM_LEN,At);return encodeTime(Ut,TIME_LEN)+Lt}}function randomChar(kt){let At=Math.floor(kt()*ENCODING_LEN);return At===ENCODING_LEN&&(At=ENCODING_LEN-1),ENCODING.charAt(At)}function replaceCharAt(kt,At,xt){return At>kt.length-1?kt:kt.substr(0,At)+xt+kt.substr(At+1)}var __awaiter$1r=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class EventLogLevel{constructor(At){this.index=new IndexLevel(Object.assign({location:"EVENTLOG",createLevelDatabase},At)),this.ulidFactory=monotonicFactory()}open(){return __awaiter$1r(this,void 0,void 0,function*(){return this.index.open()})}close(){return __awaiter$1r(this,void 0,void 0,function*(){return this.index.close()})}clear(){return __awaiter$1r(this,void 0,void 0,function*(){return this.index.clear()})}append(At,xt,Bt){return __awaiter$1r(this,void 0,void 0,function*(){const Nt=this.ulidFactory();yield this.index.put(At,xt,Object.assign(Object.assign({},Bt),{watermark:Nt}))})}queryEvents(At,xt,Bt){return __awaiter$1r(this,void 0,void 0,function*(){const Nt=yield this.index.query(At,xt,{sortProperty:"watermark",cursor:Bt});return{events:Nt.map(({messageCid:jt})=>jt),cursor:IndexLevel.createCursorFromLastArrayItem(Nt,"watermark")}})}getEvents(At,xt){return __awaiter$1r(this,void 0,void 0,function*(){return this.queryEvents(At,[],xt)})}deleteEventsByCid(At,xt){return __awaiter$1r(this,void 0,void 0,function*(){const Bt=[];for(const Nt of xt)Bt.push(this.index.delete(At,Nt));yield Promise.all(Bt)})}}function readonly({enumerable:kt=!0,configurable:At=!1}={}){return{enumerable:kt,configurable:At,writable:!1}}function*linksWithin(kt,At){if(At!=null&&typeof At=="object")if(Array.isArray(At))for(const[xt,Bt]of At.entries()){const Nt=[...kt,xt],jt=CID.asCID(Bt);jt?yield[Nt.join("/"),jt]:typeof Bt=="object"&&(yield*links(Bt,Nt))}else{const xt=CID.asCID(At);xt?yield[kt.join("/"),xt]:yield*links(At,kt)}}function*links(kt,At){if(kt==null||kt instanceof Uint8Array)return;const xt=CID.asCID(kt);xt&&(yield[At.join("/"),xt]);for(const[Bt,Nt]of Object.entries(kt)){const jt=[...At,Bt];yield*linksWithin(jt,Nt)}}function*treeWithin(kt,At){if(Array.isArray(At))for(const[xt,Bt]of At.entries()){const Nt=[...kt,xt];yield Nt.join("/"),typeof Bt=="object"&&!CID.asCID(Bt)&&(yield*tree(Bt,Nt))}else yield*tree(At,kt)}function*tree(kt,At){if(!(kt==null||typeof kt!="object"))for(const[xt,Bt]of Object.entries(kt)){const Nt=[...At,xt];yield Nt.join("/"),Bt!=null&&!(Bt instanceof Uint8Array)&&typeof Bt=="object"&&!CID.asCID(Bt)&&(yield*treeWithin(Nt,Bt))}}function get(kt,At){let xt=kt;for(const[Bt,Nt]of At.entries()){if(xt=xt[Nt],xt==null)throw new Error(`Object has no property at ${At.slice(0,Bt+1).map(Ut=>`[${JSON.stringify(Ut)}]`).join("")}`);const jt=CID.asCID(xt);if(jt)return{value:jt,remaining:At.slice(Bt+1).join("/")}}return{value:xt}}class Block{constructor({cid:At,bytes:xt,value:Bt}){if(!At||!xt||typeof Bt>"u")throw new Error("Missing required argument");this.cid=At,this.bytes=xt,this.value=Bt,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links(this.value,[])}tree(){return tree(this.value,[])}get(At="/"){return get(this.value,At.split("/").filter(Boolean))}}async function encode({value:kt,codec:At,hasher:xt}){if(typeof kt>"u")throw new Error('Missing required argument "value"');if(!At||!xt)throw new Error("Missing required argument: codec or hasher");const Bt=At.encode(kt),Nt=await xt.digest(Bt),jt=CID.create(1,At.code,Nt);return new Block({value:kt,bytes:Bt,cid:jt})}async function decode({bytes:kt,codec:At,hasher:xt}){if(!kt)throw new Error('Missing required argument "bytes"');if(!At||!xt)throw new Error("Missing required argument: codec or hasher");const Bt=At.decode(kt),Nt=await xt.digest(kt),jt=CID.create(1,At.code,Nt);return new Block({value:Bt,bytes:kt,cid:jt})}var __awaiter$1q=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class MessageStoreLevel{constructor(At={}){this.config=Object.assign({blockstoreLocation:"MESSAGESTORE",indexLocation:"INDEX",createLevelDatabase},At),this.blockstore=new BlockstoreLevel({location:this.config.blockstoreLocation,createLevelDatabase:this.config.createLevelDatabase}),this.index=new IndexLevel({location:this.config.indexLocation,createLevelDatabase:this.config.createLevelDatabase})}open(){return __awaiter$1q(this,void 0,void 0,function*(){yield this.blockstore.open(),yield this.index.open()})}close(){return __awaiter$1q(this,void 0,void 0,function*(){yield this.blockstore.close(),yield this.index.close()})}get(At,xt,Bt){var Nt;return __awaiter$1q(this,void 0,void 0,function*(){(Nt=Bt==null?void 0:Bt.signal)===null||Nt===void 0||Nt.throwIfAborted();const jt=yield executeUnlessAborted(this.blockstore.partition(At),Bt==null?void 0:Bt.signal),Ut=CID.parse(xt),Lt=yield jt.get(Ut,Bt);return Lt?(yield executeUnlessAborted(decode({bytes:Lt,codec:cbor,hasher:sha256$7}),Bt==null?void 0:Bt.signal)).value:void 0})}query(At,xt,Bt,Nt,jt){var Ut;return __awaiter$1q(this,void 0,void 0,function*(){(Ut=jt==null?void 0:jt.signal)===null||Ut===void 0||Ut.throwIfAborted();const Lt=MessageStoreLevel.buildQueryOptions(Bt,Nt),Ht=yield this.index.query(At,xt,Lt,jt);let Vt;(Nt==null?void 0:Nt.limit)!==void 0&&Nt.limit<Ht.length&&(Ht.splice(-1),Vt=IndexLevel.createCursorFromLastArrayItem(Ht,Lt.sortProperty));const zt=[];for(let Wt=0;Wt<Ht.length;Wt++){const{messageCid:Jt}=Ht[Wt],Qt=yield this.get(At,Jt,jt);Qt&&zt.push(Qt)}return{messages:zt,cursor:Vt}})}static buildQueryOptions(At={},xt={}){let{limit:Bt,cursor:Nt}=xt;const{dateCreated:jt,datePublished:Ut,messageTimestamp:Lt}=At;let Ht=SortDirection.Ascending,Vt="messageTimestamp";return jt!==void 0?Vt="dateCreated":Ut!==void 0?Vt="datePublished":Lt!==void 0&&(Vt="messageTimestamp"),At[Vt]!==void 0&&(Ht=At[Vt]),Bt!==void 0&&Bt>0&&(Bt=Bt+1),{sortDirection:Ht,sortProperty:Vt,limit:Bt,cursor:Nt}}delete(At,xt,Bt){var Nt;return __awaiter$1q(this,void 0,void 0,function*(){(Nt=Bt==null?void 0:Bt.signal)===null||Nt===void 0||Nt.throwIfAborted();const jt=yield executeUnlessAborted(this.blockstore.partition(At),Bt==null?void 0:Bt.signal),Ut=CID.parse(xt);yield jt.delete(Ut,Bt),yield this.index.delete(At,xt,Bt)})}put(At,xt,Bt,Nt){var jt;return __awaiter$1q(this,void 0,void 0,function*(){(jt=Nt==null?void 0:Nt.signal)===null||jt===void 0||jt.throwIfAborted();const Ut=yield executeUnlessAborted(this.blockstore.partition(At),Nt==null?void 0:Nt.signal),Lt=yield executeUnlessAborted(encode({value:xt,codec:cbor,hasher:sha256$7}),Nt==null?void 0:Nt.signal),Ht=Cid.parseCid(yield Message.getCid(xt));yield Ut.put(Ht,Lt.bytes,Nt);const Vt=Ht.toString();yield this.index.put(At,Vt,Bt,Nt)})}clear(){return __awaiter$1q(this,void 0,void 0,function*(){yield this.blockstore.clear(),yield this.index.clear()})}}var __awaiter$1p=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$2=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};class ResumableTaskStoreLevel{constructor(At){this.config=Object.assign({location:"RESUMABLE-TASK-STORE",createLevelDatabase},At),this.db=new LevelWrapper({location:this.config.location,createLevelDatabase:this.config.createLevelDatabase,keyEncoding:"utf8"})}open(){return __awaiter$1p(this,void 0,void 0,function*(){yield this.db.open()})}close(){return __awaiter$1p(this,void 0,void 0,function*(){yield this.db.close()})}register(At,xt){return __awaiter$1p(this,void 0,void 0,function*(){const Bt=yield Cid.computeCid(At),Nt={id:Bt,timeout:Date.now()+xt*1e3,retryCount:0,task:At};return yield this.db.put(Bt,JSON.stringify(Nt)),Nt})}grab(At){var xt,Bt,Nt,jt;return __awaiter$1p(this,void 0,void 0,function*(){const Ut=[];try{for(var Lt=!0,Ht=__asyncValues$2(this.db.iterator()),Vt;Vt=yield Ht.next(),xt=Vt.done,!xt;Lt=!0){jt=Vt.value,Lt=!1;const[zt,Wt]=jt,Jt=JSON.parse(Wt);if(Date.now()>=Jt.timeout&&(Jt.timeout=Date.now()+ResumableTaskStoreLevel.taskTimeoutInSeconds*1e3,Jt.retryCount++,yield this.db.put(Jt.id,JSON.stringify(Jt)),Ut.push(Jt)),Ut.length>=At)break}}catch(zt){Bt={error:zt}}finally{try{!Lt&&!xt&&(Nt=Ht.return)&&(yield Nt.call(Ht))}finally{if(Bt)throw Bt.error}}return Ut})}read(At){return __awaiter$1p(this,void 0,void 0,function*(){const xt=yield this.db.get(At);if(xt)return JSON.parse(xt)})}extend(At,xt){return __awaiter$1p(this,void 0,void 0,function*(){const Bt=yield this.db.get(At);if(Bt){const Nt=JSON.parse(Bt);Nt.timeout=Date.now()+xt*1e3,yield this.db.put(Nt.id,JSON.stringify(Nt))}})}delete(At){return __awaiter$1p(this,void 0,void 0,function*(){return this.db.delete(At)})}clear(){return __awaiter$1p(this,void 0,void 0,function*(){yield this.db.clear()})}}ResumableTaskStoreLevel.taskTimeoutInSeconds=60;var DwnInterface;(function(kt){kt.MessagesQuery="MessagesQuery",kt.MessagesRead="MessagesRead",kt.MessagesSubscribe="MessagesSubscribe",kt.ProtocolsConfigure="ProtocolsConfigure",kt.ProtocolsQuery="ProtocolsQuery",kt.RecordsDelete="RecordsDelete",kt.RecordsQuery="RecordsQuery",kt.RecordsRead="RecordsRead",kt.RecordsSubscribe="RecordsSubscribe",kt.RecordsWrite="RecordsWrite"})(DwnInterface||(DwnInterface={}));const dwnMessageConstructors={[DwnInterface.MessagesQuery]:MessagesQuery,[DwnInterface.MessagesRead]:MessagesRead,[DwnInterface.MessagesSubscribe]:MessagesSubscribe,[DwnInterface.ProtocolsConfigure]:ProtocolsConfigure,[DwnInterface.ProtocolsQuery]:ProtocolsQuery,[DwnInterface.RecordsDelete]:RecordsDelete,[DwnInterface.RecordsQuery]:RecordsQuery,[DwnInterface.RecordsRead]:RecordsRead,[DwnInterface.RecordsSubscribe]:RecordsSubscribe,[DwnInterface.RecordsWrite]:RecordsWrite};var DidVerificationRelationship$1;(function(kt){kt.authentication="authentication",kt.assertionMethod="assertionMethod",kt.keyAgreement="keyAgreement",kt.capabilityInvocation="capabilityInvocation",kt.capabilityDelegation="capabilityDelegation"})(DidVerificationRelationship$1||(DidVerificationRelationship$1={}));const EMPTY_DID_RESOLUTION_RESULT$1={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};let Did$1=class ps{constructor({method:At,id:xt,path:Bt,query:Nt,fragment:jt,params:Ut}){this.uri=`did:${At}:${xt}`,this.method=At,this.id=xt,this.path=Bt,this.query=Nt,this.fragment=jt,this.params=Ut}static parse(At){if(!At)return null;const xt=ps.DID_URI_PATTERN.exec(At);if(!xt||!xt.groups)return null;const{method:Bt,id:Nt,path:jt,query:Ut,fragment:Lt}=xt.groups,Ht={uri:`did:${Bt}:${Nt}`,method:Bt,id:Nt};if(jt&&(Ht.path=jt),Ut&&(Ht.query=Ut.slice(1)),Lt&&(Ht.fragment=Lt.slice(1)),Ut){const Vt={},zt=Ut.slice(1).split("&");for(const Wt of zt){const[Jt,Qt]=Wt.split("=");Vt[Jt]=Qt}Ht.params=Vt}return Ht}};Did$1.METHOD_PATTERN="([a-z0-9]+)";Did$1.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Did$1.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Did$1.PCT_ENCODED_PATTERN})`;Did$1.METHOD_ID_PATTERN=`((?:${Did$1.ID_CHAR_PATTERN}*:)*(${Did$1.ID_CHAR_PATTERN}+))`;Did$1.PATH_PATTERN="(/[^#?]*)?";Did$1.QUERY_PATTERN="([?][^#]*)?";Did$1.FRAGMENT_PATTERN="(#.*)?";Did$1.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Did$1.METHOD_PATTERN}):(?<id>${Did$1.METHOD_ID_PATTERN})(?<path>${Did$1.PATH_PATTERN})(?<query>${Did$1.QUERY_PATTERN})(?<fragment>${Did$1.FRAGMENT_PATTERN})$`);let DidError$1=class ys extends Error{constructor(At,xt){super(`${At}: ${xt}`),this.code=At,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ys)}};var DidErrorCode$1;(function(kt){kt.InvalidDid="invalidDid",kt.MethodNotSupported="methodNotSupported",kt.InternalError="internalError",kt.InvalidDidDocument="invalidDidDocument",kt.InvalidDidDocumentLength="invalidDidDocumentLength",kt.InvalidDidUrl="invalidDidUrl",kt.InvalidPreviousDidProof="invalidPreviousDidProof",kt.InvalidPublicKey="invalidPublicKey",kt.InvalidPublicKeyLength="invalidPublicKeyLength",kt.InvalidPublicKeyType="invalidPublicKeyType",kt.InvalidSignature="invalidSignature",kt.NotFound="notFound",kt.RepresentationNotSupported="representationNotSupported",kt.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(DidErrorCode$1||(DidErrorCode$1={}));var __awaiter$1o=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let Sha256$1=class{static digest(At){return __awaiter$1o(this,arguments,void 0,function*({data:xt}){return sha256$5(xt)})}},CryptoAlgorithm$1=class{};var __awaiter$1n=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let Sha2Algorithm$1=class extends CryptoAlgorithm$1{digest(At){return __awaiter$1n(this,arguments,void 0,function*({algorithm:xt,data:Bt}){switch(xt){case"SHA-256":return yield Sha256$1.digest({data:Bt})}})}};function canonicalize$2(kt){const At=Bt=>{if(Bt!==null&&typeof Bt=="object"&&!Array.isArray(Bt)){const Nt=Object.keys(Bt).sort(),jt={};for(const Ut of Nt)jt[Ut]=At(Bt[Ut]);return jt}return Bt},xt=At(kt);return JSON.stringify(xt)}var __awaiter$1m=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const KEY_URI_PREFIX_JWK$1="urn:jwk:";function computeJwkThumbprint$1(kt){return __awaiter$1m(this,arguments,void 0,function*({jwk:At}){const xt=At.kty;let Bt;if(xt==="EC")Bt={crv:At.crv,kty:At.kty,x:At.x,y:At.y};else if(xt==="oct")Bt={k:At.k,kty:At.kty};else if(xt==="OKP")Bt={crv:At.crv,kty:At.kty,x:At.x};else if(xt==="RSA")Bt={e:At.e,kty:At.kty,n:At.n};else throw new Error(`Unsupported key type: ${xt}`);removeUndefinedProperties$1(Bt);const Nt=canonicalize$2(Bt),jt=Convert$2.string(Nt).toUint8Array(),Ut=yield Sha256$1.digest({data:jt});return Convert$2.uint8Array(Ut).toBase64Url()})}function isEcPrivateJwk$1(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt&&"d"in kt)||kt.kty!=="EC"||typeof kt.d!="string"||typeof kt.x!="string")}function isEcPublicJwk$1(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt)||"d"in kt||kt.kty!=="EC"||typeof kt.x!="string")}function isOctPrivateJwk(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"k"in kt)||kt.kty!=="oct"||typeof kt.k!="string")}function isOkpPrivateJwk$1(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt&&"d"in kt)||kt.kty!=="OKP"||typeof kt.d!="string"||typeof kt.x!="string")}function isOkpPublicJwk$1(kt){return!(!kt||typeof kt!="object"||"d"in kt||!("kty"in kt&&"crv"in kt&&"x"in kt)||kt.kty!=="OKP"||typeof kt.x!="string")}function isPrivateJwk$1(kt){if(!kt||typeof kt!="object")return!1;switch(kt.kty){case"EC":case"OKP":case"RSA":return"d"in kt;case"oct":return"k"in kt;default:return!1}}var __awaiter$1l=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$o=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Secp256k1$1=class Ni{static adjustSignatureToLowS(At){return __awaiter$1l(this,arguments,void 0,function*({signature:xt}){const Bt=secp256k1.Signature.fromCompact(xt);return Bt.hasHighS()?Bt.normalizeS().toCompactRawBytes():xt})}static bytesToPrivateKey(At){return __awaiter$1l(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=yield Ni.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"secp256k1",d:Convert$2.uint8Array(xt).toBase64Url(),x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1l(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt=yield Ni.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"secp256k1",x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}),Nt})}static compressPublicKey(At){return __awaiter$1l(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256k1.ProjectivePoint.fromHex(xt).toRawBytes(!0)})}static computePublicKey(At){return __awaiter$1l(this,arguments,void 0,function*({key:xt}){const Bt=yield Ni.privateKeyToBytes({privateKey:xt}),Nt=yield Ni.getCurvePoint({keyBytes:Bt}),jt={kty:"EC",crv:"secp256k1",x:Convert$2.uint8Array(Nt.x).toBase64Url(),y:Convert$2.uint8Array(Nt.y).toBase64Url()};return jt.kid=yield computeJwkThumbprint$1({jwk:jt}),jt})}static convertDerToCompactSignature(At){return __awaiter$1l(this,arguments,void 0,function*({derSignature:xt}){return secp256k1.Signature.fromDER(xt).toCompactRawBytes()})}static decompressPublicKey(At){return __awaiter$1l(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256k1.ProjectivePoint.fromHex(xt).toRawBytes(!1)})}static generateKey(){return __awaiter$1l(this,void 0,void 0,function*(){const At=secp256k1.utils.randomPrivateKey(),xt=yield Ni.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$1({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1l(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isEcPrivateJwk$1(xt)&&xt.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let Nt=__rest$o(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$1({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1l(this,arguments,void 0,function*({privateKey:xt}){if(!isEcPrivateJwk$1(xt))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1l(this,arguments,void 0,function*({publicKey:xt}){if(!(isEcPublicJwk$1(xt)&&xt.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const Bt=new Uint8Array([4]),Nt=Convert$2.base64Url(xt.x).toUint8Array(),jt=Convert$2.base64Url(xt.y).toUint8Array();return new Uint8Array([...Bt,...Nt,...jt])})}static sharedSecret(At){return __awaiter$1l(this,arguments,void 0,function*({privateKeyA:xt,publicKeyB:Bt}){if("x"in xt&&"x"in Bt&&xt.x===Bt.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Nt=yield Ni.privateKeyToBytes({privateKey:xt}),jt=yield Ni.publicKeyToBytes({publicKey:Bt});return secp256k1.getSharedSecret(Nt,jt,!0).slice(1)})}static sign(At){return __awaiter$1l(this,arguments,void 0,function*({data:xt,key:Bt}){const Nt=yield Ni.privateKeyToBytes({privateKey:Bt}),jt=sha256$5(xt);return secp256k1.sign(jt,Nt).toCompactRawBytes()})}static validatePrivateKey(At){return __awaiter$1l(this,arguments,void 0,function*({privateKeyBytes:xt}){return secp256k1.utils.isValidPrivateKey(xt)})}static validatePublicKey(At){return __awaiter$1l(this,arguments,void 0,function*({publicKeyBytes:xt}){try{secp256k1.ProjectivePoint.fromHex(xt).assertValidity()}catch{return!1}return!0})}static verify(At){return __awaiter$1l(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=yield Ni.publicKeyToBytes({publicKey:xt}),Ut=sha256$5(Nt);return secp256k1.verify(Bt,Ut,jt,{lowS:!1})})}static getCurvePoint(At){return __awaiter$1l(this,arguments,void 0,function*({keyBytes:xt}){xt.byteLength===32&&(xt=secp256k1.getPublicKey(xt));const Bt=secp256k1.ProjectivePoint.fromHex(xt),Nt=numberToBytesBE(Bt.x,32),jt=numberToBytesBE(Bt.y,32);return{x:Nt,y:jt}})}};var __awaiter$1k=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$n=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Secp256r1$1=class ji{static adjustSignatureToLowS(At){return __awaiter$1k(this,arguments,void 0,function*({signature:xt}){const Bt=secp256r1.Signature.fromCompact(xt);return Bt.hasHighS()?Bt.normalizeS().toCompactRawBytes():xt})}static bytesToPrivateKey(At){return __awaiter$1k(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=yield ji.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"P-256",d:Convert$2.uint8Array(xt).toBase64Url(),x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1k(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt=yield ji.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"P-256",x:Convert$2.uint8Array(Bt.x).toBase64Url(),y:Convert$2.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}),Nt})}static compressPublicKey(At){return __awaiter$1k(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256r1.ProjectivePoint.fromHex(xt).toRawBytes(!0)})}static computePublicKey(At){return __awaiter$1k(this,arguments,void 0,function*({key:xt}){const Bt=yield ji.privateKeyToBytes({privateKey:xt}),Nt=yield ji.getCurvePoint({keyBytes:Bt}),jt={kty:"EC",crv:"P-256",x:Convert$2.uint8Array(Nt.x).toBase64Url(),y:Convert$2.uint8Array(Nt.y).toBase64Url()};return jt.kid=yield computeJwkThumbprint$1({jwk:jt}),jt})}static convertDerToCompactSignature(At){return __awaiter$1k(this,arguments,void 0,function*({derSignature:xt}){return secp256r1.Signature.fromDER(xt).toCompactRawBytes()})}static decompressPublicKey(At){return __awaiter$1k(this,arguments,void 0,function*({publicKeyBytes:xt}){return secp256r1.ProjectivePoint.fromHex(xt).toRawBytes(!1)})}static generateKey(){return __awaiter$1k(this,void 0,void 0,function*(){const At=secp256r1.utils.randomPrivateKey(),xt=yield ji.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$1({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1k(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isEcPrivateJwk$1(xt)&&xt.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let Nt=__rest$n(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$1({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1k(this,arguments,void 0,function*({privateKey:xt}){if(!isEcPrivateJwk$1(xt))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1k(this,arguments,void 0,function*({publicKey:xt}){if(!(isEcPublicJwk$1(xt)&&xt.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const Bt=new Uint8Array([4]),Nt=Convert$2.base64Url(xt.x).toUint8Array(),jt=Convert$2.base64Url(xt.y).toUint8Array();return new Uint8Array([...Bt,...Nt,...jt])})}static sharedSecret(At){return __awaiter$1k(this,arguments,void 0,function*({privateKeyA:xt,publicKeyB:Bt}){if("x"in xt&&"x"in Bt&&xt.x===Bt.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Nt=yield ji.privateKeyToBytes({privateKey:xt}),jt=yield ji.publicKeyToBytes({publicKey:Bt});return secp256r1.getSharedSecret(Nt,jt,!0).slice(1)})}static sign(At){return __awaiter$1k(this,arguments,void 0,function*({data:xt,key:Bt}){const Nt=yield ji.privateKeyToBytes({privateKey:Bt}),jt=sha256$5(xt);return secp256r1.sign(jt,Nt).toCompactRawBytes()})}static validatePrivateKey(At){return __awaiter$1k(this,arguments,void 0,function*({privateKeyBytes:xt}){return secp256r1.utils.isValidPrivateKey(xt)})}static validatePublicKey(At){return __awaiter$1k(this,arguments,void 0,function*({publicKeyBytes:xt}){try{secp256r1.ProjectivePoint.fromHex(xt).assertValidity()}catch{return!1}return!0})}static verify(At){return __awaiter$1k(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=yield ji.publicKeyToBytes({publicKey:xt}),Ut=sha256$5(Nt);return secp256r1.verify(Bt,Ut,jt,{lowS:!1})})}static getCurvePoint(At){return __awaiter$1k(this,arguments,void 0,function*({keyBytes:xt}){xt.byteLength===32&&(xt=secp256r1.getPublicKey(xt));const Bt=secp256r1.ProjectivePoint.fromHex(xt),Nt=numberToBytesBE(Bt.x,32),jt=numberToBytesBE(Bt.y,32);return{x:Nt,y:jt}})}};var __awaiter$1j=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let EcdsaAlgorithm$2=class extends CryptoAlgorithm$1{computePublicKey(At){return __awaiter$1j(this,arguments,void 0,function*({key:xt}){if(!isEcPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(xt.crv){case"secp256k1":{const Bt=yield Secp256k1$1.computePublicKey({key:xt});return Bt.alg="ES256K",Bt}case"P-256":{const Bt=yield Secp256r1$1.computePublicKey({key:xt});return Bt.alg="ES256",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}generateKey(At){return __awaiter$1j(this,arguments,void 0,function*({algorithm:xt}){switch(xt){case"ES256K":case"secp256k1":{const Bt=yield Secp256k1$1.generateKey();return Bt.alg="ES256K",Bt}case"ES256":case"secp256r1":{const Bt=yield Secp256r1$1.generateKey();return Bt.alg="ES256",Bt}}})}getPublicKey(At){return __awaiter$1j(this,arguments,void 0,function*({key:xt}){if(!isEcPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(xt.crv){case"secp256k1":{const Bt=yield Secp256k1$1.getPublicKey({key:xt});return Bt.alg="ES256K",Bt}case"P-256":{const Bt=yield Secp256r1$1.getPublicKey({key:xt});return Bt.alg="ES256",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}sign(At){return __awaiter$1j(this,arguments,void 0,function*({key:xt,data:Bt}){if(!isEcPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(xt.crv){case"secp256k1":return yield Secp256k1$1.sign({key:xt,data:Bt});case"P-256":return yield Secp256r1$1.sign({key:xt,data:Bt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}verify(At){return __awaiter$1j(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){if(!isEcPublicJwk$1(xt))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(xt.crv){case"secp256k1":return yield Secp256k1$1.verify({key:xt,signature:Bt,data:Nt});case"P-256":return yield Secp256r1$1.verify({key:xt,signature:Bt,data:Nt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}};var __awaiter$1i=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$m=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let Ed25519$1=class Qi{static bytesToPrivateKey(At){return __awaiter$1i(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=ed25519.getPublicKey(xt),Nt={crv:"Ed25519",d:Convert$2.uint8Array(xt).toBase64Url(),kty:"OKP",x:Convert$2.uint8Array(Bt).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1i(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt={kty:"OKP",crv:"Ed25519",x:Convert$2.uint8Array(xt).toBase64Url()};return Bt.kid=yield computeJwkThumbprint$1({jwk:Bt}),Bt})}static computePublicKey(At){return __awaiter$1i(this,arguments,void 0,function*({key:xt}){const Bt=yield Qi.privateKeyToBytes({privateKey:xt}),Nt=ed25519.getPublicKey(Bt),jt={kty:"OKP",crv:"Ed25519",x:Convert$2.uint8Array(Nt).toBase64Url()};return jt.kid=yield computeJwkThumbprint$1({jwk:jt}),jt})}static convertPrivateKeyToX25519(At){return __awaiter$1i(this,arguments,void 0,function*({privateKey:xt}){const Bt=yield Qi.privateKeyToBytes({privateKey:xt}),Nt=edwardsToMontgomeryPriv(Bt),jt=x25519.getPublicKey(Nt),Ut={kty:"OKP",crv:"X25519",d:Convert$2.uint8Array(Nt).toBase64Url(),x:Convert$2.uint8Array(jt).toBase64Url()};return Ut.kid=yield computeJwkThumbprint$1({jwk:Ut}),Ut})}static convertPublicKeyToX25519(At){return __awaiter$1i(this,arguments,void 0,function*({publicKey:xt}){const Bt=yield Qi.publicKeyToBytes({publicKey:xt});if(!(yield Qi.validatePublicKey({publicKeyBytes:Bt})))throw new Error("Ed25519: Invalid public key.");const jt=edwardsToMontgomeryPub(Bt),Ut={kty:"OKP",crv:"X25519",x:Convert$2.uint8Array(jt).toBase64Url()};return Ut.kid=yield computeJwkThumbprint$1({jwk:Ut}),Ut})}static generateKey(){return __awaiter$1i(this,void 0,void 0,function*(){const At=ed25519.utils.randomPrivateKey(),xt=yield Qi.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$1({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1i(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isOkpPrivateJwk$1(xt)&&xt.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let Nt=__rest$m(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$1({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1i(this,arguments,void 0,function*({privateKey:xt}){if(!isOkpPrivateJwk$1(xt))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1i(this,arguments,void 0,function*({publicKey:xt}){if(!isOkpPublicJwk$1(xt))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Convert$2.base64Url(xt.x).toUint8Array()})}static sign(At){return __awaiter$1i(this,arguments,void 0,function*({key:xt,data:Bt}){const Nt=yield Qi.privateKeyToBytes({privateKey:xt});return ed25519.sign(Bt,Nt)})}static validatePublicKey(At){return __awaiter$1i(this,arguments,void 0,function*({publicKeyBytes:xt}){try{ed25519.ExtendedPoint.fromHex(xt).assertValidity()}catch{return!1}return!0})}static verify(At){return __awaiter$1i(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=yield Qi.publicKeyToBytes({publicKey:xt});return ed25519.verify(Bt,Nt,jt)})}};var __awaiter$1h=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let EdDsaAlgorithm$2=class extends CryptoAlgorithm$1{computePublicKey(At){return __awaiter$1h(this,arguments,void 0,function*({key:xt}){if(!isOkpPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(xt.crv){case"Ed25519":{const Bt=yield Ed25519$1.computePublicKey({key:xt});return Bt.alg="EdDSA",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}generateKey(At){return __awaiter$1h(this,arguments,void 0,function*({algorithm:xt}){switch(xt){case"Ed25519":{const Bt=yield Ed25519$1.generateKey();return Bt.alg="EdDSA",Bt}}})}getPublicKey(At){return __awaiter$1h(this,arguments,void 0,function*({key:xt}){if(!isOkpPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(xt.crv){case"Ed25519":{const Bt=yield Ed25519$1.getPublicKey({key:xt});return Bt.alg="EdDSA",Bt}default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}sign(At){return __awaiter$1h(this,arguments,void 0,function*({key:xt,data:Bt}){if(!isOkpPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(xt.crv){case"Ed25519":return yield Ed25519$1.sign({key:xt,data:Bt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}verify(At){return __awaiter$1h(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){if(!isOkpPublicJwk$1(xt))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(xt.crv){case"Ed25519":return yield Ed25519$1.verify({key:xt,signature:Bt,data:Nt});default:throw new Error(`Unsupported curve: ${xt.crv}`)}})}};var __awaiter$1g=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const supportedAlgorithms$3={Ed25519:{implementation:EdDsaAlgorithm$2,names:["Ed25519"]},secp256k1:{implementation:EcdsaAlgorithm$2,names:["ES256K","secp256k1"]},secp256r1:{implementation:EcdsaAlgorithm$2,names:["ES256","secp256r1"]},"SHA-256":{implementation:Sha2Algorithm$1,names:["SHA-256"]}};let LocalKeyManager$2=class{constructor(At){var xt;this._algorithmInstances=new Map,this._keyStore=(xt=At==null?void 0:At.keyStore)!==null&&xt!==void 0?xt:new MemoryStore$1}digest(At){return __awaiter$1g(this,arguments,void 0,function*({algorithm:xt,data:Bt}){return yield this.getAlgorithm({algorithm:xt}).digest({algorithm:xt,data:Bt})})}exportKey(At){return __awaiter$1g(this,arguments,void 0,function*({keyUri:xt}){return yield this.getPrivateKey({keyUri:xt})})}generateKey(At){return __awaiter$1g(this,arguments,void 0,function*({algorithm:xt}){const Nt=yield this.getAlgorithm({algorithm:xt}).generateKey({algorithm:xt});if((Nt==null?void 0:Nt.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const jt=`${KEY_URI_PREFIX_JWK$1}${Nt.kid}`;return yield this._keyStore.set(jt,Nt),jt})}getKeyUri(At){return __awaiter$1g(this,arguments,void 0,function*({key:xt}){const Bt=yield computeJwkThumbprint$1({jwk:xt});return`${KEY_URI_PREFIX_JWK$1}${Bt}`})}getPublicKey(At){return __awaiter$1g(this,arguments,void 0,function*({keyUri:xt}){const Bt=yield this.getPrivateKey({keyUri:xt}),Nt=this.getAlgorithmName({key:Bt});return yield this.getAlgorithm({algorithm:Nt}).getPublicKey({key:Bt})})}importKey(At){return __awaiter$1g(this,arguments,void 0,function*({key:xt}){var Bt;if(!isPrivateJwk$1(xt))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const Nt=structuredClone(xt);(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}));const jt=yield this.getKeyUri({key:Nt});return yield this._keyStore.set(jt,Nt),jt})}sign(At){return __awaiter$1g(this,arguments,void 0,function*({keyUri:xt,data:Bt}){const Nt=yield this.getPrivateKey({keyUri:xt}),jt=this.getAlgorithmName({key:Nt});return this.getAlgorithm({algorithm:jt}).sign({data:Bt,key:Nt})})}verify(At){return __awaiter$1g(this,arguments,void 0,function*({key:xt,signature:Bt,data:Nt}){const jt=this.getAlgorithmName({key:xt});return this.getAlgorithm({algorithm:jt}).verify({key:xt,signature:Bt,data:Nt})})}getAlgorithm({algorithm:At}){var xt;const Bt=(xt=supportedAlgorithms$3[At])===null||xt===void 0?void 0:xt.implementation;if(!Bt)throw new Error(`Algorithm not supported: ${At}`);return this._algorithmInstances.has(Bt)||this._algorithmInstances.set(Bt,new Bt),this._algorithmInstances.get(Bt)}getAlgorithmName({key:At}){const xt=At.alg,Bt=At.crv;for(const Nt in supportedAlgorithms$3){const jt=supportedAlgorithms$3[Nt];if(xt&&jt.names.includes(xt))return Nt;if(Bt&&jt.names.includes(Bt))return Nt}throw new Error(`Unable to determine algorithm based on provided input: alg=${xt}, crv=${Bt}`)}getPrivateKey(At){return __awaiter$1g(this,arguments,void 0,function*({keyUri:xt}){const Bt=yield this._keyStore.get(xt);if(!Bt)throw new Error(`Key not found: ${xt}`);return Bt})}};function getJoseSignatureAlgorithmFromPublicKey$2(kt){const At={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(kt.alg&&Object.values(At).includes(kt.alg))return kt.alg;if(kt.crv&&Object.keys(At).includes(kt.crv))return At[kt.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${kt.alg}, crv=${kt.crv}. Supported 'alg' values: ${Object.values(At).join(", ")}. Supported 'crv' values: ${Object.keys(At).join(", ")}.`)}function randomBytes$1(kt){return randomBytes$7(kt)}function randomUuid$1(){return crypto$7.randomUUID()}function randomPin$1({length:kt}){if(3>kt||kt>10)throw new Error("randomPin() can securely generate a PIN between 3 to 10 digits.");const At=Math.pow(10,kt)-1;let xt;if(kt<=6){const Bt=Math.pow(10,kt);do{const Nt=randomBytes$1(Math.ceil(kt/2));xt=new DataView(Nt.buffer).getUint16(0,!1)%Bt}while(xt>At)}else{const Bt=Math.pow(10,10);do{const Nt=randomBytes$1(4);xt=new DataView(Nt.buffer).getUint32(0,!1)%Bt}while(xt>At)}return xt.toString().padStart(kt,"0")}const CryptoUtils$1={randomPin:randomPin$1,randomUuid:randomUuid$1,randomBytes:randomBytes$1,getJoseSignatureAlgorithmFromPublicKey:getJoseSignatureAlgorithmFromPublicKey$2};var __awaiter$1f=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$l=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const AES_GCM_IV_LENGTH=96,AES_KEY_LENGTHS$1=[128,192,256],AES_GCM_TAG_LENGTHS=[96,104,112,120,128];class AesGcm{static bytesToPrivateKey(At){return __awaiter$1f(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt={k:Convert$2.uint8Array(xt).toBase64Url(),kty:"oct"};return Bt.kid=yield computeJwkThumbprint$1({jwk:Bt}),Bt})}static decrypt(At){return __awaiter$1f(this,arguments,void 0,function*({key:xt,data:Bt,iv:Nt,additionalData:jt,tagLength:Ut}){if(Nt.byteLength!==AES_GCM_IV_LENGTH/8)throw new TypeError(`The initialization vector must be ${AES_GCM_IV_LENGTH} bits in length`);if(Ut&&!AES_GCM_TAG_LENGTHS.includes(Ut))throw new RangeError(`The tag length is invalid: Must be ${AES_GCM_TAG_LENGTHS.join(", ")} bits`);const Lt=getWebcryptoSubtle(),Ht=yield Lt.importKey("jwk",xt,{name:"AES-GCM"},!0,["decrypt"]),Vt=Object.assign(Object.assign({name:"AES-GCM",iv:Nt},Ut&&{tagLength:Ut}),jt&&{additionalData:jt}),zt=yield Lt.decrypt(Vt,Ht,Bt);return new Uint8Array(zt)})}static encrypt(At){return __awaiter$1f(this,arguments,void 0,function*({data:xt,iv:Bt,key:Nt,additionalData:jt,tagLength:Ut}){if(Bt.byteLength!==AES_GCM_IV_LENGTH/8)throw new TypeError(`The initialization vector must be ${AES_GCM_IV_LENGTH} bits in length`);if(Ut&&!AES_GCM_TAG_LENGTHS.includes(Ut))throw new RangeError(`The tag length is invalid: Must be ${AES_GCM_TAG_LENGTHS.join(", ")} bits`);const Lt=getWebcryptoSubtle(),Ht=yield Lt.importKey("jwk",Nt,{name:"AES-GCM"},!0,["encrypt"]),Vt=Object.assign(Object.assign({name:"AES-GCM",iv:Bt},Ut&&{tagLength:Ut}),jt&&{additionalData:jt}),zt=yield Lt.encrypt(Vt,Ht,xt);return new Uint8Array(zt)})}static generateKey(At){return __awaiter$1f(this,arguments,void 0,function*({length:xt}){if(!AES_KEY_LENGTHS$1.includes(xt))throw new RangeError(`The key length is invalid: Must be ${AES_KEY_LENGTHS$1.join(", ")} bits`);const Bt=getWebcryptoSubtle(),Nt=yield Bt.generateKey({name:"AES-GCM",length:xt},!0,["encrypt"]),jt=yield Bt.exportKey("jwk",Nt),Ut=__rest$l(jt,["ext","key_ops"]);return Ut.kid=yield computeJwkThumbprint$1({jwk:Ut}),Ut})}static privateKeyToBytes(At){return __awaiter$1f(this,arguments,void 0,function*({privateKey:xt}){if(!isOctPrivateJwk(xt))throw new Error("AesGcm: The provided key is not a valid oct private key.");return Convert$2.base64Url(xt.k).toUint8Array()})}}var __awaiter$1e=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let AesGcmAlgorithm$1=class extends CryptoAlgorithm$1{decrypt(At){return __awaiter$1e(this,void 0,void 0,function*(){return AesGcm.decrypt(At)})}encrypt(At){return __awaiter$1e(this,void 0,void 0,function*(){return AesGcm.encrypt(At)})}generateKey(At){return __awaiter$1e(this,arguments,void 0,function*({algorithm:xt}){const Bt={A128GCM:128,A192GCM:192,A256GCM:256}[xt],Nt=yield AesGcm.generateKey({length:Bt});return Nt.alg=xt,Nt})}};var __awaiter$1d=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$k=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};let X25519$1=class To{static bytesToPrivateKey(At){return __awaiter$1d(this,arguments,void 0,function*({privateKeyBytes:xt}){const Bt=x25519.getPublicKey(xt),Nt={kty:"OKP",crv:"X25519",d:Convert$2.uint8Array(xt).toBase64Url(),x:Convert$2.uint8Array(Bt).toBase64Url()};return Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}),Nt})}static bytesToPublicKey(At){return __awaiter$1d(this,arguments,void 0,function*({publicKeyBytes:xt}){const Bt={kty:"OKP",crv:"X25519",x:Convert$2.uint8Array(xt).toBase64Url()};return Bt.kid=yield computeJwkThumbprint$1({jwk:Bt}),Bt})}static computePublicKey(At){return __awaiter$1d(this,arguments,void 0,function*({key:xt}){const Bt=yield To.privateKeyToBytes({privateKey:xt}),Nt=x25519.getPublicKey(Bt),jt={kty:"OKP",crv:"X25519",x:Convert$2.uint8Array(Nt).toBase64Url()};return jt.kid=yield computeJwkThumbprint$1({jwk:jt}),jt})}static generateKey(){return __awaiter$1d(this,void 0,void 0,function*(){const At=x25519.utils.randomPrivateKey(),xt=yield To.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint$1({jwk:xt}),xt})}static getPublicKey(At){return __awaiter$1d(this,arguments,void 0,function*({key:xt}){var Bt;if(!(isOkpPrivateJwk$1(xt)&&xt.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let Nt=__rest$k(xt,["d"]);return(Bt=Nt.kid)!==null&&Bt!==void 0||(Nt.kid=yield computeJwkThumbprint$1({jwk:Nt})),Nt})}static privateKeyToBytes(At){return __awaiter$1d(this,arguments,void 0,function*({privateKey:xt}){if(!isOkpPrivateJwk$1(xt))throw new Error("X25519: The provided key is not a valid OKP private key.");return Convert$2.base64Url(xt.d).toUint8Array()})}static publicKeyToBytes(At){return __awaiter$1d(this,arguments,void 0,function*({publicKey:xt}){if(!isOkpPublicJwk$1(xt))throw new Error("X25519: The provided key is not a valid OKP public key.");return Convert$2.base64Url(xt.x).toUint8Array()})}static sharedSecret(At){return __awaiter$1d(this,arguments,void 0,function*({privateKeyA:xt,publicKeyB:Bt}){if("x"in xt&&"x"in Bt&&xt.x===Bt.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Nt=yield To.privateKeyToBytes({privateKey:xt}),jt=yield To.publicKeyToBytes({publicKey:Bt});return x25519.getSharedSecret(Nt,jt)})}};function extractDidFragment$1(kt){if(typeof kt=="string"&&kt.length!==0)return kt.split("#").pop()}function getVerificationMethods$1({didDocument:kt}){var At,xt;if(!kt)throw new TypeError("Required parameter missing: 'didDocument'");const Bt=[];return Bt.push(...(xt=(At=kt.verificationMethod)===null||At===void 0?void 0:At.filter(isDidVerificationMethod$1))!==null&&xt!==void 0?xt:[]),Object.keys(DidVerificationRelationship$1).forEach(Nt=>{var jt,Ut;Bt.push(...(Ut=(jt=kt[Nt])===null||jt===void 0?void 0:jt.filter(isDidVerificationMethod$1))!==null&&Ut!==void 0?Ut:[])}),Bt}function getVerificationMethodTypes$1({didDocument:kt}){const xt=getVerificationMethods$1({didDocument:kt}).map(Bt=>Bt.type);return[...new Set(xt)]}function getVerificationRelationshipsById$1({didDocument:kt,methodId:At}){const xt=[];return Object.keys(DidVerificationRelationship$1).forEach(Bt=>{if(Array.isArray(kt[Bt])){const Nt=kt[Bt],jt=extractDidFragment$1(At);Nt.some(Lt=>{const Ht=extractDidFragment$1(Lt)===jt,Vt=isDidVerificationMethod$1(Lt)&&extractDidFragment$1(Lt.id)===jt;return Ht||Vt})&&xt.push(Bt)}}),xt}function isDidService(kt){return!kt||typeof kt!="object"||kt===null?!1:"id"in kt&&"type"in kt&&"serviceEndpoint"in kt}function isDwnDidService(kt){if(!isDidService(kt)||kt.type!=="DecentralizedWebNode"||!("enc"in kt&&"sig"in kt))return!1;const At=xt=>typeof xt=="string"||Array.isArray(xt)&&xt.every(Bt=>typeof Bt=="string");return At(kt.enc)&&At(kt.sig)}function isDidVerificationMethod$1(kt){return!(!kt||typeof kt!="object"||kt===null||!("id"in kt&&"type"in kt&&"controller"in kt)||typeof kt.id!="string"||typeof kt.type!="string"||typeof kt.controller!="string")}function keyBytesToMultibaseId$1({keyBytes:kt,multicodecCode:At,multicodecName:xt}){const Bt=Multicodec$1.addPrefix({code:At,data:kt,name:xt}),Nt=Convert$1.uint8Array(Bt).toBase58Btc();return Convert$1.base58Btc(Nt).toMultibase()}function multibaseIdToKeyBytes$1({multibaseKeyId:kt}){try{const At=Convert$1.multibase(kt).toBase58Btc(),xt=Convert$1.base58Btc(At).toUint8Array(),{code:Bt,data:Nt,name:jt}=Multicodec$1.removePrefix({prefixedData:xt});return{keyBytes:Nt,multicodecCode:Bt,multicodecName:jt}}catch{throw new DidError$1(DidErrorCode$1.InvalidDid,`Invalid multibase identifier: ${kt}`)}}var __awaiter$1c=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let BearerDid$1=class gs{constructor({uri:At,document:xt,metadata:Bt,keyManager:Nt}){this.uri=At,this.document=xt,this.metadata=Bt,this.keyManager=Nt}export(){return __awaiter$1c(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let At={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const xt=[];for(let Bt of this.document.verificationMethod){if(!Bt.publicKeyJwk)throw new Error(`Verification method '${Bt.id}' does not contain a public key in JWK format`);const Nt=yield this.keyManager.getKeyUri({key:Bt.publicKeyJwk}),jt=yield this.keyManager.exportKey({keyUri:Nt});xt.push(Object.assign({},jt))}At.privateKeys=xt}return At})}getSigner(At){return __awaiter$1c(this,void 0,void 0,function*(){var xt;const Bt=(xt=this.document.verificationMethod)===null||xt===void 0?void 0:xt.find(Ht=>{var Vt,zt;return extractDidFragment$1(Ht.id)===((Vt=extractDidFragment$1(At==null?void 0:At.methodId))!==null&&Vt!==void 0?Vt:extractDidFragment$1((zt=this.document.assertionMethod)===null||zt===void 0?void 0:zt[0]))});if(!(Bt&&Bt.publicKeyJwk))throw new DidError$1(DidErrorCode$1.InternalError,"A verification method intended for signing could not be determined from the DID Document");const Nt=yield this.keyManager.getKeyUri({key:Bt.publicKeyJwk}),jt=yield this.keyManager.getPublicKey({keyUri:Nt}),Ut=this.keyManager;return{algorithm:CryptoUtils$1.getJoseSignatureAlgorithmFromPublicKey(jt),keyId:Bt.id,sign(Ht){return __awaiter$1c(this,arguments,void 0,function*({data:Vt}){return yield Ut.sign({data:Vt,keyUri:Nt})})},verify(Ht){return __awaiter$1c(this,arguments,void 0,function*({data:Vt,signature:zt}){return yield Ut.verify({data:Vt,key:jt,signature:zt})})}}})}static import(At){return __awaiter$1c(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$2}){var Nt;const jt=getVerificationMethods$1({didDocument:xt.document});if(jt.length===0)throw new DidError$1(DidErrorCode$1.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let Lt of(Nt=xt.privateKeys)!==null&&Nt!==void 0?Nt:[])yield Bt.importKey({key:Lt});for(let Lt of jt){if(!Lt.publicKeyJwk)throw new Error(`Verification method '${Lt.id}' does not contain a public key in JWK format`);const Ht=yield Bt.getKeyUri({key:Lt.publicKeyJwk});yield Bt.getPublicKey({keyUri:Ht})}return new gs({uri:xt.uri,document:xt.document,metadata:xt.metadata,keyManager:Bt})})}};var __awaiter$1b=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidMethod$1=class{static getSigningMethod(At){return __awaiter$1b(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(At,xt){return __awaiter$1b(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var __awaiter$1a=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$j=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const DEFAULT_GATEWAY_URI$3="https://diddht.tbddev.org",DID_DHT_SPECIFICATION_VERSION$1=0,DNS_RECORD_TTL$1=7200,PROPERTY_SEPARATOR$1=";",VALUE_SEPARATOR$1=",";var DidDhtRegisteredDidType$1;(function(kt){kt[kt.Discoverable=0]="Discoverable",kt[kt.Organization=1]="Organization",kt[kt.Government=2]="Government",kt[kt.Corporation=3]="Corporation",kt[kt.LocalBusiness=4]="LocalBusiness",kt[kt.SoftwarePackage=5]="SoftwarePackage",kt[kt.WebApp=6]="WebApp",kt[kt.FinancialInstitution=7]="FinancialInstitution"})(DidDhtRegisteredDidType$1||(DidDhtRegisteredDidType$1={}));var DidDhtRegisteredKeyType$1;(function(kt){kt[kt.Ed25519=0]="Ed25519",kt[kt.secp256k1=1]="secp256k1",kt[kt.secp256r1=2]="secp256r1",kt[kt.X25519=3]="X25519"})(DidDhtRegisteredKeyType$1||(DidDhtRegisteredKeyType$1={}));var DidDhtVerificationRelationship$1;(function(kt){kt.authentication="auth",kt.assertionMethod="asm",kt.capabilityDelegation="del",kt.capabilityInvocation="inv",kt.keyAgreement="agm"})(DidDhtVerificationRelationship$1||(DidDhtVerificationRelationship$1={}));const AlgorithmToKeyTypeMap$5={Ed25519:DidDhtRegisteredKeyType$1.Ed25519,ES256K:DidDhtRegisteredKeyType$1.secp256k1,ES256:DidDhtRegisteredKeyType$1.secp256r1,"P-256":DidDhtRegisteredKeyType$1.secp256r1,secp256k1:DidDhtRegisteredKeyType$1.secp256k1,secp256r1:DidDhtRegisteredKeyType$1.secp256r1,X25519:DidDhtRegisteredKeyType$1.X25519},KeyTypeToDefaultAlgorithmMap$1={[DidDhtRegisteredKeyType$1.Ed25519]:"EdDSA",[DidDhtRegisteredKeyType$1.secp256k1]:"ES256K",[DidDhtRegisteredKeyType$1.secp256r1]:"ES256",[DidDhtRegisteredKeyType$1.X25519]:"ECDH-ES+A256KW"};let DidDht$1=class Wo extends DidMethod$1{static create(){return __awaiter$1a(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$2,options:xt={}}={}){var Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt;if(!((Bt=xt.verificationMethods)===null||Bt===void 0)&&Bt.some(yr=>!(yr.algorithm in AlgorithmToKeyTypeMap$5)))throw new Error("One or more verification method algorithms are not supported");const Xt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt.filter(yr=>"id"in yr).map(yr=>yr.id);if(Xt&&Xt.length!==new Set(Xt).size)throw new Error("One or more verification method IDs are not unique");if(!((jt=xt.services)===null||jt===void 0)&&jt.some(yr=>!yr.id||!yr.type||!yr.serviceEndpoint))throw new Error("One or more services are missing required properties");const tr=yield At.generateKey({algorithm:"Ed25519"}),rr=yield At.getPublicKey({keyUri:tr}),nr=yield DidDhtUtils$1.identityKeyToIdentifier({identityKey:rr}),ar=Object.assign(Object.assign({id:nr},xt.alsoKnownAs&&{alsoKnownAs:xt.alsoKnownAs}),xt.controllers&&{controller:xt.controllers}),ir=[...(Ut=xt.verificationMethods)!==null&&Ut!==void 0?Ut:[]];ir!=null&&ir.some(yr=>{var Sr;return((Sr=yr.id)===null||Sr===void 0?void 0:Sr.split("#").pop())==="0"})||ir.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const yr of ir){const Sr=yr.id&&yr.id.split("#").pop()==="0"?tr:yield At.generateKey({algorithm:yr.algorithm}),Ar=yield At.getPublicKey({keyUri:Sr});let Dr=(Ht=(Lt=yr.id)!==null&&Lt!==void 0?Lt:Ar.kid)!==null&&Ht!==void 0?Ht:yield computeJwkThumbprint$1({jwk:Ar});Dr=`${nr}#${extractDidFragment$1(Dr)}`,(Vt=ar.verificationMethod)!==null&&Vt!==void 0||(ar.verificationMethod=[]),ar.verificationMethod.push({id:Dr,type:"JsonWebKey",controller:(zt=yr.controller)!==null&&zt!==void 0?zt:nr,publicKeyJwk:Ar});for(const Br of(Wt=yr.purposes)!==null&&Wt!==void 0?Wt:[])ar[Br]||(ar[Br]=[]),ar[Br].push(Dr)}(Jt=xt.services)===null||Jt===void 0||Jt.forEach(yr=>{var Sr;(Sr=ar.service)!==null&&Sr!==void 0||(ar.service=[]),yr.id=`${nr}#${yr.id.split("#").pop()}`,ar.service.push(yr)});const lr=new BearerDid$1({uri:nr,document:ar,metadata:Object.assign({published:!1},xt.types&&{types:xt.types}),keyManager:At});if(!((Qt=xt.publish)!==null&&Qt!==void 0)||Qt){const yr=yield Wo.publish({did:lr,gatewayUri:xt.gatewayUri});lr.metadata=yr.didDocumentMetadata}return lr})}static import(At){return __awaiter$1a(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$2}){var Nt;const jt=Did$1.parse(xt.uri);if((jt==null?void 0:jt.method)!==Wo.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,"Method not supported");const Ut=yield BearerDid$1.import({portableDid:xt,keyManager:Bt});if(!(!((Nt=Ut.document.verificationMethod)===null||Nt===void 0)&&Nt.some(Lt=>{var Ht;return((Ht=Lt.id)===null||Ht===void 0?void 0:Ht.split("#").pop())==="0"})))throw new DidError$1(DidErrorCode$1.InvalidDidDocument,"DID document must contain an Identity Key");return Ut})}static getSigningMethod(At){return __awaiter$1a(this,arguments,void 0,function*({didDocument:xt,methodId:Bt="#0"}){var Nt;const jt=Did$1.parse(xt.id);if(jt&&jt.method!==this.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,`Method not supported: ${jt.method}`);const Ut=(Nt=xt.verificationMethod)===null||Nt===void 0?void 0:Nt.find(Lt=>{var Ht,Vt;return extractDidFragment$1(Lt.id)===((Ht=extractDidFragment$1(Bt))!==null&&Ht!==void 0?Ht:extractDidFragment$1((Vt=xt.assertionMethod)===null||Vt===void 0?void 0:Vt[0]))});if(!(Ut&&Ut.publicKeyJwk))throw new DidError$1(DidErrorCode$1.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static publish(At){return __awaiter$1a(this,arguments,void 0,function*({did:xt,gatewayUri:Bt=DEFAULT_GATEWAY_URI$3}){return yield DidDhtDocument$1.put({did:xt,gatewayUri:Bt})})}static resolve(At){return __awaiter$1a(this,arguments,void 0,function*(xt,Bt={}){var Nt;const jt=(Nt=Bt==null?void 0:Bt.gatewayUri)!==null&&Nt!==void 0?Nt:DEFAULT_GATEWAY_URI$3;try{yield DidDhtUtils$1.identifierToIdentityKey({didUri:xt});const{didDocument:Ut,didDocumentMetadata:Lt}=yield DidDhtDocument$1.get({didUri:xt,gatewayUri:jt});return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didDocument:Ut,didDocumentMetadata:Lt})}catch(Ut){if(!(Ut instanceof DidError$1))throw new Error(Ut);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:Object.assign({error:Ut.code},Ut.message&&{errorMessage:Ut.message})})}})}};DidDht$1.methodName="dht";let DidDhtDocument$1=class io{static get(At){return __awaiter$1a(this,arguments,void 0,function*({didUri:xt,gatewayUri:Bt}){const Nt=DidDhtUtils$1.identifierToIdentityKeyBytes({didUri:xt}),jt=yield io.pkarrGet({gatewayUri:Bt,publicKeyBytes:Nt}),Ut=yield DidDhtUtils$1.parseBep44GetMessage({bep44Message:jt}),Lt=yield io.fromDnsPacket({didUri:xt,dnsPacket:Ut});return Lt.didDocumentMetadata.versionId=jt.seq.toString(),Lt})}static put(At){return __awaiter$1a(this,arguments,void 0,function*({did:xt,gatewayUri:Bt}){const Nt=yield io.toDnsPacket({didDocument:xt.document,didMetadata:xt.metadata,authoritativeGatewayUris:[Bt]}),jt=yield DidDhtUtils$1.createBep44PutMessage({dnsPacket:Nt,publicKeyBytes:DidDhtUtils$1.identifierToIdentityKeyBytes({didUri:xt.uri}),signer:yield xt.getSigner({methodId:"0"})}),Ut=yield io.pkarrPut({gatewayUri:Bt,bep44Message:jt});return{didDocument:xt.document,didDocumentMetadata:Object.assign(Object.assign({},xt.metadata),{published:Ut,versionId:jt.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(At){return __awaiter$1a(this,arguments,void 0,function*({gatewayUri:xt,publicKeyBytes:Bt}){const Nt=Convert$1.uint8Array(Bt).toBase32Z(),jt=new URL(Nt,xt).href;let Ut;try{if(Ut=yield fetch(jt,{method:"GET"}),!Ut.ok)throw new DidError$1(DidErrorCode$1.NotFound,`Pkarr record not found for: ${Nt}`)}catch(Vt){throw Vt instanceof DidError$1?Vt:new DidError$1(DidErrorCode$1.InternalError,`Failed to fetch Pkarr record: ${Vt.message}`)}const Lt=yield Ut.arrayBuffer();if(!Lt)throw new DidError$1(DidErrorCode$1.NotFound,`Pkarr record not found for: ${Nt}`);if(Lt.byteLength<72)throw new DidError$1(DidErrorCode$1.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${Lt.byteLength}`);if(Lt.byteLength>1072)throw new DidError$1(DidErrorCode$1.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${Lt.byteLength}`);return{k:Bt,seq:Number(new DataView(Lt).getBigUint64(64)),sig:new Uint8Array(Lt,0,64),v:new Uint8Array(Lt,72)}})}static pkarrPut(At){return __awaiter$1a(this,arguments,void 0,function*({gatewayUri:xt,bep44Message:Bt}){const Nt=Convert$1.uint8Array(Bt.k).toBase32Z(),jt=new URL(Nt,xt).href,Ut=new Uint8Array(Bt.v.length+72);Ut.set(Bt.sig,0),new DataView(Ut.buffer).setBigUint64(Bt.sig.length,BigInt(Bt.seq)),Ut.set(Bt.v,Bt.sig.length+8);let Lt;try{Lt=yield fetch(jt,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:Ut})}catch(Ht){throw new DidError$1(DidErrorCode$1.InternalError,`Failed to put Pkarr record for identifier ${Nt}: ${Ht.message}`)}return Lt.ok})}static fromDnsPacket(At){return __awaiter$1a(this,arguments,void 0,function*({didUri:xt,dnsPacket:Bt}){var Nt,jt,Ut;const Lt={id:xt},Ht={published:!0},Vt=new Map;for(const zt of(Nt=Bt==null?void 0:Bt.answers)!==null&&Nt!==void 0?Nt:[]){if(zt.type!=="TXT")continue;const Wt=zt.name.split(".")[0].substring(1);switch(!0){case Wt.startsWith("aka"):{const Jt=DidDhtUtils$1.parseTxtDataToString(zt.data);Lt.alsoKnownAs=Jt.split(VALUE_SEPARATOR$1);break}case Wt.startsWith("cnt"):{const Jt=DidDhtUtils$1.parseTxtDataToString(zt.data);Lt.controller=Jt.includes(VALUE_SEPARATOR$1)?Jt.split(VALUE_SEPARATOR$1):Jt;break}case Wt.startsWith("k"):{const{id:Jt,t:Qt,k:Xt,c:tr,a:rr}=DidDhtUtils$1.parseTxtDataToObject(zt.data),nr=Convert$1.base64Url(Xt).toUint8Array(),ar=DidDhtRegisteredKeyType$1[Number(Qt)];let ir=yield DidDhtUtils$1.keyConverter(ar).bytesToPublicKey({publicKeyBytes:nr});ir.alg=rr||KeyTypeToDefaultAlgorithmMap$1[Number(Qt)];const lr=Wt==="k0"?"0":Jt!==void 0?Jt:yield computeJwkThumbprint$1({jwk:ir});(jt=Lt.verificationMethod)!==null&&jt!==void 0||(Lt.verificationMethod=[]);const yr=`${xt}#${lr}`;Lt.verificationMethod.push({id:yr,type:"JsonWebKey",controller:tr??xt,publicKeyJwk:ir}),Vt.set(Wt,yr);break}case Wt.startsWith("s"):{const Jt=DidDhtUtils$1.parseTxtDataToObject(zt.data),{id:Qt,t:Xt,se:tr}=Jt,rr=__rest$j(Jt,["id","t","se"]),nr=tr.includes(VALUE_SEPARATOR$1)?tr.split(VALUE_SEPARATOR$1):[tr],ar=Object.fromEntries(Object.entries(rr).map(([ir,lr])=>[ir,lr.includes(VALUE_SEPARATOR$1)?lr.split(VALUE_SEPARATOR$1):lr]));(Ut=Lt.service)!==null&&Ut!==void 0||(Lt.service=[]),Lt.service.push(Object.assign(Object.assign({},ar),{id:`${xt}#${Qt}`,type:Xt,serviceEndpoint:nr}));break}case Wt.startsWith("typ"):{const{id:Jt}=DidDhtUtils$1.parseTxtDataToObject(zt.data);Ht.types=Jt.split(VALUE_SEPARATOR$1).map(Qt=>Number(Qt));break}case Wt.startsWith("did"):{const Jt=ar=>ar.split(VALUE_SEPARATOR$1).map(ir=>Vt.get(ir)).filter(ir=>typeof ir=="string"),{auth:Qt,asm:Xt,del:tr,inv:rr,agm:nr}=DidDhtUtils$1.parseTxtDataToObject(zt.data);Qt&&(Lt.authentication=Jt(Qt)),Xt&&(Lt.assertionMethod=Jt(Xt)),tr&&(Lt.capabilityDelegation=Jt(tr)),rr&&(Lt.capabilityInvocation=Jt(rr)),nr&&(Lt.keyAgreement=Jt(nr));break}}}return{didDocument:Lt,didDocumentMetadata:Ht,didResolutionMetadata:{}}})}static toDnsPacket(At){return __awaiter$1a(this,arguments,void 0,function*({didDocument:xt,didMetadata:Bt,authoritativeGatewayUris:Nt,previousDidProof:jt}){var Ut,Lt,Ht,Vt,zt;const Wt=[],Jt=[],Qt=new Map,Xt=[],tr=[];if(jt!==void 0){const{signature:ar,previousDid:ir}=jt;yield DidDhtUtils$1.validatePreviousDidProof({newDid:xt.id,previousDidProof:jt}),Wt.push({type:"TXT",name:"_prv._did.",ttl:DNS_RECORD_TTL$1,data:`id=${ir};s=${ar}`})}if(xt.alsoKnownAs&&Wt.push({type:"TXT",name:"_aka._did.",ttl:DNS_RECORD_TTL$1,data:xt.alsoKnownAs.join(VALUE_SEPARATOR$1)}),xt.controller){const ar=Array.isArray(xt.controller)?xt.controller.join(VALUE_SEPARATOR$1):xt.controller;Wt.push({type:"TXT",name:"_cnt._did.",ttl:DNS_RECORD_TTL$1,data:ar})}for(const[ar,ir]of(Lt=(Ut=xt.verificationMethod)===null||Ut===void 0?void 0:Ut.entries())!==null&&Lt!==void 0?Lt:[]){const lr=`k${ar}`;tr.push(lr);let yr=ir.id.split("#").pop();Qt.set(yr,lr);const Sr=ir.publicKeyJwk;if(!(Sr!=null&&Sr.crv&&Sr.crv in AlgorithmToKeyTypeMap$5))throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Verification method '${ir.id}' contains an unsupported key type: ${(Ht=Sr==null?void 0:Sr.crv)!==null&&Ht!==void 0?Ht:"undefined"}`);const Ar=DidDhtRegisteredKeyType$1[Sr.crv],Dr=yield DidDhtUtils$1.keyConverter(Sr.crv).publicKeyToBytes({publicKey:Sr}),Br=Convert$1.uint8Array(Dr).toBase64Url(),Lr=[`t=${Ar}`,`k=${Br}`];yr!=="0"&&(yield computeJwkThumbprint$1({jwk:Sr}))!==yr&&Lr.unshift(`id=${yr}`),Sr.alg!==KeyTypeToDefaultAlgorithmMap$1[Ar]&&Lr.push(`a=${Sr.alg}`),ir.controller!==xt.id&&Lr.push(`c=${ir.controller}`),Wt.push({type:"TXT",name:`_${lr}._did.`,ttl:DNS_RECORD_TTL$1,data:Lr.join(PROPERTY_SEPARATOR$1)})}(Vt=xt.service)===null||Vt===void 0||Vt.forEach((ar,ir)=>{const lr=`s${ir}`;Xt.push(lr);let{id:yr,type:Sr,serviceEndpoint:Ar}=ar,Dr=__rest$j(ar,["id","type","serviceEndpoint"]);yr=extractDidFragment$1(yr),Ar=Array.isArray(Ar)?Ar.join(","):Ar;const Lr=Object.entries(Object.assign({id:yr,t:Sr,se:Ar},Dr)).map(([vr,pr])=>`${vr}=${pr}`).join(PROPERTY_SEPARATOR$1),Or=DidDhtUtils$1.chunkDataIfNeeded(Lr);Wt.push({type:"TXT",name:`_${lr}._did.`,ttl:DNS_RECORD_TTL$1,data:Or})});const rr=[`v=${DID_DHT_SPECIFICATION_VERSION$1}`];if(tr.length&&rr.push(`vm=${tr.join(VALUE_SEPARATOR$1)}`),Object.keys(DidVerificationRelationship$1).forEach(ar=>{var ir;const lr=(ir=xt[ar])===null||ir===void 0?void 0:ir.map(yr=>Qt.get(yr.split("#").pop()));if(lr){const yr=DidDhtVerificationRelationship$1[ar];rr.push(`${yr}=${lr.join(VALUE_SEPARATOR$1)}`)}}),Xt.length&&rr.push(`svc=${Xt.join(VALUE_SEPARATOR$1)}`),!((zt=Bt.types)===null||zt===void 0)&&zt.length){const ir=Bt.types.map(lr=>typeof lr=="string"?DidDhtRegisteredDidType$1[lr]:lr);Wt.push({type:"TXT",name:"_typ._did.",ttl:DNS_RECORD_TTL$1,data:`id=${ir.join(VALUE_SEPARATOR$1)}`})}Wt.push({type:"TXT",name:"_did."+io.getUniqueDidSuffix(xt.id)+".",ttl:DNS_RECORD_TTL$1,data:rr.join(PROPERTY_SEPARATOR$1)});for(const ar of Nt||[])Jt.push({type:"NS",name:"_did."+io.getUniqueDidSuffix(xt.id)+".",ttl:DNS_RECORD_TTL$1,data:ar+"."});return{id:0,type:"response",flags:AUTHORITATIVE_ANSWER,answers:[...Wt,...Jt]}})}static getUniqueDidSuffix(At){return At.split(":")[2]}},DidDhtUtils$1=class Lo{static createBep44PutMessage(At){return __awaiter$1a(this,arguments,void 0,function*({dnsPacket:xt,publicKeyBytes:Bt,signer:Nt}){const jt=Math.ceil(Date.now()/1e3),Ut=encode$2(xt),Lt=bencode.encode({seq:jt,v:Ut}).subarray(1,-1);if(Lt.length>1e3)throw new DidError$1(DidErrorCode$1.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${Lt.length} bytes`);const Ht=yield Nt.sign({data:Lt});return{k:Bt,seq:jt,sig:Ht,v:Ut}})}static identifierToIdentityKey(At){return __awaiter$1a(this,arguments,void 0,function*({didUri:xt}){let Bt=Lo.identifierToIdentityKeyBytes({didUri:xt});return yield Ed25519$1.bytesToPublicKey({publicKeyBytes:Bt})})}static identifierToIdentityKeyBytes({didUri:At}){const xt=Did$1.parse(At);if(!xt)throw new DidError$1(DidErrorCode$1.InvalidDid,`Invalid DID URI: ${At}`);if(xt.method!==DidDht$1.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,`Method not supported: ${xt.method}`);let Bt;try{Bt=Convert$1.base32Z(xt.id).toUint8Array()}catch{throw new DidError$1(DidErrorCode$1.InvalidPublicKey,"Failed to decode method-specific identifier")}if(Bt.length!==32)throw new DidError$1(DidErrorCode$1.InvalidPublicKeyLength,`Invalid public key length: ${Bt.length}`);return Bt}static identityKeyToIdentifier(At){return __awaiter$1a(this,arguments,void 0,function*({identityKey:xt}){const Bt=yield Ed25519$1.publicKeyToBytes({publicKey:xt}),Nt=Convert$1.uint8Array(Bt).toBase32Z();return`did:${DidDht$1.methodName}:${Nt}`})}static keyConverter(At){const Bt={Ed25519:Ed25519$1,"P-256":{publicKeyToBytes:Nt=>__awaiter$1a(this,[Nt],void 0,function*({publicKey:jt}){const Ut=yield Secp256r1$1.publicKeyToBytes({publicKey:jt});return yield Secp256r1$1.compressPublicKey({publicKeyBytes:Ut})}),bytesToPublicKey:Secp256r1$1.bytesToPublicKey,privateKeyToBytes:Secp256r1$1.privateKeyToBytes,bytesToPrivateKey:Secp256r1$1.bytesToPrivateKey},secp256k1:{publicKeyToBytes:Nt=>__awaiter$1a(this,[Nt],void 0,function*({publicKey:jt}){const Ut=yield Secp256k1$1.publicKeyToBytes({publicKey:jt});return yield Secp256k1$1.compressPublicKey({publicKeyBytes:Ut})}),bytesToPublicKey:Secp256k1$1.bytesToPublicKey,privateKeyToBytes:Secp256k1$1.privateKeyToBytes,bytesToPrivateKey:Secp256k1$1.bytesToPrivateKey},X25519:X25519$1}[At];if(!Bt)throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static parseBep44GetMessage(At){return __awaiter$1a(this,arguments,void 0,function*({bep44Message:xt}){const Bt=yield Ed25519$1.bytesToPublicKey({publicKeyBytes:xt.k}),Nt=bencode.encode({seq:xt.seq,v:xt.v}).subarray(1,-1);if(!(yield Ed25519$1.verify({key:Bt,signature:xt.sig,data:Nt})))throw new DidError$1(DidErrorCode$1.InvalidSignature,"Invalid signature for DHT BEP44 message");return decode$1(xt.v)})}static parseTxtDataToObject(At){return this.parseTxtDataToString(At).split(PROPERTY_SEPARATOR$1).reduce((xt,Bt)=>{const[Nt,jt]=Bt.split("=");return xt[Nt]=jt,xt},{})}static parseTxtDataToString(At){if(typeof At=="string")return At;if(At instanceof Uint8Array)return Convert$1.uint8Array(At).toString();if(Array.isArray(At))return At.map(xt=>this.parseTxtDataToString(xt)).join("");throw new DidError$1(DidErrorCode$1.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(At){return __awaiter$1a(this,arguments,void 0,function*({newDid:xt,previousDidProof:Bt}){const Nt=yield Lo.identifierToIdentityKey({didUri:Bt.previousDid}),jt=Lo.identifierToIdentityKeyBytes({didUri:xt}),Ut=Convert$1.base64Url(Bt.signature).toUint8Array();if(!(yield Ed25519$1.verify({key:Nt,data:jt,signature:Ut})))throw new DidError$1(DidErrorCode$1.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(At){if(At.length<=255)return At;const xt=[];for(let Bt=0;Bt<At.length;Bt+=255)xt.push(At.slice(Bt,Bt+255));return xt}};var __awaiter$19=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidIonRegisteredKeyType$1;(function(kt){kt.Ed25519="Ed25519",kt.secp256k1="secp256k1",kt.secp256r1="secp256r1",kt.X25519="X25519"})(DidIonRegisteredKeyType$1||(DidIonRegisteredKeyType$1={}));const AlgorithmToKeyTypeMap$4={Ed25519:DidIonRegisteredKeyType$1.Ed25519,ES256K:DidIonRegisteredKeyType$1.secp256k1,ES256:DidIonRegisteredKeyType$1.secp256r1,"P-256":DidIonRegisteredKeyType$1.secp256r1,secp256k1:DidIonRegisteredKeyType$1.secp256k1,secp256r1:DidIonRegisteredKeyType$1.secp256r1},DEFAULT_GATEWAY_URI$2="https://ion.tbd.engineering";let DidIon$1=class Ao extends DidMethod$1{static create(){return __awaiter$19(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$2,options:xt={}}={}){var Bt,Nt,jt,Ut,Lt,Ht,Vt;if(!((Bt=xt.verificationMethods)===null||Bt===void 0)&&Bt.some(yr=>!(yr.algorithm in AlgorithmToKeyTypeMap$4)))throw new Error("One or more verification method algorithms are not supported");const zt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt.filter(yr=>"id"in yr).map(yr=>yr.id);if(zt&&zt.length!==new Set(zt).size)throw new Error("One or more verification method IDs are not unique");if(!((jt=xt.services)===null||jt===void 0)&&jt.some(yr=>!yr.id||!yr.type||!yr.serviceEndpoint))throw new Error("One or more services are missing required properties");const Wt={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},Jt=[];for(const yr of(Ut=xt.verificationMethods)!==null&&Ut!==void 0?Ut:[Wt]){const Sr=yield At.generateKey({algorithm:yr.algorithm}),Ar=yield At.getPublicKey({keyUri:Sr});Jt.push({id:yr.id,publicKeyJwk:Ar,purposes:(Lt=yr.purposes)!==null&&Lt!==void 0?Lt:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const Qt=yield At.generateKey({algorithm:DidIonRegisteredKeyType$1.secp256k1}),Xt=yield At.getPublicKey({keyUri:Qt}),tr=yield At.generateKey({algorithm:DidIonRegisteredKeyType$1.secp256k1}),rr=yield At.getPublicKey({keyUri:tr}),nr=yield DidIonUtils$1.computeLongFormDidUri({recoveryKey:Xt,updateKey:rr,services:(Ht=xt.services)!==null&&Ht!==void 0?Ht:[],verificationMethods:Jt}),{didDocument:ar,didResolutionMetadata:ir}=yield Ao.resolve(nr,{gatewayUri:xt.gatewayUri});if(ar===null)throw new Error(`Unable to resolve DID during creation: ${ir==null?void 0:ir.error}`);const lr=new BearerDid$1({uri:nr,document:ar,metadata:{published:!1,canonicalId:nr.split(":",3).join(":"),recoveryKey:Xt,updateKey:rr},keyManager:At});if(!((Vt=xt.publish)!==null&&Vt!==void 0)||Vt){const yr=yield Ao.publish({did:lr,gatewayUri:xt.gatewayUri});lr.metadata=yr.didDocumentMetadata}return lr})}static getSigningMethod(At){return __awaiter$19(this,arguments,void 0,function*({didDocument:xt,methodId:Bt}){var Nt;const jt=Did$1.parse(xt.id);if(jt&&jt.method!==this.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,`Method not supported: ${jt.method}`);const Ut=(Nt=xt.verificationMethod)===null||Nt===void 0?void 0:Nt.find(Lt=>{var Ht;return Lt.id===(Bt??((Ht=xt.assertionMethod)===null||Ht===void 0?void 0:Ht[0]))});if(!(Ut&&Ut.publicKeyJwk))throw new DidError$1(DidErrorCode$1.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static import(At){return __awaiter$19(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$2}){const Nt=Did$1.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==Ao.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,"Method not supported");return yield BearerDid$1.import({portableDid:xt,keyManager:Bt})})}static publish(At){return __awaiter$19(this,arguments,void 0,function*({did:xt,gatewayUri:Bt=DEFAULT_GATEWAY_URI$2}){var Nt,jt,Ut;const Lt=(jt=(Nt=xt.document.verificationMethod)===null||Nt===void 0?void 0:Nt.map(zt=>({id:zt.id,publicKeyJwk:zt.publicKeyJwk,purposes:getVerificationRelationshipsById$1({didDocument:xt.document,methodId:zt.id})})))!==null&&jt!==void 0?jt:[],Ht=yield DidIonUtils$1.createIonDocument({services:(Ut=xt.document.service)!==null&&Ut!==void 0?Ut:[],verificationMethods:Lt}),Vt=yield DidIonUtils$1.constructCreateRequest({ionDocument:Ht,recoveryKey:xt.metadata.recoveryKey,updateKey:xt.metadata.updateKey});try{const zt=DidIonUtils$1.appendPathToUrl({baseUrl:Bt,path:"/operations"}),Wt=yield fetch(zt,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(Vt)});return{didDocument:xt.document,didDocumentMetadata:Object.assign(Object.assign({},xt.metadata),{published:Wt.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:DidErrorCode$1.InternalError,errorMessage:`Failed to publish DID document for: ${xt.uri}`}}}})}static resolve(At){return __awaiter$19(this,arguments,void 0,function*(xt,Bt={}){var Nt,jt;const Ut=Did$1.parse(xt);if(!Ut)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"invalidDid"}});if(Ut.method!==Ao.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"methodNotSupported"}});const Lt=(Nt=Bt==null?void 0:Bt.gatewayUri)!==null&&Nt!==void 0?Nt:DEFAULT_GATEWAY_URI$2;try{const Ht=DidIonUtils$1.appendPathToUrl({baseUrl:Lt,path:`/identifiers/${xt}`}),Vt=yield fetch(Ht);if(!Vt.ok)throw new DidError$1(DidErrorCode$1.NotFound,`Unable to find DID document for: ${xt}`);const{didDocument:zt,didDocumentMetadata:Wt}=yield Vt.json();return Object.assign(Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),zt&&{didDocument:zt}),{didDocumentMetadata:Object.assign({published:(jt=Wt==null?void 0:Wt.method)===null||jt===void 0?void 0:jt.published},Wt)})}catch(Ht){if(!(Ht instanceof DidError$1))throw new Error(Ht);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:Object.assign({error:Ht.code},Ht.message&&{errorMessage:Ht.message})})}})}};DidIon$1.methodName="ion";let DidIonUtils$1=class so{static appendPathToUrl({baseUrl:At,path:xt}){const Bt=new URL(At);return Bt.pathname=Bt.pathname.endsWith("/")?Bt.pathname:Bt.pathname+"/",Bt.pathname+=xt.startsWith("/")?xt.substring(1):xt,Bt.toString()}static computeLongFormDidUri(At){return __awaiter$19(this,arguments,void 0,function*({recoveryKey:xt,updateKey:Bt,services:Nt,verificationMethods:jt}){const Ut=yield so.createIonDocument({services:Nt,verificationMethods:jt}),Lt=so.normalizeJwk(xt),Ht=so.normalizeJwk(Bt);return yield IonDid.createLongFormDid({document:Ut,recoveryKey:Lt,updateKey:Ht})})}static constructCreateRequest(At){return __awaiter$19(this,arguments,void 0,function*({ionDocument:xt,recoveryKey:Bt,updateKey:Nt}){return yield IonRequest.createCreateRequest({document:xt,recoveryKey:so.normalizeJwk(Bt),updateKey:so.normalizeJwk(Nt)})})}static createIonDocument(At){return __awaiter$19(this,arguments,void 0,function*({services:xt,verificationMethods:Bt}){var Nt,jt;const Ut=[];for(const Vt of Bt){let zt=(jt=(Nt=Vt.id)!==null&&Nt!==void 0?Nt:Vt.publicKeyJwk.kid)!==null&&jt!==void 0?jt:yield computeJwkThumbprint$1({jwk:Vt.publicKeyJwk});zt=`${zt.split("#").pop()}`;const Wt={id:zt,publicKeyJwk:so.normalizeJwk(Vt.publicKeyJwk),purposes:Vt.purposes,type:"JsonWebKey2020"};Ut.push(Wt)}const Lt=xt.map(Vt=>Object.assign(Object.assign({},Vt),{id:`${Vt.id.split("#").pop()}`}));return{publicKeys:Ut,services:Lt}})}static normalizeJwk(At){const xt=At.kty;let Bt;if(xt==="EC")Bt={crv:At.crv,kty:At.kty,x:At.x,y:At.y};else if(xt==="oct")Bt={k:At.k,kty:At.kty};else if(xt==="OKP")Bt={crv:At.crv,kty:At.kty,x:At.x};else if(xt==="RSA")Bt={e:At.e,kty:At.kty,n:At.n};else throw new Error(`Unsupported key type: ${xt}`);return Bt}};var __awaiter$18=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidJwk$1=class xo extends DidMethod$1{static create(){return __awaiter$18(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$2,options:xt={}}={}){var Bt,Nt,jt,Ut;if(xt.algorithm&&xt.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(xt.verificationMethods&&xt.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const Lt=(Ut=(Bt=xt.algorithm)!==null&&Bt!==void 0?Bt:(jt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt[0])===null||jt===void 0?void 0:jt.algorithm)!==null&&Ut!==void 0?Ut:"Ed25519",Ht=yield At.generateKey({algorithm:Lt}),Vt=yield At.getPublicKey({keyUri:Ht}),zt=Convert$1.object(Vt).toBase64Url(),Wt=`did:${xo.methodName}:${zt}`,Qt=(yield xo.resolve(Wt)).didDocument;return new BearerDid$1({uri:Wt,document:Qt,metadata:{},keyManager:At})})}static getSigningMethod(At){return __awaiter$18(this,arguments,void 0,function*({didDocument:xt}){var Bt;const Nt=Did$1.parse(xt.id);if(Nt&&Nt.method!==this.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,`Method not supported: ${Nt.method}`);const[jt]=(Bt=xt.verificationMethod)!==null&&Bt!==void 0?Bt:[];if(!(jt&&jt.publicKeyJwk))throw new DidError$1(DidErrorCode$1.InternalError,"A verification method intended for signing could not be determined from the DID Document");return jt})}static import(At){return __awaiter$18(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$2}){const Nt=Did$1.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==xo.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,"Method not supported");const jt=yield BearerDid$1.import({portableDid:xt,keyManager:Bt});if(jt.document.verificationMethod.length!==1)throw new DidError$1(DidErrorCode$1.InvalidDidDocument,"DID document must contain exactly one verification method");return jt})}static resolve(At,xt){return __awaiter$18(this,void 0,void 0,function*(){const Bt=Did$1.parse(At);let Nt;try{Nt=Convert$1.base64Url(Bt.id).toObject()}catch{}if(!Bt||!Nt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"invalidDid"}});if(Bt.method!==xo.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"methodNotSupported"}});const jt={"@context":["https://www.w3.org/ns/did/v1"],id:Bt.uri},Ut=`${jt.id}#0`;switch(jt.verificationMethod=[{id:Ut,type:"JsonWebKey",controller:jt.id,publicKeyJwk:Nt}],jt.authentication=[Ut],jt.assertionMethod=[Ut],jt.capabilityInvocation=[Ut],jt.capabilityDelegation=[Ut],jt.keyAgreement=[Ut],Nt.use){case"sig":{delete jt.keyAgreement;break}case"enc":{delete jt.authentication,delete jt.assertionMethod,delete jt.capabilityInvocation,delete jt.capabilityDelegation;break}}return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didDocument:jt})})}};DidJwk$1.methodName="jwk";var __awaiter$17=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidKeyRegisteredKeyType$1;(function(kt){kt.Ed25519="Ed25519",kt.secp256k1="secp256k1",kt.secp256r1="secp256r1",kt.X25519="X25519"})(DidKeyRegisteredKeyType$1||(DidKeyRegisteredKeyType$1={}));const DidKeyVerificationMethodType$1={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},AlgorithmToKeyTypeMap$3={Ed25519:DidKeyRegisteredKeyType$1.Ed25519,ES256K:DidKeyRegisteredKeyType$1.secp256k1,ES256:DidKeyRegisteredKeyType$1.secp256r1,"P-256":DidKeyRegisteredKeyType$1.secp256r1,secp256k1:DidKeyRegisteredKeyType$1.secp256k1,secp256r1:DidKeyRegisteredKeyType$1.secp256r1,X25519:DidKeyRegisteredKeyType$1.X25519};let DidKey$1=class Ki extends DidMethod$1{static create(){return __awaiter$17(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager$2,options:xt={}}={}){var Bt,Nt,jt,Ut;if(xt.algorithm&&xt.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(xt.verificationMethods&&xt.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const Lt=(Ut=(Bt=xt.algorithm)!==null&&Bt!==void 0?Bt:(jt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt[0])===null||jt===void 0?void 0:jt.algorithm)!==null&&Ut!==void 0?Ut:"Ed25519",Ht=yield At.generateKey({algorithm:Lt}),Vt=yield At.getPublicKey({keyUri:Ht}),zt=yield DidKeyUtils$1.publicKeyToMultibaseId({publicKey:Vt}),Wt=`did:${Ki.methodName}:${zt}`,Qt=(yield Ki.resolve(Wt,xt)).didDocument;return new BearerDid$1({uri:Wt,document:Qt,metadata:{},keyManager:At})})}static getSigningMethod(At){return __awaiter$17(this,arguments,void 0,function*({didDocument:xt}){var Bt;const Nt=Did$1.parse(xt.id);if(Nt&&Nt.method!==this.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,`Method not supported: ${Nt.method}`);const[jt]=xt.assertionMethod||[],Ut=(Bt=xt.verificationMethod)===null||Bt===void 0?void 0:Bt.find(Lt=>Lt.id===jt);if(!(Ut&&Ut.publicKeyJwk))throw new DidError$1(DidErrorCode$1.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static import(At){return __awaiter$17(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager$2}){const Nt=Did$1.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==Ki.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,"Method not supported");const jt=yield BearerDid$1.import({portableDid:xt,keyManager:Bt});if(jt.document.verificationMethod.length!==1)throw new DidError$1(DidErrorCode$1.InvalidDidDocument,"DID document must contain exactly one verification method");return jt})}static resolve(At,xt){return __awaiter$17(this,void 0,void 0,function*(){try{const Bt=yield Ki.createDocument({didUri:At,options:xt});return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didDocument:Bt})}catch(Bt){if(!(Bt instanceof DidError$1))throw new Error(Bt);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:Object.assign({error:Bt.code},Bt.message&&{errorMessage:Bt.message})})}})}static createDocument(At){return __awaiter$17(this,arguments,void 0,function*({didUri:xt,options:Bt={}}){const{defaultContext:Nt="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:jt=!1,enableExperimentalPublicKeyTypes:Ut=!1,publicKeyFormat:Lt="JsonWebKey2020"}=Bt,Ht={id:""},Vt=Did$1.parse(xt);if(!Vt)throw new DidError$1(DidErrorCode$1.InvalidDid,`Invalid DID URI: ${xt}`);const zt=Vt.id;if(Vt.method!==Ki.methodName)throw new DidError$1(DidErrorCode$1.MethodNotSupported,`Method not supported: ${Vt.method}`);if(!Ki.validateIdentifier(Vt))throw new DidError$1(DidErrorCode$1.InvalidDid,`Invalid DID URI: ${xt}`);const Wt=yield Ki.createSignatureMethod({didUri:xt,multibaseValue:zt,options:{enableExperimentalPublicKeyTypes:Ut,publicKeyFormat:Lt}});if(Ht.id=Vt.uri,Ht.verificationMethod=[Wt],Ht.authentication=[Wt.id],Ht.assertionMethod=[Wt.id],Ht.capabilityInvocation=[Wt.id],Ht.capabilityDelegation=[Wt.id],jt===!0){const Xt=Lt==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",tr=yield this.createEncryptionMethod({didUri:xt,multibaseValue:zt,options:{enableExperimentalPublicKeyTypes:Ut,publicKeyFormat:Xt}});Ht.verificationMethod.push(tr),Ht.keyAgreement=[tr.id]}const Jt=[Nt];return getVerificationMethodTypes$1({didDocument:Ht}).forEach(Xt=>{const tr=DidKeyVerificationMethodType$1[Xt];Jt.push(tr)}),Ht["@context"]=Jt,Ht})}static createEncryptionMethod(At){return __awaiter$17(this,arguments,void 0,function*({didUri:xt,multibaseValue:Bt,options:Nt}){const{enableExperimentalPublicKeyTypes:jt,publicKeyFormat:Ut}=Nt,Lt={id:"",type:"",controller:""},{keyBytes:Ht,multicodecCode:Vt}=yield Ki.deriveEncryptionKey({multibaseValue:Bt}),zt=Ht.byteLength,Wt=DidKeyUtils$1.MULTICODEC_PUBLIC_KEY_LENGTH[Vt];if(zt!==Wt)throw new DidError$1(DidErrorCode$1.InvalidPublicKeyLength,`Expected ${zt} bytes. Actual: ${Wt}`);const Jt=keyBytesToMultibaseId$1({keyBytes:Ht,multicodecCode:Vt});Lt.id=`${xt}#${Jt}`;try{new URL(Lt.id)}catch{throw new DidError$1(DidErrorCode$1.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(Ut in DidKeyVerificationMethodType$1))throw new DidError$1(DidErrorCode$1.UnsupportedPublicKeyType,`Unsupported format: ${Ut}`);if(jt===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(Ut))throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Specified '${Ut}' without setting enableExperimentalPublicKeyTypes to true.`);if(Lt.type=Ut,Lt.controller=xt,Ut==="X25519KeyAgreementKey2020"&&(Lt.publicKeyMultibase=Jt),Ut==="JsonWebKey2020"){const{crv:Xt}=yield DidKeyUtils$1.multicodecToJwk({code:Vt});Lt.publicKeyJwk=yield DidKeyUtils$1.keyConverter(Xt).bytesToPublicKey({publicKeyBytes:Ht})}return Lt})}static createSignatureMethod(At){return __awaiter$17(this,arguments,void 0,function*({didUri:xt,multibaseValue:Bt,options:Nt}){const{enableExperimentalPublicKeyTypes:jt,publicKeyFormat:Ut}=Nt,Lt={id:"",type:"",controller:""},{keyBytes:Ht,multicodecCode:Vt,multicodecName:zt}=multibaseIdToKeyBytes$1({multibaseKeyId:Bt}),Wt=Ht.byteLength,Jt=DidKeyUtils$1.MULTICODEC_PUBLIC_KEY_LENGTH[Vt];if(Wt!==Jt)throw new DidError$1(DidErrorCode$1.InvalidPublicKeyLength,`Expected ${Wt} bytes. Actual: ${Jt}`);let Qt=!1;switch(zt){case"secp256k1-pub":Qt=yield Secp256k1$1.validatePublicKey({publicKeyBytes:Ht});break;case"ed25519-pub":Qt=yield Ed25519$1.validatePublicKey({publicKeyBytes:Ht});break;case"x25519-pub":Qt=!0;break}if(!Qt)throw new DidError$1(DidErrorCode$1.InvalidPublicKey,"Invalid public key detected.");Lt.id=`${xt}#${Bt}`;try{new URL(Lt.id)}catch{throw new DidError$1(DidErrorCode$1.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(Ut in DidKeyVerificationMethodType$1))throw new DidError$1(DidErrorCode$1.UnsupportedPublicKeyType,`Unsupported format: ${Ut}`);if(jt===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(Ut))throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Specified '${Ut}' without setting enableExperimentalPublicKeyTypes to true.`);if(Lt.type=Ut,Lt.controller=xt,Ut==="Ed25519VerificationKey2020"&&(Lt.publicKeyMultibase=Bt),Ut==="JsonWebKey2020"){const{crv:tr}=yield DidKeyUtils$1.multicodecToJwk({code:Vt});Lt.publicKeyJwk=yield DidKeyUtils$1.keyConverter(tr).bytesToPublicKey({publicKeyBytes:Ht})}return Lt})}static deriveEncryptionKey(At){return __awaiter$17(this,arguments,void 0,function*({multibaseValue:xt}){let Bt={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:Nt,multicodecCode:jt}=multibaseIdToKeyBytes$1({multibaseKeyId:xt});if(jt===237){const Ut=yield DidKeyUtils$1.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:Nt}),Lt=yield Ed25519$1.convertPublicKeyToX25519({publicKey:Ut});Bt={keyBytes:yield DidKeyUtils$1.keyConverter("Ed25519").publicKeyToBytes({publicKey:Lt}),multicodecCode:236}}return Bt})}static validateIdentifier(At){const{method:xt,id:Bt}=At,[Nt]=At.uri.split(":",1);return Nt==="did"&&xt==="key"&&Number("1")>0&&universalTypeOf$1(Bt)==="String"&&Bt.startsWith("z")}};DidKey$1.methodName="key";let DidKeyUtils$1=class yo{static jwkToMulticodec(At){return __awaiter$17(this,arguments,void 0,function*({jwk:xt}){const Bt=[];xt.crv&&(Bt.push(xt.crv),xt.d?Bt.push("private"):Bt.push("public"));const Nt=Bt.join(":"),jt=yo.JWK_TO_MULTICODEC[Nt];if(jt===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${Nt}'`);return{code:Multicodec$1.getCodeFromName({name:jt}),name:jt}})}static keyCompressor(At){const Bt={"P-256":Secp256r1$1.compressPublicKey,secp256k1:Secp256k1$1.compressPublicKey}[At];if(!Bt)throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static keyConverter(At){const Bt={Ed25519:Ed25519$1,"P-256":Secp256r1$1,secp256k1:Secp256k1$1,X25519:X25519$1}[At];if(!Bt)throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static multicodecToJwk(At){return __awaiter$17(this,arguments,void 0,function*({code:xt,name:Bt}){if(!(Bt?!xt:xt))throw new Error("Either 'name' or 'code' must be defined, but not both.");Bt=Bt===void 0?Multicodec$1.getNameFromCode({code:xt}):Bt;const Nt=Bt,jt=yo.MULTICODEC_TO_JWK[Nt];if(jt===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},jt)})}static publicKeyToMultibaseId(At){return __awaiter$17(this,arguments,void 0,function*({publicKey:xt}){var Bt;if(!(xt!=null&&xt.crv&&xt.crv in AlgorithmToKeyTypeMap$3))throw new DidError$1(DidErrorCode$1.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(Bt=xt==null?void 0:xt.crv)!==null&&Bt!==void 0?Bt:"undefined"}`);let Nt=yield yo.keyConverter(xt.crv).publicKeyToBytes({publicKey:xt});/^(secp256k1|P-256|P-384|P-521)$/.test(xt.crv)&&(Nt=yield yo.keyCompressor(xt.crv)({publicKeyBytes:Nt}));const{name:jt}=yield yo.jwkToMulticodec({jwk:xt});return keyBytesToMultibaseId$1({keyBytes:Nt,multicodecName:jt})})}};DidKeyUtils$1.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};DidKeyUtils$1.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};DidKeyUtils$1.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var __awaiter$16=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let DidWeb$1=class vs extends DidMethod$1{static resolve(At,xt){return __awaiter$16(this,void 0,void 0,function*(){const Bt=Did$1.parse(At);if(!Bt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"invalidDid"}});if(Bt.method!==vs.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"methodNotSupported"}});let Nt=`https://${Bt.id.replace(/:/g,"/")}`;Nt=decodeURIComponent(Nt);const jt=Bt.id.includes(":")?`${Nt}/did.json`:`${Nt}/.well-known/did.json`;try{const Ut=yield fetch(jt);if(!Ut.ok)throw new Error("HTTP error status code returned");const Lt=yield Ut.json();return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didDocument:Lt})}catch{return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:"notFound"}})}})}};DidWeb$1.methodName="web";var __awaiter$15=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DidResolverCacheLevel{constructor({db:At,location:xt="DATA/DID_RESOLVERCACHE",ttl:Bt="15m"}={}){this.cache=At??new Level$1(xt),this.ttl=ms$1(Bt)}get(At){return __awaiter$15(this,void 0,void 0,function*(){try{const xt=yield this.cache.get(At),Bt=JSON.parse(xt);if(Date.now()>=Bt.ttlMillis){this.cache.nextTick(()=>this.cache.del(At));return}else return Bt.value}catch(xt){if(xt.notFound)return;throw xt}})}set(At,xt){const Bt={ttlMillis:Date.now()+this.ttl,value:xt},Nt=JSON.stringify(Bt);return this.cache.put(At,Nt)}delete(At){return this.cache.del(At)}clear(){return this.cache.clear()}close(){return this.cache.close()}}const DidResolverCacheNoop$1={get:function(kt){return null},set:function(kt,At){return null},delete:function(kt){return null},clear:function(){return null},close:function(){return null}};var __awaiter$14=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let UniversalResolver$1=class{constructor({cache:At,didResolvers:xt}){this.didResolvers=new Map,this.cache=At||DidResolverCacheNoop$1;for(const Bt of xt)this.didResolvers.set(Bt.methodName,Bt)}resolve(At,xt){return __awaiter$14(this,void 0,void 0,function*(){const Bt=Did$1.parse(At);if(!Bt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:DidErrorCode$1.InvalidDid,errorMessage:`Invalid DID URI: ${At}`}});const Nt=this.didResolvers.get(Bt.method);if(!Nt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT$1),{didResolutionMetadata:{error:DidErrorCode$1.MethodNotSupported,errorMessage:`Method not supported: ${Bt.method}`}});const jt=yield this.cache.get(Bt.uri);if(jt)return jt;{const Ut=yield Nt.resolve(Bt.uri,xt);return Ut.didResolutionMetadata.error||(yield this.cache.set(Bt.uri,Ut)),Ut}})}dereference(At,xt){return __awaiter$14(this,void 0,void 0,function*(){const Bt=Did$1.parse(At);if(!Bt)return{dereferencingMetadata:{error:DidErrorCode$1.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:Nt,didResolutionMetadata:jt,didDocumentMetadata:Ut}=yield this.resolve(Bt.uri);if(!Nt)return{dereferencingMetadata:{error:jt.error},contentStream:null,contentMetadata:{}};if(!Bt.fragment||Bt.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:Nt,contentMetadata:Ut};const{service:Lt=[],verificationMethod:Ht=[]}=Nt,Vt=new Set([At,Bt.fragment,`#${Bt.fragment}`]);let zt;for(let Wt of Ht)if(Vt.has(Wt.id)){zt=Wt;break}for(let Wt of Lt)if(Vt.has(Wt.id)){zt=Wt;break}return zt?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:zt,contentMetadata:jt}:{dereferencingMetadata:{error:DidErrorCode$1.NotFound},contentStream:null,contentMetadata:{}}})}};var __awaiter$13=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class AgentDidResolverCache extends DidResolverCacheLevel{constructor({agent:At,db:xt,location:Bt,ttl:Nt}){super({db:xt,location:Bt,ttl:Nt}),this._resolving=new Map,this._agent=At}get agent(){if(!this._agent)throw new Error("Agent not initialized");return this._agent}set agent(At){this._agent=At}get(At){return __awaiter$13(this,void 0,void 0,function*(){try{const xt=yield this.cache.get(At),Bt=JSON.parse(xt);if(!this._resolving.has(At)&&Date.now()>=Bt.ttlMillis)if(this._resolving.set(At,!0),this.agent.agentDid.uri===At||typeof(yield this.agent.identity.get({didUri:At}))<"u")try{const Nt=yield this.agent.did.resolve(At);Nt.didResolutionMetadata.error||this.set(At,Nt)}finally{this._resolving.delete(At)}else this._resolving.delete(At),this.cache.nextTick(()=>this.cache.del(At));return Bt.value}catch(xt){if(xt.notFound)return;throw xt}})}}var __awaiter$12=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class BearerIdentity{constructor({did:At,metadata:xt}){this.did=At,this.metadata=xt}export(){return __awaiter$12(this,void 0,void 0,function*(){return{portableDid:yield this.did.export(),metadata:this.metadata}})}}var __awaiter$11=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Hkdf{static deriveKeyBytes({baseKeyBytes:At,length:xt,hash:Bt,salt:Nt,info:jt=new Uint8Array}){return __awaiter$11(this,void 0,void 0,function*(){const Lt=yield getWebcryptoSubtle().importKey("raw",At,{name:"HKDF"},!1,["deriveBits"]);Nt=typeof Nt=="string"?Convert$1.string(Nt).toUint8Array():Nt,jt=typeof jt=="string"?Convert$1.string(jt).toUint8Array():jt;const Ht=yield crypto.subtle.deriveBits({name:"HKDF",hash:Bt,salt:Nt,info:jt},Lt,xt);return new Uint8Array(Ht)})}}var __awaiter$10=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$i=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class HkdfAlgorithm extends CryptoAlgorithm$1{deriveKeyBytes(At){var{algorithm:xt}=At,Bt=__rest$i(At,["algorithm"]);return __awaiter$10(this,void 0,void 0,function*(){const Nt={"HKDF-256":"SHA-256","HKDF-384":"SHA-384","HKDF-512":"SHA-512"}[xt];return yield Hkdf.deriveKeyBytes(Object.assign(Object.assign({},Bt),{hash:Nt}))})}}class CryptoError extends Error{constructor(At,xt){super(xt),this.code=At,this.name="CryptoError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,CryptoError)}}var CryptoErrorCode;(function(kt){kt.AlgorithmNotSupported="algorithmNotSupported",kt.EncodingError="encodingError",kt.InvalidJwe="invalidJwe",kt.InvalidJwk="invalidJwk",kt.OperationNotSupported="operationNotSupported"})(CryptoErrorCode||(CryptoErrorCode={}));var __awaiter$$=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let EcdsaAlgorithm$1=class extends CryptoAlgorithm$1{bytesToPrivateKey({algorithm:At,privateKeyBytes:xt}){return __awaiter$$(this,void 0,void 0,function*(){switch(At){case"ES256K":case"secp256k1":{const Bt=yield Secp256k1$1.bytesToPrivateKey({privateKeyBytes:xt});return Bt.alg="EdDSA",Bt}case"ES256":case"secp256r1":{const Bt=yield Secp256r1$1.bytesToPrivateKey({privateKeyBytes:xt});return Bt.alg="EdDSA",Bt}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported: ${At}`)}})}bytesToPublicKey({algorithm:At,publicKeyBytes:xt}){return __awaiter$$(this,void 0,void 0,function*(){switch(At){case"ES256K":case"secp256k1":{const Bt=yield Secp256k1$1.bytesToPublicKey({publicKeyBytes:xt});return Bt.alg="EdDSA",Bt}case"ES256":case"secp256r1":{const Bt=yield Secp256r1$1.bytesToPublicKey({publicKeyBytes:xt});return Bt.alg="EdDSA",Bt}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported: ${At}`)}})}computePublicKey({key:At}){return __awaiter$$(this,void 0,void 0,function*(){if(!isEcPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(At.crv){case"secp256k1":{const xt=yield Secp256k1$1.computePublicKey({key:At});return xt.alg="ES256K",xt}case"P-256":{const xt=yield Secp256r1$1.computePublicKey({key:At});return xt.alg="ES256",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}generateKey({algorithm:At}){return __awaiter$$(this,void 0,void 0,function*(){switch(At){case"ES256K":case"secp256k1":{const xt=yield Secp256k1$1.generateKey();return xt.alg="ES256K",xt}case"ES256":case"secp256r1":{const xt=yield Secp256r1$1.generateKey();return xt.alg="ES256",xt}}})}getPublicKey({key:At}){return __awaiter$$(this,void 0,void 0,function*(){if(!isEcPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(At.crv){case"secp256k1":{const xt=yield Secp256k1$1.getPublicKey({key:At});return xt.alg="ES256K",xt}case"P-256":{const xt=yield Secp256r1$1.getPublicKey({key:At});return xt.alg="ES256",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}privateKeyToBytes({privateKey:At}){return __awaiter$$(this,void 0,void 0,function*(){switch(At.crv){case"secp256k1":return yield Secp256k1$1.privateKeyToBytes({privateKey:At});case"P-256":return yield Secp256r1$1.privateKeyToBytes({privateKey:At});default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}publicKeyToBytes({publicKey:At}){return __awaiter$$(this,void 0,void 0,function*(){switch(At.crv){case"secp256k1":return yield Secp256k1$1.publicKeyToBytes({publicKey:At});case"P-256":return yield Secp256r1$1.publicKeyToBytes({publicKey:At});default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}sign({key:At,data:xt}){return __awaiter$$(this,void 0,void 0,function*(){if(!isEcPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(At.crv){case"secp256k1":return yield Secp256k1$1.sign({key:At,data:xt});case"P-256":return yield Secp256r1$1.sign({key:At,data:xt});default:throw new Error(`Unsupported curve: ${At.crv}`)}})}verify({key:At,signature:xt,data:Bt}){return __awaiter$$(this,void 0,void 0,function*(){if(!isEcPublicJwk$1(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(At.crv){case"secp256k1":return yield Secp256k1$1.verify({key:At,signature:xt,data:Bt});case"P-256":return yield Secp256r1$1.verify({key:At,signature:xt,data:Bt});default:throw new Error(`Unsupported curve: ${At.crv}`)}})}};var __awaiter$_=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};let EdDsaAlgorithm$1=class extends CryptoAlgorithm$1{bytesToPrivateKey({algorithm:At,privateKeyBytes:xt}){return __awaiter$_(this,void 0,void 0,function*(){switch(At){case"Ed25519":{const Bt=yield Ed25519$1.bytesToPrivateKey({privateKeyBytes:xt});return Bt.alg="EdDSA",Bt}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported: ${At}`)}})}bytesToPublicKey({algorithm:At,publicKeyBytes:xt}){return __awaiter$_(this,void 0,void 0,function*(){switch(At){case"Ed25519":{const Bt=yield Ed25519$1.bytesToPublicKey({publicKeyBytes:xt});return Bt.alg="EdDSA",Bt}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported: ${At}`)}})}computePublicKey({key:At}){return __awaiter$_(this,void 0,void 0,function*(){if(!isOkpPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(At.crv){case"Ed25519":{const xt=yield Ed25519$1.computePublicKey({key:At});return xt.alg="EdDSA",xt}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}generateKey({algorithm:At}){return __awaiter$_(this,void 0,void 0,function*(){switch(At){case"Ed25519":{const xt=yield Ed25519$1.generateKey();return xt.alg="EdDSA",xt}}})}getPublicKey({key:At}){return __awaiter$_(this,void 0,void 0,function*(){if(!isOkpPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(At.crv){case"Ed25519":{const xt=yield Ed25519$1.getPublicKey({key:At});return xt.alg="EdDSA",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}privateKeyToBytes({privateKey:At}){return __awaiter$_(this,void 0,void 0,function*(){switch(At.crv){case"Ed25519":return yield Ed25519$1.privateKeyToBytes({privateKey:At});default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}publicKeyToBytes({publicKey:At}){return __awaiter$_(this,void 0,void 0,function*(){switch(At.crv){case"Ed25519":return yield Ed25519$1.publicKeyToBytes({publicKey:At});default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}sign({key:At,data:xt}){return __awaiter$_(this,void 0,void 0,function*(){if(!isOkpPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(At.crv){case"Ed25519":return yield Ed25519$1.sign({key:At,data:xt});default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}verify({key:At,signature:xt,data:Bt}){return __awaiter$_(this,void 0,void 0,function*(){if(!isOkpPublicJwk$1(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(At.crv){case"Ed25519":return yield Ed25519$1.verify({key:At,signature:xt,data:Bt});default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Curve not supported: ${At.crv}`)}})}};var __awaiter$Z=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$h=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const AES_KEY_LENGTHS=[128,192,256];class AesKw{static bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$Z(this,void 0,void 0,function*(){const xt={k:Convert$1.uint8Array(At).toBase64Url(),kty:"oct"};xt.kid=yield computeJwkThumbprint$1({jwk:xt});const Bt=At.length*8;return xt.alg={128:"A128KW",192:"A192KW",256:"A256KW"}[Bt],xt})}static generateKey({length:At}){return __awaiter$Z(this,void 0,void 0,function*(){if(!AES_KEY_LENGTHS.includes(At))throw new RangeError(`The key length is invalid: Must be ${AES_KEY_LENGTHS.join(", ")} bits`);const xt=getWebcryptoSubtle(),Bt=yield xt.generateKey({name:"AES-KW",length:At},!0,["wrapKey","unwrapKey"]),Nt=yield xt.exportKey("jwk",Bt),jt=__rest$h(Nt,["ext","key_ops"]);return jt.kid=yield computeJwkThumbprint$1({jwk:jt}),jt})}static privateKeyToBytes({privateKey:At}){return __awaiter$Z(this,void 0,void 0,function*(){if(!isOctPrivateJwk(At))throw new Error("AesKw: The provided key is not a valid oct private key.");return Convert$1.base64Url(At.k).toUint8Array()})}static unwrapKey({wrappedKeyBytes:At,wrappedKeyAlgorithm:xt,decryptionKey:Bt}){return __awaiter$Z(this,void 0,void 0,function*(){if(!("alg"in Bt&&Bt.alg))throw new CryptoError(CryptoErrorCode.InvalidJwk,"The decryption key is missing the 'alg' property.");if(!["A128KW","A192KW","A256KW"].includes(Bt.alg))throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`The 'decryptionKey' algorithm is not supported: ${Bt.alg}`);const Nt=getWebcryptoSubtle(),jt=yield Nt.importKey("jwk",Bt,{name:"AES-KW"},!0,["unwrapKey"]),Ut={A128KW:"AES-KW",A192KW:"AES-KW",A256KW:"AES-KW",A128GCM:"AES-GCM",A192GCM:"AES-GCM",A256GCM:"AES-GCM"}[xt];if(!Ut)throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`The 'wrappedKeyAlgorithm' is not supported: ${xt}`);const Lt=yield Nt.unwrapKey("raw",At.buffer,jt,"AES-KW",{name:Ut},!0,["unwrapKey"]),Ht=yield Nt.exportKey("jwk",Lt),zt=__rest$h(Ht,["ext","key_ops"]);return zt.kid=yield computeJwkThumbprint$1({jwk:zt}),zt})}static wrapKey({unwrappedKey:At,encryptionKey:xt}){return __awaiter$Z(this,void 0,void 0,function*(){if(!("alg"in xt&&xt.alg))throw new CryptoError(CryptoErrorCode.InvalidJwk,"The encryption key is missing the 'alg' property.");if(!["A128KW","A192KW","A256KW"].includes(xt.alg))throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`The 'encryptionKey' algorithm is not supported: ${xt.alg}`);if(!("alg"in At&&At.alg))throw new CryptoError(CryptoErrorCode.InvalidJwk,"The private key to wrap is missing the 'alg' property.");const Bt=getWebcryptoSubtle(),Nt=yield Bt.importKey("jwk",xt,{name:"AES-KW"},!0,["wrapKey"]),jt={A128KW:"AES-KW",A192KW:"AES-KW",A256KW:"AES-KW",A128GCM:"AES-GCM",A192GCM:"AES-GCM",A256GCM:"AES-GCM"}[At.alg];if(!jt)throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`The 'unwrappedKey' algorithm is not supported: ${At.alg}`);const Ut=yield Bt.importKey("jwk",At,{name:jt},!0,["unwrapKey"]),Lt=yield Bt.wrapKey("raw",Ut,Nt,"AES-KW");return new Uint8Array(Lt)})}}var __awaiter$Y=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class AesKwAlgorithm extends CryptoAlgorithm$1{bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$Y(this,void 0,void 0,function*(){const xt=yield AesKw.bytesToPrivateKey({privateKeyBytes:At});return xt.alg={16:"A128KW",24:"A192KW",32:"A256KW"}[At.length],xt})}generateKey({algorithm:At}){return __awaiter$Y(this,void 0,void 0,function*(){const xt={A128KW:128,A192KW:192,A256KW:256}[At],Bt=yield AesKw.generateKey({length:xt});return Bt.alg=At,Bt})}privateKeyToBytes({privateKey:At}){return __awaiter$Y(this,void 0,void 0,function*(){return yield AesKw.privateKeyToBytes({privateKey:At})})}unwrapKey(At){return __awaiter$Y(this,void 0,void 0,function*(){return yield AesKw.unwrapKey(At)})}wrapKey(At){return __awaiter$Y(this,void 0,void 0,function*(){return AesKw.wrapKey(At)})}}var __awaiter$X=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Pbkdf2{static deriveKeyBytes({baseKeyBytes:At,hash:xt,salt:Bt,iterations:Nt,length:jt}){return __awaiter$X(this,void 0,void 0,function*(){const Ut=getWebcryptoSubtle(),Lt=yield Ut.importKey("raw",At,{name:"PBKDF2"},!1,["deriveBits"]),Ht=yield Ut.deriveBits({name:"PBKDF2",hash:xt,salt:Bt,iterations:Nt},Lt,jt);return new Uint8Array(Ht)})}}var __awaiter$W=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$g=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Pbkdf2Algorithm extends CryptoAlgorithm$1{deriveKeyBytes(At){var{algorithm:xt}=At,Bt=__rest$g(At,["algorithm"]);return __awaiter$W(this,void 0,void 0,function*(){const[,Nt]=xt.split(/[-+]/),jt={HS256:"SHA-256",HS384:"SHA-384",HS512:"SHA-512"}[Nt];return yield Pbkdf2.deriveKeyBytes(Object.assign(Object.assign({},Bt),{hash:jt}))})}}var __awaiter$V=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class AesGcmAlgorithm extends CryptoAlgorithm$1{bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$V(this,void 0,void 0,function*(){const xt=yield AesGcm.bytesToPrivateKey({privateKeyBytes:At});return xt.alg={16:"A128GCM",24:"A192GCM",32:"A256GCM"}[At.length],xt})}decrypt(At){return __awaiter$V(this,void 0,void 0,function*(){return AesGcm.decrypt(At)})}encrypt(At){return __awaiter$V(this,void 0,void 0,function*(){return AesGcm.encrypt(At)})}generateKey({algorithm:At}){return __awaiter$V(this,void 0,void 0,function*(){const xt={A128GCM:128,A192GCM:192,A256GCM:256}[At],Bt=yield AesGcm.generateKey({length:xt});return Bt.alg=At,Bt})}privateKeyToBytes({privateKey:At}){return __awaiter$V(this,void 0,void 0,function*(){return yield AesGcm.privateKeyToBytes({privateKey:At})})}}var __awaiter$U=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const supportedAlgorithms$2={"AES-GCM":{implementation:AesGcmAlgorithm,names:["A128GCM","A192GCM","A256GCM"],operations:["bytesToPrivateKey","decrypt","encrypt","generateKey"]},"AES-KW":{implementation:AesKwAlgorithm,names:["A128KW","A192KW","A256KW"],operations:["bytesToPrivateKey","generateKey","privateKeyToBytes","wrapKey","unwrapKey"]},Ed25519:{implementation:EdDsaAlgorithm$1,names:["Ed25519"],operations:["bytesToPrivateKey","bytesToPublicKey","generateKey","sign","verify"]},HKDF:{implementation:HkdfAlgorithm,names:["HKDF-256","HKDF-384","HKDF-512"],operations:["deriveKey","deriveKeyBytes"]},PBKDF2:{implementation:Pbkdf2Algorithm,names:["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"],operations:["deriveKey","deriveKeyBytes"]},secp256k1:{implementation:EcdsaAlgorithm$1,names:["ES256K","secp256k1"],operations:["bytesToPrivateKey","bytesToPublicKey","generateKey","sign","verify"]},secp256r1:{implementation:EcdsaAlgorithm$1,names:["ES256","secp256r1"],operations:["bytesToPrivateKey","bytesToPublicKey","generateKey","sign","verify"]},"SHA-256":{implementation:Sha2Algorithm$1,names:["SHA-256"],operations:["digest"]}};class AgentCryptoApi{constructor(){this._algorithmInstances=new Map}bytesToPrivateKey({algorithm:At,privateKeyBytes:xt}){return __awaiter$U(this,void 0,void 0,function*(){const Bt=this.getAlgorithmName({algorithm:At});return yield this.getAlgorithm({algorithm:Bt}).bytesToPrivateKey({algorithm:At,privateKeyBytes:xt})})}bytesToPublicKey({algorithm:At,publicKeyBytes:xt}){return __awaiter$U(this,void 0,void 0,function*(){const Bt=this.getAlgorithmName({algorithm:At});return yield this.getAlgorithm({algorithm:Bt}).bytesToPublicKey({algorithm:At,publicKeyBytes:xt})})}decrypt(At){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At.key});return yield this.getAlgorithm({algorithm:xt}).decrypt(At)})}deriveKey(At){var xt,Bt;return __awaiter$U(this,void 0,void 0,function*(){const Nt=this.getAlgorithmName({algorithm:At.algorithm}),jt=this.getAlgorithm({algorithm:Nt});let Ut;switch(At.algorithm){case"HKDF-256":case"HKDF-384":case"HKDF-512":{Ut=At.derivedKeyAlgorithm;break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{Ut=At.algorithm.split(/[-+]/)[2];break}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`The specified "algorithm" is not supported: ${At.algorithm}`)}const Lt=+((Bt=(xt=Ut.match(/\d+/))===null||xt===void 0?void 0:xt[0])!==null&&Bt!==void 0?Bt:-1);if(Lt===-1)throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`The derived key algorithm" is not supported: ${Ut}`);const Ht=yield jt.deriveKeyBytes(Object.assign(Object.assign({},At),{length:Lt}));return yield this.bytesToPrivateKey({algorithm:Ut,privateKeyBytes:Ht})})}deriveKeyBytes(At){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({algorithm:At.algorithm});return yield this.getAlgorithm({algorithm:xt}).deriveKeyBytes(At)})}digest({algorithm:At,data:xt}){return __awaiter$U(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:At}).digest({algorithm:At,data:xt})})}encrypt(At){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At.key});return yield this.getAlgorithm({algorithm:xt}).encrypt(At)})}generateKey(At){var xt;return __awaiter$U(this,void 0,void 0,function*(){const Bt=this.getAlgorithmName({algorithm:At.algorithm}),jt=yield this.getAlgorithm({algorithm:Bt}).generateKey({algorithm:At.algorithm});return(xt=jt.kid)!==null&&xt!==void 0||(jt.kid=yield computeJwkThumbprint$1({jwk:jt})),jt})}getKeyUri(At){return __awaiter$U(this,void 0,void 0,function*(){throw new Error("Method not implemented.")})}getPublicKey({key:At}){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At});return yield this.getAlgorithm({algorithm:xt}).getPublicKey({key:At})})}privateKeyToBytes({privateKey:At}){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At});return yield this.getAlgorithm({algorithm:xt}).privateKeyToBytes({privateKey:At})})}publicKeyToBytes({publicKey:At}){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At});return yield this.getAlgorithm({algorithm:xt}).publicKeyToBytes({publicKey:At})})}sign({key:At,data:xt}){return __awaiter$U(this,void 0,void 0,function*(){const Bt=this.getAlgorithmName({key:At});return this.getAlgorithm({algorithm:Bt}).sign({data:xt,key:At})})}unwrapKey(At){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At.decryptionKey});return yield this.getAlgorithm({algorithm:xt}).unwrapKey(At)})}verify({key:At,signature:xt,data:Bt}){return __awaiter$U(this,void 0,void 0,function*(){const Nt=this.getAlgorithmName({key:At});return this.getAlgorithm({algorithm:Nt}).verify({key:At,signature:xt,data:Bt})})}wrapKey(At){return __awaiter$U(this,void 0,void 0,function*(){const xt=this.getAlgorithmName({key:At.encryptionKey});return yield this.getAlgorithm({algorithm:xt}).wrapKey(At)})}getAlgorithm({algorithm:At}){var xt;const Bt=(xt=supportedAlgorithms$2[At])===null||xt===void 0?void 0:xt.implementation;if(!Bt)throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported: ${At}`);return this._algorithmInstances.has(Bt)||this._algorithmInstances.set(Bt,new Bt),this._algorithmInstances.get(Bt)}getAlgorithmName({algorithm:At,key:xt}){var Bt;const Nt=(Bt=xt==null?void 0:xt.alg)!==null&&Bt!==void 0?Bt:At,jt=xt==null?void 0:xt.crv;for(const Ut of Object.keys(supportedAlgorithms$2)){const Lt=supportedAlgorithms$2[Ut].names;if(Nt&&Lt.includes(Nt))return Ut;if(jt&&Lt.includes(jt))return Ut}throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported based on provided input: alg=${Nt}, crv=${jt}. Please check the documentation for the list of supported algorithms.`)}}const IdentityProtocolDefinition={protocol:"http://identity.foundation/protocols/web5/identity-store",published:!1,types:{portableDid:{schema:"https://identity.foundation/schemas/web5/portable-did",dataFormats:["application/json"]},identityMetadata:{schema:"https://identity.foundation/schemas/web5/identity-metadata",dataFormats:["application/json"]}},structure:{portableDid:{},identityMetadata:{}}},JwkProtocolDefinition={protocol:"http://identity.foundation/protocols/web5/jwk-store",published:!1,types:{privateJwk:{schema:"https://identity.foundation/schemas/web5/private-jwk",dataFormats:["application/json"]}},structure:{privateJwk:{}}};function isPortableDid(kt){return!(!kt||typeof kt!="object"||kt===null)&&"uri"in kt&&"document"in kt&&"metadata"in kt&&(!("keyManager"in kt)||kt.keyManager===void 0)}var __awaiter$T=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$f=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const TENANT_SEPARATOR="^";class DeterministicKeyGenerator extends LocalKeyManager$2{constructor(){super(),this._predefinedKeys=new Map,this._keyGenerator=this._predefinedKeys.keys()}addPredefinedKeys({privateKeys:At}){var xt;return __awaiter$T(this,void 0,void 0,function*(){const Bt={};for(const Nt of At){(xt=Nt.kid)!==null&&xt!==void 0||(Nt.kid=yield computeJwkThumbprint$1({jwk:Nt}));const jt=yield this.getKeyUri({key:Nt});Bt[jt]=Nt}this._predefinedKeys=new Map(Object.entries(Bt)),this._keyGenerator=this._predefinedKeys.keys()})}exportKey({keyUri:At}){return __awaiter$T(this,void 0,void 0,function*(){const xt=this._predefinedKeys.get(At);if(!xt)throw new Error(`DeterministicKeyGenerator.exportKey: Key not found: ${At}`);return xt})}generateKey(At){return __awaiter$T(this,void 0,void 0,function*(){const{value:xt,done:Bt}=this._keyGenerator.next();if(Bt)throw new Error("Ran out of predefined keys");return xt})}getPublicKey({keyUri:At}){return __awaiter$T(this,void 0,void 0,function*(){const xt=this._predefinedKeys.get(At);if(!xt)throw new Error(`DeterministicKeyGenerator.getPublicKey: Key not found: ${At}`);return __rest$f(xt,["d"])})}sign({keyUri:At,data:xt}){return __awaiter$T(this,void 0,void 0,function*(){const Bt=this._predefinedKeys.get(At);if(!Bt)throw new Error(`DeterministicKeyGenerator.sign: Key not found: ${At}`);return yield Ed25519$1.sign({data:xt,key:Bt})})}}function getDataStoreTenant({agent:kt,tenant:At,didUri:xt}){return __awaiter$T(this,void 0,void 0,function*(){if(At)return At;if(kt.agentDid)return kt.agentDid.uri;if(!xt)throw new Error("Failed to determine tenant DID: 'agent.agentDid', 'tenant', and 'didUri' are undefined");return xt})}var __awaiter$S=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DwnDataStore{constructor(){this.name="DwnDataStore",this._cache=new TtlCache({ttl:ms$1("15 minutes"),max:100}),this._index=new TtlCache({ttl:ms$1("21 days"),max:1e3}),this._protocolInitializedCache=new TtlCache({ttl:ms$1("21 days"),max:1e3}),this._recordProperties={dataFormat:"application/json"}}delete({id:At,agent:xt,tenant:Bt}){return __awaiter$S(this,void 0,void 0,function*(){const Nt=yield getDataStoreTenant({agent:xt,tenant:Bt,didUri:At});let jt=yield this.lookupRecordId({id:At,tenantDid:Nt,agent:xt});if(!jt)return!1;const{reply:{status:Ut}}=yield xt.dwn.processRequest({author:Nt,target:Nt,messageType:DwnInterface.RecordsDelete,messageParams:{recordId:jt}});if(Ut.code===202)return this._index.delete(`${Nt}${TENANT_SEPARATOR}${At}`),this._cache.delete(jt),!0;throw new Error(`${this.name}: Failed to delete '${At}' from store: (${Ut.code}) ${Ut.detail}`)})}get({id:At,agent:xt,tenant:Bt,useCache:Nt=!1}){return __awaiter$S(this,void 0,void 0,function*(){const jt=yield getDataStoreTenant({agent:xt,tenant:Bt,didUri:At});let Ut=yield this.lookupRecordId({id:At,tenantDid:jt,agent:xt});if(Ut)return yield this.getRecord({recordId:Ut,tenantDid:jt,agent:xt,useCache:Nt})})}list({agent:At,tenant:xt}){return __awaiter$S(this,void 0,void 0,function*(){const Bt=yield getDataStoreTenant({tenant:xt,agent:At});return yield this.getAllRecords({agent:At,tenantDid:Bt})})}set({id:At,data:xt,tenant:Bt,agent:Nt,preventDuplicates:jt=!0,useCache:Ut=!1}){return __awaiter$S(this,void 0,void 0,function*(){const Lt=yield getDataStoreTenant({agent:Nt,tenant:Bt,didUri:At});if(yield this.initialize({tenant:Lt,agent:Nt}),jt&&(yield this.lookupRecordId({id:At,tenantDid:Lt,agent:Nt})))throw new Error(`${this.name}: Import failed due to duplicate entry for: ${At}`);const Ht=Convert$1.object(xt).toUint8Array(),{message:Vt,reply:{status:zt}}=yield Nt.dwn.processRequest({author:Lt,target:Lt,messageType:DwnInterface.RecordsWrite,messageParams:Object.assign({},this._recordProperties),dataStream:new Blob([Ht],{type:"application/json"})});if(!(Vt&&zt.code===202))throw new Error(`${this.name}: Failed to write data to store for ${At}: ${zt.detail}`);this._index.set(`${Lt}${TENANT_SEPARATOR}${At}`,Vt.recordId),Ut&&this._cache.set(Vt.recordId,xt)})}initialize({tenant:At,agent:xt}){return __awaiter$S(this,void 0,void 0,function*(){const Bt=yield getDataStoreTenant({agent:xt,tenant:At});if(this._protocolInitializedCache.has(Bt))return;const{reply:{status:Nt,entries:jt}}=yield xt.dwn.processRequest({author:Bt,target:Bt,messageType:DwnInterface.ProtocolsQuery,messageParams:{filter:{protocol:this._recordProtocolDefinition.protocol}}});if(Nt.code!==200)throw new Error(`Failed to query for protocols: ${Nt.code} - ${Nt.detail}`);(jt==null?void 0:jt.length)===0&&(yield this.installProtocol(Bt,xt)),this._protocolInitializedCache.set(Bt,!0)})}getAllRecords(At){return __awaiter$S(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DwnDataStore must implement getAllRecords()")})}getRecord({recordId:At,tenantDid:xt,agent:Bt,useCache:Nt}){var jt;return __awaiter$S(this,void 0,void 0,function*(){if(Nt){const Ht=this._cache.get(At);if(Ht)return Ht}const{reply:Ut}=yield Bt.dwn.processRequest({author:xt,target:xt,messageType:DwnInterface.RecordsRead,messageParams:{filter:{recordId:At}}});if(!(!((jt=Ut.record)===null||jt===void 0)&&jt.data))throw new Error(`${this.name}: Failed to read data from DWN for: ${At}`);const Lt=yield NodeStream.consumeToJson({readable:Ut.record.data});return Nt&&this._cache.set(At,Lt),Lt})}installProtocol(At,xt){return __awaiter$S(this,void 0,void 0,function*(){const{reply:{status:Bt}}=yield xt.dwn.processRequest({author:At,target:At,messageType:DwnInterface.ProtocolsConfigure,messageParams:{definition:this._recordProtocolDefinition}});if(Bt.code!==202)throw new Error(`Failed to install protocol: ${Bt.code} - ${Bt.detail}`)})}lookupRecordId({id:At,tenantDid:xt,agent:Bt}){return __awaiter$S(this,void 0,void 0,function*(){let Nt=this._index.get(`${xt}${TENANT_SEPARATOR}${At}`,{updateAgeOnGet:!0});return Nt||(yield this.getAllRecords({agent:Bt,tenantDid:xt}),Nt=this._index.get(`${xt}${TENANT_SEPARATOR}${At}`)),Nt})}}class InMemoryDataStore{constructor(){this.name="InMemoryDataStore",this.store=new Map}delete({id:At,agent:xt,tenant:Bt}){return __awaiter$S(this,void 0,void 0,function*(){const Nt=yield getDataStoreTenant({agent:xt,tenant:Bt,didUri:At});return this.store.has(`${Nt}${TENANT_SEPARATOR}${At}`)?(this.store.delete(`${Nt}${TENANT_SEPARATOR}${At}`),!0):!1})}get({id:At,agent:xt,tenant:Bt}){return __awaiter$S(this,void 0,void 0,function*(){const Nt=yield getDataStoreTenant({agent:xt,tenant:Bt,didUri:At});return this.store.get(`${Nt}${TENANT_SEPARATOR}${At}`)})}list({agent:At,tenant:xt}){return __awaiter$S(this,void 0,void 0,function*(){const Bt=yield getDataStoreTenant({tenant:xt,agent:At}),Nt=[];for(const[jt,Ut]of this.store.entries())jt.startsWith(`${Bt}${TENANT_SEPARATOR}`)&&Nt.push(Ut);return Nt})}set({id:At,data:xt,tenant:Bt,agent:Nt,preventDuplicates:jt}){return __awaiter$S(this,void 0,void 0,function*(){const Ut=yield getDataStoreTenant({agent:Nt,tenant:Bt,didUri:At});if(jt&&this.store.has(`${Ut}${TENANT_SEPARATOR}${At}`))throw new Error(`${this.name}: Import failed due to duplicate entry for: ${At}`);const Lt=structuredClone(xt);this.store.set(`${Ut}${TENANT_SEPARATOR}${At}`,Lt)})}}var __awaiter$R=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DwnDidStore extends DwnDataStore{constructor(){super(...arguments),this.name="DwnDidStore",this._recordProtocolDefinition=IdentityProtocolDefinition,this._recordProperties={dataFormat:"application/json",protocol:this._recordProtocolDefinition.protocol,protocolPath:"portableDid",schema:this._recordProtocolDefinition.types.portableDid.schema}}delete(At){const xt=Object.create(null,{delete:{get:()=>super.delete}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.delete.call(this,At)})}get(At){const xt=Object.create(null,{get:{get:()=>super.get}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.get.call(this,At)})}list(At){const xt=Object.create(null,{list:{get:()=>super.list}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.list.call(this,At)})}set(At){const xt=Object.create(null,{set:{get:()=>super.set}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.set.call(this,At)})}getAllRecords({agent:At,tenantDid:xt}){var Bt;return __awaiter$R(this,void 0,void 0,function*(){this._index.clear();const{reply:Nt}=yield At.dwn.processRequest({author:xt,target:xt,messageType:DwnInterface.RecordsQuery,messageParams:{filter:Object.assign({},this._recordProperties)}});let jt=[];for(const Ut of(Bt=Nt.entries)!==null&&Bt!==void 0?Bt:[]){if(!Ut.encodedData)throw new Error(`${this.name}: Expected 'encodedData' to be present in the DWN query result entry`);const Lt=Convert$1.base64Url(Ut.encodedData).toObject();if(isPortableDid(Lt)){const Ht=`${xt}${TENANT_SEPARATOR}${Lt.uri}`;this._index.set(Ht,Ut.recordId),this._cache.set(Ut.recordId,Lt),jt.push(Lt)}}return jt})}}class InMemoryDidStore extends InMemoryDataStore{constructor(){super(...arguments),this.name="InMemoryDidStore"}delete(At){const xt=Object.create(null,{delete:{get:()=>super.delete}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.delete.call(this,At)})}get(At){const xt=Object.create(null,{get:{get:()=>super.get}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.get.call(this,At)})}list(At){const xt=Object.create(null,{list:{get:()=>super.list}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.list.call(this,At)})}set(At){const xt=Object.create(null,{set:{get:()=>super.set}});return __awaiter$R(this,void 0,void 0,function*(){return yield xt.set.call(this,At)})}}var __awaiter$Q=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidInterface;(function(kt){kt.Create="Create",kt.Resolve="Resolve"})(DidInterface||(DidInterface={}));function isDidRequest(kt,At){return kt.messageType===At}class AgentDidApi extends UniversalResolver$1{constructor({agent:At,didMethods:xt,resolverCache:Bt,store:Nt}){if(!xt)throw new TypeError("AgentDidApi: Required parameter missing: 'didMethods'");super({didResolvers:xt,cache:Bt??new AgentDidResolverCache({agent:At,location:"DATA/AGENT/DID_CACHE"})}),this._didMethods=new Map,this._agent=At,this._store=Nt??new InMemoryDidStore;for(const jt of xt)this._didMethods.set(jt.methodName,jt)}get agent(){if(this._agent===void 0)throw new Error("AgentDidApi: Unable to determine agent execution context.");return this._agent}set agent(At){this._agent=At,"agent"in this.cache&&(this.cache.agent=At)}create({method:At,tenant:xt,options:Bt,store:Nt}){return __awaiter$Q(this,void 0,void 0,function*(){const Ut=yield this.getMethod(At).create({keyManager:this.agent.keyManager,options:Bt});if(Nt??!0){const{uri:Lt,document:Ht,metadata:Vt}=Ut,zt={uri:Lt,document:Ht,metadata:Vt};yield this._store.set({id:zt.uri,data:zt,agent:this.agent,tenant:xt??zt.uri,preventDuplicates:!1,useCache:!0})}return Ut})}export({didUri:At,tenant:xt}){return __awaiter$Q(this,void 0,void 0,function*(){const Bt=yield this.get({didUri:At,tenant:xt});if(!Bt)throw new Error(`AgentDidApi: Failed to export due to DID not found: ${At}`);return yield Bt.export()})}get({didUri:At,tenant:xt}){return __awaiter$Q(this,void 0,void 0,function*(){const Bt=yield this._store.get({id:At,agent:this.agent,tenant:xt,useCache:!0});return Bt?yield BearerDid$1.import({portableDid:Bt,keyManager:this.agent.keyManager}):void 0})}getSigningMethod({didUri:At,methodId:xt}){return __awaiter$Q(this,void 0,void 0,function*(){const Bt=Did$1.parse(At);if(!Bt)throw new Error(`Invalid DID URI: ${At}`);const Nt=this.getMethod(Bt.method),{didDocument:jt,didResolutionMetadata:Ut}=yield this.resolve(At);if(!jt)throw new Error(`DID resolution failed for '${At}': ${JSON.stringify(Ut)}`);return yield Nt.getSigningMethod({didDocument:jt,methodId:xt})})}import({portableDid:At,tenant:xt}){return __awaiter$Q(this,void 0,void 0,function*(){const Bt=yield BearerDid$1.import({keyManager:this.agent.keyManager,portableDid:At}),{uri:Nt,document:jt,metadata:Ut}=Bt,Lt={uri:Nt,document:jt,metadata:Ut};return yield this._store.set({id:Lt.uri,data:Lt,agent:this.agent,tenant:xt??Lt.uri,preventDuplicates:!0,useCache:!0}),Bt})}delete({didUri:At,tenant:xt,deleteKey:Bt=!0}){return __awaiter$Q(this,void 0,void 0,function*(){const Nt=yield this._store.get({id:At,agent:this.agent,tenant:xt,useCache:!1});if(!Nt)throw new Error("AgentDidApi: Could not delete, DID not found");yield this._store.delete({id:At,agent:this.agent,tenant:xt}),Bt&&(yield this.deleteKeys({portableDid:Nt}))})}deleteKeys({portableDid:At}){return __awaiter$Q(this,void 0,void 0,function*(){for(const xt of At.document.verificationMethod||[]){if(!xt.publicKeyJwk)continue;const Bt=yield this.agent.keyManager.getKeyUri({key:xt.publicKeyJwk});yield this.agent.keyManager.deleteKey({keyUri:Bt})}})}processRequest(At){var xt;return __awaiter$Q(this,void 0,void 0,function*(){if(isDidRequest(At,DidInterface.Create))try{const Bt=yield this.create(Object.assign({},At.messageParams));return{result:{uri:Bt.uri,document:Bt.document,metadata:Bt.metadata},ok:!0,status:{code:201,message:"Created"}}}catch(Bt){return{ok:!1,status:{code:500,message:(xt=Bt.message)!==null&&xt!==void 0?xt:"Unknown error occurred"}}}if(isDidRequest(At,DidInterface.Resolve)){const{didUri:Bt,options:Nt}=At.messageParams;return{result:yield this.resolve(Bt,Nt),ok:!0,status:{code:200,message:"OK"}}}throw new Error(`AgentDidApi: Unsupported request type: ${At.messageType}`)})}getMethod(At){const xt=this._didMethods.get(At);if(xt===void 0)throw new Error(`DID Method not supported: ${At}`);return xt}}var lib={};Object.defineProperty(lib,"__esModule",{value:!0});var ReadableWebToNodeStream_1=lib.ReadableWebToNodeStream=void 0;const readable_stream_1=readableBrowserExports$1;class ReadableWebToNodeStream extends readable_stream_1.Readable{constructor(At){super(),this.bytesRead=0,this.released=!1,this.reader=At.getReader()}async _read(){if(this.released){this.push(null);return}this.pendingRead=this.reader.read();const At=await this.pendingRead;delete this.pendingRead,At.done||this.released?this.push(null):(this.bytesRead+=At.value.length,this.push(At.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}ReadableWebToNodeStream_1=lib.ReadableWebToNodeStream=ReadableWebToNodeStream;var __awaiter$P=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function blobToIsomorphicNodeReadable(kt){return webReadableToIsomorphicNodeReadable(kt.stream())}function getDwnServiceEndpointUrls(kt,At){return __awaiter$P(this,void 0,void 0,function*(){const xt=yield At.dereference(`${kt}#dwn`);if(xt.dereferencingMetadata.error)throw new Error(`Failed to dereference '${kt}#dwn': ${xt.dereferencingMetadata.error}`);if(isDwnDidService(xt.contentStream)){const{serviceEndpoint:Bt}=xt.contentStream,Nt=typeof Bt=="string"?[Bt]:Array.isArray(Bt)&&Bt.every(jt=>typeof jt=="string")?Bt:[];if(Nt.length>0)return Nt}return[]})}function getRecordAuthor(kt){return Message.getAuthor(kt)}function isRecordsWrite(kt){return!kt||typeof kt!="object"||kt===null?!1:"message"in kt&&typeof kt.message=="object"&&kt.message!==null&&"descriptor"in kt.message&&typeof kt.message.descriptor=="object"&&kt.message.descriptor!==null&&"interface"in kt.message.descriptor&&kt.message.descriptor.interface===DwnInterfaceName.Records&&"method"in kt.message.descriptor&&kt.message.descriptor.method===DwnMethodName.Write}function getRecordMessageCid(kt){return Message.getCid(kt)}function getPaginationCursor(kt,At){return __awaiter$P(this,void 0,void 0,function*(){const xt=At===DateSort.CreatedAscending||At===DateSort.CreatedDescending?kt.descriptor.dateCreated:kt.descriptor.datePublished;if(xt===void 0)throw new Error("The dateCreated or datePublished property is missing from the record descriptor.");return{messageCid:yield getRecordMessageCid(kt),value:xt}})}function webReadableToIsomorphicNodeReadable(kt){return new ReadableWebToNodeStream_1(kt)}function pollWithTtl(kt,At=3e3,xt=3e5,Bt){const Nt=Date.now()+xt;let jt=null,Ut=!0;return new Promise((Lt,Ht)=>{function Vt(){return __awaiter$P(this,void 0,void 0,function*(){if(!Ut)return;const zt=Nt-Date.now();if(zt<=0){Ut=!1,console.log("Polling stopped: TTL reached"),Lt(null);return}console.log(`Polling... (Remaining time: ${Math.ceil(zt/1e3)}s)`);try{const Wt=yield kt();if(Wt.ok){Ut=!1,jt!==null&&clearTimeout(jt),console.log("Polling stopped: Success condition met"),Lt(Wt);return}}catch(Wt){console.error("Error fetching data:",Wt),Ht(Wt)}Ut&&(jt=setTimeout(Vt,At))})}Vt()})}function concatenateUrl(kt,At){return kt.endsWith("/")&&(kt=kt.slice(0,-1)),At.startsWith("/")&&(At=At.slice(1)),`${kt}/${At}`}var __awaiter$O=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function isDwnRequest(kt,At){return kt.messageType===At}function isDwnMessage(kt,At){return At.descriptor.interface+At.descriptor.method===kt}function isRecordsType(kt){return kt===DwnInterface.RecordsDelete||kt===DwnInterface.RecordsQuery||kt===DwnInterface.RecordsRead||kt===DwnInterface.RecordsSubscribe||kt===DwnInterface.RecordsWrite}function isRecordPermissionScope(kt){return kt.interface===DwnInterfaceName.Records}class AgentDwnApi{constructor({agent:At,dwn:xt}){this._agent=At,this._dwn=xt}get agent(){if(this._agent===void 0)throw new Error("AgentDwnApi: Unable to determine agent execution context.");return this._agent}set agent(At){this._agent=At}get node(){return this._dwn}static createDwn({dataPath:At,dataStore:xt,didResolver:Bt,eventLog:Nt,eventStream:jt,messageStore:Ut,tenantGate:Lt,resumableTaskStore:Ht}){return __awaiter$O(this,void 0,void 0,function*(){return xt??(xt=new DataStoreLevel({blockstoreLocation:`${At}/DWN_DATASTORE`})),Bt??(Bt=new UniversalResolver$1({didResolvers:[DidDht$1,DidJwk$1],cache:new DidResolverCacheLevel({location:`${At}/DID_RESOLVERCACHE`})})),Nt??(Nt=new EventLogLevel({location:`${At}/DWN_EVENTLOG`})),Ut??(Ut=new MessageStoreLevel({blockstoreLocation:`${At}/DWN_MESSAGESTORE`,indexLocation:`${At}/DWN_MESSAGEINDEX`})),Ht??(Ht=new ResumableTaskStoreLevel({location:`${At}/DWN_RESUMABLETASKSTORE`})),yield Dwn.create({dataStore:xt,didResolver:Bt,eventLog:Nt,eventStream:jt,messageStore:Ut,tenantGate:Lt,resumableTaskStore:Ht})})}processRequest(At){return __awaiter$O(this,void 0,void 0,function*(){const{message:xt,dataStream:Bt}=yield this.constructDwnMessage({request:At}),{subscriptionHandler:Nt}=At;return{reply:At.store!==!1?yield this._dwn.processMessage(At.target,xt,{dataStream:Bt,subscriptionHandler:Nt}):{status:{code:202,detail:"Accepted"}},message:xt,messageCid:yield Message.getCid(xt)}})}sendRequest(At){return __awaiter$O(this,void 0,void 0,function*(){const xt=yield getDwnServiceEndpointUrls(At.target,this.agent.did);if(xt.length===0)throw new Error(`AgentDwnApi: DID Service is missing or malformed: ${At.target}#dwn`);let Bt,Nt,jt,Ut;if("messageCid"in At)({message:Nt,data:jt}=yield this.getDwnMessage({author:At.author,messageCid:At.messageCid,messageType:At.messageType})),Bt=At.messageCid;else{if({message:Nt}=yield this.constructDwnMessage({request:At}),At.dataStream&&!(At.dataStream instanceof Blob))throw new Error("AgentDwnApi: DataStream must be provided as a Blob");jt=At.dataStream,Ut=At.subscriptionHandler}const Lt=yield this.sendDwnRpcRequest({targetDid:At.target,dwnEndpointUrls:xt,message:Nt,data:jt,subscriptionHandler:Ut});return Bt??(Bt=yield Message.getCid(Nt)),{reply:Lt,message:Nt,messageCid:Bt}})}sendDwnRpcRequest({targetDid:At,dwnEndpointUrls:xt,message:Bt,data:Nt,subscriptionHandler:jt}){return __awaiter$O(this,void 0,void 0,function*(){const Ut=[];if(Bt.descriptor.method===DwnMethodName.Subscribe&&jt===void 0)throw new Error("AgentDwnApi: Subscription handler is required for subscription requests.");for(let Lt of xt)try{if(jt!==void 0){if(!(yield this.agent.rpc.getServerInfo(Lt)).webSocketSupport){Ut.push({url:Lt,message:"WebSocket support is not enabled on the server."});continue}const zt=new URL(Lt);zt.protocol=zt.protocol==="http:"?"ws:":"wss:",Lt=zt.toString()}return yield this.agent.rpc.sendDwnRequest({dwnUrl:Lt,targetDid:At,message:Bt,data:Nt,subscriptionHandler:jt})}catch(Ht){Ut.push({url:Lt,message:Ht instanceof Error?Ht.message:"Unknown error"})}throw new Error(`Failed to send DWN RPC request: ${JSON.stringify(Ut)}`)})}constructDwnMessage({request:At}){var xt;return __awaiter$O(this,void 0,void 0,function*(){if(At.granteeDid&&!this.hasGrantParams(At.messageParams))throw new Error("AgentDwnApi: Requested to sign with a permission but no grant messageParams were provided in the request");const Bt=At.rawMessage;let Nt;if(isDwnRequest(At,DwnInterface.RecordsWrite)){const Lt=At.messageParams;if(At.dataStream&&!(Lt!=null&&Lt.data)){const{dataStream:Ht}=At;let Vt;if(Ht instanceof Blob)Vt=blobToIsomorphicNodeReadable(Ht),Nt=blobToIsomorphicNodeReadable(Ht);else if(Ht instanceof ReadableStream){const[zt,Wt]=Ht.tee();Vt=webReadableToIsomorphicNodeReadable(zt),Nt=webReadableToIsomorphicNodeReadable(Wt)}Bt||(Lt.dataCid=yield Cid.computeDagPbCidFromStream(Vt),(xt=Lt.dataSize)!==null&&xt!==void 0||(Lt.dataSize=Vt.bytesRead))}}let jt;const Ut=dwnMessageConstructors[At.messageType];if(Bt){if(jt=yield Ut.parse(Bt),isRecordsWrite(jt)&&At.signAsOwner){const Lt=yield this.getSigner(At.author);yield jt.signAsOwner(Lt)}else if(At.granteeDid&&isRecordsWrite(jt)&&At.signAsOwnerDelegate){const Lt=yield this.getSigner(At.granteeDid),Ht=At.messageParams;yield jt.signAsOwnerDelegate(Lt,Ht.delegatedGrant)}}else{const Lt=At.granteeDid?yield this.getSigner(At.granteeDid):yield this.getSigner(At.author);jt=yield Ut.create(Object.assign(Object.assign({},At.messageParams),{signer:Lt}))}return{message:jt.message,dataStream:Nt}})}hasGrantParams(At){return At!==void 0&&("permissionGrantId"in At&&At.permissionGrantId!==void 0||"delegatedGrant"in At&&At.delegatedGrant!==void 0)}getSigner(At){return __awaiter$O(this,void 0,void 0,function*(){if(At===this.agent.agentDid.uri){const xt=yield this.agent.agentDid.getSigner();return{algorithm:xt.algorithm,keyId:xt.keyId,sign:Bt=>__awaiter$O(this,void 0,void 0,function*(){return yield xt.sign({data:Bt})})}}else try{const xt=yield this.agent.did.getSigningMethod({didUri:At});if(!xt.publicKeyJwk)throw new Error(`Verification method '${xt.id}' does not contain a public key in JWK format`);const Bt=yield this.agent.keyManager.getKeyUri({key:xt.publicKeyJwk}),Nt=yield this.agent.keyManager.getPublicKey({keyUri:Bt}),jt=this.agent.keyManager;return{algorithm:CryptoUtils$1.getJoseSignatureAlgorithmFromPublicKey(Nt),keyId:xt.id,sign:Ut=>__awaiter$O(this,void 0,void 0,function*(){return yield jt.sign({data:Ut,keyUri:Bt})})}}catch(xt){throw new Error(`AgentDwnApi: Unable to get signer for author '${At}': ${xt.message}`)}})}getDwnMessage({author:At,messageCid:xt}){return __awaiter$O(this,void 0,void 0,function*(){const Bt=yield this.getSigner(At),Nt=yield dwnMessageConstructors[DwnInterface.MessagesRead].create({messageCid:xt,signer:Bt}),jt=yield this._dwn.processMessage(At,Nt.message);if(jt.status.code!==200)throw new Error(`AgentDwnApi: Failed to read message, response status: ${jt.status.code} - ${jt.status.detail}`);const Ut=jt.entry;let Ht={message:Ut.message};if(isRecordsWrite(Ut)&&Ut.data){const Vt=yield NodeStream.consumeToBytes({readable:Ut.data});Ht.data=new Blob([Vt],{type:Ut.message.descriptor.dataFormat})}return Ht})}}var __awaiter$N=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DwnRegistrar{static registerTenant(At,xt){return __awaiter$N(this,void 0,void 0,function*(){const Bt=concatenateUrl(At,"registration"),Nt=concatenateUrl(Bt,"terms-of-service"),jt=concatenateUrl(Bt,"proof-of-work"),Ut=yield fetch(Nt,{method:"GET"});if(Ut.status!==200){const tr=Ut.status,rr=Ut.statusText,nr=yield Ut.text();throw new Error(`Failed fetching terms-of-service: ${tr} ${rr}: ${nr}`)}const Lt=yield Ut.text(),Ht=yield fetch(jt,{method:"GET"}),{challengeNonce:Vt,maximumAllowedHashValue:zt}=yield Ht.json(),Wt={did:xt,termsOfServiceHash:yield DwnRegistrar.hashAsHexString(Lt)},Jt=yield DwnRegistrar.findQualifiedResponseNonce({challengeNonce:Vt,maximumAllowedHashValue:zt,requestData:JSON.stringify(Wt)}),Xt=yield fetch(Bt,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registrationData:Wt,proofOfWork:{challengeNonce:Vt,responseNonce:Jt}})});if(Xt.status!==200){const tr=Xt.status,rr=Xt.statusText,nr=yield Xt.text();throw new Error(`Registration failed: ${tr} ${rr}: ${nr}`)}})}static hashAsHexString(At){return __awaiter$N(this,void 0,void 0,function*(){const xt=yield Sha256$1.digest({data:Convert$1.string(At).toUint8Array()});return Convert$1.uint8Array(xt).toHex()})}static findQualifiedResponseNonce(At){return __awaiter$N(this,void 0,void 0,function*(){const xt=Date.now(),{maximumAllowedHashValue:Bt,challengeNonce:Nt,requestData:jt}=At,Ut=BigInt(`0x${Bt}`);let Lt=1,Ht,Vt=!1;do{Ht=yield this.generateNonce();const zt=yield DwnRegistrar.hashAsHexString(Nt+Ht+jt);Vt=BigInt(`0x${zt}`)<=Ut,Lt++}while(!Vt);return console.log(`iterations: ${Lt}, time lapsed: ${Date.now()-xt} ms`),Ht})}static generateNonce(){return __awaiter$N(this,void 0,void 0,function*(){const At=CryptoUtils$1.randomBytes(32);return Convert$1.uint8Array(At).toHex().toUpperCase()})}}const Rho=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id=Uint8Array.from({length:16},(kt,At)=>At),Pi=Id.map(kt=>(9*kt+5)%16);let idxL=[Id],idxR=[Pi];for(let kt=0;kt<4;kt++)for(let At of[idxL,idxR])At.push(At[kt].map(xt=>Rho[xt]));const shifts=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(kt=>new Uint8Array(kt)),shiftsL=idxL.map((kt,At)=>kt.map(xt=>shifts[At][xt])),shiftsR=idxR.map((kt,At)=>kt.map(xt=>shifts[At][xt])),Kl=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Kr=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),rotl=(kt,At)=>kt<<At|kt>>>32-At;function f(kt,At,xt,Bt){return kt===0?At^xt^Bt:kt===1?At&xt|~At&Bt:kt===2?(At|~xt)^Bt:kt===3?At&Bt|xt&~Bt:At^(xt|~Bt)}const BUF=new Uint32Array(16);class RIPEMD160 extends SHA2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:At,h1:xt,h2:Bt,h3:Nt,h4:jt}=this;return[At,xt,Bt,Nt,jt]}set(At,xt,Bt,Nt,jt){this.h0=At|0,this.h1=xt|0,this.h2=Bt|0,this.h3=Nt|0,this.h4=jt|0}process(At,xt){for(let Qt=0;Qt<16;Qt++,xt+=4)BUF[Qt]=At.getUint32(xt,!0);let Bt=this.h0|0,Nt=Bt,jt=this.h1|0,Ut=jt,Lt=this.h2|0,Ht=Lt,Vt=this.h3|0,zt=Vt,Wt=this.h4|0,Jt=Wt;for(let Qt=0;Qt<5;Qt++){const Xt=4-Qt,tr=Kl[Qt],rr=Kr[Qt],nr=idxL[Qt],ar=idxR[Qt],ir=shiftsL[Qt],lr=shiftsR[Qt];for(let yr=0;yr<16;yr++){const Sr=rotl(Bt+f(Qt,jt,Lt,Vt)+BUF[nr[yr]]+tr,ir[yr])+Wt|0;Bt=Wt,Wt=Vt,Vt=rotl(Lt,10)|0,Lt=jt,jt=Sr}for(let yr=0;yr<16;yr++){const Sr=rotl(Nt+f(Xt,Ut,Ht,zt)+BUF[ar[yr]]+rr,lr[yr])+Jt|0;Nt=Jt,Jt=zt,zt=rotl(Ht,10)|0,Ht=Ut,Ut=Sr}}this.set(this.h1+Lt+zt|0,this.h2+Vt+Jt|0,this.h3+Wt+Nt|0,this.h4+Bt+Ut|0,this.h0+jt+Ht|0)}roundClean(){BUF.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const ripemd160=wrapConstructor(()=>new RIPEMD160);/*! micro-ed25519-hdkey - MIT License (c) 2022 Paul Miller (paulmillr.com) */const MASTER_SECRET=utf8ToBytes$2("ed25519 seed"),HARDENED_OFFSET=2147483648,ZERO=new Uint8Array([0]);function ensureBytes$1(kt,...At){return typeof kt=="string"&&(kt=hexToBytes$1(kt)),bytes$1(kt,...At),kt}const hash160=kt=>ripemd160(sha256(kt)),fromU32=kt=>createView(kt).getUint32(0,!1),toU32=kt=>{if(!Number.isSafeInteger(kt)||kt<0||kt>2**32-1)throw new Error(`Invalid number=${kt}. Should be from 0 to 2 ** 32 - 1`);const At=new Uint8Array(4);return createView(At).setUint32(0,kt,!1),At};class HDKey{get publicKeyRaw(){return ed25519.getPublicKey(this.privateKey)}get publicKey(){return concatBytes$1(ZERO,this.publicKeyRaw)}get pubHash(){return hash160(this.publicKey)}get fingerprint(){return fromU32(this.pubHash)}get fingerprintHex(){return bytesToHex$1(toU32(this.fingerprint))}get parentFingerprintHex(){return bytesToHex$1(toU32(this.parentFingerprint))}static fromMasterSeed(At){if(At=ensureBytes$1(At),8*At.length<128||8*At.length>512)throw new Error(`HDKey: wrong seed length=${At.length}. Should be between 128 and 512 bits; 256 bits is advised)`);const xt=hmac(sha512,MASTER_SECRET,At);return new HDKey({privateKey:xt.slice(0,32),chainCode:xt.slice(32)})}constructor(At){if(this.depth=0,this.index=0,this.parentFingerprint=0,!At||typeof At!="object")throw new Error("HDKey.constructor must not be called directly");if(bytes$1(At.privateKey,32),bytes$1(At.chainCode,32),this.depth=At.depth||0,this.index=At.index||0,this.parentFingerprint=At.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");this.chainCode=At.chainCode,this.privateKey=At.privateKey}derive(At,xt=!1){if(!/^[mM]'?/.test(At))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(At))return this;const Bt=At.replace(/^[mM]'?\//,"").split("/");let Nt=this;for(const jt of Bt){const Ut=/^(\d+)('?)$/.exec(jt);if(!Ut||Ut.length!==3)throw new Error(`Invalid child index: ${jt}`);let Lt=+Ut[1];if(!Number.isSafeInteger(Lt)||Lt>=HARDENED_OFFSET)throw new Error("Invalid index");(xt||Ut[2]==="'")&&(Lt+=HARDENED_OFFSET),Nt=Nt.deriveChild(Lt)}return Nt}deriveChild(At){if(At<HARDENED_OFFSET)throw new Error(`Non-hardened child derivation not possible for Ed25519 (index=${At})`);const xt=concatBytes$1(ZERO,this.privateKey,toU32(At)),Bt=hmac(sha512,this.chainCode,xt);return new HDKey({chainCode:Bt.slice(32),depth:this.depth+1,parentFingerprint:this.fingerprint,index:At,privateKey:Bt.slice(0,32)})}sign(At){return ed25519.sign(At,this.privateKey)}verify(At,xt){return xt=ensureBytes$1(xt,64),ed25519.verify(xt,At,this.publicKeyRaw)}}const wordlist=`abandon
ability
able
about
above
absent
absorb
abstract
absurd
abuse
access
accident
account
accuse
achieve
acid
acoustic
acquire
across
act
action
actor
actress
actual
adapt
add
addict
address
adjust
admit
adult
advance
advice
aerobic
affair
afford
afraid
again
age
agent
agree
ahead
aim
air
airport
aisle
alarm
album
alcohol
alert
alien
all
alley
allow
almost
alone
alpha
already
also
alter
always
amateur
amazing
among
amount
amused
analyst
anchor
ancient
anger
angle
angry
animal
ankle
announce
annual
another
answer
antenna
antique
anxiety
any
apart
apology
appear
apple
approve
april
arch
arctic
area
arena
argue
arm
armed
armor
army
around
arrange
arrest
arrive
arrow
art
artefact
artist
artwork
ask
aspect
assault
asset
assist
assume
asthma
athlete
atom
attack
attend
attitude
attract
auction
audit
august
aunt
author
auto
autumn
average
avocado
avoid
awake
aware
away
awesome
awful
awkward
axis
baby
bachelor
bacon
badge
bag
balance
balcony
ball
bamboo
banana
banner
bar
barely
bargain
barrel
base
basic
basket
battle
beach
bean
beauty
because
become
beef
before
begin
behave
behind
believe
below
belt
bench
benefit
best
betray
better
between
beyond
bicycle
bid
bike
bind
biology
bird
birth
bitter
black
blade
blame
blanket
blast
bleak
bless
blind
blood
blossom
blouse
blue
blur
blush
board
boat
body
boil
bomb
bone
bonus
book
boost
border
boring
borrow
boss
bottom
bounce
box
boy
bracket
brain
brand
brass
brave
bread
breeze
brick
bridge
brief
bright
bring
brisk
broccoli
broken
bronze
broom
brother
brown
brush
bubble
buddy
budget
buffalo
build
bulb
bulk
bullet
bundle
bunker
burden
burger
burst
bus
business
busy
butter
buyer
buzz
cabbage
cabin
cable
cactus
cage
cake
call
calm
camera
camp
can
canal
cancel
candy
cannon
canoe
canvas
canyon
capable
capital
captain
car
carbon
card
cargo
carpet
carry
cart
case
cash
casino
castle
casual
cat
catalog
catch
category
cattle
caught
cause
caution
cave
ceiling
celery
cement
census
century
cereal
certain
chair
chalk
champion
change
chaos
chapter
charge
chase
chat
cheap
check
cheese
chef
cherry
chest
chicken
chief
child
chimney
choice
choose
chronic
chuckle
chunk
churn
cigar
cinnamon
circle
citizen
city
civil
claim
clap
clarify
claw
clay
clean
clerk
clever
click
client
cliff
climb
clinic
clip
clock
clog
close
cloth
cloud
clown
club
clump
cluster
clutch
coach
coast
coconut
code
coffee
coil
coin
collect
color
column
combine
come
comfort
comic
common
company
concert
conduct
confirm
congress
connect
consider
control
convince
cook
cool
copper
copy
coral
core
corn
correct
cost
cotton
couch
country
couple
course
cousin
cover
coyote
crack
cradle
craft
cram
crane
crash
crater
crawl
crazy
cream
credit
creek
crew
cricket
crime
crisp
critic
crop
cross
crouch
crowd
crucial
cruel
cruise
crumble
crunch
crush
cry
crystal
cube
culture
cup
cupboard
curious
current
curtain
curve
cushion
custom
cute
cycle
dad
damage
damp
dance
danger
daring
dash
daughter
dawn
day
deal
debate
debris
decade
december
decide
decline
decorate
decrease
deer
defense
define
defy
degree
delay
deliver
demand
demise
denial
dentist
deny
depart
depend
deposit
depth
deputy
derive
describe
desert
design
desk
despair
destroy
detail
detect
develop
device
devote
diagram
dial
diamond
diary
dice
diesel
diet
differ
digital
dignity
dilemma
dinner
dinosaur
direct
dirt
disagree
discover
disease
dish
dismiss
disorder
display
distance
divert
divide
divorce
dizzy
doctor
document
dog
doll
dolphin
domain
donate
donkey
donor
door
dose
double
dove
draft
dragon
drama
drastic
draw
dream
dress
drift
drill
drink
drip
drive
drop
drum
dry
duck
dumb
dune
during
dust
dutch
duty
dwarf
dynamic
eager
eagle
early
earn
earth
easily
east
easy
echo
ecology
economy
edge
edit
educate
effort
egg
eight
either
elbow
elder
electric
elegant
element
elephant
elevator
elite
else
embark
embody
embrace
emerge
emotion
employ
empower
empty
enable
enact
end
endless
endorse
enemy
energy
enforce
engage
engine
enhance
enjoy
enlist
enough
enrich
enroll
ensure
enter
entire
entry
envelope
episode
equal
equip
era
erase
erode
erosion
error
erupt
escape
essay
essence
estate
eternal
ethics
evidence
evil
evoke
evolve
exact
example
excess
exchange
excite
exclude
excuse
execute
exercise
exhaust
exhibit
exile
exist
exit
exotic
expand
expect
expire
explain
expose
express
extend
extra
eye
eyebrow
fabric
face
faculty
fade
faint
faith
fall
false
fame
family
famous
fan
fancy
fantasy
farm
fashion
fat
fatal
father
fatigue
fault
favorite
feature
february
federal
fee
feed
feel
female
fence
festival
fetch
fever
few
fiber
fiction
field
figure
file
film
filter
final
find
fine
finger
finish
fire
firm
first
fiscal
fish
fit
fitness
fix
flag
flame
flash
flat
flavor
flee
flight
flip
float
flock
floor
flower
fluid
flush
fly
foam
focus
fog
foil
fold
follow
food
foot
force
forest
forget
fork
fortune
forum
forward
fossil
foster
found
fox
fragile
frame
frequent
fresh
friend
fringe
frog
front
frost
frown
frozen
fruit
fuel
fun
funny
furnace
fury
future
gadget
gain
galaxy
gallery
game
gap
garage
garbage
garden
garlic
garment
gas
gasp
gate
gather
gauge
gaze
general
genius
genre
gentle
genuine
gesture
ghost
giant
gift
giggle
ginger
giraffe
girl
give
glad
glance
glare
glass
glide
glimpse
globe
gloom
glory
glove
glow
glue
goat
goddess
gold
good
goose
gorilla
gospel
gossip
govern
gown
grab
grace
grain
grant
grape
grass
gravity
great
green
grid
grief
grit
grocery
group
grow
grunt
guard
guess
guide
guilt
guitar
gun
gym
habit
hair
half
hammer
hamster
hand
happy
harbor
hard
harsh
harvest
hat
have
hawk
hazard
head
health
heart
heavy
hedgehog
height
hello
helmet
help
hen
hero
hidden
high
hill
hint
hip
hire
history
hobby
hockey
hold
hole
holiday
hollow
home
honey
hood
hope
horn
horror
horse
hospital
host
hotel
hour
hover
hub
huge
human
humble
humor
hundred
hungry
hunt
hurdle
hurry
hurt
husband
hybrid
ice
icon
idea
identify
idle
ignore
ill
illegal
illness
image
imitate
immense
immune
impact
impose
improve
impulse
inch
include
income
increase
index
indicate
indoor
industry
infant
inflict
inform
inhale
inherit
initial
inject
injury
inmate
inner
innocent
input
inquiry
insane
insect
inside
inspire
install
intact
interest
into
invest
invite
involve
iron
island
isolate
issue
item
ivory
jacket
jaguar
jar
jazz
jealous
jeans
jelly
jewel
job
join
joke
journey
joy
judge
juice
jump
jungle
junior
junk
just
kangaroo
keen
keep
ketchup
key
kick
kid
kidney
kind
kingdom
kiss
kit
kitchen
kite
kitten
kiwi
knee
knife
knock
know
lab
label
labor
ladder
lady
lake
lamp
language
laptop
large
later
latin
laugh
laundry
lava
law
lawn
lawsuit
layer
lazy
leader
leaf
learn
leave
lecture
left
leg
legal
legend
leisure
lemon
lend
length
lens
leopard
lesson
letter
level
liar
liberty
library
license
life
lift
light
like
limb
limit
link
lion
liquid
list
little
live
lizard
load
loan
lobster
local
lock
logic
lonely
long
loop
lottery
loud
lounge
love
loyal
lucky
luggage
lumber
lunar
lunch
luxury
lyrics
machine
mad
magic
magnet
maid
mail
main
major
make
mammal
man
manage
mandate
mango
mansion
manual
maple
marble
march
margin
marine
market
marriage
mask
mass
master
match
material
math
matrix
matter
maximum
maze
meadow
mean
measure
meat
mechanic
medal
media
melody
melt
member
memory
mention
menu
mercy
merge
merit
merry
mesh
message
metal
method
middle
midnight
milk
million
mimic
mind
minimum
minor
minute
miracle
mirror
misery
miss
mistake
mix
mixed
mixture
mobile
model
modify
mom
moment
monitor
monkey
monster
month
moon
moral
more
morning
mosquito
mother
motion
motor
mountain
mouse
move
movie
much
muffin
mule
multiply
muscle
museum
mushroom
music
must
mutual
myself
mystery
myth
naive
name
napkin
narrow
nasty
nation
nature
near
neck
need
negative
neglect
neither
nephew
nerve
nest
net
network
neutral
never
news
next
nice
night
noble
noise
nominee
noodle
normal
north
nose
notable
note
nothing
notice
novel
now
nuclear
number
nurse
nut
oak
obey
object
oblige
obscure
observe
obtain
obvious
occur
ocean
october
odor
off
offer
office
often
oil
okay
old
olive
olympic
omit
once
one
onion
online
only
open
opera
opinion
oppose
option
orange
orbit
orchard
order
ordinary
organ
orient
original
orphan
ostrich
other
outdoor
outer
output
outside
oval
oven
over
own
owner
oxygen
oyster
ozone
pact
paddle
page
pair
palace
palm
panda
panel
panic
panther
paper
parade
parent
park
parrot
party
pass
patch
path
patient
patrol
pattern
pause
pave
payment
peace
peanut
pear
peasant
pelican
pen
penalty
pencil
people
pepper
perfect
permit
person
pet
phone
photo
phrase
physical
piano
picnic
picture
piece
pig
pigeon
pill
pilot
pink
pioneer
pipe
pistol
pitch
pizza
place
planet
plastic
plate
play
please
pledge
pluck
plug
plunge
poem
poet
point
polar
pole
police
pond
pony
pool
popular
portion
position
possible
post
potato
pottery
poverty
powder
power
practice
praise
predict
prefer
prepare
present
pretty
prevent
price
pride
primary
print
priority
prison
private
prize
problem
process
produce
profit
program
project
promote
proof
property
prosper
protect
proud
provide
public
pudding
pull
pulp
pulse
pumpkin
punch
pupil
puppy
purchase
purity
purpose
purse
push
put
puzzle
pyramid
quality
quantum
quarter
question
quick
quit
quiz
quote
rabbit
raccoon
race
rack
radar
radio
rail
rain
raise
rally
ramp
ranch
random
range
rapid
rare
rate
rather
raven
raw
razor
ready
real
reason
rebel
rebuild
recall
receive
recipe
record
recycle
reduce
reflect
reform
refuse
region
regret
regular
reject
relax
release
relief
rely
remain
remember
remind
remove
render
renew
rent
reopen
repair
repeat
replace
report
require
rescue
resemble
resist
resource
response
result
retire
retreat
return
reunion
reveal
review
reward
rhythm
rib
ribbon
rice
rich
ride
ridge
rifle
right
rigid
ring
riot
ripple
risk
ritual
rival
river
road
roast
robot
robust
rocket
romance
roof
rookie
room
rose
rotate
rough
round
route
royal
rubber
rude
rug
rule
run
runway
rural
sad
saddle
sadness
safe
sail
salad
salmon
salon
salt
salute
same
sample
sand
satisfy
satoshi
sauce
sausage
save
say
scale
scan
scare
scatter
scene
scheme
school
science
scissors
scorpion
scout
scrap
screen
script
scrub
sea
search
season
seat
second
secret
section
security
seed
seek
segment
select
sell
seminar
senior
sense
sentence
series
service
session
settle
setup
seven
shadow
shaft
shallow
share
shed
shell
sheriff
shield
shift
shine
ship
shiver
shock
shoe
shoot
shop
short
shoulder
shove
shrimp
shrug
shuffle
shy
sibling
sick
side
siege
sight
sign
silent
silk
silly
silver
similar
simple
since
sing
siren
sister
situate
six
size
skate
sketch
ski
skill
skin
skirt
skull
slab
slam
sleep
slender
slice
slide
slight
slim
slogan
slot
slow
slush
small
smart
smile
smoke
smooth
snack
snake
snap
sniff
snow
soap
soccer
social
sock
soda
soft
solar
soldier
solid
solution
solve
someone
song
soon
sorry
sort
soul
sound
soup
source
south
space
spare
spatial
spawn
speak
special
speed
spell
spend
sphere
spice
spider
spike
spin
spirit
split
spoil
sponsor
spoon
sport
spot
spray
spread
spring
spy
square
squeeze
squirrel
stable
stadium
staff
stage
stairs
stamp
stand
start
state
stay
steak
steel
stem
step
stereo
stick
still
sting
stock
stomach
stone
stool
story
stove
strategy
street
strike
strong
struggle
student
stuff
stumble
style
subject
submit
subway
success
such
sudden
suffer
sugar
suggest
suit
summer
sun
sunny
sunset
super
supply
supreme
sure
surface
surge
surprise
surround
survey
suspect
sustain
swallow
swamp
swap
swarm
swear
sweet
swift
swim
swing
switch
sword
symbol
symptom
syrup
system
table
tackle
tag
tail
talent
talk
tank
tape
target
task
taste
tattoo
taxi
teach
team
tell
ten
tenant
tennis
tent
term
test
text
thank
that
theme
then
theory
there
they
thing
this
thought
three
thrive
throw
thumb
thunder
ticket
tide
tiger
tilt
timber
time
tiny
tip
tired
tissue
title
toast
tobacco
today
toddler
toe
together
toilet
token
tomato
tomorrow
tone
tongue
tonight
tool
tooth
top
topic
topple
torch
tornado
tortoise
toss
total
tourist
toward
tower
town
toy
track
trade
traffic
tragic
train
transfer
trap
trash
travel
tray
treat
tree
trend
trial
tribe
trick
trigger
trim
trip
trophy
trouble
truck
true
truly
trumpet
trust
truth
try
tube
tuition
tumble
tuna
tunnel
turkey
turn
turtle
twelve
twenty
twice
twin
twist
two
type
typical
ugly
umbrella
unable
unaware
uncle
uncover
under
undo
unfair
unfold
unhappy
uniform
unique
unit
universe
unknown
unlock
until
unusual
unveil
update
upgrade
uphold
upon
upper
upset
urban
urge
usage
use
used
useful
useless
usual
utility
vacant
vacuum
vague
valid
valley
valve
van
vanish
vapor
various
vast
vault
vehicle
velvet
vendor
venture
venue
verb
verify
version
very
vessel
veteran
viable
vibrant
vicious
victory
video
view
village
vintage
violin
virtual
virus
visa
visit
visual
vital
vivid
vocal
voice
void
volcano
volume
vote
voyage
wage
wagon
wait
walk
wall
walnut
want
warfare
warm
warrior
wash
wasp
waste
water
wave
way
wealth
weapon
wear
weasel
weather
web
wedding
weekend
weird
welcome
west
wet
whale
what
wheat
wheel
when
where
whip
whisper
wide
width
wife
wild
will
win
window
wine
wing
wink
winner
winter
wire
wisdom
wise
wish
witness
wolf
woman
wonder
wood
wool
word
work
world
worry
worth
wrap
wreck
wrestle
wrist
write
wrong
yard
year
yellow
you
young
youth
zebra
zero
zone
zoo`.split(`
`);function pbkdf2Init(kt,At,xt,Bt){hash(kt);const Nt=checkOpts({dkLen:32,asyncTick:10},Bt),{c:jt,dkLen:Ut,asyncTick:Lt}=Nt;if(number(jt),number(Ut),number(Lt),jt<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const Ht=toBytes$1(At),Vt=toBytes$1(xt),zt=new Uint8Array(Ut),Wt=hmac.create(kt,Ht),Jt=Wt._cloneInto().update(Vt);return{c:jt,dkLen:Ut,asyncTick:Lt,DK:zt,PRF:Wt,PRFSalt:Jt}}function pbkdf2Output(kt,At,xt,Bt,Nt){return kt.destroy(),At.destroy(),Bt&&Bt.destroy(),Nt.fill(0),xt}async function pbkdf2Async(kt,At,xt,Bt){const{c:Nt,dkLen:jt,asyncTick:Ut,DK:Lt,PRF:Ht,PRFSalt:Vt}=pbkdf2Init(kt,At,xt,Bt);let zt;const Wt=new Uint8Array(4),Jt=createView(Wt),Qt=new Uint8Array(Ht.outputLen);for(let Xt=1,tr=0;tr<jt;Xt++,tr+=Ht.outputLen){const rr=Lt.subarray(tr,tr+Ht.outputLen);Jt.setInt32(0,Xt,!1),(zt=Vt._cloneInto(zt)).update(Wt).digestInto(Qt),rr.set(Qt.subarray(0,rr.length)),await asyncLoop(Nt-1,Ut,()=>{Ht._cloneInto(zt).update(Qt).digestInto(Qt);for(let nr=0;nr<rr.length;nr++)rr[nr]^=Qt[nr]})}return pbkdf2Output(Ht,Vt,Lt,zt,Qt)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$2(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}function chain(...kt){const At=jt=>jt,xt=(jt,Ut)=>Lt=>jt(Ut(Lt)),Bt=kt.map(jt=>jt.encode).reduceRight(xt,At),Nt=kt.map(jt=>jt.decode).reduce(xt,At);return{encode:Bt,decode:Nt}}function alphabet(kt){return{encode:At=>{if(!Array.isArray(At)||At.length&&typeof At[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return At.map(xt=>{if(xt<0||xt>=kt.length)throw new Error(`Digit index outside alphabet: ${xt} (alphabet: ${kt.length})`);return kt[xt]})},decode:At=>{if(!Array.isArray(At)||At.length&&typeof At[0]!="string")throw new Error("alphabet.decode input should be array of strings");return At.map(xt=>{if(typeof xt!="string")throw new Error(`alphabet.decode: not string element=${xt}`);const Bt=kt.indexOf(xt);if(Bt===-1)throw new Error(`Unknown letter: "${xt}". Allowed: ${kt}`);return Bt})}}}function join(kt=""){if(typeof kt!="string")throw new Error("join separator should be string");return{encode:At=>{if(!Array.isArray(At)||At.length&&typeof At[0]!="string")throw new Error("join.encode input should be array of strings");for(let xt of At)if(typeof xt!="string")throw new Error(`join.encode: non-string input=${xt}`);return At.join(kt)},decode:At=>{if(typeof At!="string")throw new Error("join.decode input should be string");return At.split(kt)}}}function padding(kt,At="="){if(typeof At!="string")throw new Error("padding chr should be string");return{encode(xt){if(!Array.isArray(xt)||xt.length&&typeof xt[0]!="string")throw new Error("padding.encode input should be array of strings");for(let Bt of xt)if(typeof Bt!="string")throw new Error(`padding.encode: non-string input=${Bt}`);for(;xt.length*kt%8;)xt.push(At);return xt},decode(xt){if(!Array.isArray(xt)||xt.length&&typeof xt[0]!="string")throw new Error("padding.encode input should be array of strings");for(let Nt of xt)if(typeof Nt!="string")throw new Error(`padding.decode: non-string input=${Nt}`);let Bt=xt.length;if(Bt*kt%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;Bt>0&&xt[Bt-1]===At;Bt--)if(!((Bt-1)*kt%8))throw new Error("Invalid padding: string has too much padding");return xt.slice(0,Bt)}}}function convertRadix(kt,At,xt){if(At<2)throw new Error(`convertRadix: wrong from=${At}, base cannot be less than 2`);if(xt<2)throw new Error(`convertRadix: wrong to=${xt}, base cannot be less than 2`);if(!Array.isArray(kt))throw new Error("convertRadix: data should be array");if(!kt.length)return[];let Bt=0;const Nt=[],jt=Array.from(kt);for(jt.forEach(Ut=>{if(Ut<0||Ut>=At)throw new Error(`Wrong integer: ${Ut}`)});;){let Ut=0,Lt=!0;for(let Ht=Bt;Ht<jt.length;Ht++){const Vt=jt[Ht],zt=At*Ut+Vt;if(!Number.isSafeInteger(zt)||At*Ut/At!==Ut||zt-Vt!==At*Ut)throw new Error("convertRadix: carry overflow");Ut=zt%xt;const Wt=Math.floor(zt/xt);if(jt[Ht]=Wt,!Number.isSafeInteger(Wt)||Wt*xt+Ut!==zt)throw new Error("convertRadix: carry overflow");if(Lt)Wt?Lt=!1:Bt=Ht;else continue}if(Nt.push(Ut),Lt)break}for(let Ut=0;Ut<kt.length-1&&kt[Ut]===0;Ut++)Nt.push(0);return Nt.reverse()}const gcd=(kt,At)=>At?gcd(At,kt%At):kt,radix2carry=(kt,At)=>kt+(At-gcd(kt,At));function convertRadix2(kt,At,xt,Bt){if(!Array.isArray(kt))throw new Error("convertRadix2: data should be array");if(At<=0||At>32)throw new Error(`convertRadix2: wrong from=${At}`);if(xt<=0||xt>32)throw new Error(`convertRadix2: wrong to=${xt}`);if(radix2carry(At,xt)>32)throw new Error(`convertRadix2: carry overflow from=${At} to=${xt} carryBits=${radix2carry(At,xt)}`);let Nt=0,jt=0;const Ut=2**xt-1,Lt=[];for(const Ht of kt){if(Ht>=2**At)throw new Error(`convertRadix2: invalid data word=${Ht} from=${At}`);if(Nt=Nt<<At|Ht,jt+At>32)throw new Error(`convertRadix2: carry overflow pos=${jt} from=${At}`);for(jt+=At;jt>=xt;jt-=xt)Lt.push((Nt>>jt-xt&Ut)>>>0);Nt&=2**jt-1}if(Nt=Nt<<xt-jt&Ut,!Bt&&jt>=At)throw new Error("Excess padding");if(!Bt&&Nt)throw new Error(`Non-zero padding: ${Nt}`);return Bt&&jt>0&&Lt.push(Nt>>>0),Lt}function radix(kt){return{encode:At=>{if(!isBytes$2(At))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(At),2**8,kt)},decode:At=>{if(!Array.isArray(At)||At.length&&typeof At[0]!="number")throw new Error("radix.decode input should be array of numbers");return Uint8Array.from(convertRadix(At,kt,2**8))}}}function radix2(kt,At=!1){if(kt<=0||kt>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,kt)>32||radix2carry(kt,8)>32)throw new Error("radix2: carry overflow");return{encode:xt=>{if(!isBytes$2(xt))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(xt),8,kt,!At)},decode:xt=>{if(!Array.isArray(xt)||xt.length&&typeof xt[0]!="number")throw new Error("radix2.decode input should be array of numbers");return Uint8Array.from(convertRadix2(xt,kt,8,At))}}}function checksum(kt,At){if(typeof At!="function")throw new Error("checksum fn should be function");return{encode(xt){if(!isBytes$2(xt))throw new Error("checksum.encode: input should be Uint8Array");const Bt=At(xt).slice(0,kt),Nt=new Uint8Array(xt.length+kt);return Nt.set(xt),Nt.set(Bt,xt.length),Nt},decode(xt){if(!isBytes$2(xt))throw new Error("checksum.decode: input should be Uint8Array");const Bt=xt.slice(0,-kt),Nt=At(Bt).slice(0,kt),jt=xt.slice(-kt);for(let Ut=0;Ut<kt;Ut++)if(Nt[Ut]!==jt[Ut])throw new Error("Invalid checksum");return Bt}}}const utils={alphabet,chain,checksum,convertRadix,convertRadix2,radix,radix2,join,padding};/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const isJapanese=kt=>kt[0]==="";function nfkd(kt){if(typeof kt!="string")throw new TypeError(`Invalid mnemonic type: ${typeof kt}`);return kt.normalize("NFKD")}function normalize(kt){const At=nfkd(kt),xt=At.split(" ");if(![12,15,18,21,24].includes(xt.length))throw new Error("Invalid mnemonic");return{nfkd:At,words:xt}}function assertEntropy(kt){bytes$1(kt,16,20,24,28,32)}function generateMnemonic(kt,At=128){if(number(At),At%32!==0||At>256)throw new TypeError("Invalid entropy");return entropyToMnemonic(randomBytes$2(At/8),kt)}const calcChecksum=kt=>{const At=8-kt.length/4;return new Uint8Array([sha256(kt)[0]>>At<<At])};function getCoder(kt){if(!Array.isArray(kt)||kt.length!==2048||typeof kt[0]!="string")throw new Error("Wordlist: expected array of 2048 strings");return kt.forEach(At=>{if(typeof At!="string")throw new Error(`Wordlist: non-string element: ${At}`)}),utils.chain(utils.checksum(1,calcChecksum),utils.radix2(11,!0),utils.alphabet(kt))}function mnemonicToEntropy(kt,At){const{words:xt}=normalize(kt),Bt=getCoder(At).decode(xt);return assertEntropy(Bt),Bt}function entropyToMnemonic(kt,At){return assertEntropy(kt),getCoder(At).encode(kt).join(isJapanese(At)?"":" ")}function validateMnemonic(kt,At){try{mnemonicToEntropy(kt,At)}catch{return!1}return!0}const salt=kt=>nfkd(`mnemonic${kt}`);function mnemonicToSeed(kt,At=""){return pbkdf2Async(sha512,normalize(kt).nfkd,salt(At),{c:2048,dkLen:64})}var __awaiter$M=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DwnKeyStore extends DwnDataStore{constructor(){super(...arguments),this.name="DwnKeyStore",this._recordProtocolDefinition=JwkProtocolDefinition,this._recordProperties={dataFormat:"application/json",protocol:this._recordProtocolDefinition.protocol,protocolPath:"privateJwk",schema:this._recordProtocolDefinition.types.privateJwk.schema}}delete(At){const xt=Object.create(null,{delete:{get:()=>super.delete}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.delete.call(this,At)})}get(At){const xt=Object.create(null,{get:{get:()=>super.get}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.get.call(this,At)})}set(At){const xt=Object.create(null,{set:{get:()=>super.set}});return __awaiter$M(this,void 0,void 0,function*(){yield xt.set.call(this,At)})}list(At){const xt=Object.create(null,{list:{get:()=>super.list}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.list.call(this,At)})}getAllRecords({agent:At,tenantDid:xt}){var Bt;return __awaiter$M(this,void 0,void 0,function*(){this._index.clear();const{reply:Nt}=yield At.dwn.processRequest({author:xt,target:xt,messageType:DwnInterface.RecordsQuery,messageParams:{filter:Object.assign({},this._recordProperties)}});let jt=[];for(const Ut of(Bt=Nt.entries)!==null&&Bt!==void 0?Bt:[]){if(!Ut.encodedData)throw new Error(`${this.name}: Expected 'encodedData' to be present in the DWN query result entry`);const Lt=Convert$1.base64Url(Ut.encodedData).toObject();if(isPrivateJwk$1(Lt)){const Ht=`${xt}${TENANT_SEPARATOR}${KEY_URI_PREFIX_JWK$1}${Lt.kid}`;this._index.set(Ht,Ut.recordId),this._cache.set(Ut.recordId,Lt),jt.push(Lt)}}return jt})}}class InMemoryKeyStore extends InMemoryDataStore{constructor(){super(...arguments),this.name="InMemoryKeyStore"}delete(At){const xt=Object.create(null,{delete:{get:()=>super.delete}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.delete.call(this,At)})}get(At){const xt=Object.create(null,{get:{get:()=>super.get}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.get.call(this,At)})}list(At){const xt=Object.create(null,{list:{get:()=>super.list}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.list.call(this,At)})}set(At){const xt=Object.create(null,{set:{get:()=>super.set}});return __awaiter$M(this,void 0,void 0,function*(){return yield xt.set.call(this,At)})}}var __awaiter$L=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$e=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const supportedAlgorithms$1={"AES-GCM":{implementation:AesGcmAlgorithm$1,names:["A128GCM","A192GCM","A256GCM"]},"AES-KW":{implementation:AesKwAlgorithm,names:["A128KW","A192KW","A256KW"]},Ed25519:{implementation:EdDsaAlgorithm$2,names:["Ed25519"]},secp256k1:{implementation:EcdsaAlgorithm$2,names:["ES256K","secp256k1"]},secp256r1:{implementation:EcdsaAlgorithm$2,names:["ES256","secp256r1"]},"SHA-256":{implementation:Sha2Algorithm$1,names:["SHA-256"]}};let LocalKeyManager$1=class{constructor({agent:At,keyStore:xt}={}){this._algorithmInstances=new Map,this._agent=At,this._keyStore=xt??new InMemoryKeyStore}get agent(){if(this._agent===void 0)throw new Error("LocalKeyManager: Unable to determine agent execution context.");return this._agent}set agent(At){this._agent=At}decrypt(At){var{keyUri:xt}=At,Bt=__rest$e(At,["keyUri"]);return __awaiter$L(this,void 0,void 0,function*(){const Nt=yield this.getPrivateKey({keyUri:xt}),jt=this.getAlgorithmName({key:Nt});return yield this.getAlgorithm({algorithm:jt}).decrypt(Object.assign({key:Nt},Bt))})}digest(At){throw new Error("Method not implemented.")}encrypt(At){var{keyUri:xt}=At,Bt=__rest$e(At,["keyUri"]);return __awaiter$L(this,void 0,void 0,function*(){const Nt=yield this.getPrivateKey({keyUri:xt}),jt=this.getAlgorithmName({key:Nt});return yield this.getAlgorithm({algorithm:jt}).encrypt(Object.assign({key:Nt},Bt))})}exportKey({keyUri:At}){return __awaiter$L(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:At})})}generateKey({algorithm:At}){var xt;return __awaiter$L(this,void 0,void 0,function*(){const Bt=this.getAlgorithmName({key:{alg:At}}),jt=yield this.getAlgorithm({algorithm:Bt}).generateKey({algorithm:At});(xt=jt.kid)!==null&&xt!==void 0||(jt.kid=yield computeJwkThumbprint$1({jwk:jt}));const Ut=yield this.getKeyUri({key:jt});return yield this._keyStore.set({id:Ut,data:jt,agent:this.agent,preventDuplicates:!1,useCache:!0}),Ut})}getKeyUri({key:At}){return __awaiter$L(this,void 0,void 0,function*(){const xt=yield computeJwkThumbprint$1({jwk:At});return`${KEY_URI_PREFIX_JWK$1}${xt}`})}getPublicKey({keyUri:At}){return __awaiter$L(this,void 0,void 0,function*(){const xt=yield this.getPrivateKey({keyUri:At}),Bt=this.getAlgorithmName({key:xt});return yield this.getAlgorithm({algorithm:Bt}).getPublicKey({key:xt})})}importKey({key:At}){var xt;return __awaiter$L(this,void 0,void 0,function*(){if(!isPrivateJwk$1(At))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const Bt=structuredClone(At);(xt=Bt.kid)!==null&&xt!==void 0||(Bt.kid=yield computeJwkThumbprint$1({jwk:Bt}));const Nt=yield this.getKeyUri({key:Bt});return yield this._keyStore.set({id:Nt,data:Bt,agent:this.agent,preventDuplicates:!0,useCache:!0}),Nt})}sign({keyUri:At,data:xt}){return __awaiter$L(this,void 0,void 0,function*(){const Bt=yield this.getPrivateKey({keyUri:At}),Nt=this.getAlgorithmName({key:Bt});return this.getAlgorithm({algorithm:Nt}).sign({data:xt,key:Bt})})}unwrapKey({wrappedKeyBytes:At,wrappedKeyAlgorithm:xt,decryptionKeyUri:Bt}){return __awaiter$L(this,void 0,void 0,function*(){const Nt=yield this.getPrivateKey({keyUri:Bt}),jt=this.getAlgorithmName({key:Nt});return yield this.getAlgorithm({algorithm:jt}).unwrapKey({wrappedKeyBytes:At,wrappedKeyAlgorithm:xt,decryptionKey:Nt})})}verify({key:At,signature:xt,data:Bt}){return __awaiter$L(this,void 0,void 0,function*(){const Nt=this.getAlgorithmName({key:At});return this.getAlgorithm({algorithm:Nt}).verify({key:At,signature:xt,data:Bt})})}wrapKey({unwrappedKey:At,encryptionKeyUri:xt}){return __awaiter$L(this,void 0,void 0,function*(){const Bt=yield this.getPrivateKey({keyUri:xt}),Nt=this.getAlgorithmName({key:Bt});return yield this.getAlgorithm({algorithm:Nt}).wrapKey({unwrappedKey:At,encryptionKey:Bt})})}deleteKey({keyUri:At}){return __awaiter$L(this,void 0,void 0,function*(){if(!(yield this._keyStore.get({id:At,agent:this.agent,useCache:!0})))throw new Error(`Key not found: ${At}`);yield this._keyStore.delete({id:At,agent:this.agent})})}getAlgorithm({algorithm:At}){var xt;const Bt=(xt=supportedAlgorithms$1[At])===null||xt===void 0?void 0:xt.implementation;if(!Bt)throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported: ${At}`);return this._algorithmInstances.has(Bt)||this._algorithmInstances.set(Bt,new Bt),this._algorithmInstances.get(Bt)}getAlgorithmName({key:At}){const xt=At.alg,Bt=At.crv;for(const Nt of Object.keys(supportedAlgorithms$1)){const jt=supportedAlgorithms$1[Nt].names;if(xt&&jt.includes(xt))return Nt;if(Bt&&jt.includes(Bt))return Nt}throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Algorithm not supported based on provided input: alg=${xt}, crv=${Bt}. Please check the documentation for the list of supported algorithms.`)}getPrivateKey({keyUri:At}){return __awaiter$L(this,void 0,void 0,function*(){const xt=yield this._keyStore.get({id:At,agent:this.agent,useCache:!0});if(!xt)throw new Error(`Key not found: ${At}`);return xt})}};var __awaiter$K=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function isValidJweHeader(kt){return typeof kt=="object"&&kt!==null&&"alg"in kt&&kt.alg!==void 0&&"enc"in kt&&kt.enc!==void 0}class JweKeyManagement{static decrypt({key:At,encryptedKey:xt,joseHeader:Bt,crypto:Nt}){return __awaiter$K(this,void 0,void 0,function*(){switch(Bt.alg){case"dir":{if(xt!==void 0)throw new CryptoError(CryptoErrorCode.InvalidJwe,'JWE "encrypted_key" is not allowed when using "dir" (Direct Encryption Mode).');if(At instanceof Uint8Array)throw new CryptoError(CryptoErrorCode.InvalidJwe,'Key management "key" must be a Key URI or JWK when using "dir" (Direct Encryption Mode).');return At}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(typeof Bt.p2c!="number")throw new CryptoError(CryptoErrorCode.InvalidJwe,'JOSE Header "p2c" (PBES2 Count) is missing or not a number.');if(typeof Bt.p2s!="string")throw new CryptoError(CryptoErrorCode.InvalidJwe,'JOSE Header "p2s" (PBES2 salt) is missing or not a string.');if(!(At instanceof Uint8Array))throw new CryptoError(CryptoErrorCode.InvalidJwe,'Key management "key" must be a Uint8Array when using "PBES2" (Key Encryption Mode).');if(xt===void 0)throw new CryptoError(CryptoErrorCode.InvalidJwe,'JWE "encrypted_key" is required when using "PBES2" (Key Encryption Mode).');let jt;try{jt=new Uint8Array([...Convert$1.string(Bt.alg).toUint8Array(),0,...Convert$1.base64Url(Bt.p2s).toUint8Array()])}catch{throw new CryptoError(CryptoErrorCode.EncodingError,'Failed to decode the JOSE Header "p2s" (PBES2 salt) value.')}const Ut=yield Nt.deriveKey({algorithm:Bt.alg,baseKeyBytes:At,iterations:Bt.p2c,salt:jt});if(!(Ut.alg&&["A128KW","A192KW","A256KW"].includes(Ut.alg)))throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Unsupported Key Encryption Algorithm (alg) value: ${Ut.alg}`);return yield Nt.unwrapKey({decryptionKey:Ut,wrappedKeyBytes:xt,wrappedKeyAlgorithm:Bt.enc})}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Unsupported "alg" (Algorithm) Header Parameter value: ${Bt.alg}`)}})}static encrypt({key:At,joseHeader:xt,crypto:Bt}){return __awaiter$K(this,void 0,void 0,function*(){let Nt,jt;switch(xt.alg){case"dir":{if(jt!==void 0)throw new CryptoError(CryptoErrorCode.InvalidJwe,'JWE "encrypted_key" is not allowed when using "dir" (Direct Encryption Mode).');if(At instanceof Uint8Array)throw new CryptoError(CryptoErrorCode.InvalidJwe,'Key management "key" must be a Key URI or JWK when using "dir" (Direct Encryption Mode).');Nt=At;break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(typeof xt.p2c!="number")throw new CryptoError(CryptoErrorCode.InvalidJwe,'JOSE Header "p2c" (PBES2 Count) is missing or not a number.');if(typeof xt.p2s!="string")throw new CryptoError(CryptoErrorCode.InvalidJwe,'JOSE Header "p2s" (PBES2 salt) is missing or not a string.');if(!(At instanceof Uint8Array))throw new CryptoError(CryptoErrorCode.InvalidJwe,'Key management "key" must be a Uint8Array when using "PBES2" (Key Encryption Mode).');Nt=yield Bt.generateKey({algorithm:xt.enc});let Ut;try{Ut=new Uint8Array([...Convert$1.string(xt.alg).toUint8Array(),0,...Convert$1.base64Url(xt.p2s).toUint8Array()])}catch{throw new CryptoError(CryptoErrorCode.EncodingError,'Failed to decode the JOSE Header "p2s" (PBES2 salt) value.')}const Lt=yield Bt.deriveKey({algorithm:xt.alg,baseKeyBytes:At,iterations:xt.p2c,salt:Ut});jt=yield Bt.wrapKey({encryptionKey:Lt,unwrappedKey:Nt});break}default:throw new CryptoError(CryptoErrorCode.AlgorithmNotSupported,`Unsupported "alg" (Algorithm) Header Parameter value: ${xt.alg}`)}return{cek:Nt,encryptedKey:jt}})}}function isCipher(kt){return kt!==null&&typeof kt=="object"&&"encrypt"in kt&&typeof kt.encrypt=="function"&&"decrypt"in kt&&typeof kt.decrypt=="function"}function hasDuplicateProperties(...kt){const At=new Set,xt=kt.filter(Boolean);for(const Bt of xt)for(const Nt in Bt){if(At.has(Nt))return!0;At.add(Nt)}return!1}var __awaiter$J=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function decodeHeaderParam(kt,At){if(At!==void 0)try{if(typeof At!="string")throw new Error;return Convert$1.base64Url(At).toUint8Array()}catch{throw new CryptoError(CryptoErrorCode.InvalidJwe,`Failed to decode the JWE Header parameter '${kt}' from Base64 URL format to Uint8Array. Ensure the value is properly encoded in Base64 URL format without padding.`)}}class FlattenedJwe{constructor(At){this.ciphertext="",Object.assign(this,At)}static decrypt({jwe:At,key:xt,keyManager:Bt=new LocalKeyManager$2,crypto:Nt=new AgentCryptoApi,options:jt={}}){var Ut,Lt;return __awaiter$J(this,void 0,void 0,function*(){if(!isCipher(Nt))throw new CryptoError(CryptoErrorCode.OperationNotSupported,'Crypto API does not support the "encrypt" operation.');if(!isCipher(Bt))throw new CryptoError(CryptoErrorCode.OperationNotSupported,'Key Manager does not support the "decrypt" operation.');if(!At.protected&&!At.header&&!At.unprotected)throw new CryptoError(CryptoErrorCode.InvalidJwe,'JWE is missing the required JOSE header parameters. Please provide at least one of the following: "protected", "header", or "unprotected"');if(typeof At.ciphertext!="string")throw new CryptoError(CryptoErrorCode.InvalidJwe,"JWE Ciphertext is missing or not a string.");let Ht;if(At.protected)try{Ht=Convert$1.base64Url(At.protected).toObject()}catch{throw new Error("JWE Protected Header is invalid")}if(hasDuplicateProperties(Ht,At.header,At.unprotected))throw new Error('Duplicate properties detected. Please ensure that each parameter is defined only once across the JWE "header", "protected", and "unprotected" objects.');const Vt=Object.assign(Object.assign(Object.assign({},Ht),At.header),At.unprotected);if(!isValidJweHeader(Vt))throw new Error('JWE Header is missing required "alg" (Algorithm) and/or "enc" (Encryption) Header Parameters');if(Array.isArray(jt.allowedAlgValues)&&!jt.allowedAlgValues.includes(Vt.alg))throw new Error(`"alg" (Algorithm) Header Parameter value not allowed: ${Vt.alg}`);if(Array.isArray(jt.allowedEncValues)&&!jt.allowedEncValues.includes(Vt.enc))throw new Error(`"enc" (Encryption Algorithm) Header Parameter value not allowed: ${Vt.enc}`);let zt;try{const rr=At.encrypted_key?Convert$1.base64Url(At.encrypted_key).toUint8Array():void 0;zt=yield JweKeyManagement.decrypt({key:xt,encryptedKey:rr,joseHeader:Vt,keyManager:Bt,crypto:Nt})}catch(rr){if(rr instanceof CryptoError&&(rr.code===CryptoErrorCode.InvalidJwe||rr.code===CryptoErrorCode.AlgorithmNotSupported))throw rr;zt=typeof xt=="string"?yield Bt.generateKey({algorithm:Vt.enc}):yield Nt.generateKey({algorithm:Vt.enc})}const Wt=decodeHeaderParam("iv",At.iv),Jt=decodeHeaderParam("tag",At.tag),Qt=Jt!==void 0?new Uint8Array([...Convert$1.base64Url(At.ciphertext).toUint8Array(),...Jt??[]]):Convert$1.base64Url(At.ciphertext).toUint8Array(),Xt=At.aad!==void 0?new Uint8Array([...Convert$1.string((Ut=At.protected)!==null&&Ut!==void 0?Ut:"").toUint8Array(),...Convert$1.string(".").toUint8Array(),...Convert$1.string(At.aad).toUint8Array()]):Convert$1.string((Lt=At.protected)!==null&&Lt!==void 0?Lt:"").toUint8Array();return{plaintext:typeof zt=="string"?yield Bt.decrypt({keyUri:zt,data:Qt,iv:Wt,additionalData:Xt}):yield Nt.decrypt({key:zt,data:Qt,iv:Wt,additionalData:Xt}),protectedHeader:Ht,additionalAuthenticatedData:decodeHeaderParam("aad",At.aad),sharedUnprotectedHeader:At.unprotected,unprotectedHeader:At.header}})}static encrypt({key:At,plaintext:xt,additionalAuthenticatedData:Bt,protectedHeader:Nt,sharedUnprotectedHeader:jt,unprotectedHeader:Ut,keyManager:Lt=new LocalKeyManager$2,crypto:Ht=new AgentCryptoApi}){return __awaiter$J(this,void 0,void 0,function*(){if(!isCipher(Ht))throw new CryptoError(CryptoErrorCode.OperationNotSupported,'Crypto API does not support the "encrypt" operation.');if(!isCipher(Lt))throw new CryptoError(CryptoErrorCode.OperationNotSupported,'Key Manager does not support the "decrypt" operation.');if(!Nt&&!jt&&!Ut)throw new CryptoError(CryptoErrorCode.InvalidJwe,'JWE is missing the required JOSE header parameters. Please provide at least one of the following: "protectedHeader", "sharedUnprotectedHeader", or "unprotectedHeader"');if(!(xt instanceof Uint8Array))throw new CryptoError(CryptoErrorCode.InvalidJwe,"Plaintext is missing or not a byte array.");if(hasDuplicateProperties(Nt,jt,Ut))throw new Error('Duplicate properties detected. Please ensure that each parameter is defined only once across the JWE "protectedHeader", "sharedUnprotectedHeader", and "unprotectedHeader" objects.');const Vt=Object.assign(Object.assign(Object.assign({},Nt),jt),Ut);if(!isValidJweHeader(Vt))throw new Error('JWE Header is missing required "alg" (Algorithm) and/or "enc" (Encryption) Header Parameters');const{cek:zt,encryptedKey:Wt}=yield JweKeyManagement.encrypt({key:At,joseHeader:Vt,keyManager:Lt,crypto:Ht});let Jt;switch(Vt.enc){case"A128GCM":case"A192GCM":case"A256GCM":Jt=CryptoUtils$1.randomBytes(12);break;default:Jt=new Uint8Array(0)}const Qt=Nt?Convert$1.object(Nt).toBase64Url():"";let Xt,tr;Bt?(tr=Convert$1.uint8Array(Bt).toBase64Url(),Xt=Convert$1.string(Qt+"."+tr).toUint8Array()):Xt=Convert$1.string(Qt).toUint8Array();const rr=typeof zt=="string"?yield Lt.encrypt({keyUri:zt,data:xt,iv:Jt,additionalData:Xt}):yield Ht.encrypt({key:zt,data:xt,iv:Jt,additionalData:Xt}),nr=rr.slice(0,-16),ar=rr.slice(-16),ir=new FlattenedJwe({ciphertext:Convert$1.uint8Array(nr).toBase64Url()});return Wt&&(ir.encrypted_key=Convert$1.uint8Array(Wt).toBase64Url()),Nt&&(ir.protected=Qt),jt&&(ir.unprotected=jt),Ut&&(ir.header=Ut),Jt&&(ir.iv=Convert$1.uint8Array(Jt).toBase64Url()),tr&&(ir.aad=tr),ar&&(ir.tag=Convert$1.uint8Array(ar).toBase64Url()),ir})}}var __awaiter$I=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class CompactJwe{static decrypt({jwe:At,key:xt,keyManager:Bt=new LocalKeyManager$2,crypto:Nt=new AgentCryptoApi,options:jt={}}){return __awaiter$I(this,void 0,void 0,function*(){if(typeof At!="string")throw new CryptoError(CryptoErrorCode.InvalidJwe,"Invalid JWE format. JWE must be a string.");const{0:Ut,1:Lt,2:Ht,3:Vt,4:zt,length:Wt}=At.split(".");if(Wt!==5)throw new CryptoError(CryptoErrorCode.InvalidJwe,"Invalid JWE format. JWE must have 5 parts.");const Jt=yield FlattenedJwe.decrypt({jwe:{ciphertext:Vt,encrypted_key:Lt||void 0,iv:Ht||void 0,protected:Ut,tag:zt||void 0},key:xt,keyManager:Bt,crypto:Nt,options:jt});if(!isValidJweHeader(Jt.protectedHeader))throw new CryptoError(CryptoErrorCode.InvalidJwe,"Decrypt operation failed due to missing or malformed JWE Protected Header");return{plaintext:Jt.plaintext,protectedHeader:Jt.protectedHeader}})}static encrypt({plaintext:At,protectedHeader:xt,key:Bt,keyManager:Nt=new LocalKeyManager$2,crypto:jt=new AgentCryptoApi,options:Ut={}}){return __awaiter$I(this,void 0,void 0,function*(){const Lt=yield FlattenedJwe.encrypt({plaintext:At,protectedHeader:xt,key:Bt,keyManager:Nt,crypto:jt,options:Ut});return[Lt.protected,Lt.encrypted_key,Lt.iv,Lt.ciphertext,Lt.tag].join(".")})}}var __awaiter$H=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function isEmptyString(kt){return typeof kt!="string"||kt.trim().length===0}function isIdentityVaultBackup(kt){return typeof kt=="object"&&kt!==null&&"dateCreated"in kt&&typeof kt.dateCreated=="string"&&"size"in kt&&typeof kt.size=="number"&&"data"in kt&&typeof kt.data=="string"}function isIdentityVaultStatus(kt){return typeof kt=="object"&&kt!==null&&"initialized"in kt&&typeof kt.initialized=="boolean"&&"lastBackup"in kt&&"lastRestore"in kt}class HdIdentityVault{constructor({keyDerivationWorkFactor:At,store:xt}={}){this.crypto=new AgentCryptoApi,this._keyDerivationWorkFactor=At??21e4,this._store=xt??new MemoryStore}backup(){return __awaiter$H(this,void 0,void 0,function*(){if(this.isLocked()||(yield this.isInitialized())===!1)throw new Error("HdIdentityVault: Unable to proceed with the backup operation because the identity vault has not been initialized and unlocked. Please ensure the vault is properly initialized with a secure password before attempting to backup its contents.");const At={did:yield this.getStoredDid(),contentEncryptionKey:yield this.getStoredContentEncryptionKey(),status:yield this.getStatus()},xt=Convert$1.object(At).toBase64Url(),Bt={data:xt,dateCreated:new Date().toISOString(),size:xt.length};return yield this.setStatus({lastBackup:Bt.dateCreated}),Bt})}changePassword({oldPassword:At,newPassword:xt}){return __awaiter$H(this,void 0,void 0,function*(){if((yield this.isInitialized())===!1)throw new Error("HdIdentityVault: Unable to proceed with the change password operation because the identity vault has not been initialized. Please ensure the vault is properly initialized with a secure password before trying again.");yield this.lock();const Bt=yield this.getStoredContentEncryptionKey();let Nt,jt;try{let Lt;({plaintext:Lt,protectedHeader:Nt}=yield CompactJwe.decrypt({jwe:Bt,key:Convert$1.string(At).toUint8Array(),crypto:this.crypto,keyManager:new LocalKeyManager$1})),jt=Convert$1.uint8Array(Lt).toObject()}catch{throw new Error("HdIdentityVault: Unable to change the vault password due to an incorrectly entered old password.")}const Ut=yield CompactJwe.encrypt({key:Convert$1.string(xt).toUint8Array(),protectedHeader:Nt,plaintext:Convert$1.object(jt).toUint8Array(),crypto:this.crypto,keyManager:new LocalKeyManager$1});yield this._store.set("contentEncryptionKey",Ut),this._contentEncryptionKey=jt})}getDid(){return __awaiter$H(this,void 0,void 0,function*(){if(this.isLocked())throw new Error("HdIdentityVault: Vault has not been initialized and unlocked.");const At=yield this.getStoredDid(),{plaintext:xt}=yield CompactJwe.decrypt({jwe:At,key:this._contentEncryptionKey,crypto:this.crypto,keyManager:new LocalKeyManager$1}),Bt=Convert$1.uint8Array(xt).toObject();if(!isPortableDid(Bt))throw new Error("HdIdentityVault: Unable to decode malformed DID in identity vault");return yield BearerDid$1.import({portableDid:Bt})})}getStatus(){return __awaiter$H(this,void 0,void 0,function*(){const At=yield this._store.get("vaultStatus");if(!At)return{initialized:!1,lastBackup:null,lastRestore:null};const xt=Convert$1.string(At).toObject();if(!isIdentityVaultStatus(xt))throw new Error("HdIdentityVault: Invalid IdentityVaultStatus object in store");return xt})}initialize({password:At,recoveryPhrase:xt,dwnEndpoints:Bt}){return __awaiter$H(this,void 0,void 0,function*(){if(yield this.isInitialized())throw new Error("HdIdentityVault: Vault has already been initialized.");if(isEmptyString(At))throw new Error(`HdIdentityVault: The password is required and cannot be blank. Please provide a ' +
        'valid, non-empty password.`);if(xt&&isEmptyString(xt))throw new Error(`HdIdentityVault: The password is required and cannot be blank. Please provide a ' +
        'valid, non-empty password.`);if(xt??(xt=generateMnemonic(wordlist,128)),!validateMnemonic(xt,wordlist))throw new Error("HdIdentityVault: The provided recovery phrase is invalid. Please ensure that the recovery phrase is a correctly formatted series of 12 words.");const Nt=yield mnemonicToSeed(xt),jt=HDKey.fromMasterSeed(Nt),Ut=jt.derive("m/44'/0'/0'/0'/0'"),Lt=yield this.crypto.deriveKey({algorithm:"HKDF-512",baseKeyBytes:Ut.privateKey,salt:"",info:"vault_cek",derivedKeyAlgorithm:"A256GCM"}),Ht=yield this.crypto.deriveKeyBytes({algorithm:"HKDF-512",baseKeyBytes:Ut.publicKey,salt:"",info:"vault_unlock_salt",length:256}),Vt={alg:"PBES2-HS512+A256KW",enc:"A256GCM",cty:"text/plain",p2c:this._keyDerivationWorkFactor,p2s:Convert$1.uint8Array(Ht).toBase64Url()},zt=yield CompactJwe.encrypt({key:Convert$1.string(At).toUint8Array(),protectedHeader:Vt,plaintext:Convert$1.object(Lt).toUint8Array(),crypto:this.crypto,keyManager:new LocalKeyManager$1});yield this._store.set("contentEncryptionKey",zt);const Wt=jt.derive("m/44'/0'/1708523827'/0'/0'"),Jt=yield this.crypto.bytesToPrivateKey({algorithm:"Ed25519",privateKeyBytes:Wt.privateKey});let Qt=jt.derive("m/44'/0'/1708523827'/0'/1'");const Xt=yield this.crypto.bytesToPrivateKey({algorithm:"Ed25519",privateKeyBytes:Qt.privateKey}),tr=new DeterministicKeyGenerator;yield tr.addPredefinedKeys({privateKeys:[Jt,Xt]});const rr={verificationMethods:[{algorithm:"Ed25519",id:"sig",purposes:["assertionMethod","authentication"]}]};Bt&&Bt.length&&(rr.services=[{id:"dwn",type:"DecentralizedWebNode",serviceEndpoint:Bt,enc:"#enc",sig:"#sig"}]);const ar=yield(yield DidDht$1.create({keyManager:tr,options:rr})).export(),ir={alg:"dir",enc:"A256GCM",cty:"json"},lr=yield CompactJwe.encrypt({key:Lt,plaintext:Convert$1.object(ar).toUint8Array(),protectedHeader:ir,crypto:this.crypto,keyManager:new LocalKeyManager$1});return yield this._store.set("did",lr),this._contentEncryptionKey=Lt,yield this.setStatus({initialized:!0}),xt})}isInitialized(){return __awaiter$H(this,void 0,void 0,function*(){return this.getStatus().then(({initialized:At})=>At)})}isLocked(){return!this._contentEncryptionKey}lock(){return __awaiter$H(this,void 0,void 0,function*(){if((yield this.isInitialized())===!1)throw new Error("HdIdentityVault: Lock operation failed. Vault has not been initialized.");this._contentEncryptionKey&&(this._contentEncryptionKey.k=""),this._contentEncryptionKey=void 0})}restore({backup:At,password:xt}){return __awaiter$H(this,void 0,void 0,function*(){if(!isIdentityVaultBackup(At))throw new Error("HdIdentityVault: Restore operation failed due to invalid backup object.");let Bt,Nt,jt;try{jt=yield this.getStoredDid(),Nt=yield this.getStoredContentEncryptionKey(),Bt=yield this.getStatus()}catch{throw new Error("HdIdentityVault: The restore operation cannot proceed because the existing vault contents are missing or inaccessible. If the problem persists consider re-initializing the vault and retrying the restore.")}try{const Ut=Convert$1.base64Url(At.data).toObject();yield this._store.set("did",Ut.did),yield this._store.set("contentEncryptionKey",Ut.contentEncryptionKey),yield this.setStatus(Ut.status),yield this.unlock({password:xt})}catch{throw yield this.setStatus(Bt),yield this._store.set("contentEncryptionKey",Nt),yield this._store.set("did",jt),new Error("HdIdentityVault: Restore operation failed due to invalid backup data or an incorrect password. Please verify the password is correct for the provided backup and try again.")}yield this.setStatus({lastRestore:new Date().toISOString()})})}unlock({password:At}){return __awaiter$H(this,void 0,void 0,function*(){yield this.lock();const xt=yield this.getStoredContentEncryptionKey();try{const{plaintext:Bt}=yield CompactJwe.decrypt({jwe:xt,key:Convert$1.string(At).toUint8Array(),crypto:this.crypto,keyManager:new LocalKeyManager$1}),Nt=Convert$1.uint8Array(Bt).toObject();this._contentEncryptionKey=Nt}catch{throw new Error("HdIdentityVault: Unable to unlock the vault due to an incorrect password.")}})}getStoredDid(){return __awaiter$H(this,void 0,void 0,function*(){const At=yield this._store.get("did");if(!At)throw new Error("HdIdentityVault: Unable to retrieve the DID record from the vault. Please check the vault status and if the problem persists consider re-initializing the vault and restoring the contents from a previous backup.");return At})}getStoredContentEncryptionKey(){return __awaiter$H(this,void 0,void 0,function*(){const At=yield this._store.get("contentEncryptionKey");if(!At)throw new Error("HdIdentityVault: Unable to retrieve the Content Encryption Key record from the vault. Please check the vault status and if the problem persists consider re-initializing the vault and restoring the contents from a previous backup.");return At})}setStatus({initialized:At,lastBackup:xt,lastRestore:Bt}){return __awaiter$H(this,void 0,void 0,function*(){let Nt=yield this.getStatus();return Nt.initialized=At??Nt.initialized,Nt.lastBackup=xt??Nt.lastBackup,Nt.lastRestore=Bt??Nt.lastRestore,yield this._store.set("vaultStatus",JSON.stringify(Nt)),!0})}}var __awaiter$G=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function isIdentityMetadata(kt){return!(!kt||typeof kt!="object"||kt===null)&&"name"in kt}class DwnIdentityStore extends DwnDataStore{constructor(){super(...arguments),this.name="DwnIdentityStore",this._recordProtocolDefinition=IdentityProtocolDefinition,this._recordProperties={dataFormat:"application/json",protocol:this._recordProtocolDefinition.protocol,protocolPath:"identityMetadata",schema:this._recordProtocolDefinition.types.identityMetadata.schema}}delete(At){const xt=Object.create(null,{delete:{get:()=>super.delete}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.delete.call(this,At)})}get(At){const xt=Object.create(null,{get:{get:()=>super.get}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.get.call(this,At)})}set(At){const xt=Object.create(null,{set:{get:()=>super.set}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.set.call(this,At)})}list(At){const xt=Object.create(null,{list:{get:()=>super.list}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.list.call(this,At)})}getAllRecords({agent:At,tenantDid:xt}){var Bt;return __awaiter$G(this,void 0,void 0,function*(){this._index.clear();const{reply:Nt}=yield At.dwn.processRequest({author:xt,target:xt,messageType:DwnInterface.RecordsQuery,messageParams:{filter:Object.assign({},this._recordProperties)}});let jt=[];for(const Ut of(Bt=Nt.entries)!==null&&Bt!==void 0?Bt:[]){if(!Ut.encodedData)throw new Error(`${this.name}: Expected 'encodedData' to be present in the DWN query result entry`);const Lt=Convert$1.base64Url(Ut.encodedData).toObject();if(isIdentityMetadata(Lt)){const Ht=`${xt}${TENANT_SEPARATOR}${Lt.uri}`;this._index.set(Ht,Ut.recordId),this._cache.set(Ut.recordId,Lt),jt.push(Lt)}}return jt})}}class InMemoryIdentityStore extends InMemoryDataStore{constructor(){super(...arguments),this.name="InMemoryIdentityStore"}delete(At){const xt=Object.create(null,{delete:{get:()=>super.delete}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.delete.call(this,At)})}get(At){const xt=Object.create(null,{get:{get:()=>super.get}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.get.call(this,At)})}list(At){const xt=Object.create(null,{list:{get:()=>super.list}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.list.call(this,At)})}set(At){const xt=Object.create(null,{set:{get:()=>super.set}});return __awaiter$G(this,void 0,void 0,function*(){return yield xt.set.call(this,At)})}}var __awaiter$F=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class AgentIdentityApi{constructor({agent:At,store:xt}={}){this._agent=At,this._store=xt??new InMemoryIdentityStore}get agent(){if(this._agent===void 0)throw new Error("AgentIdentityApi: Unable to determine agent execution context.");return this._agent}set agent(At){this._agent=At}create({metadata:At,didMethod:xt="dht",didOptions:Bt,store:Nt,tenant:jt}){return __awaiter$F(this,void 0,void 0,function*(){const Ut=yield this.agent.did.create({method:xt,options:Bt,store:Nt,tenant:jt}),Lt=new BearerIdentity({did:Ut,metadata:Object.assign(Object.assign({},At),{uri:Ut.uri,tenant:jt??Ut.uri})});return(Nt??!0)&&(yield this._store.set({id:Lt.did.uri,data:Lt.metadata,agent:this.agent,tenant:Lt.metadata.tenant,preventDuplicates:!1,useCache:!0})),Lt})}export({didUri:At,tenant:xt}){return __awaiter$F(this,void 0,void 0,function*(){const Bt=yield this.get({didUri:At,tenant:xt});if(!Bt)throw new Error(`AgentIdentityApi: Failed to export due to Identity not found: ${At}`);return yield Bt.export()})}get({didUri:At,tenant:xt}){return __awaiter$F(this,void 0,void 0,function*(){const Bt=yield this._store.get({id:At,agent:this.agent,tenant:xt,useCache:!0});if(!Bt)return;const Nt=yield this.agent.did.get({didUri:At,tenant:Bt.tenant});if(!Nt)throw new Error(`AgentIdentityApi: Identity is present in the store but DID is missing: ${At}`);return new BearerIdentity({did:Nt,metadata:Bt})})}import({portableIdentity:At}){return __awaiter$F(this,void 0,void 0,function*(){const xt=yield this.agent.did.import({portableDid:At.portableDid,tenant:At.metadata.tenant});if(!xt)throw new Error(`AgentIdentityApi: Failed to import Identity: ${At.metadata.uri}`);const Bt=new BearerIdentity({did:xt,metadata:At.metadata});return yield this._store.set({id:Bt.did.uri,data:Bt.metadata,agent:this.agent,tenant:Bt.metadata.tenant,preventDuplicates:!0,useCache:!0}),Bt})}list({tenant:At}={}){return __awaiter$F(this,void 0,void 0,function*(){const xt=yield this._store.list({agent:this.agent,tenant:At});return(yield Promise.all(xt.map(Nt=>__awaiter$F(this,void 0,void 0,function*(){return this.get({didUri:Nt.uri,tenant:Nt.tenant})})))).filter(Nt=>typeof Nt<"u")})}manage({portableIdentity:At}){return __awaiter$F(this,void 0,void 0,function*(){const xt=yield this.agent.did.get({didUri:At.metadata.uri,tenant:At.metadata.tenant});if(!xt)throw new Error(`AgentIdentityApi: Failed to manage Identity: ${At.metadata.uri}`);const Bt=new BearerIdentity({did:xt,metadata:At.metadata});return yield this._store.set({id:Bt.did.uri,data:Bt.metadata,agent:this.agent,preventDuplicates:!0,useCache:!0}),Bt})}delete({didUri:At,tenant:xt}){return __awaiter$F(this,void 0,void 0,function*(){if(!(yield this._store.get({id:At,agent:this.agent,tenant:xt,useCache:!0})))throw new Error(`AgentIdentityApi: Failed to purge due to Identity not found: ${At}`);yield this._store.delete({id:At,agent:this.agent,tenant:xt})})}connectedIdentity({connectedDid:At}={}){return __awaiter$F(this,void 0,void 0,function*(){const xt=yield this.list();if(!(xt.length<1))return At?xt.find(Bt=>Bt.metadata.connectedDid===At):xt.find(Bt=>Bt.metadata.connectedDid!==void 0)})}}var __awaiter$E=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$d=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class AgentPermissionsApi{get agent(){if(!this._agent)throw new Error("AgentPermissionsApi: Agent is not set");return this._agent}set agent(At){this._agent=At}constructor({agent:At}={}){this._cachedPermissions=new TtlCache({ttl:60*1e3}),this._agent=At}getPermissionForRequest({connectedDid:At,delegateDid:xt,delegate:Bt,messageType:Nt,protocol:jt,cached:Ut=!1}){return __awaiter$E(this,void 0,void 0,function*(){const Lt=[At,xt,Nt,jt].join("~"),Ht=Ut?this._cachedPermissions.get(Lt):void 0;if(Ht)return Ht;const Vt=yield this.fetchGrants({author:xt,target:xt,grantor:At,grantee:xt}),zt=yield AgentPermissionsApi.matchGrantFromArray(At,xt,{messageType:Nt,protocol:jt},Vt,Bt);if(!zt)throw new Error(`CachedPermissions: No permissions found for ${Nt}: ${jt}`);return this._cachedPermissions.set(Lt,zt),zt})}fetchGrants({author:At,target:xt,grantee:Bt,grantor:Nt,protocol:jt,remote:Ut=!1}){return __awaiter$E(this,void 0,void 0,function*(){const Lt=jt?{protocol:jt}:void 0,Ht={author:At,target:xt,messageType:DwnInterface.RecordsQuery,messageParams:{filter:{author:Nt,recipient:Bt,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.grantPath,tags:Lt}}},{reply:Vt}=Ut?yield this.agent.sendDwnRequest(Ht):yield this.agent.processDwnRequest(Ht);if(Vt.status.code!==200)throw new Error(`PermissionsApi: Failed to fetch grants: ${Vt.status.detail}`);const zt=[];for(const Wt of Vt.entries){const Jt=yield PermissionGrant$1.parse(Wt);zt.push({grant:Jt,message:Wt})}return zt})}fetchRequests({author:At,target:xt,protocol:Bt,remote:Nt=!1}){return __awaiter$E(this,void 0,void 0,function*(){const jt=Bt?{protocol:Bt}:void 0,Ut={author:At,target:xt,messageType:DwnInterface.RecordsQuery,messageParams:{filter:{protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.requestPath,tags:jt}}},{reply:Lt}=Nt?yield this.agent.sendDwnRequest(Ut):yield this.agent.processDwnRequest(Ut);if(Lt.status.code!==200)throw new Error(`PermissionsApi: Failed to fetch requests: ${Lt.status.detail}`);const Ht=[];for(const Vt of Lt.entries){const zt=yield PermissionRequest$1.parse(Vt);Ht.push({request:zt,message:Vt})}return Ht})}isGrantRevoked({author:At,target:xt,grantRecordId:Bt,remote:Nt=!1}){return __awaiter$E(this,void 0,void 0,function*(){const jt={author:At,target:xt,messageType:DwnInterface.RecordsRead,messageParams:{filter:{parentId:Bt,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.revocationPath}}},{reply:Ut}=Nt?yield this.agent.sendDwnRequest(jt):yield this.agent.processDwnRequest(jt);if(Ut.status.code===404)return!1;if(Ut.status.code===200)return!0;throw new Error(`PermissionsApi: Failed to check if grant is revoked: ${Ut.status.detail}`)})}createGrant(At){return __awaiter$E(this,void 0,void 0,function*(){const{author:xt,store:Bt=!1,delegated:Nt=!1}=At,jt=__rest$d(At,["author","store","delegated"]);let Ut;PermissionsProtocol.hasProtocolScope(jt.scope)&&(Ut={protocol:jt.scope.protocol});const Lt={dateExpires:jt.dateExpires,requestId:jt.requestId,description:jt.description,delegated:Nt,scope:jt.scope},Ht=Convert$1.object(Lt).toUint8Array(),Vt={recipient:jt.grantedTo,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.grantPath,dataFormat:"application/json",tags:Ut},{reply:zt,message:Wt}=yield this.agent.processDwnRequest({store:Bt,author:xt,target:xt,messageType:DwnInterface.RecordsWrite,messageParams:Vt,dataStream:new Blob([Ht])});if(zt.status.code!==202)throw new Error(`PermissionsApi: Failed to create grant: ${zt.status.detail}`);const Jt=Object.assign(Object.assign({},Wt),{encodedData:Convert$1.uint8Array(Ht).toBase64Url()});return{grant:yield PermissionGrant$1.parse(Jt),message:Jt}})}createRequest(At){return __awaiter$E(this,void 0,void 0,function*(){const{author:xt,store:Bt=!1,delegated:Nt=!1}=At,jt=__rest$d(At,["author","store","delegated"]);let Ut;PermissionsProtocol.hasProtocolScope(jt.scope)&&(Ut={protocol:jt.scope.protocol});const Lt={description:jt.description,delegated:Nt,scope:jt.scope},Ht=Convert$1.object(Lt).toUint8Array(),Vt={protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.requestPath,dataFormat:"application/json",tags:Ut},{reply:zt,message:Wt}=yield this.agent.processDwnRequest({store:Bt,author:xt,target:xt,messageType:DwnInterface.RecordsWrite,messageParams:Vt,dataStream:new Blob([Ht])});if(zt.status.code!==202)throw new Error(`PermissionsApi: Failed to create request: ${zt.status.detail}`);const Jt=Object.assign(Object.assign({},Wt),{encodedData:Convert$1.uint8Array(Ht).toBase64Url()});return{request:yield PermissionRequest$1.parse(Jt),message:Jt}})}createRevocation(At){return __awaiter$E(this,void 0,void 0,function*(){const{author:xt,store:Bt=!1,grant:Nt,description:jt}=At,Ut={description:jt},Lt=Convert$1.object(Ut).toUint8Array();let Ht;PermissionsProtocol.hasProtocolScope(Nt.scope)&&(Ht={protocol:Nt.scope.protocol});const Vt={parentContextId:Nt.id,protocol:PermissionsProtocol.uri,protocolPath:PermissionsProtocol.revocationPath,dataFormat:"application/json",tags:Ht},{reply:zt,message:Wt}=yield this.agent.processDwnRequest({store:Bt,author:xt,target:xt,messageType:DwnInterface.RecordsWrite,messageParams:Vt,dataStream:new Blob([Lt])});if(zt.status.code!==202)throw new Error(`PermissionsApi: Failed to create revocation: ${zt.status.detail}`);return{message:Object.assign(Object.assign({},Wt),{encodedData:Convert$1.uint8Array(Lt).toBase64Url()})}})}clear(){return __awaiter$E(this,void 0,void 0,function*(){this._cachedPermissions.clear()})}static matchGrantFromArray(At,xt,Bt,Nt,jt=!1){return __awaiter$E(this,void 0,void 0,function*(){for(const Ut of Nt){const{grant:Lt,message:Ht}=Ut;if(jt===!0&&Lt.delegated!==!0)continue;const{messageType:Vt,protocol:zt,protocolPath:Wt,contextId:Jt}=Bt;if(this.matchScopeFromGrant(At,xt,Vt,Lt,zt,Wt,Jt))return{grant:Lt,message:Ht}}})}static matchScopeFromGrant(At,xt,Bt,Nt,jt,Ut,Lt){if(Nt.grantee!==xt||Nt.grantor!==At)return!1;const Ht=Nt.scope;if(Ht.interface+Ht.method===Bt)if(isRecordsType(Bt)){const zt=Ht;if(zt.protocol!==jt)return!1;if(this.isUnrestrictedProtocolScope(zt)||zt.protocolPath!==void 0&&zt.protocolPath===Ut||zt.contextId!==void 0&&(Lt!=null&&Lt.startsWith(zt.contextId)))return!0}else{const zt=Ht;return zt.protocol===void 0?!0:zt.protocol!==jt?!1:this.isUnrestrictedProtocolScope(zt)}return!1}static isUnrestrictedProtocolScope(At){return At.contextId===void 0&&At.protocolPath===void 0}}var JsonRpcErrorCodes;(function(kt){kt[kt.InvalidRequest=-32600]="InvalidRequest",kt[kt.MethodNotFound=-32601]="MethodNotFound",kt[kt.InvalidParams=-32602]="InvalidParams",kt[kt.InternalError=-32603]="InternalError",kt[kt.ParseError=-32700]="ParseError",kt[kt.TransportError=-32300]="TransportError",kt[kt.BadRequest=-50400]="BadRequest",kt[kt.Unauthorized=-50401]="Unauthorized",kt[kt.Forbidden=-50403]="Forbidden",kt[kt.Conflict=-50409]="Conflict"})(JsonRpcErrorCodes||(JsonRpcErrorCodes={}));const createJsonRpcRequest=(kt,At,xt)=>({jsonrpc:"2.0",id:kt,method:At,params:xt}),createJsonRpcSubscriptionRequest=(kt,At,xt,Bt)=>({jsonrpc:"2.0",id:kt,method:`rpc.subscribe.${At}`,params:Bt,subscription:{id:xt}});function parseJson(kt){try{return JSON.parse(kt)}catch{return null}}var __awaiter$D=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DwnServerInfoCacheMemory{constructor({ttl:At="15m"}={}){this.cache=new TtlCache({ttl:ms$1(At)})}get(At){return __awaiter$D(this,void 0,void 0,function*(){return this.cache.get(At)})}set(At,xt){return __awaiter$D(this,void 0,void 0,function*(){this.cache.set(At,xt)})}delete(At){return __awaiter$D(this,void 0,void 0,function*(){this.cache.delete(At)})}clear(){return __awaiter$D(this,void 0,void 0,function*(){this.cache.clear()})}close(){return __awaiter$D(this,void 0,void 0,function*(){})}}var __awaiter$C=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class HttpDwnRpcClient{constructor(At){this.serverInfoCache=At??new DwnServerInfoCacheMemory}get transportProtocols(){return["http:","https:"]}sendDwnRequest(At){return __awaiter$C(this,void 0,void 0,function*(){const xt=CryptoUtils$1.randomUuid(),Bt=createJsonRpcRequest(xt,"dwn.processMessage",{target:At.targetDid,message:At.message}),Nt={method:"POST",headers:{"dwn-request":JSON.stringify(Bt)}};At.data&&(Nt.headers["content-type"]="application/octet-stream",Nt.body=At.data);const jt=yield fetch(At.dwnUrl,Nt);let Ut,Lt;const{headers:Ht}=jt;if(Ht.has("dwn-response")){const zt=parseJson(Ht.get("dwn-response"));if(zt==null)throw new Error(`failed to parse json rpc response. dwn url: ${At.dwnUrl}`);Lt=jt.body,Ut=zt}else{const zt=yield jt.text();Ut=JSON.parse(zt)}if(Ut.error){const{code:zt,message:Wt}=Ut.error;throw new Error(`(${zt}) - ${Wt}`)}const{reply:Vt}=Ut.result;return Lt&&Vt.record?Vt.record.data=Lt:Lt&&Vt.entry&&(Vt.entry.data=Lt),Vt})}getServerInfo(At){return __awaiter$C(this,void 0,void 0,function*(){const xt=yield this.serverInfoCache.get(At);if(xt)return xt;const Bt=new URL(At);Bt.pathname.endsWith("/")?Bt.pathname+="info":Bt.pathname+="/info";try{const Nt=yield fetch(Bt.toString());if(Nt.ok){const jt=yield Nt.json(),Ut={registrationRequirements:jt.registrationRequirements,maxFileSize:jt.maxFileSize,webSocketSupport:jt.webSocketSupport};return this.serverInfoCache.set(At,Ut),Ut}else throw new Error(`HTTP (${Nt.status}) - ${Nt.statusText}`)}catch(Nt){throw new Error(`Error encountered while processing response from ${Bt.toString()}: ${Nt.message}`)}})}}var ws=null;typeof WebSocket<"u"?ws=WebSocket:typeof MozWebSocket<"u"?ws=MozWebSocket:typeof globalThis<"u"?ws=globalThis.WebSocket||globalThis.MozWebSocket:typeof window<"u"?ws=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(ws=self.WebSocket||self.MozWebSocket);const IsomorphicWebSocket=ws;var __awaiter$B=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const CONNECT_TIMEOUT=3e3,RESPONSE_TIMEOUT=3e4;class JsonRpcSocket{constructor(At,xt){this.socket=At,this.responseTimeout=xt,this.messageHandlers=new Map}static connect(At,xt={}){return __awaiter$B(this,void 0,void 0,function*(){const{connectTimeout:Bt=CONNECT_TIMEOUT,responseTimeout:Nt=RESPONSE_TIMEOUT,onclose:jt,onerror:Ut}=xt,Lt=new IsomorphicWebSocket(At);return jt?Lt.onclose=jt:Lt.onclose=()=>{console.info(`JSON RPC Socket close ${At}`)},Ut?Lt.onerror=Ut:Lt.onerror=Ht=>{console.error(`JSON RPC Socket error ${At}`,Ht)},new Promise((Ht,Vt)=>{Lt.addEventListener("open",()=>{const zt=new JsonRpcSocket(Lt,Nt);Lt.addEventListener("message",Wt=>{const Jt=parseJson(Wt.data),Qt=zt.messageHandlers.get(Jt.id);Qt&&Qt(Wt)}),Ht(zt)}),Lt.addEventListener("error",zt=>{Vt(zt)}),setTimeout(()=>Vt,Bt)})})}close(){this.socket.close()}request(At){return __awaiter$B(this,void 0,void 0,function*(){return new Promise((xt,Bt)=>{var Nt;(Nt=At.id)!==null&&Nt!==void 0||(At.id=CryptoUtils$1.randomUuid());const jt=Ut=>{const Lt=parseJson(Ut.data);if(Lt.id===At.id)return this.messageHandlers.delete(At.id),xt(Lt)};this.messageHandlers.set(At.id,jt),this.send(At),setTimeout(()=>{this.messageHandlers.delete(At.id),Bt(new Error("request timed out"))},this.responseTimeout)})})}subscribe(At,xt){return __awaiter$B(this,void 0,void 0,function*(){if(!At.method.startsWith("rpc.subscribe."))throw new Error("subscribe rpc requests must include the `rpc.subscribe` prefix");if(!At.subscription)throw new Error("subscribe rpc requests must include subscribe options");const Bt=At.subscription.id,Nt=Lt=>{const Ht=parseJson(Lt.data.toString());Ht.id===Bt&&(Ht.error!==void 0&&(this.messageHandlers.delete(Bt),this.closeSubscription(Bt)),xt(Ht))};this.messageHandlers.set(Bt,Nt);const jt=yield this.request(At);return jt.error?(this.messageHandlers.delete(Bt),{response:jt}):{response:jt,close:()=>__awaiter$B(this,void 0,void 0,function*(){this.messageHandlers.delete(Bt),yield this.closeSubscription(Bt)})}})}closeSubscription(At){const xt=CryptoUtils$1.randomUuid(),Bt=createJsonRpcSubscriptionRequest(xt,"close",At,{});return this.request(Bt)}send(At){this.socket.send(JSON.stringify(At))}}var __awaiter$A=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class WebSocketDwnRpcClient{get transportProtocols(){return["ws:","wss:"]}sendDwnRequest(At,xt){return __awaiter$A(this,void 0,void 0,function*(){const Bt=new URL(At.dwnUrl);if(Bt.protocol!=="ws:"&&Bt.protocol!=="wss:")throw new Error(`Invalid websocket protocol ${Bt.protocol}`);if(!WebSocketDwnRpcClient.connections.has(Bt.host))try{const Vt=yield JsonRpcSocket.connect(Bt.toString(),xt),zt=new Map;WebSocketDwnRpcClient.connections.set(Bt.host,{socket:Vt,subscriptions:zt})}catch(Vt){throw new Error(`Error connecting to ${Bt.host}: ${Vt.message}`)}const jt=WebSocketDwnRpcClient.connections.get(Bt.host),{targetDid:Ut,message:Lt,subscriptionHandler:Ht}=At;return Ht?WebSocketDwnRpcClient.subscriptionRequest(jt,Ut,Lt,Ht):WebSocketDwnRpcClient.processMessage(jt,Ut,Lt)})}static processMessage(At,xt,Bt){return __awaiter$A(this,void 0,void 0,function*(){const Nt=CryptoUtils$1.randomUuid(),jt=createJsonRpcRequest(Nt,"dwn.processMessage",{target:xt,message:Bt}),{socket:Ut}=At,Lt=yield Ut.request(jt),{error:Ht,result:Vt}=Lt;if(Ht!==void 0)throw new Error(`error sending DWN request: ${Ht.message}`);return Vt.reply})}static subscriptionRequest(At,xt,Bt,Nt){return __awaiter$A(this,void 0,void 0,function*(){const jt=CryptoUtils$1.randomUuid(),Ut=CryptoUtils$1.randomUuid(),Lt=createJsonRpcSubscriptionRequest(jt,"dwn.processMessage",Ut,{target:xt,message:Bt}),{socket:Ht,subscriptions:Vt}=At,{response:zt,close:Wt}=yield Ht.subscribe(Lt,tr=>{const{result:rr,error:nr}=tr;if(nr){const ir=Vt.get(Ut);ir&&ir.close(),Vt.delete(Ut);return}const{event:ar}=rr;Nt(ar)}),{error:Jt,result:Qt}=zt;if(Jt)throw new Error(`could not subscribe via jsonrpc socket: ${Jt.message}`);const{reply:Xt}=Qt;return Xt.subscription&&Wt&&(Vt.set(Ut,Object.assign(Object.assign({},Xt.subscription),{close:Wt})),Xt.subscription.close=Wt),Xt})}}WebSocketDwnRpcClient.connections=new Map;var __awaiter$z=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidRpcMethod;(function(kt){kt.Create="did.create",kt.Resolve="did.resolve"})(DidRpcMethod||(DidRpcMethod={}));class Web5RpcClient{constructor(At=[]){this.transportClients=new Map,At=[new HttpWeb5RpcClient,new WebSocketWeb5RpcClient,...At];for(let xt of At)for(let Bt of xt.transportProtocols)this.transportClients.set(Bt,xt)}get transportProtocols(){return Array.from(this.transportClients.keys())}sendDidRequest(At){return __awaiter$z(this,void 0,void 0,function*(){const xt=new URL(At.url),Bt=this.transportClients.get(xt.protocol);if(!Bt){const Nt=new Error(`no ${xt.protocol} transport client available`);throw Nt.name="NO_TRANSPORT_CLIENT",Nt}return Bt.sendDidRequest(At)})}sendDwnRequest(At){const xt=new URL(At.dwnUrl),Bt=this.transportClients.get(xt.protocol);if(!Bt){const Nt=new Error(`no ${xt.protocol} transport client available`);throw Nt.name="NO_TRANSPORT_CLIENT",Nt}return Bt.sendDwnRequest(At)}getServerInfo(At){return __awaiter$z(this,void 0,void 0,function*(){const xt=new URL(At),Bt=this.transportClients.get(xt.protocol);if(!Bt){const Nt=new Error(`no ${xt.protocol} transport client available`);throw Nt.name="NO_TRANSPORT_CLIENT",Nt}return Bt.getServerInfo(At)})}}class HttpWeb5RpcClient extends HttpDwnRpcClient{sendDidRequest(At){return __awaiter$z(this,void 0,void 0,function*(){const xt=CryptoUtils$1.randomUuid(),Bt=createJsonRpcRequest(xt,At.method,{data:At.data}),Nt=new Request(At.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Bt)});let jt;try{const Ut=yield fetch(Nt);if(Ut.ok){if(jt=yield Ut.json(),jt.error){const{code:Lt,message:Ht}=jt.error;throw new Error(`JSON RPC (${Lt}) - ${Ht}`)}}else throw new Error(`HTTP (${Ut.status}) - ${Ut.statusText}`)}catch(Ut){throw new Error(`Error encountered while processing response from ${At.url}: ${Ut.message}`)}return jt.result})}}class WebSocketWeb5RpcClient extends WebSocketDwnRpcClient{sendDidRequest(At){return __awaiter$z(this,void 0,void 0,function*(){throw new Error(`not implemented for transports [${this.transportProtocols.join(", ")}]`)})}getServerInfo(At){return __awaiter$z(this,void 0,void 0,function*(){throw new Error(`not implemented for transports [${this.transportProtocols.join(", ")}]`)})}}var __awaiter$y=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class AgentSyncApi{constructor({agent:At,syncEngine:xt}){this._syncEngine=xt,this._agent=At}get agent(){if(this._agent===void 0)throw new Error("AgentSyncApi: Unable to determine agent execution context.");return this._agent}set agent(At){this._agent=At,this._syncEngine.agent=At}registerIdentity(At){return __awaiter$y(this,void 0,void 0,function*(){yield this._syncEngine.registerIdentity(At)})}unregisterIdentity(At){return __awaiter$y(this,void 0,void 0,function*(){yield this._syncEngine.unregisterIdentity(At)})}getIdentityOptions(At){return __awaiter$y(this,void 0,void 0,function*(){return yield this._syncEngine.getIdentityOptions(At)})}updateIdentityOptions(At){return __awaiter$y(this,void 0,void 0,function*(){yield this._syncEngine.updateIdentityOptions(At)})}sync(At){return this._syncEngine.sync(At)}startSync(At){return this._syncEngine.startSync(At)}stopSync(At){return this._syncEngine.stopSync(At)}}var __awaiter$x=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues$1=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};class SyncEngineLevel{constructor({agent:At,dataPath:xt,db:Bt}){this._syncLock=!1,this._agent=At,this._permissionsApi=new AgentPermissionsApi({agent:At}),this._db=Bt||new Level(xt??"DATA/AGENT/SYNC_STORE"),this._ulidFactory=monotonicFactory()}get agent(){if(this._agent===void 0)throw new Error("SyncEngineLevel: Unable to determine agent execution context.");return this._agent}set agent(At){this._agent=At,this._permissionsApi=new AgentPermissionsApi({agent:At})}clear(){return __awaiter$x(this,void 0,void 0,function*(){yield this._permissionsApi.clear(),yield this._db.clear()})}close(){return __awaiter$x(this,void 0,void 0,function*(){yield this._db.close()})}pull(){var At;return __awaiter$x(this,void 0,void 0,function*(){const xt=yield this.getSyncPeerState({syncDirection:"pull"});yield this.enqueueOperations({syncDirection:"pull",syncPeerState:xt});const Bt=this.getPullQueue(),Nt=yield Bt.iterator().all(),jt=[],Ut=new Set;for(let Lt of Nt){const[Ht]=Lt,{did:Vt,dwnUrl:zt,messageCid:Wt,delegateDid:Jt,protocol:Qt}=SyncEngineLevel.parseSyncMessageParamsKey(Ht);if(Ut.has(zt))continue;if(yield this.messageExists(Vt,Wt)){jt.push({type:"del",key:Ht});continue}let tr,rr;if(Jt)try{tr=(yield this._permissionsApi.getPermissionForRequest({connectedDid:Vt,messageType:DwnInterface.MessagesRead,delegateDid:Jt,protocol:Qt,cached:!0})).grant.id,rr=Jt}catch(Ar){console.error("SyncEngineLevel: pull - Error fetching MessagesRead permission grant for delegate DID",Ar);continue}const nr=yield this.agent.processDwnRequest({store:!1,author:Vt,target:Vt,messageType:DwnInterface.MessagesRead,granteeDid:rr,messageParams:{messageCid:Wt,permissionGrantId:tr}});let ar;try{ar=yield this.agent.rpc.sendDwnRequest({dwnUrl:zt,targetDid:Vt,message:nr.message})}catch{Ut.add(zt);continue}if(ar.status.code!==200||!(!((At=ar.entry)===null||At===void 0)&&At.message)){yield this.addMessage(Vt,Wt),jt.push({type:"del",key:Ht});continue}const ir=ar.entry,lr=ir.message,yr=isRecordsWrite(ir)&&ir.data?NodeStream.fromWebReadable({readableStream:ir.data}):void 0,Sr=yield this.agent.dwn.node.processMessage(Vt,lr,{dataStream:yr});SyncEngineLevel.syncMessageReplyIsSuccessful(Sr)&&(yield this.addMessage(Vt,Wt),jt.push({type:"del",key:Ht}))}yield Bt.batch(jt)})}push(){return __awaiter$x(this,void 0,void 0,function*(){const At=yield this.getSyncPeerState({syncDirection:"push"});yield this.enqueueOperations({syncDirection:"push",syncPeerState:At});const xt=this.getPushQueue(),Bt=yield xt.iterator().all(),Nt=[],jt=new Set;for(let Ut of Bt){const[Lt]=Ut,{did:Ht,delegateDid:Vt,protocol:zt,dwnUrl:Wt,messageCid:Jt}=SyncEngineLevel.parseSyncMessageParamsKey(Lt);if(jt.has(Wt))continue;const Qt=yield this.getDwnMessage({author:Ht,messageCid:Jt,delegateDid:Vt,protocol:zt});if(!Qt){Nt.push({type:"del",key:Lt}),yield this.addMessage(Ht,Jt);continue}try{const Xt=yield this.agent.rpc.sendDwnRequest({dwnUrl:Wt,targetDid:Ht,data:Qt.data,message:Qt.message});SyncEngineLevel.syncMessageReplyIsSuccessful(Xt)&&(yield this.addMessage(Ht,Jt),Nt.push({type:"del",key:Lt}))}catch{jt.add(Wt)}}yield xt.batch(Nt)})}registerIdentity({did:At,options:xt}){return __awaiter$x(this,void 0,void 0,function*(){const Bt=this._db.sublevel("registeredIdentities");if(yield this.getIdentityOptions(At))throw new Error(`SyncEngineLevel: Identity with DID ${At} is already registered.`);xt??(xt={protocols:[]}),yield Bt.put(At,JSON.stringify(xt))})}unregisterIdentity(At){return __awaiter$x(this,void 0,void 0,function*(){const xt=this._db.sublevel("registeredIdentities");if(!(yield this.getIdentityOptions(At)))throw new Error(`SyncEngineLevel: Identity with DID ${At} is not registered.`);yield xt.del(At)})}getIdentityOptions(At){return __awaiter$x(this,void 0,void 0,function*(){const xt=this._db.sublevel("registeredIdentities");try{const Bt=yield xt.get(At);if(Bt)return JSON.parse(Bt)}catch(Bt){const Nt=Bt;if(Nt.code==="LEVEL_NOT_FOUND")return;throw new Error(`SyncEngineLevel: Error reading level: ${Nt.code}.`)}})}updateIdentityOptions({did:At,options:xt}){return __awaiter$x(this,void 0,void 0,function*(){const Bt=this._db.sublevel("registeredIdentities");if(!(yield this.getIdentityOptions(At)))throw new Error(`SyncEngineLevel: Identity with DID ${At} is not registered.`);yield Bt.put(At,JSON.stringify(xt))})}sync(At){return __awaiter$x(this,void 0,void 0,function*(){if(this._syncLock)throw new Error("SyncEngineLevel: Sync operation is already in progress.");this._syncLock=!0;try{(!At||At==="push")&&(yield this.push()),(!At||At==="pull")&&(yield this.pull())}finally{this._syncLock=!1}})}startSync({interval:At}){return __awaiter$x(this,void 0,void 0,function*(){const xt=ms$1(At),Bt=()=>__awaiter$x(this,void 0,void 0,function*(){this._syncLock||(clearInterval(this._syncIntervalId),this._syncIntervalId=void 0,yield this.sync(),this._syncIntervalId||(this._syncIntervalId=setInterval(Bt,xt)))});this._syncIntervalId&&clearInterval(this._syncIntervalId),this._syncIntervalId=setInterval(Bt,xt),this._syncLock||(yield this.sync())})}stopSync(At=2e3){return __awaiter$x(this,void 0,void 0,function*(){let xt=0;for(;this._syncLock;){if(xt>=At)throw new Error(`SyncEngineLevel: Existing sync operation did not complete within ${At} milliseconds.`);xt+=100,yield new Promise(Bt=>setTimeout(Bt,At<100?At:100))}this._syncIntervalId&&(clearInterval(this._syncIntervalId),this._syncIntervalId=void 0)})}static syncMessageReplyIsSuccessful(At){var xt,Bt;return At.status.code===202||At.status.code===204||At.status.code===409||((xt=At.entry)===null||xt===void 0?void 0:xt.message.descriptor.interface)===DwnInterfaceName.Records&&((Bt=At.entry)===null||Bt===void 0?void 0:Bt.message.descriptor.method)===DwnMethodName.Delete&&At.status.code===404}enqueueOperations({syncDirection:At,syncPeerState:xt}){return __awaiter$x(this,void 0,void 0,function*(){for(let Bt of xt){const Nt=yield this.getDwnEventLog({did:Bt.did,delegateDid:Bt.delegateDid,dwnUrl:Bt.dwnUrl,cursor:Bt.cursor,protocol:Bt.protocol,syncDirection:At}),jt=[];for(let Ut of Nt){const Lt=this._ulidFactory(),Ht=SyncEngineLevel.generateSyncMessageParamsKey(Object.assign(Object.assign({},Bt),{watermark:Lt,messageCid:Ut}));jt.push({type:"put",key:Ht,value:""})}jt.length>0&&(yield(At==="pull"?this.getPullQueue():this.getPushQueue()).batch(jt))}})}static generateSyncMessageParamsKey({did:At,delegateDid:xt,dwnUrl:Bt,protocol:Nt,watermark:jt,messageCid:Ut}){return[At,xt,Bt,Nt,jt,Ut].join("~")}static parseSyncMessageParamsKey(At){const[xt,Bt,Nt,jt,Ut,Lt]=At.split("~");return{did:xt,delegateDid:Bt===""?void 0:Bt,dwnUrl:Nt,watermark:Ut,messageCid:Lt,protocol:jt===""?void 0:jt}}getDwnEventLog({did:At,delegateDid:xt,dwnUrl:Bt,syncDirection:Nt,cursor:jt,protocol:Ut}){var Lt;return __awaiter$x(this,void 0,void 0,function*(){let Ht={},Vt;if(xt)try{Vt=(yield this._permissionsApi.getPermissionForRequest({connectedDid:At,messageType:DwnInterface.MessagesQuery,delegateDid:xt,protocol:Ut,cached:!0})).grant.id}catch(Wt){return console.error("SyncEngineLevel: Error fetching MessagesQuery permission grant for delegate DID",Wt),[]}if(Nt==="pull"){const Wt=Ut?[{protocol:Ut}]:[],Jt=yield this.agent.dwn.processRequest({store:!1,target:At,author:At,messageType:DwnInterface.MessagesQuery,granteeDid:xt,messageParams:{filters:Wt,cursor:jt,permissionGrantId:Vt}});try{Ht=yield this.agent.rpc.sendDwnRequest({dwnUrl:Bt,targetDid:At,message:Jt.message})}catch{}}else if(Nt==="push"){const Wt=Ut?[{protocol:Ut}]:[];Ht=(yield this.agent.dwn.processRequest({author:At,target:At,messageType:DwnInterface.MessagesQuery,granteeDid:xt,messageParams:{filters:Wt,cursor:jt,permissionGrantId:Vt}})).reply}const zt=(Lt=Ht.entries)!==null&&Lt!==void 0?Lt:[];return Ht.cursor&&this.setCursor(At,Bt,Nt,Ht.cursor,Ut),zt})}getDwnMessage({author:At,delegateDid:xt,protocol:Bt,messageCid:Nt}){return __awaiter$x(this,void 0,void 0,function*(){let jt;if(xt)try{jt=(yield this._permissionsApi.getPermissionForRequest({connectedDid:At,messageType:DwnInterface.MessagesRead,delegateDid:xt,protocol:Bt,cached:!0})).grant.id}catch(Vt){console.error("SyncEngineLevel: push - Error fetching MessagesRead permission grant for delegate DID",Vt);return}let{reply:Ut}=yield this.agent.dwn.processRequest({author:At,target:At,messageType:DwnInterface.MessagesRead,granteeDid:xt,messageParams:{messageCid:Nt,permissionGrantId:jt}});if(Ut.status.code!==200||!Ut.entry)return;const Lt=Ut.entry;let Ht={message:Lt.message};if(isRecordsWrite(Lt)&&Lt.data){const Vt=yield NodeStream.consumeToBytes({readable:Lt.data});Ht.data=new Blob([Vt],{type:Lt.message.descriptor.dataFormat})}return Ht})}getSyncPeerState({syncDirection:At}){var xt,Bt,Nt,jt;return __awaiter$x(this,void 0,void 0,function*(){const Ut=[];try{for(var Lt=!0,Ht=__asyncValues$1(this._db.sublevel("registeredIdentities").iterator()),Vt;Vt=yield Ht.next(),xt=Vt.done,!xt;Lt=!0){jt=Vt.value,Lt=!1;const[zt,Wt]=jt,{protocols:Jt,delegateDid:Qt}=yield new Promise(tr=>{try{const{protocols:rr,delegateDid:nr}=JSON.parse(Wt);tr({protocols:rr,delegateDid:nr})}catch{tr({protocols:[]})}}),Xt=yield getDwnServiceEndpointUrls(zt,this.agent.did);if(Xt.length!==0)for(let tr of Xt)if(Jt.length===0){const rr=yield this.getCursor(zt,tr,At);Ut.push({did:zt,delegateDid:Qt,dwnUrl:tr,cursor:rr})}else for(const rr of Jt){const nr=yield this.getCursor(zt,tr,At,rr);Ut.push({did:zt,delegateDid:Qt,dwnUrl:tr,cursor:nr,protocol:rr})}}}catch(zt){Bt={error:zt}}finally{try{!Lt&&!xt&&(Nt=Ht.return)&&(yield Nt.call(Ht))}finally{if(Bt)throw Bt.error}}return Ut})}getCursor(At,xt,Bt,Nt){return __awaiter$x(this,void 0,void 0,function*(){const jt=Nt?`${At}~${xt}~${Bt}-${Nt}`:`${At}~${xt}~${Bt}`,Ut=this.getCursorStore();try{const Lt=yield Ut.get(jt);if(Lt)return JSON.parse(Lt)}catch(Lt){if(Lt.notFound)return}})}setCursor(At,xt,Bt,Nt,jt){return __awaiter$x(this,void 0,void 0,function*(){const Ut=jt?`${At}~${xt}~${Bt}-${jt}`:`${At}~${xt}~${Bt}`;yield this.getCursorStore().put(Ut,JSON.stringify(Nt))})}messageExists(At,xt){return __awaiter$x(this,void 0,void 0,function*(){const Bt=this.getMessageStore(At);try{return yield Bt.get(xt),!0}catch(Nt){if(Nt.notFound)return!1;throw Nt}})}addMessage(At,xt){return __awaiter$x(this,void 0,void 0,function*(){return yield this.getMessageStore(At).put(xt,"")})}getMessageStore(At){return this._db.sublevel("history").sublevel(At).sublevel("messages")}getCursorStore(){return this._db.sublevel("cursors")}getPushQueue(){return this._db.sublevel("pushQueue")}getPullQueue(){return this._db.sublevel("pullQueue")}}var __awaiter$w=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$c=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};function buildOidcUrl({baseURL:kt,endpoint:At,authParam:xt,tokenParam:Bt}){switch(At){case"pushedAuthorizationRequest":return concatenateUrl(kt,"par");case"authorize":if(!xt)throw new Error("authParam must be providied when building a token URL");return concatenateUrl(kt,`authorize/${xt}.jwt`);case"callback":return concatenateUrl(kt,"callback");case"token":if(!Bt)throw new Error("tokenParam must be providied when building a token URL");return concatenateUrl(kt,`token/${Bt}.jwt`);default:throw new Error(`No matches for endpoint specified: ${At}`)}}function generateCodeChallenge(){return __awaiter$w(this,void 0,void 0,function*(){const kt=CryptoUtils$1.randomBytes(32),At=yield Sha256$1.digest({data:kt}),xt=Convert$1.uint8Array(At).toBase64Url();return{codeChallengeBytes:At,codeChallengeBase64Url:xt}})}function createAuthRequest(kt){return __awaiter$w(this,void 0,void 0,function*(){const At=CryptoUtils$1.randomBytes(16),xt=CryptoUtils$1.randomBytes(16);return Object.assign(Object.assign({},kt),{nonce:Convert$1.uint8Array(xt).toBase64Url(),response_type:"id_token",response_mode:"direct_post",state:Convert$1.uint8Array(At).toBase64Url(),client_metadata:{subject_syntax_types_supported:["did:dht","did:jwk"]}})})}function encryptAuthRequest({jwt:kt,encryptionKey:At}){return __awaiter$w(this,void 0,void 0,function*(){const xt={alg:"dir",cty:"JWT",enc:"XC20P",typ:"JWT"},Bt=CryptoUtils$1.randomBytes(24),Nt=Convert$1.object(xt).toUint8Array(),jt=Convert$1.string(kt).toUint8Array(),Lt=xchacha20poly1305(At,Bt,Nt).encrypt(jt),Ht=Lt.subarray(0,-16),Vt=Lt.subarray(-16);return[Convert$1.object(xt).toBase64Url(),"",Convert$1.uint8Array(Bt).toBase64Url(),Convert$1.uint8Array(Ht).toBase64Url(),Convert$1.uint8Array(Vt).toBase64Url()].join(".")})}function createResponseObject(kt){return __awaiter$w(this,void 0,void 0,function*(){const At=Math.floor(Date.now()/1e3);return Object.assign(Object.assign({},kt),{iat:At,exp:At+600})})}function signJwt({did:kt,data:At}){return __awaiter$w(this,void 0,void 0,function*(){const xt=Convert$1.object({alg:"EdDSA",kid:kt.document.verificationMethod[0].id,typ:"JWT"}).toBase64Url(),Bt=Convert$1.object(At).toBase64Url(),jt=yield(yield kt.getSigner()).sign({data:Convert$1.string(`${xt}.${Bt}`).toUint8Array()}),Ut=Convert$1.uint8Array(jt).toBase64Url();return`${xt}.${Bt}.${Ut}`})}function verifyJwt({jwt:kt}){var At,xt;return __awaiter$w(this,void 0,void 0,function*(){const[Bt,Nt,jt]=kt.split("."),Ut=Convert$1.base64Url(Bt).toObject();if(!Ut.kid)throw new Error("OIDC: Object could not be verified due to missing 'kid' header value.");const{didDocument:Lt}=yield DidJwk$1.resolve(Ut.kid.split("#")[0]);if(!Lt)throw new Error("OIDC: Object could not be verified due to Client DID resolution issue.");const{publicKeyJwk:Ht}=(xt=(At=Lt.verificationMethod)===null||At===void 0?void 0:At.find(Jt=>Jt.id===Ut.kid))!==null&&xt!==void 0?xt:{};if(!Ht)throw new Error("OIDC: Object could not be verified due to missing public key in DID document.");if(!(yield new EdDsaAlgorithm$2().verify({key:Ht,signature:Convert$1.base64Url(jt).toUint8Array(),data:Convert$1.string(`${Bt}.${Nt}`).toUint8Array()})))throw new Error("OIDC: Object failed verification due to invalid signature.");return Convert$1.base64Url(Nt).toObject()})}const getAuthRequest=(kt,At)=>__awaiter$w(void 0,void 0,void 0,function*(){const Bt=yield(yield fetch(kt)).text(),Nt=decryptAuthRequest({jwe:Bt,encryption_key:At});return yield verifyJwt({jwt:Nt})});function decryptAuthRequest({jwe:kt,encryption_key:At}){const[xt,,Bt,Nt,jt]=kt.split("."),Ut=Convert$1.base64Url(At).toUint8Array(),Ht=Convert$1.base64Url(xt).toUint8Array(),Vt=Convert$1.base64Url(Bt).toUint8Array(),zt=Convert$1.base64Url(Nt).toUint8Array(),Wt=Convert$1.base64Url(jt).toUint8Array(),Jt=new Uint8Array([...zt,...Wt]),Xt=xchacha20poly1305(Ut,Vt,Ht).decrypt(Jt);return Convert$1.uint8Array(Xt).toString()}function decryptAuthResponse(kt,At,xt){return __awaiter$w(this,void 0,void 0,function*(){const[Bt,,Nt,jt,Ut]=At.split("."),Lt=Convert$1.base64Url(Bt).toObject(),Ht=yield DidJwk$1.resolve(Lt.kid.split("#")[0]),Vt=yield Oidc.deriveSharedKey(kt,Ht.didDocument),zt=Object.assign(Object.assign({},Lt),{pin:xt}),Wt=Convert$1.object(zt).toUint8Array(),Jt=Convert$1.base64Url(Nt).toUint8Array(),Qt=Convert$1.base64Url(jt).toUint8Array(),Xt=Convert$1.base64Url(Ut).toUint8Array(),tr=new Uint8Array([...Qt,...Xt]),nr=xchacha20poly1305(Vt,Jt,Wt).decrypt(tr);return Convert$1.uint8Array(nr).toString()})}function deriveSharedKey(kt,At){var xt,Bt;return __awaiter$w(this,void 0,void 0,function*(){const Nt=yield kt.export(),jt=(xt=At.verificationMethod)===null||xt===void 0?void 0:xt[0].publicKeyJwk,Ut=(Bt=Nt.privateKeys)===null||Bt===void 0?void 0:Bt[0];jt.alg="EdDSA";const Lt=yield Ed25519$1.convertPublicKeyToX25519({publicKey:jt}),Ht=yield Ed25519$1.convertPrivateKeyToX25519({privateKey:Ut}),Vt=yield X25519$1.sharedSecret({privateKeyA:Ht,publicKeyB:Lt}),zt=yield crypto.subtle.importKey("raw",Vt,{name:"HKDF"},!1,["deriveBits"]),Wt=yield crypto.subtle.deriveBits({name:"HKDF",hash:"SHA-256",info:new Uint8Array,salt:new Uint8Array},zt,256);return new Uint8Array(Wt)})}function encryptAuthResponse({jwt:kt,encryptionKey:At,delegateDidKeyId:xt,randomPin:Bt}){const Nt={alg:"dir",cty:"JWT",enc:"XC20P",typ:"JWT",kid:xt},jt=CryptoUtils$1.randomBytes(24),Ut=Convert$1.object(Object.assign(Object.assign({},Nt),{pin:Bt})).toUint8Array(),Lt=Convert$1.string(kt).toUint8Array(),Vt=xchacha20poly1305(At,jt,Ut).encrypt(Lt),zt=Vt.subarray(0,-16),Wt=Vt.subarray(-16);return[Convert$1.object(Nt).toBase64Url(),"",Convert$1.uint8Array(jt).toBase64Url(),Convert$1.uint8Array(zt).toBase64Url(),Convert$1.uint8Array(Wt).toBase64Url()].join(".")}function shouldUseDelegatePermission(kt){return isRecordPermissionScope(kt)?!0:kt.interface===DwnInterfaceName.Protocols&&kt.method===DwnMethodName.Configure}function createPermissionGrants(kt,At,xt,Bt){return __awaiter$w(this,void 0,void 0,function*(){const Nt=new AgentPermissionsApi({agent:xt}),Ut=(yield Promise.all(Bt.map(Ht=>{const Vt=shouldUseDelegatePermission(Ht);return Nt.createGrant({delegated:Vt,store:!0,grantedTo:At.uri,scope:Ht,dateExpires:"2040-06-25T16:09:16.693356Z",author:kt})}))).map(Ht=>__awaiter$w(this,void 0,void 0,function*(){const Vt=Ht.message,{encodedData:zt}=Vt,Wt=__rest$c(Vt,["encodedData"]),Jt=Convert$1.base64Url(zt).toUint8Array(),{reply:Qt}=yield xt.sendDwnRequest({author:kt,target:kt,messageType:DwnInterface.RecordsWrite,dataStream:new Blob([Jt]),rawMessage:Wt});if(Qt.status.code!==202&&Qt.status.code!==409)throw new Error(`Could not send the message. Error details: ${Qt.status.detail}`);return Ht.message}));return yield Promise.all(Ut)})}function prepareProtocol(kt,At,xt){return __awaiter$w(this,void 0,void 0,function*(){const Bt=yield At.processDwnRequest({author:kt,messageType:DwnInterface.ProtocolsQuery,target:kt,messageParams:{filter:{protocol:xt.protocol}}});if(Bt.reply.status.code!==200)throw new Error(`Could not fetch protocol: ${Bt.reply.status.detail}`);if(Bt.reply.entries===void 0||Bt.reply.entries.length===0){const{reply:Nt,message:jt}=yield At.sendDwnRequest({author:kt,target:kt,messageType:DwnInterface.ProtocolsConfigure,messageParams:{definition:xt}});if(Nt.status.code!==202&&Nt.status.code!==409)throw new Error(`Could not send protocol: ${Nt.status.detail}`);yield At.processDwnRequest({author:kt,target:kt,messageType:DwnInterface.ProtocolsConfigure,rawMessage:jt})}else{const Nt=Bt.reply.entries[0],{reply:jt}=yield At.sendDwnRequest({author:kt,target:kt,messageType:DwnInterface.ProtocolsConfigure,rawMessage:Nt});if(jt.status.code!==202&&jt.status.code!==409)throw new Error(`Could not send protocol: ${jt.status.detail}`)}})}function submitAuthResponse(kt,At,xt,Bt){return __awaiter$w(this,void 0,void 0,function*(){const Nt=yield DidJwk$1.create(),jt=yield Nt.export(),Ut=At.permissionRequests.map(Xt=>__awaiter$w(this,void 0,void 0,function*(){const{protocolDefinition:tr,permissionScopes:rr}=Xt;if(!rr.every(ir=>"protocol"in ir&&ir.protocol===tr.protocol))throw new Error("All permission scopes must match the protocol uri they are provided with.");return yield prepareProtocol(kt,Bt,tr),yield Oidc.createPermissionGrants(kt,Nt,Bt,rr)})),Lt=(yield Promise.all(Ut)).flat(),Ht=yield Oidc.createResponseObject({iss:kt,sub:Nt.uri,aud:At.client_id,nonce:At.nonce,delegateGrants:Lt,delegatePortableDid:jt}),Vt=yield Oidc.signJwt({did:Nt,data:Ht}),zt=yield DidJwk$1.resolve(At.client_id),Wt=yield Oidc.deriveSharedKey(Nt,zt==null?void 0:zt.didDocument),Jt=Oidc.encryptAuthResponse({jwt:Vt,encryptionKey:Wt,delegateDidKeyId:Nt.document.verificationMethod[0].id,randomPin:xt}),Qt=new URLSearchParams({id_token:Jt,state:At.state}).toString();yield fetch(At.redirect_uri,{body:Qt,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}})})}const Oidc={createAuthRequest,encryptAuthRequest,getAuthRequest,decryptAuthRequest,createPermissionGrants,createResponseObject,encryptAuthResponse,decryptAuthResponse,deriveSharedKey,signJwt,verifyJwt,buildOidcUrl,generateCodeChallenge,submitAuthResponse};var __awaiter$v=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};function initClient({connectServerUrl:kt,walletUri:At,permissionRequests:xt,onWalletUriReady:Bt,validatePin:Nt}){return __awaiter$v(this,void 0,void 0,function*(){const jt=yield DidJwk$1.create(),Ut=CryptoUtils$1.randomBytes(32),Lt=Oidc.buildOidcUrl({baseURL:kt,endpoint:"callback"}),Ht=yield Oidc.createAuthRequest({client_id:jt.uri,scope:"openid did:jwk",permissionRequests:xt,redirect_uri:Lt}),Vt=yield Oidc.signJwt({did:jt,data:Ht});if(!Vt)throw new Error("Unable to sign requestObject");const zt=yield Oidc.encryptAuthRequest({jwt:Vt,encryptionKey:Ut}),Wt=new URLSearchParams({request:zt}),Jt=Oidc.buildOidcUrl({baseURL:kt,endpoint:"pushedAuthorizationRequest"}),Qt=yield fetch(Jt,{body:Wt,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!Qt.ok)throw new Error(`${Qt.status}: ${Qt.statusText}`);const Xt=yield Qt.json(),tr=new URL(At);tr.searchParams.set("request_uri",Xt.request_uri),tr.searchParams.set("encryption_key",Convert$1.uint8Array(Ut).toBase64Url()),Bt(tr.toString());const rr=Oidc.buildOidcUrl({baseURL:kt,endpoint:"token",tokenParam:Ht.state}),nr=yield pollWithTtl(()=>fetch(rr));if(nr){const ar=yield nr==null?void 0:nr.text(),ir=yield Nt(),lr=yield Oidc.decryptAuthResponse(jt,ar,ir),yr=yield Oidc.verifyJwt({jwt:lr});return{delegateGrants:yr.delegateGrants,delegatePortableDid:yr.delegatePortableDid,connectedDid:yr.iss}}})}function createPermissionRequestForProtocol({definition:kt,permissions:At}){const xt=[];xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Protocols,method:DwnMethodName.Query}),xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Messages,method:DwnMethodName.Read},{protocol:kt.protocol,interface:DwnInterfaceName.Messages,method:DwnMethodName.Query},{protocol:kt.protocol,interface:DwnInterfaceName.Messages,method:DwnMethodName.Subscribe});for(const Bt of At)switch(Bt){case"write":xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Records,method:DwnMethodName.Write});break;case"read":xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Records,method:DwnMethodName.Read});break;case"delete":xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Records,method:DwnMethodName.Delete});break;case"query":xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Records,method:DwnMethodName.Query});break;case"subscribe":xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Records,method:DwnMethodName.Subscribe});break;case"configure":xt.push({protocol:kt.protocol,interface:DwnInterfaceName.Protocols,method:DwnMethodName.Configure});break}return{protocolDefinition:kt,permissionScopes:xt}}const WalletConnect={initClient,createPermissionRequestForProtocol};var __awaiter$u=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$b=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class DidApi{constructor(At){this.agent=At.agent,this.connectedDid=At.connectedDid}create(At){return __awaiter$u(this,void 0,void 0,function*(){const xt=yield this.agent.processDidRequest({messageType:DidInterface.Create,messageParams:Object.assign({},At)}),{result:Bt}=xt,Nt=__rest$b(xt,["result"]);return Object.assign({did:Bt},Nt)})}resolve(At,xt){return __awaiter$u(this,void 0,void 0,function*(){const{result:Bt}=yield this.agent.processDidRequest({messageParams:{didUri:At,options:xt},messageType:DidInterface.Resolve});return Bt})}}function dataToBlob(kt,At){let xt;const Bt=universalTypeOf$1(kt);if(At==="text/plain"||Bt==="String")xt=new Blob([kt],{type:"text/plain"});else if(At==="application/json"||Bt==="Object"){const Nt=Convert$1.object(kt).toUint8Array();xt=new Blob([Nt],{type:"application/json"})}else if(Bt==="Uint8Array"||Bt==="ArrayBuffer")xt=new Blob([kt],{type:"application/octet-stream"});else if(Bt==="Blob")xt=kt;else throw new Error("data type not supported.");return At=At||xt.type||"application/octet-stream",{dataBlob:xt,dataFormat:At}}class SendCache{static check(At,xt){let Bt=SendCache.cache.get(At);return Bt?Bt.has(xt):!1}static set(At,xt){let Bt=SendCache.cache.get(At)||new Set;if(SendCache.cache.delete(At),SendCache.cache.set(At,Bt),this.cache.size>SendCache.sendCacheLimit){const Nt=SendCache.cache.keys().next().value;SendCache.cache.delete(Nt)}if(Bt.delete(xt),Bt.add(xt),Bt.size>SendCache.sendCacheLimit){const Nt=Bt.keys().next().value;Bt.delete(Nt)}}}SendCache.cache=new Map;SendCache.sendCacheLimit=100;var __awaiter$t=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$a=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Record{get _recordsWriteDescriptor(){if(isDwnMessage(DwnInterface.RecordsWrite,this.rawMessage))return this._descriptor}get _immutableProperties(){return this._recordsWriteDescriptor||this._initialWrite.descriptor}get id(){return this._recordId}get contextId(){return this.deleted?this._initialWrite.contextId:this._contextId}get dateCreated(){return this._immutableProperties.dateCreated}get parentId(){return this._immutableProperties.parentId}get protocol(){return this._immutableProperties.protocol}get protocolPath(){return this._immutableProperties.protocolPath}get recipient(){return this._immutableProperties.recipient}get schema(){return this._immutableProperties.schema}get dataFormat(){var At;return(At=this._recordsWriteDescriptor)===null||At===void 0?void 0:At.dataFormat}get dataCid(){var At;return(At=this._recordsWriteDescriptor)===null||At===void 0?void 0:At.dataCid}get dataSize(){var At;return(At=this._recordsWriteDescriptor)===null||At===void 0?void 0:At.dataSize}get datePublished(){var At;return(At=this._recordsWriteDescriptor)===null||At===void 0?void 0:At.datePublished}get published(){var At;return(At=this._recordsWriteDescriptor)===null||At===void 0?void 0:At.published}get tags(){var At;return(At=this._recordsWriteDescriptor)===null||At===void 0?void 0:At.tags}get author(){return this._author}get creator(){return this._creator}get dateModified(){return this._descriptor.messageTimestamp}get encryption(){return this._encryption}get authorization(){return this._authorization}get attestation(){return this._attestation}get protocolRole(){return this._protocolRole}get deleted(){return isDwnMessage(DwnInterface.RecordsDelete,this.rawMessage)}get initialWrite(){return this._initialWrite}get rawMessage(){const At=this._descriptor.interface+this._descriptor.method;let xt;return At===DwnInterface.RecordsWrite?xt=JSON.parse(JSON.stringify({contextId:this._contextId,recordId:this._recordId,descriptor:this._descriptor,attestation:this._attestation,authorization:this._authorization,encryption:this._encryption})):xt=JSON.parse(JSON.stringify({descriptor:this._descriptor,authorization:this._authorization})),removeUndefinedProperties(xt),xt}constructor(At,xt,Bt){this._agent=At,this._author=xt.author,this._creator=xt.initialWrite?getRecordAuthor(xt.initialWrite):xt.author,this._connectedDid=xt.connectedDid,this._delegateDid=xt.delegateDid,this._permissionsApi=Bt??new AgentPermissionsApi({agent:At}),this._remoteOrigin=xt.remoteOrigin,this._attestation=xt.attestation,this._authorization=xt.authorization,this._contextId=xt.contextId,this._descriptor=xt.descriptor,this._encryption=xt.encryption,this._initialWrite=xt.initialWrite,this._recordId=this.isRecordsDeleteDescriptor(xt.descriptor)?xt.descriptor.recordId:xt.recordId,this._protocolRole=xt.protocolRole,xt.encodedData&&(this._encodedData=typeof xt.encodedData=="string"?new Blob([Convert$1.base64Url(xt.encodedData).toUint8Array()],{type:this.dataFormat}):xt.encodedData),xt.data&&(this._readableStream=Stream.isReadableStream(xt.data)?NodeStream.fromWebReadable({readableStream:xt.data}):xt.data)}get data(){const At=this;return{blob(){return __awaiter$t(this,void 0,void 0,function*(){return new Blob([yield NodeStream.consumeToBytes({readable:yield this.stream()})],{type:At.dataFormat})})},bytes(){return __awaiter$t(this,void 0,void 0,function*(){return yield NodeStream.consumeToBytes({readable:yield this.stream()})})},json(){return __awaiter$t(this,void 0,void 0,function*(){return yield NodeStream.consumeToJson({readable:yield this.stream()})})},text(){return __awaiter$t(this,void 0,void 0,function*(){return yield NodeStream.consumeToText({readable:yield this.stream()})})},stream(){return __awaiter$t(this,void 0,void 0,function*(){if(At._encodedData?At._readableStream=NodeStream.fromWebReadable({readableStream:At._encodedData.stream()}):NodeStream.isReadable({readable:At._readableStream})||(At._readableStream=At._remoteOrigin?yield At.readRecordData({target:At._remoteOrigin,isRemote:!0}):yield At.readRecordData({target:At._connectedDid,isRemote:!1})),!At._readableStream)throw new Error("Record data is not available.");return At._readableStream})},then(Bt,Nt){return this.stream().then(Bt,Nt)},catch(Bt){return this.stream().catch(Bt)}}}store(At=!1){return __awaiter$t(this,void 0,void 0,function*(){return this.processRecord({signAsOwner:At,store:!0})})}import(At=!0){return __awaiter$t(this,void 0,void 0,function*(){return this.processRecord({store:At,signAsOwner:!0})})}send(At){return __awaiter$t(this,void 0,void 0,function*(){const xt=this._initialWrite;if(At??(At=this._connectedDid),xt&&!Record._sendCache.check(this._recordId,At)){const jt=Object.assign({},xt);removeUndefinedProperties(jt),yield this._agent.sendDwnRequest({messageType:DwnInterface.RecordsWrite,author:this._connectedDid,target:At,rawMessage:jt}),Record._sendCache.set(this._recordId,At)}let Bt;this.deleted?Bt={messageType:DwnInterface.RecordsDelete,author:this._connectedDid,target:At,rawMessage:Object.assign({},this.rawMessage)}:Bt={messageType:DwnInterface.RecordsWrite,author:this._connectedDid,target:At,dataStream:yield this.data.blob(),rawMessage:Object.assign({},this.rawMessage)};const{reply:Nt}=yield this._agent.sendDwnRequest(Bt);return Nt})}toJSON(){return{attestation:this.attestation,author:this.author,authorization:this.authorization,contextId:this.contextId,dataCid:this.dataCid,dataFormat:this.dataFormat,dataSize:this.dataSize,dateCreated:this.dateCreated,messageTimestamp:this.dateModified,datePublished:this.datePublished,encryption:this.encryption,parentId:this.parentId,protocol:this.protocol,protocolPath:this.protocolPath,protocolRole:this.protocolRole,published:this.published,recipient:this.recipient,recordId:this.id,schema:this.schema,tags:this.tags}}toString(){let At=`Record: {
`;return At+=`  ID: ${this.id}
`,At+=this.contextId?`  Context ID: ${this.contextId}
`:"",At+=this.protocol?`  Protocol: ${this.protocol}
`:"",At+=this.schema?`  Schema: ${this.schema}
`:"",this.deleted||(At+=`  Data CID: ${this.dataCid}
`,At+=`  Data Format: ${this.dataFormat}
`,At+=`  Data Size: ${this.dataSize}
`),At+=`  Deleted: ${this.deleted}
`,At+=`  Created: ${this.dateCreated}
`,At+=`  Modified: ${this.dateModified}
`,At+="}",At}paginationCursor(At){return __awaiter$t(this,void 0,void 0,function*(){return isDwnMessage(DwnInterface.RecordsWrite,this.rawMessage)?getPaginationCursor(this.rawMessage,At):void 0})}update(At){var{dateModified:xt,data:Bt}=At,Nt=__rest$a(At,["dateModified","data"]);return __awaiter$t(this,void 0,void 0,function*(){if(this.deleted)throw new Error("Record: Cannot revive a deleted record.");const jt=this._recordsWriteDescriptor,{parentId:Ut}=jt,Lt=__rest$a(jt,["parentId"]),Ht=Ut?this._contextId.split("/").slice(0,-1).join("/"):void 0;let Vt=Object.assign(Object.assign(Object.assign({},Lt),Nt),{parentContextId:Ht,messageTimestamp:xt,recordId:this._recordId});(isEmptyObject(Vt.tags)||Vt.tags===null)&&delete Vt.tags;let zt;Bt!==void 0&&(delete Vt.dataCid,delete Vt.dataSize,{dataBlob:zt}=dataToBlob(Bt,Vt.dataFormat));const Wt=new Set(["data","dataCid","dataFormat","dataSize","datePublished","messageTimestamp","published","tags"]);Record.verifyPermittedMutation(Object.keys(Nt),Wt),Nt.published===!1&&Vt.datePublished!==void 0&&delete Vt.datePublished;const Jt={author:this._connectedDid,dataStream:zt,messageParams:Object.assign({},Vt),messageType:DwnInterface.RecordsWrite,target:this._connectedDid};if(this._delegateDid){const{message:nr}=yield this._permissionsApi.getPermissionForRequest({connectedDid:this._connectedDid,delegateDid:this._delegateDid,protocol:this.protocol,delegate:!0,cached:!0,messageType:Jt.messageType});Jt.messageParams.delegatedGrant=nr,Jt.granteeDid=this._delegateDid}const Qt=yield this._agent.processDwnRequest(Jt),{message:Xt,reply:{status:tr}}=Qt,rr=Xt;return 200<=tr.code&&tr.code<=299&&(this._initialWrite||(this._initialWrite=Object.assign({},this.rawMessage)),this._authorization=rr.authorization,this._protocolRole=Nt.protocolRole,Wt.forEach(nr=>{this._descriptor[nr]=rr.descriptor[nr]}),Bt!==void 0&&(this._encodedData=zt)),{status:tr}})}delete(At){return __awaiter$t(this,void 0,void 0,function*(){const{store:xt=!0,signAsOwner:Bt,dateModified:Nt,prune:jt=!1}=At||{},Ut=Bt&&this._delegateDid===void 0,Lt=Bt&&this._delegateDid!==void 0;if(this.deleted&&!this._initialWrite)throw new Error("Record: Record is in an invalid state, initial write is missing.");this._initialWrite||(this._initialWrite=Object.assign({},this.rawMessage)),yield this.processInitialWriteIfNeeded({store:xt,signAsOwner:Bt});let Ht={messageType:DwnInterface.RecordsDelete,author:this._connectedDid,target:this._connectedDid,signAsOwner:Ut,signAsOwnerDelegate:Lt,store:xt};if(this.deleted?Ht.rawMessage=this.rawMessage:Ht.messageParams={prune:jt,recordId:this._recordId,messageTimestamp:Nt},this._delegateDid){const{message:Jt}=yield this._permissionsApi.getPermissionForRequest({connectedDid:this._connectedDid,delegateDid:this._delegateDid,protocol:this.protocol,delegate:!0,cached:!0,messageType:Ht.messageType});Ht.messageParams=Object.assign(Object.assign({},Ht.messageParams),{delegatedGrant:Jt}),Ht.granteeDid=this._delegateDid}const Vt=yield this._agent.processDwnRequest(Ht),{message:zt,reply:{status:Wt}}=Vt;return Wt.code!==202?{status:Wt}:(this._author=getRecordAuthor(zt),this._descriptor=zt.descriptor,this._authorization=zt.authorization,this._encodedData=void 0,this._encryption=void 0,this._attestation=void 0,this._contextId=void 0,{status:Wt})})}processInitialWriteIfNeeded({store:At,signAsOwner:xt}){return __awaiter$t(this,void 0,void 0,function*(){if(this.initialWrite&&(xt&&!this._initialWriteSigned||At&&!this._initialWriteStored)){const Bt=xt&&this._delegateDid===void 0,Nt=xt&&this._delegateDid!==void 0,jt={messageType:DwnInterface.RecordsWrite,rawMessage:this.initialWrite,author:this._connectedDid,target:this._connectedDid,signAsOwner:Bt,signAsOwnerDelegate:Nt,store:At};if(this._delegateDid){const{message:zt}=yield this._permissionsApi.getPermissionForRequest({connectedDid:this._connectedDid,delegateDid:this._delegateDid,protocol:this.protocol,delegate:!0,cached:!0,messageType:jt.messageType});jt.messageParams=Object.assign(Object.assign({},jt.messageParams),{delegatedGrant:zt}),jt.granteeDid=this._delegateDid}const Ut=yield this._agent.processDwnRequest(jt),{message:Lt,reply:{status:Ht}}=Ut,Vt=Lt;200<=Ht.code&&Ht.code<=299&&(At&&(this._initialWriteStored=!0),xt&&(this._initialWriteSigned=!0,this.initialWrite.authorization=Vt.authorization))}})}processRecord({store:At,signAsOwner:xt}){return __awaiter$t(this,void 0,void 0,function*(){const Bt=xt&&this._delegateDid===void 0,Nt=xt&&this._delegateDid!==void 0;yield this.processInitialWriteIfNeeded({store:At,signAsOwner:xt});let jt;if(this.deleted?jt={messageType:DwnInterface.RecordsDelete,rawMessage:this.rawMessage,author:this._connectedDid,target:this._connectedDid,signAsOwner:Bt,signAsOwnerDelegate:Nt,store:At}:jt={messageType:DwnInterface.RecordsWrite,rawMessage:this.rawMessage,author:this._connectedDid,target:this._connectedDid,dataStream:yield this.data.blob(),signAsOwner:Bt,signAsOwnerDelegate:Nt,store:At},this._delegateDid){const{message:zt}=yield this._permissionsApi.getPermissionForRequest({connectedDid:this._connectedDid,delegateDid:this._delegateDid,protocol:this.protocol,delegate:!0,cached:!0,messageType:jt.messageType});jt.messageParams=Object.assign(Object.assign({},jt.messageParams),{delegatedGrant:zt}),jt.granteeDid=this._delegateDid}const Ut=yield this._agent.processDwnRequest(jt),{message:Lt,reply:{status:Ht}}=Ut,Vt=Lt;return 200<=Ht.code&&Ht.code<=299&&xt&&(this._authorization=Vt.authorization),{status:Ht}})}readRecordData({target:At,isRemote:xt}){return __awaiter$t(this,void 0,void 0,function*(){const Bt={author:this._connectedDid,messageParams:{filter:{recordId:this.id}},messageType:DwnInterface.RecordsRead,target:At};if(this._delegateDid)try{const{message:jt}=yield this._permissionsApi.getPermissionForRequest({connectedDid:this._connectedDid,delegateDid:this._delegateDid,protocol:this.protocol,delegate:!0,cached:!0,messageType:Bt.messageType});Bt.messageParams=Object.assign(Object.assign({},Bt.messageParams),{delegatedGrant:jt}),Bt.granteeDid=this._delegateDid}catch{Bt.author=this._delegateDid}const Nt=xt?this._agent.sendDwnRequest(Bt):this._agent.processDwnRequest(Bt);try{const{reply:{status:jt,record:Ut}}=yield Nt;if(jt.code!==200)throw new Error(`${jt.code}: ${jt.detail}`);const Lt=Ut.data;return Stream.isReadableStream(Lt)?NodeStream.fromWebReadable({readableStream:Lt}):Lt}catch(jt){throw new Error(`Error encountered while attempting to read data: ${jt.message}`)}})}static verifyPermittedMutation(At,xt){for(const Bt of At)if(!xt.has(Bt))throw new Error(`${Bt} is an immutable property. Its value cannot be changed.`)}isRecordsDeleteDescriptor(At){return At.interface+At.method===DwnInterface.RecordsDelete}}Record._sendCache=SendCache;var __awaiter$s=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Protocol{constructor(At,xt,Bt){this._agent=At,this._metadata=Bt,this._protocolsConfigureMessage=xt}get definition(){return this._protocolsConfigureMessage.descriptor.definition}toJSON(){return this._protocolsConfigureMessage}send(At){return __awaiter$s(this,void 0,void 0,function*(){const{reply:xt}=yield this._agent.sendDwnRequest({author:this._metadata.author,messageCid:this._metadata.messageCid,messageType:DwnInterface.ProtocolsConfigure,target:At});return{status:xt.status}})}}var __awaiter$r=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$9=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class PermissionGrantRevocation{constructor(At,xt){this._permissions=At,this._connectedDid=xt.connectedDid,this._message=xt.message}get author(){return getRecordAuthor(this._message)}static parse({connectedDid:At,agent:xt,message:Bt}){return __awaiter$r(this,void 0,void 0,function*(){const Nt=new AgentPermissionsApi({agent:xt});return new PermissionGrantRevocation(Nt,{connectedDid:At,message:Bt})})}get agent(){return this._permissions.agent}get rawMessage(){return this._message}send(At){return __awaiter$r(this,void 0,void 0,function*(){At??(At=this._connectedDid);const xt=this._message,{encodedData:Bt}=xt,Nt=__rest$9(xt,["encodedData"]),jt=new Blob([Convert$1.base64Url(Bt).toUint8Array()]),Ut={messageType:DwnInterface.RecordsWrite,author:this._connectedDid,target:At,dataStream:jt,rawMessage:Nt},{reply:Lt}=yield this.agent.sendDwnRequest(Ut);return Lt})}store(At){return __awaiter$r(this,void 0,void 0,function*(){const xt=this.rawMessage,{encodedData:Bt}=xt,Nt=__rest$9(xt,["encodedData"]),jt=new Blob([Convert$1.base64Url(Bt).toUint8Array()]),{reply:Ut,message:Lt}=yield this.agent.processDwnRequest({author:this._connectedDid,target:this._connectedDid,messageType:DwnInterface.RecordsWrite,signAsOwner:At,rawMessage:Nt,dataStream:jt});return this._message=Object.assign(Object.assign({},Lt),{encodedData:Bt}),{status:Ut.status}})}}var __awaiter$q=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$8=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class PermissionGrant{constructor({api:At,connectedDid:xt,message:Bt,grant:Nt}){this._permissions=At,this._connectedDid=xt,this._message=Bt,this._grant=Nt}static parse(At){return __awaiter$q(this,void 0,void 0,function*(){const xt=yield PermissionGrant$1.parse(At.message),Bt=new AgentPermissionsApi({agent:At.agent});return new PermissionGrant(Object.assign(Object.assign({},At),{grant:xt,api:Bt}))})}get agent(){return this._permissions.agent}get id(){return this._grant.id}get grantor(){return this._grant.grantor}get grantee(){return this._grant.grantee}get dateGranted(){return this._grant.dateGranted}get description(){return this._grant.description}get requestId(){return this._grant.requestId}get dateExpires(){return this._grant.dateExpires}get delegated(){return this._grant.delegated}get scope(){return this._grant.scope}get conditions(){return this._grant.conditions}get rawMessage(){return this._message}send(At){return __awaiter$q(this,void 0,void 0,function*(){At??(At=this._connectedDid);const xt=this._message,{encodedData:Bt}=xt,Nt=__rest$8(xt,["encodedData"]),jt=new Blob([Convert$1.base64Url(Bt).toUint8Array()]),Ut={messageType:DwnInterface.RecordsWrite,author:this._connectedDid,target:At,dataStream:jt,rawMessage:Nt},{reply:Lt}=yield this.agent.sendDwnRequest(Ut);return Lt})}store(At=!1){return __awaiter$q(this,void 0,void 0,function*(){const xt=this.rawMessage,{encodedData:Bt}=xt,Nt=__rest$8(xt,["encodedData"]),jt=new Blob([Convert$1.base64Url(Bt).toUint8Array()]),{reply:Ut,message:Lt}=yield this.agent.processDwnRequest({store:!0,author:this._connectedDid,target:this._connectedDid,messageType:DwnInterface.RecordsWrite,signAsOwner:At,rawMessage:Nt,dataStream:jt});return this._message=Object.assign(Object.assign({},Lt),{encodedData:Bt}),{status:Ut.status}})}import(At=!1){return __awaiter$q(this,void 0,void 0,function*(){const xt=this.rawMessage,{encodedData:Bt}=xt,Nt=__rest$8(xt,["encodedData"]),jt=new Blob([Convert$1.base64Url(Bt).toUint8Array()]),{reply:Ut,message:Lt}=yield this.agent.processDwnRequest({store:At,author:this._connectedDid,target:this._connectedDid,messageType:DwnInterface.RecordsWrite,signAsOwner:!0,rawMessage:Nt,dataStream:jt});return this._message=Object.assign(Object.assign({},Lt),{encodedData:Bt}),{status:Ut.status}})}revoke(At=!0){return __awaiter$q(this,void 0,void 0,function*(){const xt=yield this._permissions.createRevocation({store:At,author:this._connectedDid,grant:this._grant});return PermissionGrantRevocation.parse({connectedDid:this._connectedDid,agent:this.agent,message:xt.message})})}isRevoked(At=!1){return this._permissions.isGrantRevoked({author:this._connectedDid,target:this.grantor,grantRecordId:this.id,remote:At})}toJSON(){return{id:this.id,grantor:this.grantor,grantee:this.grantee,dateGranted:this.dateGranted,description:this.description,requestId:this.requestId,dateExpires:this.dateExpires,delegated:this.delegated,scope:this.scope,conditions:this.conditions}}}var __awaiter$p=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$7=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class PermissionRequest{constructor({api:At,connectedDid:xt,message:Bt,request:Nt}){this._permissions=At,this._connectedDid=xt,this._request=Nt,this._message=Bt}static parse({connectedDid:At,agent:xt,message:Bt}){return __awaiter$p(this,void 0,void 0,function*(){const Nt=yield PermissionRequest$1.parse(Bt),jt=new AgentPermissionsApi({agent:xt});return new PermissionRequest({api:jt,connectedDid:At,message:Bt,request:Nt})})}get agent(){return this._permissions.agent}get id(){return this._request.id}get requester(){return this._request.requester}get description(){return this._request.description}get delegated(){return this._request.delegated}get scope(){return this._request.scope}get conditions(){return this._request.conditions}get rawMessage(){return this._message}send(At){return __awaiter$p(this,void 0,void 0,function*(){At??(At=this._connectedDid);const xt=this._message,{encodedData:Bt}=xt,Nt=__rest$7(xt,["encodedData"]),jt=new Blob([Convert$1.base64Url(Bt).toUint8Array()]),Ut={messageType:DwnInterface.RecordsWrite,author:this._connectedDid,target:At,dataStream:jt,rawMessage:Nt},{reply:Lt}=yield this.agent.sendDwnRequest(Ut);return Lt})}store(){return __awaiter$p(this,void 0,void 0,function*(){const At=this.rawMessage,{encodedData:xt}=At,Bt=__rest$7(At,["encodedData"]),Nt=new Blob([Convert$1.base64Url(xt).toUint8Array()]),{reply:jt,message:Ut}=yield this.agent.processDwnRequest({author:this._connectedDid,target:this._connectedDid,messageType:DwnInterface.RecordsWrite,rawMessage:Bt,dataStream:Nt});return this._message=Object.assign(Object.assign({},Ut),{encodedData:xt}),{status:jt.status}})}grant(At,xt=!0){return __awaiter$p(this,void 0,void 0,function*(){const{message:Bt}=yield this._permissions.createGrant({requestId:this.id,grantedTo:this.requester,scope:this.scope,delegated:this.delegated,author:this._connectedDid,store:xt,dateExpires:At});return PermissionGrant.parse({connectedDid:this._connectedDid,agent:this.agent,message:Bt})})}toJSON(){return this._request}}var __awaiter$o=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class SubscriptionUtil{static recordSubscriptionHandler({agent:At,connectedDid:xt,request:Bt,delegateDid:Nt,permissionsApi:jt}){const{subscriptionHandler:Ut,from:Lt}=Bt;return Ht=>__awaiter$o(this,void 0,void 0,function*(){const{message:Vt,initialWrite:zt}=Ht,Jt={author:getRecordAuthor(Vt),connectedDid:xt,remoteOrigin:Lt,initialWrite:zt},Qt=new Record(At,Object.assign(Object.assign(Object.assign({},Vt),Jt),{delegateDid:Nt}),jt);Ut(Qt)})}}var __awaiter$n=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$6=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class DwnApi{constructor(At){this.agent=At.agent,this.connectedDid=At.connectedDid,this.delegateDid=At.delegateDid,this.permissionsApi=new AgentPermissionsApi({agent:this.agent})}get permissions(){return{request:At=>__awaiter$n(this,void 0,void 0,function*(){var xt,Bt;const{message:Nt}=yield this.permissionsApi.createRequest(Object.assign(Object.assign({},At),{author:(xt=this.delegateDid)!==null&&xt!==void 0?xt:this.connectedDid})),jt={connectedDid:(Bt=this.delegateDid)!==null&&Bt!==void 0?Bt:this.connectedDid,agent:this.agent,message:Nt};return yield PermissionRequest.parse(jt)}),grant:At=>__awaiter$n(this,void 0,void 0,function*(){var xt,Bt;const{message:Nt}=yield this.permissionsApi.createGrant(Object.assign(Object.assign({},At),{author:(xt=this.delegateDid)!==null&&xt!==void 0?xt:this.connectedDid})),jt={connectedDid:(Bt=this.delegateDid)!==null&&Bt!==void 0?Bt:this.connectedDid,agent:this.agent,message:Nt};return yield PermissionGrant.parse(jt)}),queryRequests:(At={})=>__awaiter$n(this,void 0,void 0,function*(){var xt,Bt,Nt;const{from:jt}=At,Ut=__rest$6(At,["from"]),Lt=yield this.permissionsApi.fetchRequests(Object.assign(Object.assign({},Ut),{author:(xt=this.delegateDid)!==null&&xt!==void 0?xt:this.connectedDid,target:(Bt=jt??this.delegateDid)!==null&&Bt!==void 0?Bt:this.connectedDid,remote:jt!==void 0})),Ht=[];for(const Vt of Lt){const zt={connectedDid:(Nt=this.delegateDid)!==null&&Nt!==void 0?Nt:this.connectedDid,agent:this.agent,message:Vt.message};Ht.push(yield PermissionRequest.parse(zt))}return Ht}),queryGrants:(At={})=>__awaiter$n(this,void 0,void 0,function*(){var xt,Bt,Nt;const{checkRevoked:jt,from:Ut}=At,Lt=__rest$6(At,["checkRevoked","from"]),Ht=Ut!==void 0,Vt=(xt=this.delegateDid)!==null&&xt!==void 0?xt:this.connectedDid,zt=(Bt=Ut??this.delegateDid)!==null&&Bt!==void 0?Bt:this.connectedDid,Wt=yield this.permissionsApi.fetchGrants(Object.assign(Object.assign({},Lt),{author:Vt,target:zt,remote:Ht})),Jt=[];for(const Qt of Wt){const Xt={connectedDid:(Nt=this.delegateDid)!==null&&Nt!==void 0?Nt:this.connectedDid,agent:this.agent,message:Qt.message};if(jt){const tr=Qt.grant.id;if(yield this.permissionsApi.isGrantRevoked({author:Vt,target:zt,grantRecordId:tr,remote:Ht}))continue}Jt.push(yield PermissionGrant.parse(Xt))}return Jt})}}get protocols(){return{configure:At=>__awaiter$n(this,void 0,void 0,function*(){const xt={author:this.connectedDid,messageParams:At.message,messageType:DwnInterface.ProtocolsConfigure,target:this.connectedDid};if(this.delegateDid){const{message:Ht}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.message.definition.protocol,delegate:!0,cached:!0,messageType:xt.messageType});xt.messageParams=Object.assign(Object.assign({},xt.messageParams),{delegatedGrant:Ht}),xt.granteeDid=this.delegateDid}const Bt=yield this.agent.processDwnRequest(xt),{message:Nt,messageCid:jt,reply:{status:Ut}}=Bt,Lt={status:Ut};if(Ut.code<300){const Ht={author:this.connectedDid,messageCid:jt};Lt.protocol=new Protocol(this.agent,Nt,Ht)}return Lt}),query:At=>__awaiter$n(this,void 0,void 0,function*(){const xt={author:this.connectedDid,messageParams:At.message,messageType:DwnInterface.ProtocolsQuery,target:At.from||this.connectedDid};if(this.delegateDid)try{const{grant:{id:Ht}}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.message.filter.protocol,cached:!0,messageType:xt.messageType});xt.messageParams=Object.assign(Object.assign({},xt.messageParams),{permissionGrantId:Ht}),xt.granteeDid=this.delegateDid}catch{xt.author=this.delegateDid}let Bt;At.from?Bt=yield this.agent.sendDwnRequest(xt):Bt=yield this.agent.processDwnRequest(xt);const Nt=Bt.reply,{entries:jt=[],status:Ut}=Nt;return{protocols:jt.map(Ht=>{const Vt={author:this.connectedDid};return new Protocol(this.agent,Ht,Vt)}),status:Ut}})}}get records(){return{create:At=>__awaiter$n(this,void 0,void 0,function*(){return this.records.write(At)}),createFrom:At=>__awaiter$n(this,void 0,void 0,function*(){var xt;const Bt=At.record.toJSON(),{author:Nt}=Bt,jt=__rest$6(Bt,["author"]);return At.data!==void 0&&(delete jt.dataCid,delete jt.dataSize),((xt=At.message)===null||xt===void 0?void 0:xt.published)===!1&&jt.datePublished!==void 0&&(delete jt.datePublished,delete jt.published),(!isEmptyObject(At.message)||At.author&&At.author!==Nt)&&delete jt.recordId,this.records.write({data:At.data,message:Object.assign(Object.assign({},jt),At.message)})}),delete:At=>__awaiter$n(this,void 0,void 0,function*(){const xt={author:this.connectedDid,messageParams:At.message,messageType:DwnInterface.RecordsDelete,target:At.from||this.connectedDid};if(this.delegateDid){const{message:jt}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.protocol,delegate:!0,cached:!0,messageType:xt.messageType});xt.messageParams=Object.assign(Object.assign({},xt.messageParams),{delegatedGrant:jt}),xt.granteeDid=this.delegateDid}let Bt;At.from?Bt=yield this.agent.sendDwnRequest(xt):Bt=yield this.agent.processDwnRequest(xt);const{reply:{status:Nt}}=Bt;return{status:Nt}}),query:At=>__awaiter$n(this,void 0,void 0,function*(){const xt={author:this.connectedDid,messageParams:At.message,messageType:DwnInterface.RecordsQuery,target:At.from||this.connectedDid};if(this.delegateDid)try{const{message:Vt}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.protocol,delegate:!0,cached:!0,messageType:xt.messageType});xt.messageParams=Object.assign(Object.assign({},xt.messageParams),{delegatedGrant:Vt}),xt.granteeDid=this.delegateDid}catch{xt.author=this.delegateDid}let Bt;At.from?Bt=yield this.agent.sendDwnRequest(xt):Bt=yield this.agent.processDwnRequest(xt);const Nt=Bt.reply,{entries:jt=[],status:Ut,cursor:Lt}=Nt;return{records:jt.map(Vt=>{const zt=Object.assign({author:getRecordAuthor(Vt),connectedDid:this.connectedDid,remoteOrigin:At.from,delegateDid:this.delegateDid},Vt);return new Record(this.agent,zt,this.permissionsApi)}),status:Ut,cursor:Lt}}),read:At=>__awaiter$n(this,void 0,void 0,function*(){const xt={author:this.connectedDid,messageParams:At.message,messageType:DwnInterface.RecordsRead,target:At.from||this.connectedDid};if(this.delegateDid)try{const{message:Lt}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.protocol,delegate:!0,cached:!0,messageType:xt.messageType});xt.messageParams=Object.assign(Object.assign({},xt.messageParams),{delegatedGrant:Lt}),xt.granteeDid=this.delegateDid}catch{xt.author=this.delegateDid}let Bt;At.from?Bt=yield this.agent.sendDwnRequest(xt):Bt=yield this.agent.processDwnRequest(xt);const{reply:{record:Nt,status:jt}}=Bt;let Ut;if(200<=jt.code&&jt.code<=299){const Lt=Object.assign({author:getRecordAuthor(Nt),connectedDid:this.connectedDid,remoteOrigin:At.from,delegateDid:this.delegateDid},Nt);Ut=new Record(this.agent,Lt,this.permissionsApi)}return{record:Ut,status:jt}}),subscribe:At=>__awaiter$n(this,void 0,void 0,function*(){const xt={author:this.connectedDid,messageParams:At.message,messageType:DwnInterface.RecordsSubscribe,target:At.from||this.connectedDid,subscriptionHandler:SubscriptionUtil.recordSubscriptionHandler({agent:this.agent,connectedDid:this.connectedDid,delegateDid:this.delegateDid,permissionsApi:this.permissionsApi,request:At})};if(this.delegateDid)try{const{message:Lt}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.protocol,delegate:!0,cached:!0,messageType:xt.messageType});xt.messageParams=Object.assign(Object.assign({},xt.messageParams),{delegatedGrant:Lt}),xt.granteeDid=this.delegateDid}catch{xt.author=this.delegateDid}let Bt;At.from?Bt=yield this.agent.sendDwnRequest(xt):Bt=yield this.agent.processDwnRequest(xt);const Nt=Bt.reply,{status:jt,subscription:Ut}=Nt;return{status:jt,subscription:Ut}}),write:At=>__awaiter$n(this,void 0,void 0,function*(){var xt;const{dataBlob:Bt,dataFormat:Nt}=dataToBlob(At.data,(xt=At.message)===null||xt===void 0?void 0:xt.dataFormat),jt={store:At.store,messageType:DwnInterface.RecordsWrite,messageParams:Object.assign(Object.assign({},At.message),{dataFormat:Nt}),author:this.connectedDid,target:this.connectedDid,dataStream:Bt};if(this.delegateDid){const{message:zt}=yield this.permissionsApi.getPermissionForRequest({connectedDid:this.connectedDid,delegateDid:this.delegateDid,protocol:At.message.protocol,delegate:!0,cached:!0,messageType:jt.messageType});jt.messageParams=Object.assign(Object.assign({},jt.messageParams),{delegatedGrant:zt}),jt.granteeDid=this.delegateDid}const Ut=yield this.agent.processDwnRequest(jt),{message:Lt,reply:{status:Ht}}=Ut;let Vt;if(200<=Ht.code&&Ht.code<=299){const zt=Object.assign({author:this.connectedDid,connectedDid:this.connectedDid,encodedData:Bt,delegateDid:this.delegateDid},Lt);Vt=new Record(this.agent,zt,this.permissionsApi)}return{record:Vt,status:Ht}})}}}var __awaiter$m=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class VcApi{constructor(At){this.agent=At.agent,this.connectedDid=At.connectedDid}create(){return __awaiter$m(this,void 0,void 0,function*(){throw new Error("Not implemented.")})}}var DidVerificationRelationship;(function(kt){kt.authentication="authentication",kt.assertionMethod="assertionMethod",kt.keyAgreement="keyAgreement",kt.capabilityInvocation="capabilityInvocation",kt.capabilityDelegation="capabilityDelegation"})(DidVerificationRelationship||(DidVerificationRelationship={}));const EMPTY_DID_RESOLUTION_RESULT={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};class Did{constructor({method:At,id:xt,path:Bt,query:Nt,fragment:jt,params:Ut}){this.uri=`did:${At}:${xt}`,this.method=At,this.id=xt,this.path=Bt,this.query=Nt,this.fragment=jt,this.params=Ut}static parse(At){if(!At)return null;const xt=Did.DID_URI_PATTERN.exec(At);if(!xt||!xt.groups)return null;const{method:Bt,id:Nt,path:jt,query:Ut,fragment:Lt}=xt.groups,Ht={uri:`did:${Bt}:${Nt}`,method:Bt,id:Nt};if(jt&&(Ht.path=jt),Ut&&(Ht.query=Ut.slice(1)),Lt&&(Ht.fragment=Lt.slice(1)),Ut){const Vt={},zt=Ut.slice(1).split("&");for(const Wt of zt){const[Jt,Qt]=Wt.split("=");Vt[Jt]=Qt}Ht.params=Vt}return Ht}}Did.METHOD_PATTERN="([a-z0-9]+)";Did.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Did.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Did.PCT_ENCODED_PATTERN})`;Did.METHOD_ID_PATTERN=`((?:${Did.ID_CHAR_PATTERN}*:)*(${Did.ID_CHAR_PATTERN}+))`;Did.PATH_PATTERN="(/[^#?]*)?";Did.QUERY_PATTERN="([?][^#]*)?";Did.FRAGMENT_PATTERN="(#.*)?";Did.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Did.METHOD_PATTERN}):(?<id>${Did.METHOD_ID_PATTERN})(?<path>${Did.PATH_PATTERN})(?<query>${Did.QUERY_PATTERN})(?<fragment>${Did.FRAGMENT_PATTERN})$`);class DidError extends Error{constructor(At,xt){super(`${At}: ${xt}`),this.code=At,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,DidError)}}var DidErrorCode;(function(kt){kt.InvalidDid="invalidDid",kt.MethodNotSupported="methodNotSupported",kt.InternalError="internalError",kt.InvalidDidDocument="invalidDidDocument",kt.InvalidDidDocumentLength="invalidDidDocumentLength",kt.InvalidDidUrl="invalidDidUrl",kt.InvalidPreviousDidProof="invalidPreviousDidProof",kt.InvalidPublicKey="invalidPublicKey",kt.InvalidPublicKeyLength="invalidPublicKeyLength",kt.InvalidPublicKeyType="invalidPublicKeyType",kt.InvalidSignature="invalidSignature",kt.NotFound="notFound",kt.RepresentationNotSupported="representationNotSupported",kt.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(DidErrorCode||(DidErrorCode={}));var __awaiter$l=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Sha256{static digest({data:At}){return __awaiter$l(this,void 0,void 0,function*(){return sha256(At)})}}class CryptoAlgorithm{}var __awaiter$k=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Sha2Algorithm extends CryptoAlgorithm{digest({algorithm:At,data:xt}){return __awaiter$k(this,void 0,void 0,function*(){switch(At){case"SHA-256":return yield Sha256.digest({data:xt})}})}}function canonicalize$1(kt){const At=Bt=>{if(Bt!==null&&typeof Bt=="object"&&!Array.isArray(Bt)){const Nt=Object.keys(Bt).sort(),jt={};for(const Ut of Nt)jt[Ut]=At(Bt[Ut]);return jt}return Bt},xt=At(kt);return JSON.stringify(xt)}var __awaiter$j=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const KEY_URI_PREFIX_JWK="urn:jwk:";function computeJwkThumbprint({jwk:kt}){return __awaiter$j(this,void 0,void 0,function*(){const At=kt.kty;let xt;if(At==="EC")xt={crv:kt.crv,kty:kt.kty,x:kt.x,y:kt.y};else if(At==="oct")xt={k:kt.k,kty:kt.kty};else if(At==="OKP")xt={crv:kt.crv,kty:kt.kty,x:kt.x};else if(At==="RSA")xt={e:kt.e,kty:kt.kty,n:kt.n};else throw new Error(`Unsupported key type: ${At}`);removeUndefinedProperties(xt);const Bt=canonicalize$1(xt),Nt=Convert$1.string(Bt).toUint8Array(),jt=yield Sha256.digest({data:Nt});return Convert$1.uint8Array(jt).toBase64Url()})}function isEcPrivateJwk(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt&&"d"in kt)||kt.kty!=="EC"||typeof kt.d!="string"||typeof kt.x!="string")}function isEcPublicJwk(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt)||"d"in kt||kt.kty!=="EC"||typeof kt.x!="string")}function isOkpPrivateJwk(kt){return!(!kt||typeof kt!="object"||!("kty"in kt&&"crv"in kt&&"x"in kt&&"d"in kt)||kt.kty!=="OKP"||typeof kt.d!="string"||typeof kt.x!="string")}function isOkpPublicJwk(kt){return!(!kt||typeof kt!="object"||"d"in kt||!("kty"in kt&&"crv"in kt&&"x"in kt)||kt.kty!=="OKP"||typeof kt.x!="string")}function isPrivateJwk(kt){if(!kt||typeof kt!="object")return!1;switch(kt.kty){case"EC":case"OKP":case"RSA":return"d"in kt;case"oct":return"k"in kt;default:return!1}}var __awaiter$i=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$5=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Secp256k1{static adjustSignatureToLowS({signature:At}){return __awaiter$i(this,void 0,void 0,function*(){const xt=secp256k1.Signature.fromCompact(At);return xt.hasHighS()?xt.normalizeS().toCompactRawBytes():At})}static bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){const xt=yield Secp256k1.getCurvePoint({keyBytes:At}),Bt={kty:"EC",crv:"secp256k1",d:Convert$1.uint8Array(At).toBase64Url(),x:Convert$1.uint8Array(xt.x).toBase64Url(),y:Convert$1.uint8Array(xt.y).toBase64Url()};return Bt.kid=yield computeJwkThumbprint({jwk:Bt}),Bt})}static bytesToPublicKey({publicKeyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){const xt=yield Secp256k1.getCurvePoint({keyBytes:At}),Bt={kty:"EC",crv:"secp256k1",x:Convert$1.uint8Array(xt.x).toBase64Url(),y:Convert$1.uint8Array(xt.y).toBase64Url()};return Bt.kid=yield computeJwkThumbprint({jwk:Bt}),Bt})}static compressPublicKey({publicKeyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){return secp256k1.ProjectivePoint.fromHex(At).toRawBytes(!0)})}static computePublicKey({key:At}){return __awaiter$i(this,void 0,void 0,function*(){const xt=yield Secp256k1.privateKeyToBytes({privateKey:At}),Bt=yield Secp256k1.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"secp256k1",x:Convert$1.uint8Array(Bt.x).toBase64Url(),y:Convert$1.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint({jwk:Nt}),Nt})}static convertDerToCompactSignature({derSignature:At}){return __awaiter$i(this,void 0,void 0,function*(){return secp256k1.Signature.fromDER(At).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){return secp256k1.ProjectivePoint.fromHex(At).toRawBytes(!1)})}static generateKey(){return __awaiter$i(this,void 0,void 0,function*(){const At=secp256k1.utils.randomPrivateKey(),xt=yield Secp256k1.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint({jwk:xt}),xt})}static getPublicKey({key:At}){var xt;return __awaiter$i(this,void 0,void 0,function*(){if(!(isEcPrivateJwk(At)&&At.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let Bt=__rest$5(At,["d"]);return(xt=Bt.kid)!==null&&xt!==void 0||(Bt.kid=yield computeJwkThumbprint({jwk:Bt})),Bt})}static privateKeyToBytes({privateKey:At}){return __awaiter$i(this,void 0,void 0,function*(){if(!isEcPrivateJwk(At))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Convert$1.base64Url(At.d).toUint8Array()})}static publicKeyToBytes({publicKey:At}){return __awaiter$i(this,void 0,void 0,function*(){if(!(isEcPublicJwk(At)&&At.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const xt=new Uint8Array([4]),Bt=Convert$1.base64Url(At.x).toUint8Array(),Nt=Convert$1.base64Url(At.y).toUint8Array();return new Uint8Array([...xt,...Bt,...Nt])})}static sharedSecret({privateKeyA:At,publicKeyB:xt}){return __awaiter$i(this,void 0,void 0,function*(){if("x"in At&&"x"in xt&&At.x===xt.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Bt=yield Secp256k1.privateKeyToBytes({privateKey:At}),Nt=yield Secp256k1.publicKeyToBytes({publicKey:xt});return secp256k1.getSharedSecret(Bt,Nt,!0).slice(1)})}static sign({data:At,key:xt}){return __awaiter$i(this,void 0,void 0,function*(){const Bt=yield Secp256k1.privateKeyToBytes({privateKey:xt}),Nt=sha256(At);return secp256k1.sign(Nt,Bt).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){return secp256k1.utils.isValidPrivateKey(At)})}static validatePublicKey({publicKeyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){try{secp256k1.ProjectivePoint.fromHex(At).assertValidity()}catch{return!1}return!0})}static verify({key:At,signature:xt,data:Bt}){return __awaiter$i(this,void 0,void 0,function*(){const Nt=yield Secp256k1.publicKeyToBytes({publicKey:At}),jt=sha256(Bt);return secp256k1.verify(xt,jt,Nt,{lowS:!1})})}static getCurvePoint({keyBytes:At}){return __awaiter$i(this,void 0,void 0,function*(){At.byteLength===32&&(At=secp256k1.getPublicKey(At));const xt=secp256k1.ProjectivePoint.fromHex(At),Bt=numberToBytesBE(xt.x,32),Nt=numberToBytesBE(xt.y,32);return{x:Bt,y:Nt}})}}var __awaiter$h=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$4=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Secp256r1{static adjustSignatureToLowS({signature:At}){return __awaiter$h(this,void 0,void 0,function*(){const xt=secp256r1.Signature.fromCompact(At);return xt.hasHighS()?xt.normalizeS().toCompactRawBytes():At})}static bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){const xt=yield Secp256r1.getCurvePoint({keyBytes:At}),Bt={kty:"EC",crv:"P-256",d:Convert$1.uint8Array(At).toBase64Url(),x:Convert$1.uint8Array(xt.x).toBase64Url(),y:Convert$1.uint8Array(xt.y).toBase64Url()};return Bt.kid=yield computeJwkThumbprint({jwk:Bt}),Bt})}static bytesToPublicKey({publicKeyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){const xt=yield Secp256r1.getCurvePoint({keyBytes:At}),Bt={kty:"EC",crv:"P-256",x:Convert$1.uint8Array(xt.x).toBase64Url(),y:Convert$1.uint8Array(xt.y).toBase64Url()};return Bt.kid=yield computeJwkThumbprint({jwk:Bt}),Bt})}static compressPublicKey({publicKeyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){return secp256r1.ProjectivePoint.fromHex(At).toRawBytes(!0)})}static computePublicKey({key:At}){return __awaiter$h(this,void 0,void 0,function*(){const xt=yield Secp256r1.privateKeyToBytes({privateKey:At}),Bt=yield Secp256r1.getCurvePoint({keyBytes:xt}),Nt={kty:"EC",crv:"P-256",x:Convert$1.uint8Array(Bt.x).toBase64Url(),y:Convert$1.uint8Array(Bt.y).toBase64Url()};return Nt.kid=yield computeJwkThumbprint({jwk:Nt}),Nt})}static convertDerToCompactSignature({derSignature:At}){return __awaiter$h(this,void 0,void 0,function*(){return secp256r1.Signature.fromDER(At).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){return secp256r1.ProjectivePoint.fromHex(At).toRawBytes(!1)})}static generateKey(){return __awaiter$h(this,void 0,void 0,function*(){const At=secp256r1.utils.randomPrivateKey(),xt=yield Secp256r1.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint({jwk:xt}),xt})}static getPublicKey({key:At}){var xt;return __awaiter$h(this,void 0,void 0,function*(){if(!(isEcPrivateJwk(At)&&At.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let Bt=__rest$4(At,["d"]);return(xt=Bt.kid)!==null&&xt!==void 0||(Bt.kid=yield computeJwkThumbprint({jwk:Bt})),Bt})}static privateKeyToBytes({privateKey:At}){return __awaiter$h(this,void 0,void 0,function*(){if(!isEcPrivateJwk(At))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Convert$1.base64Url(At.d).toUint8Array()})}static publicKeyToBytes({publicKey:At}){return __awaiter$h(this,void 0,void 0,function*(){if(!(isEcPublicJwk(At)&&At.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const xt=new Uint8Array([4]),Bt=Convert$1.base64Url(At.x).toUint8Array(),Nt=Convert$1.base64Url(At.y).toUint8Array();return new Uint8Array([...xt,...Bt,...Nt])})}static sharedSecret({privateKeyA:At,publicKeyB:xt}){return __awaiter$h(this,void 0,void 0,function*(){if("x"in At&&"x"in xt&&At.x===xt.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Bt=yield Secp256r1.privateKeyToBytes({privateKey:At}),Nt=yield Secp256r1.publicKeyToBytes({publicKey:xt});return secp256r1.getSharedSecret(Bt,Nt,!0).slice(1)})}static sign({data:At,key:xt}){return __awaiter$h(this,void 0,void 0,function*(){const Bt=yield Secp256r1.privateKeyToBytes({privateKey:xt}),Nt=sha256(At);return secp256r1.sign(Nt,Bt).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){return secp256r1.utils.isValidPrivateKey(At)})}static validatePublicKey({publicKeyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){try{secp256r1.ProjectivePoint.fromHex(At).assertValidity()}catch{return!1}return!0})}static verify({key:At,signature:xt,data:Bt}){return __awaiter$h(this,void 0,void 0,function*(){const Nt=yield Secp256r1.publicKeyToBytes({publicKey:At}),jt=sha256(Bt);return secp256r1.verify(xt,jt,Nt,{lowS:!1})})}static getCurvePoint({keyBytes:At}){return __awaiter$h(this,void 0,void 0,function*(){At.byteLength===32&&(At=secp256r1.getPublicKey(At));const xt=secp256r1.ProjectivePoint.fromHex(At),Bt=numberToBytesBE(xt.x,32),Nt=numberToBytesBE(xt.y,32);return{x:Bt,y:Nt}})}}var __awaiter$g=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class EcdsaAlgorithm extends CryptoAlgorithm{computePublicKey({key:At}){return __awaiter$g(this,void 0,void 0,function*(){if(!isEcPrivateJwk(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(At.crv){case"secp256k1":{const xt=yield Secp256k1.computePublicKey({key:At});return xt.alg="ES256K",xt}case"P-256":{const xt=yield Secp256r1.computePublicKey({key:At});return xt.alg="ES256",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}generateKey({algorithm:At}){return __awaiter$g(this,void 0,void 0,function*(){switch(At){case"ES256K":case"secp256k1":{const xt=yield Secp256k1.generateKey();return xt.alg="ES256K",xt}case"ES256":case"secp256r1":{const xt=yield Secp256r1.generateKey();return xt.alg="ES256",xt}}})}getPublicKey({key:At}){return __awaiter$g(this,void 0,void 0,function*(){if(!isEcPrivateJwk(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(At.crv){case"secp256k1":{const xt=yield Secp256k1.getPublicKey({key:At});return xt.alg="ES256K",xt}case"P-256":{const xt=yield Secp256r1.getPublicKey({key:At});return xt.alg="ES256",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}sign({key:At,data:xt}){return __awaiter$g(this,void 0,void 0,function*(){if(!isEcPrivateJwk(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(At.crv){case"secp256k1":return yield Secp256k1.sign({key:At,data:xt});case"P-256":return yield Secp256r1.sign({key:At,data:xt});default:throw new Error(`Unsupported curve: ${At.crv}`)}})}verify({key:At,signature:xt,data:Bt}){return __awaiter$g(this,void 0,void 0,function*(){if(!isEcPublicJwk(At))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(At.crv){case"secp256k1":return yield Secp256k1.verify({key:At,signature:xt,data:Bt});case"P-256":return yield Secp256r1.verify({key:At,signature:xt,data:Bt});default:throw new Error(`Unsupported curve: ${At.crv}`)}})}}var __awaiter$f=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$3=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Ed25519{static bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$f(this,void 0,void 0,function*(){const xt=ed25519.getPublicKey(At),Bt={crv:"Ed25519",d:Convert$1.uint8Array(At).toBase64Url(),kty:"OKP",x:Convert$1.uint8Array(xt).toBase64Url()};return Bt.kid=yield computeJwkThumbprint({jwk:Bt}),Bt})}static bytesToPublicKey({publicKeyBytes:At}){return __awaiter$f(this,void 0,void 0,function*(){const xt={kty:"OKP",crv:"Ed25519",x:Convert$1.uint8Array(At).toBase64Url()};return xt.kid=yield computeJwkThumbprint({jwk:xt}),xt})}static computePublicKey({key:At}){return __awaiter$f(this,void 0,void 0,function*(){const xt=yield Ed25519.privateKeyToBytes({privateKey:At}),Bt=ed25519.getPublicKey(xt),Nt={kty:"OKP",crv:"Ed25519",x:Convert$1.uint8Array(Bt).toBase64Url()};return Nt.kid=yield computeJwkThumbprint({jwk:Nt}),Nt})}static convertPrivateKeyToX25519({privateKey:At}){return __awaiter$f(this,void 0,void 0,function*(){const xt=yield Ed25519.privateKeyToBytes({privateKey:At}),Bt=edwardsToMontgomeryPriv(xt),Nt=x25519.getPublicKey(Bt),jt={kty:"OKP",crv:"X25519",d:Convert$1.uint8Array(Bt).toBase64Url(),x:Convert$1.uint8Array(Nt).toBase64Url()};return jt.kid=yield computeJwkThumbprint({jwk:jt}),jt})}static convertPublicKeyToX25519({publicKey:At}){return __awaiter$f(this,void 0,void 0,function*(){const xt=yield Ed25519.publicKeyToBytes({publicKey:At});if(!(yield Ed25519.validatePublicKey({publicKeyBytes:xt})))throw new Error("Ed25519: Invalid public key.");const Nt=edwardsToMontgomeryPub(xt),jt={kty:"OKP",crv:"X25519",x:Convert$1.uint8Array(Nt).toBase64Url()};return jt.kid=yield computeJwkThumbprint({jwk:jt}),jt})}static generateKey(){return __awaiter$f(this,void 0,void 0,function*(){const At=ed25519.utils.randomPrivateKey(),xt=yield Ed25519.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint({jwk:xt}),xt})}static getPublicKey({key:At}){var xt;return __awaiter$f(this,void 0,void 0,function*(){if(!(isOkpPrivateJwk(At)&&At.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let Bt=__rest$3(At,["d"]);return(xt=Bt.kid)!==null&&xt!==void 0||(Bt.kid=yield computeJwkThumbprint({jwk:Bt})),Bt})}static privateKeyToBytes({privateKey:At}){return __awaiter$f(this,void 0,void 0,function*(){if(!isOkpPrivateJwk(At))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Convert$1.base64Url(At.d).toUint8Array()})}static publicKeyToBytes({publicKey:At}){return __awaiter$f(this,void 0,void 0,function*(){if(!isOkpPublicJwk(At))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Convert$1.base64Url(At.x).toUint8Array()})}static sign({key:At,data:xt}){return __awaiter$f(this,void 0,void 0,function*(){const Bt=yield Ed25519.privateKeyToBytes({privateKey:At});return ed25519.sign(xt,Bt)})}static validatePublicKey({publicKeyBytes:At}){return __awaiter$f(this,void 0,void 0,function*(){try{ed25519.ExtendedPoint.fromHex(At).assertValidity()}catch{return!1}return!0})}static verify({key:At,signature:xt,data:Bt}){return __awaiter$f(this,void 0,void 0,function*(){const Nt=yield Ed25519.publicKeyToBytes({publicKey:At});return ed25519.verify(xt,Bt,Nt)})}}var __awaiter$e=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class EdDsaAlgorithm extends CryptoAlgorithm{computePublicKey({key:At}){return __awaiter$e(this,void 0,void 0,function*(){if(!isOkpPrivateJwk(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(At.crv){case"Ed25519":{const xt=yield Ed25519.computePublicKey({key:At});return xt.alg="EdDSA",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}generateKey({algorithm:At}){return __awaiter$e(this,void 0,void 0,function*(){switch(At){case"Ed25519":{const xt=yield Ed25519.generateKey();return xt.alg="EdDSA",xt}}})}getPublicKey({key:At}){return __awaiter$e(this,void 0,void 0,function*(){if(!isOkpPrivateJwk(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(At.crv){case"Ed25519":{const xt=yield Ed25519.getPublicKey({key:At});return xt.alg="EdDSA",xt}default:throw new Error(`Unsupported curve: ${At.crv}`)}})}sign({key:At,data:xt}){return __awaiter$e(this,void 0,void 0,function*(){if(!isOkpPrivateJwk(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(At.crv){case"Ed25519":return yield Ed25519.sign({key:At,data:xt});default:throw new Error(`Unsupported curve: ${At.crv}`)}})}verify({key:At,signature:xt,data:Bt}){return __awaiter$e(this,void 0,void 0,function*(){if(!isOkpPublicJwk(At))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(At.crv){case"Ed25519":return yield Ed25519.verify({key:At,signature:xt,data:Bt});default:throw new Error(`Unsupported curve: ${At.crv}`)}})}}var __awaiter$d=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};const supportedAlgorithms={Ed25519:{implementation:EdDsaAlgorithm,names:["Ed25519"]},secp256k1:{implementation:EcdsaAlgorithm,names:["ES256K","secp256k1"]},secp256r1:{implementation:EcdsaAlgorithm,names:["ES256","secp256r1"]},"SHA-256":{implementation:Sha2Algorithm,names:["SHA-256"]}};class LocalKeyManager{constructor(At){var xt;this._algorithmInstances=new Map,this._keyStore=(xt=At==null?void 0:At.keyStore)!==null&&xt!==void 0?xt:new MemoryStore}digest({algorithm:At,data:xt}){return __awaiter$d(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:At}).digest({algorithm:At,data:xt})})}exportKey({keyUri:At}){return __awaiter$d(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:At})})}generateKey({algorithm:At}){return __awaiter$d(this,void 0,void 0,function*(){const Bt=yield this.getAlgorithm({algorithm:At}).generateKey({algorithm:At});if((Bt==null?void 0:Bt.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const Nt=`${KEY_URI_PREFIX_JWK}${Bt.kid}`;return yield this._keyStore.set(Nt,Bt),Nt})}getKeyUri({key:At}){return __awaiter$d(this,void 0,void 0,function*(){const xt=yield computeJwkThumbprint({jwk:At});return`${KEY_URI_PREFIX_JWK}${xt}`})}getPublicKey({keyUri:At}){return __awaiter$d(this,void 0,void 0,function*(){const xt=yield this.getPrivateKey({keyUri:At}),Bt=this.getAlgorithmName({key:xt});return yield this.getAlgorithm({algorithm:Bt}).getPublicKey({key:xt})})}importKey({key:At}){var xt;return __awaiter$d(this,void 0,void 0,function*(){if(!isPrivateJwk(At))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const Bt=structuredClone(At);(xt=Bt.kid)!==null&&xt!==void 0||(Bt.kid=yield computeJwkThumbprint({jwk:Bt}));const Nt=yield this.getKeyUri({key:Bt});return yield this._keyStore.set(Nt,Bt),Nt})}sign({keyUri:At,data:xt}){return __awaiter$d(this,void 0,void 0,function*(){const Bt=yield this.getPrivateKey({keyUri:At}),Nt=this.getAlgorithmName({key:Bt});return this.getAlgorithm({algorithm:Nt}).sign({data:xt,key:Bt})})}verify({key:At,signature:xt,data:Bt}){return __awaiter$d(this,void 0,void 0,function*(){const Nt=this.getAlgorithmName({key:At});return this.getAlgorithm({algorithm:Nt}).verify({key:At,signature:xt,data:Bt})})}getAlgorithm({algorithm:At}){var xt;const Bt=(xt=supportedAlgorithms[At])===null||xt===void 0?void 0:xt.implementation;if(!Bt)throw new Error(`Algorithm not supported: ${At}`);return this._algorithmInstances.has(Bt)||this._algorithmInstances.set(Bt,new Bt),this._algorithmInstances.get(Bt)}getAlgorithmName({key:At}){const xt=At.alg,Bt=At.crv;for(const Nt in supportedAlgorithms){const jt=supportedAlgorithms[Nt];if(xt&&jt.names.includes(xt))return Nt;if(Bt&&jt.names.includes(Bt))return Nt}throw new Error(`Unable to determine algorithm based on provided input: alg=${xt}, crv=${Bt}`)}getPrivateKey({keyUri:At}){return __awaiter$d(this,void 0,void 0,function*(){const xt=yield this._keyStore.get(At);if(!xt)throw new Error(`Key not found: ${At}`);return xt})}}function getJoseSignatureAlgorithmFromPublicKey$1(kt){const At={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(kt.alg&&Object.values(At).includes(kt.alg))return kt.alg;if(kt.crv&&Object.keys(At).includes(kt.crv))return At[kt.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${kt.alg}, crv=${kt.crv}. Supported 'alg' values: ${Object.values(At).join(", ")}. Supported 'crv' values: ${Object.keys(At).join(", ")}.`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u32=kt=>new Uint32Array(kt.buffer,kt.byteOffset,Math.floor(kt.byteLength/4));function isBytes$1(kt){return kt instanceof Uint8Array||kt!=null&&typeof kt=="object"&&kt.constructor.name==="Uint8Array"}const isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes(kt){if(typeof kt!="string")throw new Error(`utf8ToBytes expected string, got ${typeof kt}`);return new Uint8Array(new TextEncoder().encode(kt))}function toBytes(kt){if(typeof kt=="string")kt=utf8ToBytes(kt);else if(isBytes$1(kt))kt=kt.slice();else throw new Error(`expected Uint8Array, got ${typeof kt}`);return kt}function ensureBytes(kt,At){if(!isBytes$1(kt))throw new Error("Uint8Array expected");if(kt.length!==At)throw new Error(`Uint8Array length ${At} expected`)}function isBytes(kt){return kt!=null&&typeof kt=="object"&&(kt instanceof Uint8Array||kt.constructor.name==="Uint8Array")}function bytes(kt,...At){if(!isBytes(kt))throw new Error("Uint8Array expected");if(At.length>0&&!At.includes(kt.length))throw new Error(`Uint8Array expected of length ${At}, not of length=${kt.length}`)}function exists(kt,At=!0){if(kt.destroyed)throw new Error("Hash instance has been destroyed");if(At&&kt.finished)throw new Error("Hash#digest() has already been called")}function output(kt,At){bytes(kt);const xt=At.outputLen;if(kt.length<xt)throw new Error(`digestInto() expects output buffer of length at least ${xt}`)}var __awaiter$c=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$2=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class X25519{static bytesToPrivateKey({privateKeyBytes:At}){return __awaiter$c(this,void 0,void 0,function*(){const xt=x25519.getPublicKey(At),Bt={kty:"OKP",crv:"X25519",d:Convert$1.uint8Array(At).toBase64Url(),x:Convert$1.uint8Array(xt).toBase64Url()};return Bt.kid=yield computeJwkThumbprint({jwk:Bt}),Bt})}static bytesToPublicKey({publicKeyBytes:At}){return __awaiter$c(this,void 0,void 0,function*(){const xt={kty:"OKP",crv:"X25519",x:Convert$1.uint8Array(At).toBase64Url()};return xt.kid=yield computeJwkThumbprint({jwk:xt}),xt})}static computePublicKey({key:At}){return __awaiter$c(this,void 0,void 0,function*(){const xt=yield X25519.privateKeyToBytes({privateKey:At}),Bt=x25519.getPublicKey(xt),Nt={kty:"OKP",crv:"X25519",x:Convert$1.uint8Array(Bt).toBase64Url()};return Nt.kid=yield computeJwkThumbprint({jwk:Nt}),Nt})}static generateKey(){return __awaiter$c(this,void 0,void 0,function*(){const At=x25519.utils.randomPrivateKey(),xt=yield X25519.bytesToPrivateKey({privateKeyBytes:At});return xt.kid=yield computeJwkThumbprint({jwk:xt}),xt})}static getPublicKey({key:At}){var xt;return __awaiter$c(this,void 0,void 0,function*(){if(!(isOkpPrivateJwk(At)&&At.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let Bt=__rest$2(At,["d"]);return(xt=Bt.kid)!==null&&xt!==void 0||(Bt.kid=yield computeJwkThumbprint({jwk:Bt})),Bt})}static privateKeyToBytes({privateKey:At}){return __awaiter$c(this,void 0,void 0,function*(){if(!isOkpPrivateJwk(At))throw new Error("X25519: The provided key is not a valid OKP private key.");return Convert$1.base64Url(At.d).toUint8Array()})}static publicKeyToBytes({publicKey:At}){return __awaiter$c(this,void 0,void 0,function*(){if(!isOkpPublicJwk(At))throw new Error("X25519: The provided key is not a valid OKP public key.");return Convert$1.base64Url(At.x).toUint8Array()})}static sharedSecret({privateKeyA:At,publicKeyB:xt}){return __awaiter$c(this,void 0,void 0,function*(){if("x"in At&&"x"in xt&&At.x===xt.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const Bt=yield X25519.privateKeyToBytes({privateKey:At}),Nt=yield X25519.publicKeyToBytes({publicKey:xt});return x25519.getSharedSecret(Bt,Nt)})}}const u8to16=(kt,At)=>kt[At++]&255|(kt[At++]&255)<<8;class Poly1305{constructor(At){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,At=toBytes(At),ensureBytes(At,32);const xt=u8to16(At,0),Bt=u8to16(At,2),Nt=u8to16(At,4),jt=u8to16(At,6),Ut=u8to16(At,8),Lt=u8to16(At,10),Ht=u8to16(At,12),Vt=u8to16(At,14);this.r[0]=xt&8191,this.r[1]=(xt>>>13|Bt<<3)&8191,this.r[2]=(Bt>>>10|Nt<<6)&7939,this.r[3]=(Nt>>>7|jt<<9)&8191,this.r[4]=(jt>>>4|Ut<<12)&255,this.r[5]=Ut>>>1&8190,this.r[6]=(Ut>>>14|Lt<<2)&8191,this.r[7]=(Lt>>>11|Ht<<5)&8065,this.r[8]=(Ht>>>8|Vt<<8)&8191,this.r[9]=Vt>>>5&127;for(let zt=0;zt<8;zt++)this.pad[zt]=u8to16(At,16+2*zt)}process(At,xt,Bt=!1){const Nt=Bt?0:2048,{h:jt,r:Ut}=this,Lt=Ut[0],Ht=Ut[1],Vt=Ut[2],zt=Ut[3],Wt=Ut[4],Jt=Ut[5],Qt=Ut[6],Xt=Ut[7],tr=Ut[8],rr=Ut[9],nr=u8to16(At,xt+0),ar=u8to16(At,xt+2),ir=u8to16(At,xt+4),lr=u8to16(At,xt+6),yr=u8to16(At,xt+8),Sr=u8to16(At,xt+10),Ar=u8to16(At,xt+12),Dr=u8to16(At,xt+14);let Br=jt[0]+(nr&8191),Lr=jt[1]+((nr>>>13|ar<<3)&8191),Or=jt[2]+((ar>>>10|ir<<6)&8191),vr=jt[3]+((ir>>>7|lr<<9)&8191),pr=jt[4]+((lr>>>4|yr<<12)&8191),dr=jt[5]+(yr>>>1&8191),ur=jt[6]+((yr>>>14|Sr<<2)&8191),$r=jt[7]+((Sr>>>11|Ar<<5)&8191),wr=jt[8]+((Ar>>>8|Dr<<8)&8191),Er=jt[9]+(Dr>>>5|Nt),gr=0,fr=gr+Br*Lt+Lr*(5*rr)+Or*(5*tr)+vr*(5*Xt)+pr*(5*Qt);gr=fr>>>13,fr&=8191,fr+=dr*(5*Jt)+ur*(5*Wt)+$r*(5*zt)+wr*(5*Vt)+Er*(5*Ht),gr+=fr>>>13,fr&=8191;let br=gr+Br*Ht+Lr*Lt+Or*(5*rr)+vr*(5*tr)+pr*(5*Xt);gr=br>>>13,br&=8191,br+=dr*(5*Qt)+ur*(5*Jt)+$r*(5*Wt)+wr*(5*zt)+Er*(5*Vt),gr+=br>>>13,br&=8191;let _r=gr+Br*Vt+Lr*Ht+Or*Lt+vr*(5*rr)+pr*(5*tr);gr=_r>>>13,_r&=8191,_r+=dr*(5*Xt)+ur*(5*Qt)+$r*(5*Jt)+wr*(5*Wt)+Er*(5*zt),gr+=_r>>>13,_r&=8191;let Tr=gr+Br*zt+Lr*Vt+Or*Ht+vr*Lt+pr*(5*rr);gr=Tr>>>13,Tr&=8191,Tr+=dr*(5*tr)+ur*(5*Xt)+$r*(5*Qt)+wr*(5*Jt)+Er*(5*Wt),gr+=Tr>>>13,Tr&=8191;let Pr=gr+Br*Wt+Lr*zt+Or*Vt+vr*Ht+pr*Lt;gr=Pr>>>13,Pr&=8191,Pr+=dr*(5*rr)+ur*(5*tr)+$r*(5*Xt)+wr*(5*Qt)+Er*(5*Jt),gr+=Pr>>>13,Pr&=8191;let Nr=gr+Br*Jt+Lr*Wt+Or*zt+vr*Vt+pr*Ht;gr=Nr>>>13,Nr&=8191,Nr+=dr*Lt+ur*(5*rr)+$r*(5*tr)+wr*(5*Xt)+Er*(5*Qt),gr+=Nr>>>13,Nr&=8191;let Cr=gr+Br*Qt+Lr*Jt+Or*Wt+vr*zt+pr*Vt;gr=Cr>>>13,Cr&=8191,Cr+=dr*Ht+ur*Lt+$r*(5*rr)+wr*(5*tr)+Er*(5*Xt),gr+=Cr>>>13,Cr&=8191;let xr=gr+Br*Xt+Lr*Qt+Or*Jt+vr*Wt+pr*zt;gr=xr>>>13,xr&=8191,xr+=dr*Vt+ur*Ht+$r*Lt+wr*(5*rr)+Er*(5*tr),gr+=xr>>>13,xr&=8191;let Rr=gr+Br*tr+Lr*Xt+Or*Qt+vr*Jt+pr*Wt;gr=Rr>>>13,Rr&=8191,Rr+=dr*zt+ur*Vt+$r*Ht+wr*Lt+Er*(5*rr),gr+=Rr>>>13,Rr&=8191;let qr=gr+Br*rr+Lr*tr+Or*Xt+vr*Qt+pr*Jt;gr=qr>>>13,qr&=8191,qr+=dr*Wt+ur*zt+$r*Vt+wr*Ht+Er*Lt,gr+=qr>>>13,qr&=8191,gr=(gr<<2)+gr|0,gr=gr+fr|0,fr=gr&8191,gr=gr>>>13,br+=gr,jt[0]=fr,jt[1]=br,jt[2]=_r,jt[3]=Tr,jt[4]=Pr,jt[5]=Nr,jt[6]=Cr,jt[7]=xr,jt[8]=Rr,jt[9]=qr}finalize(){const{h:At,pad:xt}=this,Bt=new Uint16Array(10);let Nt=At[1]>>>13;At[1]&=8191;for(let Lt=2;Lt<10;Lt++)At[Lt]+=Nt,Nt=At[Lt]>>>13,At[Lt]&=8191;At[0]+=Nt*5,Nt=At[0]>>>13,At[0]&=8191,At[1]+=Nt,Nt=At[1]>>>13,At[1]&=8191,At[2]+=Nt,Bt[0]=At[0]+5,Nt=Bt[0]>>>13,Bt[0]&=8191;for(let Lt=1;Lt<10;Lt++)Bt[Lt]=At[Lt]+Nt,Nt=Bt[Lt]>>>13,Bt[Lt]&=8191;Bt[9]-=8192;let jt=(Nt^1)-1;for(let Lt=0;Lt<10;Lt++)Bt[Lt]&=jt;jt=~jt;for(let Lt=0;Lt<10;Lt++)At[Lt]=At[Lt]&jt|Bt[Lt];At[0]=(At[0]|At[1]<<13)&65535,At[1]=(At[1]>>>3|At[2]<<10)&65535,At[2]=(At[2]>>>6|At[3]<<7)&65535,At[3]=(At[3]>>>9|At[4]<<4)&65535,At[4]=(At[4]>>>12|At[5]<<1|At[6]<<14)&65535,At[5]=(At[6]>>>2|At[7]<<11)&65535,At[6]=(At[7]>>>5|At[8]<<8)&65535,At[7]=(At[8]>>>8|At[9]<<5)&65535;let Ut=At[0]+xt[0];At[0]=Ut&65535;for(let Lt=1;Lt<8;Lt++)Ut=(At[Lt]+xt[Lt]|0)+(Ut>>>16)|0,At[Lt]=Ut&65535}update(At){exists(this);const{buffer:xt,blockLen:Bt}=this;At=toBytes(At);const Nt=At.length;for(let jt=0;jt<Nt;){const Ut=Math.min(Bt-this.pos,Nt-jt);if(Ut===Bt){for(;Bt<=Nt-jt;jt+=Bt)this.process(At,jt);continue}xt.set(At.subarray(jt,jt+Ut),this.pos),this.pos+=Ut,jt+=Ut,this.pos===Bt&&(this.process(xt,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(At){exists(this),output(At,this),this.finished=!0;const{buffer:xt,h:Bt}=this;let{pos:Nt}=this;if(Nt){for(xt[Nt++]=1;Nt<16;Nt++)xt[Nt]=0;this.process(xt,0,!0)}this.finalize();let jt=0;for(let Ut=0;Ut<8;Ut++)At[jt++]=Bt[Ut]>>>0,At[jt++]=Bt[Ut]>>>8;return At}digest(){const{buffer:At,outputLen:xt}=this;this.digestInto(At);const Bt=At.slice(0,xt);return this.destroy(),Bt}}function wrapConstructorWithKey(kt){const At=(Bt,Nt)=>kt(Nt).update(toBytes(Bt)).digest(),xt=kt(new Uint8Array(32));return At.outputLen=xt.outputLen,At.blockLen=xt.blockLen,At.create=Bt=>kt(Bt),At}wrapConstructorWithKey(kt=>new Poly1305(kt));const sigma16=utf8ToBytes("expand 16-byte k"),sigma32=utf8ToBytes("expand 32-byte k");u32(sigma16);u32(sigma32);function extractDidFragment(kt){if(typeof kt=="string"&&kt.length!==0)return kt.split("#").pop()}function getVerificationMethods({didDocument:kt}){var At,xt;if(!kt)throw new TypeError("Required parameter missing: 'didDocument'");const Bt=[];return Bt.push(...(xt=(At=kt.verificationMethod)===null||At===void 0?void 0:At.filter(isDidVerificationMethod))!==null&&xt!==void 0?xt:[]),Object.keys(DidVerificationRelationship).forEach(Nt=>{var jt,Ut;Bt.push(...(Ut=(jt=kt[Nt])===null||jt===void 0?void 0:jt.filter(isDidVerificationMethod))!==null&&Ut!==void 0?Ut:[])}),Bt}function getVerificationMethodTypes({didDocument:kt}){const xt=getVerificationMethods({didDocument:kt}).map(Bt=>Bt.type);return[...new Set(xt)]}function getVerificationRelationshipsById({didDocument:kt,methodId:At}){const xt=[];return Object.keys(DidVerificationRelationship).forEach(Bt=>{if(Array.isArray(kt[Bt])){const Nt=kt[Bt],jt=extractDidFragment(At);Nt.some(Lt=>{const Ht=extractDidFragment(Lt)===jt,Vt=isDidVerificationMethod(Lt)&&extractDidFragment(Lt.id)===jt;return Ht||Vt})&&xt.push(Bt)}}),xt}function isDidVerificationMethod(kt){return!(!kt||typeof kt!="object"||kt===null||!("id"in kt&&"type"in kt&&"controller"in kt)||typeof kt.id!="string"||typeof kt.type!="string"||typeof kt.controller!="string")}function keyBytesToMultibaseId({keyBytes:kt,multicodecCode:At,multicodecName:xt}){const Bt=Multicodec$1.addPrefix({code:At,data:kt,name:xt}),Nt=Convert$1.uint8Array(Bt).toBase58Btc();return Convert$1.base58Btc(Nt).toMultibase()}function multibaseIdToKeyBytes({multibaseKeyId:kt}){try{const At=Convert$1.multibase(kt).toBase58Btc(),xt=Convert$1.base58Btc(At).toUint8Array(),{code:Bt,data:Nt,name:jt}=Multicodec$1.removePrefix({prefixedData:xt});return{keyBytes:Nt,multicodecCode:Bt,multicodecName:jt}}catch{throw new DidError(DidErrorCode.InvalidDid,`Invalid multibase identifier: ${kt}`)}}var __awaiter$b=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class BearerDid{constructor({uri:At,document:xt,metadata:Bt,keyManager:Nt}){this.uri=At,this.document=xt,this.metadata=Bt,this.keyManager=Nt}export(){return __awaiter$b(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let At={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const xt=[];for(let Bt of this.document.verificationMethod){if(!Bt.publicKeyJwk)throw new Error(`Verification method '${Bt.id}' does not contain a public key in JWK format`);const Nt=yield this.keyManager.getKeyUri({key:Bt.publicKeyJwk}),jt=yield this.keyManager.exportKey({keyUri:Nt});xt.push(Object.assign({},jt))}At.privateKeys=xt}return At})}getSigner(At){return __awaiter$b(this,void 0,void 0,function*(){var xt;const Bt=(xt=this.document.verificationMethod)===null||xt===void 0?void 0:xt.find(Ht=>{var Vt,zt;return extractDidFragment(Ht.id)===((Vt=extractDidFragment(At==null?void 0:At.methodId))!==null&&Vt!==void 0?Vt:extractDidFragment((zt=this.document.assertionMethod)===null||zt===void 0?void 0:zt[0]))});if(!(Bt&&Bt.publicKeyJwk))throw new DidError(DidErrorCode.InternalError,"A verification method intended for signing could not be determined from the DID Document");const Nt=yield this.keyManager.getKeyUri({key:Bt.publicKeyJwk}),jt=yield this.keyManager.getPublicKey({keyUri:Nt}),Ut=this.keyManager;return{algorithm:getJoseSignatureAlgorithmFromPublicKey$1(jt),keyId:Bt.id,sign(Ht){return __awaiter$b(this,arguments,void 0,function*({data:Vt}){return yield Ut.sign({data:Vt,keyUri:Nt})})},verify(Ht){return __awaiter$b(this,arguments,void 0,function*({data:Vt,signature:zt}){return yield Ut.verify({data:Vt,key:jt,signature:zt})})}}})}static import(At){return __awaiter$b(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager}){var Nt;const jt=getVerificationMethods({didDocument:xt.document});if(jt.length===0)throw new DidError(DidErrorCode.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let Lt of(Nt=xt.privateKeys)!==null&&Nt!==void 0?Nt:[])yield Bt.importKey({key:Lt});for(let Lt of jt){if(!Lt.publicKeyJwk)throw new Error(`Verification method '${Lt.id}' does not contain a public key in JWK format`);const Ht=yield Bt.getKeyUri({key:Lt.publicKeyJwk});yield Bt.getPublicKey({keyUri:Ht})}return new BearerDid({uri:xt.uri,document:xt.document,metadata:xt.metadata,keyManager:Bt})})}}var __awaiter$a=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DidMethod{static getSigningMethod(At){return __awaiter$a(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(At,xt){return __awaiter$a(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}}var __awaiter$9=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest$1=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};const DEFAULT_GATEWAY_URI$1="https://diddht.tbddev.org",DID_DHT_SPECIFICATION_VERSION=0,DNS_RECORD_TTL=7200,PROPERTY_SEPARATOR=";",VALUE_SEPARATOR=",";var DidDhtRegisteredDidType;(function(kt){kt[kt.Discoverable=0]="Discoverable",kt[kt.Organization=1]="Organization",kt[kt.Government=2]="Government",kt[kt.Corporation=3]="Corporation",kt[kt.LocalBusiness=4]="LocalBusiness",kt[kt.SoftwarePackage=5]="SoftwarePackage",kt[kt.WebApp=6]="WebApp",kt[kt.FinancialInstitution=7]="FinancialInstitution"})(DidDhtRegisteredDidType||(DidDhtRegisteredDidType={}));var DidDhtRegisteredKeyType;(function(kt){kt[kt.Ed25519=0]="Ed25519",kt[kt.secp256k1=1]="secp256k1",kt[kt.secp256r1=2]="secp256r1",kt[kt.X25519=3]="X25519"})(DidDhtRegisteredKeyType||(DidDhtRegisteredKeyType={}));var DidDhtVerificationRelationship;(function(kt){kt.authentication="auth",kt.assertionMethod="asm",kt.capabilityDelegation="del",kt.capabilityInvocation="inv",kt.keyAgreement="agm"})(DidDhtVerificationRelationship||(DidDhtVerificationRelationship={}));const AlgorithmToKeyTypeMap$2={Ed25519:DidDhtRegisteredKeyType.Ed25519,ES256K:DidDhtRegisteredKeyType.secp256k1,ES256:DidDhtRegisteredKeyType.secp256r1,"P-256":DidDhtRegisteredKeyType.secp256r1,secp256k1:DidDhtRegisteredKeyType.secp256k1,secp256r1:DidDhtRegisteredKeyType.secp256r1,X25519:DidDhtRegisteredKeyType.X25519},KeyTypeToDefaultAlgorithmMap={[DidDhtRegisteredKeyType.Ed25519]:"Ed25519",[DidDhtRegisteredKeyType.secp256k1]:"ES256K",[DidDhtRegisteredKeyType.secp256r1]:"ES256",[DidDhtRegisteredKeyType.X25519]:"ECDH-ES+A256KW"};class DidDht extends DidMethod{static create(){return __awaiter$9(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager,options:xt={}}={}){var Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt;if(!((Bt=xt.verificationMethods)===null||Bt===void 0)&&Bt.some(yr=>!(yr.algorithm in AlgorithmToKeyTypeMap$2)))throw new Error("One or more verification method algorithms are not supported");const Xt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt.filter(yr=>"id"in yr).map(yr=>yr.id);if(Xt&&Xt.length!==new Set(Xt).size)throw new Error("One or more verification method IDs are not unique");if(!((jt=xt.services)===null||jt===void 0)&&jt.some(yr=>!yr.id||!yr.type||!yr.serviceEndpoint))throw new Error("One or more services are missing required properties");const tr=yield At.generateKey({algorithm:"Ed25519"}),rr=yield At.getPublicKey({keyUri:tr}),nr=yield DidDhtUtils.identityKeyToIdentifier({identityKey:rr}),ar=Object.assign(Object.assign({id:nr},xt.alsoKnownAs&&{alsoKnownAs:xt.alsoKnownAs}),xt.controllers&&{controller:xt.controllers}),ir=[...(Ut=xt.verificationMethods)!==null&&Ut!==void 0?Ut:[]];ir!=null&&ir.some(yr=>{var Sr;return((Sr=yr.id)===null||Sr===void 0?void 0:Sr.split("#").pop())==="0"})||ir.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const yr of ir){const Sr=yr.id&&yr.id.split("#").pop()==="0"?tr:yield At.generateKey({algorithm:yr.algorithm}),Ar=yield At.getPublicKey({keyUri:Sr});let Dr=(Ht=(Lt=yr.id)!==null&&Lt!==void 0?Lt:Ar.kid)!==null&&Ht!==void 0?Ht:yield computeJwkThumbprint({jwk:Ar});Dr=`${nr}#${extractDidFragment(Dr)}`,(Vt=ar.verificationMethod)!==null&&Vt!==void 0||(ar.verificationMethod=[]),ar.verificationMethod.push({id:Dr,type:"JsonWebKey",controller:(zt=yr.controller)!==null&&zt!==void 0?zt:nr,publicKeyJwk:Ar});for(const Br of(Wt=yr.purposes)!==null&&Wt!==void 0?Wt:[])ar[Br]||(ar[Br]=[]),ar[Br].push(Dr)}(Jt=xt.services)===null||Jt===void 0||Jt.forEach(yr=>{var Sr;(Sr=ar.service)!==null&&Sr!==void 0||(ar.service=[]),yr.id=`${nr}#${yr.id.split("#").pop()}`,ar.service.push(yr)});const lr=new BearerDid({uri:nr,document:ar,metadata:Object.assign({published:!1},xt.types&&{types:xt.types}),keyManager:At});if(!((Qt=xt.publish)!==null&&Qt!==void 0)||Qt){const yr=yield DidDht.publish({did:lr,gatewayUri:xt.gatewayUri});lr.metadata=yr.didDocumentMetadata}return lr})}static import(At){return __awaiter$9(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager}){var Nt;const jt=Did.parse(xt.uri);if((jt==null?void 0:jt.method)!==DidDht.methodName)throw new DidError(DidErrorCode.MethodNotSupported,"Method not supported");const Ut=yield BearerDid.import({portableDid:xt,keyManager:Bt});if(!(!((Nt=Ut.document.verificationMethod)===null||Nt===void 0)&&Nt.some(Lt=>{var Ht;return((Ht=Lt.id)===null||Ht===void 0?void 0:Ht.split("#").pop())==="0"})))throw new DidError(DidErrorCode.InvalidDidDocument,"DID document must contain an Identity Key");return Ut})}static getSigningMethod(At){return __awaiter$9(this,arguments,void 0,function*({didDocument:xt,methodId:Bt="#0"}){var Nt;const jt=Did.parse(xt.id);if(jt&&jt.method!==this.methodName)throw new DidError(DidErrorCode.MethodNotSupported,`Method not supported: ${jt.method}`);const Ut=(Nt=xt.verificationMethod)===null||Nt===void 0?void 0:Nt.find(Lt=>{var Ht,Vt;return extractDidFragment(Lt.id)===((Ht=extractDidFragment(Bt))!==null&&Ht!==void 0?Ht:extractDidFragment((Vt=xt.assertionMethod)===null||Vt===void 0?void 0:Vt[0]))});if(!(Ut&&Ut.publicKeyJwk))throw new DidError(DidErrorCode.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static publish(At){return __awaiter$9(this,arguments,void 0,function*({did:xt,gatewayUri:Bt=DEFAULT_GATEWAY_URI$1}){return yield DidDhtDocument.put({did:xt,gatewayUri:Bt})})}static resolve(At){return __awaiter$9(this,arguments,void 0,function*(xt,Bt={}){var Nt;const jt=(Nt=Bt==null?void 0:Bt.gatewayUri)!==null&&Nt!==void 0?Nt:DEFAULT_GATEWAY_URI$1;try{yield DidDhtUtils.identifierToIdentityKey({didUri:xt});const{didDocument:Ut,didDocumentMetadata:Lt}=yield DidDhtDocument.get({didUri:xt,gatewayUri:jt});return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didDocument:Ut,didDocumentMetadata:Lt})}catch(Ut){if(!(Ut instanceof DidError))throw new Error(Ut);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:Object.assign({error:Ut.code},Ut.message&&{errorMessage:Ut.message})})}})}}DidDht.methodName="dht";class DidDhtDocument{static get(At){return __awaiter$9(this,arguments,void 0,function*({didUri:xt,gatewayUri:Bt}){const Nt=DidDhtUtils.identifierToIdentityKeyBytes({didUri:xt}),jt=yield DidDhtDocument.pkarrGet({gatewayUri:Bt,publicKeyBytes:Nt}),Ut=yield DidDhtUtils.parseBep44GetMessage({bep44Message:jt}),Lt=yield DidDhtDocument.fromDnsPacket({didUri:xt,dnsPacket:Ut});return Lt.didDocumentMetadata.versionId=jt.seq.toString(),Lt})}static put(At){return __awaiter$9(this,arguments,void 0,function*({did:xt,gatewayUri:Bt}){const Nt=yield DidDhtDocument.toDnsPacket({didDocument:xt.document,didMetadata:xt.metadata,authoritativeGatewayUris:[Bt]}),jt=yield DidDhtUtils.createBep44PutMessage({dnsPacket:Nt,publicKeyBytes:DidDhtUtils.identifierToIdentityKeyBytes({didUri:xt.uri}),signer:yield xt.getSigner({methodId:"0"})}),Ut=yield DidDhtDocument.pkarrPut({gatewayUri:Bt,bep44Message:jt});return{didDocument:xt.document,didDocumentMetadata:Object.assign(Object.assign({},xt.metadata),{published:Ut,versionId:jt.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(At){return __awaiter$9(this,arguments,void 0,function*({gatewayUri:xt,publicKeyBytes:Bt}){const Nt=Convert$1.uint8Array(Bt).toBase32Z(),jt=new URL(Nt,xt).href;let Ut;try{if(Ut=yield fetch(jt,{method:"GET"}),!Ut.ok)throw new DidError(DidErrorCode.NotFound,`Pkarr record not found for: ${Nt}`)}catch(Vt){throw Vt instanceof DidError?Vt:new DidError(DidErrorCode.InternalError,`Failed to fetch Pkarr record: ${Vt.message}`)}const Lt=yield Ut.arrayBuffer();if(!Lt)throw new DidError(DidErrorCode.NotFound,`Pkarr record not found for: ${Nt}`);if(Lt.byteLength<72)throw new DidError(DidErrorCode.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${Lt.byteLength}`);if(Lt.byteLength>1072)throw new DidError(DidErrorCode.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${Lt.byteLength}`);return{k:Bt,seq:Number(new DataView(Lt).getBigUint64(64)),sig:new Uint8Array(Lt,0,64),v:new Uint8Array(Lt,72)}})}static pkarrPut(At){return __awaiter$9(this,arguments,void 0,function*({gatewayUri:xt,bep44Message:Bt}){const Nt=Convert$1.uint8Array(Bt.k).toBase32Z(),jt=new URL(Nt,xt).href,Ut=new Uint8Array(Bt.v.length+72);Ut.set(Bt.sig,0),new DataView(Ut.buffer).setBigUint64(Bt.sig.length,BigInt(Bt.seq)),Ut.set(Bt.v,Bt.sig.length+8);let Lt;try{Lt=yield fetch(jt,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:Ut})}catch(Ht){throw new DidError(DidErrorCode.InternalError,`Failed to put Pkarr record for identifier ${Nt}: ${Ht.message}`)}return Lt.ok})}static fromDnsPacket(At){return __awaiter$9(this,arguments,void 0,function*({didUri:xt,dnsPacket:Bt}){var Nt,jt,Ut;const Lt={id:xt},Ht={published:!0},Vt=new Map;for(const zt of(Nt=Bt==null?void 0:Bt.answers)!==null&&Nt!==void 0?Nt:[]){if(zt.type!=="TXT")continue;const Wt=zt.name.split(".")[0].substring(1);switch(!0){case Wt.startsWith("aka"):{const Jt=DidDhtUtils.parseTxtDataToString(zt.data);Lt.alsoKnownAs=Jt.split(VALUE_SEPARATOR);break}case Wt.startsWith("cnt"):{const Jt=DidDhtUtils.parseTxtDataToString(zt.data);Lt.controller=Jt.includes(VALUE_SEPARATOR)?Jt.split(VALUE_SEPARATOR):Jt;break}case Wt.startsWith("k"):{const{id:Jt,t:Qt,k:Xt,c:tr,a:rr}=DidDhtUtils.parseTxtDataToObject(zt.data),nr=Convert$1.base64Url(Xt).toUint8Array(),ar=DidDhtRegisteredKeyType[Number(Qt)];let ir=yield DidDhtUtils.keyConverter(ar).bytesToPublicKey({publicKeyBytes:nr});ir.alg=rr||KeyTypeToDefaultAlgorithmMap[Number(Qt)];const lr=Wt==="k0"?"0":Jt!==void 0?Jt:yield computeJwkThumbprint({jwk:ir});(jt=Lt.verificationMethod)!==null&&jt!==void 0||(Lt.verificationMethod=[]);const yr=`${xt}#${lr}`;Lt.verificationMethod.push({id:yr,type:"JsonWebKey",controller:tr??xt,publicKeyJwk:ir}),Vt.set(Wt,yr);break}case Wt.startsWith("s"):{const Jt=DidDhtUtils.parseTxtDataToObject(zt.data),{id:Qt,t:Xt,se:tr}=Jt,rr=__rest$1(Jt,["id","t","se"]),nr=tr.includes(VALUE_SEPARATOR)?tr.split(VALUE_SEPARATOR):[tr],ar=Object.fromEntries(Object.entries(rr).map(([ir,lr])=>[ir,lr.includes(VALUE_SEPARATOR)?lr.split(VALUE_SEPARATOR):lr]));(Ut=Lt.service)!==null&&Ut!==void 0||(Lt.service=[]),Lt.service.push(Object.assign(Object.assign({},ar),{id:`${xt}#${Qt}`,type:Xt,serviceEndpoint:nr}));break}case Wt.startsWith("typ"):{const{id:Jt}=DidDhtUtils.parseTxtDataToObject(zt.data);Ht.types=Jt.split(VALUE_SEPARATOR).map(Qt=>Number(Qt));break}case Wt.startsWith("did"):{const Jt=ar=>ar.split(VALUE_SEPARATOR).map(ir=>Vt.get(ir)).filter(ir=>typeof ir=="string"),{auth:Qt,asm:Xt,del:tr,inv:rr,agm:nr}=DidDhtUtils.parseTxtDataToObject(zt.data);Qt&&(Lt.authentication=Jt(Qt)),Xt&&(Lt.assertionMethod=Jt(Xt)),tr&&(Lt.capabilityDelegation=Jt(tr)),rr&&(Lt.capabilityInvocation=Jt(rr)),nr&&(Lt.keyAgreement=Jt(nr));break}}}return{didDocument:Lt,didDocumentMetadata:Ht,didResolutionMetadata:{}}})}static toDnsPacket(At){return __awaiter$9(this,arguments,void 0,function*({didDocument:xt,didMetadata:Bt,authoritativeGatewayUris:Nt,previousDidProof:jt}){var Ut,Lt,Ht,Vt,zt;const Wt=[],Jt=[],Qt=new Map,Xt=[],tr=[];if(jt!==void 0){const{signature:ar,previousDid:ir}=jt;yield DidDhtUtils.validatePreviousDidProof({newDid:xt.id,previousDidProof:jt}),Wt.push({type:"TXT",name:"_prv._did.",ttl:DNS_RECORD_TTL,data:`id=${ir};s=${ar}`})}if(xt.alsoKnownAs&&Wt.push({type:"TXT",name:"_aka._did.",ttl:DNS_RECORD_TTL,data:xt.alsoKnownAs.join(VALUE_SEPARATOR)}),xt.controller){const ar=Array.isArray(xt.controller)?xt.controller.join(VALUE_SEPARATOR):xt.controller;Wt.push({type:"TXT",name:"_cnt._did.",ttl:DNS_RECORD_TTL,data:ar})}for(const[ar,ir]of(Lt=(Ut=xt.verificationMethod)===null||Ut===void 0?void 0:Ut.entries())!==null&&Lt!==void 0?Lt:[]){const lr=`k${ar}`;tr.push(lr);let yr=ir.id.split("#").pop();Qt.set(yr,lr);const Sr=ir.publicKeyJwk;if(!(Sr!=null&&Sr.crv&&Sr.crv in AlgorithmToKeyTypeMap$2))throw new DidError(DidErrorCode.InvalidPublicKeyType,`Verification method '${ir.id}' contains an unsupported key type: ${(Ht=Sr==null?void 0:Sr.crv)!==null&&Ht!==void 0?Ht:"undefined"}`);const Ar=DidDhtRegisteredKeyType[Sr.crv],Dr=yield DidDhtUtils.keyConverter(Sr.crv).publicKeyToBytes({publicKey:Sr}),Br=Convert$1.uint8Array(Dr).toBase64Url(),Lr=[`t=${Ar}`,`k=${Br}`];yr!=="0"&&(yield computeJwkThumbprint({jwk:Sr}))!==yr&&Lr.unshift(`id=${yr}`),Sr.alg!==KeyTypeToDefaultAlgorithmMap[Ar]&&Lr.push(`a=${Sr.alg}`),ir.controller!==xt.id&&Lr.push(`c=${ir.controller}`),Wt.push({type:"TXT",name:`_${lr}._did.`,ttl:DNS_RECORD_TTL,data:Lr.join(PROPERTY_SEPARATOR)})}(Vt=xt.service)===null||Vt===void 0||Vt.forEach((ar,ir)=>{const lr=`s${ir}`;Xt.push(lr);let{id:yr,type:Sr,serviceEndpoint:Ar}=ar,Dr=__rest$1(ar,["id","type","serviceEndpoint"]);yr=extractDidFragment(yr),Ar=Array.isArray(Ar)?Ar.join(","):Ar;const Lr=Object.entries(Object.assign({id:yr,t:Sr,se:Ar},Dr)).map(([vr,pr])=>`${vr}=${pr}`).join(PROPERTY_SEPARATOR),Or=DidDhtUtils.chunkDataIfNeeded(Lr);Wt.push({type:"TXT",name:`_${lr}._did.`,ttl:DNS_RECORD_TTL,data:Or})});const rr=[`v=${DID_DHT_SPECIFICATION_VERSION}`];if(tr.length&&rr.push(`vm=${tr.join(VALUE_SEPARATOR)}`),Object.keys(DidVerificationRelationship).forEach(ar=>{var ir;const lr=(ir=xt[ar])===null||ir===void 0?void 0:ir.map(yr=>Qt.get(yr.split("#").pop()));if(lr){const yr=DidDhtVerificationRelationship[ar];rr.push(`${yr}=${lr.join(VALUE_SEPARATOR)}`)}}),Xt.length&&rr.push(`svc=${Xt.join(VALUE_SEPARATOR)}`),!((zt=Bt.types)===null||zt===void 0)&&zt.length){const ir=Bt.types.map(lr=>typeof lr=="string"?DidDhtRegisteredDidType[lr]:lr);Wt.push({type:"TXT",name:"_typ._did.",ttl:DNS_RECORD_TTL,data:`id=${ir.join(VALUE_SEPARATOR)}`})}Wt.push({type:"TXT",name:"_did."+DidDhtDocument.getUniqueDidSuffix(xt.id)+".",ttl:DNS_RECORD_TTL,data:rr.join(PROPERTY_SEPARATOR)});for(const ar of Nt||[])Jt.push({type:"NS",name:"_did."+DidDhtDocument.getUniqueDidSuffix(xt.id)+".",ttl:DNS_RECORD_TTL,data:ar+"."});return{id:0,type:"response",flags:AUTHORITATIVE_ANSWER,answers:[...Wt,...Jt]}})}static getUniqueDidSuffix(At){return At.split(":")[2]}}class DidDhtUtils{static createBep44PutMessage(At){return __awaiter$9(this,arguments,void 0,function*({dnsPacket:xt,publicKeyBytes:Bt,signer:Nt}){const jt=Math.ceil(Date.now()/1e3),Ut=encode$2(xt),Lt=bencode.encode({seq:jt,v:Ut}).subarray(1,-1);if(Lt.length>1e3)throw new DidError(DidErrorCode.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${Lt.length} bytes`);const Ht=yield Nt.sign({data:Lt});return{k:Bt,seq:jt,sig:Ht,v:Ut}})}static identifierToIdentityKey(At){return __awaiter$9(this,arguments,void 0,function*({didUri:xt}){let Bt=DidDhtUtils.identifierToIdentityKeyBytes({didUri:xt});return yield Ed25519.bytesToPublicKey({publicKeyBytes:Bt})})}static identifierToIdentityKeyBytes({didUri:At}){const xt=Did.parse(At);if(!xt)throw new DidError(DidErrorCode.InvalidDid,`Invalid DID URI: ${At}`);if(xt.method!==DidDht.methodName)throw new DidError(DidErrorCode.MethodNotSupported,`Method not supported: ${xt.method}`);let Bt;try{Bt=Convert$1.base32Z(xt.id).toUint8Array()}catch{throw new DidError(DidErrorCode.InvalidPublicKey,"Failed to decode method-specific identifier")}if(Bt.length!==32)throw new DidError(DidErrorCode.InvalidPublicKeyLength,`Invalid public key length: ${Bt.length}`);return Bt}static identityKeyToIdentifier(At){return __awaiter$9(this,arguments,void 0,function*({identityKey:xt}){const Bt=yield Ed25519.publicKeyToBytes({publicKey:xt}),Nt=Convert$1.uint8Array(Bt).toBase32Z();return`did:${DidDht.methodName}:${Nt}`})}static keyConverter(At){const Bt={Ed25519,"P-256":{publicKeyToBytes:Nt=>__awaiter$9(this,[Nt],void 0,function*({publicKey:jt}){const Ut=yield Secp256r1.publicKeyToBytes({publicKey:jt});return yield Secp256r1.compressPublicKey({publicKeyBytes:Ut})}),bytesToPublicKey:Secp256r1.bytesToPublicKey,privateKeyToBytes:Secp256r1.privateKeyToBytes,bytesToPrivateKey:Secp256r1.bytesToPrivateKey},secp256k1:{publicKeyToBytes:Nt=>__awaiter$9(this,[Nt],void 0,function*({publicKey:jt}){const Ut=yield Secp256k1.publicKeyToBytes({publicKey:jt});return yield Secp256k1.compressPublicKey({publicKeyBytes:Ut})}),bytesToPublicKey:Secp256k1.bytesToPublicKey,privateKeyToBytes:Secp256k1.privateKeyToBytes,bytesToPrivateKey:Secp256k1.bytesToPrivateKey},X25519}[At];if(!Bt)throw new DidError(DidErrorCode.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static parseBep44GetMessage(At){return __awaiter$9(this,arguments,void 0,function*({bep44Message:xt}){const Bt=yield Ed25519.bytesToPublicKey({publicKeyBytes:xt.k}),Nt=bencode.encode({seq:xt.seq,v:xt.v}).subarray(1,-1);if(!(yield Ed25519.verify({key:Bt,signature:xt.sig,data:Nt})))throw new DidError(DidErrorCode.InvalidSignature,"Invalid signature for DHT BEP44 message");return decode$1(xt.v)})}static parseTxtDataToObject(At){return this.parseTxtDataToString(At).split(PROPERTY_SEPARATOR).reduce((xt,Bt)=>{const[Nt,jt]=Bt.split("=");return xt[Nt]=jt,xt},{})}static parseTxtDataToString(At){if(typeof At=="string")return At;if(At instanceof Uint8Array)return Convert$1.uint8Array(At).toString();if(Array.isArray(At))return At.map(xt=>this.parseTxtDataToString(xt)).join("");throw new DidError(DidErrorCode.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(At){return __awaiter$9(this,arguments,void 0,function*({newDid:xt,previousDidProof:Bt}){const Nt=yield DidDhtUtils.identifierToIdentityKey({didUri:Bt.previousDid}),jt=DidDhtUtils.identifierToIdentityKeyBytes({didUri:xt}),Ut=Convert$1.base64Url(Bt.signature).toUint8Array();if(!(yield Ed25519.verify({key:Nt,data:jt,signature:Ut})))throw new DidError(DidErrorCode.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(At){if(At.length<=255)return At;const xt=[];for(let Bt=0;Bt<At.length;Bt+=255)xt.push(At.slice(Bt,Bt+255));return xt}}var __awaiter$8=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidIonRegisteredKeyType;(function(kt){kt.Ed25519="Ed25519",kt.secp256k1="secp256k1",kt.secp256r1="secp256r1",kt.X25519="X25519"})(DidIonRegisteredKeyType||(DidIonRegisteredKeyType={}));const AlgorithmToKeyTypeMap$1={Ed25519:DidIonRegisteredKeyType.Ed25519,ES256K:DidIonRegisteredKeyType.secp256k1,ES256:DidIonRegisteredKeyType.secp256r1,"P-256":DidIonRegisteredKeyType.secp256r1,secp256k1:DidIonRegisteredKeyType.secp256k1,secp256r1:DidIonRegisteredKeyType.secp256r1},DEFAULT_GATEWAY_URI="https://ion.tbd.engineering";class DidIon extends DidMethod{static create(){return __awaiter$8(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager,options:xt={}}={}){var Bt,Nt,jt,Ut,Lt,Ht,Vt;if(!((Bt=xt.verificationMethods)===null||Bt===void 0)&&Bt.some(yr=>!(yr.algorithm in AlgorithmToKeyTypeMap$1)))throw new Error("One or more verification method algorithms are not supported");const zt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt.filter(yr=>"id"in yr).map(yr=>yr.id);if(zt&&zt.length!==new Set(zt).size)throw new Error("One or more verification method IDs are not unique");if(!((jt=xt.services)===null||jt===void 0)&&jt.some(yr=>!yr.id||!yr.type||!yr.serviceEndpoint))throw new Error("One or more services are missing required properties");const Wt={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},Jt=[];for(const yr of(Ut=xt.verificationMethods)!==null&&Ut!==void 0?Ut:[Wt]){const Sr=yield At.generateKey({algorithm:yr.algorithm}),Ar=yield At.getPublicKey({keyUri:Sr});Jt.push({id:yr.id,publicKeyJwk:Ar,purposes:(Lt=yr.purposes)!==null&&Lt!==void 0?Lt:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const Qt=yield At.generateKey({algorithm:DidIonRegisteredKeyType.secp256k1}),Xt=yield At.getPublicKey({keyUri:Qt}),tr=yield At.generateKey({algorithm:DidIonRegisteredKeyType.secp256k1}),rr=yield At.getPublicKey({keyUri:tr}),nr=yield DidIonUtils.computeLongFormDidUri({recoveryKey:Xt,updateKey:rr,services:(Ht=xt.services)!==null&&Ht!==void 0?Ht:[],verificationMethods:Jt}),{didDocument:ar,didResolutionMetadata:ir}=yield DidIon.resolve(nr,{gatewayUri:xt.gatewayUri});if(ar===null)throw new Error(`Unable to resolve DID during creation: ${ir==null?void 0:ir.error}`);const lr=new BearerDid({uri:nr,document:ar,metadata:{published:!1,canonicalId:nr.split(":",3).join(":"),recoveryKey:Xt,updateKey:rr},keyManager:At});if(!((Vt=xt.publish)!==null&&Vt!==void 0)||Vt){const yr=yield DidIon.publish({did:lr,gatewayUri:xt.gatewayUri});lr.metadata=yr.didDocumentMetadata}return lr})}static getSigningMethod(At){return __awaiter$8(this,arguments,void 0,function*({didDocument:xt,methodId:Bt}){var Nt;const jt=Did.parse(xt.id);if(jt&&jt.method!==this.methodName)throw new DidError(DidErrorCode.MethodNotSupported,`Method not supported: ${jt.method}`);const Ut=(Nt=xt.verificationMethod)===null||Nt===void 0?void 0:Nt.find(Lt=>{var Ht;return Lt.id===(Bt??((Ht=xt.assertionMethod)===null||Ht===void 0?void 0:Ht[0]))});if(!(Ut&&Ut.publicKeyJwk))throw new DidError(DidErrorCode.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static import(At){return __awaiter$8(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager}){const Nt=Did.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==DidIon.methodName)throw new DidError(DidErrorCode.MethodNotSupported,"Method not supported");return yield BearerDid.import({portableDid:xt,keyManager:Bt})})}static publish(At){return __awaiter$8(this,arguments,void 0,function*({did:xt,gatewayUri:Bt=DEFAULT_GATEWAY_URI}){var Nt,jt,Ut;const Lt=(jt=(Nt=xt.document.verificationMethod)===null||Nt===void 0?void 0:Nt.map(zt=>({id:zt.id,publicKeyJwk:zt.publicKeyJwk,purposes:getVerificationRelationshipsById({didDocument:xt.document,methodId:zt.id})})))!==null&&jt!==void 0?jt:[],Ht=yield DidIonUtils.createIonDocument({services:(Ut=xt.document.service)!==null&&Ut!==void 0?Ut:[],verificationMethods:Lt}),Vt=yield DidIonUtils.constructCreateRequest({ionDocument:Ht,recoveryKey:xt.metadata.recoveryKey,updateKey:xt.metadata.updateKey});try{const zt=DidIonUtils.appendPathToUrl({baseUrl:Bt,path:"/operations"}),Wt=yield fetch(zt,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(Vt)});return{didDocument:xt.document,didDocumentMetadata:Object.assign(Object.assign({},xt.metadata),{published:Wt.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:DidErrorCode.InternalError,errorMessage:`Failed to publish DID document for: ${xt.uri}`}}}})}static resolve(At){return __awaiter$8(this,arguments,void 0,function*(xt,Bt={}){var Nt,jt;const Ut=Did.parse(xt);if(!Ut)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"invalidDid"}});if(Ut.method!==DidIon.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"methodNotSupported"}});const Lt=(Nt=Bt==null?void 0:Bt.gatewayUri)!==null&&Nt!==void 0?Nt:DEFAULT_GATEWAY_URI;try{const Ht=DidIonUtils.appendPathToUrl({baseUrl:Lt,path:`/identifiers/${xt}`}),Vt=yield fetch(Ht);if(!Vt.ok)throw new DidError(DidErrorCode.NotFound,`Unable to find DID document for: ${xt}`);const{didDocument:zt,didDocumentMetadata:Wt}=yield Vt.json();return Object.assign(Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),zt&&{didDocument:zt}),{didDocumentMetadata:Object.assign({published:(jt=Wt==null?void 0:Wt.method)===null||jt===void 0?void 0:jt.published},Wt)})}catch(Ht){if(!(Ht instanceof DidError))throw new Error(Ht);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:Object.assign({error:Ht.code},Ht.message&&{errorMessage:Ht.message})})}})}}DidIon.methodName="ion";class DidIonUtils{static appendPathToUrl({baseUrl:At,path:xt}){const Bt=new URL(At);return Bt.pathname=Bt.pathname.endsWith("/")?Bt.pathname:Bt.pathname+"/",Bt.pathname+=xt.startsWith("/")?xt.substring(1):xt,Bt.toString()}static computeLongFormDidUri(At){return __awaiter$8(this,arguments,void 0,function*({recoveryKey:xt,updateKey:Bt,services:Nt,verificationMethods:jt}){const Ut=yield DidIonUtils.createIonDocument({services:Nt,verificationMethods:jt}),Lt=DidIonUtils.normalizeJwk(xt),Ht=DidIonUtils.normalizeJwk(Bt);return yield IonDid.createLongFormDid({document:Ut,recoveryKey:Lt,updateKey:Ht})})}static constructCreateRequest(At){return __awaiter$8(this,arguments,void 0,function*({ionDocument:xt,recoveryKey:Bt,updateKey:Nt}){return yield IonRequest.createCreateRequest({document:xt,recoveryKey:DidIonUtils.normalizeJwk(Bt),updateKey:DidIonUtils.normalizeJwk(Nt)})})}static createIonDocument(At){return __awaiter$8(this,arguments,void 0,function*({services:xt,verificationMethods:Bt}){var Nt,jt;const Ut=[];for(const Vt of Bt){let zt=(jt=(Nt=Vt.id)!==null&&Nt!==void 0?Nt:Vt.publicKeyJwk.kid)!==null&&jt!==void 0?jt:yield computeJwkThumbprint({jwk:Vt.publicKeyJwk});zt=`${zt.split("#").pop()}`;const Wt={id:zt,publicKeyJwk:DidIonUtils.normalizeJwk(Vt.publicKeyJwk),purposes:Vt.purposes,type:"JsonWebKey2020"};Ut.push(Wt)}const Lt=xt.map(Vt=>Object.assign(Object.assign({},Vt),{id:`${Vt.id.split("#").pop()}`}));return{publicKeys:Ut,services:Lt}})}static normalizeJwk(At){const xt=At.kty;let Bt;if(xt==="EC")Bt={crv:At.crv,kty:At.kty,x:At.x,y:At.y};else if(xt==="oct")Bt={k:At.k,kty:At.kty};else if(xt==="OKP")Bt={crv:At.crv,kty:At.kty,x:At.x};else if(xt==="RSA")Bt={e:At.e,kty:At.kty,n:At.n};else throw new Error(`Unsupported key type: ${xt}`);return Bt}}var __awaiter$7=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DidJwk extends DidMethod{static create(){return __awaiter$7(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager,options:xt={}}={}){var Bt,Nt,jt,Ut;if(xt.algorithm&&xt.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(xt.verificationMethods&&xt.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const Lt=(Ut=(Bt=xt.algorithm)!==null&&Bt!==void 0?Bt:(jt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt[0])===null||jt===void 0?void 0:jt.algorithm)!==null&&Ut!==void 0?Ut:"Ed25519",Ht=yield At.generateKey({algorithm:Lt}),Vt=yield At.getPublicKey({keyUri:Ht}),zt=Convert$1.object(Vt).toBase64Url(),Wt=`did:${DidJwk.methodName}:${zt}`,Qt=(yield DidJwk.resolve(Wt)).didDocument;return new BearerDid({uri:Wt,document:Qt,metadata:{},keyManager:At})})}static getSigningMethod(At){return __awaiter$7(this,arguments,void 0,function*({didDocument:xt}){var Bt;const Nt=Did.parse(xt.id);if(Nt&&Nt.method!==this.methodName)throw new DidError(DidErrorCode.MethodNotSupported,`Method not supported: ${Nt.method}`);const[jt]=(Bt=xt.verificationMethod)!==null&&Bt!==void 0?Bt:[];if(!(jt&&jt.publicKeyJwk))throw new DidError(DidErrorCode.InternalError,"A verification method intended for signing could not be determined from the DID Document");return jt})}static import(At){return __awaiter$7(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager}){const Nt=Did.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==DidJwk.methodName)throw new DidError(DidErrorCode.MethodNotSupported,"Method not supported");const jt=yield BearerDid.import({portableDid:xt,keyManager:Bt});if(jt.document.verificationMethod.length!==1)throw new DidError(DidErrorCode.InvalidDidDocument,"DID document must contain exactly one verification method");return jt})}static resolve(At,xt){return __awaiter$7(this,void 0,void 0,function*(){const Bt=Did.parse(At);let Nt;try{Nt=Convert$1.base64Url(Bt.id).toObject()}catch{}if(!Bt||!Nt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"invalidDid"}});if(Bt.method!==DidJwk.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"methodNotSupported"}});const jt={"@context":["https://www.w3.org/ns/did/v1"],id:Bt.uri},Ut=`${jt.id}#0`;switch(jt.verificationMethod=[{id:Ut,type:"JsonWebKey",controller:jt.id,publicKeyJwk:Nt}],jt.authentication=[Ut],jt.assertionMethod=[Ut],jt.capabilityInvocation=[Ut],jt.capabilityDelegation=[Ut],jt.keyAgreement=[Ut],Nt.use){case"sig":{delete jt.keyAgreement;break}case"enc":{delete jt.authentication,delete jt.assertionMethod,delete jt.capabilityInvocation,delete jt.capabilityDelegation;break}}return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didDocument:jt})})}}DidJwk.methodName="jwk";var __awaiter$6=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},DidKeyRegisteredKeyType;(function(kt){kt.Ed25519="Ed25519",kt.secp256k1="secp256k1",kt.secp256r1="secp256r1",kt.X25519="X25519"})(DidKeyRegisteredKeyType||(DidKeyRegisteredKeyType={}));const DidKeyVerificationMethodType={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},AlgorithmToKeyTypeMap={Ed25519:DidKeyRegisteredKeyType.Ed25519,ES256K:DidKeyRegisteredKeyType.secp256k1,ES256:DidKeyRegisteredKeyType.secp256r1,"P-256":DidKeyRegisteredKeyType.secp256r1,secp256k1:DidKeyRegisteredKeyType.secp256k1,secp256r1:DidKeyRegisteredKeyType.secp256r1,X25519:DidKeyRegisteredKeyType.X25519};class DidKey extends DidMethod{static create(){return __awaiter$6(this,arguments,void 0,function*({keyManager:At=new LocalKeyManager,options:xt={}}={}){var Bt,Nt,jt,Ut;if(xt.algorithm&&xt.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(xt.verificationMethods&&xt.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const Lt=(Ut=(Bt=xt.algorithm)!==null&&Bt!==void 0?Bt:(jt=(Nt=xt.verificationMethods)===null||Nt===void 0?void 0:Nt[0])===null||jt===void 0?void 0:jt.algorithm)!==null&&Ut!==void 0?Ut:"Ed25519",Ht=yield At.generateKey({algorithm:Lt}),Vt=yield At.getPublicKey({keyUri:Ht}),zt=yield DidKeyUtils.publicKeyToMultibaseId({publicKey:Vt}),Wt=`did:${DidKey.methodName}:${zt}`,Qt=(yield DidKey.resolve(Wt,xt)).didDocument;return new BearerDid({uri:Wt,document:Qt,metadata:{},keyManager:At})})}static getSigningMethod(At){return __awaiter$6(this,arguments,void 0,function*({didDocument:xt}){var Bt;const Nt=Did.parse(xt.id);if(Nt&&Nt.method!==this.methodName)throw new DidError(DidErrorCode.MethodNotSupported,`Method not supported: ${Nt.method}`);const[jt]=xt.assertionMethod||[],Ut=(Bt=xt.verificationMethod)===null||Bt===void 0?void 0:Bt.find(Lt=>Lt.id===jt);if(!(Ut&&Ut.publicKeyJwk))throw new DidError(DidErrorCode.InternalError,"A verification method intended for signing could not be determined from the DID Document");return Ut})}static import(At){return __awaiter$6(this,arguments,void 0,function*({portableDid:xt,keyManager:Bt=new LocalKeyManager}){const Nt=Did.parse(xt.uri);if((Nt==null?void 0:Nt.method)!==DidKey.methodName)throw new DidError(DidErrorCode.MethodNotSupported,"Method not supported");const jt=yield BearerDid.import({portableDid:xt,keyManager:Bt});if(jt.document.verificationMethod.length!==1)throw new DidError(DidErrorCode.InvalidDidDocument,"DID document must contain exactly one verification method");return jt})}static resolve(At,xt){return __awaiter$6(this,void 0,void 0,function*(){try{const Bt=yield DidKey.createDocument({didUri:At,options:xt});return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didDocument:Bt})}catch(Bt){if(!(Bt instanceof DidError))throw new Error(Bt);return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:Object.assign({error:Bt.code},Bt.message&&{errorMessage:Bt.message})})}})}static createDocument(At){return __awaiter$6(this,arguments,void 0,function*({didUri:xt,options:Bt={}}){const{defaultContext:Nt="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:jt=!1,enableExperimentalPublicKeyTypes:Ut=!1,publicKeyFormat:Lt="JsonWebKey2020"}=Bt,Ht={id:""},Vt=Did.parse(xt);if(!Vt)throw new DidError(DidErrorCode.InvalidDid,`Invalid DID URI: ${xt}`);const zt=Vt.id;if(Vt.method!==DidKey.methodName)throw new DidError(DidErrorCode.MethodNotSupported,`Method not supported: ${Vt.method}`);if(!DidKey.validateIdentifier(Vt))throw new DidError(DidErrorCode.InvalidDid,`Invalid DID URI: ${xt}`);const Wt=yield DidKey.createSignatureMethod({didUri:xt,multibaseValue:zt,options:{enableExperimentalPublicKeyTypes:Ut,publicKeyFormat:Lt}});if(Ht.id=Vt.uri,Ht.verificationMethod=[Wt],Ht.authentication=[Wt.id],Ht.assertionMethod=[Wt.id],Ht.capabilityInvocation=[Wt.id],Ht.capabilityDelegation=[Wt.id],jt===!0){const Xt=Lt==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",tr=yield this.createEncryptionMethod({didUri:xt,multibaseValue:zt,options:{enableExperimentalPublicKeyTypes:Ut,publicKeyFormat:Xt}});Ht.verificationMethod.push(tr),Ht.keyAgreement=[tr.id]}const Jt=[Nt];return getVerificationMethodTypes({didDocument:Ht}).forEach(Xt=>{const tr=DidKeyVerificationMethodType[Xt];Jt.push(tr)}),Ht["@context"]=Jt,Ht})}static createEncryptionMethod(At){return __awaiter$6(this,arguments,void 0,function*({didUri:xt,multibaseValue:Bt,options:Nt}){const{enableExperimentalPublicKeyTypes:jt,publicKeyFormat:Ut}=Nt,Lt={id:"",type:"",controller:""},{keyBytes:Ht,multicodecCode:Vt}=yield DidKey.deriveEncryptionKey({multibaseValue:Bt}),zt=Ht.byteLength,Wt=DidKeyUtils.MULTICODEC_PUBLIC_KEY_LENGTH[Vt];if(zt!==Wt)throw new DidError(DidErrorCode.InvalidPublicKeyLength,`Expected ${zt} bytes. Actual: ${Wt}`);const Jt=keyBytesToMultibaseId({keyBytes:Ht,multicodecCode:Vt});Lt.id=`${xt}#${Jt}`;try{new URL(Lt.id)}catch{throw new DidError(DidErrorCode.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(Ut in DidKeyVerificationMethodType))throw new DidError(DidErrorCode.UnsupportedPublicKeyType,`Unsupported format: ${Ut}`);if(jt===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(Ut))throw new DidError(DidErrorCode.InvalidPublicKeyType,`Specified '${Ut}' without setting enableExperimentalPublicKeyTypes to true.`);if(Lt.type=Ut,Lt.controller=xt,Ut==="X25519KeyAgreementKey2020"&&(Lt.publicKeyMultibase=Jt),Ut==="JsonWebKey2020"){const{crv:Xt}=yield DidKeyUtils.multicodecToJwk({code:Vt});Lt.publicKeyJwk=yield DidKeyUtils.keyConverter(Xt).bytesToPublicKey({publicKeyBytes:Ht})}return Lt})}static createSignatureMethod(At){return __awaiter$6(this,arguments,void 0,function*({didUri:xt,multibaseValue:Bt,options:Nt}){const{enableExperimentalPublicKeyTypes:jt,publicKeyFormat:Ut}=Nt,Lt={id:"",type:"",controller:""},{keyBytes:Ht,multicodecCode:Vt,multicodecName:zt}=multibaseIdToKeyBytes({multibaseKeyId:Bt}),Wt=Ht.byteLength,Jt=DidKeyUtils.MULTICODEC_PUBLIC_KEY_LENGTH[Vt];if(Wt!==Jt)throw new DidError(DidErrorCode.InvalidPublicKeyLength,`Expected ${Wt} bytes. Actual: ${Jt}`);let Qt=!1;switch(zt){case"secp256k1-pub":Qt=yield Secp256k1.validatePublicKey({publicKeyBytes:Ht});break;case"ed25519-pub":Qt=yield Ed25519.validatePublicKey({publicKeyBytes:Ht});break;case"x25519-pub":Qt=!0;break}if(!Qt)throw new DidError(DidErrorCode.InvalidPublicKey,"Invalid public key detected.");Lt.id=`${xt}#${Bt}`;try{new URL(Lt.id)}catch{throw new DidError(DidErrorCode.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(Ut in DidKeyVerificationMethodType))throw new DidError(DidErrorCode.UnsupportedPublicKeyType,`Unsupported format: ${Ut}`);if(jt===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(Ut))throw new DidError(DidErrorCode.InvalidPublicKeyType,`Specified '${Ut}' without setting enableExperimentalPublicKeyTypes to true.`);if(Lt.type=Ut,Lt.controller=xt,Ut==="Ed25519VerificationKey2020"&&(Lt.publicKeyMultibase=Bt),Ut==="JsonWebKey2020"){const{crv:tr}=yield DidKeyUtils.multicodecToJwk({code:Vt});Lt.publicKeyJwk=yield DidKeyUtils.keyConverter(tr).bytesToPublicKey({publicKeyBytes:Ht})}return Lt})}static deriveEncryptionKey(At){return __awaiter$6(this,arguments,void 0,function*({multibaseValue:xt}){let Bt={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:Nt,multicodecCode:jt}=multibaseIdToKeyBytes({multibaseKeyId:xt});if(jt===237){const Ut=yield DidKeyUtils.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:Nt}),Lt=yield Ed25519.convertPublicKeyToX25519({publicKey:Ut});Bt={keyBytes:yield DidKeyUtils.keyConverter("Ed25519").publicKeyToBytes({publicKey:Lt}),multicodecCode:236}}return Bt})}static validateIdentifier(At){const{method:xt,id:Bt}=At,[Nt]=At.uri.split(":",1);return Nt==="did"&&xt==="key"&&Number("1")>0&&universalTypeOf$1(Bt)==="String"&&Bt.startsWith("z")}}DidKey.methodName="key";class DidKeyUtils{static jwkToMulticodec(At){return __awaiter$6(this,arguments,void 0,function*({jwk:xt}){const Bt=[];xt.crv&&(Bt.push(xt.crv),xt.d?Bt.push("private"):Bt.push("public"));const Nt=Bt.join(":"),jt=DidKeyUtils.JWK_TO_MULTICODEC[Nt];if(jt===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${Nt}'`);return{code:Multicodec$1.getCodeFromName({name:jt}),name:jt}})}static keyCompressor(At){const Bt={"P-256":Secp256r1.compressPublicKey,secp256k1:Secp256k1.compressPublicKey}[At];if(!Bt)throw new DidError(DidErrorCode.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static keyConverter(At){const Bt={Ed25519,"P-256":Secp256r1,secp256k1:Secp256k1,X25519}[At];if(!Bt)throw new DidError(DidErrorCode.InvalidPublicKeyType,`Unsupported curve: ${At}`);return Bt}static multicodecToJwk(At){return __awaiter$6(this,arguments,void 0,function*({code:xt,name:Bt}){if(!(Bt?!xt:xt))throw new Error("Either 'name' or 'code' must be defined, but not both.");Bt=Bt===void 0?Multicodec$1.getNameFromCode({code:xt}):Bt;const Nt=Bt,jt=DidKeyUtils.MULTICODEC_TO_JWK[Nt];if(jt===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},jt)})}static publicKeyToMultibaseId(At){return __awaiter$6(this,arguments,void 0,function*({publicKey:xt}){var Bt;if(!(xt!=null&&xt.crv&&xt.crv in AlgorithmToKeyTypeMap))throw new DidError(DidErrorCode.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(Bt=xt==null?void 0:xt.crv)!==null&&Bt!==void 0?Bt:"undefined"}`);let Nt=yield DidKeyUtils.keyConverter(xt.crv).publicKeyToBytes({publicKey:xt});/^(secp256k1|P-256|P-384|P-521)$/.test(xt.crv)&&(Nt=yield DidKeyUtils.keyCompressor(xt.crv)({publicKeyBytes:Nt}));const{name:jt}=yield DidKeyUtils.jwkToMulticodec({jwk:xt});return keyBytesToMultibaseId({keyBytes:Nt,multicodecName:jt})})}}DidKeyUtils.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};DidKeyUtils.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};DidKeyUtils.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var __awaiter$5=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class DidWeb extends DidMethod{static resolve(At,xt){return __awaiter$5(this,void 0,void 0,function*(){const Bt=Did.parse(At);if(!Bt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"invalidDid"}});if(Bt.method!==DidWeb.methodName)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"methodNotSupported"}});let Nt=`https://${Bt.id.replace(/:/g,"/")}`;Nt=decodeURIComponent(Nt);const jt=Bt.id.includes(":")?`${Nt}/did.json`:`${Nt}/.well-known/did.json`;try{const Ut=yield fetch(jt);if(!Ut.ok)throw new Error("HTTP error status code returned");const Lt=yield Ut.json();return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didDocument:Lt})}catch{return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:"notFound"}})}})}}DidWeb.methodName="web";const DidResolverCacheNoop={get:function(kt){return null},set:function(kt,At){return null},delete:function(kt){return null},clear:function(){return null},close:function(){return null}};var __awaiter$4=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class UniversalResolver{constructor({cache:At,didResolvers:xt}){this.didResolvers=new Map,this.cache=At||DidResolverCacheNoop;for(const Bt of xt)this.didResolvers.set(Bt.methodName,Bt)}resolve(At,xt){return __awaiter$4(this,void 0,void 0,function*(){const Bt=Did.parse(At);if(!Bt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:DidErrorCode.InvalidDid,errorMessage:`Invalid DID URI: ${At}`}});const Nt=this.didResolvers.get(Bt.method);if(!Nt)return Object.assign(Object.assign({},EMPTY_DID_RESOLUTION_RESULT),{didResolutionMetadata:{error:DidErrorCode.MethodNotSupported,errorMessage:`Method not supported: ${Bt.method}`}});const jt=yield this.cache.get(Bt.uri);if(jt)return jt;{const Ut=yield Nt.resolve(Bt.uri,xt);return Ut.didResolutionMetadata.error||(yield this.cache.set(Bt.uri,Ut)),Ut}})}dereference(At,xt){return __awaiter$4(this,void 0,void 0,function*(){const Bt=Did.parse(At);if(!Bt)return{dereferencingMetadata:{error:DidErrorCode.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:Nt,didResolutionMetadata:jt,didDocumentMetadata:Ut}=yield this.resolve(Bt.uri);if(!Nt)return{dereferencingMetadata:{error:jt.error},contentStream:null,contentMetadata:{}};if(!Bt.fragment||Bt.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:Nt,contentMetadata:Ut};const{service:Lt=[],verificationMethod:Ht=[]}=Nt,Vt=new Set([At,Bt.fragment,`#${Bt.fragment}`]);let zt;for(let Wt of Ht)if(Vt.has(Wt.id)){zt=Wt;break}for(let Wt of Lt)if(Vt.has(Wt.id)){zt=Wt;break}return zt?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:zt,contentMetadata:jt}:{dereferencingMetadata:{error:DidErrorCode.NotFound},contentStream:null,contentMetadata:{}}})}}var __awaiter$3=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})};class Web5UserAgent{constructor(At){this._agentDid=At.agentDid,this.crypto=At.cryptoApi,this.did=At.didApi,this.dwn=At.dwnApi,this.identity=At.identityApi,this.keyManager=At.keyManager,this.permissions=At.permissionsApi,this.rpc=At.rpcClient,this.sync=At.syncApi,this.vault=At.agentVault,this.did.agent=this,this.dwn.agent=this,this.identity.agent=this,this.keyManager.agent=this,this.permissions.agent=this,this.sync.agent=this}get agentDid(){if(this._agentDid===void 0)throw new Error('Web5UserAgent: The "agentDid" property is not set. Ensure the agent is properly initialized and a DID is assigned.');return this._agentDid}set agentDid(At){this._agentDid=At}static create({dataPath:At="DATA/AGENT",agentDid:xt,agentVault:Bt,cryptoApi:Nt,didApi:jt,dwnApi:Ut,identityApi:Lt,keyManager:Ht,permissionsApi:Vt,rpcClient:zt,syncApi:Wt}={}){return __awaiter$3(this,void 0,void 0,function*(){return Bt??(Bt=new HdIdentityVault({keyDerivationWorkFactor:21e4,store:new LevelStore({location:`${At}/VAULT_STORE`})})),Nt??(Nt=new AgentCryptoApi),jt??(jt=new AgentDidApi({didMethods:[DidDht,DidJwk],resolverCache:new AgentDidResolverCache({location:`${At}/DID_RESOLVERCACHE`}),store:new DwnDidStore})),Ut??(Ut=new AgentDwnApi({dwn:yield AgentDwnApi.createDwn({dataPath:At,didResolver:jt})})),Lt??(Lt=new AgentIdentityApi({store:new DwnIdentityStore})),Ht??(Ht=new LocalKeyManager$1({keyStore:new DwnKeyStore})),Vt??(Vt=new AgentPermissionsApi),zt??(zt=new Web5RpcClient),Wt??(Wt=new AgentSyncApi({syncEngine:new SyncEngineLevel({dataPath:At})})),new Web5UserAgent({agentDid:xt,agentVault:Bt,cryptoApi:Nt,didApi:jt,dwnApi:Ut,keyManager:Ht,permissionsApi:Vt,identityApi:Lt,rpcClient:zt,syncApi:Wt})})}firstLaunch(){return __awaiter$3(this,void 0,void 0,function*(){return(yield this.vault.isInitialized())===!1})}initialize({password:At,recoveryPhrase:xt,dwnEndpoints:Bt}){return __awaiter$3(this,void 0,void 0,function*(){return xt=yield this.vault.initialize({password:At,recoveryPhrase:xt,dwnEndpoints:Bt}),xt})}processDidRequest(At){return __awaiter$3(this,void 0,void 0,function*(){return this.did.processRequest(At)})}processDwnRequest(At){return __awaiter$3(this,void 0,void 0,function*(){return this.dwn.processRequest(At)})}processVcRequest(At){return __awaiter$3(this,void 0,void 0,function*(){throw new Error("Not implemented")})}sendDidRequest(At){return __awaiter$3(this,void 0,void 0,function*(){throw new Error("Not implemented")})}sendDwnRequest(At){return __awaiter$3(this,void 0,void 0,function*(){return this.dwn.sendRequest(At)})}sendVcRequest(At){return __awaiter$3(this,void 0,void 0,function*(){throw new Error("Not implemented")})}start({password:At}){return __awaiter$3(this,void 0,void 0,function*(){this.vault.isLocked()&&(yield this.vault.unlock({password:At})),this.agentDid=yield this.vault.getDid()})}}var __awaiter$2=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__rest=function(kt,At){var xt={};for(var Bt in kt)Object.prototype.hasOwnProperty.call(kt,Bt)&&At.indexOf(Bt)<0&&(xt[Bt]=kt[Bt]);if(kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Nt=0,Bt=Object.getOwnPropertySymbols(kt);Nt<Bt.length;Nt++)At.indexOf(Bt[Nt])<0&&Object.prototype.propertyIsEnumerable.call(kt,Bt[Nt])&&(xt[Bt[Nt]]=kt[Bt[Nt]]);return xt};class Web5{constructor({agent:At,connectedDid:xt,delegateDid:Bt}){this.agent=At,this.did=new DidApi({agent:At,connectedDid:xt}),this.dwn=new DwnApi({agent:At,connectedDid:xt,delegateDid:Bt}),this.vc=new VcApi({agent:At,connectedDid:xt})}static connect({agent:At,agentVault:xt,connectedDid:Bt,password:Nt,recoveryPhrase:jt,sync:Ut,techPreview:Lt,didCreateOptions:Ht,registration:Vt,walletConnectOptions:zt}={}){var Wt,Jt,Qt;return __awaiter$2(this,void 0,void 0,function*(){let Xt;if(At===void 0){let rr=!1;const nr=yield Web5UserAgent.create({agentVault:xt});At=nr,Nt===void 0&&(Nt="insecure-static-phrase",console.warn("%cSECURITY WARNING:%c You have not set a password, which defaults to a static, guessable value. This significantly compromises the security of your data. Please configure a secure, unique password.","font-weight: bold; color: red;","font-weight: normal; color: inherit;"));const ar=(Jt=(Wt=Lt==null?void 0:Lt.dwnEndpoints)!==null&&Wt!==void 0?Wt:Ht==null?void 0:Ht.dwnEndpoints)!==null&&Jt!==void 0?Jt:["https://dwn.tbddev.org/beta"];(yield nr.firstLaunch())&&(jt=yield nr.initialize({password:Nt,recoveryPhrase:jt,dwnEndpoints:ar})),yield nr.start({password:Nt});const ir=yield nr.identity.connectedIdentity();let lr,yr=[];if(ir)lr=ir;else if(zt){if(Ut==="off")throw new Error("Sync must not be disabled when using WalletConnect");rr=!0;try{const{permissionRequests:Sr}=zt,Ar=__rest(zt,["permissionRequests"]),Dr=Sr.map(({protocolDefinition:vr,permissions:pr})=>WalletConnect.createPermissionRequestForProtocol({definition:vr,permissions:pr??["read","write","delete","query","subscribe"]})),{delegatePortableDid:Br,connectedDid:Lr,delegateGrants:Or}=yield WalletConnect.initClient(Object.assign(Object.assign({},Ar),{permissionRequests:Dr}));lr=yield nr.identity.import({portableIdentity:{portableDid:Br,metadata:{connectedDid:Lr,name:"Default",tenant:Br.uri,uri:Br.uri}}}),yield nr.identity.manage({portableIdentity:yield lr.export()}),yr=yield this.processConnectedGrants({agent:At,delegateDid:Br.uri,grants:Or})}catch(Sr){throw yield this.cleanUpIdentity({identity:lr,userAgent:nr}),new Error(`Failed to connect to wallet: ${Sr.message}`)}}else{const Sr=yield nr.identity.list();Sr.length===0?(rr=!0,lr=yield nr.identity.create({didMethod:"dht",metadata:{name:"Default"},didOptions:{services:[{id:"dwn",type:"DecentralizedWebNode",serviceEndpoint:ar,enc:"#enc",sig:"#sig"}],verificationMethods:[{algorithm:"Ed25519",id:"sig",purposes:["assertionMethod","authentication"]},{algorithm:"secp256k1",id:"enc",purposes:["keyAgreement"]}]}}),yield nr.identity.manage({portableIdentity:yield lr.export()})):lr=Sr[0]}if(Bt=(Qt=lr.metadata.connectedDid)!==null&&Qt!==void 0?Qt:lr.did.uri,Xt=lr.metadata.connectedDid?lr.did.uri:void 0,Vt!==void 0)try{for(const Sr of ar)(yield nr.rpc.getServerInfo(Sr)).registrationRequirements.length!==0&&(yield DwnRegistrar.registerTenant(Sr,At.agentDid.uri),yield DwnRegistrar.registerTenant(Sr,Bt));Vt.onSuccess()}catch(Sr){Vt.onFailure(Sr)}Ut!=="off"&&(rr&&(yield nr.sync.registerIdentity({did:Bt,options:{delegateDid:Xt,protocols:yr}}),zt!==void 0&&(yield nr.sync.sync("pull"))),Ut??(Ut="2m"),nr.sync.startSync({interval:Ut}).catch(Sr=>{console.error(`Sync failed: ${Sr}`)}))}return{web5:new Web5({agent:At,connectedDid:Bt,delegateDid:Xt}),did:Bt,delegateDid:Xt,recoveryPhrase:jt}})}static cleanUpIdentity({identity:At,userAgent:xt}){return __awaiter$2(this,void 0,void 0,function*(){try{yield xt.did.delete({didUri:At.did.uri,tenant:At.metadata.tenant,deleteKey:!0})}catch(Bt){console.error(`Failed to delete DID ${At.did.uri}: ${Bt.message}`)}try{yield xt.identity.delete({didUri:At.did.uri})}catch(Bt){console.error(`Failed to delete Identity ${At.metadata.name}: ${Bt.message}`)}})}static processConnectedGrants({grants:At,agent:xt,delegateDid:Bt}){return __awaiter$2(this,void 0,void 0,function*(){const Nt=new Set;for(const jt of At){const Ut=yield PermissionGrant.parse({connectedDid:Bt,agent:xt,message:jt}),{status:Lt}=yield Ut.store(!0);if(Lt.code!==202)throw new Error(`AgentDwnApi: Failed to process connected grant: ${Lt.detail}`);const Ht=Ut.scope.protocol;Ht&&Nt.add(Ht)}return[...Nt]})}}var __awaiter$1=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,[])).next())})};const DidResolver=new UniversalResolver({didResolvers:[DidDht,DidWeb]}),didUrlRegex=/^https?:\/\/dweb\/([^/]+)\/?(.*)?$/,httpToHttpsRegex=/^http:/,trailingSlashRegex=/\/$/;function importMetaIfSupported(){try{return new Function("return import.meta")()}catch{return}}function getDwnEndpoints(kt){var At,xt;return __awaiter$1(this,void 0,void 0,function*(){const{didDocument:Bt}=yield DidResolver.resolve(kt);let Nt=(xt=(At=Bt==null?void 0:Bt.service)===null||At===void 0?void 0:At.find(jt=>jt.type==="DecentralizedWebNode"))===null||xt===void 0?void 0:xt.serviceEndpoint;return(Array.isArray(Nt)?Nt:[Nt]).filter(jt=>jt.startsWith("http"))})}function handleEvent(kt,At,xt,Bt){return __awaiter$1(this,void 0,void 0,function*(){const Nt=kt.request.url.replace(httpToHttpsRegex,"https:").replace(trailingSlashRegex,""),jt=yield caches.open("drl"),Ut=yield jt.match(Nt);if(Ut){if(!navigator.onLine)return Ut;const Lt=yield Bt==null?void 0:Bt.onCacheCheck(kt,Nt);if(Lt){const Ht=Ut.headers.get("dwn-cache-time");if(Ht&&Date.now()<Number(Ht)+(Number(Lt.ttl)||0))return Ut}}try{if(xt)return yield fetchResource(kt,At,Nt,xt,jt,Bt);{const Lt=yield DidResolver.resolve(At);return new Response(JSON.stringify(Lt),{status:200,headers:{"Content-Type":"application/json"}})}}catch(Lt){return Lt instanceof Response?Lt:(console.log(`Error in DID URL fetch: ${Lt}`),new Response("DID URL fetch error",{status:500}))}})}function fetchResource(kt,At,xt,Bt,Nt,jt){return __awaiter$1(this,void 0,void 0,function*(){const Ut=yield getDwnEndpoints(At);if(!(Ut!=null&&Ut.length))throw new Response("DWeb Node resolution failed: no valid endpoints found.",{status:530});for(const Lt of Ut)try{const Ht=`${Lt.replace(trailingSlashRegex,"")}/${At}/${Bt}`,Vt=yield fetch(Ht,{headers:kt.request.headers});return Vt.ok?((yield jt==null?void 0:jt.onCacheCheck(kt,xt))&&cacheResponse(xt,Ht,Vt,Nt),Vt):(console.log(`DWN endpoint error: ${Vt.status}`),new Response("DWeb Node request failed",{status:Vt.status}))}catch(Ht){return console.log(`DWN endpoint error: ${Ht}`),new Response("DWeb Node request failed: "+Ht,{status:500})}})}function cacheResponse(kt,At,xt,Bt){return __awaiter$1(this,void 0,void 0,function*(){const Nt=xt.clone(),jt=new Headers(Nt.headers);jt.append("dwn-cache-time",Date.now().toString()),jt.append("dwn-composed-url",At);const Ut=new Response(Nt.body,{headers:jt});Bt.put(kt,Ut)})}function installWorker(kt={}){var At,xt,Bt;return __awaiter$1(this,void 0,void 0,function*(){const Nt=self;try{if(typeof ServiceWorkerGlobalScope<"u"&&Nt instanceof ServiceWorkerGlobalScope)Nt.skipWaiting(),Nt.addEventListener("activate",jt=>{jt.waitUntil(Nt.clients.claim())}),Nt.addEventListener("fetch",jt=>{const Ut=jt.request.url.match(didUrlRegex);Ut&&jt.respondWith(handleEvent(jt,Ut[1],Ut[2],kt))});else if(!((At=globalThis==null?void 0:globalThis.navigator)===null||At===void 0)&&At.serviceWorker){if(!(yield navigator.serviceWorker.getRegistration("/"))){const Ut=kt.path||(globalThis.document?(xt=document==null?void 0:document.currentScript)===null||xt===void 0?void 0:xt.src:(Bt=importMetaIfSupported())===null||Bt===void 0?void 0:Bt.url);Ut&&navigator.serviceWorker.register(Ut,{type:"module"}).catch(Lt=>{console.error("DWeb networking feature installation failed: ",Lt)})}}else throw new Error("DWeb networking features are not available for install in this environment")}catch(jt){console.error("Error in installing networking features:",jt)}})}const loaderStyles=`
  .drl-loading-overlay {
    position: fixed;
    inset: 0;
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    color: #fff;
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    z-index: 1000000;
  }

  .drl-loading-overlay > div {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .drl-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
  }

    .drl-loading-spinner div {
      position: relative;
      width: 2em;
      height: 2em;
      margin: 0.1em 0.25em 0 0;
    }
    .drl-loading-spinner div::after,
    .drl-loading-spinner div::before {
      content: '';  
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 0.1em solid #FFF;
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      animation: drl-loading-spinner 2s linear infinite;
    }
    .drl-loading-spinner div::after {
      animation-delay: 1s;
    }

  .drl-loading-overlay span {
    --text-opacity: 2;
    display: flex;
    align-items: center;
    margin: 2em auto 0;
    padding: 0.2em 0.75em 0.25em;
    text-align: center;
    border-radius: 5em;
    background: rgba(255 255 255 / 8%);
    opacity: 0.8;
    transition: opacity 0.3s ease;
    cursor: pointer;
  }

    .drl-loading-overlay span:focus {
      opacity: 1;
    }

    .drl-loading-overlay span:hover {
      opacity: 1;
    }

    .drl-loading-overlay span::before {
      content: " ";
      margin: 0 0.4em 0 0;
      color: red;
      font-size: 65%;
      font-weight: bold;
    }

    .drl-loading-overlay span::after {
      content: "stop";
      display: block;
      font-size: 60%;
      line-height: 0;
      color: rgba(255 255 255 / 60%);
    }

    .drl-loading-overlay.new-tab-overlay span::after {
      content: "close";
    }
  
  @keyframes drl-loading-spinner {
    0% {
      transform: scale(0);
      opacity: 1;
    }
    100% {
      transform: scale(1);
      opacity: 0;
    }
  }
`,tabContent=`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loading DRL...</title>
  <style>
    html, body {
      background-color: #151518;
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    ${loaderStyles}
  </style>
</head>
<body>
  <div class="drl-loading-overlay new-tab-overlay">
    <div class="drl-loading-spinner">
      <div></div>
      Loading DRL
    </div>
    <span onclick="window.close()" tabindex="0"></span>
  </div>
</body>
</html>
`;let elementsInjected=!1;function injectElements(){if(elementsInjected)return;const kt=document.createElement("style");kt.innerHTML=`
    ${loaderStyles}

    .drl-loading-overlay {
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    :root[drl-link-loading] .drl-loading-overlay {
      opacity: 1;
      pointer-events: all;
    }
  `,document.head.append(kt);let At=document.createElement("div");At.classList.add("drl-loading-overlay"),At.innerHTML=`
    <div class="drl-loading-spinner">
      <div></div>
      Loading DRL
    </div> 
    <span tabindex="0"></span>
  `,At.lastElementChild.addEventListener("click",cancelNavigation),document.body.prepend(At),elementsInjected=!0}function cancelNavigation(){document.documentElement.removeAttribute("drl-link-loading"),activeNavigation=null}let activeNavigation,linkFeaturesActive=!1;function addLinkFeatures(){linkFeaturesActive||(document.addEventListener("click",kt=>__awaiter$1(this,void 0,void 0,function*(){let At=kt.target.closest("a");if(At){let xt=At.href;const Bt=xt.match(didUrlRegex);if(Bt){let Nt=Bt[1],jt=Bt[2];const Ut=At.target==="_blank";kt.preventDefault();try{let Lt;Ut?(Lt=window.open("","_blank"),Lt.document.write(tabContent)):(activeNavigation=jt,setTimeout(()=>document.documentElement.setAttribute("drl-link-loading",""),50));const Ht=yield getDwnEndpoints(Nt);if(!Ht.length)throw null;let Vt=`${Ht[0].replace(trailingSlashRegex,"")}/${Nt}/${jt}`;Ut?Lt.closed||(Lt.location.href=Vt):activeNavigation===jt&&(window.location.href=Vt)}catch{throw activeNavigation===jt&&cancelNavigation(),new Error(`DID endpoint resolution failed for the DRL: ${xt}`)}}}})),document.addEventListener("pointercancel",resetContextMenuTarget),document.addEventListener("pointerdown",kt=>__awaiter$1(this,void 0,void 0,function*(){var At;const xt=kt.composedPath()[0];if(kt.pointerType==="mouse"&&kt.button===2||kt.pointerType==="touch"&&kt.isPrimary){if(resetContextMenuTarget(),xt&&(!((At=xt==null?void 0:xt.src)===null||At===void 0)&&At.match(didUrlRegex))){contextMenuTarget=xt,xt.__src__=xt.src;const Bt=xt.src.replace(httpToHttpsRegex,"https:").replace(trailingSlashRegex,""),Ut=(yield(yield caches.open("drl")).match(Bt)).headers.get("dwn-composed-url");Ut&&(xt.src=Ut),xt.addEventListener("pointerup",resetContextMenuTarget,{once:!0})}}else xt===contextMenuTarget&&resetContextMenuTarget()})),linkFeaturesActive=!0)}let contextMenuTarget;function resetContextMenuTarget(kt){return __awaiter$1(this,void 0,void 0,function*(){(kt==null?void 0:kt.type)==="pointerup"&&(yield new Promise(At=>requestAnimationFrame(At))),contextMenuTarget&&(contextMenuTarget.src=contextMenuTarget.__src__,delete contextMenuTarget.__src__,contextMenuTarget=null)})}function activatePolyfills(kt={}){kt.serviceWorker!==!1&&installWorker(kt),typeof window<"u"&&typeof window.document<"u"&&(kt.injectStyles!==!1&&(document.readyState!=="loading"?injectElements():document.addEventListener("DOMContentLoaded",injectElements,{once:!0})),kt.links!==!1&&addLinkFeatures())}function isArrayBufferSlice(kt){return kt.byteOffset!==0||kt.byteLength!==kt.buffer.byteLength}function isAsyncIterable(kt){return typeof kt!="object"||kt===null?!1:typeof kt[Symbol.asyncIterator]=="function"}function universalTypeOf(kt){const xt=Object.prototype.toString.call(kt).match(/\s([a-zA-Z0-9]+)/),[Bt,Nt]=xt;return Nt}var __awaiter=function(kt,At,xt,Bt){function Nt(jt){return jt instanceof xt?jt:new xt(function(Ut){Ut(jt)})}return new(xt||(xt=Promise))(function(jt,Ut){function Lt(zt){try{Vt(Bt.next(zt))}catch(Wt){Ut(Wt)}}function Ht(zt){try{Vt(Bt.throw(zt))}catch(Wt){Ut(Wt)}}function Vt(zt){zt.done?jt(zt.value):Nt(zt.value).then(Lt,Ht)}Vt((Bt=Bt.apply(kt,At||[])).next())})},__asyncValues=function(kt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=kt[Symbol.asyncIterator],xt;return At?At.call(kt):(kt=typeof __values=="function"?__values(kt):kt[Symbol.iterator](),xt={},Bt("next"),Bt("throw"),Bt("return"),xt[Symbol.asyncIterator]=function(){return this},xt);function Bt(jt){xt[jt]=kt[jt]&&function(Ut){return new Promise(function(Lt,Ht){Ut=kt[jt](Ut),Nt(Lt,Ht,Ut.done,Ut.value)})}}function Nt(jt,Ut,Lt,Ht){Promise.resolve(Ht).then(function(Vt){jt({value:Vt,done:Lt})},Ut)}};const textEncoder=new TextEncoder,textDecoder=new TextDecoder;class Convert{constructor(At,xt){this.data=At,this.format=xt}static arrayBuffer(At){return new Convert(At,"ArrayBuffer")}static asyncIterable(At){if(!isAsyncIterable(At))throw new TypeError("Input must be of type AsyncIterable.");return new Convert(At,"AsyncIterable")}static base32Z(At){return new Convert(At,"Base32Z")}static base58Btc(At){return new Convert(At,"Base58Btc")}static base64Url(At){return new Convert(At,"Base64Url")}static bufferSource(At){return new Convert(At,"BufferSource")}static hex(At){if(typeof At!="string")throw new TypeError("Hex input must be a string.");if(At.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Convert(At,"Hex")}static multibase(At){return new Convert(At,"Multibase")}static object(At){return new Convert(At,"Object")}static string(At){return new Convert(At,"String")}static uint8Array(At){return new Convert(At,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return base58btc.baseDecode(this.data).buffer;case"Base64Url":return base64url.baseDecode(this.data).buffer;case"BufferSource":{if(universalTypeOf(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return isArrayBufferSlice(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return __awaiter(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return base32z.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const At=new Uint8Array(this.data);return base58btc.baseEncode(At)}case"Multibase":return this.data.substring(1);case"Uint8Array":return base58btc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const At=new Uint8Array(this.data);return base64url.baseEncode(At)}case"BufferSource":{const At=this.toUint8Array();return base64url.baseEncode(At)}case"Object":{const At=JSON.stringify(this.data),xt=textEncoder.encode(At);return base64url.baseEncode(xt)}case"String":{const At=textEncoder.encode(this.data);return base64url.baseEncode(At)}case"Uint8Array":return base64url.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return __awaiter(this,void 0,void 0,function*(){var At,xt,Bt,Nt;switch(this.format){case"AsyncIterable":{const Ht=[];try{for(var jt=!0,Ut=__asyncValues(this.data),Lt;Lt=yield Ut.next(),At=Lt.done,!At;jt=!0){Nt=Lt.value,jt=!1;const zt=Nt;Ht.push(zt)}}catch(zt){xt={error:zt}}finally{try{!jt&&!At&&(Bt=Ut.return)&&(yield Bt.call(Ut))}finally{if(xt)throw xt.error}}return new Blob(Ht)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const At=Array.from({length:256},(xt,Bt)=>Bt.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const xt=this.toUint8Array();return Convert.uint8Array(xt).toHex()}case"Base64Url":{const xt=this.toUint8Array();return Convert.uint8Array(xt).toHex()}case"Uint8Array":{let xt="";for(let Bt=0;Bt<this.data.length;Bt++)xt+=At[this.data[Bt]];return xt}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const At=base64url.baseDecode(this.data),xt=textDecoder.decode(At);return JSON.parse(xt)}case"String":return JSON.parse(this.data);case"Uint8Array":{const At=textDecoder.decode(this.data);return JSON.parse(At)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return __awaiter(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const At=yield this.toStringAsync();return JSON.parse(At)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return textDecoder.decode(this.data);case"Base64Url":{const At=base64url.baseDecode(this.data);return textDecoder.decode(At)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return textDecoder.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return __awaiter(this,void 0,void 0,function*(){var At,xt,Bt,Nt;switch(this.format){case"AsyncIterable":{let Ht="";try{for(var jt=!0,Ut=__asyncValues(this.data),Lt;Lt=yield Ut.next(),At=Lt.done,!At;jt=!0){Nt=Lt.value,jt=!1;const Vt=Nt;typeof Vt=="string"?Ht+=Vt:Ht+=textDecoder.decode(Vt,{stream:!0})}}catch(Vt){xt={error:Vt}}finally{try{!jt&&!At&&(Bt=Ut.return)&&(yield Bt.call(Ut))}finally{if(xt)throw xt.error}}return Ht+=textDecoder.decode(void 0,{stream:!1}),Ht}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return base32z.baseDecode(this.data);case"Base58Btc":return base58btc.baseDecode(this.data);case"Base64Url":return base64url.baseDecode(this.data);case"BufferSource":{const At=universalTypeOf(this.data);if(At==="Uint8Array")return this.data;if(At==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const At=new Uint8Array(this.data.length/2);for(let xt=0;xt<this.data.length;xt+=2){const Bt=parseInt(this.data.substring(xt,xt+2),16);if(isNaN(Bt))throw new TypeError("Input is not a valid hexadecimal string.");At[xt/2]=Bt}return At}case"Object":{const At=JSON.stringify(this.data);return textEncoder.encode(At)}case"String":return textEncoder.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return __awaiter(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const At=yield this.toArrayBufferAsync();return new Uint8Array(At)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}}class Multicodec{static addPrefix(At){var xt;let{code:Bt,data:Nt,name:jt}=At;if(!(jt?!Bt:Bt))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(Bt=Multicodec.codeToName.has(Bt)?Bt:Multicodec.nameToCode.get(jt),Bt===void 0)throw new Error(`Unsupported multicodec: ${(xt=At.name)!==null&&xt!==void 0?xt:At.code}`);const Ut=encodingLength$4(Bt),Lt=new Uint8Array(Ut+Nt.byteLength);return Lt.set(Nt,Ut),encodeTo(Bt,Lt),Lt}static getCodeFromData(At){const{prefixedData:xt}=At,[Bt,Nt]=decode$5(xt);return Bt}static getCodeFromName(At){const{name:xt}=At,Bt=Multicodec.nameToCode.get(xt);if(Bt===void 0)throw new Error(`Unsupported multicodec: ${xt}`);return Bt}static getNameFromCode(At){const{code:xt}=At,Bt=Multicodec.codeToName.get(xt);if(Bt===void 0)throw new Error(`Unsupported multicodec: ${xt}`);return Bt}static registerCodec(At){Multicodec.codeToName.set(At.code,At.name),Multicodec.nameToCode.set(At.name,At.code)}static removePrefix(At){const{prefixedData:xt}=At,[Bt,Nt]=decode$5(xt),jt=Multicodec.codeToName.get(Bt);if(jt===void 0)throw new Error(`Unsupported multicodec: ${Bt}`);return{code:Bt,data:xt.slice(Nt),name:jt}}}Multicodec.codeToName=new Map;Multicodec.nameToCode=new Map;Multicodec.registerCodec({code:237,name:"ed25519-pub"});Multicodec.registerCodec({code:4864,name:"ed25519-priv"});Multicodec.registerCodec({code:236,name:"x25519-pub"});Multicodec.registerCodec({code:4866,name:"x25519-priv"});Multicodec.registerCodec({code:231,name:"secp256k1-pub"});Multicodec.registerCodec({code:4865,name:"secp256k1-priv"});var __await=function(kt){return this instanceof __await?(this.v=kt,this):new __await(kt)};function buildFormatLongFn(kt){return function(){var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},xt=At.width?String(At.width):kt.defaultWidth,Bt=kt.formats[xt]||kt.formats[kt.defaultWidth];return Bt}}function buildLocalizeFn(kt){return function(At,xt){var Bt=xt!=null&&xt.context?String(xt.context):"standalone",Nt;if(Bt==="formatting"&&kt.formattingValues){var jt=kt.defaultFormattingWidth||kt.defaultWidth,Ut=xt!=null&&xt.width?String(xt.width):jt;Nt=kt.formattingValues[Ut]||kt.formattingValues[jt]}else{var Lt=kt.defaultWidth,Ht=xt!=null&&xt.width?String(xt.width):kt.defaultWidth;Nt=kt.values[Ht]||kt.values[Lt]}var Vt=kt.argumentCallback?kt.argumentCallback(At):At;return Nt[Vt]}}function buildMatchFn(kt){return function(At){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Bt=xt.width,Nt=Bt&&kt.matchPatterns[Bt]||kt.matchPatterns[kt.defaultMatchWidth],jt=At.match(Nt);if(!jt)return null;var Ut=jt[0],Lt=Bt&&kt.parsePatterns[Bt]||kt.parsePatterns[kt.defaultParseWidth],Ht=Array.isArray(Lt)?findIndex(Lt,function(Wt){return Wt.test(Ut)}):findKey(Lt,function(Wt){return Wt.test(Ut)}),Vt;Vt=kt.valueCallback?kt.valueCallback(Ht):Ht,Vt=xt.valueCallback?xt.valueCallback(Vt):Vt;var zt=At.slice(Ut.length);return{value:Vt,rest:zt}}}function findKey(kt,At){for(var xt in kt)if(kt.hasOwnProperty(xt)&&At(kt[xt]))return xt}function findIndex(kt,At){for(var xt=0;xt<kt.length;xt++)if(At(kt[xt]))return xt}function buildMatchPatternFn(kt){return function(At){var xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Bt=At.match(kt.matchPattern);if(!Bt)return null;var Nt=Bt[0],jt=At.match(kt.parsePattern);if(!jt)return null;var Ut=kt.valueCallback?kt.valueCallback(jt[0]):jt[0];Ut=xt.valueCallback?xt.valueCallback(Ut):Ut;var Lt=At.slice(Nt.length);return{value:Ut,rest:Lt}}}function _typeof(kt){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(At){return typeof At}:function(At){return At&&typeof Symbol=="function"&&At.constructor===Symbol&&At!==Symbol.prototype?"symbol":typeof At},_typeof(kt)}function toInteger(kt){if(kt===null||kt===!0||kt===!1)return NaN;var At=Number(kt);return isNaN(At)?At:At<0?Math.ceil(At):Math.floor(At)}function requiredArgs(kt,At){if(At.length<kt)throw new TypeError(kt+" argument"+(kt>1?"s":"")+" required, but only "+At.length+" present")}function toDate(kt){requiredArgs(1,arguments);var At=Object.prototype.toString.call(kt);return kt instanceof Date||_typeof(kt)==="object"&&At==="[object Date]"?new Date(kt.getTime()):typeof kt=="number"||At==="[object Number]"?new Date(kt):((typeof kt=="string"||At==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function addDays(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toInteger(At);return isNaN(Bt)?new Date(NaN):(Bt&&xt.setDate(xt.getDate()+Bt),xt)}function addMonths(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toInteger(At);if(isNaN(Bt))return new Date(NaN);if(!Bt)return xt;var Nt=xt.getDate(),jt=new Date(xt.getTime());jt.setMonth(xt.getMonth()+Bt+1,0);var Ut=jt.getDate();return Nt>=Ut?jt:(xt.setFullYear(jt.getFullYear(),jt.getMonth(),Nt),xt)}function add(kt,At){if(requiredArgs(2,arguments),!At||_typeof(At)!=="object")return new Date(NaN);var xt=At.years?toInteger(At.years):0,Bt=At.months?toInteger(At.months):0,Nt=At.weeks?toInteger(At.weeks):0,jt=At.days?toInteger(At.days):0,Ut=At.hours?toInteger(At.hours):0,Lt=At.minutes?toInteger(At.minutes):0,Ht=At.seconds?toInteger(At.seconds):0,Vt=toDate(kt),zt=Bt||xt?addMonths(Vt,Bt+xt*12):Vt,Wt=jt||Nt?addDays(zt,jt+Nt*7):zt,Jt=Lt+Ut*60,Qt=Ht+Jt*60,Xt=Qt*1e3,tr=new Date(Wt.getTime()+Xt);return tr}function addMilliseconds(kt,At){requiredArgs(2,arguments);var xt=toDate(kt).getTime(),Bt=toInteger(At);return new Date(xt+Bt)}var defaultOptions={};function getDefaultOptions(){return defaultOptions}function getTimezoneOffsetInMilliseconds(kt){var At=new Date(Date.UTC(kt.getFullYear(),kt.getMonth(),kt.getDate(),kt.getHours(),kt.getMinutes(),kt.getSeconds(),kt.getMilliseconds()));return At.setUTCFullYear(kt.getFullYear()),kt.getTime()-At.getTime()}function startOfDay(kt){requiredArgs(1,arguments);var At=toDate(kt);return At.setHours(0,0,0,0),At}var MILLISECONDS_IN_DAY$1=864e5;function differenceInCalendarDays(kt,At){requiredArgs(2,arguments);var xt=startOfDay(kt),Bt=startOfDay(At),Nt=xt.getTime()-getTimezoneOffsetInMilliseconds(xt),jt=Bt.getTime()-getTimezoneOffsetInMilliseconds(Bt);return Math.round((Nt-jt)/MILLISECONDS_IN_DAY$1)}function compareAsc(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toDate(At),Nt=xt.getTime()-Bt.getTime();return Nt<0?-1:Nt>0?1:Nt}var millisecondsInMinute=6e4,millisecondsInHour=36e5;function isDate(kt){return requiredArgs(1,arguments),kt instanceof Date||_typeof(kt)==="object"&&Object.prototype.toString.call(kt)==="[object Date]"}function isValid(kt){if(requiredArgs(1,arguments),!isDate(kt)&&typeof kt!="number")return!1;var At=toDate(kt);return!isNaN(Number(At))}function differenceInCalendarMonths(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toDate(At),Nt=xt.getFullYear()-Bt.getFullYear(),jt=xt.getMonth()-Bt.getMonth();return Nt*12+jt}function differenceInCalendarYears(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toDate(At);return xt.getFullYear()-Bt.getFullYear()}function compareLocalAsc(kt,At){var xt=kt.getFullYear()-At.getFullYear()||kt.getMonth()-At.getMonth()||kt.getDate()-At.getDate()||kt.getHours()-At.getHours()||kt.getMinutes()-At.getMinutes()||kt.getSeconds()-At.getSeconds()||kt.getMilliseconds()-At.getMilliseconds();return xt<0?-1:xt>0?1:xt}function differenceInDays(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toDate(At),Nt=compareLocalAsc(xt,Bt),jt=Math.abs(differenceInCalendarDays(xt,Bt));xt.setDate(xt.getDate()-Nt*jt);var Ut=+(compareLocalAsc(xt,Bt)===-Nt),Lt=Nt*(jt-Ut);return Lt===0?0:Lt}function differenceInMilliseconds(kt,At){return requiredArgs(2,arguments),toDate(kt).getTime()-toDate(At).getTime()}var roundingMap={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function kt(At){return At<0?Math.ceil(At):Math.floor(At)}},defaultRoundingMethod="trunc";function getRoundingMethod(kt){return kt?roundingMap[kt]:roundingMap[defaultRoundingMethod]}function differenceInHours(kt,At,xt){requiredArgs(2,arguments);var Bt=differenceInMilliseconds(kt,At)/millisecondsInHour;return getRoundingMethod(void 0)(Bt)}function differenceInMinutes(kt,At,xt){requiredArgs(2,arguments);var Bt=differenceInMilliseconds(kt,At)/millisecondsInMinute;return getRoundingMethod(void 0)(Bt)}function endOfDay(kt){requiredArgs(1,arguments);var At=toDate(kt);return At.setHours(23,59,59,999),At}function endOfMonth(kt){requiredArgs(1,arguments);var At=toDate(kt),xt=At.getMonth();return At.setFullYear(At.getFullYear(),xt+1,0),At.setHours(23,59,59,999),At}function isLastDayOfMonth(kt){requiredArgs(1,arguments);var At=toDate(kt);return endOfDay(At).getTime()===endOfMonth(At).getTime()}function differenceInMonths(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toDate(At),Nt=compareAsc(xt,Bt),jt=Math.abs(differenceInCalendarMonths(xt,Bt)),Ut;if(jt<1)Ut=0;else{xt.getMonth()===1&&xt.getDate()>27&&xt.setDate(30),xt.setMonth(xt.getMonth()-Nt*jt);var Lt=compareAsc(xt,Bt)===-Nt;isLastDayOfMonth(toDate(kt))&&jt===1&&compareAsc(kt,Bt)===1&&(Lt=!1),Ut=Nt*(jt-Number(Lt))}return Ut===0?0:Ut}function differenceInSeconds(kt,At,xt){requiredArgs(2,arguments);var Bt=differenceInMilliseconds(kt,At)/1e3;return getRoundingMethod(void 0)(Bt)}function differenceInYears(kt,At){requiredArgs(2,arguments);var xt=toDate(kt),Bt=toDate(At),Nt=compareAsc(xt,Bt),jt=Math.abs(differenceInCalendarYears(xt,Bt));xt.setFullYear(1584),Bt.setFullYear(1584);var Ut=compareAsc(xt,Bt)===-Nt,Lt=Nt*(jt-Number(Ut));return Lt===0?0:Lt}function subMilliseconds(kt,At){requiredArgs(2,arguments);var xt=toInteger(At);return addMilliseconds(kt,-xt)}var MILLISECONDS_IN_DAY=864e5;function getUTCDayOfYear(kt){requiredArgs(1,arguments);var At=toDate(kt),xt=At.getTime();At.setUTCMonth(0,1),At.setUTCHours(0,0,0,0);var Bt=At.getTime(),Nt=xt-Bt;return Math.floor(Nt/MILLISECONDS_IN_DAY)+1}function startOfUTCISOWeek(kt){requiredArgs(1,arguments);var At=1,xt=toDate(kt),Bt=xt.getUTCDay(),Nt=(Bt<At?7:0)+Bt-At;return xt.setUTCDate(xt.getUTCDate()-Nt),xt.setUTCHours(0,0,0,0),xt}function getUTCISOWeekYear(kt){requiredArgs(1,arguments);var At=toDate(kt),xt=At.getUTCFullYear(),Bt=new Date(0);Bt.setUTCFullYear(xt+1,0,4),Bt.setUTCHours(0,0,0,0);var Nt=startOfUTCISOWeek(Bt),jt=new Date(0);jt.setUTCFullYear(xt,0,4),jt.setUTCHours(0,0,0,0);var Ut=startOfUTCISOWeek(jt);return At.getTime()>=Nt.getTime()?xt+1:At.getTime()>=Ut.getTime()?xt:xt-1}function startOfUTCISOWeekYear(kt){requiredArgs(1,arguments);var At=getUTCISOWeekYear(kt),xt=new Date(0);xt.setUTCFullYear(At,0,4),xt.setUTCHours(0,0,0,0);var Bt=startOfUTCISOWeek(xt);return Bt}var MILLISECONDS_IN_WEEK$1=6048e5;function getUTCISOWeek(kt){requiredArgs(1,arguments);var At=toDate(kt),xt=startOfUTCISOWeek(At).getTime()-startOfUTCISOWeekYear(At).getTime();return Math.round(xt/MILLISECONDS_IN_WEEK$1)+1}function startOfUTCWeek(kt,At){var xt,Bt,Nt,jt,Ut,Lt,Ht,Vt;requiredArgs(1,arguments);var zt=getDefaultOptions(),Wt=toInteger((xt=(Bt=(Nt=(jt=At==null?void 0:At.weekStartsOn)!==null&&jt!==void 0?jt:At==null||(Ut=At.locale)===null||Ut===void 0||(Lt=Ut.options)===null||Lt===void 0?void 0:Lt.weekStartsOn)!==null&&Nt!==void 0?Nt:zt.weekStartsOn)!==null&&Bt!==void 0?Bt:(Ht=zt.locale)===null||Ht===void 0||(Vt=Ht.options)===null||Vt===void 0?void 0:Vt.weekStartsOn)!==null&&xt!==void 0?xt:0);if(!(Wt>=0&&Wt<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var Jt=toDate(kt),Qt=Jt.getUTCDay(),Xt=(Qt<Wt?7:0)+Qt-Wt;return Jt.setUTCDate(Jt.getUTCDate()-Xt),Jt.setUTCHours(0,0,0,0),Jt}function getUTCWeekYear(kt,At){var xt,Bt,Nt,jt,Ut,Lt,Ht,Vt;requiredArgs(1,arguments);var zt=toDate(kt),Wt=zt.getUTCFullYear(),Jt=getDefaultOptions(),Qt=toInteger((xt=(Bt=(Nt=(jt=At==null?void 0:At.firstWeekContainsDate)!==null&&jt!==void 0?jt:At==null||(Ut=At.locale)===null||Ut===void 0||(Lt=Ut.options)===null||Lt===void 0?void 0:Lt.firstWeekContainsDate)!==null&&Nt!==void 0?Nt:Jt.firstWeekContainsDate)!==null&&Bt!==void 0?Bt:(Ht=Jt.locale)===null||Ht===void 0||(Vt=Ht.options)===null||Vt===void 0?void 0:Vt.firstWeekContainsDate)!==null&&xt!==void 0?xt:1);if(!(Qt>=1&&Qt<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Xt=new Date(0);Xt.setUTCFullYear(Wt+1,0,Qt),Xt.setUTCHours(0,0,0,0);var tr=startOfUTCWeek(Xt,At),rr=new Date(0);rr.setUTCFullYear(Wt,0,Qt),rr.setUTCHours(0,0,0,0);var nr=startOfUTCWeek(rr,At);return zt.getTime()>=tr.getTime()?Wt+1:zt.getTime()>=nr.getTime()?Wt:Wt-1}function startOfUTCWeekYear(kt,At){var xt,Bt,Nt,jt,Ut,Lt,Ht,Vt;requiredArgs(1,arguments);var zt=getDefaultOptions(),Wt=toInteger((xt=(Bt=(Nt=(jt=At==null?void 0:At.firstWeekContainsDate)!==null&&jt!==void 0?jt:At==null||(Ut=At.locale)===null||Ut===void 0||(Lt=Ut.options)===null||Lt===void 0?void 0:Lt.firstWeekContainsDate)!==null&&Nt!==void 0?Nt:zt.firstWeekContainsDate)!==null&&Bt!==void 0?Bt:(Ht=zt.locale)===null||Ht===void 0||(Vt=Ht.options)===null||Vt===void 0?void 0:Vt.firstWeekContainsDate)!==null&&xt!==void 0?xt:1),Jt=getUTCWeekYear(kt,At),Qt=new Date(0);Qt.setUTCFullYear(Jt,0,Wt),Qt.setUTCHours(0,0,0,0);var Xt=startOfUTCWeek(Qt,At);return Xt}var MILLISECONDS_IN_WEEK=6048e5;function getUTCWeek(kt,At){requiredArgs(1,arguments);var xt=toDate(kt),Bt=startOfUTCWeek(xt,At).getTime()-startOfUTCWeekYear(xt,At).getTime();return Math.round(Bt/MILLISECONDS_IN_WEEK)+1}function addLeadingZeros(kt,At){for(var xt=kt<0?"-":"",Bt=Math.abs(kt).toString();Bt.length<At;)Bt="0"+Bt;return xt+Bt}var formatters$1={y:function kt(At,xt){var Bt=At.getUTCFullYear(),Nt=Bt>0?Bt:1-Bt;return addLeadingZeros(xt==="yy"?Nt%100:Nt,xt.length)},M:function kt(At,xt){var Bt=At.getUTCMonth();return xt==="M"?String(Bt+1):addLeadingZeros(Bt+1,2)},d:function kt(At,xt){return addLeadingZeros(At.getUTCDate(),xt.length)},a:function kt(At,xt){var Bt=At.getUTCHours()/12>=1?"pm":"am";switch(xt){case"a":case"aa":return Bt.toUpperCase();case"aaa":return Bt;case"aaaaa":return Bt[0];case"aaaa":default:return Bt==="am"?"a.m.":"p.m."}},h:function kt(At,xt){return addLeadingZeros(At.getUTCHours()%12||12,xt.length)},H:function kt(At,xt){return addLeadingZeros(At.getUTCHours(),xt.length)},m:function kt(At,xt){return addLeadingZeros(At.getUTCMinutes(),xt.length)},s:function kt(At,xt){return addLeadingZeros(At.getUTCSeconds(),xt.length)},S:function kt(At,xt){var Bt=xt.length,Nt=At.getUTCMilliseconds(),jt=Math.floor(Nt*Math.pow(10,Bt-3));return addLeadingZeros(jt,xt.length)}},dayPeriodEnum={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function kt(At,xt,Bt){var Nt=At.getUTCFullYear()>0?1:0;switch(xt){case"G":case"GG":case"GGG":return Bt.era(Nt,{width:"abbreviated"});case"GGGGG":return Bt.era(Nt,{width:"narrow"});case"GGGG":default:return Bt.era(Nt,{width:"wide"})}},y:function kt(At,xt,Bt){if(xt==="yo"){var Nt=At.getUTCFullYear(),jt=Nt>0?Nt:1-Nt;return Bt.ordinalNumber(jt,{unit:"year"})}return formatters$1.y(At,xt)},Y:function kt(At,xt,Bt,Nt){var jt=getUTCWeekYear(At,Nt),Ut=jt>0?jt:1-jt;if(xt==="YY"){var Lt=Ut%100;return addLeadingZeros(Lt,2)}return xt==="Yo"?Bt.ordinalNumber(Ut,{unit:"year"}):addLeadingZeros(Ut,xt.length)},R:function kt(At,xt){var Bt=getUTCISOWeekYear(At);return addLeadingZeros(Bt,xt.length)},u:function kt(At,xt){var Bt=At.getUTCFullYear();return addLeadingZeros(Bt,xt.length)},Q:function kt(At,xt,Bt){var Nt=Math.ceil((At.getUTCMonth()+1)/3);switch(xt){case"Q":return String(Nt);case"QQ":return addLeadingZeros(Nt,2);case"Qo":return Bt.ordinalNumber(Nt,{unit:"quarter"});case"QQQ":return Bt.quarter(Nt,{width:"abbreviated",context:"formatting"});case"QQQQQ":return Bt.quarter(Nt,{width:"narrow",context:"formatting"});case"QQQQ":default:return Bt.quarter(Nt,{width:"wide",context:"formatting"})}},q:function kt(At,xt,Bt){var Nt=Math.ceil((At.getUTCMonth()+1)/3);switch(xt){case"q":return String(Nt);case"qq":return addLeadingZeros(Nt,2);case"qo":return Bt.ordinalNumber(Nt,{unit:"quarter"});case"qqq":return Bt.quarter(Nt,{width:"abbreviated",context:"standalone"});case"qqqqq":return Bt.quarter(Nt,{width:"narrow",context:"standalone"});case"qqqq":default:return Bt.quarter(Nt,{width:"wide",context:"standalone"})}},M:function kt(At,xt,Bt){var Nt=At.getUTCMonth();switch(xt){case"M":case"MM":return formatters$1.M(At,xt);case"Mo":return Bt.ordinalNumber(Nt+1,{unit:"month"});case"MMM":return Bt.month(Nt,{width:"abbreviated",context:"formatting"});case"MMMMM":return Bt.month(Nt,{width:"narrow",context:"formatting"});case"MMMM":default:return Bt.month(Nt,{width:"wide",context:"formatting"})}},L:function kt(At,xt,Bt){var Nt=At.getUTCMonth();switch(xt){case"L":return String(Nt+1);case"LL":return addLeadingZeros(Nt+1,2);case"Lo":return Bt.ordinalNumber(Nt+1,{unit:"month"});case"LLL":return Bt.month(Nt,{width:"abbreviated",context:"standalone"});case"LLLLL":return Bt.month(Nt,{width:"narrow",context:"standalone"});case"LLLL":default:return Bt.month(Nt,{width:"wide",context:"standalone"})}},w:function kt(At,xt,Bt,Nt){var jt=getUTCWeek(At,Nt);return xt==="wo"?Bt.ordinalNumber(jt,{unit:"week"}):addLeadingZeros(jt,xt.length)},I:function kt(At,xt,Bt){var Nt=getUTCISOWeek(At);return xt==="Io"?Bt.ordinalNumber(Nt,{unit:"week"}):addLeadingZeros(Nt,xt.length)},d:function kt(At,xt,Bt){return xt==="do"?Bt.ordinalNumber(At.getUTCDate(),{unit:"date"}):formatters$1.d(At,xt)},D:function kt(At,xt,Bt){var Nt=getUTCDayOfYear(At);return xt==="Do"?Bt.ordinalNumber(Nt,{unit:"dayOfYear"}):addLeadingZeros(Nt,xt.length)},E:function kt(At,xt,Bt){var Nt=At.getUTCDay();switch(xt){case"E":case"EE":case"EEE":return Bt.day(Nt,{width:"abbreviated",context:"formatting"});case"EEEEE":return Bt.day(Nt,{width:"narrow",context:"formatting"});case"EEEEEE":return Bt.day(Nt,{width:"short",context:"formatting"});case"EEEE":default:return Bt.day(Nt,{width:"wide",context:"formatting"})}},e:function kt(At,xt,Bt,Nt){var jt=At.getUTCDay(),Ut=(jt-Nt.weekStartsOn+8)%7||7;switch(xt){case"e":return String(Ut);case"ee":return addLeadingZeros(Ut,2);case"eo":return Bt.ordinalNumber(Ut,{unit:"day"});case"eee":return Bt.day(jt,{width:"abbreviated",context:"formatting"});case"eeeee":return Bt.day(jt,{width:"narrow",context:"formatting"});case"eeeeee":return Bt.day(jt,{width:"short",context:"formatting"});case"eeee":default:return Bt.day(jt,{width:"wide",context:"formatting"})}},c:function kt(At,xt,Bt,Nt){var jt=At.getUTCDay(),Ut=(jt-Nt.weekStartsOn+8)%7||7;switch(xt){case"c":return String(Ut);case"cc":return addLeadingZeros(Ut,xt.length);case"co":return Bt.ordinalNumber(Ut,{unit:"day"});case"ccc":return Bt.day(jt,{width:"abbreviated",context:"standalone"});case"ccccc":return Bt.day(jt,{width:"narrow",context:"standalone"});case"cccccc":return Bt.day(jt,{width:"short",context:"standalone"});case"cccc":default:return Bt.day(jt,{width:"wide",context:"standalone"})}},i:function kt(At,xt,Bt){var Nt=At.getUTCDay(),jt=Nt===0?7:Nt;switch(xt){case"i":return String(jt);case"ii":return addLeadingZeros(jt,xt.length);case"io":return Bt.ordinalNumber(jt,{unit:"day"});case"iii":return Bt.day(Nt,{width:"abbreviated",context:"formatting"});case"iiiii":return Bt.day(Nt,{width:"narrow",context:"formatting"});case"iiiiii":return Bt.day(Nt,{width:"short",context:"formatting"});case"iiii":default:return Bt.day(Nt,{width:"wide",context:"formatting"})}},a:function kt(At,xt,Bt){var Nt=At.getUTCHours(),jt=Nt/12>=1?"pm":"am";switch(xt){case"a":case"aa":return Bt.dayPeriod(jt,{width:"abbreviated",context:"formatting"});case"aaa":return Bt.dayPeriod(jt,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return Bt.dayPeriod(jt,{width:"narrow",context:"formatting"});case"aaaa":default:return Bt.dayPeriod(jt,{width:"wide",context:"formatting"})}},b:function kt(At,xt,Bt){var Nt=At.getUTCHours(),jt;switch(Nt===12?jt=dayPeriodEnum.noon:Nt===0?jt=dayPeriodEnum.midnight:jt=Nt/12>=1?"pm":"am",xt){case"b":case"bb":return Bt.dayPeriod(jt,{width:"abbreviated",context:"formatting"});case"bbb":return Bt.dayPeriod(jt,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return Bt.dayPeriod(jt,{width:"narrow",context:"formatting"});case"bbbb":default:return Bt.dayPeriod(jt,{width:"wide",context:"formatting"})}},B:function kt(At,xt,Bt){var Nt=At.getUTCHours(),jt;switch(Nt>=17?jt=dayPeriodEnum.evening:Nt>=12?jt=dayPeriodEnum.afternoon:Nt>=4?jt=dayPeriodEnum.morning:jt=dayPeriodEnum.night,xt){case"B":case"BB":case"BBB":return Bt.dayPeriod(jt,{width:"abbreviated",context:"formatting"});case"BBBBB":return Bt.dayPeriod(jt,{width:"narrow",context:"formatting"});case"BBBB":default:return Bt.dayPeriod(jt,{width:"wide",context:"formatting"})}},h:function kt(At,xt,Bt){if(xt==="ho"){var Nt=At.getUTCHours()%12;return Nt===0&&(Nt=12),Bt.ordinalNumber(Nt,{unit:"hour"})}return formatters$1.h(At,xt)},H:function kt(At,xt,Bt){return xt==="Ho"?Bt.ordinalNumber(At.getUTCHours(),{unit:"hour"}):formatters$1.H(At,xt)},K:function kt(At,xt,Bt){var Nt=At.getUTCHours()%12;return xt==="Ko"?Bt.ordinalNumber(Nt,{unit:"hour"}):addLeadingZeros(Nt,xt.length)},k:function kt(At,xt,Bt){var Nt=At.getUTCHours();return Nt===0&&(Nt=24),xt==="ko"?Bt.ordinalNumber(Nt,{unit:"hour"}):addLeadingZeros(Nt,xt.length)},m:function kt(At,xt,Bt){return xt==="mo"?Bt.ordinalNumber(At.getUTCMinutes(),{unit:"minute"}):formatters$1.m(At,xt)},s:function kt(At,xt,Bt){return xt==="so"?Bt.ordinalNumber(At.getUTCSeconds(),{unit:"second"}):formatters$1.s(At,xt)},S:function kt(At,xt){return formatters$1.S(At,xt)},X:function kt(At,xt,Bt,Nt){var jt=Nt._originalDate||At,Ut=jt.getTimezoneOffset();if(Ut===0)return"Z";switch(xt){case"X":return formatTimezoneWithOptionalMinutes(Ut);case"XXXX":case"XX":return formatTimezone(Ut);case"XXXXX":case"XXX":default:return formatTimezone(Ut,":")}},x:function kt(At,xt,Bt,Nt){var jt=Nt._originalDate||At,Ut=jt.getTimezoneOffset();switch(xt){case"x":return formatTimezoneWithOptionalMinutes(Ut);case"xxxx":case"xx":return formatTimezone(Ut);case"xxxxx":case"xxx":default:return formatTimezone(Ut,":")}},O:function kt(At,xt,Bt,Nt){var jt=Nt._originalDate||At,Ut=jt.getTimezoneOffset();switch(xt){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(Ut,":");case"OOOO":default:return"GMT"+formatTimezone(Ut,":")}},z:function kt(At,xt,Bt,Nt){var jt=Nt._originalDate||At,Ut=jt.getTimezoneOffset();switch(xt){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(Ut,":");case"zzzz":default:return"GMT"+formatTimezone(Ut,":")}},t:function kt(At,xt,Bt,Nt){var jt=Nt._originalDate||At,Ut=Math.floor(jt.getTime()/1e3);return addLeadingZeros(Ut,xt.length)},T:function kt(At,xt,Bt,Nt){var jt=Nt._originalDate||At,Ut=jt.getTime();return addLeadingZeros(Ut,xt.length)}};function formatTimezoneShort(kt,At){var xt=kt>0?"-":"+",Bt=Math.abs(kt),Nt=Math.floor(Bt/60),jt=Bt%60;if(jt===0)return xt+String(Nt);var Ut=At;return xt+String(Nt)+Ut+addLeadingZeros(jt,2)}function formatTimezoneWithOptionalMinutes(kt,At){if(kt%60===0){var xt=kt>0?"-":"+";return xt+addLeadingZeros(Math.abs(kt)/60,2)}return formatTimezone(kt,At)}function formatTimezone(kt,At){var xt=At||"",Bt=kt>0?"-":"+",Nt=Math.abs(kt),jt=addLeadingZeros(Math.floor(Nt/60),2),Ut=addLeadingZeros(Nt%60,2);return Bt+jt+xt+Ut}var dateLongFormatter=function kt(At,xt){switch(At){case"P":return xt.date({width:"short"});case"PP":return xt.date({width:"medium"});case"PPP":return xt.date({width:"long"});case"PPPP":default:return xt.date({width:"full"})}},timeLongFormatter=function kt(At,xt){switch(At){case"p":return xt.time({width:"short"});case"pp":return xt.time({width:"medium"});case"ppp":return xt.time({width:"long"});case"pppp":default:return xt.time({width:"full"})}},dateTimeLongFormatter=function kt(At,xt){var Bt=At.match(/(P+)(p+)?/)||[],Nt=Bt[1],jt=Bt[2];if(!jt)return dateLongFormatter(At,xt);var Ut;switch(Nt){case"P":Ut=xt.dateTime({width:"short"});break;case"PP":Ut=xt.dateTime({width:"medium"});break;case"PPP":Ut=xt.dateTime({width:"long"});break;case"PPPP":default:Ut=xt.dateTime({width:"full"});break}return Ut.replace("{{date}}",dateLongFormatter(Nt,xt)).replace("{{time}}",timeLongFormatter(jt,xt))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},protectedDayOfYearTokens=["D","DD"],protectedWeekYearTokens=["YY","YYYY"];function isProtectedDayOfYearToken(kt){return protectedDayOfYearTokens.indexOf(kt)!==-1}function isProtectedWeekYearToken(kt){return protectedWeekYearTokens.indexOf(kt)!==-1}function throwProtectedError(kt,At,xt){if(kt==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(At,"`) for formatting years to the input `").concat(xt,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(kt==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(At,"`) for formatting years to the input `").concat(xt,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(kt==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(At,"`) for formatting days of the month to the input `").concat(xt,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(kt==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(At,"`) for formatting days of the month to the input `").concat(xt,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=function kt(At,xt,Bt){var Nt,jt=formatDistanceLocale[At];return typeof jt=="string"?Nt=jt:xt===1?Nt=jt.one:Nt=jt.other.replace("{{count}}",xt.toString()),Bt!=null&&Bt.addSuffix?Bt.comparison&&Bt.comparison>0?"in "+Nt:Nt+" ago":Nt},dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=function kt(At,xt,Bt,Nt){return formatRelativeLocale[At]},eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=function kt(At,xt){var Bt=Number(At),Nt=Bt%100;if(Nt>20||Nt<10)switch(Nt%10){case 1:return Bt+"st";case 2:return Bt+"nd";case 3:return Bt+"rd"}return Bt+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:function kt(At){return At-1}}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})},matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:function kt(At){return parseInt(At,10)}}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:function kt(At){return At+1}}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},locale={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}},formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(kt,At,xt){var Bt,Nt,jt,Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr;requiredArgs(2,arguments);var nr=String(At),ar=getDefaultOptions(),ir=(Bt=(Nt=void 0)!==null&&Nt!==void 0?Nt:ar.locale)!==null&&Bt!==void 0?Bt:locale,lr=toInteger((jt=(Ut=(Lt=(Ht=void 0)!==null&&Ht!==void 0?Ht:void 0)!==null&&Lt!==void 0?Lt:ar.firstWeekContainsDate)!==null&&Ut!==void 0?Ut:(Vt=ar.locale)===null||Vt===void 0||(zt=Vt.options)===null||zt===void 0?void 0:zt.firstWeekContainsDate)!==null&&jt!==void 0?jt:1);if(!(lr>=1&&lr<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var yr=toInteger((Wt=(Jt=(Qt=(Xt=void 0)!==null&&Xt!==void 0?Xt:void 0)!==null&&Qt!==void 0?Qt:ar.weekStartsOn)!==null&&Jt!==void 0?Jt:(tr=ar.locale)===null||tr===void 0||(rr=tr.options)===null||rr===void 0?void 0:rr.weekStartsOn)!==null&&Wt!==void 0?Wt:0);if(!(yr>=0&&yr<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!ir.localize)throw new RangeError("locale must contain localize property");if(!ir.formatLong)throw new RangeError("locale must contain formatLong property");var Sr=toDate(kt);if(!isValid(Sr))throw new RangeError("Invalid time value");var Ar=getTimezoneOffsetInMilliseconds(Sr),Dr=subMilliseconds(Sr,Ar),Br={firstWeekContainsDate:lr,weekStartsOn:yr,locale:ir,_originalDate:Sr},Lr=nr.match(longFormattingTokensRegExp).map(function(Or){var vr=Or[0];if(vr==="p"||vr==="P"){var pr=longFormatters[vr];return pr(Or,ir.formatLong)}return Or}).join("").match(formattingTokensRegExp).map(function(Or){if(Or==="''")return"'";var vr=Or[0];if(vr==="'")return cleanEscapedString(Or);var pr=formatters[vr];if(pr)return isProtectedWeekYearToken(Or)&&throwProtectedError(Or,At,String(kt)),isProtectedDayOfYearToken(Or)&&throwProtectedError(Or,At,String(kt)),pr(Dr,Or,ir.localize,Br);if(vr.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+vr+"`");return Or}).join("");return Lr}function cleanEscapedString(kt){var At=kt.match(escapedStringRegExp);return At?At[1].replace(doubleQuoteRegExp,"'"):kt}var defaultFormat=["years","months","weeks","days","hours","minutes","seconds"];function formatDuration(kt,At){var xt,Bt,Nt,jt,Ut;if(arguments.length<1)throw new TypeError("1 argument required, but only ".concat(arguments.length," present"));var Lt=getDefaultOptions(),Ht=(xt=(Bt=At==null?void 0:At.locale)!==null&&Bt!==void 0?Bt:Lt.locale)!==null&&xt!==void 0?xt:locale,Vt=(Nt=At==null?void 0:At.format)!==null&&Nt!==void 0?Nt:defaultFormat,zt=(jt=At==null?void 0:At.zero)!==null&&jt!==void 0?jt:!1,Wt=(Ut=At==null?void 0:At.delimiter)!==null&&Ut!==void 0?Ut:" ";if(!Ht.formatDistance)return"";var Jt=Vt.reduce(function(Qt,Xt){var tr="x".concat(Xt.replace(/(^.)/,function(nr){return nr.toUpperCase()})),rr=kt[Xt];return typeof rr=="number"&&(zt||kt[Xt])?Qt.concat(Ht.formatDistance(tr,rr)):Qt},[]).join(Wt);return Jt}function intervalToDuration(kt){requiredArgs(1,arguments);var At=toDate(kt.start),xt=toDate(kt.end);if(isNaN(At.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(xt.getTime()))throw new RangeError("End Date is invalid");var Bt={};Bt.years=Math.abs(differenceInYears(xt,At));var Nt=compareAsc(xt,At),jt=add(At,{years:Nt*Bt.years});Bt.months=Math.abs(differenceInMonths(xt,jt));var Ut=add(jt,{months:Nt*Bt.months});Bt.days=Math.abs(differenceInDays(xt,Ut));var Lt=add(Ut,{days:Nt*Bt.days});Bt.hours=Math.abs(differenceInHours(xt,Lt));var Ht=add(Lt,{hours:Nt*Bt.hours});Bt.minutes=Math.abs(differenceInMinutes(xt,Ht));var Vt=add(Ht,{minutes:Nt*Bt.minutes});return Bt.seconds=Math.abs(differenceInSeconds(xt,Vt)),Bt}function canonicalize(kt){var At="";return xt(kt),At;function xt(Bt){if(Bt===null||typeof Bt!="object"||Bt.toJSON!=null)At+=JSON.stringify(Bt);else if(Array.isArray(Bt)){At+="[";let Nt=!1;Bt.forEach(jt=>{Nt&&(At+=","),Nt=!0,xt(jt)}),At+="]"}else{At+="{";let Nt=!1;Object.keys(Bt).sort().forEach(jt=>{Nt&&(At+=","),Nt=!0,At+=JSON.stringify(jt),At+=":",xt(Bt[jt])}),At+="}"}}}const storage={get:(kt,At)=>{let xt=JSON.parse(localStorage.getItem("web5:"+kt));if(xt)return xt;if(At!==void 0)return storage.set(kt,At),At},set:(kt,At)=>(localStorage.setItem("web5:"+kt,JSON.stringify(At)),At),modify:(kt,At)=>{const xt=(void 0).get(kt);return(void 0).set(kt,At(xt))}};function getUserDidOptions(kt){return{services:[{id:"dwn",type:"DecentralizedWebNode",serviceEndpoint:kt||["https://dwn.tbddev.org/beta"],enc:"#enc",sig:"#sig"}],verificationMethods:[{algorithm:"Ed25519",id:"sig",purposes:["assertionMethod","authentication"]},{algorithm:"secp256k1",id:"enc",purposes:["keyAgreement"]}]}}async function registerEndpoints(kt,At,xt=[],Bt){try{for(const Nt of xt)(await kt.rpc.getServerInfo(Nt)).registrationRequirements.length!==0&&(await DwnRegistrar.registerTenant(Nt,kt.agentDid.uri),await DwnRegistrar.registerTenant(Nt,At.did.uri));Bt.onSuccess()}catch(Nt){Bt.onFailure(Nt)}}async function installProtocol(kt,At,xt=!1){console.log(kt);try{let Bt,jt=(await kt.protocols.query({message:{}})).protocols.find(Ut=>At.protocol===Ut.definition.protocol);if(!jt)Bt=At;else if(xt){let Ut=canonicalize(At),Lt=canonicalize((jt==null?void 0:jt.definition)||null);Ut!==Lt&&(Bt=At)}Bt&&await(await kt.protocols.configure({message:{definition:Bt}})).send(kt.connectedDid)}catch(Bt){return console.log("Installation of protocol configuration failed",Bt),!1}return!0}async function generateGrants(kt,At){const xt=await DidJwk$2.create(),Bt=await xt.export();let Nt=await Promise.all(At.map(async jt=>{const{protocolDefinition:Ut,permissionScopes:Lt}=jt;if(console.log(jt),!Lt.every(zt=>"protocol"in zt&&zt.protocol===Ut.protocol))throw new Error("All permission scopes must match the protocol uri they are provided with.");return await installProtocol(kt.dwn,Ut),console.log(Lt),await Oidc.createPermissionGrants(kt.did.connectedDid,xt,kt.agent,Lt).catch(zt=>console.log(zt))})).then(jt=>jt.flat());return{delegateDid:Bt,grants:Nt}}const popupContent=`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connecting...</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
      text-align: center;
      background: #000;
      color: #fff;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .text {
      font-size: 16px;
      color: #333;
    }
    .spinner {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
      font-size: 2em;
    }
      .spinner div {
        position: relative;
        width: 2em;
        height: 2em;
        margin: 0.1em 0.25em 0 0;
      }
      .spinner div::after,
      .spinner div::before {
        content: '';  
        box-sizing: border-box;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 0.1em solid #FFF;
        position: absolute;
        left: 0;
        top: 0;
        opacity: 0;
        animation: spinner 2s linear infinite;
      }
      .spinner div::after {
        animation-delay: 1s;
      }

    @keyframes spinner {
      0% {
        transform: scale(0);
        opacity: 1;
      }
      100% {
        transform: scale(1);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="spinner">
      <div></div>
    </div>
    <div id="message">Locating wallets...</div>
  </div>
</body>
</html>
`;function createPopup(kt={}){const At=kt.width||500,xt=kt.height||600,Bt=(screen.width-At)/2,Nt=(screen.height-xt)/2,jt=window.open("","_blank",`popup=true,width=${At},height=${xt},left=${Bt},top=${Nt}`);return jt.document.write(kt.content||popupContent),jt}function triggerDownload(kt,At,xt="application/json"){const Bt=new Blob([At],{type:xt}),Nt=URL.createObjectURL(Bt),jt=document.createElement("a");jt.href=Nt,jt.download=kt,document.body.append(jt),jt.click(),jt.remove(),URL.revokeObjectURL(Nt)}const inputTypes={email:"email",password:"password"};async function triggerForm(kt,At=document.body){return new Promise(xt=>{createHiddenFrame({appendTo:At,srcdoc:`<body>${Object.keys(kt).reduce((Bt,Nt)=>{const jt=Nt==="password"?"current-password":Nt;return Bt+`<input type="${inputTypes[Nt]||"text"}" name="${Nt}" value="${kt[Nt]}" autocomplete="${jt}">`},'<form action="https://postman-echo.com/post" method="POST">')+"</form>"}<script>document.forms[0].submit();<\/script></body>`,onLoad:Bt=>setTimeout(()=>{Bt.remove(),xt()},100)})})}function createHiddenFrame(kt={}){const At=document.createElement("iframe");return At.style.position="fixed",At.style.bottom="0",At.style.left="0",At.style.width="1px",At.style.height="1px",At.style.zIndex="-1000",kt.onLoad&&At.addEventListener("load",()=>kt.onLoad(At),{once:!0}),kt.onError&&At.addEventListener("error",()=>kt.onError(At),{once:!0}),kt.src?At.src=kt.src:kt.srcdoc&&(At.srcdoc=kt.srcdoc),kt.appendTo&&kt.appendTo.append(At),At}function getJoseSignatureAlgorithmFromPublicKey(kt){const At={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(kt.alg&&Object.values(At).includes(kt.alg))return kt.alg;if(kt.crv&&Object.keys(At).includes(kt.crv))return At[kt.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${kt.alg}, crv=${kt.crv}. Supported 'alg' values: ${Object.values(At).join(", ")}. Supported 'crv' values: ${Object.keys(At).join(", ")}.`)}function randomBytes(kt){return randomBytes$7(kt)}function randomUuid(){return crypto$7.randomUUID()}function randomPin({length:kt}){if(3>kt||kt>10)throw new Error("randomPin() can securely generate a PIN between 3 to 10 digits.");const At=Math.pow(10,kt)-1;let xt;if(kt<=6){const Bt=Math.pow(10,kt);do{const Nt=randomBytes(Math.ceil(kt/2));xt=new DataView(Nt.buffer).getUint16(0,!1)%Bt}while(xt>At)}else{const Bt=Math.pow(10,10);do{const Nt=randomBytes(4);xt=new DataView(Nt.buffer).getUint32(0,!1)%Bt}while(xt>At)}return xt.toString().padStart(kt,"0")}const CryptoUtils={randomPin,randomUuid,randomBytes,getJoseSignatureAlgorithmFromPublicKey};let initialize,connectInstance;const instances={},didLabelRegex=/(?:[^@]*@)?(did:[a-z0-9]+:[a-zA-Z0-9-]+)/;window.addEventListener("load",kt=>{var xt;const At=window.self!==window.top;location.pathname==="/dweb-connect"&&(At||window.opener)&&(window.addEventListener("message",async Bt=>{var Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr;const{type:Nt,did:jt,permissions:Ut}=Bt.data;if(Nt==="dweb-connect-support-request"&&At){const rr=await((Ht=(Lt=DWeb$1.connect)==null?void 0:Lt.onSupportRequest)==null?void 0:Ht.call(Lt,jt).catch(nr=>!1));window.parent.postMessage({type:"dweb-connect-support-response",supported:rr===!1?!1:!!await DWeb$1.identity.get(jt)},Bt.origin)}else if(Nt==="dweb-connect-authorization-request"){if(console.log("Authorization request from: ",Bt.origin),!((Vt=window==null?void 0:window.opener)!=null&&Vt.closed)){let rr,nr;const{authorize:ar}=await((Wt=(zt=DWeb$1.connect)==null?void 0:zt.onAuthorizationRequest)==null?void 0:Wt.call(zt,Bt.origin,jt,Ut,Bt).catch(ir=>{}))||{};if(ar)try{const ir=await DWeb$1.use(jt);({delegateDid:rr,grants:nr}=await generateGrants(ir,Ut).catch(lr=>(console.error(lr),{}))),nr||console.error("Failed to generate grants")}catch(ir){console.log(ir),(Qt=(Jt=DWeb$1.connect)==null?void 0:Jt.onGrantError)==null||Qt.call(Jt,ir.origin,jt,Ut)}(tr=(Xt=DWeb$1.connect)==null?void 0:Xt.onAuthorizationComplete)==null||tr.call(Xt,Bt.origin,jt,Ut,nr),window.opener.postMessage({type:"dweb-connect-authorization-response",delegateDid:rr,grants:nr},Bt.origin)}window.close()}}),(xt=window.opener)==null||xt.postMessage({type:"dweb-connect-loaded"},"*"))});window.addEventListener("beforeunload",()=>DWeb$1.connect.abort());async function getAgent(){return DWeb$1.initialize({portableAgent:!1})}async function getPortableDid(kt){var At;return((At=kt==null?void 0:kt.export)==null?void 0:At.call(kt))||kt}async function importIdentity(kt,At,xt=!1){var jt;const Bt=(jt=At==null?void 0:At.portableDid)==null?void 0:jt.uri;if(!await kt.identity.get({didUri:Bt})){let Ut=await kt.identity.import({portableIdentity:At});return xt?await kt.identity.manage({portableIdentity:At}):Ut}}const DWeb$1=globalThis.DWeb={storage,async initialize(kt={}){return initialize||(initialize=new Promise(async At=>{let xt=storage.get("agentDid");xt||(kt.portableAgent!==!1?xt=await DidDht$2.create({options:getUserDidOptions(kt.dwnEndpoints)}):xt=await DidJwk$2.create({options:{algorithm:"Ed25519"}}),xt=await xt.export(),storage.set("agentDid",xt));let Bt=await BearerDid$2.import({portableDid:xt});(DWeb$1.agent=await Web5UserAgent.create({agentDid:Bt})).sync.startSync({interval:kt.syncInterval||"2m"}).catch(jt=>{console.error(`Sync failed: ${jt}`)}),At(DWeb$1.agent)}))},did:{async update(kt,At){if(!At)throw"You must pass in a function that modifies a copy of the DID Document, or an already modified DID Document.";typeof kt=="string"&&(kt=await(await getAgent()).identity.get({didUri:kt}));let xt=kt.did.document,Bt=At;typeof At=="function"&&(Bt=structuredClone(kt.did.document),await At(Bt)),kt.did.document=Bt;try{return await DidDht$2.publish({did:kt.did})}catch{throw kt.did.document=xt,"Failed to update DID Document"}}},identity:{async create(kt={}){var Nt;const At=await getAgent(),xt=kt.dwnEndpoints||["https://dwn.tbddev.org/latest"],Bt=await At.identity.create({didMethod:kt.method||"dht",metadata:{name:"Default"},didOptions:getUserDidOptions(xt)});return kt.cache!==!1&&await At.identity.manage({portableIdentity:await Bt.export()}),kt.registration!==void 0&&xt&&await registerEndpoints(At,Bt,xt,kt.registration).catch(jt=>console.log("Endpoint registration failed: ",jt)),Bt.connectedDid=((Nt=Bt.metadata)==null?void 0:Nt.connectedDid)||Bt.did.uri,Bt},async list(){const kt=await(await getAgent()).identity.list();return kt.forEach(At=>{var xt;At.connectedDid=((xt=At.metadata)==null?void 0:xt.connectedDid)||At.did.uri}),kt},async get(kt){var xt;const At=await(await getAgent()).identity.get({didUri:kt});if(At)return At.connectedDid=((xt=At==null?void 0:At.metadata)==null?void 0:xt.connectedDid)||At.did.uri,At},uriFrom(kt){var At,xt;return((At=kt==null?void 0:kt.metadata)==null?void 0:At.connectedDid)||((xt=kt==null?void 0:kt.did)==null?void 0:xt.uri)||(kt==null?void 0:kt.uri)||kt},async addAutofillDid(kt){await triggerForm({email:kt})},async backup(kt,At={}){const xt=await getPortableDid(kt);!At.to||At.to==="file"?triggerDownload(kt.did.uri.replace(/:/g,"+"),JSON.stringify(xt,null,2)):console.warn(`The mechanism to backup to ${At.to} is not yet implemented`)},async restore(kt={}){const At=[],xt=await getAgent();return new Promise(async(Bt,Nt)=>{var jt;if(!kt.from||kt.from==="file")try{await Promise.all((jt=kt==null?void 0:kt.files)==null?void 0:jt.map(Ut=>new Promise(Lt=>{const Ht=new FileReader;Ht.onload=async Vt=>{const zt=JSON.parse(Vt.target.result),Wt=await importIdentity(xt,zt,!0).catch(Jt=>console.log(Jt));Wt&&At.push(Wt),Lt()},Ht.readAsText(Ut)}))),Bt(At)}catch(Ut){Nt(Ut)}else console.warn(`The mechanism to restore from ${kt.from} is not yet implemented`)})}},async use(kt,At={}){var Nt,jt,Ut;const xt=(Nt=kt==null?void 0:kt.metadata)!=null&&Nt.connectedDid?kt.did.uri:void 0,Bt=((jt=kt==null?void 0:kt.metadata)==null?void 0:jt.connectedDid)||((Ut=kt==null?void 0:kt.did)==null?void 0:Ut.uri)||(kt==null?void 0:kt.uri)||kt;return instances[Bt]||(instances[Bt]=new Promise(async Lt=>{const Ht=await getAgent();await DWeb$1.identity.get(xt||Bt)||await Ht.identity.manage({portableIdentity:await getPortableDid(kt)});const zt=new Web5({agent:Ht,connectedDid:Bt,delegateDid:xt});At.sync!==!1&&(await Ht.sync.getIdentityOptions(Bt)||await Ht.sync.registerIdentity({did:Bt})),Lt(zt)}))},dispose(kt){((kt==null?void 0:kt.agent)||kt).sync.stopSync(),delete instances[kt.connectedDid]},connect:{abort:kt=>{connectInstance&&(clearInterval(connectInstance.interval),window.removeEventListener("message",connectInstance.listener),kt!==!1&&connectInstance.reject(),connectInstance.window.close(),connectInstance=null)},attachInput(kt,At={}){if(kt._dweb_connect)return;const xt=kt._dweb_connect={event:At.event||"change",listener:async Bt=>{var Ut,Lt,Ht,Vt,zt,Wt;const jt=(Ht=(Lt=(Ut=(Bt.target.closest("input")||Bt.composedPath().find(Jt=>Jt.tagName==="INPUT")||kt).value)==null?void 0:Ut.match)==null?void 0:Lt.call(Ut,didLabelRegex))==null?void 0:Ht[1];if(!jt)(Vt=At==null?void 0:At.onError)==null||Vt.call(At,"Invalid DID");else if(connectInstance)connectInstance.window.focus();else{kt.setAttribute("dweb-connect-active","");try{const Jt=await DWeb$1.connect.webWallet(jt,Bt,At);(zt=At==null?void 0:At.onConnect)==null||zt.call(At,...Jt)}catch(Jt){(Wt=At==null?void 0:At.onError)==null||Wt.call(At,Jt)}kt.removeAttribute("dweb-connect-active")}}};kt.addEventListener(xt.event,xt.listener)},detachInput(kt){kt._dweb_connect&&(kt.removeAttribute("dweb-connect-active"),kt.removeEventListener(kt._dweb_connect.event,kt._dweb_connect.listener),delete kt._dweb_connect)},async webWallet(kt,At,xt={}){return new Promise(async(Nt,jt)=>{if(connectInstance)throw connectInstance.window.focus(),"An attempt to connect to a web wallet is already in progress";if(!At.isTrusted)throw"Connecting to a web wallet must be initiated by a user action";connectInstance={window:createPopup(),reject:jt};const Ut=xt.onProgress,Lt=await fetch(`https://dweb/${kt}/read/protocols/${Convert.string("https://areweweb5yet.com/protocols/profile").toBase64Url()}/connect`).then(Xt=>Xt.json()).catch(Xt=>{}),Ht=Lt==null?void 0:Lt.webWallets;if(!(Ht!=null&&Ht.length)){jt("No wallets found for "+kt);return}connectInstance.window.message.textContent="Wallets found. Attempting to connect...",Ut==null||Ut({stage:"wallets-found",wallets:Ht});const Vt=await Promise.any(Ht.reduce((Xt,tr)=>{const rr=new URL(tr);return rr.protocol.match("http")&&Xt.push(new Promise(async(nr,ar)=>{createHiddenFrame({appendTo:document.body,src:rr.origin+"/dweb-connect",onLoad:ir=>{window.addEventListener("message",lr=>{lr.origin===rr.origin&&lr.data.type==="dweb-connect-support-response"&&(ir.remove(),lr.data.supported?nr(rr.origin):ar())}),ir.contentWindow.postMessage({type:"dweb-connect-support-request",did:kt},rr.origin),setTimeout(()=>{ir.remove(),ar()},1e4)},onError:ir=>{ir.remove(),ar()}})})),Xt},[])).catch(Xt=>null);if(!Vt){jt("No wallet was able to provide connection support for "+kt);return}let zt=!1;async function Wt(Xt){const{type:tr,delegateDid:rr,grants:nr}=Xt.data;if(Xt.origin===Vt){if(tr==="dweb-connect-loaded")zt=!0,connectInstance.window.postMessage({type:"dweb-connect-authorization-request",did:kt,permissions:xt.permissions},Vt);else if(tr==="dweb-connect-authorization-response")if(DWeb$1.connect.abort(!1),nr){const ar=await getAgent(),ir=await ar.identity.import({portableIdentity:{portableDid:rr,metadata:{connectedDid:kt,name:"Default",tenant:rr.uri,uri:rr.uri}}});await ar.identity.manage({portableIdentity:await ir.export()});const lr=await Web5.processConnectedGrants({grants:nr,agent:ar,delegateDid:rr.uri});await ar.sync.getIdentityOptions(kt)||await ar.sync.registerIdentity({did:kt,options:{delegateDid:rr.uri,protocols:lr}}),await ar.sync.sync("pull"),Nt({did:kt,delegateDid:rr,grants:nr})}else jt("Authorization rejected for connection request to "+kt)}}window.addEventListener("message",Wt);let Jt=0;const Qt=500;connectInstance.interval=setInterval(()=>{var Xt;Jt+=Qt,((Xt=connectInstance==null?void 0:connectInstance.window)!=null&&Xt.closed||!zt&&Jt>1e4)&&DWeb$1.connect.abort()},Qt),Ut==null||Ut({stage:"requesting-authorization",walletDomain:Vt}),connectInstance.window.location.href=Vt+"/dweb-connect"}).finally(()=>{DWeb$1.connect.abort()})},async oidcConnect(kt,At){const xt=CryptoUtils.randomPin({length:4}),Bt=await getAgent();return await Oidc.submitAuthResponse(kt,At,xt,Bt),xt}}};class AppChannel{static channels={};constructor(At,xt={}){this.name=At,this.sender=new BroadcastChannel(At),this.receiver=new BroadcastChannel(At),this.receiver.addEventListener("message",Bt=>{this.data=Bt.data})}publish(At){this.data=At,this.sender.postMessage(At)}subscribe(At){this.receiver.addEventListener("message",At),this.data!==void 0&&At({data:this.data})}unsubscribe(At){this.receiver.removeEventListener("message",At)}close(){delete AppChannel.channels[this.name],this.sender.close(),this.receiver.close()}}class PageChannel{static channels={};constructor(At,xt={}){this.name=At,this.listeners=new Set}publish(At){this.data=At,this.listeners.forEach(xt=>xt({data:At}))}subscribe(At){this.listeners.add(At),this.data!==void 0&&At({data:this.data})}unsubscribe(At){this.listeners.delete(At)}}const channels={page:{get(kt,At={}){return PageChannel.channels[kt]||(PageChannel.channels[kt]=new PageChannel(kt))}},app:{get(kt,At={}){return AppChannel.channels[kt]||(AppChannel.channels[kt]=new AppChannel(kt))}}},State=kt=>class extends kt{constructor(){super(),this.constructor.properties={...super.constructor.properties,...this.constructor.properties},Object.entries(this.constructor.properties||{}).forEach(([At,xt])=>{if(xt.store&&!xt._channel){const Bt=xt._channel=(xt.store==="app"?channels.app:channels.page).get(At,{store:!0});Bt.data!==void 0&&(this[At]=Bt.data),Bt.subscribe(Nt=>{Nt.data!==this[At]&&(this[At]=Nt.data)})}})}willUpdate(At){if(!this.constructor._willUpdateRunning)return this.constructor._willUpdateRunning=!0,At.forEach((xt,Bt)=>{var Ut,Lt;const Nt=(Lt=(Ut=this.constructor)==null?void 0:Ut.properties)==null?void 0:Lt[Bt];let jt=this[Bt];Nt&&Nt.store&&jt!==Nt._channel.data&&Nt._channel.publish(jt)}),super.willUpdate(At)}updated(At){super.updated(At),this.constructor._willUpdateRunning=!1}},Query=kt=>{var At,xt,bs,Nt;return Nt=class extends kt{constructor(){super();Fn(this,xt);Fn(this,At,new Map);if(this.constructor.query)for(const[Ut,Lt]of Object.entries(this.constructor.query)){let Ht,Vt;typeof Lt=="string"?(Ht=Lt,Vt=!1):[Ht,Vt]=Lt,Object.defineProperty(this,Ut,{get:()=>An(this,xt,bs).call(this,Ut,Ht,Vt),enumerable:!0,configurable:!0})}}},At=new WeakMap,xt=new WeakSet,bs=function(Ut,Lt,Ht){if(Ht&&rn(this,At).has(Ut))return rn(this,At).get(Ut);const Vt=this.renderRoot.querySelector(Lt);return Ht&&Vt&&rn(this,At).set(Ut,Vt),Vt},Nt},DOM$1=globalThis.DOM={ready:new Promise(kt=>{document.addEventListener("DOMContentLoaded",At=>{document.documentElement.setAttribute("ready",""),kt(At)})}),delay:kt=>new Promise(At=>setTimeout(At,kt)),query:kt=>document.querySelector(kt),queryAll:kt=>document.querySelectorAll(kt),skipFrame:kt=>new Promise(At=>requestAnimationFrame(()=>{requestAnimationFrame(()=>{kt&&kt(),At()})})),wait:kt=>new Promise(At=>setTimeout(()=>At(),kt)),fireEvent(kt,At,xt={}){return kt.dispatchEvent(new CustomEvent(At,Object.assign({bubbles:!0,composed:!0},xt)))},addEventDelegate(kt,At,xt,Bt={}){let Nt=jt=>{const Ut=jt.composedPath?jt.composedPath()[0]:jt.target;let Lt=Ut.closest(At);Lt&&(!Bt.avoid||!Ut.closest(Bt.avoid))&&xt(jt,Lt)};return(Bt.container||document).addEventListener(kt,Nt,Bt),Nt},removeEventDelegate(kt,At,xt={}){(xt.container||document).removeEventListener(kt,At)},getQueryParams(kt){const At={};return new URLSearchParams(kt||location.search).forEach((xt,Bt)=>{At[Bt]?At[Bt].push(xt):At[Bt]=[xt]}),At},debounce(kt,At=50){let xt=null,Bt=null,Nt=null;const jt=()=>{kt.apply(Nt,Bt),xt=null};return function(...Ut){Bt=Ut,Nt=this,xt=xt||setTimeout(jt,At)}}},pressedElements=[];document.addEventListener("pointerdown",kt=>{const At=kt.composedPath(),xt=At.find(Bt=>{var Nt;return(Nt=Bt==null?void 0:Bt.matches)==null?void 0:Nt.call(Bt,"[pressable]")})||At[0];xt.setAttribute("pressed",""),pressedElements.push(xt)},{passive:!0,capture:!0});window.addEventListener("pointerup",kt=>{pressedElements.forEach(At=>At.removeAttribute("pressed")),pressedElements.length=0},{passive:!0,capture:!0});const transitionDuration=300,SpinnerStyles=i$7`
  .spinner-mixin {
    --inset: 0;
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    background: var(--body-bk);
    inset: var(--inset);
    opacity: 0;
    transition: opacity ${transitionDuration}ms ease;
    z-index: 1000;
    pointer-events: none;
  }

  .spinner-mixin[spinner-show] {
    opacity: 1;
    pointer-events: all;
  }

  .spinner-mixin[spinner-options~="fixed"] {
    position: fixed;
  }
`,Spinner=kt=>{var At,xt,_s,$s,jt;return jt=class extends kt{constructor(){super();Fn(this,xt);Fn(this,At);let Lt;const Ht=this.firstUpdated;Pn(this,At,new Promise(Vt=>Lt=Vt)),this.firstUpdated=async Vt=>{Lt(),await(Ht==null?void 0:Ht.call(this,Vt))}}async startSpinner(Lt={renderImmediate:!1,minimum:0,fixed:!1}){const Ht=Lt.fixed?"fixed":"";await rn(this,At);const Vt=typeof Lt.target=="string"?this.shadowRoot.querySelector(Lt.target):Lt.target||this.shadowRoot;let zt=Vt.querySelector(".spinner-mixin");if(zt){zt.setAttribute("spinner-show","");return}zt=An(this,xt,$s).call(this),zt.setAttribute("spinner-options",Ht),Vt.append(zt),Lt.minimum&&(zt._spinnerMixinDelay=DOM$1.delay(Lt.minimum)),Lt.renderImmediate?zt.setAttribute("spinner-show",""):DOM$1.skipFrame(()=>zt.setAttribute("spinner-show","")),await DOM$1.delay(transitionDuration)}async stopSpinner(Lt={}){var zt;const Vt=(typeof Lt.target=="string"?this.shadowRoot.querySelector(Lt.target):Lt.target||this.shadowRoot).querySelector(".spinner-mixin");await(Vt==null?void 0:Vt._spinnerMixinDelay),(zt=Vt==null?void 0:Vt.removeAttribute)==null||zt.call(Vt,"spinner-show"),document.visibilityState==="hidden"&&(Vt==null||Vt.remove())}},At=new WeakMap,xt=new WeakSet,_s=function(Lt){Lt.propertyName==="opacity"&&getComputedStyle(Lt.target).opacity==="0"&&Lt.target.remove()},$s=function(){const Lt=document.createElement("div");return Lt.classList.add("spinner-mixin"),Lt.ontransitionend=Ht=>An(this,xt,_s).call(this,Ht),Lt.appendChild(document.createElement("sl-spinner")),Lt},jt};h$2.with=function(...kt){return kt.reduce((At,xt)=>xt(At),this)};function addSchemas(kt){const At=kt.types,xt=kt.protocol;return Object.entries(At).reduce((Bt,[Nt,jt])=>(jt.dataFormats.some(Ut=>Ut.match("json"))&&(Bt[Nt]=At[Nt].schema=xt+"/schemas/"+Nt),Bt),{})}const profileDefinition={published:!0,protocol:"https://areweweb5yet.com/protocols/profile",types:{name:{dataFormats:["application/json"]},social:{dataFormats:["application/json"]},messaging:{dataFormats:["application/json"]},phone:{dataFormats:["application/json"]},address:{dataFormats:["application/json"]},career:{dataFormats:["application/json"]},payment:{dataFormats:["application/json"]},connect:{dataFormats:["application/json"]},avatar:{dataFormats:["image/gif","image/png","image/jpeg"]},hero:{dataFormats:["image/gif","image/png","image/jpeg"]}},structure:{name:{},social:{},career:{},avatar:{},hero:{},messaging:{},address:{},phone:{},payment:{},connect:{}}},profile={uri:profileDefinition.protocol,schemas:addSchemas(profileDefinition),definition:profileDefinition},byUri={[profileDefinition.protocol]:profile},protocols=Object.freeze(Object.defineProperty({__proto__:null,byUri,profile},Symbol.toStringTag,{value:"Module"}));globalThis.URLPattern||await __vitePreload(()=>import("./index-6Ez4sj9Y.js"),[]);const drlCaptureRegexp=/^(?:dweb:\/\/)?(did:[^\/]+)(?:\/protocols\/([^\/]+)\/?)?/,hasBuffers=typeof buffer$2.Buffer<"u",natives={canonicalize:function(kt){var At="";return xt(kt),At;function xt(Bt){if(Bt===null||typeof Bt!="object"||Bt.toJSON!=null)At+=JSON.stringify(Bt);else if(Array.isArray(Bt)){At+="[";let Nt=!1;Bt.forEach(jt=>{Nt&&(At+=","),Nt=!0,xt(jt)}),At+="]"}else{At+="{";let Nt=!1;Object.keys(Bt).sort().forEach(jt=>{Nt&&(At+=","),Nt=!0,At+=JSON.stringify(jt),At+=":",xt(Bt[jt])}),At+="}"}}},deepSet(kt,At,xt){const Bt=At.split("."),Nt=Bt.pop(),jt=Bt.reduce((Ut,Lt)=>Ut[Lt]=Ut[Lt]||{},kt);jt[Nt]=xt},unslash(kt){return kt.endsWith("/")?kt.slice(0,-1):kt},randomString(kt=32){const At="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let xt="";const Bt=new Uint8Array(kt);return crypto.getRandomValues(Bt),Bt.forEach(Nt=>{xt+=At[Nt%At.length]}),xt},url:{encode:kt=>{let At=[hasBuffers?buffer$2.Buffer.from:btoa](encodeURIComponent(kt).replace(/%([0-9A-F]{2})/g,(xt,Bt)=>String.fromCharCode("0x"+Bt)));return hasBuffers&&(At=At.toString("base64")),At.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decode:kt=>{let At=kt.replace(/-/g,"+").replace(/_/g,"/");return At=hasBuffers?buffer$2.Buffer.from(At,"base64").toString():atob(At),decodeURIComponent(At.split("").map(xt=>"%"+("00"+xt.charCodeAt(0).toString(16)).slice(-2)).join(""))}},drl:{async cache(kt,At,xt){return await(await caches.open("drl")).put(kt,new Response(xt||await At.data.blob(),{headers:{"Content-Type":At.dataFormat,"dwn-cache-time":Date.now().toString()}})),kt},async fromRecord(kt,At,xt){const Bt=`https://dweb/${kt.author}/records/${kt.id}`;return At&&await this.cache(Bt,kt,xt),Bt},create(kt,{protocol:At="",action:xt="",path:Bt="",params:Nt={},hash:jt="",flushCache:Ut=!1}){let Lt=`https://dweb/${kt}${xt?"/"+xt:""}`;At&&(Lt+="/protocols/"+Convert.string(At).toBase64Url()),Lt+=natives.unslash(Bt.startsWith("/")?Bt:"/"+Bt);const Ht=new URLSearchParams;for(let Vt in Nt){const zt=Nt[Vt];Array.isArray(zt)?zt.forEach(Wt=>Ht.append(Vt,Wt)):Ht.append(Vt,zt)}return Lt+Ht.toString()+(Ut?"?cache-updated="+new Date().getTime():"")+jt},parse(kt,At="*"){const xt=natives.unslash(kt),Bt=new URLPattern({protocol:"dweb",pathname:At}).exec(xt);if(!Bt)return null;const Nt=xt.match(drlCaptureRegexp),jt=Nt==null?void 0:Nt[2];return{did:(Nt==null?void 0:Nt[1])||null,protocol:jt?decodeURIComponent(jt):null,path:Bt.pathname.groups,params:Object.fromEntries(new URLSearchParams(Bt.search.input)),hash:Bt.hash.input}}},worker(kt,At=!1){const xt=new Blob([`
      self.onmessage = function(e) {
        const { data, code } = e.data;
        const execute = new Function('data', code);
        try {
          const result = execute(data);
          self.postMessage({ result });
        }
        catch (error) {
          self.postMessage({ error: error.message });
        }
      }
    `],{type:"application/javascript"}),Bt=URL.createObjectURL(xt),Nt=new Worker(Bt);return{run:function(jt){return new Promise((Ut,Lt)=>{Nt.onmessage=function(Ht){Ht.data.error?Lt(new Error(Ht.data.error)):Ut(Ht.data.result),At||this.terminate()},Nt.postMessage({data:jt,code:kt})})},terminate:function(){Nt.terminate(),URL.revokeObjectURL(Bt)}}}};setInterval(()=>Datastore.cache={},1e3*60*60);async function cacheJson(kt){await Promise.all((Array.isArray(kt)?kt:[kt]).map(async At=>{var xt,Bt,Nt,jt;At.cache={json:await((jt=(Nt=(Bt=(xt=At.data)==null?void 0:xt.json)==null?void 0:Bt.call(xt))==null?void 0:Nt.catch(Ut=>{}))==null?void 0:jt.then(Ut=>Ut||{}))}}))}class Datastore{static cache={};static setCache(At,xt,Bt){(Datastore.cache[At]||(Datastore.cache[At]={}))[xt]=Bt}static getCache(At,xt){var Bt,Nt;return(Nt=(Bt=Datastore.cache)==null?void 0:Bt[At])==null?void 0:Nt[xt]}constructor(At,xt={}){this.options=xt,this.did=At.did.connectedDid,this.dwn=At.dwn,this.ready=this.installProtocols()}async installProtocols(){const At=await this.dwn.protocols.query({message:{}}),xt=[];if(this.options.aggregator){const Bt=(void 0).definition.structure;Bt.story.$actions=Bt.thread.$actions=[{who:"anyone",can:["create","update","delete"]}]}try{for(let Nt in byUri){let jt=At.protocols.find(Vt=>Nt===Vt.definition.protocol),Ut=byUri[Nt].definition,Lt=natives.canonicalize(Ut),Ht=natives.canonicalize((jt==null?void 0:jt.definition)||null);Lt!==Ht&&(console.log("installing protocol: "+Nt),xt.push(this.dwn.protocols.configure({message:{definition:Ut}})))}const Bt=await Promise.all(xt);try{await Promise.all(Bt.map(({protocol:Nt})=>Nt.send(this.did)))}catch(Nt){return console.log("remote push of configuration failed",Nt),!0}}catch(Bt){return console.log("local install of configuration failed",Bt),!1}return!0}async getProtocol(At,xt={}){const Bt={from:xt.from,message:{filter:{protocol:At}}},{protocols:Nt,status:jt}=await this.dwn.protocols.query(Bt);return{protocol:Nt[0],status:jt}}async queryProtocolRecords(At,xt,Bt={}){await this.ready;const Nt={filter:{protocol:protocols[At].uri,protocolPath:xt}},jt={message:Nt};return Bt.from&&(jt.from=Bt.from),Bt.recordId&&(Nt.filter.recordId=Bt.recordId),Bt.parentId&&(Nt.filter.parentId=Bt.parentId),Bt.contextId&&(Nt.filter.contextId=Bt.contextId),Bt.published!==void 0&&(Nt.filter.published=Bt.published),Bt.recipient&&(Nt.filter.recipient=Bt.recipient),Bt.role&&(Nt.protocolRole=Bt.role),(Bt.sort||Bt.latestRecord)&&(Nt.dateSort=Bt.latestRecord?"createdDescending":Bt.sort),(Bt.pagination||Bt.latestRecord)&&(Nt.pagination=Bt.latestRecord?{limit:1}:Bt.pagination),this.dwn.records.query(jt)}async readProtocolRecord(At,xt={}){await this.ready;const Bt={message:{filter:{recordId:At}}};return xt.from&&(Bt.from=xt.from),xt.role&&(Bt.message.protocolRole=xt.role),this.dwn.records.read(Bt)}async createProtocolRecord(At,xt,Bt={}){await this.ready;const Nt={message:{protocol:protocols[At].uri,protocolPath:xt}},jt=protocols[At].schemas[xt.split("/").pop()];jt&&(Nt.message.schema=jt),Bt.from&&(Nt.from=Bt.from),Bt.store===!1&&(Nt.store=Bt.store),Bt.parentContextId&&(Nt.message.parentContextId=Bt.parentContextId),Bt.contextId&&(Nt.message.contextId=Bt.contextId),Nt.message.dataFormat=Bt.dataFormat||"application/json",typeof Bt.data<"u"?Nt.data=Bt.data:Bt.dataFormat==="application/json"&&(Nt.data={}),Bt.published!==void 0&&(Nt.message.published=Bt.published),Bt.recipient&&(Nt.message.recipient=Bt.recipient),Bt.role&&(Nt.message.protocolRole=Bt.role);const Ut=await this.dwn.records.create(Nt);return console.log("create status",Ut),Bt.store!==!1&&await Ut.record.send(Bt.from||this.did).then(Lt=>{console.log("sent success",Ut)}).catch(Lt=>{console.log("send error",Lt)}),Ut}async putRecordPath(At,xt,Bt,Nt={}){await this.ready;let jt=Nt.record;if(!jt){const{records:Vt}=await this.queryProtocolRecords(At,xt,{latestRecord:!0});jt=Vt[0]}Bt=Bt instanceof File?new Blob([Bt],{type:Nt.dataFormat||Bt.type}):Bt;const Ut=Bt instanceof Blob?Bt.type:Nt.dataFormat||"application/json";try{jt?(await jt.update({data:Bt,published:Nt.published}),await jt.send(this.did)):jt=(await this.createProtocolRecord(At,xt,{data:Bt,dataFormat:Ut,published:Nt.published})).record}catch(Vt){console.log(Vt)}const Lt=jt.drl=natives.drl.create(this.did,{protocol:protocols[At].uri,path:xt,action:"read"}),Ht=jt.blob=jt.blob||await jt.data.blob();return Nt.cache!==!1&&natives.drl.cache(Lt,jt,Ht),jt}async readRecordPath(At,xt,Bt={}){await this.ready,Bt.latestRecord=!0;const{records:Nt,status:jt}=await this.queryProtocolRecords(At,xt,Bt),Ut=Nt[0];if(Ut)return Bt.cache!==!1&&await cacheJson(Ut),Ut}async getAggregators(At={}){At.latestRecord=!0;const{records:xt}=await this.queryProtocolRecords("social","aggregators",At),Bt=xt[0];return Bt&&await cacheJson(Bt),Bt}async setAggregators(At,xt={}){let Bt;try{Bt=await this.getAggregators(xt),Bt?await Bt.update({data:At}):Bt=(await this.createProtocolRecord("social","aggregators",{published:!0,data:At,dataFormat:"application/json"})).record;const{status:Nt}=await Bt.send(xt.from)}catch(Nt){console.log(Nt)}return Bt&&await cacheJson(Bt),Bt}async createSocial(At={}){const{record:xt,status:Bt}=await this.createProtocolRecord("profile","social",{published:!0,data:At.data||{},dataFormat:"application/json"});return At.cache!==!1&&await cacheJson(xt),xt}async getSocial(At={}){await this.ready;const xt=At.from||this.did;if(xt!==this.did){const Ut=Datastore.getCache(xt,"social");if(Ut)return Ut}const{records:Bt,status:Nt}=await this.queryProtocolRecords("profile","social",At),jt=Bt[0];if(jt)return At.cache!==!1&&await cacheJson(jt),Datastore.setCache(xt,"social",jt),jt}async createProfileImage(At,xt={}){xt.data&&(xt.dataFormat=xt.data.type,xt.data instanceof File&&(xt.data=new Blob([xt.data],{type:xt.dataFormat}))),xt.published=!0;const{record:Bt,status:Nt}=await this.createProtocolRecord("profile",At,xt);return Bt}async getProfileImage(At,xt={}){const{records:Bt,status:Nt}=await this.queryProtocolRecords("profile",At,xt);return Bt[0]}async readProfileImage(At,xt={}){await this.ready;const Bt=xt.from=xt.from||this.did;if(!xt.skipCache){const jt=Datastore.getCache(Bt,At);if(jt)return jt}const Nt=await this.getProfileImage(At,xt);if(Nt){const jt=await natives.drl.fromRecord(Nt,!0);Nt.cache={uri:jt},Datastore.setCache(Bt,At,Nt)}return Nt}async setProfileImage(At,xt,Bt,Nt=this.did){let jt=Bt||await this.getProfileImage(At,{from:Nt}),Ut=xt?new Blob([xt],{type:xt.type}):void 0;try{if(Ut){jt?await jt.update({data:Ut}):jt=await this.createProfileImage(At,{data:Ut,from:Nt});const{status:Lt}=await jt.send(Nt)}else jt&&(Ut=await jt.data.blob())}catch(Lt){console.log(Lt)}return jt&&(jt.cache=jt.cache||{},jt.cache.blob=Ut,jt.cache.uri=Ut?URL.createObjectURL(Ut):void 0),jt}async createCareer(At={}){const{record:xt,status:Bt}=await this.createProtocolRecord("profile","career",{published:!0,data:At.data,dataFormat:"application/json"});return At.cache!==!1&&await cacheJson(xt),xt}async getCareer(At={}){await this.ready;const xt=At.from||this.did;if(xt!==this.did){const Ut=Datastore.getCache(xt,"career");if(Ut)return Ut}const{records:Bt,status:Nt}=await this.queryProtocolRecords("profile","career",At),jt=Bt[0];if(jt)return At.cache!==!1&&await cacheJson(jt),Datastore.setCache(xt,"career",jt),jt}async createStory(At={}){const{record:xt,status:Bt}=await this.createProtocolRecord("social","story",{published:!1,data:At.data||{},dataFormat:"application/json"});return At.cache!==!1&&await cacheJson(xt),xt}async deleteStory(At){const xt=await this.dwn.records.delete({message:{recordId:At}});if(xt.status>399)throw"Delete failed";return xt}async readStory(At,xt={}){const{record:Bt,status:Nt}=await this.readProtocolRecord(At,xt);if(Nt.code>399){const jt=new Error(Nt.detail);throw jt.code=Nt.code,jt.detail=Nt.detail,jt}return xt.cache!==!1&&await cacheJson(Bt),Bt}async queryStories(At={}){const xt=await this.queryProtocolRecords("social","story",At);return At.cache!==!1&&await cacheJson(xt.records),xt}async createStoryMedia(At,xt={}){xt.data&&(xt.dataFormat=xt.data.type,xt.data instanceof File&&(xt.data=new Blob([xt.data],{type:xt.dataFormat}))),xt.published=!0,xt.parentContextId=At.id;const{record:Bt,status:Nt}=await this.createProtocolRecord("social","story/media",xt);return Bt}async readStoryMedia(At,xt={}){const{record:Bt,status:Nt}=await this.readProtocolRecord(At,xt);if(Nt.code>399){const jt=new Error(Nt.detail);throw jt.code=Nt.code,jt.detail=Nt.detail,jt}if(xt.cache!==!1){const jt=await natives.drl.fromRecord(Bt,!0);Bt.cache={uri:jt}}return Bt}async setStoryHero(At,xt={}){xt.data&&(xt.dataFormat=xt.data.type,xt.data instanceof File&&(xt.data=new Blob([xt.data],{type:xt.dataFormat}))),xt.published=!0;let Bt=At._hero,Nt=At.cache.json;const jt=Nt.hero;Bt||jt?(Bt||(Bt=(await this.queryProtocolRecords("social","story/media",{recordId:jt})).records[0]),await Bt.update({data:xt.data}),Bt.send(At.author)):(xt.parentContextId=At.id,Bt=(await this.createProtocolRecord("social","story/media",xt)).record);const Ut=await natives.drl.fromRecord(Bt,!0);return Bt.cache={uri:Ut},jt!==Bt.id&&(Nt.hero=Bt.id,console.log(Nt),await At.update({data:Nt}),At.send(At.author)),At._hero=Bt}async queryThreads(At={}){const xt=await this.queryProtocolRecords("social","thread",At);return At.cache!==!1&&await cacheJson(xt.records),xt}queryFollows=(At={})=>this.queryProtocolRecords("social","follow",At);async getFollows(At,xt={}){return At&&(xt.pagination=xt.pagination||{},xt.pagination.cursor=At),this.queryProtocolRecords("social","follow",xt)}async toggleFollow(At,xt){var Ut,Lt;var{records:Bt,status:Nt}=await this.queryFollows({recipient:At}),jt=Bt[0];if(jt){if(jt!=null&&jt.isDeleted)jt.update();else if(!xt){var{status:Nt}=await this.dwn.records.delete({message:{recordId:jt.id}});return!1}}else{const Ht=await this.getAggregators({from:At});var{record:jt}=await this.createProtocolRecord("social","follow",{recipient:At,data:{aggregators:((Lt=(Ut=Ht==null?void 0:Ht.cache)==null?void 0:Ut.json)==null?void 0:Lt.aggregators)||[],lastAggregatorFetch:(Ht==null?void 0:Ht.dateModified)||null}})}return jt}async sendInvite(At,xt,Bt={}){if(!Bt.skipCheck){let Lt=await this.getActiveInvite(xt,{recipient:At});if(Lt)return Lt}const{record:Nt,status:jt}=await this.createProtocolRecord("social","invite",Object.assign({recipient:At,store:!1,dataFormat:"application/json",data:{link:xt}},Bt));console.log("invite ",Nt),Bt.cache!==!1&&await cacheJson(Nt);const{status:Ut}=await Nt.send(At);if(Ut.code===202){console.log(Nt);const Lt=await Nt.store();return console.log(Lt),Nt}}}async function initializeIdentities(kt){const At={},xt=[];return kt=kt?Array.isArray(kt)?kt:[kt]:await DWeb$1.identity.list(),await Promise.all(kt.map(async Bt=>{if(At[Bt.did.uri]=Bt,Bt.web5)return;const Nt=Bt.web5=await DWeb$1.use(Bt),jt=Bt.datastore=new Datastore(Nt);xt.push(jt.readRecordPath("profile","connect").then(async Ut=>{if(Ut){const Lt=Ut.cache.json||{},Ht=(Lt==null?void 0:Lt.webWallets)||(Lt.webWallets=[]);Ht.find(Vt=>new URL(Vt).origin===location.origin)||(Ht.push(location.origin),await Ut.update({data:Lt,published:!0}),navigator.onLine&&await Ut.send())}else Ut=await jt.putRecordPath("profile","connect",{webWallets:[location.origin]},{published:!0});Bt.connectRecord=Ut}).catch(Ut=>console.error(Ut)))})),Promise.allSettled(xt).then(()=>App$1.updateState("identities")).catch(Bt=>console.error(Bt)),At}let App$1;const $App=kt=>class extends kt.with(State){static properties={ready:{store:"page"},identities:{store:"page"},avatars:{store:"page"}};constructor(){if(super(),App$1)throw"$App is a singleton and an instance already exists.";globalThis.App=App$1=this;let At;this.ready=new Promise(xt=>At=xt),initializeIdentities().then(xt=>{this.identities=xt,this.ready.state=!0,At(!0)})}async updateState(At,xt,Bt){const Nt=this[At];return xt=xt===void 0?Nt:xt,Array.isArray(xt)?this[At]=Bt&&xt!==Nt?[...Nt||[],...xt||[]]:{...xt}:typeof xt=="object"&&xt?this[At]=Bt&&xt!==Nt?{...Nt||{},...xt||{}}:{...xt}:this[At]=xt,this[At]}async updateProfileImage(At,xt,Bt){const Nt=await At.datastore.putRecordPath("profile",xt,Bt,{published:!0});return At[xt]=Nt.drl+"?cache-updated="+new Date().getTime(),this.updateState("identities"),Nt}async addIdentity(At){return await initializeIdentities(At),this.identities={...this.identities||{},[DWeb$1.identity.uriFrom(At)]:At}}async saveIdentityLabel(At,xt){const Bt=At.connectRecord;if(!Bt){console.log("No connect record found for identity: ",At);return}const Nt=Bt.cache.json;Nt.label=xt,await Bt.update({data:Nt,published:!0}),navigator.onLine&&await Bt.send(),await DWeb$1.identity.addAutofillDid(xt+"@"+At.did.uri),this.updateState("identities")}},PageStyles=i$7`

[hide-on-overlay] {
  transition: opacity 0.3s ease;
} 

:host-context(html[overlay-active]) [hide-on-overlay] {
  opacity: 0;
  pointer-events: none;
} 

:host([route-state="active"]) {
  z-index: 1;
}

:host([route-state="active"]) > section {
  opacity: 1;
}

:host([page]) > * {
  margin: 0 auto;
}

:host([page]) > section {
  box-sizing: border-box;
  width: 100%;
  max-width: var(--content-max-width);
  padding: 2.75rem 2.25rem;
}

:host([page]) > section > :first-child {
  margin-top: 0;
}

h2,h3,h4,h5,h6 {
  font-family: var(--app-font);
  font-weight: normal;
}

ul, ol {
  margin: 0;
  padding: 0;
}

.markdown-body *:is(ul, ol) {
  padding: 0.25em 1.2em;
}

form input,
form textarea,
form sl-input::part(input),
form sl-textarea::part(textarea) {
  transition: color 0.5s ease;
}

form[loading] input,
form[loading] textarea,
form[loading] sl-input::part(input),
form[loading] sl-textarea::part(textarea) {
  color: transparent;
}

::part(form-control-help-text) {
  font-size: 0.75em;
}

/* sl-input, sl-textarea, vaadin-combo-box {
  margin: 0 0 1em;
} */

sl-icon::part(svg) {
  width: 1em;
  height: 1em;
}

sl-button::part(base) {
  align-items: center;
}

sl-button:not([circle]) sl-icon { 
  font-size: 1rem;
  padding: 0.4rem 0;
}

sl-dialog::part(panel) {
  width: calc(100% - 2rem);
  max-width: 600px;
}

sl-dialog[fit-content]::part(panel) {
  height: fit-content;
  width: fit-content;
  max-width: calc(100% - 2rem);
}

sl-dialog::part(header) {
  border-bottom: 1px solid rgb(255 255 255 / 2%);
  box-shadow: 0 1px 1px 1px rgba(0, 0, 0, 0.15);
}

sl-dialog::part(header-actions) {
  padding: 0 1rem;
}

sl-dialog::part(title) {
  padding: 1rem 1.2rem;
}

sl-dialog[tabbed]:has(sl-tab-group)::part(body) {
  padding: 0;
}

sl-dialog[tabbed] sl-tab-panel::part(base) {
  padding: 1rem 1rem 1.5rem;
}

sl-dialog::part(footer) {
  border-top: 1px solid rgba(255 255 255 / 5%);
  box-shadow: 0 -1px 1px 0px rgba(0 0 0 / 15%);
}

sl-tab-group::part(tabs) {
  border-bottom: 1px solid var(--track-color);
}

*::part(input-field) {
  background: var(--sl-input-background-color);
  border: solid var(--sl-input-border-width) var(--sl-input-border-color);
}

*::part(form-control-label) {
  margin: 0 0 0.4em;
  font-size: var(--sl-input-label-font-size-medium)
}

[pressable] * {
  pointer-events: none;
}

[flex] {
  display: flex;
}

[flex~="inline"] {
  display: inline-flex;
}

[flex~="column"] {
  flex-direction: column;
}

[flex~="end"] {
  align-items: end;
}

[flex~="column"][flex~="end"],
[flex~="column-reverse"][flex~="end"] {
  justify-content: flex-end;
}

[flex~="column-reverse"] {
  flex-direction: column-reverse;
}

[flex~="wrap"] {
  flex-wrap: wrap;
}

[flex~="shrink"] {
  flex: 0;
}

[flex~="fill"] {
  flex: 1;
}

[flex~="align-start"], [flex~="start"] {
  align-items: start;
}

[flex~="end"] {
  align-items: end;
}

[flex~="center-x"]:not([flex~="column"]) {
  justify-content: center;
}

[flex~="center-x"][flex~="column"] {
  align-items: center;
}

[flex~="center-y"]:not([flex~="column"]) {
  align-items: center;
}

[flex~="center-y"][flex~="column"] {
  justify-content: center;
}

[flex~="gap-small"] > * {
  margin: 0 0.5em 0.5em 0;
}

[flex~="gap-medium"] > * {
  margin: 0 1em 1em 0;
}

[flex~="gap-large"] > * {
  margin: 0 2em 2em 0;
}

[default-content] {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

[default-content~="cover"] {
  position: absolute;
  inset: 0;
  z-index: 1000;
}

[default-content~="placeholder"] > :is(svg, sl-icon) {
  display: block;
  margin: 1rem auto 1.75rem;
  font-size: 9em;
  max-width: 300px;
  height: auto;
  color: var(--header-bk);
  transition: opacity 0.3s ease, visibility 0.3s;
}

[default-content~="firstrun"] > :is(svg, sl-icon) {
  display: block;
  margin: 4rem auto;
  font-size: 50vh;
  width: 100%;
  max-width: 800px;
  height: auto;
  color: var(--header-bk);
}

[default-content~="clickable"] {
  cursor: pointer;
}

[default-content~="clickable"] {
  transition: background-color 0.25s ease;
}

[default-content~="clickable"]:hover {
  background-color: rgba(255 255 255 / 0.075)
}

.text-logo {
  font-family: var(--app-font);
}

[break-text] {
  display: block;
  position: relative;
  width: 100%;
  margin: 1.5em 0;
  box-sizing: border-box;
  text-align: center;
}

[break-text]::before {
  content: "";
  display: block;
  position: absolute;
  width: 100%;
  height: 0px;
  top: 50%;
  transform: translateY(-50%);
  border-top: 1px solid rgba(255,255,255,0.1);
  border-bottom: 1px solid rgba(0,0,0,0.1);
}

[break-text]::after {
  content: attr(break-text);
  position: relative;
  top: -0.15em;
  padding: 0 0.5em;
  background: inherit;
}

[empty-text]:empty::before, [empty-text][empty]::before {
  content: attr(empty-text);
  display: block;
  width: 100%;
  font-size: 85%;
  color: rgba(255,255,255,0.5);
  font-style: italic;
}

[columns~="2"] {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 1rem;  /* Adjusts spacing between rows and columns */
  align-items: center;
}

[columns~="2"] > *:nth-child(2n + 1) {
  font-family: var(--app-font);
}

[columns~="2"][columns~="labels-right"] > *:nth-child(2n + 1) {
  text-align: right;
}

[ellipsis] {
  width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.shadow-icon {
  filter: drop-shadow(0px 1px 1px rgba(0 0 0 / 50%));
}

/* sl-icon-button:hover:not(.icon-button--disabled)::part(base), .icon-button:focus-visible:not(.icon-button--disabled)::part(base) {
  color: currentColor;
  filter: drop-shadow(0px 1px 2px rgba(0 0 0 / 35%));
} */


.page-dialog::part(panel) {
  max-height: calc(100% - var(--header-height) - var(--sl-spacing-2x-large));
  margin-top: var(--header-height);
}

.hero[src] {
  background: none;
}

.hero::part(fallback) {
  display: none;
}

.hero sl-icon-button {
  position: absolute;
  top: 1em;
  right: 1em;
  background: rgba(0 0 0 / 0.6);
  border-radius: 100%;
  cursor: pointer;
  z-index: 3;
} 

#view_header {
  position: sticky;
  top: 0;
  max-width: none;
  padding: 1.1em 1.2em 1em;
  background: rgba(44 44 49 / 90%);
  border-bottom: 1px solid rgba(0 0 0 / 50%);
  z-index: 1;
}

@media(max-width: 500px) {

  :host([page]) > section {
    padding: 1.5rem 1.25rem;
  }

  :host([page~="full-width"]) > section {
    padding: 0;
  }

  .page-dialog::part(panel) {
    width: 100%;
    height: calc(100% - var(--header-height));
    max-width: none;
    max-height: none;
    margin-top: var(--header-height);
    box-shadow: none;
    border-radius: 0;
  }
}

`;class ConnectWidget extends h$2.with(State,Query,Spinner){static properties={identities:{store:"page"}};static query={selectDidInput:["#select_did_input",!0]};constructor(){super()}firstUpdated(){DWeb$1.connect.attachInput(this.selectDidInput,{permissions:[{protocolDefinition:profile.definition,permissionScopes:["Query","Read","Subscribe","Write","Delete","Query:Protocols","Query:Messages","Read:Messages","Subscribe:Messages"].map(At=>(At=At.split(":"),{protocol:profile.uri,interface:At[1]||"Records",method:At[0]}))}],onConnect:async(At,xt)=>{console.log(At,xt)},onError:At=>{console.log(At)},onProgress:At=>{console.log(At)}})}render(){return this.connected?ke$2`
      <div>connected</div>
    `:ke$2`
      <section flex="column center-x center-y">
        <sl-button variant="default" size="large" @click="${async At=>{At.target.loading=!0;const xt=await DWeb$1.identity.create({});App$1.addIdentity(xt),At.target.loading=!1,router.navigateTo(`/profiles/${xt.did.uri}`)}}">
          <sl-icon slot="prefix" name="person-plus"></sl-icon>
          Create a new identity
        </sl-button>
        <div break-text="OR"></div>
        <div>
          <input id="select_did_input" name="email" type="email" label="Select a DID" placeholder="social@did:dht:..." autocomplete="on" />
        </div>
        <sl-button variant="default" size="large" @click="${At=>{}}">
          <sl-icon slot="prefix" name="wallet2"></sl-icon>
          Connect via Wallet
        </sl-button>
        <sl-button variant="default" size="large" @click="${At=>App$1.restoreIdentityModal.show()}">
          <sl-icon slot="prefix" name="upload"></sl-icon>
          Restore from File
        </sl-button>
        <!-- <sl-button variant="default" size="large" @click="${At=>{}}">
          <sl-icon slot="prefix" name="key-fill"></sl-icon>
          Enter as Password
        </sl-button> -->
      </section>
    `}static styles=[PageStyles,SpinnerStyles,i$7`
      :host {
        display: flex;
        justify-content: center;
      }

      sl-button {
        width: 100%;
      }

      sl-button + sl-button {
        margin: 1rem 0 0;
      }

      @media(max-width: 800px) {

      }
    `]}customElements.define("connect-widget",ConnectWidget);var Yo,Zo;class ConnectRequest extends h$2.with(State,Spinner,Query){constructor(){super();Fn(this,Yo);Fn(this,Zo);this.profileProtocolEncoded=Convert.string(profile.uri).toBase64Url()}firstUpdated(){this.did=this.identities?Object.keys(this.identities)[0]:""}willUpdate(xt){xt.has("identities")&&(this.did=this.identities?Object.keys(this.identities)[0]:"")}async allow(){this.acceptButton.loading=!0;const xt=await DWeb$1.connect.oidcConnect(this.did,this.request);DOM$1.fireEvent(this,"connect-pin",{detail:{pin:xt}}),this.parentElement.hide(),this.acceptButton.loading=!1}deny(){this.parentElement.hide()}truncateString(xt){return xt.length>20?xt.slice(0,20)+"...":xt}render(){return this.identities?ke$2`
      <section flex="center-y column">
        <div id="requestor" flex="center-x center-y" ellipsis>
          <img src="https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${this.origin}&size=128"/>
          ${this.truncateString(new URL(this.request.client_id).host||this.request.client_id)}
        </div>
        <div>is requesting permissions for, choose an identity :</div>
        <select id="identity" placeholder="Select an identity" @change="${xt=>this.did=xt.target.value}">
          ${Object.entries(this.identities).map(([xt,Bt])=>{var Nt,jt,Ut;return ke$2`
            <option value="${xt}" ?selected="${this.did===xt}">
              ${(((Ut=(jt=(Nt=Bt==null?void 0:Bt.connectRecord)==null?void 0:Nt.cache)==null?void 0:jt.json)==null?void 0:Ut.label)||"")+"@"+xt}
            </option>
          `})}
        </select>
        ${this.request.permissionRequests.reduce((xt,Bt)=>{let Nt,jt={};const Ut=[];return xt.push(ke$2`<h4 ellipsis>${Bt.protocolDefinition.protocol}</h4>`),Bt.permissionScopes.forEach(Lt=>{Lt.interface==="Records"?Ut.push(ke$2`<strong>${Lt.method.toLowerCase()}</strong>`):Lt.interface==="Messages"?jt[Lt.method]=!0:Lt.interface==="Protocols"&&Lt.method==="Configure"&&(Nt=!0)}),jt=jt.Query&&jt.Read&&jt.Subscribe?ke$2`<strong>sync</strong>`:"",xt.push(ke$2`<ul class="permission-list">${[Nt?ke$2`<li>Modify how this protocol works</li>`:D$1,Ut.length||jt?ke$2`<li>${Ut}${jt} data</li>`:D$1]}</ul>`),xt},[])}
        <div id="user_actions" flex="center-x center-y">
          <sl-button id="accept_button" variant="success" @click="${this.allow}">Accept</sl-button>
          <sl-button id="deny_button" variant="primary" @click="${this.deny}">Deny</sl-button>
        </div>
      </section>`:D$1}}Yo=new WeakMap,Zo=new WeakMap,ti(ConnectRequest,"properties",{identities:{store:"page"},request:{type:Object}}),ti(ConnectRequest,"query",{acceptButton:["#accept_button",!0]}),ti(ConnectRequest,"styles",[PageStyles,i$7`

      :host {
        padding: 0 !important;
      }

      :host > section {
        box-sizing: border-box;
        padding: 1rem 1.25rem;
      }

      :host > section > div {
        box-sizing: border-box;
        margin: 1rem 0;
        text-align: center;
      }

      #requestor, #identity {
        padding: 1rem;
        background: rgb(0 0 0 / 70%);
        border-radius: 10rem;
        border: 1px solid rgb(255 255 255 / 0.2);
      }

      #requestor {
        font-size: 1.5rem;
      }

      #requestor img, sl-avatar {
        --size: 2rem;
        height: var(--size);
        margin: 0 1rem 0 0;
      }

      .permission-list {
        padding: 0 0 0 2rem;
      }

      .permission-list strong:first-child {
        text-transform: capitalize;
      }
      .permission-list strong::before {
        content: ", ";
        font-weight: normal;
      }
      .permission-list strong:first-child::before {
        display: none;
      }
      .permission-list strong:last-child::before {
        content: ", and ";
      }

      #user_actions {
        margin: 2rem 0 0;
      }

      #user_actions sl-button {
        flex: 1;
        margin: 0 1rem;
      }

      @media(max-width: 800px) {

      }
    `]);customElements.define("connect-request",ConnectRequest);const notify={info(kt,At={}){const xt=Object.assign(document.createElement("sl-alert"),{variant:"primary",duration:3e3,closable:!0,innerHTML:`
        <sl-icon name="${At.icon||"info-circle"}" slot="icon"></sl-icon>
        ${document.createTextNode(kt).textContent}
      `},At);return document.body.appendChild(xt).toast()},success(kt,At={}){notify.info(kt,Object.assign({variant:"success"},At))},warning(kt,At={}){notify.info(kt,Object.assign({variant:"warning"},At))},error(kt,At={}){notify.info(kt,Object.assign({variant:"danger"},At))}};let e$1=class Wn{constructor(At,xt,Bt,Nt,jt){this._legacyCanvasSize=Wn.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=At,this.$canvas=document.createElement("canvas"),Bt&&typeof Bt=="object"?this._onDecode=xt:(console.warn(Bt||Nt||jt?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=xt),xt=typeof Bt=="object"?Bt:{},this._onDecodeError=xt.onDecodeError||(typeof Bt=="function"?Bt:this._onDecodeError),this._calculateScanRegion=xt.calculateScanRegion||(typeof Nt=="function"?Nt:this._calculateScanRegion),this._preferredCamera=xt.preferredCamera||jt||this._preferredCamera,this._legacyCanvasSize=typeof Bt=="number"?Bt:typeof Nt=="number"?Nt:this._legacyCanvasSize,this._maxScansPerSecond=xt.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),At.disablePictureInPicture=!0,At.playsInline=!0,At.muted=!0;let Ut=!1;if(At.hidden&&(At.hidden=!1,Ut=!0),document.body.contains(At)||(document.body.appendChild(At),Ut=!0),Bt=At.parentElement,xt.highlightScanRegion||xt.highlightCodeOutline){if(Nt=!!xt.overlay,this.$overlay=xt.overlay||document.createElement("div"),jt=this.$overlay.style,jt.position="absolute",jt.display="none",jt.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!Nt&&xt.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}Bt.insertBefore(this.$overlay,this.$video.nextSibling)}xt.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(At),requestAnimationFrame(()=>{let Lt=window.getComputedStyle(At);Lt.display==="none"&&(At.style.setProperty("display","block","important"),Ut=!0),Lt.visibility!=="visible"&&(At.style.setProperty("visibility","visible","important"),Ut=!0),Ut&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),At.style.opacity="0",At.style.width="0",At.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),At.addEventListener("play",this._onPlay),At.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=Wn.createQrEngine()}static set WORKER_PATH(At){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await Wn.listCameras(!1)).length}catch{return!1}}static async listCameras(At=!1){if(!navigator.mediaDevices)return[];let xt=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(Nt=>Nt.kind==="videoinput"),Bt;try{At&&(await xt()).every(Nt=>!Nt.label)&&(Bt=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await xt()).map((Nt,jt)=>({id:Nt.deviceId,label:Nt.label||(jt===0?"Default Camera":`Camera ${jt+1}`)}))}finally{Bt&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),Wn._stopVideoStream(Bt))}}async hasFlash(){let At;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;At=this.$video.srcObject}else At=(await this._getCameraStream()).stream;return"torch"in At.getVideoTracks()[0].getSettings()}catch{return!1}finally{At&&At!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),Wn._stopVideoStream(At))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(At){throw this._flashOn=!1,At}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),Wn._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:At,facingMode:xt}=await this._getCameraStream();!this._active||this._paused?Wn._stopVideoStream(At):(this._setVideoMirror(xt),this.$video.srcObject=At,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(At){if(!this._paused)throw this._active=!1,At}}stop(){this.pause(),this._active=!1}async pause(At=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let xt=()=>{this.$video.srcObject instanceof MediaStream&&(Wn._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return At?(xt(),!0):(await new Promise(Bt=>setTimeout(Bt,300)),this._paused?(xt(),!0):!1)}async setCamera(At){At!==this._preferredCamera&&(this._preferredCamera=At,await this._restartVideoStream())}static async scanImage(At,xt,Bt,Nt,jt=!1,Ut=!1){let Lt,Ht=!1;xt&&("scanRegion"in xt||"qrEngine"in xt||"canvas"in xt||"disallowCanvasResizing"in xt||"alsoTryWithoutScanRegion"in xt||"returnDetailedScanResult"in xt)?(Lt=xt.scanRegion,Bt=xt.qrEngine,Nt=xt.canvas,jt=xt.disallowCanvasResizing||!1,Ut=xt.alsoTryWithoutScanRegion||!1,Ht=!0):console.warn(xt||Bt||Nt||jt||Ut?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),xt=!!Bt;try{let Vt,zt;[Bt,Vt]=await Promise.all([Bt||Wn.createQrEngine(),Wn._loadImage(At)]),[Nt,zt]=Wn._drawToCanvas(Vt,Lt,Nt,jt);let Wt;if(Bt instanceof Worker){let Jt=Bt;xt||Wn._postWorkerMessageSync(Jt,"inversionMode","both"),Wt=await new Promise((Qt,Xt)=>{let tr,rr,nr,ar=-1;rr=lr=>{lr.data.id===ar&&(Jt.removeEventListener("message",rr),Jt.removeEventListener("error",nr),clearTimeout(tr),lr.data.data!==null?Qt({data:lr.data.data,cornerPoints:Wn._convertPoints(lr.data.cornerPoints,Lt)}):Xt(Wn.NO_QR_CODE_FOUND))},nr=lr=>{Jt.removeEventListener("message",rr),Jt.removeEventListener("error",nr),clearTimeout(tr),Xt("Scanner error: "+(lr?lr.message||lr:"Unknown Error"))},Jt.addEventListener("message",rr),Jt.addEventListener("error",nr),tr=setTimeout(()=>nr("timeout"),1e4);let ir=zt.getImageData(0,0,Nt.width,Nt.height);ar=Wn._postWorkerMessageSync(Jt,"decode",ir,[ir.data.buffer])})}else Wt=await Promise.race([new Promise((Jt,Qt)=>window.setTimeout(()=>Qt("Scanner error: timeout"),1e4)),(async()=>{try{var[Jt]=await Bt.detect(Nt);if(!Jt)throw Wn.NO_QR_CODE_FOUND;return{data:Jt.rawValue,cornerPoints:Wn._convertPoints(Jt.cornerPoints,Lt)}}catch(Qt){if(Jt=Qt.message||Qt,/not implemented|service unavailable/.test(Jt))return Wn._disableBarcodeDetector=!0,Wn.scanImage(At,{scanRegion:Lt,canvas:Nt,disallowCanvasResizing:jt,alsoTryWithoutScanRegion:Ut});throw`Scanner error: ${Jt}`}})()]);return Ht?Wt:Wt.data}catch(Vt){if(!Lt||!Ut)throw Vt;let zt=await Wn.scanImage(At,{qrEngine:Bt,canvas:Nt,disallowCanvasResizing:jt});return Ht?zt:zt.data}finally{xt||Wn._postWorkerMessage(Bt,"close")}}setGrayscaleWeights(At,xt,Bt,Nt=!0){Wn._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:At,green:xt,blue:Bt,useIntegerApproximation:Nt})}setInversionMode(At){Wn._postWorkerMessage(this._qrEnginePromise,"inversionMode",At)}static async createQrEngine(At){if(At&&console.warn("Specifying a worker path is not required and not supported anymore."),At=()=>__vitePreload(()=>import("./qr-scanner-worker.min-D85Z9gVD.js"),[]).then(Bt=>Bt.createWorker()),!(!Wn._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return At();let xt=navigator.userAgentData;return xt&&xt.brands.some(({brand:Bt})=>/Chromium/i.test(Bt))&&/mac ?OS/i.test(xt.platform)&&await xt.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:Bt,platformVersion:Nt})=>/arm/i.test(Bt||"arm")&&13<=parseInt(Nt||"13")).catch(()=>!0)?At():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(At){let xt=Math.round(.6666666666666666*Math.min(At.videoWidth,At.videoHeight));return{x:Math.round((At.videoWidth-xt)/2),y:Math.round((At.videoHeight-xt)/2),width:xt,height:xt,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var At=this.$video,xt=At.videoWidth,Bt=At.videoHeight,Nt=At.offsetWidth,jt=At.offsetHeight,Ut=At.offsetLeft,Lt=At.offsetTop,Ht=window.getComputedStyle(At),Vt=Ht.objectFit,zt=xt/Bt,Wt=Nt/jt;switch(Vt){case"none":var Jt=xt,Qt=Bt;break;case"fill":Jt=Nt,Qt=jt;break;default:(Vt==="cover"?zt>Wt:zt<Wt)?(Qt=jt,Jt=Qt*zt):(Jt=Nt,Qt=Jt/zt),Vt==="scale-down"&&(Jt=Math.min(Jt,xt),Qt=Math.min(Qt,Bt))}var[Xt,tr]=Ht.objectPosition.split(" ").map((nr,ar)=>{const ir=parseFloat(nr);return nr.endsWith("%")?(ar?jt-Qt:Nt-Jt)*ir/100:ir});Ht=this._scanRegion.width||xt,Wt=this._scanRegion.height||Bt,Vt=this._scanRegion.x||0;var rr=this._scanRegion.y||0;zt=this.$overlay.style,zt.width=`${Ht/xt*Jt}px`,zt.height=`${Wt/Bt*Qt}px`,zt.top=`${Lt+tr+rr/Bt*Qt}px`,Bt=/scaleX\(-1\)/.test(At.style.transform),zt.left=`${Ut+(Bt?Nt-Xt-Jt:Xt)+(Bt?xt-Vt-Ht:Vt)/xt*Jt}px`,zt.transform=At.style.transform}})}static _convertPoints(At,xt){if(!xt)return At;let Bt=xt.x||0,Nt=xt.y||0,jt=xt.width&&xt.downScaledWidth?xt.width/xt.downScaledWidth:1;xt=xt.height&&xt.downScaledHeight?xt.height/xt.downScaledHeight:1;for(let Ut of At)Ut.x=Ut.x*jt+Bt,Ut.y=Ut.y*xt+Nt;return At}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var At=Date.now()-this._lastScanTimestamp,xt=1e3/this._maxScansPerSecond;At<xt&&await new Promise(Nt=>setTimeout(Nt,xt-At)),this._lastScanTimestamp=Date.now();try{var Bt=await Wn.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(Nt){if(!this._active)return;this._onDecodeError(Nt)}!Wn._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=Wn.createQrEngine()),Bt?(this._onDecode?this._onDecode(Bt):this._legacyOnDecode&&this._legacyOnDecode(Bt.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",Bt.cornerPoints.map(({x:Nt,y:jt})=>`${Nt},${jt}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(At){At!==Wn.NO_QR_CODE_FOUND&&console.log(At)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let At=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",xt=[{width:{min:1024}},{width:{min:768}},{}],Bt=xt.map(Nt=>Object.assign({},Nt,{[At]:{exact:this._preferredCamera}}));for(let Nt of[...Bt,...xt])try{let jt=await navigator.mediaDevices.getUserMedia({video:Nt,audio:!1}),Ut=this._getFacingMode(jt)||(Nt.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:jt,facingMode:Ut}}catch{}throw"Camera not found."}async _restartVideoStream(){let At=this._paused;await this.pause(!0)&&!At&&this._active&&await this.start()}static _stopVideoStream(At){for(let xt of At.getTracks())xt.stop(),At.removeTrack(xt)}_setVideoMirror(At){this.$video.style.transform="scaleX("+(At==="user"?-1:1)+")"}_getFacingMode(At){return(At=At.getVideoTracks()[0])?/rear|back|environment/i.test(At.label)?"environment":/front|user|face/i.test(At.label)?"user":null:null}static _drawToCanvas(At,xt,Bt,Nt=!1){Bt=Bt||document.createElement("canvas");let jt=xt&&xt.x?xt.x:0,Ut=xt&&xt.y?xt.y:0,Lt=xt&&xt.width?xt.width:At.videoWidth||At.width,Ht=xt&&xt.height?xt.height:At.videoHeight||At.height;return Nt||(Nt=xt&&xt.downScaledWidth?xt.downScaledWidth:Lt,xt=xt&&xt.downScaledHeight?xt.downScaledHeight:Ht,Bt.width!==Nt&&(Bt.width=Nt),Bt.height!==xt&&(Bt.height=xt)),xt=Bt.getContext("2d",{alpha:!1}),xt.imageSmoothingEnabled=!1,xt.drawImage(At,jt,Ut,Lt,Ht,0,0,Bt.width,Bt.height),[Bt,xt]}static async _loadImage(At){if(At instanceof Image)return await Wn._awaitImageLoad(At),At;if(At instanceof HTMLVideoElement||At instanceof HTMLCanvasElement||At instanceof SVGImageElement||"OffscreenCanvas"in window&&At instanceof OffscreenCanvas||"ImageBitmap"in window&&At instanceof ImageBitmap)return At;if(At instanceof File||At instanceof Blob||At instanceof URL||typeof At=="string"){let xt=new Image;xt.src=At instanceof File||At instanceof Blob?URL.createObjectURL(At):At.toString();try{return await Wn._awaitImageLoad(xt),xt}finally{(At instanceof File||At instanceof Blob)&&URL.revokeObjectURL(xt.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(At){At.complete&&At.naturalWidth!==0||await new Promise((xt,Bt)=>{let Nt=jt=>{At.removeEventListener("load",Nt),At.removeEventListener("error",Nt),jt instanceof ErrorEvent?Bt("Image load error"):xt()};At.addEventListener("load",Nt),At.addEventListener("error",Nt)})}static async _postWorkerMessage(At,xt,Bt,Nt){return Wn._postWorkerMessageSync(await At,xt,Bt,Nt)}static _postWorkerMessageSync(At,xt,Bt,Nt){if(!(At instanceof Worker))return-1;let jt=Wn._workerMessageId++;return At.postMessage({id:jt,type:xt,data:Bt},Nt),jt}};e$1.DEFAULT_CANVAS_SIZE=400;e$1.NO_QR_CODE_FOUND="No QR code found";e$1._disableBarcodeDetector=!1;e$1._workerMessageId=0;class QRCodeScanner extends h$2.with(Query,Spinner){static query={video:["#qr_video",!0],videoContainer:["#video_container",!0],camList:["#cam_list",!0],fileInput:["#file_input",!0]};setResult(At){At.data&&(this.stop(),DOM$1.fireEvent(this,"scan",{detail:{data:At.data}}))}start(){e$1.hasCamera().then(At=>{At?this.scanner.start():notify.warning("No camera found")})}stop(){var At,xt;(xt=(At=this==null?void 0:this.scanner)==null?void 0:At.stop)==null||xt.call(At)}firstUpdated(){this.scanner=new e$1(this.video,At=>this.setResult(At),{onDecodeError:At=>{},highlightScanRegion:!0,highlightCodeOutline:!0}),this.videoContainer.append(this.scanner.$canvas)}render(){return ke$2`
      <div id="video_container">
        <video id="qr_video"></video>
      </div>

      <div id="options" flex="end">

        <sl-select id="cam_list" value="environment" @sl-change="${At=>this.scanner.setCamera(At.target.value)}">
          <sl-icon slot="prefix" name="camera"></sl-icon>
          <sl-option value="environment">Front</sl-option>
          <sl-option value="user">Selfie</sl-option>
        </sl-select>

        <sl-button id="file_button" @click="${()=>this.fileInput.click()}">
          <sl-icon slot="prefix" name="upload"></sl-icon>
          Upload QR
          <input id="file_input" type="file" slot="suffix" @change="${At=>{const xt=this.files[0];xt&&e$1.scanImage(xt,{returnDetailedScanResult:!0}).then(Bt=>this.setResult(Bt))}}">
        </sl-button>

      </div>
    `}static styles=[PageStyles,i$7`
      :host {
        display: block;
      }

      #video_container {
        width: 100%;                           
        max-width: clamp(200px, 425px, 42vh);
        aspect-ratio: 1 / 1; 
        margin: 0 auto 1rem; 
        box-sizing: border-box;
      }

      #video_container canvas {
        height: 100%;
        width: 100%;
        border-radius: 4px;
      }

      #options {
        gap: 0 1rem;
      }

      #file_button {
        margin-left: auto;
      }

      #file_input {
        display: none;
      }
    `]}customElements.define("qrcode-scanner",QRCodeScanner);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t=new WeakMap,s=kt=>{if((xt=>xt.pattern!==void 0)(kt))return kt.pattern;let At=t.get(kt);return At===void 0&&t.set(kt,At=new URLPattern({pathname:kt.path})),At};let i$1=class{constructor(At,xt,Bt){this.routes=[],this.o=[],this.t={},this.i=Nt=>{if(Nt.routes===this)return;const jt=Nt.routes;this.o.push(jt),jt.h=this,Nt.stopImmediatePropagation(),Nt.onDisconnect=()=>{var Lt;(Lt=this.o)==null||Lt.splice(this.o.indexOf(jt)>>>0,1)};const Ut=o$1(this.t);Ut!==void 0&&jt.goto(Ut)},(this.l=At).addController(this),this.routes=[...xt],this.fallback=Bt==null?void 0:Bt.fallback}link(At){var xt;if(At!=null&&At.startsWith("/"))return At;if(At!=null&&At.startsWith("."))throw Error("Not implemented");return At??=this.u,(((xt=this.h)==null?void 0:xt.link())??"")+At}async goto(At){let xt;if(this.routes.length===0&&this.fallback===void 0)xt=At,this.u="",this.t={0:xt};else{const Bt=this.p(At);if(Bt===void 0)throw Error("No route found for "+At);const Nt=s(Bt).exec({pathname:At}),jt=(Nt==null?void 0:Nt.pathname.groups)??{};if(xt=o$1(jt),typeof Bt.enter=="function"&&await Bt.enter(jt)===!1)return;this.v=Bt,this.t=jt,this.u=xt===void 0?At:At.substring(0,At.length-xt.length)}if(xt!==void 0)for(const Bt of this.o)Bt.goto(xt);this.l.requestUpdate()}outlet(){var At,xt;return(xt=(At=this.v)==null?void 0:At.render)==null?void 0:xt.call(At,this.t)}get params(){return this.t}p(At){const xt=this.routes.find(Bt=>s(Bt).test({pathname:At}));return xt||this.fallback===void 0?xt:this.fallback?{...this.fallback,path:"/*"}:void 0}hostConnected(){this.l.addEventListener(e.eventName,this.i);const At=new e(this);this.l.dispatchEvent(At),this._=At.onDisconnect}hostDisconnected(){var At;(At=this._)==null||At.call(this),this.h=void 0}};const o$1=kt=>{let At;for(const xt of Object.keys(kt))/\d+/.test(xt)&&(At===void 0||xt>At)&&(At=xt);return At&&kt[At]};class e extends Event{constructor(At){super(e.eventName,{bubbles:!0,composed:!0,cancelable:!1}),this.routes=At}}e.eventName="lit-routes-connected";/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o=location.origin||location.protocol+"//"+location.host;class i extends i$1{constructor(){super(...arguments),this.m=At=>{const xt=At.button!==0||At.metaKey||At.ctrlKey||At.shiftKey;if(At.defaultPrevented||xt)return;const Bt=At.composedPath().find(Ut=>Ut.tagName==="A");if(Bt===void 0||Bt.target!==""||Bt.hasAttribute("download")||Bt.getAttribute("rel")==="external")return;const Nt=Bt.href;if(Nt===""||Nt.startsWith("mailto:"))return;const jt=window.location;Bt.origin===o&&(At.preventDefault(),Nt!==jt.href&&(window.history.pushState({},"",Nt),this.goto(Bt.pathname)))},this.R=At=>{this.goto(window.location.pathname)}}hostConnected(){super.hostConnected(),window.addEventListener("click",this.m),window.addEventListener("popstate",this.R),this.goto(window.location.pathname)}hostDisconnected(){super.hostDisconnected(),window.removeEventListener("click",this.m),window.removeEventListener("popstate",this.R)}}class AppRouter extends i{constructor(At,xt){const Bt=xt.routes;super(At,Bt.map((Nt,jt,Ut)=>{const Lt=Nt.component;return typeof Lt=="string"&&(Nt.component=()=>At.renderRoot.querySelector(Lt)),Nt.enter=async Ht=>{var Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr;(zt=(Vt=this.activeComponent)==null?void 0:Vt.removeAttribute)==null||zt.call(Vt,"route-state"),await Promise.all([(Wt=xt==null?void 0:xt.onRouteChange)==null?void 0:Wt.call(xt,Nt,Ht),(Qt=(Jt=this.activeComponent)==null?void 0:Jt.onRouteLeave)==null?void 0:Qt.call(Jt,Nt,Ht),(Xt=Nt==null?void 0:Nt.onEnter)==null?void 0:Xt.call(Nt,Ht)]),this.activeComponent=await((tr=Nt.component)==null?void 0:tr.call(Nt,Nt,Ht,!0)),(nr=(rr=this.activeComponent)==null?void 0:rr.setAttribute)==null||nr.call(rr,"route-state","active"),(ir=(ar=this.activeComponent)==null?void 0:ar.onRouteEnter)==null||ir.call(ar,Nt,Ht),(lr=Nt==null?void 0:Nt.render)==null||lr.call(this,Ht)},Nt}))}navigateTo=(At,xt={})=>{history.pushState(xt,xt.title||"",At),this.goto(At)};replaceState=(At,xt={})=>{history.replaceState(xt,xt.title||"",At)}}var Po,ko;class ConnectPage extends h$2.with(State,Spinner,Query){constructor(){super();Fn(this,Po);Fn(this,ko);this.profileProtocolEncoded=Convert.string(profile.uri).toBase64Url()}firstUpdated(){DWeb$1.connect.onAuthorizationRequest=async(xt,Bt,Nt)=>(this.origin=xt,this.did=Bt,this.permissions=Nt,new Promise(async(jt,Ut)=>{Pn(this,Po,jt),Pn(this,ko,Ut)})),DWeb$1.connect.onAuthorizationComplete=()=>{this.acceptButton.loading=!1}}allow(){this.acceptButton.loading=!0,rn(this,Po).call(this,{authorize:!0})}deny(){rn(this,ko).call(this,{authorize:!1})}render(){var Nt,jt,Ut,Lt;const xt=(Nt=this.identities)==null?void 0:Nt[this.did],Bt=(Lt=(Ut=(jt=xt==null?void 0:xt.connectRecord)==null?void 0:jt.cache)==null?void 0:Ut.json)==null?void 0:Lt.label;return this.did?ke$2`
      <section flex="center-y column">
        <div id="requestor" flex="center-x center-y" ellipsis>
          <img src="https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${this.origin}&size=128"/>
          ${new URL(this.origin).host||this.origin}
        </div>
        <div>is requesting permissions for this identity:</div>
        <div id="identity" ellipsis>
          <sl-avatar image="${(xt==null?void 0:xt.avatar)||`https://dweb/${this.did}/read/protocols/${this.profileProtocolEncoded}/avatar`}" shape="circle" size="small"></sl-avatar>
          ${(Bt?Bt+"@":"")+this.did}
        </div>
        ${this.permissions.reduce((Ht,Vt)=>{let zt,Wt={};const Jt=[];return Ht.push(ke$2`<h4 ellipsis>${Vt.protocolDefinition.protocol}</h4>`),Vt.permissionScopes.forEach(Qt=>{Qt.interface==="Records"?Jt.push(ke$2`<strong>${Qt.method.toLowerCase()}</strong>`):Qt.interface==="Messages"?Wt[Qt.method]=!0:Qt.interface==="Protocols"&&Qt.method==="Configure"&&(zt=!0)}),Wt=Wt.Query&&Wt.Read&&Wt.Subscribe?ke$2`<strong>sync</strong>`:"",Ht.push(ke$2`<ul class="permission-list">${[zt?ke$2`<li>Modify how this protocol works</li>`:D$1,Jt.length||Wt?ke$2`<li>${Jt}${Wt} data</li>`:D$1]}</ul>`),Ht},[])}
        <div id="user_actions" flex="center-x center-y">
          <sl-button id="accept_button" variant="success" @click="${this.allow}">Accept</sl-button>
          <sl-button id="deny_button" variant="primary" @click="${this.deny}">Deny</sl-button>
        </div>
      </section>`:D$1}}Po=new WeakMap,ko=new WeakMap,ti(ConnectPage,"properties",{identities:{store:"page"},origin:{type:String},permissions:{type:Object}}),ti(ConnectPage,"query",{acceptButton:["#accept_button"]}),ti(ConnectPage,"styles",[PageStyles,i$7`

      :host {
        padding: 0 !important;
      }

      :host > section {
        box-sizing: border-box;
        padding: 1rem 1.25rem;
      }

      :host > section > div {
        box-sizing: border-box;
        margin: 1rem 0;
        text-align: center;
      }

      #requestor, #identity {
        padding: 1rem;
        background: rgb(0 0 0 / 70%);
        border-radius: 10rem;
        border: 1px solid rgb(255 255 255 / 0.2);
      }

      #requestor {
        font-size: 1.5rem;
      }

      #requestor img, sl-avatar {
        --size: 2rem;
        height: var(--size);
        margin: 0 1rem 0 0;
      }

      .permission-list {
        padding: 0 0 0 2rem;
      }

      .permission-list strong:first-child {
        text-transform: capitalize;
      }
      .permission-list strong::before {
        content: ", ";
        font-weight: normal;
      }
      .permission-list strong:first-child::before {
        display: none;
      }
      .permission-list strong:last-child::before {
        content: ", and ";
      }

      #user_actions {
        margin: 2rem 0 0;
      }

      #user_actions sl-button {
        flex: 1;
        margin: 0 1rem;
      }

      @media(max-width: 800px) {

      }
    `]);customElements.define("connect-page",ConnectPage);function generateGradient(kt){if(kt.length<32)throw new Error("Input must be at least 32 bytes long.");const At=3,xt=60,Bt=Array.from(kt,Vt=>Vt.charCodeAt(0)),Nt=80+Bt[0]%15,jt=45+Bt[1]%20,Ut=Bt[2]*1.4%360,Lt=Array.from({length:At}).map((Vt,zt)=>`hsl(${(Ut+zt*xt)%360}, ${Nt}%, ${jt}%)`).join(", ");let Ht=Bt[3]%180;return Ht=Ht<45?Ht+=315:Ht>135?Ht+=90:Ht,`linear-gradient(${Ht}deg, ${Lt})`}const socialApps={x:{profileUrl:"https://twitter.com/",icon:"twitter"},linkedin:{profileUrl:"https://www.linkedin.com/in/"},github:{profileUrl:"https://github.com/"},cash:{profileUrl:"https://cash.app/$",icon:"cash-app"}};class W5Image extends h$2.with(Query){static styles=[i$7`

      :host {
        --size: 6rem;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        width: var(--size);
        height: var(--size);
        flex-shrink: 0;
      }

      #image {
        display: block;
        box-sizing: border-box;
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        border: none;
        opacity: 0;
        transition: opacity 0.3s ease;
        filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 1));
        z-index: 2;
      }

      #image[loaded] {
        opacity: 1;
      }

      [part="fallback"] {
        position: absolute;
        top: 50%;
        left: 50%;
        width: auto;
        margin: 0;
        padding: 0;
        font-size: 3rem;
        z-index: 1;
        transform: translate(-50%, -50%);
        transition: opacity 0.3s ease;
      }

      :host([loaded]) [part="fallback"] {
        opacity: 0;
      }
    `];static properties={src:{type:String,reflect:!0},fallback:{type:String}};static query={image:"#image"};updated(At){At.has("src")&&(this.removeAttribute("loaded"),this.image&&(this.image.removeAttribute("loaded"),this.image.src=this.src))}loaded(){this.setAttribute("loaded",""),this==null||this.image.setAttribute("loaded","")}constructor(){super()}render(){var At;return ke$2`
      <img id="image" part="image" src="${to(this.src)}" @load="${xt=>this.loaded()}" @error="${xt=>DOM.fireEvent(this,"error",{detail:{originalTarget:this}})}"/>
      ${(At=this==null?void 0:this.fallback)!=null&&At.match(/^[a-zA-Z0-9]+:/)?ke$2`<img part="fallback" src="${this.fallback}">`:ke$2`<sl-icon part="fallback" name="${this.fallback||"image"}"></sl-icon>`}
      <slot></slot>
    `}}customElements.define("w5-img",W5Image);var Co,Jo;class DetailBox extends h$2.with(Query){constructor(){super(...arguments);Fn(this,Co)}firstUpdated(){DOM$1.addEventDelegate("click","[detail-box-toggle]",Bt=>{this.toggle()},{container:this}),this.addEventListener("transitionend",Bt=>{Bt.target===this&&Bt.propertyName==="max-height"&&(this.style.maxHeight=this.open?"none":null)}),new ResizeObserver(()=>An(this,Co,Jo).call(this)).observe(this.content),An(this,Co,Jo).call(this)}updated(xt){if(xt.has("open")){const Bt=this.content.scrollHeight;this.open?this.offsetHeight<Bt&&(this.style.maxHeight=Bt+"px"):(this.style.maxHeight=Bt+"px",this.scrollHeight,this.style.removeProperty("max-height"))}super.updated(xt)}toggle(){this.open=!this.open}render(){return ke$2`
      <section id="content" part="content"><slot></slot></section>
      ${this.hideToggle?"":ke$2`<div id="toggle" part="toggle" detail-box-toggle></div>`}
    `}}Co=new WeakSet,Jo=function(){this.content.scrollHeight>this.offsetHeight?this.setAttribute("overflow",""):this.open||this.removeAttribute("overflow")},ti(DetailBox,"styles",[i$7`
      :host {
        display: block;
        max-height: 10em;
        transition: max-height 0.3s ease;
        overflow: hidden;
      }

      #content {
        box-sizing: border-box;
        overflow: hidden;
      }

      #content:has(slot:not(:empty)) {
        padding: 0 0 2.5em;
      }

      #toggle {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: absolute;
        bottom: 0;
        width: 100%;
        font-size: 80%;
        text-align: center;
        overflow: hidden;
        cursor: pointer;
      }

        :host(:not([overflow])) #toggle {
          display: none;
        }

      #toggle::before {
        content: " See More";
        margin: 0.75em 0;
        padding: 0.25em 0.4em 0.35em 0.4em;
        border-radius: 3px;
        background: #000;
        box-shadow: 0 1px 3px 1px rgba(0 0 0 / 75%);
        border: 1px solid rgba(255 255 255 / 25%);
      }

        #toggle:hover::before {
          border-color: rgba(255 255 255 / 50%);
        }

        :host([open]) #toggle::before {
          content: " Close"
        }

      #toggle::after {
        content: "";
        display: block;
        position: absolute;
        bottom: -1em;
        height: 1em;
        width: calc(100% - 3em);
        border-radius: 100%;
        box-shadow: 0 0 1.5em 1em rgba(0 0 0 / 50%);
      }

        :host([open]) #toggle::after {
          opacity: 0.25;
        }
    `]),ti(DetailBox,"properties",{open:{type:Boolean,reflect:!0},hideToggle:{type:Boolean,attribute:"hide-toggle"}}),ti(DetailBox,"query",{content:["#content",!0]});customElements.define("detail-box",DetailBox);async function getCommunity(kt){return await datastore.getCommunity(kt.path.community,{from:kt.did,role:"community/member"})}class InviteItem extends h$2.with(State,Query,Spinner){static styles=[SpinnerStyles,i$7`

      :host {
        position: relative;
        display: flex;
        max-width: 600px;
        border-radius: 0.2em;
        overflow: hidden;
        cursor: default;
      }

        :host * {
          transition: opacity 0.3s ease;
        }

      w5-img {
        margin: 0 1rem 0 0;
        border: 2px solid rgba(200, 200, 230, 0.5);
        border-radius: 0.2rem;
      }

      #content {
        flex: 1;
        position: relative;
        margin: 0 1em 0 0;
      }

      h3 {
        margin: -0.1em 0 0;
        font-size: 110%;
        text-wrap: nowrap;
      }

      p {
        margin: 0.3em 0 0;
      }

      #empty_text, #error_text {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        inset: 0;
        opacity: 0;
        z-index: 1000;
        pointer-events: none;
      }

      #empty_text:before,
      #error_text:before {
        content: attr(data-value);
      }

      :host(:not([drl])) *:not(#empty_text),
      :host([error]) *:not(#error_text),
      :host([loading]) *:not(.spinner-mixin) {
        opacity: 0;
        pointer-events: none;
      }

      :host(:not([drl])) #empty_text,
      :host([error]) #error_text {
        opacity: 1;
        pointer-events: all;
      }

      .spinner-mixin {
        font-size: 1.5rem;
      }

    `];static properties={loading:{type:Boolean,reflect:!0},drl:{type:String,reflect:!0},invite:{type:Object,attribute:!1},error:{type:Boolean,reflect:!0},errorText:{attribute:"error-text",type:String,reflect:!0},emptyText:{attribute:"empty-text",type:String,reflect:!0}};static query={installButton:"#install_button"};willUpdate(At){At.has("invite")&&this.invite&&(this.drl=natives.drl.parse(this.invite.cache.json.link,"/:did/protocols/:protocol/communities/:community"),this.loadInvite())}async loadInvite(){this.error=!1,this.loading=!0,this.startSpinner();const At=this.drl;try{const xt=await getCommunity(At);this.drl===At&&(this.community=xt,this.requestUpdate())}catch{this.error=!0}this.loading=!1,this.stopSpinner()}async installCommunity(){if(this.community){this.installButton.loading=!0;try{await this.context.instance.installCommunity(this.community.id,this.drl.did,this.community),await this.invite.update({data:this.invite.cache.json}),await this.invite.send(this.context.did)}catch(At){console.log(At)}this.installButton.loading=!1}}render(){var xt,Bt;const At=((Bt=(xt=this.community)==null?void 0:xt.cache)==null?void 0:Bt.json)||{};return ke$2`
      <w5-img part="image" src="${to(this.avatarDataUri)}" fallback="people"></w5-img>
      <div id="content">
        <h3 part="name">${At.name||"Unknown Community"}</h3>
        ${At.description?ke$2`<p>${this.description}</p>`:D$1}
      </div>
      <sl-button id="install_button" variant="default" size="small" @click="${Nt=>this.installCommunity(Nt)}">
        <sl-icon slot="prefix" name="plus"></sl-icon>
        Add Community
      </sl-button>
      <div id="empty_text" data-value="${this.emptyText||""}"></div>
      <div id="error_text" data-value="${this.error&&this.errorText||"Couldn't find anything for that"}"></div>
    `}}customElements.define("invite-item",InviteItem);class ProfileView extends h$2.with(State,Query){static query={heroImage:["#hero",!0],tabs:["#tabs",!0],profileForm:["#profile_form",!0],jobModal:["#job_modal",!0],jobForm:["#job_form",!0],qrModal:["#qr_modal",!0],qrCode:["#qr_code",!0],payModal:["#pay_modal",!0],heroInput:["#hero_input",!0],avatarInput:["#avatar_input",!0],profileEditModal:["#profile_edit_modal",!0]};static properties={ready:{type:Boolean,store:"page"},identities:{store:"page"},job:{type:Object},avatar:{type:String},hero:{type:Object},socialData:{type:Object},careerData:{type:Object},did:{type:String,reflect:!0},owner:{type:Boolean,reflect:!0},social:{type:Object},career:{type:Object},loading:{type:Boolean,reflect:!0},loadingError:{type:Boolean,attribute:"loading-error",reflect:!0},loaded:{type:Boolean,reflect:!0},panel:{type:String,reflect:!0}};static paymentTypes={cashtag:{icon:"cash-app",color:"#00c853",newTab:!0,normalize:(At,xt)=>(At=At.replace(/^(?!\$)/,"$"),xt?`https://cash.app/${At}`:At)},ln_address:{icon:"lightning-charge",color:"#cac55c",normalize:(At,xt)=>xt?`lightning:${At}`:At},btc_address:{icon:"currency-bitcoin",color:"#f18f19",normalize:(At,xt)=>xt?`bitcoin:${At}`:At},dap:{icon:"dap-white",color:"#37b4fc",normalize:(At,xt)=>xt?null:At.replace(/^(?!\@)/,"@")}};constructor(){super(),this.profileProtocolEncoded=Convert.string(profile.uri).toBase64Url(),this.clearData()}clearData(){this.social={},this.career={},this.socialData={displayName:"",bio:"",apps:{},payment:{}},this.careerData={jobs:[],skills:[],education:[]}}willUpdate(At){var xt,Bt;At.has("panel")&&((Bt=(xt=this==null?void 0:this.tabs)==null?void 0:xt.show)==null||Bt.call(xt,this.panel||"profile")),At.has("did")&&this.did&&this.loadProfile(this.did)}async loadProfile(At){var xt,Bt,Nt,jt,Ut,Lt;this.loaded=!1,this.loading=!0;try{await this.ready,this.owner=this.identities[At],this.datastore=((xt=this.owner)==null?void 0:xt.datastore)||((Bt=Object.values(this.identities)[0])==null?void 0:Bt.datastore),this.clearData(),this.heroImage.style.setProperty("--deterministic-background",generateGradient(At.split(":")[2]));const Ht=await Promise.all([this.datastore.getSocial({from:this.owner?void 0:At}),this.datastore.getCareer({from:this.owner?void 0:At})]);this.avatar=`https://dweb/${this.did}/read/protocols/${this.profileProtocolEncoded}/avatar`,this.hero=`https://dweb/${this.did}/read/protocols/${this.profileProtocolEncoded}/hero`,this.social=Ht[0],this.career=Ht[1],this.socialData=((jt=(Nt=this.social)==null?void 0:Nt.cache)==null?void 0:jt.json)||this.socialData,this.careerData=((Lt=(Ut=this.career)==null?void 0:Ut.cache)==null?void 0:Lt.json)||this.careerData,this.loadingError=!1,this.loaded=!0,DOM$1.fireEvent(this,"profile-view-load-success")}catch(Ht){console.log(Ht),this.loadingError=!0,DOM$1.fireEvent(this,"profile-view-load-error")}this.loading=!1,DOM$1.fireEvent(this,"profile-view-load-complete")}async handleFileChange(At,xt){await this.ready,await App$1.updateProfileImage(this.owner,At,xt.files[0]),this[At]=this.owner[At]}async saveSocialInfo(At){const xt=new FormData(this.profileForm);for(const Nt of xt.entries())natives.deepSet(this.socialData,Nt[0],Nt[1]||void 0);try{await this.ready,this.social?await this.social.update({data:this.socialData}):this.social=await this.datastore.createSocial({data:this.socialData});var{status:Bt}=await this.social.send(this.did);notify.success("Your profile info was saved")}catch(Nt){console.log(Nt),notify.error("There was a problem saving your profile info")}this.requestUpdate()}showJobModal(At){this.job=At?typeof At=="string"?this.careerData.jobs.find(xt=>xt.id===At):At:{id:natives.randomString(32)},this.jobModal.show()}async saveJob(At=!1){var Nt;if(!this.jobForm.checkValidity()){notify.error("You haven't filled out all the required fields");return}const xt=new FormData(this.jobForm);for(const jt of xt.entries())natives.deepSet(this.job,jt[0],(Nt=jt[1])!=null&&Nt.trim?jt[1].trim():jt[1]||void 0);try{this.careerData.jobs.includes(this.job)||this.careerData.jobs.push(this.job),await this.ready,this.career?await this.career.update({data:this.careerData}):this.career=await this.datastore.createCareer({data:this.careerData});var{status:Bt}=await this.career.send(this.did);notify.success("Job info saved"),At&&this.jobModal.hide()}catch(jt){console.log(jt),notify.error("There was a problem saving this job info")}this.requestUpdate()}onTabShow(At){this.panel=At.detail.name,this.panel}showQrModal(At,xt){this.qrModal.label=At,this.qrCode.value=xt,this.qrModal.show()}render(){var Ut,Lt,Ht,Vt,zt,Wt,Jt,Qt,Xt,tr,rr,nr,ar,ir,lr,yr,Sr,Ar,Dr,Br,Lr;const At=new Date,xt=At.getTime();let Bt={startTime:xt,endTime:0};const Nt=(Lt=(Ut=this==null?void 0:this.careerData)==null?void 0:Ut.jobs)==null?void 0:Lt.reduce((Or,vr)=>{var dr;const pr=((dr=vr==null?void 0:vr.employer)==null?void 0:dr.trim().toLowerCase())||"";return(Or[pr]=Or[pr]||[]).push(vr),vr.startTime=new Date(vr.start_date).getTime(),vr.endTime=vr.end_date?new Date(vr.end_date).getTime():xt,(vr.endTime>Bt.endTime||vr.endTime===Bt.endTime&&vr.startTime<=Bt.startTime)&&(Bt=vr),Or},{}),jt={bio:!((Ht=this==null?void 0:this.socialData)!=null&&Ht.bio),jobs:!((zt=(Vt=this==null?void 0:this.careerData)==null?void 0:Vt.jobs)!=null&&zt.length),apps:!Object.keys(((Wt=this==null?void 0:this.socialData)==null?void 0:Wt.apps)||{}).length};return ke$2`

      <section id="profile_card" flex="column fill">

        <w5-img id="hero" src="${this.hero}">
          <sl-icon-button class="edit-button" name="pencil" size="medium" @click="${Or=>this.heroInput.click()}"></sl-icon-button>
          <input id="hero_input" type="file" accept="image/png, image/jpeg, image/gif" style="display: none" @change="${Or=>this.handleFileChange("hero",this.heroInput)}" />
        </w5-img>

        <div id="basic_info">
          <div id="avatar_wrapper" flex="end">
            <w5-img id="avatar" src="${this.avatar}" fallback="${this.owner?"person-fill-add":"person-fill"}" @click="${Or=>this.avatarInput.click()}">
              <input id="avatar_input" type="file" accept="image/png, image/jpeg, image/gif" style="display: none" @change="${Or=>this.handleFileChange("avatar",this.avatarInput)}" />
            </w5-img>
            ${Object.keys(((Jt=this.socialData)==null?void 0:Jt.payment)||{}).length?ke$2`
              <sl-button class="pay-button" size="small" @click="${Or=>this.payModal.show()}">
                $ Pay
              </sl-button>`:D$1}
            ${this.owner?ke$2`
              <sl-button class="edit-button" size="small" @click="${Or=>this.profileEditModal.show()}">
                Edit profile
              </sl-button>`:D$1}
          </div>
          <div id="profile_name">
            <h2>
              ${this.socialData.displayName||"Anon"} 
              <sl-copy-button value="${this.did}" copy-label="Copy this user's DID"></sl-copy-button>
              <sl-tooltip content="Scan this user's DID">
                <sl-icon-button class="qr_button" name="simple-qr" size="small" @click="${Or=>this.showQrModal("Scan this user's DID",this.did)}"></sl-icon-button>
              </sl-tooltip>
            </h2>
            <small>${this.socialData.tagline||""}</small>
          </div> 
        </div>
      </section>

      <sl-tab-group id="tabs" flex="fill" @sl-tab-show="${this.onTabShow}">
        <sl-tab slot="nav" panel="profile" ?active="${this.panel==="profile"||D$1}">Profile</sl-tab>
        <!-- <sl-tab slot="nav" panel="threads" ?active="${this.panel==="threads"||D$1}">Threads</sl-tab> -->
        <!-- ${this.owner?ke$2`
          <sl-tab slot="nav" panel="notifications" ?active="${this.panel==="notifications"||D$1}">Notifications</sl-tab>
        `:D$1} -->

        <sl-tab-panel id="profile_panel" name="profile" ?active="${this.panel==="profile"||D$1}">
          <section id="profile_about">
            <header flex="center-y">
              <sl-icon name="person-vcard" size="small"></sl-icon>
              <h3>About</h3>
              <sl-icon-button class="edit-button" name="pencil" variant="default" size="medium" @click="${Or=>this.profileEditModal.show()}"></sl-icon-button>
            </header>
            <p class="section-content" empty-text="Tell people about yourself" ?empty="${jt.bio}">${this.socialData.bio||D$1}</p>
          </section>

          <section id="profile_social">
            <header flex="center-y">
              <sl-icon name="at" size="small"></sl-icon>
              <h3>Social</h3>
              <sl-icon-button class="edit-button" name="pencil" variant="default" size="medium" @click="${Or=>this.profileEditModal.show()}"></sl-icon-button>
            </header>
            <div class="section-content" empty-text="Add social links" ?empty="${jt.apps}">
              ${Object.entries(this.socialData.apps).map(Or=>{const vr=Or[0],pr=socialApps[vr];return Or[1]?ke$2`<sl-icon-button name="${(pr==null?void 0:pr.icon)||vr}" target="_blank" href="${pr!=null&&pr.profileUrl?pr.profileUrl+Or[1]:`https://${vr}.com/${Or[1]}`}"></sl-icon-button>`:D$1})}
            </div>
          </section>  
        
          <section id="profile_career">
            <header flex="center-y">
              <sl-icon name="briefcase" size="small"></sl-icon>
              <h3>Career</h3>
              <sl-icon-button class="edit-button" name="plus-lg" variant="default" size="medium" @click="${Or=>this.showJobModal()}"></sl-icon-button>
            </header>
            <detail-box id="job_groups" flex="column-reverse end" class="section-content" empty-text="Where have you worked?" ?empty="${jt.jobs}">
              ${Object.keys(Nt).map((Or,vr)=>{const pr=Nt[Or]=Nt[Or].sort((ur,$r)=>$r.endTime-ur.endTime),dr=Math.round(pr[0].endTime/1e8);return ke$2`<ul class="job-group" style="order: ${dr}">${pr.map(ur=>{ur.id||(ur.id=natives.randomString(32));const $r=new Date(ur.start_date),wr=ur.end_date?new Date(ur.end_date):null,Er=formatDuration(intervalToDuration({start:$r,end:wr||At}),{format:["years","months"]});return ur?ke$2`
                        <li class="job" flex ?latest-job="${ur===Bt||D$1}">
                          <div class="gutter" flex="column center-x">
                            <img src="https://t3.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${ur.url}&size=128"/>
                            ${this.owner&&ke$2`<sl-icon-button name="pencil" variant="default" size="medium" @click="${gr=>this.showJobModal(ur.id)}"></sl-icon-button>`}
                          </div>
                          <div class="content" flex="column align-start">
                            <strong>${ur==null?void 0:ur.title}</strong>
                            <small>${ur==null?void 0:ur.employer}</small>
                            <small>${format($r,"MMM yyy")} - ${wr?format(wr,"MMM yyy"):"Present"}  ${Er}</small>
                            <p>${ur==null?void 0:ur.description}</p>
                          </div>
                        </li>
                      `:D$1})}</ul>`})}
            </detail-box>
          </section> 

          ${!this.owner&&jt.bio&&jt.jobs&&jt.apps?ke$2`
            <div id="empty_profile_placeholder" default-content="placeholder">
              <sl-icon name="incognito"></sl-icon>
              <p>Looks like someone is shy</p>
            </div>
          `:D$1}
        </sl-tab-panel>

        <sl-tab-panel id="threads_panel" name="threads" ?active="${this.panel==="threads"||D$1}">
          <ul id="threads_list"></ul>
          <div default-content="placeholder">
            ${this.owner?ke$2`
              <sl-icon name="card-heading"></sl-icon>
              <sl-button>
                <sl-icon name="plus-lg" slot="prefix"></sl-icon>
                Start your first thread
              </sl-button>
              `:ke$2`
                <sl-icon name="file-earmark-richtext"></sl-icon>
                <p>Nothing to see here yet.</p>
              `}
          </div>
        </sl-tab-panel>

        <!-- ${this.owner?ke$2`
          <sl-tab-panel name="notifications" ?active="${this.panel==="notifications"||D$1}">
            ${[].map(Or=>Or.initialWrite?D$1:ke$2`<invite-item .invite="${Or}"></invite-item>`)}
          </sl-tab-panel>
        `:D$1} -->
      </sl-tab-group>

      <sl-dialog id="profile_edit_modal" class="page-dialog" label="Edit Profile" placement="start">
        <form id="profile_form" @sl-change="${Or=>this.saveSocialInfo(Or)}" @submit="${Or=>Or.preventDefault()}">
          <sl-tab-group>

            <sl-tab slot="nav" panel="bio">Bio</sl-tab>
            <sl-tab slot="nav" panel="social">Social Accounts</sl-tab>
            <sl-tab slot="nav" panel="payment">Payment</sl-tab>
            
            <sl-tab-panel name="bio">
              <sl-input name="displayName" value="${this.socialData.displayName}" label="Display Name" help-text="A public name visible to everyone"></sl-input>
              <sl-input name="tagline" value="${this.socialData.tagline}" label="What you do" help-text="Your title or personal tagline" maxlength="80"></sl-input>
              <sl-textarea name="bio" value="${this.socialData.bio}" label="About" help-text="Tell people a little more about yourself" rows="4" resize="none"></sl-textarea>
            </sl-tab-panel>

            <sl-tab-panel name="social">
              <sl-input label="X (Twitter)" name="apps.x" value="${this.socialData.apps.x}" class="label-on-left"></sl-input>
              <sl-input label="Instagram" name="apps.instagram" value="${this.socialData.apps.instagram}" class="label-on-left"></sl-input>
              <sl-input label="Facebook" name="apps.facebook" value="${this.socialData.apps.facebook}" class="label-on-left"></sl-input>
              <sl-input label="GitHub" name="apps.github" value="${this.socialData.apps.github}" class="label-on-left"></sl-input>
              <sl-input label="LinkedIn" name="apps.linkedin" value="${this.socialData.apps.linkedin}" class="label-on-left"></sl-input>
              <sl-input label="Tidal" name="apps.tidal" value="${this.socialData.apps.tidal}" class="label-on-left"></sl-input>
              <sl-input label="Cash" name="apps.cash" value="${this.socialData.apps.cash}" class="label-on-left"></sl-input>
            </sl-tab-panel>

            <sl-tab-panel name="payment">
              <sl-input label="Cashtag" name="payment.cashtag" value="${(Xt=(Qt=this.socialData)==null?void 0:Qt.payment)==null?void 0:Xt.cashtag}" class="label-on-left"></sl-input>
              <sl-input label="Bitcoin Address" name="payment.btc_address" value="${(rr=(tr=this.socialData)==null?void 0:tr.payment)==null?void 0:rr.btc_address}" class="label-on-left"></sl-input>
              <sl-input label="Lightning Address" name="payment.ln_address" value="${(ar=(nr=this.socialData)==null?void 0:nr.payment)==null?void 0:ar.ln_address}" class="label-on-left"></sl-input>
              <sl-input label="DAP" name="payment.dap" value="${(lr=(ir=this.socialData)==null?void 0:ir.payment)==null?void 0:lr.dap}" class="label-on-left"></sl-input>
            </sl-tab-panel>
          </sl-tab-group>
        </form>
        <sl-button slot="footer" variant="primary" @click="${Or=>this.profileEditModal.hide()}">Submit</sl-button>
      </sl-dialog> 
      
      <sl-dialog id="job_modal" class="page-dialog dialog-deny-close" label="Edit Job" placement="start">
        <form id="job_form" @submit="${Or=>{Or.preventDefault(),this.saveJob()}}">   
          <sl-input name="employer" required value="${(yr=this==null?void 0:this.job)==null?void 0:yr.employer}" label="Employer" help-text="What was the name of your employer?"></sl-input>
          <sl-input name="url" required value="${(Sr=this==null?void 0:this.job)==null?void 0:Sr.url}" label="Employer Website" pattern="https?://.+" help-text="Enter the URL of the company"></sl-input>
          <sl-input name="title" required value="${(Ar=this==null?void 0:this.job)==null?void 0:Ar.title}" label="Job Title" help-text="What was your job title?"></sl-input>
          <div flex="center-y gap-medium">
            <sl-input name="start_date" required value="${(Dr=this==null?void 0:this.job)==null?void 0:Dr.start_date}" type="date" label="Start date"></sl-input>
            <sl-input name="end_date" value="${(Br=this==null?void 0:this.job)==null?void 0:Br.end_date}" type="date" label="End date"></sl-input>
          </div>
          <sl-textarea name="description" required value="${(Lr=this==null?void 0:this.job)==null?void 0:Lr.description}" label="Job Description" help-text="What did you do there?" rows="4"></sl-textarea>
        </form>
        <sl-button slot="footer" variant="danger" @click="${Or=>this.jobModal.hide()}">Cancel</sl-button>
        <sl-button slot="footer" variant="primary" @click="${Or=>this.saveJob(!0)}">Save</sl-button>
      </sl-dialog>

      <sl-dialog id="pay_modal" class="page-dialog" label="Payment" placement="start">
        ${Object.entries(this.socialData.payment||{}).map(([Or,vr])=>{var dr;if(!vr)return D$1;let pr=(dr=ProfileView.paymentTypes)==null?void 0:dr[Or];if(pr){let ur=(pr==null?void 0:pr.normalize(vr))||vr,$r=pr==null?void 0:pr.normalize(vr,!0);return ke$2`
              <div class="payment-type" flex>
                <sl-icon name="${pr.icon}" style="color: ${pr.color||"#fff"}"></sl-icon>
                <a href="${$r||D$1}" target="${pr.newTab?"_blank":D$1}">
                  ${ur}
                </a>
                <sl-copy-button value="${ur}" copy-label="Copy"></sl-copy-button>
                <sl-tooltip content="Show QR">
                  <sl-icon-button class="qr_button" name="simple-qr" size="small" @click="${wr=>this.showQrModal(ur,$r||ur)}"></sl-icon-button>
                </sl-tooltip>
              </div>
            `}else return D$1})}
      </sl-dialog>

      <sl-dialog id="qr_modal" class="page-dialog" placement="start" fit-content>
        <sl-qr-code id="qr_code"></sl-qr-code>
      </sl-dialog>
    `}static styles=[PageStyles,i$7`

      :host {
        --avatar-size: clamp(6em, 18vw, 9em);
        --block-padding: calc(var(--avatar-size) * 0.2);
        --hero-border-size: clamp(0.2em, 1vw, 0.4em);
        --hero-border: var(--hero-border-size) solid rgba(0 0 0 / 15%);
        position: relative;
        display: flex;
        box-sizing: border-box;
        justify-content: center;
        flex-direction: column;
        max-width: var(--content-max-width);
        background: var(--grey);
        border-radius: var(--block-radius);
        box-shadow: var(--block-shadow);
        overflow: hidden;
        cursor: default;
      }

      :host(:not([owner])) .edit-button {
        visibility: hidden;
        pointer-events: none;
      }

      form {
        max-width: 600px;
        margin: 0 auto;
      }

      sl-input, sl-textarea {
        margin: 0 0 1em;
      }

      sl-tab-panel {
        padding: 0.5em 1.5em;
      }

      #profile_card {
        position: relative;
        flex: 0;
        min-width: 250px;
        margin: 0 0 1.5em;
      }

      #hero {
        position: relative;
        width: 100%;
        height: calc(var(--avatar-size) * 1.3);
        background: var(--deterministic-background);
      }

      #hero::after {
        content: "";
        box-sizing: border-box;
        position: absolute;
        inset: 0;
        border: 1px solid rgba(255 255 255 / 7%);
        border-bottom: var(--hero-border);
        border-radius: var(--block-radius) var(--block-radius) 0 0;
        z-index: 2;
      }

      #hero[src][loaded] {
        background: none;
      }

      #hero::part(fallback) {
        display: none;
      }

      #hero sl-icon-button {
        position: absolute;
        top: 1em;
        right: 1em;
        background: rgba(0 0 0 / 0.6);
        border-radius: 100%;
        cursor: pointer;
        z-index: 3;
      }

      #basic_info {
        margin: 0 0 0 var(--block-padding);
      }

      #avatar_wrapper {
        height: 2.75em;
        margin: 0 0 1.1em;
      }

      #avatar_wrapper sl-button {
        margin: 0.75em 0.75em 0 0;
      }

      #avatar_wrapper sl-button:first-of-type {
        margin-left: auto;
      }

      #avatar {
        --size: var(--avatar-size);
        position: absolute;
        background: var(--grey-lighter);
        outline: var(--hero-border);
        box-shadow: 0 1px 1px 0px rgba(0 0 0 / 0.6);
        border-radius: 6px;
        z-index: 2;
        cursor: pointer;
      }

      #profile_name {
        position: relative;
        margin: 0 0 0.5em 0.1em;
        z-index: 2;
      }

      #profile_name h2 {
        margin: 0 0 0.2em;
        /* font-size: calc(var(--avatar-size) * 0.2); */
      }

      sl-copy-button {
        font-size: 0.925rem;
        opacity: 0.5;
        transition: opacity 0.3s ease;
      }

      #profile_name sl-copy-button:hover {
        opacity: 1;
      }

      .qr_button {
        font-size: 0.95rem;
      }

      .qr_button::part(base) {
        padding-left: 0;
        padding-right: 0;
      }

      #profile_name small {
        color: #777;
      }

      #tabs {
        flex: 1;
      }

      #tabs::part(body),
      #tabs sl-tab-panel::part(base),
      #tabs sl-tab-panel[active] {
        display: flex;
        flex-direction: column;
        flex: 1;
      }

      #tabs::part(base) {
        width: 100%;
      }

      #tabs::part(tabs) {
        box-sizing: border-box;
        background: rgba(0 0 0 / 15%);
        border: solid 1px var(--track-color);
        border-left: none;
        border-right: none;
      }

      #tabs::part(active-tab-indicator) {
        bottom: 0;
      }

      #tabs sl-tab-panel {
        flex: 1;
      }

      #empty_profile_placeholder sl-icon {
        margin-bottom: 0;
      }

      #tabs sl-tab-panel [default-content~="placeholder"]{
        flex: 1;
        padding: 0 0 2rem;
      }

      #profile_panel > section {
        margin: 0 0 2em;
      }

      #profile_panel > section:last-child {
        margin: 0 0 1em;
      }

      /* #profile_panel > section :last-child {
        margin-bottom: 0;
      } */

      :host(:not([owner])) #profile_panel > section:has([empty]) {
        display: none;
      }

      #profile_panel header {
        margin: 0 0 1em;
        border-bottom: 2px dotted rgba(255 255 255 / 0.05);
      }

      #profile_panel header sl-icon {
        margin-top: -0.15em;
        color: #bbb;
      }

        #profile_social header sl-icon::part(svg) {
          margin-top: -0.1em;
          font-size: 1.3em;
        }

      #profile_panel h3 {
        margin: 0 auto 0.2em 0.5em;
        font-weight: normal;
      }

      #profile_about .section-content {
        white-space: pre-wrap;
      }

      #profile_panel [empty-text][empty] {
        text-align: center;
      }

      #profile_social .section-content sl-icon-button {
        font-size: 1.5em;
      }

      #profile_career {
        position: relative;
      }

      #profile_career header {
        margin: 0 0 1.5em;
      }

      #job_groups {
        max-height: 20em;
      }

      #job_groups::part(content) {
        display: flex;
        flex-direction: column-reverse;
        justify-content: flex-end;
      }

      .job-group {
        margin: 1.25em 0 0;
        padding: 1.75em 0 0.5em;
        border-top: 1px solid rgba(255 255 255 / 0.05)
      }

      .job-group:has([latest-job]) {
        order: 1000000 !important;
        margin-top: 0;
        padding-top: 0.25em;
        border: none;
      }

      .job:not(:last-child) {
        margin: 0 0 1.5em;
      }

      .job img {
        box-sizing: border-box;
        width: 4em;
        padding: 0.2em;
        border: 1px solid rgba(255 255 255 / 0.25);
        border-radius: 6px;
      }

      .job .gutter {
        min-width: 4em;
        margin: 0 1em 0 0;
        font-size: clamp(0.6rem, 3vw, 1rem);
      }

      .job .content > :last-child {
        margin-bottom: 0;
      }

      .job:not(:first-child) .gutter img {
        width: 2.6em;
      }

      .job:not(:last-child) .gutter::after {
        content: "";
        display: block;
        flex: 1;
        width: 3px;
        background: rgba(255 255 255 / 0.2);
        margin: 0.7em 0 0;
        border-radius: 3px;
      }

      .job .gutter sl-icon-button {
        margin: 0.6em 0 0;
      }

      .job strong {
        margin: 0 0 0.4em;
        font-weight: normal;
      }

      .job small {
        margin: 0 0 0.2em;
        color: rgba(255 255 255 / 0.6);
      }

      .job p {
        white-space: pre-wrap;
      }

      .label-on-left {
        --label-width: 5.5rem;
        --gap-width: 1rem;
      }

      .label-on-left + .label-on-left {
        margin-top: var(--sl-spacing-medium);
      }

      .label-on-left::part(form-control) {
        display: grid;
        grid: auto / var(--label-width) 1fr;
        gap: var(--sl-spacing-3x-small) var(--gap-width);
        align-items: center;
      }

      .label-on-left::part(form-control-label) {
        text-align: right;
      }

      .label-on-left::part(form-control-input) {
        min-width: 0;
      }
        

      .label-on-left::part(form-control-help-text) {
        grid-column-start: 2;
      }

      #profile_edit_modal::part(body) {
        padding: 0;
      }

      #profile_edit_modal sl-tab-panel {
        height: 27em;
      }

      #qr_modal::part(title) {
        padding-right: 0;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      #qr_modal::part(panel) {
        max-width: 20em;
      }

      #qr_modal::part(body) {
        margin: 0 auto;
      }

      #qr_modal sl-qr-code {
        padding: 1em;
        background: #fff;
        border-radius: 0.25rem;
      }

      #qr_modal sl-qr-code::part(base) {  
        width: 100% !important;
        max-width: 15rem;
        height: auto !important;
        aspect-ratio: 1 / 1;
      }

      #pay_modal .payment-type {
        margin: 0 0 1.5em;
        font-size: 1.25em;
        align-items: center; 
      }

      #pay_modal .payment-type:last-child {
        margin: 0 0 0.5em;
      }

      #pay_modal .payment-type a {
        overflow: hidden;
        text-decoration: none;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      #pay_modal .payment-type sl-icon {
        font-size: 1.25em;
        margin: 0 0.25em 0 0;
      }

      @media(max-width: 500px) {
        :host {
          border-radius: 0;
        }

        #hero::after {
          display: none;
        }
      }

    `]}customElements.define("profile-view",ProfileView);class FindPage extends h$2.with(State,Query,Spinner){static properties={identities:{store:"page"},did:{type:String}};static query={searchInput:"#search_input",profileView:"#profile_view"};constructor(){super(),this.path={}}onRouteEnter(At,xt){this.path=xt,this.loadDid()}firstUpdated(){this.componentReady=!0,this.loadDid()}async loadDid(){if(this.componentReady){const At=this.path.did;this.did&&!At&&router.navigateTo(`/profiles/${this.did}`),At&&At!==this.did&&(this.searchInput.value=At,await this.startSpinner({minimum:1e3,fixed:!0}),this.did=At)}}async onLoadComplete(){this.stopSpinner()}lookupProfile(At=this.searchInput.value){!At||At===this.did||At!==this.path.did&&router.navigateTo(`/profiles/${At}`)}render(){return ke$2`
      <header id="search_bar" flex="center-y center-x" hide-on-overlay>
        <sl-input id="search_input"
                  clearable
                  value="${to(this.did)}"
                  required
                  size="small"
                  placeholder="Enter a DID to view a profile"
                  pattern="did:dht:[a-zA-Z0-9]+"
                  @sl-clear="${At=>this.did=""}"
                  @keydown="${At=>At.key==="Enter"&&this.lookupProfile()}"
                  @keypress="${At=>/^[a-zA-Z0-9_\-:.]+$/.test(String.fromCharCode(At.charCode||At.which))?!0:At.preventDefault()}"
        ></sl-input>
        <sl-button variant="primary" size="small" @click="${At=>this.lookupProfile()}" slot="suffix">Find</sl-button>
      </header>
      <section>
        <profile-view id="profile_view" did="${to(this.did)}" @profile-view-load-complete="${this.onLoadComplete}"></profile-view>
        <div id="placeholder" default-content="cover placeholder">
          <sl-icon name="search"></sl-icon>
          <p>Enter a DID above to view a profile.</p>
        </div>
      </section>
    `}static styles=[PageStyles,SpinnerStyles,i$7`

      /* :host {
        padding: 0 !important;
      } */

      .spinner-mixin {
        z-index: 0;
      }

      connect-widget {
        align-self: center;
      }

      #search_bar {
        position: sticky;
        top: var(--header-height);
        height: var(--subheader-height);
        box-sizing: border-box;
        padding: 0 0.8rem 0;
        border-bottom: 1px solid rgba(255 255 255 / 1%);
        box-shadow: 0 2px 1px -1px rgba(0 0 0 / 40%);
        background: hsl(240deg 7% 15% / 90%);
        backdrop-filter: blur(10px) saturate(100%);
        -webkit-backdrop-filter: blur(10px) saturate(100%);
        z-index: 1;
      }

      #search_bar sl-input {
        flex: 1;
        max-width: 700px;
        margin: 0 0.5em 0 0;
        transition: transform 0.4s ease;
      }
      
      profile-view {
        width: 100%;
        max-width: var(--content-max-width);
        margin: 0 auto;
        opacity: 0;
        transition: opacity 0.3s;
        z-index: 0;
      }

      profile-view[loaded] {
        opacity: 1;
        /* height: 3000px; */
      }

      #placeholder {
        z-index: 0;
      }

        profile-view[did] ~ #placeholder {
          opacity: 0;
          visibility: hidden;
          z-index: -1;
        }

      #placeholder sl-icon{
        color: var(--sl-color-primary-600);
      }

      .spinner-mixin {
        --inset: var(--header-height) 0 0 var(--nav-width);
      }

      @media(max-width: 800px) {
        #search_bar {
          left: 0;
        }
        .spinner-mixin {
          --inset: var(--header-height) 0 0 0;
        }
      }  

      @media(max-width: 500px) {

        :host {
          background: var(--grey);
        }

        :host > section {
          padding: 0;
        }

        profile-view {
          border: none;
          box-shadow: none;
          background: none;
        }
      }
    `]}customElements.define("find-page",FindPage);class CreateIdentity extends h$2.with(State,Query){static properties={identities:{store:"page"}};static query={createIdentityLabel:"#create_identity_label",createIdentityButton:"#create_identity_button"};render(){return ke$2`
      <sl-input id="create_identity_label" label="Add a Label" placeholder="Ex: social, career" pattern="^[a-zA-Z0-9]{3,}$" required></sl-input>
      <sl-button id="create_identity_button" variant="success" @click="${async At=>{const xt=this.createIdentityLabel.value||"";if(!/^[a-zA-Z0-9]{3,}$/.test(xt)){DOM$1.fireEvent(this,"invalid-label");return}if(this.createIdentityButton.loading)return!1;this.createIdentityButton.loading=!0;const Nt=await DWeb$1.identity.create({dwnEndpoints:["http://localhost:3000"]});await DWeb$1.identity.addAutofillDid(xt+"@"+Nt.did.uri),App$1.addIdentity(Nt),this.createIdentityButton.loading=!1,DOM$1.fireEvent(this,"identity-created",{detail:{identity:Nt}})}}">
        Create
      </sl-button>
    `}static styles=[PageStyles,i$7`
      #create_identity_button {
        display: block;
        margin: 1.5rem auto 0;
      }
    `]}customElements.define("create-identity",CreateIdentity);class IdentitiesPage extends h$2.with(State,Query,Spinner){static properties={ready:{store:"page"},identities:{store:"page"},identityEndpointUpdate:{type:Object}};static query={createIdentityButton:"#create_identity_button",createIdentityModal:["#create_identity_modal",!0],restoreIdentityButton:"#restore_identity_button",modifyEndpointsModal:["#modify_endpoints_modal",!0]};constructor(){super(),this.lastIdentityLabelSave=Date.now(),this.profileProtocolEncoded=Convert.string(profile.uri).toBase64Url()}firstUpdated(){this.ready.state||this.startSpinner({target:"section",minimum:500,renderImmediate:!0}),this.ready.then(()=>{this.stopSpinner()})}toggleIdentityDetails(At){const xt=At.currentTarget,Bt=xt.closest("li").querySelector("detail-box");Bt.toggle(),xt.firstElementChild.name=Bt.open?"chevron-up":"chevron-down"}generateEndpointItems(At,xt,Bt){return(At.did.document.service||[]).reduce((Nt,jt)=>{if(!Nt&&jt.type==="DecentralizedWebNode"){let Ut=jt.serviceEndpoint||[];Ut=Array.isArray(Ut)?Ut:[Ut],Bt&&(Ut=this.identityEndpointUpdate.endpoints=this.identityEndpointUpdate.endpoints||[...Ut]),Nt=xt(Ut,At)}return Nt},null)}openEndpointModal(At){(!this.identityEndpointUpdate||this.identityEndpointUpdate.identity!==At)&&(this.identityEndpointUpdate={identity:At}),this.modifyEndpointsModal.show()}closeEndpointModal(){this.modifyEndpointsModal.hide()}async updateEndpoints(At){if(!this.identityEndpointUpdate)return;const{identity:xt,endpoints:Bt}=this.identityEndpointUpdate;console.log(Bt);try{const Nt=await DWeb.did.update(xt,jt=>{const Ut=jt.service.find(Lt=>Lt.type==="DecentralizedWebNode");Ut&&(Ut.serviceEndpoint=Bt.reduce((Lt,Ht)=>(Ht=Ht.trim(),Ht.length&&Lt.push(Ht),Lt),[])),Ut.serviceEndpoint=Bt});return At&&this.closeEndpointModal(),Nt}catch{}}async saveIdentityLabel(At,xt){var jt,Ut,Lt;console.log(At);let Bt=At.target.value.trim().toLowerCase(),Nt=((Lt=(Ut=(jt=xt.connectRecord)==null?void 0:jt.cache)==null?void 0:Ut.json)==null?void 0:Lt.label)||"";Bt&&Bt!==Nt&&Date.now()>this.lastIdentityLabelSave+2e3&&(this.lastIdentityLabelSave=Date.now(),await App$1.saveIdentityLabel(xt,Bt).then(Ht=>notify.success("Your profile info was saved")).catch(Ht=>{Ht.target.value=Nt,notify.error("There was an error saving your new label for this identity")}))}render(){var xt;const At=Object.values(this.identities||{});return ke$2`
      <section page-section>
        ${At!=null&&At.length?ke$2`
            <h2 flex>
              Identities

              <sl-dropdown id="identity_actions">
                <sl-button size="small" slot="trigger" caret>Actions</sl-button>
                <sl-menu>
                  <sl-menu-item @click="${Bt=>this.createIdentityModal.show()}">
                    <sl-icon slot="prefix" name="person-plus"></sl-icon> Create an Identity
                  </sl-menu-item>
                  <sl-menu-item @click="${Bt=>App$1.restoreIdentityModal.show()}">
                    <sl-icon slot="prefix" name="person-up"></sl-icon> Restore an Identity
                  </sl-menu-item>
                  <sl-menu-item @click="${Bt=>App$1.qrScannerModal.show()}">
                    <sl-icon slot="prefix" name="window-stack"></sl-icon> Connect an App
                  </sl-menu-item>
                </sl-menu>
              </sl-dropdown>

            </h2>
            <ul id="identity_list" limit-width>
              ${At.map(Bt=>{var jt,Ut,Lt;const Nt=Bt.connectedDid;return ke$2`
                <li>
                  <div flex="center-y">
                    <a href="/profiles/${Nt}">
                      <sl-avatar image="${Bt.avatar||`https://dweb/${Nt}/read/protocols/${this.profileProtocolEncoded}/avatar`}" shape="circle" size="small"></sl-avatar>
                      ${Nt}
                    </a> 
                    <sl-button detail-box-toggle circle size="small" @click="${this.toggleIdentityDetails}">
                      <sl-icon name="chevron-down"></sl-icon>
                    </sl-button>
                  </div>
                  <detail-box hide-toggle>
                    <div>
                      <div columns="2 labels-right">
                        <span>Identity Label:</span>
                        <div>
                          <sl-input size="small" value="${(Lt=(Ut=(jt=Bt==null?void 0:Bt.connectRecord)==null?void 0:jt.cache)==null?void 0:Ut.json)==null?void 0:Lt.label}" autocomplete="off" placeholder="Ex: social, career, family" 
                            @sl-input="${Ht=>Ht.target.value=Ht.target.value.trim().toLowerCase()}"
                            @sl-change="${Ht=>this.saveIdentityLabel(Ht,Bt)}"
                          ></sl-input>
                        </div>

                        <span>Backup:</span>
                        <div>
                          <sl-button size="small" @click="${Ht=>DWeb.identity.backup(Bt,{to:"file"})}">
                            <sl-icon slot="prefix" name="download"></sl-icon> Download identity backup
                          </sl-button>
                        </div>
                      </div>

                      <h3 flex="center-y">
                        <span>Datastore Locations</span>
                        <sl-icon-button name="pencil" variant="default" size="medium" @click="${Ht=>this.openEndpointModal(Bt)}"></sl-icon-button>
                      </h3>
                      ${this.generateEndpointItems(Bt,Ht=>ke$2`<div>${Ht.join("<br>")}</div>`)}
                    </div>
                  </detail-box>
                </li>
              `})}
            </ul>
            <!-- <div id="create_restore_buttons" flex="center-x center-y">
              <sl-button id="create_identity_button" variant="success" size="small" @click="${Bt=>this.createIdentityModal.show()}">
                <sl-icon slot="prefix" name="person-plus"></sl-icon> Create an Identity
              </sl-button>
              <sl-button id="restore_identity_button" variant="primary" size="small" @click="${Bt=>App$1.restoreIdentityModal.show()}">
                <sl-icon slot="prefix" name="person-up"></sl-icon> Restore an Identity
              </sl-button>
              <sl-button id="restore_identity_button" variant="primary" size="small" @click="${Bt=>App$1.qrScannerModal.show()}">
                <sl-icon slot="prefix" name="window-stack"></sl-icon> Connect an App
              </sl-button>
            </div> -->
          `:ke$2`
            <connect-widget></connect-widget>
          `}
      </section>

      <sl-dialog id="create_identity_modal" label="Create an Identity" placement="start" fit-content>
        <create-identity @identity-created="${Bt=>this.createIdentityModal.hide()}"></create-identity>
      </sl-dialog>

      <sl-dialog id="modify_endpoints_modal" label="Modify Endpoints" placement="start" @sl-after-hide="${Bt=>this.identityEndpointUpdate=null}">
        <div id="modify_endpoints_identity" flex="center-y">
          ${this.identityEndpointUpdate?ke$2`
                <sl-avatar image="${((xt=this.identityEndpointUpdate.identity)==null?void 0:xt.avatar)||`https://dweb/${this.identityEndpointUpdate.identity.connectedDid}/read/protocols/${this.profileProtocolEncoded}/avatar`}" shape="circle" size="small"></sl-avatar>
                <div>${this.identityEndpointUpdate.identity.connectedDid}</div>
              `:D$1}
        </div>
        <p>This is an advanced feature to edit the datastore locations of the DID above. Do not change these values unless you know what you are doing.</p>
        <section>
          ${this.identityEndpointUpdate?this.generateEndpointItems(this.identityEndpointUpdate.identity,Bt=>Bt.map((Nt,jt)=>ke$2`
                  <div index="${jt}" class="service-endpoint-entry" flex="center-y">

                    <sl-input class="service-endpoint-input" size="small" value="${Nt}" @input="${Ut=>{Bt[jt]=Ut.target.value}}"></sl-input>

                    <sl-button class="remove-endpoint-button" size="small" @click="${Ut=>{Bt.splice(jt,1),this.identityEndpointUpdate={...this.identityEndpointUpdate}}}">
                        <sl-icon slot="prefix" name="x-lg">
                      </sl-icon>
                    </sl-button>

                    <sl-button class="add-endpoint-button" size="small" @click="${Ut=>{Bt.push(""),this.identityEndpointUpdate={...this.identityEndpointUpdate}}}">
                      <sl-icon slot="prefix" name="plus-lg"></sl-icon>
                    </sl-button>
                  </div>
                `),!0):D$1}
        </section>
        <sl-button id="close_endpoints_button" slot="footer" @click="${async Bt=>this.closeEndpointModal()}">Close</sl-button>
        <sl-button id="submit_endpoints_button" slot="footer" variant="success" @click="${async Bt=>this.updateEndpoints(!0)}">Submit</sl-button>
      </sl-dialog>

      
    `}static styles=[PageStyles,SpinnerStyles,i$7`
      :host > section {
        
      }

      #identity_actions {
        margin-left: auto;
      }

      connect-widget {
        align-self: center;
      }

      #identity_list li {
        --border: 1px solid rgb(255 255 255 / 8%);
        list-style: none;
        border-bottom: var(--border);
      }

      #identity_list li:first-child {
        border-top: var(--border);
      } 

      #identity_list a {
        width: 100%;
        padding: 1.1rem 0 1rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        text-decoration: none;
        color: var(--sl-color-blue-700);
        cursor: pointer;
      }

      #identity_list sl-avatar {
        --size: 2.25rem;
        margin: 0 0.5rem 0 0;
      }

      #identity_list [detail-box-toggle] {
        margin: 0 0 0 0.75rem;
      }

      #identity_list detail-box {
        max-height: 0;
      }

      #identity_list detail-box > :first-child {
        margin-bottom: 1rem;
        padding: 1.2rem 1.1rem;
        background: rgb(183 192 254 / 4%);
        border: 1px solid rgb(183 192 254 / 9%);
        border-radius: 5px;
      }

      #identity_list detail-box h3 {
        margin: 1.75rem 0 1rem;
        border-bottom: 1px solid rgba(255 255 255 / 8%);
        padding: 0 0 0.25rem;
      }

      #identity_list detail-box h3 :not(span) {
        margin: 0 0 0 auto;
      }

      #create_restore_buttons {
        margin: 2rem 0 0;
      }

      #create_restore_buttons sl-button {
        margin: 0 0.5rem;
      }

    /* Modify Endpoints Dialog */

      #modify_endpoints_modal::part(panel) {
        max-width: 500px;
      }

      .service-endpoint-entry:not(:last-child) {
        margin-bottom: 1rem;
      }

      .service-endpoint-input {
        flex: 1;
        margin: 0;
      }

      .service-endpoint-input ~ sl-button {
        margin: 0 0 0 0.5rem;
      }

      .service-endpoint-entry sl-icon {
        stroke: currentColor;
      }

      .service-endpoint-entry .remove-endpoint-button::part(base) {
        color: #ff2e2e;
      }

      .service-endpoint-entry .add-endpoint-button::part(base) {
        color: #00ba00;
      }

      .service-endpoint-entry:not(:last-child) .add-endpoint-button {
        visibility: hidden;
        pointer-events: none;
      }

      #modify_endpoints_identity sl-avatar {
        --size: 2.25rem;
        margin: 0 0.6rem 0 0;
      }

      #modify_endpoints_identity div {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      #modify_endpoints_modal p {
        margin: 1rem 0 1.5rem;
        color: var(--sl-color-red-700);
      }

      @media(max-width: 800px) {

      }
    `]}customElements.define("identities-page",IdentitiesPage);activatePolyfills();class AppView extends h$2.with($App,State,Query){static query={appLayout:["#app_layout",!0],connectModal:["#connect_modal",!0],pages:["#pages",!0],connectPage:["#connect",!0],connectRequestModal:["#connect_request_modal",!0],pinModal:["#pin_modal",!0],pinModalContent:["#pin_modal_content",!0],profilePage:["#profile",!0],directoryPage:["#directory",!0],identitiesPage:["#identities",!0],restoreIdentityModal:["#restore_identity_modal",!0],restoreUploader:["#restore_uploader",!0],qrScannerModal:["#qr_scanner_modal",!0],qrScanner:["#qr_scanner",!0]};constructor(){super(),this.router=globalThis.router=new AppRouter(this,{onRouteChange:async(At,xt)=>{this.appLayout&&matchMedia("(max-width: 800px)").matches&&(this.appLayout.drawerOpened=!1)},routes:[{path:"/",component:"#identities"},{path:"/profiles(/)?:did?",component:"#find"},{path:"/dweb-connect(/.*)?",component:"#connect"}]}),DOM$1.addEventDelegate("sl-show","sl-dialog",(At,xt)=>{document.documentElement.setAttribute("overlay-active","")}),DOM$1.addEventDelegate("sl-hide","sl-dialog",(At,xt)=>{document.documentElement.removeAttribute("overlay-active")})}async handleWalletConnectFlow(At){const xt=new URL(At.detail.data),Bt=xt.searchParams.get("request_uri"),Nt=xt.searchParams.get("encryption_key"),jt=await Oidc.getAuthRequest(Bt,Nt),Ut=document.createElement("connect-request");Ut.request=jt,Ut.addEventListener("connect-pin",async Lt=>{this.pinModalContent.innerHTML=Lt.detail.pin,this.pinModal.show()}),this.connectRequestModal.appendChild(Ut),this.connectRequestModal.show()}async handleRestoreUpload(At){if(!(!this.restoreUploader||!this.restoreUploader.files.length)){try{const xt=await DWeb$1.identity.restore({from:"file",files:this.restoreUploader.files});xt&&await App.addIdentity(xt),this.restoreIdentityModal.hide()}catch(xt){console.log(xt)}this.restoreUploader.files=[]}}render(){var At;return ke$2`


    <vaadin-app-layout id="app_layout">
      
      <sl-icon slot="navbar" id="nav_toggle" name="list" @click="${xt=>this.appLayout.drawerOpened=!0}"></sl-icon>
      <sl-icon slot="navbar" id="logo_icon" name="app-logo"></sl-icon>
      <h1 slot="navbar">Aliased</h1>

      <nav id="nav" slot="drawer" @click="${xt=>{var Bt;return(Bt=this.nav)==null?void 0:Bt.removeAttribute("open")}}">
        <a href="/" ?active="${location.pathname==="/"}">
          <sl-icon slot="prefix" name="people"></sl-icon>
          My IDs
        </a>
        <a href="/profiles" ?active="${location.pathname.startsWith("/profiles")}">
          <sl-icon slot="prefix" name="search"></sl-icon>
          Find
        </a>
      </nav>
      <sl-button id="drawer_close_button" variant="text" @click="${xt=>this.appLayout.drawerOpened=!1}">
        <sl-icon slot="prefix" name="x-lg" ></sl-icon>
      </sl-button>
      

      <find-page id="find" page="full-width"></find-page>
      <identities-page id="identities" page></identities-page>
      <connect-page id="connect" page></connect-page>

    </vaadin-app-layout>

      <sl-dialog id="connect_modal" label="Connect" placement="start" fit-content ?open="${((At=this==null?void 0:this.connectModal)==null?void 0:At.open)&&this.identity&&!1}">
        <connect-widget></connect-widget>
      </sl-dialog>

      <sl-dialog id="pin_modal" label="ConnectPin" placement="start" fit-content>
        <div id="pin_modal_content" flex="center-y column">
        </div> 
        <sl-button id="pin_close" variant="success" @click="${()=>this.pinModal.hide()}">Done</sl-button>
      </sl-dialog>

      <sl-dialog id="qr_scanner_modal" label="Scan QR Code" placement="start" fit-content
        @sl-show="${()=>this.qrScanner.start()}"
        @sl-hide="${()=>this.qrScanner.stop()}"
        >
        <p>Scan a QR code to connect to a DWA.</p>
        <qrcode-scanner id="qr_scanner" @scan="${xt=>{this.qrScannerModal.hide(),this.handleWalletConnectFlow(xt)}}"></qrcode-scanner>
      </sl-dialog>

      <sl-dialog id="connect_request_modal" label="ConnectPage" placement="start" fit-content>
      </sl-dialog>

      <sl-dialog id="restore_identity_modal" label="Restore an Identity" placement="start" fit-content>
        <p>Upload or drop in a backup file to restore an identity.</p>
        <vaadin-upload
          id="restore_uploader"
          no-auto
          max-files="1"
          accept="text/json,application/json,.json"
          @files-changed="${this.handleRestoreUpload}"
        ></vaadin-upload>
      </sl-dialog>

      <pwa-badge></pwa-badge>

    `}static styles=[PageStyles,i$7`
      :host {
        --header-height: 3rem;
        --subheader-height: 3.5rem;
        --_vaadin-app-layout-navbar-offset-size: var(--header-height);
        --nav-width: 4.5rem;
        --_vaadin-app-layout-drawer-offset-size: var(--nav-width);
        --content-height: calc(100vh - var(--header-height));
        --page-padding: var(--header-height) 0 3rem;
        height: 100%;
      }

      #app_layout {
        --vaadin-app-layout-drawer-width: var(--nav-width);
        height: 100%;
      }

      #app_layout::part(navbar){
        /* position: sticky;
        top: 0; */
        display: flex;
        align-items: center;
        height: var(--header-height);
        min-height: var(--header-height);
        padding: 0 0.65rem;
        background: #17456d;
        box-shadow: 0 0 2px 1px rgba(0 0 0 / 25%);
        user-select: none;
      }

      #nav_toggle {
        display: none;
        font-size: 1.75rem;
        margin: 0 0 0 -1.3rem;
        padding: 0 0.15em 0 0;
        opacity: 0.5;
        transition: opacity 0.3s ease;
        cursor: pointer;
      }

      #nav_toggle:hover {
        opacity: 1;
      }

      #logo_icon {
        /* Use the same hue value as the background color of the header */
        --background-color: 208; 
        font-size: 1.75rem;
      }

      #app_layout > h1 {
        margin: 0 auto -0.1rem 0.2rem;
        font-family: var(--app-font);
        font-size: 1.75rem;
        font-weight: normal
      }

      #app_layout > sl-avatar {
        --size: calc(var(--header-height) - 1rem);
      }

      :host-context(html.sl-scroll-lock) #pages {
        z-index: 3;
      } 

      #app_layout::part(drawer) {
        overflow: visible;
        padding: 0.6rem 0;
        background: var(--grey);
        border-right: 1px solid rgba(0 0 0 / 60%);
      }

      #drawer_close_button {
        position: fixed;
        top: 1rem;
        right: 1rem;
        stroke: red;
        opacity: 0;
        transition: opacity 0.2s ease;
        background: rgba(255 255 255 / 7%);
        border-radius: 100%;
        pointer-events: none;
        z-index: 2;
      }

      [drawer-opened] #drawer_close_button {
        opacity: 1;
        pointer-events: all;
      }

      #nav a {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 4rem;
        margin: 0 0 0.5rem;
        font-size: 0.75rem;
        color: rgba(255,255,255,0.75);
        border-right: 2px solid transparent;
        opacity: 0.6;
        transition: opacity 0.3s ease;
        text-decoration: none;
        cursor: pointer;
      }

      #nav *:is(sl-icon, sl-avatar) {
        margin: 0 0 0.2rem;
        font-size: 1.5rem;
        color: #fff;
      }

      #nav sl-avatar {
        --size: 1.55rem;
      }

      #nav sl-icon[name="search"] {
        margin: 0 0 0.3rem;
        font-size: 1.2rem;
      }

      #nav a:hover {
        opacity: 1;
      }

      #nav a[active] {
        opacity: 1;
        color: var(--sl-color-blue-700);
        border-right: 2px solid rgb(51 117 174);
      }

      #nav a[active] sl-icon {
        color: currentColor;
      }

      #app_layout::part(backdrop) {
        background-color: rgba(0 0 0 / 75%);
      }

      #app_layout [page] {
        display: block;
        position: absolute;
        top: 0;
        box-sizing: border-box;
        height: var(--content-height);
        min-height: 100%;
        width: calc(100% - var(--nav-width));
        padding: var(--page-padding);
        opacity: 0;
        visibility: hidden;
        transition: visibility 0.3s, opacity 0.3s ease;
        overflow-y: clip;
        z-index: -1;
      }

      #app_layout [page][route-state="active"] {
        height: auto;
        opacity: 1;
        z-index: 0;
        visibility: visible;
        overflow: visible;
      }

      /* Restore Identity Dialog */

      vaadin-upload {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 8rem;
        border: 2px dashed rgba(255,255,255,0.2);
      }

      vaadin-upload::part(drop-label) {
        color: #fff;
      }

      vaadin-upload vaadin-button {
        color: #fff;
        background: var(--_lumo-button-primary-background);
        cursor: pointer;
      }

      @media(min-width: 800px) {
        #drawer_close_button {
          display: none;
        }
      }

      @media(max-width: 800px) {

        #app_layout {
          --vaadin-app-layout-drawer-width: 200px;
        }
        
        #nav a {
          flex-direction: row;
          justify-content: left;
          height: 3rem;
          margin: 0.25rem 0 0;
          font-size: 1rem;
          padding: 0 2rem 0 1rem;
        }
        #nav a > :first-child {
          display: flex;
          justify-content: center;
          width: 2rem;
          margin: 0 0.5rem 0 0;
        }
        #nav sl-avatar {
          --size: 1.55rem;
        }

        #nav_toggle {
          display: unset;
        }

        #app_layout [page] {
          width: 100%;
        }
      }

      @media(max-width: 500px) {
        #pages > * {
          padding: 1.5rem 1.25rem 1rem;
        }

        #pages > [page~="full-width"] {
          padding: 0;
        }
      }

      @media (prefers-color-scheme: light) {
        a:hover {
          color: #747bff;
        }
        button {
          background-color: #f9f9f9;
        }
      }
    `]}customElements.define("app-view",AppView);
