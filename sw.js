try{self["workbox:core:7.0.0"]&&_()}catch{}const cy=(n,...e)=>{let t=n;return e.length>0&&(t+=` :: ${JSON.stringify(e)}`),t},ly=cy;class xt extends Error{constructor(e,t){const r=ly(e,t);super(r),this.name=e,this.details=t}}const Cn={googleAnalytics:"googleAnalytics",precache:"precache-v2",prefix:"workbox",runtime:"runtime",suffix:typeof registration<"u"?registration.scope:""},sa=n=>[Cn.prefix,n,Cn.suffix].filter(e=>e&&e.length>0).join("-"),uy=n=>{for(const e of Object.keys(Cn))n(e)},Cs={updateDetails:n=>{uy(e=>{typeof n[e]=="string"&&(Cn[e]=n[e])})},getGoogleAnalyticsName:n=>n||sa(Cn.googleAnalytics),getPrecacheName:n=>n||sa(Cn.precache),getPrefix:()=>Cn.prefix,getRuntimeName:n=>n||sa(Cn.runtime),getSuffix:()=>Cn.suffix};function Bl(n,e){const t=e();return n.waitUntil(t),t}try{self["workbox:precaching:7.0.0"]&&_()}catch{}const dy="__WB_REVISION__";function fy(n){if(!n)throw new xt("add-to-cache-list-unexpected-type",{entry:n});if(typeof n=="string"){const o=new URL(n,location.href);return{cacheKey:o.href,url:o.href}}const{revision:e,url:t}=n;if(!t)throw new xt("add-to-cache-list-unexpected-type",{entry:n});if(!e){const o=new URL(t,location.href);return{cacheKey:o.href,url:o.href}}const r=new URL(t,location.href),i=new URL(t,location.href);return r.searchParams.set(dy,e),{cacheKey:r.href,url:i.href}}class hy{constructor(){this.updatedURLs=[],this.notUpdatedURLs=[],this.handlerWillStart=async({request:e,state:t})=>{t&&(t.originalRequest=e)},this.cachedResponseWillBeUsed=async({event:e,state:t,cachedResponse:r})=>{if(e.type==="install"&&t&&t.originalRequest&&t.originalRequest instanceof Request){const i=t.originalRequest.url;r?this.notUpdatedURLs.push(i):this.updatedURLs.push(i)}return r}}}class yy{constructor({precacheController:e}){this.cacheKeyWillBeUsed=async({request:t,params:r})=>{const i=(r==null?void 0:r.cacheKey)||this._precacheController.getCacheKeyForURL(t.url);return i?new Request(i,{headers:t.headers}):t},this._precacheController=e}}let Hi;function py(){if(Hi===void 0){const n=new Response("");if("body"in n)try{new Response(n.body),Hi=!0}catch{Hi=!1}Hi=!1}return Hi}async function gy(n,e){let t=null;if(n.url&&(t=new URL(n.url).origin),t!==self.location.origin)throw new xt("cross-origin-copy-response",{origin:t});const r=n.clone(),o={headers:new Headers(r.headers),status:r.status,statusText:r.statusText},s=py()?r.body:await r.blob();return new Response(s,o)}const wy=n=>new URL(String(n),location.href).href.replace(new RegExp(`^${location.origin}`),"");function Ll(n,e){const t=new URL(n);for(const r of e)t.searchParams.delete(r);return t.href}async function by(n,e,t,r){const i=Ll(e.url,t);if(e.url===i)return n.match(e,r);const o=Object.assign(Object.assign({},r),{ignoreSearch:!0}),s=await n.keys(e,o);for(const a of s){const l=Ll(a.url,t);if(i===l)return n.match(a,r)}}class vy{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}const my=new Set;async function Ey(){for(const n of my)await n()}function _y(n){return new Promise(e=>setTimeout(e,n))}try{self["workbox:strategies:7.0.0"]&&_()}catch{}function Do(n){return typeof n=="string"?new Request(n):n}class xy{constructor(e,t){this._cacheKeys={},Object.assign(this,t),this.event=t.event,this._strategy=e,this._handlerDeferred=new vy,this._extendLifetimePromises=[],this._plugins=[...e.plugins],this._pluginStateMap=new Map;for(const r of this._plugins)this._pluginStateMap.set(r,{});this.event.waitUntil(this._handlerDeferred.promise)}async fetch(e){const{event:t}=this;let r=Do(e);if(r.mode==="navigate"&&t instanceof FetchEvent&&t.preloadResponse){const s=await t.preloadResponse;if(s)return s}const i=this.hasCallback("fetchDidFail")?r.clone():null;try{for(const s of this.iterateCallbacks("requestWillFetch"))r=await s({request:r.clone(),event:t})}catch(s){if(s instanceof Error)throw new xt("plugin-error-request-will-fetch",{thrownErrorMessage:s.message})}const o=r.clone();try{let s;s=await fetch(r,r.mode==="navigate"?void 0:this._strategy.fetchOptions);for(const a of this.iterateCallbacks("fetchDidSucceed"))s=await a({event:t,request:o,response:s});return s}catch(s){throw i&&await this.runCallbacks("fetchDidFail",{error:s,event:t,originalRequest:i.clone(),request:o.clone()}),s}}async fetchAndCachePut(e){const t=await this.fetch(e),r=t.clone();return this.waitUntil(this.cachePut(e,r)),t}async cacheMatch(e){const t=Do(e);let r;const{cacheName:i,matchOptions:o}=this._strategy,s=await this.getCacheKey(t,"read"),a=Object.assign(Object.assign({},o),{cacheName:i});r=await caches.match(s,a);for(const l of this.iterateCallbacks("cachedResponseWillBeUsed"))r=await l({cacheName:i,matchOptions:o,cachedResponse:r,request:s,event:this.event})||void 0;return r}async cachePut(e,t){const r=Do(e);await _y(0);const i=await this.getCacheKey(r,"write");if(!t)throw new xt("cache-put-with-no-response",{url:wy(i.url)});const o=await this._ensureResponseSafeToCache(t);if(!o)return!1;const{cacheName:s,matchOptions:a}=this._strategy,l=await self.caches.open(s),u=this.hasCallback("cacheDidUpdate"),c=u?await by(l,i.clone(),["__WB_REVISION__"],a):null;try{await l.put(i,u?o.clone():o)}catch(h){if(h instanceof Error)throw h.name==="QuotaExceededError"&&await Ey(),h}for(const h of this.iterateCallbacks("cacheDidUpdate"))await h({cacheName:s,oldResponse:c,newResponse:o.clone(),request:i,event:this.event});return!0}async getCacheKey(e,t){const r=`${e.url} | ${t}`;if(!this._cacheKeys[r]){let i=e;for(const o of this.iterateCallbacks("cacheKeyWillBeUsed"))i=Do(await o({mode:t,request:i,event:this.event,params:this.params}));this._cacheKeys[r]=i}return this._cacheKeys[r]}hasCallback(e){for(const t of this._strategy.plugins)if(e in t)return!0;return!1}async runCallbacks(e,t){for(const r of this.iterateCallbacks(e))await r(t)}*iterateCallbacks(e){for(const t of this._strategy.plugins)if(typeof t[e]=="function"){const r=this._pluginStateMap.get(t);yield o=>{const s=Object.assign(Object.assign({},o),{state:r});return t[e](s)}}}waitUntil(e){return this._extendLifetimePromises.push(e),e}async doneWaiting(){let e;for(;e=this._extendLifetimePromises.shift();)await e}destroy(){this._handlerDeferred.resolve(null)}async _ensureResponseSafeToCache(e){let t=e,r=!1;for(const i of this.iterateCallbacks("cacheWillUpdate"))if(t=await i({request:this.request,response:t,event:this.event})||void 0,r=!0,!t)break;return r||t&&t.status!==200&&(t=void 0),t}}class Sy{constructor(e={}){this.cacheName=Cs.getRuntimeName(e.cacheName),this.plugins=e.plugins||[],this.fetchOptions=e.fetchOptions,this.matchOptions=e.matchOptions}handle(e){const[t]=this.handleAll(e);return t}handleAll(e){e instanceof FetchEvent&&(e={event:e,request:e.request});const t=e.event,r=typeof e.request=="string"?new Request(e.request):e.request,i="params"in e?e.params:void 0,o=new xy(this,{event:t,request:r,params:i}),s=this._getResponse(o,r,t),a=this._awaitComplete(s,o,r,t);return[s,a]}async _getResponse(e,t,r){await e.runCallbacks("handlerWillStart",{event:r,request:t});let i;try{if(i=await this._handle(t,e),!i||i.type==="error")throw new xt("no-response",{url:t.url})}catch(o){if(o instanceof Error){for(const s of e.iterateCallbacks("handlerDidError"))if(i=await s({error:o,event:r,request:t}),i)break}if(!i)throw o}for(const o of e.iterateCallbacks("handlerWillRespond"))i=await o({event:r,request:t,response:i});return i}async _awaitComplete(e,t,r,i){let o,s;try{o=await e}catch{}try{await t.runCallbacks("handlerDidRespond",{event:i,request:r,response:o}),await t.doneWaiting()}catch(a){a instanceof Error&&(s=a)}if(await t.runCallbacks("handlerDidComplete",{event:i,request:r,response:o,error:s}),t.destroy(),s)throw s}}class cr extends Sy{constructor(e={}){e.cacheName=Cs.getPrecacheName(e.cacheName),super(e),this._fallbackToNetwork=e.fallbackToNetwork!==!1,this.plugins.push(cr.copyRedirectedCacheableResponsesPlugin)}async _handle(e,t){const r=await t.cacheMatch(e);return r||(t.event&&t.event.type==="install"?await this._handleInstall(e,t):await this._handleFetch(e,t))}async _handleFetch(e,t){let r;const i=t.params||{};if(this._fallbackToNetwork){const o=i.integrity,s=e.integrity,a=!s||s===o;r=await t.fetch(new Request(e,{integrity:e.mode!=="no-cors"?s||o:void 0})),o&&a&&e.mode!=="no-cors"&&(this._useDefaultCacheabilityPluginIfNeeded(),await t.cachePut(e,r.clone()))}else throw new xt("missing-precache-entry",{cacheName:this.cacheName,url:e.url});return r}async _handleInstall(e,t){this._useDefaultCacheabilityPluginIfNeeded();const r=await t.fetch(e);if(!await t.cachePut(e,r.clone()))throw new xt("bad-precaching-response",{url:e.url,status:r.status});return r}_useDefaultCacheabilityPluginIfNeeded(){let e=null,t=0;for(const[r,i]of this.plugins.entries())i!==cr.copyRedirectedCacheableResponsesPlugin&&(i===cr.defaultPrecacheCacheabilityPlugin&&(e=r),i.cacheWillUpdate&&t++);t===0?this.plugins.push(cr.defaultPrecacheCacheabilityPlugin):t>1&&e!==null&&this.plugins.splice(e,1)}}cr.defaultPrecacheCacheabilityPlugin={async cacheWillUpdate({response:n}){return!n||n.status>=400?null:n}};cr.copyRedirectedCacheableResponsesPlugin={async cacheWillUpdate({response:n}){return n.redirected?await gy(n):n}};class Ay{constructor({cacheName:e,plugins:t=[],fallbackToNetwork:r=!0}={}){this._urlsToCacheKeys=new Map,this._urlsToCacheModes=new Map,this._cacheKeysToIntegrities=new Map,this._strategy=new cr({cacheName:Cs.getPrecacheName(e),plugins:[...t,new yy({precacheController:this})],fallbackToNetwork:r}),this.install=this.install.bind(this),this.activate=this.activate.bind(this)}get strategy(){return this._strategy}precache(e){this.addToCacheList(e),this._installAndActiveListenersAdded||(self.addEventListener("install",this.install),self.addEventListener("activate",this.activate),this._installAndActiveListenersAdded=!0)}addToCacheList(e){const t=[];for(const r of e){typeof r=="string"?t.push(r):r&&r.revision===void 0&&t.push(r.url);const{cacheKey:i,url:o}=fy(r),s=typeof r!="string"&&r.revision?"reload":"default";if(this._urlsToCacheKeys.has(o)&&this._urlsToCacheKeys.get(o)!==i)throw new xt("add-to-cache-list-conflicting-entries",{firstEntry:this._urlsToCacheKeys.get(o),secondEntry:i});if(typeof r!="string"&&r.integrity){if(this._cacheKeysToIntegrities.has(i)&&this._cacheKeysToIntegrities.get(i)!==r.integrity)throw new xt("add-to-cache-list-conflicting-integrities",{url:o});this._cacheKeysToIntegrities.set(i,r.integrity)}if(this._urlsToCacheKeys.set(o,i),this._urlsToCacheModes.set(o,s),t.length>0){const a=`Workbox is precaching URLs without revision info: ${t.join(", ")}
This is generally NOT safe. Learn more at https://bit.ly/wb-precache`;console.warn(a)}}}install(e){return Bl(e,async()=>{const t=new hy;this.strategy.plugins.push(t);for(const[o,s]of this._urlsToCacheKeys){const a=this._cacheKeysToIntegrities.get(s),l=this._urlsToCacheModes.get(o),u=new Request(o,{integrity:a,cache:l,credentials:"same-origin"});await Promise.all(this.strategy.handleAll({params:{cacheKey:s},request:u,event:e}))}const{updatedURLs:r,notUpdatedURLs:i}=t;return{updatedURLs:r,notUpdatedURLs:i}})}activate(e){return Bl(e,async()=>{const t=await self.caches.open(this.strategy.cacheName),r=await t.keys(),i=new Set(this._urlsToCacheKeys.values()),o=[];for(const s of r)i.has(s.url)||(await t.delete(s),o.push(s.url));return{deletedURLs:o}})}getURLsToCacheKeys(){return this._urlsToCacheKeys}getCachedURLs(){return[...this._urlsToCacheKeys.keys()]}getCacheKeyForURL(e){const t=new URL(e,location.href);return this._urlsToCacheKeys.get(t.href)}getIntegrityForCacheKey(e){return this._cacheKeysToIntegrities.get(e)}async matchPrecache(e){const t=e instanceof Request?e.url:e,r=this.getCacheKeyForURL(t);if(r)return(await self.caches.open(this.strategy.cacheName)).match(r)}createHandlerBoundToURL(e){const t=this.getCacheKeyForURL(e);if(!t)throw new xt("non-precached-url",{url:e});return r=>(r.request=new Request(e),r.params=Object.assign({cacheKey:t},r.params),this.strategy.handle(r))}}let aa;const Cc=()=>(aa||(aa=new Ay),aa);try{self["workbox:routing:7.0.0"]&&_()}catch{}const Ud="GET",xs=n=>n&&typeof n=="object"?n:{handle:n};class xi{constructor(e,t,r=Ud){this.handler=xs(t),this.match=e,this.method=r}setCatchHandler(e){this.catchHandler=xs(e)}}class Ty extends xi{constructor(e,t,r){const i=({url:o})=>{const s=e.exec(o.href);if(s&&!(o.origin!==location.origin&&s.index!==0))return s.slice(1)};super(i,t,r)}}class Iy{constructor(){this._routes=new Map,this._defaultHandlerMap=new Map}get routes(){return this._routes}addFetchListener(){self.addEventListener("fetch",e=>{const{request:t}=e,r=this.handleRequest({request:t,event:e});r&&e.respondWith(r)})}addCacheListener(){self.addEventListener("message",e=>{if(e.data&&e.data.type==="CACHE_URLS"){const{payload:t}=e.data,r=Promise.all(t.urlsToCache.map(i=>{typeof i=="string"&&(i=[i]);const o=new Request(...i);return this.handleRequest({request:o,event:e})}));e.waitUntil(r),e.ports&&e.ports[0]&&r.then(()=>e.ports[0].postMessage(!0))}})}handleRequest({request:e,event:t}){const r=new URL(e.url,location.href);if(!r.protocol.startsWith("http"))return;const i=r.origin===location.origin,{params:o,route:s}=this.findMatchingRoute({event:t,request:e,sameOrigin:i,url:r});let a=s&&s.handler;const l=e.method;if(!a&&this._defaultHandlerMap.has(l)&&(a=this._defaultHandlerMap.get(l)),!a)return;let u;try{u=a.handle({url:r,request:e,event:t,params:o})}catch(h){u=Promise.reject(h)}const c=s&&s.catchHandler;return u instanceof Promise&&(this._catchHandler||c)&&(u=u.catch(async h=>{if(c)try{return await c.handle({url:r,request:e,event:t,params:o})}catch(m){m instanceof Error&&(h=m)}if(this._catchHandler)return this._catchHandler.handle({url:r,request:e,event:t});throw h})),u}findMatchingRoute({url:e,sameOrigin:t,request:r,event:i}){const o=this._routes.get(r.method)||[];for(const s of o){let a;const l=s.match({url:e,sameOrigin:t,request:r,event:i});if(l)return a=l,(Array.isArray(a)&&a.length===0||l.constructor===Object&&Object.keys(l).length===0||typeof l=="boolean")&&(a=void 0),{route:s,params:a}}return{}}setDefaultHandler(e,t=Ud){this._defaultHandlerMap.set(t,xs(e))}setCatchHandler(e){this._catchHandler=xs(e)}registerRoute(e){this._routes.has(e.method)||this._routes.set(e.method,[]),this._routes.get(e.method).push(e)}unregisterRoute(e){if(!this._routes.has(e.method))throw new xt("unregister-route-but-not-found-with-method",{method:e.method});const t=this._routes.get(e.method).indexOf(e);if(t>-1)this._routes.get(e.method).splice(t,1);else throw new xt("unregister-route-route-not-registered")}}let Vi;const Ry=()=>(Vi||(Vi=new Iy,Vi.addFetchListener(),Vi.addCacheListener()),Vi);function $d(n,e,t){let r;if(typeof n=="string"){const o=new URL(n,location.href),s=({url:a})=>a.href===o.href;r=new xi(s,e,t)}else if(n instanceof RegExp)r=new Ty(n,e,t);else if(typeof n=="function")r=new xi(n,e,t);else if(n instanceof xi)r=n;else throw new xt("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});return Ry().registerRoute(r),r}function Oy(n,e=[]){for(const t of[...n.searchParams.keys()])e.some(r=>r.test(t))&&n.searchParams.delete(t);return n}function*By(n,{ignoreURLParametersMatching:e=[/^utm_/,/^fbclid$/],directoryIndex:t="index.html",cleanURLs:r=!0,urlManipulation:i}={}){const o=new URL(n,location.href);o.hash="",yield o.href;const s=Oy(o,e);if(yield s.href,t&&s.pathname.endsWith("/")){const a=new URL(s.href);a.pathname+=t,yield a.href}if(r){const a=new URL(s.href);a.pathname+=".html",yield a.href}if(i){const a=i({url:o});for(const l of a)yield l.href}}class Ly extends xi{constructor(e,t){const r=({request:i})=>{const o=e.getURLsToCacheKeys();for(const s of By(i.url,t)){const a=o.get(s);if(a){const l=e.getIntegrityForCacheKey(a);return{cacheKey:a,integrity:l}}}};super(r,e.strategy)}}function ky(n){const e=Cc(),t=new Ly(e,n);$d(t)}const Cy="-precache-",Uy=async(n,e=Cy)=>{const r=(await self.caches.keys()).filter(i=>i.includes(e)&&i.includes(self.registration.scope)&&i!==n);return await Promise.all(r.map(i=>self.caches.delete(i))),r};function $y(){self.addEventListener("activate",n=>{const e=Cs.getPrecacheName();n.waitUntil(Uy(e).then(t=>{}))})}function Ny(n){return Cc().createHandlerBoundToURL(n)}function Dy(n){Cc().precache(n)}function Py(n,e){Dy(n),ky(e)}function Ky(){self.addEventListener("activate",()=>self.clients.claim())}class My extends xi{constructor(e,{allowlist:t=[/./],denylist:r=[]}={}){super(i=>this._match(i),e),this._allowlist=t,this._denylist=r}_match({url:e,request:t}){if(t&&t.mode!=="navigate")return!1;const r=e.pathname+e.search;for(const i of this._denylist)if(i.test(r))return!1;return!!this._allowlist.some(i=>i.test(r))}}var vo;(function(n){n.authentication="authentication",n.assertionMethod="assertionMethod",n.keyAgreement="keyAgreement",n.capabilityInvocation="capabilityInvocation",n.capabilityDelegation="capabilityDelegation"})(vo||(vo={}));const yt={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};class Be{constructor({method:e,id:t,path:r,query:i,fragment:o,params:s}){this.uri=`did:${e}:${t}`,this.method=e,this.id=t,this.path=r,this.query=i,this.fragment=o,this.params=s}static parse(e){if(!e)return null;const t=Be.DID_URI_PATTERN.exec(e);if(!t||!t.groups)return null;const{method:r,id:i,path:o,query:s,fragment:a}=t.groups,l={uri:`did:${r}:${i}`,method:r,id:i};if(o&&(l.path=o),s&&(l.query=s.slice(1)),a&&(l.fragment=a.slice(1)),s){const u={},c=s.slice(1).split("&");for(const h of c){const[m,E]=h.split("=");u[m]=E}l.params=u}return l}}Be.METHOD_PATTERN="([a-z0-9]+)";Be.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Be.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Be.PCT_ENCODED_PATTERN})`;Be.METHOD_ID_PATTERN=`((?:${Be.ID_CHAR_PATTERN}*:)*(${Be.ID_CHAR_PATTERN}+))`;Be.PATH_PATTERN="(/[^#?]*)?";Be.QUERY_PATTERN="([?][^#]*)?";Be.FRAGMENT_PATTERN="(#.*)?";Be.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Be.METHOD_PATTERN}):(?<id>${Be.METHOD_ID_PATTERN})(?<path>${Be.PATH_PATTERN})(?<query>${Be.QUERY_PATTERN})(?<fragment>${Be.FRAGMENT_PATTERN})$`);class pe extends Error{constructor(e,t){super(`${e}: ${t}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pe)}}var fe;(function(n){n.InvalidDid="invalidDid",n.MethodNotSupported="methodNotSupported",n.InternalError="internalError",n.InvalidDidDocument="invalidDidDocument",n.InvalidDidDocumentLength="invalidDidDocumentLength",n.InvalidDidUrl="invalidDidUrl",n.InvalidPreviousDidProof="invalidPreviousDidProof",n.InvalidPublicKey="invalidPublicKey",n.InvalidPublicKeyLength="invalidPublicKeyLength",n.InvalidPublicKeyType="invalidPublicKeyType",n.InvalidSignature="invalidSignature",n.NotFound="notFound",n.RepresentationNotSupported="representationNotSupported",n.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(fe||(fe={}));var Fy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function jy(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Hy(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<n.length;i++){var o=n.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=n.length,l=n.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var S=0,C=0,B=0,A=g.length;B!==A&&g[B]===0;)B++,S++;for(var O=(A-B)*c+1>>>0,I=new Uint8Array(O);B!==A;){for(var x=g[B],D=0,H=O-1;(x!==0||D<C)&&H!==-1;H--,D++)x+=256*I[H]>>>0,I[H]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");C=D,B++}for(var z=O-C;z!==O&&I[z]===0;)z++;for(var Q=l.repeat(S);z<O;++z)Q+=n.charAt(I[z]);return Q}function m(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var S=0;if(g[S]!==" "){for(var C=0,B=0;g[S]===l;)C++,S++;for(var A=(g.length-S)*u+1>>>0,O=new Uint8Array(A);g[S];){var I=t[g.charCodeAt(S)];if(I===255)return;for(var x=0,D=A-1;(I!==0||x<B)&&D!==-1;D--,x++)I+=a*O[D]>>>0,O[D]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");B=x,S++}if(g[S]!==" "){for(var H=A-B;H!==A&&O[H]===0;)H++;for(var z=new Uint8Array(C+(A-H)),Q=C;H!==A;)z[Q++]=O[H++];return z}}}function E(g){var S=m(g);if(S)return S;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:m,decode:E}}var Vy=Hy,Wy=Vy;const qy=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")};let zy=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Gy=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Nd(this,e)}},Yy=class{constructor(e){this.decoders=e}or(e){return Nd(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Nd=(n,e)=>new Yy({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});let Jy=class{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new zy(e,t,r),this.decoder=new Gy(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Dd=({name:n,prefix:e,encode:t,decode:r})=>new Jy(n,e,t,r),Pd=({prefix:n,name:e,alphabet:t})=>{const{encode:r,decode:i}=Wy(t,e);return Dd({prefix:n,name:e,encode:r,decode:o=>qy(i(o))})},Xy=(n,e,t,r)=>{const i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=n.length;for(;n[o-1]==="=";)--o;const s=new Uint8Array(o*t/8|0);let a=0,l=0,u=0;for(let c=0;c<o;++c){const h=i[n[c]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return s},Zy=(n,e,t)=>{const r=e[e.length-1]==="=",i=(1<<t)-1;let o="",s=0,a=0;for(let l=0;l<n.length;++l)for(a=a<<8|n[l],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),r)for(;o.length*t&7;)o+="=";return o},Ct=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>Dd({prefix:e,name:n,encode(i){return Zy(i,r,t)},decode(i){return Xy(i,r,t,n)}});Ct({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Ct({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Ct({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Ct({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Ct({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Ct({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Ct({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Ct({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const kl=Ct({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Po=Pd({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});Pd({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Ct({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ct({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const An=Ct({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Ct({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Qy(n){return n.byteOffset!==0||n.byteLength!==n.buffer.byteLength}function ep(n){return typeof n!="object"||n===null?!1:typeof n[Symbol.asyncIterator]=="function"}function Xa(n){const t=Object.prototype.toString.call(n).match(/\s([a-zA-Z0-9]+)/),[r,i]=t;return i}var Wi=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Cl=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}};const Ko=new TextEncoder,xr=new TextDecoder;class se{constructor(e,t){this.data=e,this.format=t}static arrayBuffer(e){return new se(e,"ArrayBuffer")}static asyncIterable(e){if(!ep(e))throw new TypeError("Input must be of type AsyncIterable.");return new se(e,"AsyncIterable")}static base32Z(e){return new se(e,"Base32Z")}static base58Btc(e){return new se(e,"Base58Btc")}static base64Url(e){return new se(e,"Base64Url")}static bufferSource(e){return new se(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new se(e,"Hex")}static multibase(e){return new se(e,"Multibase")}static object(e){return new se(e,"Object")}static string(e){return new se(e,"String")}static uint8Array(e){return new se(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Po.baseDecode(this.data).buffer;case"Base64Url":return An.baseDecode(this.data).buffer;case"BufferSource":{if(Xa(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Qy(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Wi(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return kl.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Po.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Po.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return An.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return An.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),t=Ko.encode(e);return An.baseEncode(t)}case"String":{const e=Ko.encode(this.data);return An.baseEncode(e)}case"Uint8Array":return An.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,t,r,i;return Wi(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const l=[];try{for(var o=!0,s=Cl(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;const c=i;l.push(c)}}catch(c){t={error:c}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return new Blob(l)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(t,r)=>r.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const t=this.toUint8Array();return se.uint8Array(t).toHex()}case"Base64Url":{const t=this.toUint8Array();return se.uint8Array(t).toHex()}case"Uint8Array":{let t="";for(let r=0;r<this.data.length;r++)t+=e[this.data[r]];return t}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=An.baseDecode(this.data),t=xr.decode(e);return JSON.parse(t)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=xr.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Wi(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return xr.decode(this.data);case"Base64Url":{const e=An.baseDecode(this.data);return xr.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return xr.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,t,r,i;return Wi(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let l="";try{for(var o=!0,s=Cl(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;const u=i;typeof u=="string"?l+=u:l+=xr.decode(u,{stream:!0})}}catch(u){t={error:u}}finally{try{!o&&!e&&(r=s.return)&&(yield r.call(s))}finally{if(t)throw t.error}}return l+=xr.decode(void 0,{stream:!1}),l}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return kl.baseDecode(this.data);case"Base58Btc":return Po.baseDecode(this.data);case"Base64Url":return An.baseDecode(this.data);case"BufferSource":{const e=Xa(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let t=0;t<this.data.length;t+=2){const r=parseInt(this.data.substring(t,t+2),16);if(isNaN(r))throw new TypeError("Input is not a valid hexadecimal string.");e[t/2]=r}return e}case"Object":{const e=JSON.stringify(this.data);return Ko.encode(e)}case"String":return Ko.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Wi(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}}var tp=Kd,Ul=128,np=127,rp=~np,ip=Math.pow(2,31);function Kd(n,e,t){e=e||[],t=t||0;for(var r=t;n>=ip;)e[t++]=n&255|Ul,n/=128;for(;n&rp;)e[t++]=n&255|Ul,n>>>=7;return e[t]=n|0,Kd.bytes=t-r+1,e}var op=Za,sp=128,$l=127;function Za(n,r){var t=0,r=r||0,i=0,o=r,s,a=n.length;do{if(o>=a)throw Za.bytes=0,new RangeError("Could not decode varint");s=n[o++],t+=i<28?(s&$l)<<i:(s&$l)*Math.pow(2,i),i+=7}while(s>=sp);return Za.bytes=o-r,t}var ap=Math.pow(2,7),cp=Math.pow(2,14),lp=Math.pow(2,21),up=Math.pow(2,28),dp=Math.pow(2,35),fp=Math.pow(2,42),hp=Math.pow(2,49),yp=Math.pow(2,56),pp=Math.pow(2,63),gp=function(n){return n<ap?1:n<cp?2:n<lp?3:n<up?4:n<dp?5:n<fp?6:n<hp?7:n<yp?8:n<pp?9:10},wp={encode:tp,decode:op,encodingLength:gp},Ss=wp;const Nl=(n,e=0)=>[Ss.decode(n,e),Ss.decode.bytes],bp=(n,e,t=0)=>(Ss.encode(n,e,t),e),vp=n=>Ss.encodingLength(n);class rt{static addPrefix(e){var t;let{code:r,data:i,name:o}=e;if(!(o?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(r=rt.codeToName.has(r)?r:rt.nameToCode.get(o),r===void 0)throw new Error(`Unsupported multicodec: ${(t=e.name)!==null&&t!==void 0?t:e.code}`);const s=vp(r),a=new Uint8Array(s+i.byteLength);return a.set(i,s),bp(r,a),a}static getCodeFromData(e){const{prefixedData:t}=e,[r,i]=Nl(t);return r}static getCodeFromName(e){const{name:t}=e,r=rt.nameToCode.get(t);if(r===void 0)throw new Error(`Unsupported multicodec: ${t}`);return r}static getNameFromCode(e){const{code:t}=e,r=rt.codeToName.get(t);if(r===void 0)throw new Error(`Unsupported multicodec: ${t}`);return r}static registerCodec(e){rt.codeToName.set(e.code,e.name),rt.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:t}=e,[r,i]=Nl(t),o=rt.codeToName.get(r);if(o===void 0)throw new Error(`Unsupported multicodec: ${r}`);return{code:r,data:t.slice(i),name:o}}}rt.codeToName=new Map;rt.nameToCode=new Map;rt.registerCodec({code:237,name:"ed25519-pub"});rt.registerCodec({code:4864,name:"ed25519-priv"});rt.registerCodec({code:236,name:"x25519-pub"});rt.registerCodec({code:4866,name:"x25519-priv"});rt.registerCodec({code:231,name:"secp256k1-pub"});rt.registerCodec({code:4865,name:"secp256k1-priv"});function Md(n){Object.keys(n).forEach(e=>{n[e]===void 0?delete n[e]:typeof n[e]=="object"&&Md(n[e])})}var gr={},Us={},Fd={};Fd.supports=function(...e){const t=e.reduce((r,i)=>Object.assign(r,i),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})};var jd={},mn=class extends Error{constructor(e,t){super(e||""),typeof t=="object"&&t!==null&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},ti={},Wt={},$s={};$s.byteLength=_p;$s.toByteArray=Sp;$s.fromByteArray=Ip;var dn=[],Pt=[],mp=typeof Uint8Array<"u"?Uint8Array:Array,ca="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ci=0,Ep=ca.length;ci<Ep;++ci)dn[ci]=ca[ci],Pt[ca.charCodeAt(ci)]=ci;Pt[45]=62;Pt[95]=63;function Hd(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function _p(n){var e=Hd(n),t=e[0],r=e[1];return(t+r)*3/4-r}function xp(n,e,t){return(e+t)*3/4-t}function Sp(n){var e,t=Hd(n),r=t[0],i=t[1],o=new mp(xp(n,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)e=Pt[n.charCodeAt(l)]<<18|Pt[n.charCodeAt(l+1)]<<12|Pt[n.charCodeAt(l+2)]<<6|Pt[n.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Pt[n.charCodeAt(l)]<<2|Pt[n.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=Pt[n.charCodeAt(l)]<<10|Pt[n.charCodeAt(l+1)]<<4|Pt[n.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function Ap(n){return dn[n>>18&63]+dn[n>>12&63]+dn[n>>6&63]+dn[n&63]}function Tp(n,e,t){for(var r,i=[],o=e;o<t;o+=3)r=(n[o]<<16&16711680)+(n[o+1]<<8&65280)+(n[o+2]&255),i.push(Ap(r));return i.join("")}function Ip(n){for(var e,t=n.length,r=t%3,i=[],o=16383,s=0,a=t-r;s<a;s+=o)i.push(Tp(n,s,s+o>a?a:s+o));return r===1?(e=n[t-1],i.push(dn[e>>2]+dn[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(dn[e>>10]+dn[e>>4&63]+dn[e<<2&63]+"=")),i.join("")}var Uc={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Uc.read=function(n,e,t,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=t?i-1:0,m=t?-1:1,E=n[e+h];for(h+=m,o=E&(1<<-c)-1,E>>=-c,c+=a;c>0;o=o*256+n[e+h],h+=m,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=s*256+n[e+h],h+=m,c-=8);if(o===0)o=1-u;else{if(o===l)return s?NaN:(E?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-u}return(E?-1:1)*s*Math.pow(2,o-r)};Uc.write=function(n,e,t,r,i,o){var s,a,l,u=o*8-i-1,c=(1<<u)-1,h=c>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=r?0:o-1,g=r?1:-1,S=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?e+=m/l:e+=m*Math.pow(2,1-h),e*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s=s+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;n[t+E]=a&255,E+=g,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;n[t+E]=s&255,E+=g,s/=256,u-=8);n[t+E-g]|=S*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){var e=$s,t=Uc,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=A,n.INSPECT_MAX_BYTES=50;var i=2147483647;n.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var y=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(y,d),y.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(y){if(y>i)throw new RangeError('The value "'+y+'" is invalid for option "size"');var d=new Uint8Array(y);return Object.setPrototypeOf(d,a.prototype),d}function a(y,d,f){if(typeof y=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(y)}return l(y,d,f)}a.poolSize=8192;function l(y,d,f){if(typeof y=="string")return m(y,d);if(ArrayBuffer.isView(y))return g(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y);if(L(y,ArrayBuffer)||y&&L(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(L(y,SharedArrayBuffer)||y&&L(y.buffer,SharedArrayBuffer)))return S(y,d,f);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var w=y.valueOf&&y.valueOf();if(w!=null&&w!==y)return a.from(w,d,f);var k=C(y);if(k)return k;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return a.from(y[Symbol.toPrimitive]("string"),d,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y)}a.from=function(y,d,f){return l(y,d,f)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function c(y,d,f){return u(y),y<=0?s(y):d!==void 0?typeof f=="string"?s(y).fill(d,f):s(y).fill(d):s(y)}a.alloc=function(y,d,f){return c(y,d,f)};function h(y){return u(y),s(y<0?0:B(y)|0)}a.allocUnsafe=function(y){return h(y)},a.allocUnsafeSlow=function(y){return h(y)};function m(y,d){if((typeof d!="string"||d==="")&&(d="utf8"),!a.isEncoding(d))throw new TypeError("Unknown encoding: "+d);var f=O(y,d)|0,w=s(f),k=w.write(y,d);return k!==f&&(w=w.slice(0,k)),w}function E(y){for(var d=y.length<0?0:B(y.length)|0,f=s(d),w=0;w<d;w+=1)f[w]=y[w]&255;return f}function g(y){if(L(y,Uint8Array)){var d=new Uint8Array(y);return S(d.buffer,d.byteOffset,d.byteLength)}return E(y)}function S(y,d,f){if(d<0||y.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<d+(f||0))throw new RangeError('"length" is outside of buffer bounds');var w;return d===void 0&&f===void 0?w=new Uint8Array(y):f===void 0?w=new Uint8Array(y,d):w=new Uint8Array(y,d,f),Object.setPrototypeOf(w,a.prototype),w}function C(y){if(a.isBuffer(y)){var d=B(y.length)|0,f=s(d);return f.length===0||y.copy(f,0,0,d),f}if(y.length!==void 0)return typeof y.length!="number"||U(y.length)?s(0):E(y);if(y.type==="Buffer"&&Array.isArray(y.data))return E(y.data)}function B(y){if(y>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return y|0}function A(y){return+y!=y&&(y=0),a.alloc(+y)}a.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==a.prototype},a.compare=function(d,f){if(L(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),L(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),!a.isBuffer(d)||!a.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===f)return 0;for(var w=d.length,k=f.length,W=0,Y=Math.min(w,k);W<Y;++W)if(d[W]!==f[W]){w=d[W],k=f[W];break}return w<k?-1:k<w?1:0},a.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(d,f){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return a.alloc(0);var w;if(f===void 0)for(f=0,w=0;w<d.length;++w)f+=d[w].length;var k=a.allocUnsafe(f),W=0;for(w=0;w<d.length;++w){var Y=d[w];if(L(Y,Uint8Array))W+Y.length>k.length?a.from(Y).copy(k,W):Uint8Array.prototype.set.call(k,Y,W);else if(a.isBuffer(Y))Y.copy(k,W);else throw new TypeError('"list" argument must be an Array of Buffers');W+=Y.length}return k};function O(y,d){if(a.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||L(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof y);var f=y.length,w=arguments.length>2&&arguments[2]===!0;if(!w&&f===0)return 0;for(var k=!1;;)switch(d){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return ve(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return ke(y).length;default:if(k)return w?-1:ve(y).length;d=(""+d).toLowerCase(),k=!0}}a.byteLength=O;function I(y,d,f){var w=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,d>>>=0,f<=d))return"";for(y||(y="utf8");;)switch(y){case"hex":return $(this,d,f);case"utf8":case"utf-8":return oe(this,d,f);case"ascii":return ne(this,d,f);case"latin1":case"binary":return j(this,d,f);case"base64":return ee(this,d,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,d,f);default:if(w)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),w=!0}}a.prototype._isBuffer=!0;function x(y,d,f){var w=y[d];y[d]=y[f],y[f]=w}a.prototype.swap16=function(){var d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var f=0;f<d;f+=2)x(this,f,f+1);return this},a.prototype.swap32=function(){var d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var f=0;f<d;f+=4)x(this,f,f+3),x(this,f+1,f+2);return this},a.prototype.swap64=function(){var d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var f=0;f<d;f+=8)x(this,f,f+7),x(this,f+1,f+6),x(this,f+2,f+5),x(this,f+3,f+4);return this},a.prototype.toString=function(){var d=this.length;return d===0?"":arguments.length===0?oe(this,0,d):I.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(d){if(!a.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:a.compare(this,d)===0},a.prototype.inspect=function(){var d="",f=n.INSPECT_MAX_BYTES;return d=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(d+=" ... "),"<Buffer "+d+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(d,f,w,k,W){if(L(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),!a.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(f===void 0&&(f=0),w===void 0&&(w=d?d.length:0),k===void 0&&(k=0),W===void 0&&(W=this.length),f<0||w>d.length||k<0||W>this.length)throw new RangeError("out of range index");if(k>=W&&f>=w)return 0;if(k>=W)return-1;if(f>=w)return 1;if(f>>>=0,w>>>=0,k>>>=0,W>>>=0,this===d)return 0;for(var Y=W-k,de=w-f,Te=Math.min(Y,de),p=this.slice(k,W),v=d.slice(f,w),q=0;q<Te;++q)if(p[q]!==v[q]){Y=p[q],de=v[q];break}return Y<de?-1:de<Y?1:0};function D(y,d,f,w,k){if(y.length===0)return-1;if(typeof f=="string"?(w=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,U(f)&&(f=k?0:y.length-1),f<0&&(f=y.length+f),f>=y.length){if(k)return-1;f=y.length-1}else if(f<0)if(k)f=0;else return-1;if(typeof d=="string"&&(d=a.from(d,w)),a.isBuffer(d))return d.length===0?-1:H(y,d,f,w,k);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(y,d,f):Uint8Array.prototype.lastIndexOf.call(y,d,f):H(y,[d],f,w,k);throw new TypeError("val must be string, number or Buffer")}function H(y,d,f,w,k){var W=1,Y=y.length,de=d.length;if(w!==void 0&&(w=String(w).toLowerCase(),w==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(y.length<2||d.length<2)return-1;W=2,Y/=2,de/=2,f/=2}function Te(re,De){return W===1?re[De]:re.readUInt16BE(De*W)}var p;if(k){var v=-1;for(p=f;p<Y;p++)if(Te(y,p)===Te(d,v===-1?0:p-v)){if(v===-1&&(v=p),p-v+1===de)return v*W}else v!==-1&&(p-=p-v),v=-1}else for(f+de>Y&&(f=Y-de),p=f;p>=0;p--){for(var q=!0,Z=0;Z<de;Z++)if(Te(y,p+Z)!==Te(d,Z)){q=!1;break}if(q)return p}return-1}a.prototype.includes=function(d,f,w){return this.indexOf(d,f,w)!==-1},a.prototype.indexOf=function(d,f,w){return D(this,d,f,w,!0)},a.prototype.lastIndexOf=function(d,f,w){return D(this,d,f,w,!1)};function z(y,d,f,w){f=Number(f)||0;var k=y.length-f;w?(w=Number(w),w>k&&(w=k)):w=k;var W=d.length;w>W/2&&(w=W/2);for(var Y=0;Y<w;++Y){var de=parseInt(d.substr(Y*2,2),16);if(U(de))return Y;y[f+Y]=de}return Y}function Q(y,d,f,w){return Ce(ve(d,y.length-f),y,f,w)}function P(y,d,f,w){return Ce(Ee(d),y,f,w)}function G(y,d,f,w){return Ce(ke(d),y,f,w)}function ie(y,d,f,w){return Ce(Ne(d,y.length-f),y,f,w)}a.prototype.write=function(d,f,w,k){if(f===void 0)k="utf8",w=this.length,f=0;else if(w===void 0&&typeof f=="string")k=f,w=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(w)?(w=w>>>0,k===void 0&&(k="utf8")):(k=w,w=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var W=this.length-f;if((w===void 0||w>W)&&(w=W),d.length>0&&(w<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");k||(k="utf8");for(var Y=!1;;)switch(k){case"hex":return z(this,d,f,w);case"utf8":case"utf-8":return Q(this,d,f,w);case"ascii":case"latin1":case"binary":return P(this,d,f,w);case"base64":return G(this,d,f,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,d,f,w);default:if(Y)throw new TypeError("Unknown encoding: "+k);k=(""+k).toLowerCase(),Y=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ee(y,d,f){return d===0&&f===y.length?e.fromByteArray(y):e.fromByteArray(y.slice(d,f))}function oe(y,d,f){f=Math.min(y.length,f);for(var w=[],k=d;k<f;){var W=y[k],Y=null,de=W>239?4:W>223?3:W>191?2:1;if(k+de<=f){var Te,p,v,q;switch(de){case 1:W<128&&(Y=W);break;case 2:Te=y[k+1],(Te&192)===128&&(q=(W&31)<<6|Te&63,q>127&&(Y=q));break;case 3:Te=y[k+1],p=y[k+2],(Te&192)===128&&(p&192)===128&&(q=(W&15)<<12|(Te&63)<<6|p&63,q>2047&&(q<55296||q>57343)&&(Y=q));break;case 4:Te=y[k+1],p=y[k+2],v=y[k+3],(Te&192)===128&&(p&192)===128&&(v&192)===128&&(q=(W&15)<<18|(Te&63)<<12|(p&63)<<6|v&63,q>65535&&q<1114112&&(Y=q))}}Y===null?(Y=65533,de=1):Y>65535&&(Y-=65536,w.push(Y>>>10&1023|55296),Y=56320|Y&1023),w.push(Y),k+=de}return J(w)}var K=4096;function J(y){var d=y.length;if(d<=K)return String.fromCharCode.apply(String,y);for(var f="",w=0;w<d;)f+=String.fromCharCode.apply(String,y.slice(w,w+=K));return f}function ne(y,d,f){var w="";f=Math.min(y.length,f);for(var k=d;k<f;++k)w+=String.fromCharCode(y[k]&127);return w}function j(y,d,f){var w="";f=Math.min(y.length,f);for(var k=d;k<f;++k)w+=String.fromCharCode(y[k]);return w}function $(y,d,f){var w=y.length;(!d||d<0)&&(d=0),(!f||f<0||f>w)&&(f=w);for(var k="",W=d;W<f;++W)k+=V[y[W]];return k}function N(y,d,f){for(var w=y.slice(d,f),k="",W=0;W<w.length-1;W+=2)k+=String.fromCharCode(w[W]+w[W+1]*256);return k}a.prototype.slice=function(d,f){var w=this.length;d=~~d,f=f===void 0?w:~~f,d<0?(d+=w,d<0&&(d=0)):d>w&&(d=w),f<0?(f+=w,f<0&&(f=0)):f>w&&(f=w),f<d&&(f=d);var k=this.subarray(d,f);return Object.setPrototypeOf(k,a.prototype),k};function X(y,d,f){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+d>f)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(d,f,w){d=d>>>0,f=f>>>0,w||X(d,f,this.length);for(var k=this[d],W=1,Y=0;++Y<f&&(W*=256);)k+=this[d+Y]*W;return k},a.prototype.readUintBE=a.prototype.readUIntBE=function(d,f,w){d=d>>>0,f=f>>>0,w||X(d,f,this.length);for(var k=this[d+--f],W=1;f>0&&(W*=256);)k+=this[d+--f]*W;return k},a.prototype.readUint8=a.prototype.readUInt8=function(d,f){return d=d>>>0,f||X(d,1,this.length),this[d]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(d,f){return d=d>>>0,f||X(d,2,this.length),this[d]|this[d+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(d,f){return d=d>>>0,f||X(d,2,this.length),this[d]<<8|this[d+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(d,f){return d=d>>>0,f||X(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(d,f){return d=d>>>0,f||X(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},a.prototype.readIntLE=function(d,f,w){d=d>>>0,f=f>>>0,w||X(d,f,this.length);for(var k=this[d],W=1,Y=0;++Y<f&&(W*=256);)k+=this[d+Y]*W;return W*=128,k>=W&&(k-=Math.pow(2,8*f)),k},a.prototype.readIntBE=function(d,f,w){d=d>>>0,f=f>>>0,w||X(d,f,this.length);for(var k=f,W=1,Y=this[d+--k];k>0&&(W*=256);)Y+=this[d+--k]*W;return W*=128,Y>=W&&(Y-=Math.pow(2,8*f)),Y},a.prototype.readInt8=function(d,f){return d=d>>>0,f||X(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},a.prototype.readInt16LE=function(d,f){d=d>>>0,f||X(d,2,this.length);var w=this[d]|this[d+1]<<8;return w&32768?w|4294901760:w},a.prototype.readInt16BE=function(d,f){d=d>>>0,f||X(d,2,this.length);var w=this[d+1]|this[d]<<8;return w&32768?w|4294901760:w},a.prototype.readInt32LE=function(d,f){return d=d>>>0,f||X(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},a.prototype.readInt32BE=function(d,f){return d=d>>>0,f||X(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},a.prototype.readFloatLE=function(d,f){return d=d>>>0,f||X(d,4,this.length),t.read(this,d,!0,23,4)},a.prototype.readFloatBE=function(d,f){return d=d>>>0,f||X(d,4,this.length),t.read(this,d,!1,23,4)},a.prototype.readDoubleLE=function(d,f){return d=d>>>0,f||X(d,8,this.length),t.read(this,d,!0,52,8)},a.prototype.readDoubleBE=function(d,f){return d=d>>>0,f||X(d,8,this.length),t.read(this,d,!1,52,8)};function te(y,d,f,w,k,W){if(!a.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>k||d<W)throw new RangeError('"value" argument is out of bounds');if(f+w>y.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(d,f,w,k){if(d=+d,f=f>>>0,w=w>>>0,!k){var W=Math.pow(2,8*w)-1;te(this,d,f,w,W,0)}var Y=1,de=0;for(this[f]=d&255;++de<w&&(Y*=256);)this[f+de]=d/Y&255;return f+w},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(d,f,w,k){if(d=+d,f=f>>>0,w=w>>>0,!k){var W=Math.pow(2,8*w)-1;te(this,d,f,w,W,0)}var Y=w-1,de=1;for(this[f+Y]=d&255;--Y>=0&&(de*=256);)this[f+Y]=d/de&255;return f+w},a.prototype.writeUint8=a.prototype.writeUInt8=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,1,255,0),this[f]=d&255,f+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,2,65535,0),this[f]=d&255,this[f+1]=d>>>8,f+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,2,65535,0),this[f]=d>>>8,this[f+1]=d&255,f+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,4,4294967295,0),this[f+3]=d>>>24,this[f+2]=d>>>16,this[f+1]=d>>>8,this[f]=d&255,f+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,4,4294967295,0),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4},a.prototype.writeIntLE=function(d,f,w,k){if(d=+d,f=f>>>0,!k){var W=Math.pow(2,8*w-1);te(this,d,f,w,W-1,-W)}var Y=0,de=1,Te=0;for(this[f]=d&255;++Y<w&&(de*=256);)d<0&&Te===0&&this[f+Y-1]!==0&&(Te=1),this[f+Y]=(d/de>>0)-Te&255;return f+w},a.prototype.writeIntBE=function(d,f,w,k){if(d=+d,f=f>>>0,!k){var W=Math.pow(2,8*w-1);te(this,d,f,w,W-1,-W)}var Y=w-1,de=1,Te=0;for(this[f+Y]=d&255;--Y>=0&&(de*=256);)d<0&&Te===0&&this[f+Y+1]!==0&&(Te=1),this[f+Y]=(d/de>>0)-Te&255;return f+w},a.prototype.writeInt8=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,1,127,-128),d<0&&(d=255+d+1),this[f]=d&255,f+1},a.prototype.writeInt16LE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,2,32767,-32768),this[f]=d&255,this[f+1]=d>>>8,f+2},a.prototype.writeInt16BE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,2,32767,-32768),this[f]=d>>>8,this[f+1]=d&255,f+2},a.prototype.writeInt32LE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,4,2147483647,-2147483648),this[f]=d&255,this[f+1]=d>>>8,this[f+2]=d>>>16,this[f+3]=d>>>24,f+4},a.prototype.writeInt32BE=function(d,f,w){return d=+d,f=f>>>0,w||te(this,d,f,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4};function le(y,d,f,w,k,W){if(f+w>y.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function he(y,d,f,w,k){return d=+d,f=f>>>0,k||le(y,d,f,4),t.write(y,d,f,w,23,4),f+4}a.prototype.writeFloatLE=function(d,f,w){return he(this,d,f,!0,w)},a.prototype.writeFloatBE=function(d,f,w){return he(this,d,f,!1,w)};function we(y,d,f,w,k){return d=+d,f=f>>>0,k||le(y,d,f,8),t.write(y,d,f,w,52,8),f+8}a.prototype.writeDoubleLE=function(d,f,w){return we(this,d,f,!0,w)},a.prototype.writeDoubleBE=function(d,f,w){return we(this,d,f,!1,w)},a.prototype.copy=function(d,f,w,k){if(!a.isBuffer(d))throw new TypeError("argument should be a Buffer");if(w||(w=0),!k&&k!==0&&(k=this.length),f>=d.length&&(f=d.length),f||(f=0),k>0&&k<w&&(k=w),k===w||d.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(w<0||w>=this.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("sourceEnd out of bounds");k>this.length&&(k=this.length),d.length-f<k-w&&(k=d.length-f+w);var W=k-w;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,w,k):Uint8Array.prototype.set.call(d,this.subarray(w,k),f),W},a.prototype.fill=function(d,f,w,k){if(typeof d=="string"){if(typeof f=="string"?(k=f,f=0,w=this.length):typeof w=="string"&&(k=w,w=this.length),k!==void 0&&typeof k!="string")throw new TypeError("encoding must be a string");if(typeof k=="string"&&!a.isEncoding(k))throw new TypeError("Unknown encoding: "+k);if(d.length===1){var W=d.charCodeAt(0);(k==="utf8"&&W<128||k==="latin1")&&(d=W)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(f<0||this.length<f||this.length<w)throw new RangeError("Out of range index");if(w<=f)return this;f=f>>>0,w=w===void 0?this.length:w>>>0,d||(d=0);var Y;if(typeof d=="number")for(Y=f;Y<w;++Y)this[Y]=d;else{var de=a.isBuffer(d)?d:a.from(d,k),Te=de.length;if(Te===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(Y=0;Y<w-f;++Y)this[Y+f]=de[Y%Te]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function ae(y){if(y=y.split("=")[0],y=y.trim().replace(ue,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function ve(y,d){d=d||1/0;for(var f,w=y.length,k=null,W=[],Y=0;Y<w;++Y){if(f=y.charCodeAt(Y),f>55295&&f<57344){if(!k){if(f>56319){(d-=3)>-1&&W.push(239,191,189);continue}else if(Y+1===w){(d-=3)>-1&&W.push(239,191,189);continue}k=f;continue}if(f<56320){(d-=3)>-1&&W.push(239,191,189),k=f;continue}f=(k-55296<<10|f-56320)+65536}else k&&(d-=3)>-1&&W.push(239,191,189);if(k=null,f<128){if((d-=1)<0)break;W.push(f)}else if(f<2048){if((d-=2)<0)break;W.push(f>>6|192,f&63|128)}else if(f<65536){if((d-=3)<0)break;W.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((d-=4)<0)break;W.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return W}function Ee(y){for(var d=[],f=0;f<y.length;++f)d.push(y.charCodeAt(f)&255);return d}function Ne(y,d){for(var f,w,k,W=[],Y=0;Y<y.length&&!((d-=2)<0);++Y)f=y.charCodeAt(Y),w=f>>8,k=f%256,W.push(k),W.push(w);return W}function ke(y){return e.toByteArray(ae(y))}function Ce(y,d,f,w){for(var k=0;k<w&&!(k+f>=d.length||k>=y.length);++k)d[k+f]=y[k];return k}function L(y,d){return y instanceof d||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===d.name}function U(y){return y!==y}var V=function(){for(var y="0123456789abcdef",d=new Array(256),f=0;f<16;++f)for(var w=f*16,k=0;k<16;++k)d[w+k]=y[f]+y[k];return d}()})(Wt);let la=null;var Vd=function(){return la===null&&(la={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),la},Ao={},$c={};const ua=mn,Rp=new Set(["buffer","view","utf8"]);let Op=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!Rp.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ua(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ua(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ua(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};$c.Encoding=Op;const{Buffer:Nc}=Wt||{},{Encoding:Dc}=$c,Bp=Vd;let Pc=class extends Dc{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new Kc({encode:this.encode,decode:e=>this.decode(Nc.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},Kc=class extends Dc{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new Pc({encode:e=>{const t=this.encode(e);return Nc.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},Lp=class extends Dc{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new Pc({encode:e=>Nc.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=Bp();return new Kc({encode:r=>e.encode(this.encode(r)),decode:r=>this.decode(t.decode(r)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};Ao.BufferFormat=Pc;Ao.ViewFormat=Kc;Ao.UTF8Format=Lp;const{Buffer:gt}=Wt||{Buffer:{isBuffer:()=>!1}},{textEncoder:Wd,textDecoder:Dl}=Vd(),{BufferFormat:To,ViewFormat:Mc,UTF8Format:qd}=Ao,As=n=>n;ti.utf8=new qd({encode:function(n){return gt.isBuffer(n)?n.toString("utf8"):ArrayBuffer.isView(n)?Dl.decode(n):String(n)},decode:As,name:"utf8",createViewTranscoder(){return new Mc({encode:function(n){return ArrayBuffer.isView(n)?n:Wd.encode(n)},decode:function(n){return Dl.decode(n)},name:`${this.name}+view`})},createBufferTranscoder(){return new To({encode:function(n){return gt.isBuffer(n)?n:ArrayBuffer.isView(n)?gt.from(n.buffer,n.byteOffset,n.byteLength):gt.from(String(n),"utf8")},decode:function(n){return n.toString("utf8")},name:`${this.name}+buffer`})}});ti.json=new qd({encode:JSON.stringify,decode:JSON.parse,name:"json"});ti.buffer=new To({encode:function(n){return gt.isBuffer(n)?n:ArrayBuffer.isView(n)?gt.from(n.buffer,n.byteOffset,n.byteLength):gt.from(String(n),"utf8")},decode:As,name:"buffer",createViewTranscoder(){return new Mc({encode:function(n){return ArrayBuffer.isView(n)?n:gt.from(String(n),"utf8")},decode:function(n){return gt.from(n.buffer,n.byteOffset,n.byteLength)},name:`${this.name}+view`})}});ti.view=new Mc({encode:function(n){return ArrayBuffer.isView(n)?n:Wd.encode(n)},decode:As,name:"view",createBufferTranscoder(){return new To({encode:function(n){return gt.isBuffer(n)?n:ArrayBuffer.isView(n)?gt.from(n.buffer,n.byteOffset,n.byteLength):gt.from(String(n),"utf8")},decode:As,name:`${this.name}+buffer`})}});ti.hex=new To({encode:function(n){return gt.isBuffer(n)?n:gt.from(String(n),"hex")},decode:function(n){return n.toString("hex")},name:"hex"});ti.base64=new To({encode:function(n){return gt.isBuffer(n)?n:gt.from(String(n),"base64")},decode:function(n){return n.toString("base64")},name:"base64"});const Pl=mn,Ts=ti,{Encoding:kp}=$c,{BufferFormat:Cp,ViewFormat:Up,UTF8Format:$p}=Ao,qi=Symbol("formats"),Mo=Symbol("encodings"),Np=new Set(["buffer","view","utf8"]);let Dp=class{constructor(e){if(Array.isArray(e)){if(!e.every(t=>Np.has(t)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[Mo]=new Map,this[qi]=new Set(e);for(const t in Ts)try{this.encoding(t)}catch(r){if(r.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw r}}encodings(){return Array.from(new Set(this[Mo].values()))}encoding(e){let t=this[Mo].get(e);if(t===void 0){if(typeof e=="string"&&e!==""){if(t=Fp[e],!t)throw new Pl(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");t=Pp(e)}const{name:r,format:i}=t;if(!this[qi].has(i))if(this[qi].has("view"))t=t.createViewTranscoder();else if(this[qi].has("buffer"))t=t.createBufferTranscoder();else if(this[qi].has("utf8"))t=t.createUTF8Transcoder();else throw new Pl(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const o of[e,r,t.name,t.commonName])this[Mo].set(o,t)}return t}};jd.Transcoder=Dp;function Pp(n){if(n instanceof kp)return n;const e="type"in n&&typeof n.type=="string"?n.type:void 0,t=n.name||e||`anonymous-${jp++}`;switch(Kp(n)){case"view":return new Up({...n,name:t});case"utf8":return new $p({...n,name:t});case"buffer":return new Cp({...n,name:t});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function Kp(n){return"format"in n&&n.format!==void 0?n.format:"buffer"in n&&typeof n.buffer=="boolean"?n.buffer?"buffer":"utf8":"code"in n&&Number.isInteger(n.code)?"view":"buffer"}const Mp={binary:Ts.buffer,"utf-8":Ts.utf8},Fp={...Ts,...Mp};let jp=0;var Fc={exports:{}},Si=typeof Reflect=="object"?Reflect:null,Kl=Si&&typeof Si.apply=="function"?Si.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},ls;Si&&typeof Si.ownKeys=="function"?ls=Si.ownKeys:Object.getOwnPropertySymbols?ls=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ls=function(e){return Object.getOwnPropertyNames(e)};function Hp(n){console&&console.warn&&console.warn(n)}var zd=Number.isNaN||function(e){return e!==e};function $e(){$e.init.call(this)}Fc.exports=$e;Fc.exports.once=zp;$e.EventEmitter=$e;$e.prototype._events=void 0;$e.prototype._eventsCount=0;$e.prototype._maxListeners=void 0;var Ml=10;function Ns(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty($e,"defaultMaxListeners",{enumerable:!0,get:function(){return Ml},set:function(n){if(typeof n!="number"||n<0||zd(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");Ml=n}});$e.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};$e.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||zd(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Gd(n){return n._maxListeners===void 0?$e.defaultMaxListeners:n._maxListeners}$e.prototype.getMaxListeners=function(){return Gd(this)};$e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")Kl(l,this,t);else for(var u=l.length,c=Qd(l,u),r=0;r<u;++r)Kl(c[r],this,t);return!0};function Yd(n,e,t,r){var i,o,s;if(Ns(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),s=o[e]),s===void 0)s=o[e]=t,++n._eventsCount;else if(typeof s=="function"?s=o[e]=r?[t,s]:[s,t]:r?s.unshift(t):s.push(t),i=Gd(n),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=s.length,Hp(a)}return n}$e.prototype.addListener=function(e,t){return Yd(this,e,t,!1)};$e.prototype.on=$e.prototype.addListener;$e.prototype.prependListener=function(e,t){return Yd(this,e,t,!0)};function Vp(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Jd(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=Vp.bind(r);return i.listener=t,r.wrapFn=i,i}$e.prototype.once=function(e,t){return Ns(t),this.on(e,Jd(this,e,t)),this};$e.prototype.prependOnceListener=function(e,t){return Ns(t),this.prependListener(e,Jd(this,e,t)),this};$e.prototype.removeListener=function(e,t){var r,i,o,s,a;if(Ns(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():Wp(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};$e.prototype.off=$e.prototype.removeListener;$e.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Xd(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?qp(i):Qd(i,i.length)}$e.prototype.listeners=function(e){return Xd(this,e,!0)};$e.prototype.rawListeners=function(e){return Xd(this,e,!1)};$e.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):Zd.call(n,e)};$e.prototype.listenerCount=Zd;function Zd(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}$e.prototype.eventNames=function(){return this._eventsCount>0?ls(this._events):[]};function Qd(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function Wp(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function qp(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function zp(n,e){return new Promise(function(t,r){function i(s){n.removeListener(e,o),r(s)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}ef(n,e,o,{once:!0}),e!=="error"&&Gp(n,i,{once:!0})})}function Gp(n,e,t){typeof n.on=="function"&&ef(n,"error",e,t)}function ef(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){r.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Ds=Fc.exports,Ci={},Yp=typeof queueMicrotask=="function"?queueMicrotask:n=>Promise.resolve().then(n),Fl=Yp;Ci.fromCallback=function(n,e){if(n===void 0){var t=new Promise(function(r,i){n=function(o,s){o?i(o):r(s)}});n[e!==void 0?e:"promise"]=t}else if(typeof n!="function")throw new TypeError("Callback must be a function");return n};Ci.fromPromise=function(n,e){if(e===void 0)return n;n.then(function(t){Fl(()=>e(null,t))}).catch(function(t){Fl(()=>e(t))})};var En={},Io={};Io.getCallback=function(n,e){return typeof n=="function"?n:e};Io.getOptions=function(n,e){return typeof n=="object"&&n!==null?n:e!==void 0?e:{}};const{fromCallback:da}=Ci,Bt=mn,{getOptions:fa,getCallback:jl}=Io,Sr=Symbol("promise"),li=Symbol("callback"),tn=Symbol("working"),Pr=Symbol("handleOne"),Un=Symbol("handleMany"),ha=Symbol("autoClose"),hr=Symbol("finishWork"),fn=Symbol("returnMany"),Yn=Symbol("closing"),zi=Symbol("handleClose"),Fo=Symbol("closed"),Gi=Symbol("closeCallbacks"),ur=Symbol("keyEncoding"),zr=Symbol("valueEncoding"),ya=Symbol("abortOnClose"),jo=Symbol("legacy"),pa=Symbol("keys"),ga=Symbol("values"),Jn=Symbol("limit"),Ft=Symbol("count"),Ho=Object.freeze({}),Jp=()=>{};let Hl=!1;class jc{constructor(e,t,r){if(typeof e!="object"||e===null){const i=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${i}`)}if(typeof t!="object"||t===null)throw new TypeError("The second argument must be an options object");this[Fo]=!1,this[Gi]=[],this[tn]=!1,this[Yn]=!1,this[ha]=!1,this[li]=null,this[Pr]=this[Pr].bind(this),this[Un]=this[Un].bind(this),this[zi]=this[zi].bind(this),this[ur]=t[ur],this[zr]=t[zr],this[jo]=r,this[Jn]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[Ft]=0,this[ya]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[Ft]}get limit(){return this[Jn]}next(e){let t;if(e===void 0)t=new Promise((r,i)=>{e=(o,s,a)=>{o?i(o):this[jo]?s===void 0&&a===void 0?r():r([s,a]):r(s)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[Yn]?this.nextTick(e,new Bt("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[tn]?this.nextTick(e,new Bt("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[tn]=!0,this[li]=e,this[Ft]>=this[Jn]?this.nextTick(this[Pr],null):this._next(this[Pr])),t}_next(e){this.nextTick(e)}nextv(e,t,r){return r=jl(t,r),r=da(r,Sr),t=fa(t,Ho),Number.isInteger(e)?(this[Yn]?this.nextTick(r,new Bt("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[tn]?this.nextTick(r,new Bt("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[Jn]<1/0&&(e=Math.min(e,this[Jn]-this[Ft])),this[tn]=!0,this[li]=r,e<=0?this.nextTick(this[Un],null,[]):this._nextv(e,t,this[Un])),r[Sr]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[Sr])}_nextv(e,t,r){const i=[],o=(s,a,l)=>{if(s)return r(s);if(this[jo]?a===void 0&&l===void 0:a===void 0)return r(null,i);i.push(this[jo]?[a,l]:a),i.length===e?r(null,i):this._next(o)};this._next(o)}all(e,t){return t=jl(e,t),t=da(t,Sr),e=fa(e,Ho),this[Yn]?this.nextTick(t,new Bt("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[tn]?this.nextTick(t,new Bt("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[tn]=!0,this[li]=t,this[ha]=!0,this[Ft]>=this[Jn]?this.nextTick(this[Un],null,[]):this._all(e,this[Un])),t[Sr]}_all(e,t){let r=this[Ft];const i=[],o=()=>{const a=this[Jn]<1/0?Math.min(1e3,this[Jn]-r):1e3;a<=0?this.nextTick(t,null,i):this._nextv(a,Ho,s)},s=(a,l)=>{a?t(a):l.length===0?t(null,i):(i.push.apply(i,l),r+=l.length,o())};o()}[hr](){const e=this[li];return this[ya]&&e===null?Jp:(this[tn]=!1,this[li]=null,this[Yn]&&this._close(this[zi]),e)}[fn](e,t,r){this[ha]?this.close(e.bind(null,t,r)):e(t,r)}seek(e,t){if(t=fa(t,Ho),!this[Yn]){if(this[tn])throw new Bt("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(t.keyEncoding||this[ur]),i=r.format;t.keyEncoding!==i&&(t={...t,keyEncoding:i});const o=this.db.prefixKey(r.encode(e),i);this._seek(o,t)}}}_seek(e,t){throw new Bt("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=da(e,Sr),this[Fo]?this.nextTick(e):this[Yn]?this[Gi].push(e):(this[Yn]=!0,this[Gi].push(e),this[tn]?this[ya]&&this[hr]()(new Bt("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[zi])),e[Sr]}_close(e){this.nextTick(e)}[zi](){this[Fo]=!0,this.db.detachResource(this);const e=this[Gi];this[Gi]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[Fo]||await this.close()}}}let Ps=class extends jc{constructor(e,t){super(e,t,!0),this[pa]=t.keys!==!1,this[ga]=t.values!==!1}[Pr](e,t,r){const i=this[hr]();if(e)return i(e);try{t=this[pa]&&t!==void 0?this[ur].decode(t):void 0,r=this[ga]&&r!==void 0?this[zr].decode(r):void 0}catch(o){return i(new Ri("entry",o))}t===void 0&&r===void 0||this[Ft]++,i(null,t,r)}[Un](e,t){const r=this[hr]();if(e)return this[fn](r,e);try{for(const i of t){const o=i[0],s=i[1];i[0]=this[pa]&&o!==void 0?this[ur].decode(o):void 0,i[1]=this[ga]&&s!==void 0?this[zr].decode(s):void 0}}catch(i){return this[fn](r,new Ri("entries",i))}this[Ft]+=t.length,this[fn](r,null,t)}end(e){return!Hl&&typeof console<"u"&&(Hl=!0,console.warn(new Bt("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},Xp=class extends jc{constructor(e,t){super(e,t,!1)}[Pr](e,t){const r=this[hr]();if(e)return r(e);try{t=t!==void 0?this[ur].decode(t):void 0}catch(i){return r(new Ri("key",i))}t!==void 0&&this[Ft]++,r(null,t)}[Un](e,t){const r=this[hr]();if(e)return this[fn](r,e);try{for(let i=0;i<t.length;i++){const o=t[i];t[i]=o!==void 0?this[ur].decode(o):void 0}}catch(i){return this[fn](r,new Ri("keys",i))}this[Ft]+=t.length,this[fn](r,null,t)}},Zp=class extends jc{constructor(e,t){super(e,t,!1)}[Pr](e,t){const r=this[hr]();if(e)return r(e);try{t=t!==void 0?this[zr].decode(t):void 0}catch(i){return r(new Ri("value",i))}t!==void 0&&this[Ft]++,r(null,t)}[Un](e,t){const r=this[hr]();if(e)return this[fn](r,e);try{for(let i=0;i<t.length;i++){const o=t[i];t[i]=o!==void 0?this[zr].decode(o):void 0}}catch(i){return this[fn](r,new Ri("values",i))}this[Ft]+=t.length,this[fn](r,null,t)}};class Ri extends Bt{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const n of["_ended property","_nexting property","_end method"])Object.defineProperty(Ps.prototype,n.split(" ")[0],{get(){throw new Bt(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new Bt(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})}});Ps.keyEncoding=ur;Ps.valueEncoding=zr;En.AbstractIterator=Ps;En.AbstractKeyIterator=Xp;En.AbstractValueIterator=Zp;var Hc={};const{AbstractKeyIterator:Qp,AbstractValueIterator:e0}=En,$r=Symbol("iterator"),Yi=Symbol("callback"),Oi=Symbol("handleOne"),jr=Symbol("handleMany");let Qa=class extends Qp{constructor(e,t){super(e,t),this[$r]=e.iterator({...t,keys:!0,values:!1}),this[Oi]=this[Oi].bind(this),this[jr]=this[jr].bind(this)}},tf=class extends e0{constructor(e,t){super(e,t),this[$r]=e.iterator({...t,keys:!1,values:!0}),this[Oi]=this[Oi].bind(this),this[jr]=this[jr].bind(this)}};for(const n of[Qa,tf]){const e=n===Qa,t=e?r=>r[0]:r=>r[1];n.prototype._next=function(r){this[Yi]=r,this[$r].next(this[Oi])},n.prototype[Oi]=function(r,i,o){const s=this[Yi];r?s(r):s(null,e?i:o)},n.prototype._nextv=function(r,i,o){this[Yi]=o,this[$r].nextv(r,i,this[jr])},n.prototype._all=function(r,i){this[Yi]=i,this[$r].all(r,this[jr])},n.prototype[jr]=function(r,i){const o=this[Yi];r?o(r):o(null,i.map(t))},n.prototype._seek=function(r,i){this[$r].seek(r,i)},n.prototype._close=function(r){this[$r].close(r)}}Hc.DefaultKeyIterator=Qa;Hc.DefaultValueIterator=tf;var Ks={};const{AbstractIterator:t0,AbstractKeyIterator:n0,AbstractValueIterator:r0}=En,wa=mn,Et=Symbol("nut"),Ms=Symbol("undefer"),Fs=Symbol("factory");let nf=class extends t0{constructor(e,t){super(e,t),this[Et]=null,this[Fs]=()=>e.iterator(t),this.db.defer(()=>this[Ms]())}},rf=class extends n0{constructor(e,t){super(e,t),this[Et]=null,this[Fs]=()=>e.keys(t),this.db.defer(()=>this[Ms]())}},of=class extends r0{constructor(e,t){super(e,t),this[Et]=null,this[Fs]=()=>e.values(t),this.db.defer(()=>this[Ms]())}};for(const n of[nf,rf,of])n.prototype[Ms]=function(){this.db.status==="open"&&(this[Et]=this[Fs]())},n.prototype._next=function(e){this[Et]!==null?this[Et].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new wa("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._nextv=function(e,t,r){this[Et]!==null?this[Et].nextv(e,t,r):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,t,r)):this.nextTick(r,new wa("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._all=function(e,t){this[Et]!==null?this[Et].all(t):this.db.status==="opening"?this.db.defer(()=>this._all(e,t)):this.nextTick(t,new wa("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._seek=function(e,t){this[Et]!==null?this[Et]._seek(e,t):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,t))},n.prototype._close=function(e){this[Et]!==null?this[Et].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};Ks.DeferredIterator=nf;Ks.DeferredKeyIterator=rf;Ks.DeferredValueIterator=of;var sf={},Vc={};const{fromCallback:Vl}=Ci,Vo=mn,{getCallback:i0,getOptions:o0}=Io,Wo=Symbol("promise"),$t=Symbol("status"),ui=Symbol("operations"),Ji=Symbol("finishClose"),di=Symbol("closeCallbacks");let s0=class{constructor(e){if(typeof e!="object"||e===null){const t=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[ui]=[],this[di]=[],this[$t]="open",this[Ji]=this[Ji].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[ui].length}put(e,t,r){if(this[$t]!=="open")throw new Vo("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const i=this.db._checkKey(e)||this.db._checkValue(t);if(i)throw i;const o=r&&r.sublevel!=null?r.sublevel:this.db,s=r,a=o.keyEncoding(r&&r.keyEncoding),l=o.valueEncoding(r&&r.valueEncoding),u=a.format;r={...r,keyEncoding:u,valueEncoding:l.format},o!==this.db&&(r.sublevel=null);const c=o.prefixKey(a.encode(e),u),h=l.encode(t);return this._put(c,h,r),this[ui].push({...s,type:"put",key:e,value:t}),this}_put(e,t,r){}del(e,t){if(this[$t]!=="open")throw new Vo("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e);if(r)throw r;const i=t&&t.sublevel!=null?t.sublevel:this.db,o=t,s=i.keyEncoding(t&&t.keyEncoding),a=s.format;return t={...t,keyEncoding:a},i!==this.db&&(t.sublevel=null),this._del(i.prefixKey(s.encode(e),a),t),this[ui].push({...o,type:"del",key:e}),this}_del(e,t){}clear(){if(this[$t]!=="open")throw new Vo("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[ui]=[],this}_clear(){}write(e,t){return t=i0(e,t),t=Vl(t,Wo),e=o0(e),this[$t]!=="open"?this.nextTick(t,new Vo("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(t):(this[$t]="writing",this._write(e,r=>{this[$t]="closing",this[di].push(()=>t(r)),r||this.db.emit("batch",this[ui]),this._close(this[Ji])})),t[Wo]}_write(e,t){}close(e){return e=Vl(e,Wo),this[$t]==="closing"?this[di].push(e):this[$t]==="closed"?this.nextTick(e):(this[di].push(e),this[$t]!=="writing"&&(this[$t]="closing",this._close(this[Ji]))),e[Wo]}_close(e){this.nextTick(e)}[Ji](){this[$t]="closed",this.db.detachResource(this);const e=this[di];this[di]=[];for(const t of e)t()}};Vc.AbstractChainedBatch=s0;const{AbstractChainedBatch:a0}=Vc,c0=mn,fi=Symbol("encoded");let l0=class extends a0{constructor(e){super(e),this[fi]=[]}_put(e,t,r){this[fi].push({...r,type:"put",key:e,value:t})}_del(e,t){this[fi].push({...t,type:"del",key:e})}_clear(){this[fi]=[]}_write(e,t){this.db.status==="opening"?this.db.defer(()=>this._write(e,t)):this.db.status==="open"?this[fi].length===0?this.nextTick(t):this.db._batch(this[fi],e,t):this.nextTick(t,new c0("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};sf.DefaultChainedBatch=l0;const Wl=mn,u0=Object.prototype.hasOwnProperty,d0=new Set(["lt","lte","gt","gte"]);var f0=function(n,e){const t={};for(const r in n)if(u0.call(n,r)&&!(r==="keyEncoding"||r==="valueEncoding")){if(r==="start"||r==="end")throw new Wl(`The legacy range option '${r}' has been removed`,{code:"LEVEL_LEGACY"});if(r==="encoding")throw new Wl("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});d0.has(r)?t[r]=e.encode(n[r]):t[r]=n[r]}return t.reverse=!!t.reverse,t.limit=Number.isInteger(t.limit)&&t.limit>=0?t.limit:-1,t};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let ql;var af=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):n=>(ql||(ql=Promise.resolve())).then(n).catch(e=>setTimeout(()=>{throw e},0)),ba,zl;function h0(){if(zl)return ba;zl=1;const n=af;return ba=function(e,...t){t.length===0?n(e):n(()=>e(...t))},ba}var Xi={},Gl;function y0(){if(Gl)return Xi;Gl=1;const{AbstractIterator:n,AbstractKeyIterator:e,AbstractValueIterator:t}=En,r=Symbol("unfix"),i=Symbol("iterator"),o=Symbol("handleOne"),s=Symbol("handleMany"),a=Symbol("callback");class l extends n{constructor(m,E,g,S){super(m,E),this[i]=g,this[r]=S,this[o]=this[o].bind(this),this[s]=this[s].bind(this),this[a]=null}[o](m,E,g){const S=this[a];if(m)return S(m);E!==void 0&&(E=this[r](E)),S(m,E,g)}[s](m,E){const g=this[a];if(m)return g(m);for(const S of E){const C=S[0];C!==void 0&&(S[0]=this[r](C))}g(m,E)}}class u extends e{constructor(m,E,g,S){super(m,E),this[i]=g,this[r]=S,this[o]=this[o].bind(this),this[s]=this[s].bind(this),this[a]=null}[o](m,E){const g=this[a];if(m)return g(m);E!==void 0&&(E=this[r](E)),g(m,E)}[s](m,E){const g=this[a];if(m)return g(m);for(let S=0;S<E.length;S++){const C=E[S];C!==void 0&&(E[S]=this[r](C))}g(m,E)}}class c extends t{constructor(m,E,g){super(m,E),this[i]=g}}for(const h of[l,u])h.prototype._next=function(m){this[a]=m,this[i].next(this[o])},h.prototype._nextv=function(m,E,g){this[a]=g,this[i].nextv(m,E,this[s])},h.prototype._all=function(m,E){this[a]=E,this[i].all(m,this[s])};for(const h of[c])h.prototype._next=function(m){this[i].next(m)},h.prototype._nextv=function(m,E,g){this[i].nextv(m,E,g)},h.prototype._all=function(m,E){this[i].all(m,E)};for(const h of[l,u,c])h.prototype._seek=function(m,E){this[i].seek(m,E)},h.prototype._close=function(m){this[i].close(m)};return Xi.AbstractSublevelIterator=l,Xi.AbstractSublevelKeyIterator=u,Xi.AbstractSublevelValueIterator=c,Xi}var va,Yl;function p0(){if(Yl)return va;Yl=1;const n=mn,{Buffer:e}=Wt||{},{AbstractSublevelIterator:t,AbstractSublevelKeyIterator:r,AbstractSublevelValueIterator:i}=y0(),o=Symbol("prefix"),s=Symbol("upperBound"),a=Symbol("prefixRange"),l=Symbol("parent"),u=Symbol("unfix"),c=new TextEncoder,h={separator:"!"};va=function({AbstractLevel:B}){class A extends B{static defaults(I){if(typeof I=="string")throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(I&&I.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return I==null?h:I.separator?I:{...I,separator:"!"}}constructor(I,x,D){const{separator:H,manifest:z,...Q}=A.defaults(D);x=C(x,H);const P=H.charCodeAt(0)+1,G=I[l]||I;if(!c.encode(x).every(oe=>oe>P&&oe<127))throw new n(`Prefix must use bytes > ${P} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(m(G,z),Q);const ie=(I.prefix||"")+H+x+H,ee=ie.slice(0,-1)+String.fromCharCode(P);this[l]=G,this[o]=new g(ie),this[s]=new g(ee),this[u]=new S,this.nextTick=G.nextTick}prefixKey(I,x){if(x==="utf8")return this[o].utf8+I;if(I.byteLength===0)return this[o][x];if(x==="view"){const D=this[o].view,H=new Uint8Array(D.byteLength+I.byteLength);return H.set(D,0),H.set(I,D.byteLength),H}else{const D=this[o].buffer;return e.concat([D,I],D.byteLength+I.byteLength)}}[a](I,x){I.gte!==void 0?I.gte=this.prefixKey(I.gte,x):I.gt!==void 0?I.gt=this.prefixKey(I.gt,x):I.gte=this[o][x],I.lte!==void 0?I.lte=this.prefixKey(I.lte,x):I.lt!==void 0?I.lt=this.prefixKey(I.lt,x):I.lte=this[s][x]}get prefix(){return this[o].utf8}get db(){return this[l]}_open(I,x){this[l].open({passive:!0},x)}_put(I,x,D,H){this[l].put(I,x,D,H)}_get(I,x,D){this[l].get(I,x,D)}_getMany(I,x,D){this[l].getMany(I,x,D)}_del(I,x,D){this[l].del(I,x,D)}_batch(I,x,D){this[l].batch(I,x,D)}_clear(I,x){this[a](I,I.keyEncoding),this[l].clear(I,x)}_iterator(I){this[a](I,I.keyEncoding);const x=this[l].iterator(I),D=this[u].get(this[o].utf8.length,I.keyEncoding);return new t(this,I,x,D)}_keys(I){this[a](I,I.keyEncoding);const x=this[l].keys(I),D=this[u].get(this[o].utf8.length,I.keyEncoding);return new r(this,I,x,D)}_values(I){this[a](I,I.keyEncoding);const x=this[l].values(I);return new i(this,I,x)}}return{AbstractSublevel:A}};const m=function(B,A){return{...B.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...A,encodings:{utf8:E(B,"utf8"),buffer:E(B,"buffer"),view:E(B,"view")}}},E=function(B,A){return B.supports.encodings[A]?B.keyEncoding(A).name===A:!1};class g{constructor(A){this.utf8=A,this.view=c.encode(A),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class S{constructor(){this.cache=new Map}get(A,O){let I=this.cache.get(O);return I===void 0&&(O==="view"?I=(function(x,D){return D.subarray(x)}).bind(null,A):I=(function(x,D){return D.slice(x)}).bind(null,A),this.cache.set(O,I)),I}}const C=function(B,A){let O=0,I=B.length;for(;O<I&&B[O]===A;)O++;for(;I>O&&B[I-1]===A;)I--;return B.slice(O,I)};return va}const{supports:g0}=Fd,{Transcoder:w0}=jd,{EventEmitter:b0}=Ds,{fromCallback:Xn}=Ci,Yt=mn,{AbstractIterator:Ar}=En,{DefaultKeyIterator:v0,DefaultValueIterator:m0}=Hc,{DeferredIterator:E0,DeferredKeyIterator:_0,DeferredValueIterator:x0}=Ks,{DefaultChainedBatch:Jl}=sf,{getCallback:Tr,getOptions:Zn}=Io,qo=f0,xe=Symbol("promise"),Tn=Symbol("landed"),Ir=Symbol("resources"),ma=Symbol("closeResources"),Zi=Symbol("operations"),Qi=Symbol("undefer"),zo=Symbol("deferOpen"),Xl=Symbol("options"),Ie=Symbol("status"),Rr=Symbol("defaultOptions"),hi=Symbol("transcoder"),Go=Symbol("keyEncoding"),Ea=Symbol("valueEncoding"),S0=()=>{};let Wc=class extends b0{constructor(e,t){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");t=Zn(t);const{keyEncoding:r,valueEncoding:i,passive:o,...s}=t;this[Ir]=new Set,this[Zi]=[],this[zo]=!0,this[Xl]=s,this[Ie]="opening",this.supports=g0(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[hi]=new w0(A0(this)),this[Go]=this[hi].encoding(r||"utf8"),this[Ea]=this[hi].encoding(i||"utf8");for(const a of this[hi].encodings())this.supports.encodings[a.commonName]||(this.supports.encodings[a.commonName]=!0);this[Rr]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[Go].commonName,valueEncoding:this[Ea].commonName}),key:Object.freeze({keyEncoding:this[Go].commonName})},this.nextTick(()=>{this[zo]&&this.open({passive:!1},S0)})}get status(){return this[Ie]}keyEncoding(e){return this[hi].encoding(e??this[Go])}valueEncoding(e){return this[hi].encoding(e??this[Ea])}open(e,t){t=Tr(e,t),t=Xn(t,xe),e={...this[Xl],...Zn(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;const r=i=>{this[Ie]==="closing"||this[Ie]==="opening"?this.once(Tn,i?()=>r(i):r):this[Ie]!=="open"?t(new Yt("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:i})):t()};return e.passive?this[Ie]==="opening"?this.once(Tn,r):this.nextTick(r):this[Ie]==="closed"||this[zo]?(this[zo]=!1,this[Ie]="opening",this.emit("opening"),this._open(e,i=>{if(i){this[Ie]="closed",this[ma](()=>{this.emit(Tn),r(i)}),this[Qi]();return}this[Ie]="open",this[Qi](),this.emit(Tn),this[Ie]==="open"&&this.emit("open"),this[Ie]==="open"&&this.emit("ready"),r()})):this[Ie]==="open"?this.nextTick(r):this.once(Tn,()=>this.open(e,t)),t[xe]}_open(e,t){this.nextTick(t)}close(e){e=Xn(e,xe);const t=r=>{this[Ie]==="opening"||this[Ie]==="closing"?this.once(Tn,r?t(r):t):this[Ie]!=="closed"?e(new Yt("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):e()};if(this[Ie]==="open"){this[Ie]="closing",this.emit("closing");const r=i=>{this[Ie]="open",this[Qi](),this.emit(Tn),t(i)};this[ma](()=>{this._close(i=>{if(i)return r(i);this[Ie]="closed",this[Qi](),this.emit(Tn),this[Ie]==="closed"&&this.emit("closed"),t()})})}else this[Ie]==="closed"?this.nextTick(t):this.once(Tn,()=>this.close(e));return e[xe]}[ma](e){if(this[Ir].size===0)return this.nextTick(e);let t=this[Ir].size,r=!0;const i=()=>{--t===0&&(r?this.nextTick(e):e())};for(const o of this[Ir])o.close(i);r=!1,this[Ir].clear()}_close(e){this.nextTick(e)}get(e,t,r){if(r=Tr(t,r),r=Xn(r,xe),t=Zn(t,this[Rr].entry),this[Ie]==="opening")return this.defer(()=>this.get(e,t,r)),r[xe];if(yi(this,r))return r[xe];const i=this._checkKey(e);if(i)return this.nextTick(r,i),r[xe];const o=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),a=o.format,l=s.format;return(t.keyEncoding!==a||t.valueEncoding!==l)&&(t=Object.assign({},t,{keyEncoding:a,valueEncoding:l})),this._get(this.prefixKey(o.encode(e),a),t,(u,c)=>{if(u)return(u.code==="LEVEL_NOT_FOUND"||u.notFound||/NotFound/i.test(u))&&(u.code||(u.code="LEVEL_NOT_FOUND"),u.notFound||(u.notFound=!0),u.status||(u.status=404)),r(u);try{c=s.decode(c)}catch(h){return r(new Yt("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:h}))}r(null,c)}),r[xe]}_get(e,t,r){this.nextTick(r,new Error("NotFound"))}getMany(e,t,r){if(r=Tr(t,r),r=Xn(r,xe),t=Zn(t,this[Rr].entry),this[Ie]==="opening")return this.defer(()=>this.getMany(e,t,r)),r[xe];if(yi(this,r))return r[xe];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[xe];if(e.length===0)return this.nextTick(r,null,[]),r[xe];const i=this.keyEncoding(t.keyEncoding),o=this.valueEncoding(t.valueEncoding),s=i.format,a=o.format;(t.keyEncoding!==s||t.valueEncoding!==a)&&(t=Object.assign({},t,{keyEncoding:s,valueEncoding:a}));const l=new Array(e.length);for(let u=0;u<e.length;u++){const c=e[u],h=this._checkKey(c);if(h)return this.nextTick(r,h),r[xe];l[u]=this.prefixKey(i.encode(c),s)}return this._getMany(l,t,(u,c)=>{if(u)return r(u);try{for(let h=0;h<c.length;h++)c[h]!==void 0&&(c[h]=o.decode(c[h]))}catch(h){return r(new Yt(`Could not decode one or more of ${c.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:h}))}r(null,c)}),r[xe]}_getMany(e,t,r){this.nextTick(r,null,new Array(e.length).fill(void 0))}put(e,t,r,i){if(i=Tr(r,i),i=Xn(i,xe),r=Zn(r,this[Rr].entry),this[Ie]==="opening")return this.defer(()=>this.put(e,t,r,i)),i[xe];if(yi(this,i))return i[xe];const o=this._checkKey(e)||this._checkValue(t);if(o)return this.nextTick(i,o),i[xe];const s=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),l=s.format,u=a.format;(r.keyEncoding!==l||r.valueEncoding!==u)&&(r=Object.assign({},r,{keyEncoding:l,valueEncoding:u}));const c=this.prefixKey(s.encode(e),l),h=a.encode(t);return this._put(c,h,r,m=>{if(m)return i(m);this.emit("put",e,t),i()}),i[xe]}_put(e,t,r,i){this.nextTick(i)}del(e,t,r){if(r=Tr(t,r),r=Xn(r,xe),t=Zn(t,this[Rr].key),this[Ie]==="opening")return this.defer(()=>this.del(e,t,r)),r[xe];if(yi(this,r))return r[xe];const i=this._checkKey(e);if(i)return this.nextTick(r,i),r[xe];const o=this.keyEncoding(t.keyEncoding),s=o.format;return t.keyEncoding!==s&&(t=Object.assign({},t,{keyEncoding:s})),this._del(this.prefixKey(o.encode(e),s),t,a=>{if(a)return r(a);this.emit("del",e),r()}),r[xe]}_del(e,t,r){this.nextTick(r)}batch(e,t,r){if(!arguments.length){if(this[Ie]==="opening")return new Jl(this);if(this[Ie]!=="open")throw new Yt("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?r=e:r=Tr(t,r),r=Xn(r,xe),t=Zn(t,this[Rr].empty),this[Ie]==="opening")return this.defer(()=>this.batch(e,t,r)),r[xe];if(yi(this,r))return r[xe];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[xe];if(e.length===0)return this.nextTick(r),r[xe];const i=new Array(e.length),{keyEncoding:o,valueEncoding:s,...a}=t;for(let l=0;l<e.length;l++){if(typeof e[l]!="object"||e[l]===null)return this.nextTick(r,new TypeError("A batch operation must be an object")),r[xe];const u=Object.assign({},e[l]);if(u.type!=="put"&&u.type!=="del")return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[xe];const c=this._checkKey(u.key);if(c)return this.nextTick(r,c),r[xe];const h=u.sublevel!=null?u.sublevel:this,m=h.keyEncoding(u.keyEncoding||o),E=m.format;if(u.key=h.prefixKey(m.encode(u.key),E),u.keyEncoding=E,u.type==="put"){const g=this._checkValue(u.value);if(g)return this.nextTick(r,g),r[xe];const S=h.valueEncoding(u.valueEncoding||s);u.value=S.encode(u.value),u.valueEncoding=S.format}h!==this&&(u.sublevel=null),i[l]=u}return this._batch(i,a,l=>{if(l)return r(l);this.emit("batch",e),r()}),r[xe]}_batch(e,t,r){this.nextTick(r)}sublevel(e,t){return this._sublevel(e,ec.defaults(t))}_sublevel(e,t){return new ec(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=Tr(e,t),t=Xn(t,xe),e=Zn(e,this[Rr].empty),this[Ie]==="opening")return this.defer(()=>this.clear(e,t)),t[xe];if(yi(this,t))return t[xe];const r=e,i=this.keyEncoding(e.keyEncoding);return e=qo(e,i),e.keyEncoding=i.format,e.limit===0?this.nextTick(t):this._clear(e,o=>{if(o)return t(o);this.emit("clear",r),t()}),t[xe]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=qo(e,t),e.keys=e.keys!==!1,e.values=e.values!==!1,e[Ar.keyEncoding]=t,e[Ar.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,this[Ie]==="opening")return new E0(this,e);if(this[Ie]!=="open")throw new Yt("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new Ar(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=qo(e,t),e[Ar.keyEncoding]=t,e[Ar.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,this[Ie]==="opening")return new _0(this,e);if(this[Ie]!=="open")throw new Yt("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new v0(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=qo(e,t),e[Ar.keyEncoding]=t,e[Ar.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,this[Ie]==="opening")return new x0(this,e);if(this[Ie]!=="open")throw new Yt("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new m0(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[Zi].push(e)}[Qi](){if(this[Zi].length===0)return;const e=this[Zi];this[Zi]=[];for(const t of e)t()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[Ir].add(e)}detachResource(e){this[Ir].delete(e)}_chainedBatch(){return new Jl(this)}_checkKey(e){if(e==null)return new Yt("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new Yt("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};Wc.prototype.nextTick=h0();const{AbstractSublevel:ec}=p0()({AbstractLevel:Wc});Us.AbstractLevel=Wc;Us.AbstractSublevel=ec;const yi=function(n,e){return n[Ie]!=="open"?(n.nextTick(e,new Yt("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},A0=function(n){return Object.keys(n.supports.encodings).filter(e=>!!n.supports.encodings[e])};gr.AbstractLevel=Us.AbstractLevel;gr.AbstractSublevel=Us.AbstractSublevel;gr.AbstractIterator=En.AbstractIterator;gr.AbstractKeyIterator=En.AbstractKeyIterator;gr.AbstractValueIterator=En.AbstractValueIterator;gr.AbstractChainedBatch=Vc.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var T0=R0;const I0=af;function R0(n,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let r,i,o,s,a,l=!0,u;Array.isArray(n)?(r=[],o=i=n.length):(s=Object.keys(n),r={},o=i=s.length);function c(m){function E(){t&&t(m,r),t=null}l?I0(E):E()}function h(m,E,g){if(r[m]=g,E&&(a=!0),--o===0||E)c(E);else if(!a&&u<i){let S;s?(S=s[u],u+=1,n[S](function(C,B){h(S,C,B)})):(S=u,u+=1,n[S](function(C,B){h(S,C,B)}))}}u=e,o?s?s.some(function(m,E){return n[m](function(g,S){h(m,g,S)}),E===e-1}):n.some(function(m,E){return m(function(g,S){h(E,g,S)}),E===e-1}):c(null),l=!1}var cf={},lf=function(e){const t=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,r=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,i=e.gte===void 0,o=e.lte===void 0;return t!==void 0&&r!==void 0?IDBKeyRange.bound(t,r,i,o):t!==void 0?IDBKeyRange.lowerBound(t,i):r!==void 0?IDBKeyRange.upperBound(r,o):null};const O0=new TextEncoder;var uf=function(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):O0.encode(n)};const{AbstractIterator:B0}=gr,Zl=lf,Yo=uf,nn=Symbol("cache"),In=Symbol("finished"),Tt=Symbol("options"),Rn=Symbol("currentOptions"),Or=Symbol("position"),_a=Symbol("location"),pi=Symbol("first"),Ql={};let L0=class extends B0{constructor(e,t,r){super(e,r),this[nn]=[],this[In]=this.limit===0,this[Tt]=r,this[Rn]={...r},this[Or]=void 0,this[_a]=t,this[pi]=!0}_nextv(e,t,r){if(this[pi]=!1,this[In])return this.nextTick(r,null,[]);if(this[nn].length>0)return e=Math.min(e,this[nn].length),this.nextTick(r,null,this[nn].splice(0,e));this[Or]!==void 0&&(this[Tt].reverse?(this[Rn].lt=this[Or],this[Rn].lte=void 0):(this[Rn].gt=this[Or],this[Rn].gte=void 0));let i;try{i=Zl(this[Rn])}catch{return this[In]=!0,this.nextTick(r,null,[])}const o=this.db.db.transaction([this[_a]],"readonly"),s=o.objectStore(this[_a]),a=[];if(this[Tt].reverse){const l=!this[Tt].values&&s.openKeyCursor?"openKeyCursor":"openCursor";s[l](i,"prev").onsuccess=u=>{const c=u.target.result;if(c){const{key:h,value:m}=c;this[Or]=h,a.push([this[Tt].keys&&h!==void 0?Yo(h):void 0,this[Tt].values&&m!==void 0?Yo(m):void 0]),a.length<e?c.continue():eu(o)}else this[In]=!0}}else{let l,u;const c=()=>{if(l===void 0||u===void 0)return;const h=Math.max(l.length,u.length);h===0||e===1/0?this[In]=!0:this[Or]=l[h-1],a.length=h;for(let m=0;m<h;m++){const E=l[m],g=u[m];a[m]=[this[Tt].keys&&E!==void 0?Yo(E):void 0,this[Tt].values&&g!==void 0?Yo(g):void 0]}eu(o)};this[Tt].keys||e<1/0?s.getAllKeys(i,e<1/0?e:void 0).onsuccess=h=>{l=h.target.result,c()}:(l=[],this.nextTick(c)),this[Tt].values?s.getAll(i,e<1/0?e:void 0).onsuccess=h=>{u=h.target.result,c()}:(u=[],this.nextTick(c))}o.onabort=()=>{r(o.error||new Error("aborted by user")),r=null},o.oncomplete=()=>{r(null,a),r=null}}_next(e){if(this[nn].length>0){const[t,r]=this[nn].shift();this.nextTick(e,null,t,r)}else if(this[In])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[pi]&&(this[pi]=!1,t=1),this._nextv(t,Ql,(r,i)=>{if(r)return e(r);this[nn]=i,this._next(e)})}}_all(e,t){this[pi]=!1;const r=this[nn].splice(0,this[nn].length),i=this.limit-this.count-r.length;if(i<=0)return this.nextTick(t,null,r);this._nextv(i,Ql,(o,s)=>{if(o)return t(o);r.length>0&&(s=r.concat(s)),t(null,s)})}_seek(e,t){this[pi]=!0,this[nn]=[],this[In]=!1,this[Or]=void 0,this[Rn]={...this[Tt]};let r;try{r=Zl(this[Tt])}catch{this[In]=!0;return}r!==null&&!r.includes(e)?this[In]=!0:this[Tt].reverse?this[Rn].lte=e:this[Rn].gte=e}};cf.Iterator=L0;function eu(n){typeof n.commit=="function"&&n.commit()}var k0=function(e,t,r,i,o){if(i.limit===0)return e.nextTick(o);const s=e.db.transaction([t],"readwrite"),a=s.objectStore(t);let l=0;s.oncomplete=function(){o()},s.onabort=function(){o(s.error||new Error("aborted by user"))};const u=a.openKeyCursor?"openKeyCursor":"openCursor",c=i.reverse?"prev":"next";a[u](r,c).onsuccess=function(h){const m=h.target.result;m&&(a.delete(m.key).onsuccess=function(){(i.limit<=0||++l<i.limit)&&m.continue()})}};const{AbstractLevel:C0}=gr,tu=mn,U0=T0,{fromCallback:$0}=Ci,{Iterator:N0}=cf,nu=uf,D0=k0,P0=lf,df="level-js-",eo=Symbol("idb"),xa=Symbol("namePrefix"),On=Symbol("location"),Sa=Symbol("version"),Br=Symbol("store"),to=Symbol("onComplete"),ru=Symbol("promise");class K0 extends C0{constructor(e,t,r){if(typeof t=="function"||typeof r=="function")throw new tu("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:i,version:o,...s}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),typeof e!="string")throw new Error("constructor requires a location string argument");this[On]=e,this[xa]=i??df,this[Sa]=parseInt(o||1,10),this[eo]=null}get location(){return this[On]}get namePrefix(){return this[xa]}get version(){return this[Sa]}get db(){return this[eo]}get type(){return"browser-level"}_open(e,t){const r=indexedDB.open(this[xa]+this[On],this[Sa]);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[eo]=r.result,t()},r.onupgradeneeded=i=>{const o=i.target.result;o.objectStoreNames.contains(this[On])||o.createObjectStore(this[On])}}[Br](e){return this[eo].transaction([this[On]],e).objectStore(this[On])}[to](e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}}_get(e,t,r){const i=this[Br]("readonly");let o;try{o=i.get(e)}catch(s){return this.nextTick(r,s)}this[to](o,function(s,a){if(s)return r(s);if(a===void 0)return r(new tu("Entry not found",{code:"LEVEL_NOT_FOUND"}));r(null,nu(a))})}_getMany(e,t,r){const i=this[Br]("readonly"),o=e.map(s=>a=>{let l;try{l=i.get(s)}catch(u){return a(u)}l.onsuccess=()=>{const u=l.result;a(null,u===void 0?u:nu(u))},l.onerror=u=>{u.stopPropagation(),a(l.error)}});U0(o,16,r)}_del(e,t,r){const i=this[Br]("readwrite");let o;try{o=i.delete(e)}catch(s){return this.nextTick(r,s)}this[to](o,r)}_put(e,t,r,i){const o=this[Br]("readwrite");let s;try{s=o.put(t,e)}catch(a){return this.nextTick(i,a)}this[to](s,i)}_iterator(e){return new N0(this,this[On],e)}_batch(e,t,r){const i=this[Br]("readwrite"),o=i.transaction;let s=0,a;o.onabort=function(){r(a||o.error||new Error("aborted by user"))},o.oncomplete=function(){r()};function l(){const u=e[s++],c=u.key;let h;try{h=u.type==="del"?i.delete(c):i.put(u.value,c)}catch(m){a=m,o.abort();return}s<e.length?h.onsuccess=l:typeof o.commit=="function"&&o.commit()}l()}_clear(e,t){let r,i;try{r=P0(e)}catch{return this.nextTick(t)}if(e.limit>=0)return D0(this,this[On],r,e,t);try{const o=this[Br]("readwrite");i=r?o.delete(r):o.clear()}catch(o){return this.nextTick(t,o)}this[to](i,t)}_close(e){this[eo].close(),this.nextTick(e)}}K0.destroy=function(n,e,t){typeof e=="function"&&(t=e,e=df),t=$0(t,ru);const r=indexedDB.deleteDatabase(e+n);return r.onsuccess=function(){t()},r.onerror=function(i){t(i)},t[ru]};var Lr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class M0{constructor(){this.store=new Map}clear(){return Lr(this,void 0,void 0,function*(){this.store.clear()})}close(){return Lr(this,void 0,void 0,function*(){})}delete(e){return Lr(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return Lr(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return Lr(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return Lr(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,t){return Lr(this,void 0,void 0,function*(){this.store.set(e,t)})}}var F0={exports:{}},Aa={exports:{}},ot={ArrayIsArray(n){return Array.isArray(n)},ArrayPrototypeIncludes(n,e){return n.includes(e)},ArrayPrototypeIndexOf(n,e){return n.indexOf(e)},ArrayPrototypeJoin(n,e){return n.join(e)},ArrayPrototypeMap(n,e){return n.map(e)},ArrayPrototypePop(n,e){return n.pop(e)},ArrayPrototypePush(n,e){return n.push(e)},ArrayPrototypeSlice(n,e,t){return n.slice(e,t)},Error,FunctionPrototypeCall(n,e,...t){return n.call(e,...t)},FunctionPrototypeSymbolHasInstance(n,e){return Function.prototype[Symbol.hasInstance].call(n,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(n,e){return Object.defineProperties(n,e)},ObjectDefineProperty(n,e,t){return Object.defineProperty(n,e,t)},ObjectGetOwnPropertyDescriptor(n,e){return Object.getOwnPropertyDescriptor(n,e)},ObjectKeys(n){return Object.keys(n)},ObjectSetPrototypeOf(n,e){return Object.setPrototypeOf(n,e)},Promise,PromisePrototypeCatch(n,e){return n.catch(e)},PromisePrototypeThen(n,e,t){return n.then(e,t)},PromiseReject(n){return Promise.reject(n)},ReflectApply:Reflect.apply,RegExpPrototypeTest(n,e){return n.test(e)},SafeSet:Set,String,StringPrototypeSlice(n,e,t){return n.slice(e,t)},StringPrototypeToLowerCase(n){return n.toLowerCase()},StringPrototypeToUpperCase(n){return n.toUpperCase()},StringPrototypeTrim(n){return n.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(n,e,t){return n.set(e,t)},Uint8Array},ff={exports:{}};(function(n){const e=Wt,t=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||e.Blob,i=typeof r<"u"?function(a){return a instanceof r}:function(a){return!1};class o extends Error{constructor(a){if(!Array.isArray(a))throw new TypeError(`Expected input to be an Array, got ${typeof a}`);let l="";for(let u=0;u<a.length;u++)l+=`    ${a[u].stack}
`;super(l),this.name="AggregateError",this.errors=a}}n.exports={AggregateError:o,kEmptyObject:Object.freeze({}),once(s){let a=!1;return function(...l){a||(a=!0,s.apply(this,l))}},createDeferredPromise:function(){let s,a;return{promise:new Promise((u,c)=>{s=u,a=c}),resolve:s,reject:a}},promisify(s){return new Promise((a,l)=>{s((u,...c)=>u?l(u):a(...c))})},debuglog(){return function(){}},format(s,...a){return s.replace(/%([sdifj])/g,function(...[l,u]){const c=a.shift();return u==="f"?c.toFixed(6):u==="j"?JSON.stringify(c):u==="s"&&typeof c=="object"?`${c.constructor!==Object?c.constructor.name:""} {}`.trim():c.toString()})},inspect(s){switch(typeof s){case"string":if(s.includes("'"))if(s.includes('"')){if(!s.includes("`")&&!s.includes("${"))return`\`${s}\``}else return`"${s}"`;return`'${s}'`;case"number":return isNaN(s)?"NaN":Object.is(s,-0)?String(s):s;case"bigint":return`${String(s)}n`;case"boolean":case"undefined":return String(s);case"object":return"{}"}},types:{isAsyncFunction(s){return s instanceof t},isArrayBufferView(s){return ArrayBuffer.isView(s)}},isBlob:i},n.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(ff);var Wn=ff.exports,qc={},no={exports:{}},iu;function zc(){if(iu)return no.exports;iu=1;const{AbortController:n,AbortSignal:e}=typeof self<"u"?self:typeof window<"u"?window:void 0;return no.exports=n,no.exports.AbortSignal=e,no.exports.default=n,no.exports}const{format:j0,inspect:Is,AggregateError:H0}=Wn,V0=globalThis.AggregateError||H0,W0=Symbol("kIsNodeError"),q0=["string","function","number","object","Function","Object","boolean","bigint","symbol"],z0=/^([A-Z][a-z0-9]*)+$/,G0="__node_internal_",js={};function Hr(n,e){if(!n)throw new js.ERR_INTERNAL_ASSERTION(e)}function ou(n){let e="",t=n.length;const r=n[0]==="-"?1:0;for(;t>=r+4;t-=3)e=`_${n.slice(t-3,t)}${e}`;return`${n.slice(0,t)}${e}`}function Y0(n,e,t){if(typeof e=="function")return Hr(e.length<=t.length,`Code: ${n}; The provided arguments length (${t.length}) does not match the required ones (${e.length}).`),e(...t);const r=(e.match(/%[dfijoOs]/g)||[]).length;return Hr(r===t.length,`Code: ${n}; The provided arguments length (${t.length}) does not match the required ones (${r}).`),t.length===0?e:j0(e,...t)}function pt(n,e,t){t||(t=Error);class r extends t{constructor(...o){super(Y0(n,e,o))}toString(){return`${this.name} [${n}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:t.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${n}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=n,r.prototype[W0]=!0,js[n]=r}function su(n){const e=G0+n.name;return Object.defineProperty(n,"name",{value:e}),n}function J0(n,e){if(n&&e&&n!==e){if(Array.isArray(e.errors))return e.errors.push(n),e;const t=new V0([e,n],e.message);return t.code=e.code,t}return n||e}let X0=class extends Error{constructor(e="The operation was aborted",t=void 0){if(t!==void 0&&typeof t!="object")throw new js.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};pt("ERR_ASSERTION","%s",Error);pt("ERR_INVALID_ARG_TYPE",(n,e,t)=>{Hr(typeof n=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let r="The ";n.endsWith(" argument")?r+=`${n} `:r+=`"${n}" ${n.includes(".")?"property":"argument"} `,r+="must be ";const i=[],o=[],s=[];for(const l of e)Hr(typeof l=="string","All expected entries have to be of type string"),q0.includes(l)?i.push(l.toLowerCase()):z0.test(l)?o.push(l):(Hr(l!=="object",'The value "object" should be written as "Object"'),s.push(l));if(o.length>0){const l=i.indexOf("object");l!==-1&&(i.splice(i,l,1),o.push("Object"))}if(i.length>0){switch(i.length){case 1:r+=`of type ${i[0]}`;break;case 2:r+=`one of type ${i[0]} or ${i[1]}`;break;default:{const l=i.pop();r+=`one of type ${i.join(", ")}, or ${l}`}}(o.length>0||s.length>0)&&(r+=" or ")}if(o.length>0){switch(o.length){case 1:r+=`an instance of ${o[0]}`;break;case 2:r+=`an instance of ${o[0]} or ${o[1]}`;break;default:{const l=o.pop();r+=`an instance of ${o.join(", ")}, or ${l}`}}s.length>0&&(r+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(r+="an "),r+=`${s[0]}`;break;case 2:r+=`one of ${s[0]} or ${s[1]}`;break;default:{const l=s.pop();r+=`one of ${s.join(", ")}, or ${l}`}}if(t==null)r+=`. Received ${t}`;else if(typeof t=="function"&&t.name)r+=`. Received function ${t.name}`;else if(typeof t=="object"){var a;if((a=t.constructor)!==null&&a!==void 0&&a.name)r+=`. Received an instance of ${t.constructor.name}`;else{const l=Is(t,{depth:-1});r+=`. Received ${l}`}}else{let l=Is(t,{colors:!1});l.length>25&&(l=`${l.slice(0,25)}...`),r+=`. Received type ${typeof t} (${l})`}return r},TypeError);pt("ERR_INVALID_ARG_VALUE",(n,e,t="is invalid")=>{let r=Is(e);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${n.includes(".")?"property":"argument"} '${n}' ${t}. Received ${r}`},TypeError);pt("ERR_INVALID_RETURN_VALUE",(n,e,t)=>{var r;const i=t!=null&&(r=t.constructor)!==null&&r!==void 0&&r.name?`instance of ${t.constructor.name}`:`type ${typeof t}`;return`Expected ${n} to be returned from the "${e}" function but got ${i}.`},TypeError);pt("ERR_MISSING_ARGS",(...n)=>{Hr(n.length>0,"At least one arg needs to be specified");let e;const t=n.length;switch(n=(Array.isArray(n)?n:[n]).map(r=>`"${r}"`).join(" or "),t){case 1:e+=`The ${n[0]} argument`;break;case 2:e+=`The ${n[0]} and ${n[1]} arguments`;break;default:{const r=n.pop();e+=`The ${n.join(", ")}, and ${r} arguments`}break}return`${e} must be specified`},TypeError);pt("ERR_OUT_OF_RANGE",(n,e,t)=>{Hr(e,'Missing "range" argument');let r;return Number.isInteger(t)&&Math.abs(t)>2**32?r=ou(String(t)):typeof t=="bigint"?(r=String(t),(t>2n**32n||t<-(2n**32n))&&(r=ou(r)),r+="n"):r=Is(t),`The value of "${n}" is out of range. It must be ${e}. Received ${r}`},RangeError);pt("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);pt("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);pt("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);pt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);pt("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);pt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);pt("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);pt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);pt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);pt("ERR_STREAM_WRITE_AFTER_END","write after end",Error);pt("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var St={AbortError:X0,aggregateTwoErrors:su(J0),hideStackFrames:su,codes:js};const{ArrayIsArray:Gc,ArrayPrototypeIncludes:hf,ArrayPrototypeJoin:yf,ArrayPrototypeMap:Z0,NumberIsInteger:Yc,NumberIsNaN:Q0,NumberMAX_SAFE_INTEGER:eg,NumberMIN_SAFE_INTEGER:tg,NumberParseInt:ng,ObjectPrototypeHasOwnProperty:rg,RegExpPrototypeExec:pf,String:ig,StringPrototypeToUpperCase:og,StringPrototypeTrim:sg}=ot,{hideStackFrames:qt,codes:{ERR_SOCKET_BAD_PORT:ag,ERR_INVALID_ARG_TYPE:mt,ERR_INVALID_ARG_VALUE:Ui,ERR_OUT_OF_RANGE:Gr,ERR_UNKNOWN_SIGNAL:au}}=St,{normalizeEncoding:cg}=Wn,{isAsyncFunction:lg,isArrayBufferView:ug}=Wn.types,cu={};function dg(n){return n===(n|0)}function fg(n){return n===n>>>0}const hg=/^[0-7]+$/,yg="must be a 32-bit unsigned integer or an octal string";function pg(n,e,t){if(typeof n>"u"&&(n=t),typeof n=="string"){if(pf(hg,n)===null)throw new Ui(e,n,yg);n=ng(n,8)}return gf(n,e),n}const gg=qt((n,e,t=tg,r=eg)=>{if(typeof n!="number")throw new mt(e,"number",n);if(!Yc(n))throw new Gr(e,"an integer",n);if(n<t||n>r)throw new Gr(e,`>= ${t} && <= ${r}`,n)}),wg=qt((n,e,t=-2147483648,r=2147483647)=>{if(typeof n!="number")throw new mt(e,"number",n);if(!Yc(n))throw new Gr(e,"an integer",n);if(n<t||n>r)throw new Gr(e,`>= ${t} && <= ${r}`,n)}),gf=qt((n,e,t=!1)=>{if(typeof n!="number")throw new mt(e,"number",n);if(!Yc(n))throw new Gr(e,"an integer",n);const r=t?1:0,i=4294967295;if(n<r||n>i)throw new Gr(e,`>= ${r} && <= ${i}`,n)});function Jc(n,e){if(typeof n!="string")throw new mt(e,"string",n)}function bg(n,e,t=void 0,r){if(typeof n!="number")throw new mt(e,"number",n);if(t!=null&&n<t||r!=null&&n>r||(t!=null||r!=null)&&Q0(n))throw new Gr(e,`${t!=null?`>= ${t}`:""}${t!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,n)}const vg=qt((n,e,t)=>{if(!hf(t,n)){const i="must be one of: "+yf(Z0(t,o=>typeof o=="string"?`'${o}'`:ig(o)),", ");throw new Ui(e,n,i)}});function wf(n,e){if(typeof n!="boolean")throw new mt(e,"boolean",n)}function Ta(n,e,t){return n==null||!rg(n,e)?t:n[e]}const mg=qt((n,e,t=null)=>{const r=Ta(t,"allowArray",!1),i=Ta(t,"allowFunction",!1);if(!Ta(t,"nullable",!1)&&n===null||!r&&Gc(n)||typeof n!="object"&&(!i||typeof n!="function"))throw new mt(e,"Object",n)}),Eg=qt((n,e)=>{if(n!=null&&typeof n!="object"&&typeof n!="function")throw new mt(e,"a dictionary",n)}),Xc=qt((n,e,t=0)=>{if(!Gc(n))throw new mt(e,"Array",n);if(n.length<t){const r=`must be longer than ${t}`;throw new Ui(e,n,r)}});function _g(n,e){Xc(n,e);for(let t=0;t<n.length;t++)Jc(n[t],`${e}[${t}]`)}function xg(n,e){Xc(n,e);for(let t=0;t<n.length;t++)wf(n[t],`${e}[${t}]`)}function Sg(n,e="signal"){if(Jc(n,e),cu[n]===void 0)throw cu[og(n)]!==void 0?new au(n+" (signals must use all capital letters)"):new au(n)}const Ag=qt((n,e="buffer")=>{if(!ug(n))throw new mt(e,["Buffer","TypedArray","DataView"],n)});function Tg(n,e){const t=cg(e),r=n.length;if(t==="hex"&&r%2!==0)throw new Ui("encoding",e,`is invalid for data of length ${r}`)}function Ig(n,e="Port",t=!0){if(typeof n!="number"&&typeof n!="string"||typeof n=="string"&&sg(n).length===0||+n!==+n>>>0||n>65535||n===0&&!t)throw new ag(e,n,t);return n|0}const Rg=qt((n,e)=>{if(n!==void 0&&(n===null||typeof n!="object"||!("aborted"in n)))throw new mt(e,"AbortSignal",n)}),Og=qt((n,e)=>{if(typeof n!="function")throw new mt(e,"Function",n)}),Bg=qt((n,e)=>{if(typeof n!="function"||lg(n))throw new mt(e,"Function",n)}),Lg=qt((n,e)=>{if(n!==void 0)throw new mt(e,"undefined",n)});function kg(n,e,t){if(!hf(t,n))throw new mt(e,`('${yf(t,"|")}')`,n)}const Cg=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function lu(n,e){if(typeof n>"u"||!pf(Cg,n))throw new Ui(e,n,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function Ug(n){if(typeof n=="string")return lu(n,"hints"),n;if(Gc(n)){const e=n.length;let t="";if(e===0)return t;for(let r=0;r<e;r++){const i=n[r];lu(i,"hints"),t+=i,r!==e-1&&(t+=", ")}return t}throw new Ui("hints",n,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var Hs={isInt32:dg,isUint32:fg,parseFileMode:pg,validateArray:Xc,validateStringArray:_g,validateBooleanArray:xg,validateBoolean:wf,validateBuffer:Ag,validateDictionary:Eg,validateEncoding:Tg,validateFunction:Og,validateInt32:wg,validateInteger:gg,validateNumber:bg,validateObject:mg,validateOneOf:vg,validatePlainFunction:Bg,validatePort:Ig,validateSignalName:Sg,validateString:Jc,validateUint32:gf,validateUndefined:Lg,validateUnion:kg,validateAbortSignal:Rg,validateLinkHeaderValue:Ug},Zc={exports:{}},bf={exports:{}},et=bf.exports={},an,cn;function tc(){throw new Error("setTimeout has not been defined")}function nc(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?an=setTimeout:an=tc}catch{an=tc}try{typeof clearTimeout=="function"?cn=clearTimeout:cn=nc}catch{cn=nc}})();function vf(n){if(an===setTimeout)return setTimeout(n,0);if((an===tc||!an)&&setTimeout)return an=setTimeout,setTimeout(n,0);try{return an(n,0)}catch{try{return an.call(null,n,0)}catch{return an.call(this,n,0)}}}function $g(n){if(cn===clearTimeout)return clearTimeout(n);if((cn===nc||!cn)&&clearTimeout)return cn=clearTimeout,clearTimeout(n);try{return cn(n)}catch{try{return cn.call(null,n)}catch{return cn.call(this,n)}}}var Mn=[],Ai=!1,Kr,us=-1;function Ng(){!Ai||!Kr||(Ai=!1,Kr.length?Mn=Kr.concat(Mn):us=-1,Mn.length&&mf())}function mf(){if(!Ai){var n=vf(Ng);Ai=!0;for(var e=Mn.length;e;){for(Kr=Mn,Mn=[];++us<e;)Kr&&Kr[us].run();us=-1,e=Mn.length}Kr=null,Ai=!1,$g(n)}}et.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Mn.push(new Ef(n,e)),Mn.length===1&&!Ai&&vf(mf)};function Ef(n,e){this.fun=n,this.array=e}Ef.prototype.run=function(){this.fun.apply(null,this.array)};et.title="browser";et.browser=!0;et.env={};et.argv=[];et.version="";et.versions={};function qn(){}et.on=qn;et.addListener=qn;et.once=qn;et.off=qn;et.removeListener=qn;et.removeAllListeners=qn;et.emit=qn;et.prependListener=qn;et.prependOnceListener=qn;et.listeners=function(n){return[]};et.binding=function(n){throw new Error("process.binding is not supported")};et.cwd=function(){return"/"};et.chdir=function(n){throw new Error("process.chdir is not supported")};et.umask=function(){return 0};var ni=bf.exports;const{Symbol:Vs,SymbolAsyncIterator:uu,SymbolIterator:du,SymbolFor:_f}=ot,xf=Vs("kDestroyed"),Sf=Vs("kIsErrored"),rc=Vs("kIsReadable"),Af=Vs("kIsDisturbed"),Dg=_f("nodejs.webstream.isClosedPromise"),Pg=_f("nodejs.webstream.controllerErrorFunction");function Ws(n,e=!1){var t;return!!(n&&typeof n.pipe=="function"&&typeof n.on=="function"&&(!e||typeof n.pause=="function"&&typeof n.resume=="function")&&(!n._writableState||((t=n._readableState)===null||t===void 0?void 0:t.readable)!==!1)&&(!n._writableState||n._readableState))}function qs(n){var e;return!!(n&&typeof n.write=="function"&&typeof n.on=="function"&&(!n._readableState||((e=n._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function Kg(n){return!!(n&&typeof n.pipe=="function"&&n._readableState&&typeof n.on=="function"&&typeof n.write=="function")}function _n(n){return n&&(n._readableState||n._writableState||typeof n.write=="function"&&typeof n.on=="function"||typeof n.pipe=="function"&&typeof n.on=="function")}function Tf(n){return!!(n&&!_n(n)&&typeof n.pipeThrough=="function"&&typeof n.getReader=="function"&&typeof n.cancel=="function")}function If(n){return!!(n&&!_n(n)&&typeof n.getWriter=="function"&&typeof n.abort=="function")}function Rf(n){return!!(n&&!_n(n)&&typeof n.readable=="object"&&typeof n.writable=="object")}function Mg(n){return Tf(n)||If(n)||Rf(n)}function Fg(n,e){return n==null?!1:e===!0?typeof n[uu]=="function":e===!1?typeof n[du]=="function":typeof n[uu]=="function"||typeof n[du]=="function"}function zs(n){if(!_n(n))return null;const e=n._writableState,t=n._readableState,r=e||t;return!!(n.destroyed||n[xf]||r!=null&&r.destroyed)}function Of(n){if(!qs(n))return null;if(n.writableEnded===!0)return!0;const e=n._writableState;return e!=null&&e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function jg(n,e){if(!qs(n))return null;if(n.writableFinished===!0)return!0;const t=n._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.finished)!="boolean"?null:!!(t.finished||e===!1&&t.ended===!0&&t.length===0)}function Hg(n){if(!Ws(n))return null;if(n.readableEnded===!0)return!0;const e=n._readableState;return!e||e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function Bf(n,e){if(!Ws(n))return null;const t=n._readableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.endEmitted)!="boolean"?null:!!(t.endEmitted||e===!1&&t.ended===!0&&t.length===0)}function Lf(n){return n&&n[rc]!=null?n[rc]:typeof(n==null?void 0:n.readable)!="boolean"?null:zs(n)?!1:Ws(n)&&n.readable&&!Bf(n)}function kf(n){return typeof(n==null?void 0:n.writable)!="boolean"?null:zs(n)?!1:qs(n)&&n.writable&&!Of(n)}function Vg(n,e){return _n(n)?zs(n)?!0:!((e==null?void 0:e.readable)!==!1&&Lf(n)||(e==null?void 0:e.writable)!==!1&&kf(n)):null}function Wg(n){var e,t;return _n(n)?n.writableErrored?n.writableErrored:(e=(t=n._writableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function qg(n){var e,t;return _n(n)?n.readableErrored?n.readableErrored:(e=(t=n._readableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function zg(n){if(!_n(n))return null;if(typeof n.closed=="boolean")return n.closed;const e=n._writableState,t=n._readableState;return typeof(e==null?void 0:e.closed)=="boolean"||typeof(t==null?void 0:t.closed)=="boolean"?(e==null?void 0:e.closed)||(t==null?void 0:t.closed):typeof n._closed=="boolean"&&Cf(n)?n._closed:null}function Cf(n){return typeof n._closed=="boolean"&&typeof n._defaultKeepAlive=="boolean"&&typeof n._removedConnection=="boolean"&&typeof n._removedContLen=="boolean"}function Uf(n){return typeof n._sent100=="boolean"&&Cf(n)}function Gg(n){var e;return typeof n._consuming=="boolean"&&typeof n._dumped=="boolean"&&((e=n.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function Yg(n){if(!_n(n))return null;const e=n._writableState,t=n._readableState,r=e||t;return!r&&Uf(n)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function Jg(n){var e;return!!(n&&((e=n[Af])!==null&&e!==void 0?e:n.readableDidRead||n.readableAborted))}function Xg(n){var e,t,r,i,o,s,a,l,u,c;return!!(n&&((e=(t=(r=(i=(o=(s=n[Sf])!==null&&s!==void 0?s:n.readableErrored)!==null&&o!==void 0?o:n.writableErrored)!==null&&i!==void 0?i:(a=n._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&r!==void 0?r:(l=n._writableState)===null||l===void 0?void 0:l.errorEmitted)!==null&&t!==void 0?t:(u=n._readableState)===null||u===void 0?void 0:u.errored)!==null&&e!==void 0?e:!((c=n._writableState)===null||c===void 0)&&c.errored))}var zn={kDestroyed:xf,isDisturbed:Jg,kIsDisturbed:Af,isErrored:Xg,kIsErrored:Sf,isReadable:Lf,kIsReadable:rc,kIsClosedPromise:Dg,kControllerErrorFunction:Pg,isClosed:zg,isDestroyed:zs,isDuplexNodeStream:Kg,isFinished:Vg,isIterable:Fg,isReadableNodeStream:Ws,isReadableStream:Tf,isReadableEnded:Hg,isReadableFinished:Bf,isReadableErrored:qg,isNodeStream:_n,isWebStream:Mg,isWritable:kf,isWritableNodeStream:qs,isWritableStream:If,isWritableEnded:Of,isWritableFinished:jg,isWritableErrored:Wg,isServerRequest:Gg,isServerResponse:Uf,willEmitClose:Yg,isTransformStream:Rf};const or=ni,{AbortError:$f,codes:Zg}=St,{ERR_INVALID_ARG_TYPE:Qg,ERR_STREAM_PREMATURE_CLOSE:fu}=Zg,{kEmptyObject:ic,once:oc}=Wn,{validateAbortSignal:ew,validateFunction:tw,validateObject:nw,validateBoolean:rw}=Hs,{Promise:iw,PromisePrototypeThen:ow}=ot,{isClosed:sw,isReadable:hu,isReadableNodeStream:Ia,isReadableStream:aw,isReadableFinished:yu,isReadableErrored:pu,isWritable:gu,isWritableNodeStream:wu,isWritableStream:cw,isWritableFinished:bu,isWritableErrored:vu,isNodeStream:lw,willEmitClose:uw,kIsClosedPromise:dw}=zn;function fw(n){return n.setHeader&&typeof n.abort=="function"}const sc=()=>{};function Nf(n,e,t){var r,i;if(arguments.length===2?(t=e,e=ic):e==null?e=ic:nw(e,"options"),tw(t,"callback"),ew(e.signal,"options.signal"),t=oc(t),aw(n)||cw(n))return hw(n,e,t);if(!lw(n))throw new Qg("stream",["ReadableStream","WritableStream","Stream"],n);const o=(r=e.readable)!==null&&r!==void 0?r:Ia(n),s=(i=e.writable)!==null&&i!==void 0?i:wu(n),a=n._writableState,l=n._readableState,u=()=>{n.writable||m()};let c=uw(n)&&Ia(n)===o&&wu(n)===s,h=bu(n,!1);const m=()=>{h=!0,n.destroyed&&(c=!1),!(c&&(!n.readable||o))&&(!o||E)&&t.call(n)};let E=yu(n,!1);const g=()=>{E=!0,n.destroyed&&(c=!1),!(c&&(!n.writable||s))&&(!s||h)&&t.call(n)},S=x=>{t.call(n,x)};let C=sw(n);const B=()=>{C=!0;const x=vu(n)||pu(n);if(x&&typeof x!="boolean")return t.call(n,x);if(o&&!E&&Ia(n,!0)&&!yu(n,!1))return t.call(n,new fu);if(s&&!h&&!bu(n,!1))return t.call(n,new fu);t.call(n)},A=()=>{C=!0;const x=vu(n)||pu(n);if(x&&typeof x!="boolean")return t.call(n,x);t.call(n)},O=()=>{n.req.on("finish",m)};fw(n)?(n.on("complete",m),c||n.on("abort",B),n.req?O():n.on("request",O)):s&&!a&&(n.on("end",u),n.on("close",u)),!c&&typeof n.aborted=="boolean"&&n.on("aborted",B),n.on("end",g),n.on("finish",m),e.error!==!1&&n.on("error",S),n.on("close",B),C?or.nextTick(B):a!=null&&a.errorEmitted||l!=null&&l.errorEmitted?c||or.nextTick(A):(!o&&(!c||hu(n))&&(h||gu(n)===!1)||!s&&(!c||gu(n))&&(E||hu(n)===!1)||l&&n.req&&n.aborted)&&or.nextTick(A);const I=()=>{t=sc,n.removeListener("aborted",B),n.removeListener("complete",m),n.removeListener("abort",B),n.removeListener("request",O),n.req&&n.req.removeListener("finish",m),n.removeListener("end",u),n.removeListener("close",u),n.removeListener("finish",m),n.removeListener("end",g),n.removeListener("error",S),n.removeListener("close",B)};if(e.signal&&!C){const x=()=>{const D=t;I(),D.call(n,new $f(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)or.nextTick(x);else{const D=t;t=oc((...H)=>{e.signal.removeEventListener("abort",x),D.apply(n,H)}),e.signal.addEventListener("abort",x)}}return I}function hw(n,e,t){let r=!1,i=sc;if(e.signal)if(i=()=>{r=!0,t.call(n,new $f(void 0,{cause:e.signal.reason}))},e.signal.aborted)or.nextTick(i);else{const s=t;t=oc((...a)=>{e.signal.removeEventListener("abort",i),s.apply(n,a)}),e.signal.addEventListener("abort",i)}const o=(...s)=>{r||or.nextTick(()=>t.apply(n,s))};return ow(n[dw].promise,o,o),sc}function yw(n,e){var t;let r=!1;return e===null&&(e=ic),(t=e)!==null&&t!==void 0&&t.cleanup&&(rw(e.cleanup,"cleanup"),r=e.cleanup),new iw((i,o)=>{const s=Nf(n,e,a=>{r&&s(),a?o(a):i()})})}Zc.exports=Nf;Zc.exports.finished=yw;var wr=Zc.exports;const hn=ni,{aggregateTwoErrors:pw,codes:{ERR_MULTIPLE_CALLBACK:gw},AbortError:ww}=St,{Symbol:Df}=ot,{kDestroyed:bw,isDestroyed:vw,isFinished:mw,isServerRequest:Ew}=zn,Pf=Df("kDestroy"),ac=Df("kConstruct");function Kf(n,e,t){n&&(n.stack,e&&!e.errored&&(e.errored=n),t&&!t.errored&&(t.errored=n))}function _w(n,e){const t=this._readableState,r=this._writableState,i=r||t;return r!=null&&r.destroyed||t!=null&&t.destroyed?(typeof e=="function"&&e(),this):(Kf(n,r,t),r&&(r.destroyed=!0),t&&(t.destroyed=!0),i.constructed?mu(this,n,e):this.once(Pf,function(o){mu(this,pw(o,n),e)}),this)}function mu(n,e,t){let r=!1;function i(o){if(r)return;r=!0;const s=n._readableState,a=n._writableState;Kf(o,a,s),a&&(a.closed=!0),s&&(s.closed=!0),typeof t=="function"&&t(o),o?hn.nextTick(xw,n,o):hn.nextTick(Mf,n)}try{n._destroy(e||null,i)}catch(o){i(o)}}function xw(n,e){cc(n,e),Mf(n)}function Mf(n){const e=n._readableState,t=n._writableState;t&&(t.closeEmitted=!0),e&&(e.closeEmitted=!0),(t!=null&&t.emitClose||e!=null&&e.emitClose)&&n.emit("close")}function cc(n,e){const t=n._readableState,r=n._writableState;r!=null&&r.errorEmitted||t!=null&&t.errorEmitted||(r&&(r.errorEmitted=!0),t&&(t.errorEmitted=!0),n.emit("error",e))}function Sw(){const n=this._readableState,e=this._writableState;n&&(n.constructed=!0,n.closed=!1,n.closeEmitted=!1,n.destroyed=!1,n.errored=null,n.errorEmitted=!1,n.reading=!1,n.ended=n.readable===!1,n.endEmitted=n.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function lc(n,e,t){const r=n._readableState,i=n._writableState;if(i!=null&&i.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||i!=null&&i.autoDestroy?n.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),r&&!r.errored&&(r.errored=e),t?hn.nextTick(cc,n,e):cc(n,e))}function Aw(n,e){if(typeof n._construct!="function")return;const t=n._readableState,r=n._writableState;t&&(t.constructed=!1),r&&(r.constructed=!1),n.once(ac,e),!(n.listenerCount(ac)>1)&&hn.nextTick(Tw,n)}function Tw(n){let e=!1;function t(r){if(e){lc(n,r??new gw);return}e=!0;const i=n._readableState,o=n._writableState,s=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),s.destroyed?n.emit(Pf,r):r?lc(n,r,!0):hn.nextTick(Iw,n)}try{n._construct(r=>{hn.nextTick(t,r)})}catch(r){hn.nextTick(t,r)}}function Iw(n){n.emit(ac)}function Eu(n){return(n==null?void 0:n.setHeader)&&typeof n.abort=="function"}function Ff(n){n.emit("close")}function Rw(n,e){n.emit("error",e),hn.nextTick(Ff,n)}function Ow(n,e){!n||vw(n)||(!e&&!mw(n)&&(e=new ww),Ew(n)?(n.socket=null,n.destroy(e)):Eu(n)?n.abort():Eu(n.req)?n.req.abort():typeof n.destroy=="function"?n.destroy(e):typeof n.close=="function"?n.close():e?hn.nextTick(Rw,n,e):hn.nextTick(Ff,n),n.destroyed||(n[bw]=!0))}var $i={construct:Aw,destroyer:Ow,destroy:_w,undestroy:Sw,errorOrDestroy:lc};const{ArrayIsArray:Bw,ObjectSetPrototypeOf:jf}=ot,{EventEmitter:Gs}=Ds;function Ys(n){Gs.call(this,n)}jf(Ys.prototype,Gs.prototype);jf(Ys,Gs);Ys.prototype.pipe=function(n,e){const t=this;function r(c){n.writable&&n.write(c)===!1&&t.pause&&t.pause()}t.on("data",r);function i(){t.readable&&t.resume&&t.resume()}n.on("drain",i),!n._isStdio&&(!e||e.end!==!1)&&(t.on("end",s),t.on("close",a));let o=!1;function s(){o||(o=!0,n.end())}function a(){o||(o=!0,typeof n.destroy=="function"&&n.destroy())}function l(c){u(),Gs.listenerCount(this,"error")===0&&this.emit("error",c)}uc(t,"error",l),uc(n,"error",l);function u(){t.removeListener("data",r),n.removeListener("drain",i),t.removeListener("end",s),t.removeListener("close",a),t.removeListener("error",l),n.removeListener("error",l),t.removeListener("end",u),t.removeListener("close",u),n.removeListener("close",u)}return t.on("end",u),t.on("close",u),n.on("close",u),n.emit("pipe",t),n};function uc(n,e,t){if(typeof n.prependListener=="function")return n.prependListener(e,t);!n._events||!n._events[e]?n.on(e,t):Bw(n._events[e])?n._events[e].unshift(t):n._events[e]=[t,n._events[e]]}var Qc={Stream:Ys,prependListener:uc},Hf={exports:{}};(function(n){const{AbortError:e,codes:t}=St,{isNodeStream:r,isWebStream:i,kControllerErrorFunction:o}=zn,s=wr,{ERR_INVALID_ARG_TYPE:a}=t,l=(u,c)=>{if(typeof u!="object"||!("aborted"in u))throw new a(c,"AbortSignal",u)};n.exports.addAbortSignal=function(c,h){if(l(c,"signal"),!r(h)&&!i(h))throw new a("stream",["ReadableStream","WritableStream","Stream"],h);return n.exports.addAbortSignalNoValidate(c,h)},n.exports.addAbortSignalNoValidate=function(u,c){if(typeof u!="object"||!("aborted"in u))return c;const h=r(c)?()=>{c.destroy(new e(void 0,{cause:u.reason}))}:()=>{c[o](new e(void 0,{cause:u.reason}))};return u.aborted?h():(u.addEventListener("abort",h),s(c,()=>u.removeEventListener("abort",h))),c}})(Hf);var Js=Hf.exports;const{StringPrototypeSlice:_u,SymbolIterator:Lw,TypedArrayPrototypeSet:Jo,Uint8Array:kw}=ot,{Buffer:Ra}=Wt,{inspect:Cw}=Wn;var Uw=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let t=this.head,r=""+t.data;for(;(t=t.next)!==null;)r+=e+t.data;return r}concat(e){if(this.length===0)return Ra.alloc(0);const t=Ra.allocUnsafe(e>>>0);let r=this.head,i=0;for(;r;)Jo(t,r.data,i),i+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const i=r.slice(0,e);return this.head.data=r.slice(e),i}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[Lw](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,i=0;do{const o=r.data;if(e>o.length)t+=o,e-=o.length;else{e===o.length?(t+=o,++i,r.next?this.head=r.next:this.head=this.tail=null):(t+=_u(o,0,e),this.head=r,r.data=_u(o,e));break}++i}while((r=r.next)!==null);return this.length-=i,t}_getBuffer(e){const t=Ra.allocUnsafe(e),r=e;let i=this.head,o=0;do{const s=i.data;if(e>s.length)Jo(t,s,r-e),e-=s.length;else{e===s.length?(Jo(t,s,r-e),++o,i.next?this.head=i.next:this.head=this.tail=null):(Jo(t,new kw(s.buffer,s.byteOffset,e),r-e),this.head=i,i.data=s.slice(e));break}++o}while((i=i.next)!==null);return this.length-=o,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return Cw(this,{...t,depth:0,customInspect:!1})}};const{MathFloor:$w,NumberIsInteger:Nw}=ot,{ERR_INVALID_ARG_VALUE:Dw}=St.codes;function Pw(n,e,t){return n.highWaterMark!=null?n.highWaterMark:e?n[t]:null}function Vf(n){return n?16:16*1024}function Kw(n,e,t,r){const i=Pw(e,r,t);if(i!=null){if(!Nw(i)||i<0){const o=r?`options.${t}`:"options.highWaterMark";throw new Dw(o,i)}return $w(i)}return Vf(n.objectMode)}var el={getHighWaterMark:Kw,getDefaultHighWaterMark:Vf},Wf={},dc={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=Wt,r=t.Buffer;function i(s,a){for(var l in s)a[l]=s[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=t:(i(t,e),e.Buffer=o);function o(s,a,l){return r(s,a,l)}o.prototype=Object.create(r.prototype),i(r,o),o.from=function(s,a,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return r(s,a,l)},o.alloc=function(s,a,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var u=r(s);return a!==void 0?typeof l=="string"?u.fill(a,l):u.fill(a):u.fill(0),u},o.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r(s)},o.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(s)}})(dc,dc.exports);var Mw=dc.exports,tl=Mw.Buffer,xu=tl.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Fw(n){if(!n)return"utf8";for(var e;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(e)return;n=(""+n).toLowerCase(),e=!0}}function jw(n){var e=Fw(n);if(typeof e!="string"&&(tl.isEncoding===xu||!xu(n)))throw new Error("Unknown encoding: "+n);return e||n}Wf.StringDecoder=Ro;function Ro(n){this.encoding=jw(n);var e;switch(this.encoding){case"utf16le":this.text=Gw,this.end=Yw,e=4;break;case"utf8":this.fillLast=Ww,e=4;break;case"base64":this.text=Jw,this.end=Xw,e=3;break;default:this.write=Zw,this.end=Qw;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=tl.allocUnsafe(e)}Ro.prototype.write=function(n){if(n.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(n),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<n.length?e?e+this.text(n,t):this.text(n,t):e||""};Ro.prototype.end=zw;Ro.prototype.text=qw;Ro.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function Oa(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function Hw(n,e,t){var r=e.length-1;if(r<t)return 0;var i=Oa(e[r]);return i>=0?(i>0&&(n.lastNeed=i-1),i):--r<t||i===-2?0:(i=Oa(e[r]),i>=0?(i>0&&(n.lastNeed=i-2),i):--r<t||i===-2?0:(i=Oa(e[r]),i>=0?(i>0&&(i===2?i=0:n.lastNeed=i-3),i):0))}function Vw(n,e,t){if((e[0]&192)!==128)return n.lastNeed=0,"�";if(n.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return n.lastNeed=1,"�";if(n.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return n.lastNeed=2,"�"}}function Ww(n){var e=this.lastTotal-this.lastNeed,t=Vw(this,n);if(t!==void 0)return t;if(this.lastNeed<=n.length)return n.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,e,0,n.length),this.lastNeed-=n.length}function qw(n,e){var t=Hw(this,n,e);if(!this.lastNeed)return n.toString("utf8",e);this.lastTotal=t;var r=n.length-(t-this.lastNeed);return n.copy(this.lastChar,0,r),n.toString("utf8",e,r)}function zw(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"�":e}function Gw(n,e){if((n.length-e)%2===0){var t=n.toString("utf16le",e);if(t){var r=t.charCodeAt(t.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",e,n.length-1)}function Yw(n){var e=n&&n.length?this.write(n):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function Jw(n,e){var t=(n.length-e)%3;return t===0?n.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",e,n.length-t))}function Xw(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Zw(n){return n.toString(this.encoding)}function Qw(n){return n&&n.length?this.write(n):""}const Su=ni,{PromisePrototypeThen:eb,SymbolAsyncIterator:Au,SymbolIterator:Tu}=ot,{Buffer:tb}=Wt,{ERR_INVALID_ARG_TYPE:nb,ERR_STREAM_NULL_VALUES:rb}=St.codes;function ib(n,e,t){let r;if(typeof e=="string"||e instanceof tb)return new n({objectMode:!0,...t,read(){this.push(e),this.push(null)}});let i;if(e&&e[Au])i=!0,r=e[Au]();else if(e&&e[Tu])i=!1,r=e[Tu]();else throw new nb("iterable",["Iterable"],e);const o=new n({objectMode:!0,highWaterMark:1,...t});let s=!1;o._read=function(){s||(s=!0,l())},o._destroy=function(u,c){eb(a(u),()=>Su.nextTick(c,u),h=>Su.nextTick(c,h||u))};async function a(u){const c=u!=null,h=typeof r.throw=="function";if(c&&h){const{value:m,done:E}=await r.throw(u);if(await m,E)return}if(typeof r.return=="function"){const{value:m}=await r.return();await m}}async function l(){for(;;){try{const{value:u,done:c}=i?await r.next():r.next();if(c)o.push(null);else{const h=u&&typeof u.then=="function"?await u:u;if(h===null)throw s=!1,new rb;if(o.push(h))continue;s=!1}}catch(u){o.destroy(u)}break}}return o}var qf=ib,Ba,Iu;function Xs(){if(Iu)return Ba;Iu=1;const n=ni,{ArrayPrototypeIndexOf:e,NumberIsInteger:t,NumberIsNaN:r,NumberParseInt:i,ObjectDefineProperties:o,ObjectKeys:s,ObjectSetPrototypeOf:a,Promise:l,SafeSet:u,SymbolAsyncIterator:c,Symbol:h}=ot;Ba=N,N.ReadableState=$;const{EventEmitter:m}=Ds,{Stream:E,prependListener:g}=Qc,{Buffer:S}=Wt,{addAbortSignal:C}=Js,B=wr;let A=Wn.debuglog("stream",p=>{A=p});const O=Uw,I=$i,{getHighWaterMark:x,getDefaultHighWaterMark:D}=el,{aggregateTwoErrors:H,codes:{ERR_INVALID_ARG_TYPE:z,ERR_METHOD_NOT_IMPLEMENTED:Q,ERR_OUT_OF_RANGE:P,ERR_STREAM_PUSH_AFTER_EOF:G,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:ie}}=St,{validateObject:ee}=Hs,oe=h("kPaused"),{StringDecoder:K}=Wf,J=qf;a(N.prototype,E.prototype),a(N,E);const ne=()=>{},{errorOrDestroy:j}=I;function $(p,v,q){typeof q!="boolean"&&(q=v instanceof Fn()),this.objectMode=!!(p&&p.objectMode),q&&(this.objectMode=this.objectMode||!!(p&&p.readableObjectMode)),this.highWaterMark=p?x(this,p,"readableHighWaterMark",q):D(!1),this.buffer=new O,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[oe]=null,this.errorEmitted=!1,this.emitClose=!p||p.emitClose!==!1,this.autoDestroy=!p||p.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=p&&p.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,p&&p.encoding&&(this.decoder=new K(p.encoding),this.encoding=p.encoding)}function N(p){if(!(this instanceof N))return new N(p);const v=this instanceof Fn();this._readableState=new $(p,this,v),p&&(typeof p.read=="function"&&(this._read=p.read),typeof p.destroy=="function"&&(this._destroy=p.destroy),typeof p.construct=="function"&&(this._construct=p.construct),p.signal&&!v&&C(p.signal,this)),E.call(this,p),I.construct(this,()=>{this._readableState.needReadable&&Ee(this,this._readableState)})}N.prototype.destroy=I.destroy,N.prototype._undestroy=I.undestroy,N.prototype._destroy=function(p,v){v(p)},N.prototype[m.captureRejectionSymbol]=function(p){this.destroy(p)},N.prototype.push=function(p,v){return X(this,p,v,!1)},N.prototype.unshift=function(p,v){return X(this,p,v,!0)};function X(p,v,q,Z){A("readableAddChunk",v);const re=p._readableState;let De;if(re.objectMode||(typeof v=="string"?(q=q||re.defaultEncoding,re.encoding!==q&&(Z&&re.encoding?v=S.from(v,q).toString(re.encoding):(v=S.from(v,q),q=""))):v instanceof S?q="":E._isUint8Array(v)?(v=E._uint8ArrayToBuffer(v),q=""):v!=null&&(De=new z("chunk",["string","Buffer","Uint8Array"],v))),De)j(p,De);else if(v===null)re.reading=!1,ue(p,re);else if(re.objectMode||v&&v.length>0)if(Z)if(re.endEmitted)j(p,new ie);else{if(re.destroyed||re.errored)return!1;te(p,re,v,!0)}else if(re.ended)j(p,new G);else{if(re.destroyed||re.errored)return!1;re.reading=!1,re.decoder&&!q?(v=re.decoder.write(v),re.objectMode||v.length!==0?te(p,re,v,!1):Ee(p,re)):te(p,re,v,!1)}else Z||(re.reading=!1,Ee(p,re));return!re.ended&&(re.length<re.highWaterMark||re.length===0)}function te(p,v,q,Z){v.flowing&&v.length===0&&!v.sync&&p.listenerCount("data")>0?(v.multiAwaitDrain?v.awaitDrainWriters.clear():v.awaitDrainWriters=null,v.dataEmitted=!0,p.emit("data",q)):(v.length+=v.objectMode?1:q.length,Z?v.buffer.unshift(q):v.buffer.push(q),v.needReadable&&ae(p)),Ee(p,v)}N.prototype.isPaused=function(){const p=this._readableState;return p[oe]===!0||p.flowing===!1},N.prototype.setEncoding=function(p){const v=new K(p);this._readableState.decoder=v,this._readableState.encoding=this._readableState.decoder.encoding;const q=this._readableState.buffer;let Z="";for(const re of q)Z+=v.write(re);return q.clear(),Z!==""&&q.push(Z),this._readableState.length=Z.length,this};const le=1073741824;function he(p){if(p>le)throw new P("size","<= 1GiB",p);return p--,p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,p|=p>>>16,p++,p}function we(p,v){return p<=0||v.length===0&&v.ended?0:v.objectMode?1:r(p)?v.flowing&&v.length?v.buffer.first().length:v.length:p<=v.length?p:v.ended?v.length:0}N.prototype.read=function(p){A("read",p),p===void 0?p=NaN:t(p)||(p=i(p,10));const v=this._readableState,q=p;if(p>v.highWaterMark&&(v.highWaterMark=he(p)),p!==0&&(v.emittedReadable=!1),p===0&&v.needReadable&&((v.highWaterMark!==0?v.length>=v.highWaterMark:v.length>0)||v.ended))return A("read: emitReadable",v.length,v.ended),v.length===0&&v.ended?k(this):ae(this),null;if(p=we(p,v),p===0&&v.ended)return v.length===0&&k(this),null;let Z=v.needReadable;if(A("need readable",Z),(v.length===0||v.length-p<v.highWaterMark)&&(Z=!0,A("length less than watermark",Z)),v.ended||v.reading||v.destroyed||v.errored||!v.constructed)Z=!1,A("reading, ended or constructing",Z);else if(Z){A("do read"),v.reading=!0,v.sync=!0,v.length===0&&(v.needReadable=!0);try{this._read(v.highWaterMark)}catch(De){j(this,De)}v.sync=!1,v.reading||(p=we(q,v))}let re;return p>0?re=w(p,v):re=null,re===null?(v.needReadable=v.length<=v.highWaterMark,p=0):(v.length-=p,v.multiAwaitDrain?v.awaitDrainWriters.clear():v.awaitDrainWriters=null),v.length===0&&(v.ended||(v.needReadable=!0),q!==p&&v.ended&&k(this)),re!==null&&!v.errorEmitted&&!v.closeEmitted&&(v.dataEmitted=!0,this.emit("data",re)),re};function ue(p,v){if(A("onEofChunk"),!v.ended){if(v.decoder){const q=v.decoder.end();q&&q.length&&(v.buffer.push(q),v.length+=v.objectMode?1:q.length)}v.ended=!0,v.sync?ae(p):(v.needReadable=!1,v.emittedReadable=!0,ve(p))}}function ae(p){const v=p._readableState;A("emitReadable",v.needReadable,v.emittedReadable),v.needReadable=!1,v.emittedReadable||(A("emitReadable",v.flowing),v.emittedReadable=!0,n.nextTick(ve,p))}function ve(p){const v=p._readableState;A("emitReadable_",v.destroyed,v.length,v.ended),!v.destroyed&&!v.errored&&(v.length||v.ended)&&(p.emit("readable"),v.emittedReadable=!1),v.needReadable=!v.flowing&&!v.ended&&v.length<=v.highWaterMark,y(p)}function Ee(p,v){!v.readingMore&&v.constructed&&(v.readingMore=!0,n.nextTick(Ne,p,v))}function Ne(p,v){for(;!v.reading&&!v.ended&&(v.length<v.highWaterMark||v.flowing&&v.length===0);){const q=v.length;if(A("maybeReadMore read 0"),p.read(0),q===v.length)break}v.readingMore=!1}N.prototype._read=function(p){throw new Q("_read()")},N.prototype.pipe=function(p,v){const q=this,Z=this._readableState;Z.pipes.length===1&&(Z.multiAwaitDrain||(Z.multiAwaitDrain=!0,Z.awaitDrainWriters=new u(Z.awaitDrainWriters?[Z.awaitDrainWriters]:[]))),Z.pipes.push(p),A("pipe count=%d opts=%j",Z.pipes.length,v);const De=(!v||v.end!==!1)&&p!==n.stdout&&p!==n.stderr?vr:mr;Z.endEmitted?n.nextTick(De):q.once("end",De),p.on("unpipe",ut);function ut(xn,zt){A("onunpipe"),xn===q&&zt&&zt.hasUnpiped===!1&&(zt.hasUnpiped=!0,ia())}function vr(){A("onend"),p.end()}let wt,Ni=!1;function ia(){A("cleanup"),p.removeListener("close",Ki),p.removeListener("finish",Mi),wt&&p.removeListener("drain",wt),p.removeListener("error",Pi),p.removeListener("unpipe",ut),q.removeListener("end",vr),q.removeListener("end",mr),q.removeListener("data",At),Ni=!0,wt&&Z.awaitDrainWriters&&(!p._writableState||p._writableState.needDrain)&&wt()}function Di(){Ni||(Z.pipes.length===1&&Z.pipes[0]===p?(A("false write response, pause",0),Z.awaitDrainWriters=p,Z.multiAwaitDrain=!1):Z.pipes.length>1&&Z.pipes.includes(p)&&(A("false write response, pause",Z.awaitDrainWriters.size),Z.awaitDrainWriters.add(p)),q.pause()),wt||(wt=ke(q,p),p.on("drain",wt))}q.on("data",At);function At(xn){A("ondata");const zt=p.write(xn);A("dest.write",zt),zt===!1&&Di()}function Pi(xn){if(A("onerror",xn),mr(),p.removeListener("error",Pi),p.listenerCount("error")===0){const zt=p._writableState||p._readableState;zt&&!zt.errorEmitted?j(p,xn):p.emit("error",xn)}}g(p,"error",Pi);function Ki(){p.removeListener("finish",Mi),mr()}p.once("close",Ki);function Mi(){A("onfinish"),p.removeListener("close",Ki),mr()}p.once("finish",Mi);function mr(){A("unpipe"),q.unpipe(p)}return p.emit("pipe",q),p.writableNeedDrain===!0?Z.flowing&&Di():Z.flowing||(A("pipe resume"),q.resume()),p};function ke(p,v){return function(){const Z=p._readableState;Z.awaitDrainWriters===v?(A("pipeOnDrain",1),Z.awaitDrainWriters=null):Z.multiAwaitDrain&&(A("pipeOnDrain",Z.awaitDrainWriters.size),Z.awaitDrainWriters.delete(v)),(!Z.awaitDrainWriters||Z.awaitDrainWriters.size===0)&&p.listenerCount("data")&&p.resume()}}N.prototype.unpipe=function(p){const v=this._readableState,q={hasUnpiped:!1};if(v.pipes.length===0)return this;if(!p){const re=v.pipes;v.pipes=[],this.pause();for(let De=0;De<re.length;De++)re[De].emit("unpipe",this,{hasUnpiped:!1});return this}const Z=e(v.pipes,p);return Z===-1?this:(v.pipes.splice(Z,1),v.pipes.length===0&&this.pause(),p.emit("unpipe",this,q),this)},N.prototype.on=function(p,v){const q=E.prototype.on.call(this,p,v),Z=this._readableState;return p==="data"?(Z.readableListening=this.listenerCount("readable")>0,Z.flowing!==!1&&this.resume()):p==="readable"&&!Z.endEmitted&&!Z.readableListening&&(Z.readableListening=Z.needReadable=!0,Z.flowing=!1,Z.emittedReadable=!1,A("on readable",Z.length,Z.reading),Z.length?ae(this):Z.reading||n.nextTick(L,this)),q},N.prototype.addListener=N.prototype.on,N.prototype.removeListener=function(p,v){const q=E.prototype.removeListener.call(this,p,v);return p==="readable"&&n.nextTick(Ce,this),q},N.prototype.off=N.prototype.removeListener,N.prototype.removeAllListeners=function(p){const v=E.prototype.removeAllListeners.apply(this,arguments);return(p==="readable"||p===void 0)&&n.nextTick(Ce,this),v};function Ce(p){const v=p._readableState;v.readableListening=p.listenerCount("readable")>0,v.resumeScheduled&&v[oe]===!1?v.flowing=!0:p.listenerCount("data")>0?p.resume():v.readableListening||(v.flowing=null)}function L(p){A("readable nexttick read 0"),p.read(0)}N.prototype.resume=function(){const p=this._readableState;return p.flowing||(A("resume"),p.flowing=!p.readableListening,U(this,p)),p[oe]=!1,this};function U(p,v){v.resumeScheduled||(v.resumeScheduled=!0,n.nextTick(V,p,v))}function V(p,v){A("resume",v.reading),v.reading||p.read(0),v.resumeScheduled=!1,p.emit("resume"),y(p),v.flowing&&!v.reading&&p.read(0)}N.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[oe]=!0,this};function y(p){const v=p._readableState;for(A("flow",v.flowing);v.flowing&&p.read()!==null;);}N.prototype.wrap=function(p){let v=!1;p.on("data",Z=>{!this.push(Z)&&p.pause&&(v=!0,p.pause())}),p.on("end",()=>{this.push(null)}),p.on("error",Z=>{j(this,Z)}),p.on("close",()=>{this.destroy()}),p.on("destroy",()=>{this.destroy()}),this._read=()=>{v&&p.resume&&(v=!1,p.resume())};const q=s(p);for(let Z=1;Z<q.length;Z++){const re=q[Z];this[re]===void 0&&typeof p[re]=="function"&&(this[re]=p[re].bind(p))}return this},N.prototype[c]=function(){return d(this)},N.prototype.iterator=function(p){return p!==void 0&&ee(p,"options"),d(this,p)};function d(p,v){typeof p.read!="function"&&(p=N.wrap(p,{objectMode:!0}));const q=f(p,v);return q.stream=p,q}async function*f(p,v){let q=ne;function Z(ut){this===p?(q(),q=ne):q=ut}p.on("readable",Z);let re;const De=B(p,{writable:!1},ut=>{re=ut?H(re,ut):null,q(),q=ne});try{for(;;){const ut=p.destroyed?null:p.read();if(ut!==null)yield ut;else{if(re)throw re;if(re===null)return;await new l(Z)}}}catch(ut){throw re=H(re,ut),re}finally{(re||(v==null?void 0:v.destroyOnReturn)!==!1)&&(re===void 0||p._readableState.autoDestroy)?I.destroyer(p,null):(p.off("readable",Z),De())}}o(N.prototype,{readable:{__proto__:null,get(){const p=this._readableState;return!!p&&p.readable!==!1&&!p.destroyed&&!p.errorEmitted&&!p.endEmitted},set(p){this._readableState&&(this._readableState.readable=!!p)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(p){this._readableState&&(this._readableState.flowing=p)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(p){this._readableState&&(this._readableState.destroyed=p)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),o($.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[oe]!==!1},set(p){this[oe]=!!p}}}),N._fromList=w;function w(p,v){if(v.length===0)return null;let q;return v.objectMode?q=v.buffer.shift():!p||p>=v.length?(v.decoder?q=v.buffer.join(""):v.buffer.length===1?q=v.buffer.first():q=v.buffer.concat(v.length),v.buffer.clear()):q=v.buffer.consume(p,v.decoder),q}function k(p){const v=p._readableState;A("endReadable",v.endEmitted),v.endEmitted||(v.ended=!0,n.nextTick(W,v,p))}function W(p,v){if(A("endReadableNT",p.endEmitted,p.length),!p.errored&&!p.closeEmitted&&!p.endEmitted&&p.length===0){if(p.endEmitted=!0,v.emit("end"),v.writable&&v.allowHalfOpen===!1)n.nextTick(Y,v);else if(p.autoDestroy){const q=v._writableState;(!q||q.autoDestroy&&(q.finished||q.writable===!1))&&v.destroy()}}}function Y(p){p.writable&&!p.writableEnded&&!p.destroyed&&p.end()}N.from=function(p,v){return J(N,p,v)};let de;function Te(){return de===void 0&&(de={}),de}return N.fromWeb=function(p,v){return Te().newStreamReadableFromReadableStream(p,v)},N.toWeb=function(p,v){return Te().newReadableStreamFromStreamReadable(p,v)},N.wrap=function(p,v){var q,Z;return new N({objectMode:(q=(Z=p.readableObjectMode)!==null&&Z!==void 0?Z:p.objectMode)!==null&&q!==void 0?q:!0,...v,destroy(re,De){I.destroyer(p,re),De(re)}}).wrap(p)},Ba}var La,Ru;function zf(){if(Ru)return La;Ru=1;const n=ni,{ArrayPrototypeSlice:e,Error:t,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:i,ObjectDefineProperties:o,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:a,Symbol:l,SymbolHasInstance:u}=ot;La=K,K.WritableState=ee;const{EventEmitter:c}=Ds,h=Qc.Stream,{Buffer:m}=Wt,E=$i,{addAbortSignal:g}=Js,{getHighWaterMark:S,getDefaultHighWaterMark:C}=el,{ERR_INVALID_ARG_TYPE:B,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_MULTIPLE_CALLBACK:O,ERR_STREAM_CANNOT_PIPE:I,ERR_STREAM_DESTROYED:x,ERR_STREAM_ALREADY_FINISHED:D,ERR_STREAM_NULL_VALUES:H,ERR_STREAM_WRITE_AFTER_END:z,ERR_UNKNOWN_ENCODING:Q}=St.codes,{errorOrDestroy:P}=E;s(K.prototype,h.prototype),s(K,h);function G(){}const ie=l("kOnFinished");function ee(L,U,V){typeof V!="boolean"&&(V=U instanceof Fn()),this.objectMode=!!(L&&L.objectMode),V&&(this.objectMode=this.objectMode||!!(L&&L.writableObjectMode)),this.highWaterMark=L?S(this,L,"writableHighWaterMark",V):C(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const y=!!(L&&L.decodeStrings===!1);this.decodeStrings=!y,this.defaultEncoding=L&&L.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=N.bind(void 0,U),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,oe(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!L||L.emitClose!==!1,this.autoDestroy=!L||L.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[ie]=[]}function oe(L){L.buffered=[],L.bufferedIndex=0,L.allBuffers=!0,L.allNoop=!0}ee.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},i(ee.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function K(L){const U=this instanceof Fn();if(!U&&!r(K,this))return new K(L);this._writableState=new ee(L,this,U),L&&(typeof L.write=="function"&&(this._write=L.write),typeof L.writev=="function"&&(this._writev=L.writev),typeof L.destroy=="function"&&(this._destroy=L.destroy),typeof L.final=="function"&&(this._final=L.final),typeof L.construct=="function"&&(this._construct=L.construct),L.signal&&g(L.signal,this)),h.call(this,L),E.construct(this,()=>{const V=this._writableState;V.writing||he(this,V),ve(this,V)})}i(K,u,{__proto__:null,value:function(L){return r(this,L)?!0:this!==K?!1:L&&L._writableState instanceof ee}}),K.prototype.pipe=function(){P(this,new I)};function J(L,U,V,y){const d=L._writableState;if(typeof V=="function")y=V,V=d.defaultEncoding;else{if(!V)V=d.defaultEncoding;else if(V!=="buffer"&&!m.isEncoding(V))throw new Q(V);typeof y!="function"&&(y=G)}if(U===null)throw new H;if(!d.objectMode)if(typeof U=="string")d.decodeStrings!==!1&&(U=m.from(U,V),V="buffer");else if(U instanceof m)V="buffer";else if(h._isUint8Array(U))U=h._uint8ArrayToBuffer(U),V="buffer";else throw new B("chunk",["string","Buffer","Uint8Array"],U);let f;return d.ending?f=new z:d.destroyed&&(f=new x("write")),f?(n.nextTick(y,f),P(L,f,!0),f):(d.pendingcb++,ne(L,d,U,V,y))}K.prototype.write=function(L,U,V){return J(this,L,U,V)===!0},K.prototype.cork=function(){this._writableState.corked++},K.prototype.uncork=function(){const L=this._writableState;L.corked&&(L.corked--,L.writing||he(this,L))},K.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=a(U)),!m.isEncoding(U))throw new Q(U);return this._writableState.defaultEncoding=U,this};function ne(L,U,V,y,d){const f=U.objectMode?1:V.length;U.length+=f;const w=U.length<U.highWaterMark;return w||(U.needDrain=!0),U.writing||U.corked||U.errored||!U.constructed?(U.buffered.push({chunk:V,encoding:y,callback:d}),U.allBuffers&&y!=="buffer"&&(U.allBuffers=!1),U.allNoop&&d!==G&&(U.allNoop=!1)):(U.writelen=f,U.writecb=d,U.writing=!0,U.sync=!0,L._write(V,y,U.onwrite),U.sync=!1),w&&!U.errored&&!U.destroyed}function j(L,U,V,y,d,f,w){U.writelen=y,U.writecb=w,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new x("write")):V?L._writev(d,U.onwrite):L._write(d,f,U.onwrite),U.sync=!1}function $(L,U,V,y){--U.pendingcb,y(V),le(U),P(L,V)}function N(L,U){const V=L._writableState,y=V.sync,d=V.writecb;if(typeof d!="function"){P(L,new O);return}V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0,U?(U.stack,V.errored||(V.errored=U),L._readableState&&!L._readableState.errored&&(L._readableState.errored=U),y?n.nextTick($,L,V,U,d):$(L,V,U,d)):(V.buffered.length>V.bufferedIndex&&he(L,V),y?V.afterWriteTickInfo!==null&&V.afterWriteTickInfo.cb===d?V.afterWriteTickInfo.count++:(V.afterWriteTickInfo={count:1,cb:d,stream:L,state:V},n.nextTick(X,V.afterWriteTickInfo)):te(L,V,1,d))}function X({stream:L,state:U,count:V,cb:y}){return U.afterWriteTickInfo=null,te(L,U,V,y)}function te(L,U,V,y){for(!U.ending&&!L.destroyed&&U.length===0&&U.needDrain&&(U.needDrain=!1,L.emit("drain"));V-- >0;)U.pendingcb--,y();U.destroyed&&le(U),ve(L,U)}function le(L){if(L.writing)return;for(let d=L.bufferedIndex;d<L.buffered.length;++d){var U;const{chunk:f,callback:w}=L.buffered[d],k=L.objectMode?1:f.length;L.length-=k,w((U=L.errored)!==null&&U!==void 0?U:new x("write"))}const V=L[ie].splice(0);for(let d=0;d<V.length;d++){var y;V[d]((y=L.errored)!==null&&y!==void 0?y:new x("end"))}oe(L)}function he(L,U){if(U.corked||U.bufferProcessing||U.destroyed||!U.constructed)return;const{buffered:V,bufferedIndex:y,objectMode:d}=U,f=V.length-y;if(!f)return;let w=y;if(U.bufferProcessing=!0,f>1&&L._writev){U.pendingcb-=f-1;const k=U.allNoop?G:Y=>{for(let de=w;de<V.length;++de)V[de].callback(Y)},W=U.allNoop&&w===0?V:e(V,w);W.allBuffers=U.allBuffers,j(L,U,!0,U.length,W,"",k),oe(U)}else{do{const{chunk:k,encoding:W,callback:Y}=V[w];V[w++]=null;const de=d?1:k.length;j(L,U,!1,de,k,W,Y)}while(w<V.length&&!U.writing);w===V.length?oe(U):w>256?(V.splice(0,w),U.bufferedIndex=0):U.bufferedIndex=w}U.bufferProcessing=!1}K.prototype._write=function(L,U,V){if(this._writev)this._writev([{chunk:L,encoding:U}],V);else throw new A("_write()")},K.prototype._writev=null,K.prototype.end=function(L,U,V){const y=this._writableState;typeof L=="function"?(V=L,L=null,U=null):typeof U=="function"&&(V=U,U=null);let d;if(L!=null){const f=J(this,L,U);f instanceof t&&(d=f)}return y.corked&&(y.corked=1,this.uncork()),d||(!y.errored&&!y.ending?(y.ending=!0,ve(this,y,!0),y.ended=!0):y.finished?d=new D("end"):y.destroyed&&(d=new x("end"))),typeof V=="function"&&(d||y.finished?n.nextTick(V,d):y[ie].push(V)),this};function we(L){return L.ending&&!L.destroyed&&L.constructed&&L.length===0&&!L.errored&&L.buffered.length===0&&!L.finished&&!L.writing&&!L.errorEmitted&&!L.closeEmitted}function ue(L,U){let V=!1;function y(d){if(V){P(L,d??O());return}if(V=!0,U.pendingcb--,d){const f=U[ie].splice(0);for(let w=0;w<f.length;w++)f[w](d);P(L,d,U.sync)}else we(U)&&(U.prefinished=!0,L.emit("prefinish"),U.pendingcb++,n.nextTick(Ee,L,U))}U.sync=!0,U.pendingcb++;try{L._final(y)}catch(d){y(d)}U.sync=!1}function ae(L,U){!U.prefinished&&!U.finalCalled&&(typeof L._final=="function"&&!U.destroyed?(U.finalCalled=!0,ue(L,U)):(U.prefinished=!0,L.emit("prefinish")))}function ve(L,U,V){we(U)&&(ae(L,U),U.pendingcb===0&&(V?(U.pendingcb++,n.nextTick((y,d)=>{we(d)?Ee(y,d):d.pendingcb--},L,U)):we(U)&&(U.pendingcb++,Ee(L,U))))}function Ee(L,U){U.pendingcb--,U.finished=!0;const V=U[ie].splice(0);for(let y=0;y<V.length;y++)V[y]();if(L.emit("finish"),U.autoDestroy){const y=L._readableState;(!y||y.autoDestroy&&(y.endEmitted||y.readable===!1))&&L.destroy()}}o(K.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(L){this._writableState&&(this._writableState.destroyed=L)}},writable:{__proto__:null,get(){const L=this._writableState;return!!L&&L.writable!==!1&&!L.destroyed&&!L.errored&&!L.ending&&!L.ended},set(L){this._writableState&&(this._writableState.writable=!!L)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const L=this._writableState;return L?!L.destroyed&&!L.ending&&L.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Ne=E.destroy;K.prototype.destroy=function(L,U){const V=this._writableState;return!V.destroyed&&(V.bufferedIndex<V.buffered.length||V[ie].length)&&n.nextTick(le,V),Ne.call(this,L,U),this},K.prototype._undestroy=E.undestroy,K.prototype._destroy=function(L,U){U(L)},K.prototype[c.captureRejectionSymbol]=function(L){this.destroy(L)};let ke;function Ce(){return ke===void 0&&(ke={}),ke}return K.fromWeb=function(L,U){return Ce().newStreamWritableFromWritableStream(L,U)},K.toWeb=function(L){return Ce().newWritableStreamFromStreamWritable(L)},La}var ka,Ou;function ob(){if(Ou)return ka;Ou=1;const n=ni,e=Wt,{isReadable:t,isWritable:r,isIterable:i,isNodeStream:o,isReadableNodeStream:s,isWritableNodeStream:a,isDuplexNodeStream:l}=zn,u=wr,{AbortError:c,codes:{ERR_INVALID_ARG_TYPE:h,ERR_INVALID_RETURN_VALUE:m}}=St,{destroyer:E}=$i,g=Fn(),S=Xs(),{createDeferredPromise:C}=Wn,B=qf,A=globalThis.Blob||e.Blob,O=typeof A<"u"?function(P){return P instanceof A}:function(P){return!1},I=globalThis.AbortController||zc().AbortController,{FunctionPrototypeCall:x}=ot;class D extends g{constructor(P){super(P),(P==null?void 0:P.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(P==null?void 0:P.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}ka=function Q(P,G){if(l(P))return P;if(s(P))return z({readable:P});if(a(P))return z({writable:P});if(o(P))return z({writable:!1,readable:!1});if(typeof P=="function"){const{value:ee,write:oe,final:K,destroy:J}=H(P);if(i(ee))return B(D,ee,{objectMode:!0,write:oe,final:K,destroy:J});const ne=ee==null?void 0:ee.then;if(typeof ne=="function"){let j;const $=x(ne,ee,N=>{if(N!=null)throw new m("nully","body",N)},N=>{E(j,N)});return j=new D({objectMode:!0,readable:!1,write:oe,final(N){K(async()=>{try{await $,n.nextTick(N,null)}catch(X){n.nextTick(N,X)}})},destroy:J})}throw new m("Iterable, AsyncIterable or AsyncFunction",G,ee)}if(O(P))return Q(P.arrayBuffer());if(i(P))return B(D,P,{objectMode:!0,writable:!1});if(typeof(P==null?void 0:P.writable)=="object"||typeof(P==null?void 0:P.readable)=="object"){const ee=P!=null&&P.readable?s(P==null?void 0:P.readable)?P==null?void 0:P.readable:Q(P.readable):void 0,oe=P!=null&&P.writable?a(P==null?void 0:P.writable)?P==null?void 0:P.writable:Q(P.writable):void 0;return z({readable:ee,writable:oe})}const ie=P==null?void 0:P.then;if(typeof ie=="function"){let ee;return x(ie,P,oe=>{oe!=null&&ee.push(oe),ee.push(null)},oe=>{E(ee,oe)}),ee=new D({objectMode:!0,writable:!1,read(){}})}throw new h(G,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],P)};function H(Q){let{promise:P,resolve:G}=C();const ie=new I,ee=ie.signal;return{value:Q(async function*(){for(;;){const K=P;P=null;const{chunk:J,done:ne,cb:j}=await K;if(n.nextTick(j),ne)return;if(ee.aborted)throw new c(void 0,{cause:ee.reason});({promise:P,resolve:G}=C()),yield J}}(),{signal:ee}),write(K,J,ne){const j=G;G=null,j({chunk:K,done:!1,cb:ne})},final(K){const J=G;G=null,J({done:!0,cb:K})},destroy(K,J){ie.abort(),J(K)}}}function z(Q){const P=Q.readable&&typeof Q.readable.read!="function"?S.wrap(Q.readable):Q.readable,G=Q.writable;let ie=!!t(P),ee=!!r(G),oe,K,J,ne,j;function $(N){const X=ne;ne=null,X?X(N):N&&j.destroy(N)}return j=new D({readableObjectMode:!!(P!=null&&P.readableObjectMode),writableObjectMode:!!(G!=null&&G.writableObjectMode),readable:ie,writable:ee}),ee&&(u(G,N=>{ee=!1,N&&E(P,N),$(N)}),j._write=function(N,X,te){G.write(N,X)?te():oe=te},j._final=function(N){G.end(),K=N},G.on("drain",function(){if(oe){const N=oe;oe=null,N()}}),G.on("finish",function(){if(K){const N=K;K=null,N()}})),ie&&(u(P,N=>{ie=!1,N&&E(P,N),$(N)}),P.on("readable",function(){if(J){const N=J;J=null,N()}}),P.on("end",function(){j.push(null)}),j._read=function(){for(;;){const N=P.read();if(N===null){J=j._read;return}if(!j.push(N))return}}),j._destroy=function(N,X){!N&&ne!==null&&(N=new c),J=null,oe=null,K=null,ne===null?X(N):(ne=X,E(G,N),E(P,N))},j}return ka}var Ca,Bu;function Fn(){if(Bu)return Ca;Bu=1;const{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:t,ObjectSetPrototypeOf:r}=ot;Ca=s;const i=Xs(),o=zf();r(s.prototype,i.prototype),r(s,i);{const c=t(o.prototype);for(let h=0;h<c.length;h++){const m=c[h];s.prototype[m]||(s.prototype[m]=o.prototype[m])}}function s(c){if(!(this instanceof s))return new s(c);i.call(this,c),o.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}n(s.prototype,{writable:{__proto__:null,...e(o.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(o.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(o.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(o.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(o.prototype,"writableLength")},writableFinished:{__proto__:null,...e(o.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(o.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(o.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(o.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let a;function l(){return a===void 0&&(a={}),a}s.fromWeb=function(c,h){return l().newStreamDuplexFromReadableWritablePair(c,h)},s.toWeb=function(c){return l().newReadableWritablePairFromDuplex(c)};let u;return s.from=function(c){return u||(u=ob()),u(c,"body")},Ca}const{ObjectSetPrototypeOf:Gf,Symbol:sb}=ot;var Yf=jn;const{ERR_METHOD_NOT_IMPLEMENTED:ab}=St.codes,nl=Fn(),{getHighWaterMark:cb}=el;Gf(jn.prototype,nl.prototype);Gf(jn,nl);const bo=sb("kCallback");function jn(n){if(!(this instanceof jn))return new jn(n);const e=n?cb(this,n,"readableHighWaterMark",!0):null;e===0&&(n={...n,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:n.writableHighWaterMark||0}),nl.call(this,n),this._readableState.sync=!1,this[bo]=null,n&&(typeof n.transform=="function"&&(this._transform=n.transform),typeof n.flush=="function"&&(this._flush=n.flush)),this.on("prefinish",lb)}function fc(n){typeof this._flush=="function"&&!this.destroyed?this._flush((e,t)=>{if(e){n?n(e):this.destroy(e);return}t!=null&&this.push(t),this.push(null),n&&n()}):(this.push(null),n&&n())}function lb(){this._final!==fc&&fc.call(this)}jn.prototype._final=fc;jn.prototype._transform=function(n,e,t){throw new ab("_transform()")};jn.prototype._write=function(n,e,t){const r=this._readableState,i=this._writableState,o=r.length;this._transform(n,e,(s,a)=>{if(s){t(s);return}a!=null&&this.push(a),i.ended||o===r.length||r.length<r.highWaterMark?t():this[bo]=t})};jn.prototype._read=function(){if(this[bo]){const n=this[bo];this[bo]=null,n()}};const{ObjectSetPrototypeOf:Jf}=ot;var Xf=Bi;const rl=Yf;Jf(Bi.prototype,rl.prototype);Jf(Bi,rl);function Bi(n){if(!(this instanceof Bi))return new Bi(n);rl.call(this,n)}Bi.prototype._transform=function(n,e,t){t(null,n)};const co=ni,{ArrayIsArray:ub,Promise:db,SymbolAsyncIterator:fb}=ot,Rs=wr,{once:hb}=Wn,yb=$i,Lu=Fn(),{aggregateTwoErrors:pb,codes:{ERR_INVALID_ARG_TYPE:hc,ERR_INVALID_RETURN_VALUE:Ua,ERR_MISSING_ARGS:gb,ERR_STREAM_DESTROYED:wb,ERR_STREAM_PREMATURE_CLOSE:bb},AbortError:vb}=St,{validateFunction:mb,validateAbortSignal:Eb}=Hs,{isIterable:Cr,isReadable:$a,isReadableNodeStream:ds,isNodeStream:ku,isTransformStream:wi,isWebStream:_b,isReadableStream:Na,isReadableEnded:xb}=zn,Sb=globalThis.AbortController||zc().AbortController;let Da,Pa;function Cu(n,e,t){let r=!1;n.on("close",()=>{r=!0});const i=Rs(n,{readable:e,writable:t},o=>{r=!o});return{destroy:o=>{r||(r=!0,yb.destroyer(n,o||new wb("pipe")))},cleanup:i}}function Ab(n){return mb(n[n.length-1],"streams[stream.length - 1]"),n.pop()}function Ka(n){if(Cr(n))return n;if(ds(n))return Tb(n);throw new hc("val",["Readable","Iterable","AsyncIterable"],n)}async function*Tb(n){Pa||(Pa=Xs()),yield*Pa.prototype[fb].call(n)}async function Xo(n,e,t,{end:r}){let i,o=null;const s=u=>{if(u&&(i=u),o){const c=o;o=null,c()}},a=()=>new db((u,c)=>{i?c(i):o=()=>{i?c(i):u()}});e.on("drain",s);const l=Rs(e,{readable:!1},s);try{e.writableNeedDrain&&await a();for await(const u of n)e.write(u)||await a();r&&e.end(),await a(),t()}catch(u){t(i!==u?pb(i,u):u)}finally{l(),e.off("drain",s)}}async function Ma(n,e,t,{end:r}){wi(e)&&(e=e.writable);const i=e.getWriter();try{for await(const o of n)await i.ready,i.write(o).catch(()=>{});await i.ready,r&&await i.close(),t()}catch(o){try{await i.abort(o),t(o)}catch(s){t(s)}}}function Ib(...n){return Zf(n,hb(Ab(n)))}function Zf(n,e,t){if(n.length===1&&ub(n[0])&&(n=n[0]),n.length<2)throw new gb("streams");const r=new Sb,i=r.signal,o=t==null?void 0:t.signal,s=[];Eb(o,"options.signal");function a(){E(new vb)}o==null||o.addEventListener("abort",a);let l,u;const c=[];let h=0;function m(B){E(B,--h===0)}function E(B,A){if(B&&(!l||l.code==="ERR_STREAM_PREMATURE_CLOSE")&&(l=B),!(!l&&!A)){for(;c.length;)c.shift()(l);o==null||o.removeEventListener("abort",a),r.abort(),A&&(l||s.forEach(O=>O()),co.nextTick(e,l,u))}}let g;for(let B=0;B<n.length;B++){const A=n[B],O=B<n.length-1,I=B>0,x=O||(t==null?void 0:t.end)!==!1,D=B===n.length-1;if(ku(A)){let H=function(z){z&&z.name!=="AbortError"&&z.code!=="ERR_STREAM_PREMATURE_CLOSE"&&m(z)};if(x){const{destroy:z,cleanup:Q}=Cu(A,O,I);c.push(z),$a(A)&&D&&s.push(Q)}A.on("error",H),$a(A)&&D&&s.push(()=>{A.removeListener("error",H)})}if(B===0)if(typeof A=="function"){if(g=A({signal:i}),!Cr(g))throw new Ua("Iterable, AsyncIterable or Stream","source",g)}else Cr(A)||ds(A)||wi(A)?g=A:g=Lu.from(A);else if(typeof A=="function"){if(wi(g)){var S;g=Ka((S=g)===null||S===void 0?void 0:S.readable)}else g=Ka(g);if(g=A(g,{signal:i}),O){if(!Cr(g,!0))throw new Ua("AsyncIterable",`transform[${B-1}]`,g)}else{var C;Da||(Da=Xf);const H=new Da({objectMode:!0}),z=(C=g)===null||C===void 0?void 0:C.then;if(typeof z=="function")h++,z.call(g,G=>{u=G,G!=null&&H.write(G),x&&H.end(),co.nextTick(m)},G=>{H.destroy(G),co.nextTick(m,G)});else if(Cr(g,!0))h++,Xo(g,H,m,{end:x});else if(Na(g)||wi(g)){const G=g.readable||g;h++,Xo(G,H,m,{end:x})}else throw new Ua("AsyncIterable or Promise","destination",g);g=H;const{destroy:Q,cleanup:P}=Cu(g,!1,!0);c.push(Q),D&&s.push(P)}}else if(ku(A)){if(ds(g)){h+=2;const H=Rb(g,A,m,{end:x});$a(A)&&D&&s.push(H)}else if(wi(g)||Na(g)){const H=g.readable||g;h++,Xo(H,A,m,{end:x})}else if(Cr(g))h++,Xo(g,A,m,{end:x});else throw new hc("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=A}else if(_b(A)){if(ds(g))h++,Ma(Ka(g),A,m,{end:x});else if(Na(g)||Cr(g))h++,Ma(g,A,m,{end:x});else if(wi(g))h++,Ma(g.readable,A,m,{end:x});else throw new hc("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=A}else g=Lu.from(A)}return(i!=null&&i.aborted||o!=null&&o.aborted)&&co.nextTick(a),g}function Rb(n,e,t,{end:r}){let i=!1;if(e.on("close",()=>{i||t(new bb)}),n.pipe(e,{end:!1}),r){let o=function(){i=!0,e.end()};xb(n)?co.nextTick(o):n.once("end",o)}else t();return Rs(n,{readable:!0,writable:!1},o=>{const s=n._readableState;o&&o.code==="ERR_STREAM_PREMATURE_CLOSE"&&s&&s.ended&&!s.errored&&!s.errorEmitted?n.once("end",t).once("error",t):t(o)}),Rs(e,{readable:!1,writable:!0},t)}var il={pipelineImpl:Zf,pipeline:Ib};const{pipeline:Ob}=il,Zo=Fn(),{destroyer:Bb}=$i,{isNodeStream:Qo,isReadable:Uu,isWritable:$u,isWebStream:Fa,isTransformStream:kr,isWritableStream:Nu,isReadableStream:Du}=zn,{AbortError:Lb,codes:{ERR_INVALID_ARG_VALUE:Pu,ERR_MISSING_ARGS:kb}}=St,Cb=wr;var Qf=function(...e){if(e.length===0)throw new kb("streams");if(e.length===1)return Zo.from(e[0]);const t=[...e];if(typeof e[0]=="function"&&(e[0]=Zo.from(e[0])),typeof e[e.length-1]=="function"){const E=e.length-1;e[E]=Zo.from(e[E])}for(let E=0;E<e.length;++E)if(!(!Qo(e[E])&&!Fa(e[E]))){if(E<e.length-1&&!(Uu(e[E])||Du(e[E])||kr(e[E])))throw new Pu(`streams[${E}]`,t[E],"must be readable");if(E>0&&!($u(e[E])||Nu(e[E])||kr(e[E])))throw new Pu(`streams[${E}]`,t[E],"must be writable")}let r,i,o,s,a;function l(E){const g=s;s=null,g?g(E):E?a.destroy(E):!m&&!h&&a.destroy()}const u=e[0],c=Ob(e,l),h=!!($u(u)||Nu(u)||kr(u)),m=!!(Uu(c)||Du(c)||kr(c));if(a=new Zo({writableObjectMode:!!(u!=null&&u.writableObjectMode),readableObjectMode:!!(c!=null&&c.writableObjectMode),writable:h,readable:m}),h){if(Qo(u))a._write=function(g,S,C){u.write(g,S)?C():r=C},a._final=function(g){u.end(),i=g},u.on("drain",function(){if(r){const g=r;r=null,g()}});else if(Fa(u)){const S=(kr(u)?u.writable:u).getWriter();a._write=async function(C,B,A){try{await S.ready,S.write(C).catch(()=>{}),A()}catch(O){A(O)}},a._final=async function(C){try{await S.ready,S.close().catch(()=>{}),i=C}catch(B){C(B)}}}const E=kr(c)?c.readable:c;Cb(E,()=>{if(i){const g=i;i=null,g()}})}if(m){if(Qo(c))c.on("readable",function(){if(o){const E=o;o=null,E()}}),c.on("end",function(){a.push(null)}),a._read=function(){for(;;){const E=c.read();if(E===null){o=a._read;return}if(!a.push(E))return}};else if(Fa(c)){const g=(kr(c)?c.readable:c).getReader();a._read=async function(){for(;;)try{const{value:S,done:C}=await g.read();if(!a.push(S))return;if(C){a.push(null);return}}catch{return}}}}return a._destroy=function(E,g){!E&&s!==null&&(E=new Lb),o=null,r=null,i=null,s===null?g(E):(s=g,Qo(c)&&Bb(c,E))},a};const eh=globalThis.AbortController||zc().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Ub,ERR_INVALID_ARG_TYPE:Oo,ERR_MISSING_ARGS:$b,ERR_OUT_OF_RANGE:Nb},AbortError:gn}=St,{validateAbortSignal:ri,validateInteger:Db,validateObject:ii}=Hs,Pb=ot.Symbol("kWeak"),{finished:Kb}=wr,Mb=Qf,{addAbortSignalNoValidate:Fb}=Js,{isWritable:jb,isNodeStream:Hb}=zn,{ArrayPrototypePush:Vb,MathFloor:Wb,Number:qb,NumberIsNaN:zb,Promise:Ku,PromiseReject:Mu,PromisePrototypeThen:Gb,Symbol:th}=ot,Os=th("kEmpty"),Fu=th("kEof");function Yb(n,e){if(e!=null&&ii(e,"options"),(e==null?void 0:e.signal)!=null&&ri(e.signal,"options.signal"),Hb(n)&&!jb(n))throw new Ub("stream",n,"must be writable");const t=Mb(this,n);return e!=null&&e.signal&&Fb(e.signal,t),t}function Zs(n,e){if(typeof n!="function")throw new Oo("fn",["Function","AsyncFunction"],n);e!=null&&ii(e,"options"),(e==null?void 0:e.signal)!=null&&ri(e.signal,"options.signal");let t=1;return(e==null?void 0:e.concurrency)!=null&&(t=Wb(e.concurrency)),Db(t,"concurrency",1),(async function*(){var i,o;const s=new eh,a=this,l=[],u=s.signal,c={signal:u},h=()=>s.abort();e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted&&h(),e==null||(o=e.signal)===null||o===void 0||o.addEventListener("abort",h);let m,E,g=!1;function S(){g=!0}async function C(){try{for await(let O of a){var B;if(g)return;if(u.aborted)throw new gn;try{O=n(O,c)}catch(I){O=Mu(I)}O!==Os&&(typeof((B=O)===null||B===void 0?void 0:B.catch)=="function"&&O.catch(S),l.push(O),m&&(m(),m=null),!g&&l.length&&l.length>=t&&await new Ku(I=>{E=I}))}l.push(Fu)}catch(O){const I=Mu(O);Gb(I,void 0,S),l.push(I)}finally{var A;g=!0,m&&(m(),m=null),e==null||(A=e.signal)===null||A===void 0||A.removeEventListener("abort",h)}}C();try{for(;;){for(;l.length>0;){const B=await l[0];if(B===Fu)return;if(u.aborted)throw new gn;B!==Os&&(yield B),l.shift(),E&&(E(),E=null)}await new Ku(B=>{m=B})}}finally{s.abort(),g=!0,E&&(E(),E=null)}}).call(this)}function Jb(n=void 0){return n!=null&&ii(n,"options"),(n==null?void 0:n.signal)!=null&&ri(n.signal,"options.signal"),(async function*(){let t=0;for await(const i of this){var r;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted)throw new gn({cause:n.signal.reason});yield[t++,i]}}).call(this)}async function nh(n,e=void 0){for await(const t of ol.call(this,n,e))return!0;return!1}async function Xb(n,e=void 0){if(typeof n!="function")throw new Oo("fn",["Function","AsyncFunction"],n);return!await nh.call(this,async(...t)=>!await n(...t),e)}async function Zb(n,e){for await(const t of ol.call(this,n,e))return t}async function Qb(n,e){if(typeof n!="function")throw new Oo("fn",["Function","AsyncFunction"],n);async function t(r,i){return await n(r,i),Os}for await(const r of Zs.call(this,t,e));}function ol(n,e){if(typeof n!="function")throw new Oo("fn",["Function","AsyncFunction"],n);async function t(r,i){return await n(r,i)?r:Os}return Zs.call(this,t,e)}class ev extends $b{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function tv(n,e,t){var r;if(typeof n!="function")throw new Oo("reducer",["Function","AsyncFunction"],n);t!=null&&ii(t,"options"),(t==null?void 0:t.signal)!=null&&ri(t.signal,"options.signal");let i=arguments.length>1;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted){const u=new gn(void 0,{cause:t.signal.reason});throw this.once("error",()=>{}),await Kb(this.destroy(u)),u}const o=new eh,s=o.signal;if(t!=null&&t.signal){const u={once:!0,[Pb]:this};t.signal.addEventListener("abort",()=>o.abort(),u)}let a=!1;try{for await(const u of this){var l;if(a=!0,t!=null&&(l=t.signal)!==null&&l!==void 0&&l.aborted)throw new gn;i?e=await n(e,u,{signal:s}):(e=u,i=!0)}if(!a&&!i)throw new ev}finally{o.abort()}return e}async function nv(n){n!=null&&ii(n,"options"),(n==null?void 0:n.signal)!=null&&ri(n.signal,"options.signal");const e=[];for await(const r of this){var t;if(n!=null&&(t=n.signal)!==null&&t!==void 0&&t.aborted)throw new gn(void 0,{cause:n.signal.reason});Vb(e,r)}return e}function rv(n,e){const t=Zs.call(this,n,e);return(async function*(){for await(const i of t)yield*i}).call(this)}function rh(n){if(n=qb(n),zb(n))return 0;if(n<0)throw new Nb("number",">= 0",n);return n}function iv(n,e=void 0){return e!=null&&ii(e,"options"),(e==null?void 0:e.signal)!=null&&ri(e.signal,"options.signal"),n=rh(n),(async function*(){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new gn;for await(const o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new gn;n--<=0&&(yield o)}}).call(this)}function ov(n,e=void 0){return e!=null&&ii(e,"options"),(e==null?void 0:e.signal)!=null&&ri(e.signal,"options.signal"),n=rh(n),(async function*(){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new gn;for await(const o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new gn;if(n-- >0)yield o;else return}}).call(this)}qc.streamReturningOperators={asIndexedPairs:Jb,drop:iv,filter:ol,flatMap:rv,map:Zs,take:ov,compose:Yb};qc.promiseReturningOperators={every:Xb,forEach:Qb,reduce:tv,toArray:nv,some:nh,find:Zb};var ja,ju;function ih(){if(ju)return ja;ju=1;const{ArrayPrototypePop:n,Promise:e}=ot,{isIterable:t,isNodeStream:r,isWebStream:i}=zn,{pipelineImpl:o}=il,{finished:s}=wr;oh();function a(...l){return new e((u,c)=>{let h,m;const E=l[l.length-1];if(E&&typeof E=="object"&&!r(E)&&!t(E)&&!i(E)){const g=n(l);h=g.signal,m=g.end}o(l,(g,S)=>{g?c(g):u(S)},{signal:h,end:m})})}return ja={finished:s,pipeline:a},ja}var Hu;function oh(){if(Hu)return Aa.exports;Hu=1;const{Buffer:n}=Wt,{ObjectDefineProperty:e,ObjectKeys:t,ReflectApply:r}=ot,{promisify:{custom:i}}=Wn,{streamReturningOperators:o,promiseReturningOperators:s}=qc,{codes:{ERR_ILLEGAL_CONSTRUCTOR:a}}=St,l=Qf,{pipeline:u}=il,{destroyer:c}=$i,h=wr,m=ih(),E=zn,g=Aa.exports=Qc.Stream;g.isDisturbed=E.isDisturbed,g.isErrored=E.isErrored,g.isReadable=E.isReadable,g.Readable=Xs();for(const C of t(o)){let A=function(...O){if(new.target)throw a();return g.Readable.from(r(B,this,O))};const B=o[C];e(A,"name",{__proto__:null,value:B.name}),e(A,"length",{__proto__:null,value:B.length}),e(g.Readable.prototype,C,{__proto__:null,value:A,enumerable:!1,configurable:!0,writable:!0})}for(const C of t(s)){let A=function(...O){if(new.target)throw a();return r(B,this,O)};const B=s[C];e(A,"name",{__proto__:null,value:B.name}),e(A,"length",{__proto__:null,value:B.length}),e(g.Readable.prototype,C,{__proto__:null,value:A,enumerable:!1,configurable:!0,writable:!0})}g.Writable=zf(),g.Duplex=Fn(),g.Transform=Yf,g.PassThrough=Xf,g.pipeline=u;const{addAbortSignal:S}=Js;return g.addAbortSignal=S,g.finished=h,g.destroy=c,g.compose=l,e(g,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return m}}),e(u,i,{__proto__:null,enumerable:!0,get(){return m.pipeline}}),e(h,i,{__proto__:null,enumerable:!0,get(){return m.finished}}),g.Stream=g,g._isUint8Array=function(B){return B instanceof Uint8Array},g._uint8ArrayToBuffer=function(B){return n.from(B.buffer,B.byteOffset,B.byteLength)},Aa.exports}(function(n){const e=oh(),t=ih(),r=e.Readable.destroy;n.exports=e.Readable,n.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,n.exports._isUint8Array=e._isUint8Array,n.exports.isDisturbed=e.isDisturbed,n.exports.isErrored=e.isErrored,n.exports.isReadable=e.isReadable,n.exports.Readable=e.Readable,n.exports.Writable=e.Writable,n.exports.Duplex=e.Duplex,n.exports.Transform=e.Transform,n.exports.PassThrough=e.PassThrough,n.exports.addAbortSignal=e.addAbortSignal,n.exports.finished=e.finished,n.exports.destroy=e.destroy,n.exports.destroy=r,n.exports.pipeline=e.pipeline,n.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return t}}),n.exports.Stream=e.Stream,n.exports.default=n.exports})(F0);function Vu(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function sv(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function sh(n,...e){if(!sv(n))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function av(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Vu(n.outputLen),Vu(n.blockLen)}function Bs(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function cv(n,e){sh(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Ha=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ah(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}const Va=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),rn=(n,e)=>n<<32-e|n>>>e,lv=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!lv)throw new Error("Non little-endian hardware is not supported");function ch(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function sl(n){if(typeof n=="string"&&(n=ch(n)),!ah(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function lh(...n){let e=0;for(let r=0;r<n.length;r++){const i=n[r];if(!ah(i))throw new Error("Uint8Array expected");e+=i.length}const t=new Uint8Array(e);for(let r=0,i=0;r<n.length;r++){const o=n[r];t.set(o,i),i+=o.length}return t}class uh{clone(){return this._cloneInto()}}function dh(n){const e=r=>n().update(sl(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function al(n=32){if(Ha&&typeof Ha.getRandomValues=="function")return Ha.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}function uv(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),l=r?4:0,u=r?0:4;n.setUint32(e+l,s,r),n.setUint32(e+u,a,r)}class fh extends uh{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Va(this.buffer)}update(e){Bs(this);const{view:t,buffer:r,blockLen:i}=this;e=sl(e);const o=e.length;for(let s=0;s<o;){const a=Math.min(i-this.pos,o-s);if(a===i){const l=Va(e);for(;i<=o-s;s+=i)this.process(l,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Bs(this),cv(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:o}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let h=s;h<i;h++)t[h]=0;uv(r,i-8,BigInt(this.length*8),o),this.process(r,0);const a=Va(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=l/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,c[h],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%t&&e.buffer.set(r),e}}const dv=(n,e,t)=>n&e^~n&t,fv=(n,e,t)=>n&e^n&t^e&t,hv=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Qn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=new Uint32Array(64);class yv extends fh{constructor(){super(64,32,8,!1),this.A=Qn[0]|0,this.B=Qn[1]|0,this.C=Qn[2]|0,this.D=Qn[3]|0,this.E=Qn[4]|0,this.F=Qn[5]|0,this.G=Qn[6]|0,this.H=Qn[7]|0}get(){const{A:e,B:t,C:r,D:i,E:o,F:s,G:a,H:l}=this;return[e,t,r,i,o,s,a,l]}set(e,t,r,i,o,s,a,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=l|0}process(e,t){for(let h=0;h<16;h++,t+=4)er[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const m=er[h-15],E=er[h-2],g=rn(m,7)^rn(m,18)^m>>>3,S=rn(E,17)^rn(E,19)^E>>>10;er[h]=S+er[h-7]+g+er[h-16]|0}let{A:r,B:i,C:o,D:s,E:a,F:l,G:u,H:c}=this;for(let h=0;h<64;h++){const m=rn(a,6)^rn(a,11)^rn(a,25),E=c+m+dv(a,l,u)+hv[h]+er[h]|0,S=(rn(r,2)^rn(r,13)^rn(r,22))+fv(r,i,o)|0;c=u,u=l,l=a,a=s+E|0,s=o,o=i,i=r,r=E+S|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,l=l+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(r,i,o,s,a,l,u,c)}roundClean(){er.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Yr=dh(()=>new yv);var pv=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class hh{static digest({data:e}){return pv(this,void 0,void 0,function*(){return Yr(e)})}}class cl{}var gv=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class wv extends cl{digest({algorithm:e,data:t}){return gv(this,void 0,void 0,function*(){switch(e){case"SHA-256":return yield hh.digest({data:t})}})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yh=BigInt(0),Qs=BigInt(1),bv=BigInt(2);function wn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}const vv=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Jr(n){if(!wn(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=vv[n[t]];return e}function ph(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function ll(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}const Bn={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Wu(n){if(n>=Bn._0&&n<=Bn._9)return n-Bn._0;if(n>=Bn._A&&n<=Bn._F)return n-(Bn._A-10);if(n>=Bn._a&&n<=Bn._f)return n-(Bn._a-10)}function Li(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length,t=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let i=0,o=0;i<t;i++,o+=2){const s=Wu(n.charCodeAt(o)),a=Wu(n.charCodeAt(o+1));if(s===void 0||a===void 0){const l=n[o]+n[o+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+o)}r[i]=s*16+a}return r}function Vr(n){return ll(Jr(n))}function dr(n){if(!wn(n))throw new Error("Uint8Array expected");return ll(Jr(Uint8Array.from(n).reverse()))}function bn(n,e){return Li(n.toString(16).padStart(e*2,"0"))}function ki(n,e){return bn(n,e).reverse()}function mv(n){return Li(ph(n))}function Qe(n,e,t){let r;if(typeof e=="string")try{r=Li(e)}catch(o){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${o}`)}else if(wn(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const i=r.length;if(typeof t=="number"&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function Xr(...n){let e=0;for(let i=0;i<n.length;i++){const o=n[i];if(!wn(o))throw new Error("Uint8Array expected");e+=o.length}let t=new Uint8Array(e),r=0;for(let i=0;i<n.length;i++){const o=n[i];t.set(o,r),r+=o.length}return t}function Ev(n,e){if(n.length!==e.length)return!1;let t=0;for(let r=0;r<n.length;r++)t|=n[r]^e[r];return t===0}function _v(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function xv(n){let e;for(e=0;n>yh;n>>=Qs,e+=1);return e}function Sv(n,e){return n>>BigInt(e)&Qs}const Av=(n,e,t)=>n|(t?Qs:yh)<<BigInt(e),ul=n=>(bv<<BigInt(n-1))-Qs,Wa=n=>new Uint8Array(n),qu=n=>Uint8Array.from(n);function gh(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=Wa(n),i=Wa(n),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=(...h)=>t(i,r,...h),l=(h=Wa())=>{i=a(qu([0]),h),r=a(),h.length!==0&&(i=a(qu([1]),h),r=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const m=[];for(;h<e;){r=a();const E=r.slice();m.push(E),h+=r.length}return Xr(...m)};return(h,m)=>{s(),l(h);let E;for(;!(E=m(u()));)l();return s(),E}}const Tv={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||wn(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function oi(n,e,t={}){const r=(i,o,s)=>{const a=Tv[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);const l=n[i];if(!(s&&l===void 0)&&!a(l,n))throw new Error(`Invalid param ${String(i)}=${l} (${typeof l}), expected ${o}`)};for(const[i,o]of Object.entries(e))r(i,o,!1);for(const[i,o]of Object.entries(t))r(i,o,!0);return n}const Iv=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Sv,bitLen:xv,bitMask:ul,bitSet:Av,bytesToHex:Jr,bytesToNumberBE:Vr,bytesToNumberLE:dr,concatBytes:Xr,createHmacDrbg:gh,ensureBytes:Qe,equalBytes:Ev,hexToBytes:Li,hexToNumber:ll,isBytes:wn,numberToBytesBE:bn,numberToBytesLE:ki,numberToHexUnpadded:ph,numberToVarBytesBE:mv,utf8ToBytes:_v,validateObject:oi},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lt=BigInt(0),qe=BigInt(1),Nr=BigInt(2),Rv=BigInt(3),yc=BigInt(4),zu=BigInt(5),Gu=BigInt(8);BigInt(9);BigInt(16);function Me(n,e){const t=n%e;return t>=lt?t:e+t}function wh(n,e,t){if(t<=lt||e<lt)throw new Error("Expected power/modulo > 0");if(t===qe)return lt;let r=qe;for(;e>lt;)e&qe&&(r=r*n%t),n=n*n%t,e>>=qe;return r}function Ve(n,e,t){let r=n;for(;e-- >lt;)r*=r,r%=t;return r}function pc(n,e){if(n===lt||e<=lt)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=Me(n,e),r=e,i=lt,o=qe;for(;t!==lt;){const a=r/t,l=r%t,u=i-o*a;r=t,t=l,i=o,o=u}if(r!==qe)throw new Error("invert: does not exist");return Me(i,e)}function Ov(n){const e=(n-qe)/Nr;let t,r,i;for(t=n-qe,r=0;t%Nr===lt;t/=Nr,r++);for(i=Nr;i<n&&wh(i,e,n)!==n-qe;i++);if(r===1){const s=(n+qe)/yc;return function(l,u){const c=l.pow(u,s);if(!l.eql(l.sqr(c),u))throw new Error("Cannot find square root");return c}}const o=(t+qe)/Nr;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=r,c=a.pow(a.mul(a.ONE,i),t),h=a.pow(l,o),m=a.pow(l,t);for(;!a.eql(m,a.ONE);){if(a.eql(m,a.ZERO))return a.ZERO;let E=1;for(let S=a.sqr(m);E<u&&!a.eql(S,a.ONE);E++)S=a.sqr(S);const g=a.pow(c,qe<<BigInt(u-E-1));c=a.sqr(g),h=a.mul(h,g),m=a.mul(m,c),u=E}return h}}function Bv(n){if(n%yc===Rv){const e=(n+qe)/yc;return function(r,i){const o=r.pow(i,e);if(!r.eql(r.sqr(o),i))throw new Error("Cannot find square root");return o}}if(n%Gu===zu){const e=(n-zu)/Gu;return function(r,i){const o=r.mul(i,Nr),s=r.pow(o,e),a=r.mul(i,s),l=r.mul(r.mul(a,Nr),s),u=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(u),i))throw new Error("Cannot find square root");return u}}return Ov(n)}const Lv=(n,e)=>(Me(n,e)&qe)===qe,kv=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Cv(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=kv.reduce((r,i)=>(r[i]="function",r),e);return oi(n,t)}function Uv(n,e,t){if(t<lt)throw new Error("Expected power > 0");if(t===lt)return n.ONE;if(t===qe)return e;let r=n.ONE,i=e;for(;t>lt;)t&qe&&(r=n.mul(r,i)),i=n.sqr(i),t>>=qe;return r}function $v(n,e){const t=new Array(e.length),r=e.reduce((o,s,a)=>n.is0(s)?o:(t[a]=o,n.mul(o,s)),n.ONE),i=n.inv(r);return e.reduceRight((o,s,a)=>n.is0(s)?o:(t[a]=n.mul(o,t[a]),n.mul(o,s)),i),t}function bh(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function dl(n,e,t=!1,r={}){if(n<=lt)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:o}=bh(n,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Bv(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:o,MASK:ul(i),ZERO:lt,ONE:qe,create:l=>Me(l,n),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return lt<=l&&l<n},is0:l=>l===lt,isOdd:l=>(l&qe)===qe,neg:l=>Me(-l,n),eql:(l,u)=>l===u,sqr:l=>Me(l*l,n),add:(l,u)=>Me(l+u,n),sub:(l,u)=>Me(l-u,n),mul:(l,u)=>Me(l*u,n),pow:(l,u)=>Uv(a,l,u),div:(l,u)=>Me(l*pc(u,n),n),sqrN:l=>l*l,addN:(l,u)=>l+u,subN:(l,u)=>l-u,mulN:(l,u)=>l*u,inv:l=>pc(l,n),sqrt:r.sqrt||(l=>s(a,l)),invertBatch:l=>$v(a,l),cmov:(l,u,c)=>c?u:l,toBytes:l=>t?ki(l,o):bn(l,o),fromBytes:l=>{if(l.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${l.length}`);return t?dr(l):Vr(l)}});return Object.freeze(a)}function Nv(n,e){if(!n.isOdd)throw new Error("Field doesn't have isOdd");const t=n.sqrt(e);return n.isOdd(t)?n.neg(t):t}function vh(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function mh(n){const e=vh(n);return e+Math.ceil(e/2)}function Dv(n,e,t=!1){const r=n.length,i=vh(e),o=mh(e);if(r<16||r<o||r>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${r}`);const s=t?Vr(n):dr(n),a=Me(s,e-qe)+qe;return t?ki(a,i):bn(a,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Pv=BigInt(0),qa=BigInt(1);function Eh(n,e){const t=(i,o)=>{const s=o.negate();return i?s:o},r=i=>{const o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:t,unsafeLadder(i,o){let s=n.ZERO,a=i;for(;o>Pv;)o&qa&&(s=s.add(a)),a=a.double(),o>>=qa;return s},precomputeWindow(i,o){const{windows:s,windowSize:a}=r(o),l=[];let u=i,c=u;for(let h=0;h<s;h++){c=u,l.push(c);for(let m=1;m<a;m++)c=c.add(u),l.push(c);u=c.double()}return l},wNAF(i,o,s){const{windows:a,windowSize:l}=r(i);let u=n.ZERO,c=n.BASE;const h=BigInt(2**i-1),m=2**i,E=BigInt(i);for(let g=0;g<a;g++){const S=g*l;let C=Number(s&h);s>>=E,C>l&&(C-=m,s+=qa);const B=S,A=S+Math.abs(C)-1,O=g%2!==0,I=C<0;C===0?c=c.add(t(O,o[B])):u=u.add(t(I,o[A]))}return{p:u,f:c}},wNAFCached(i,o,s,a){const l=i._WINDOW_SIZE||1;let u=o.get(i);return u||(u=this.precomputeWindow(i,l),l!==1&&o.set(i,a(u))),this.wNAF(l,u,s)}}}function fl(n){return Cv(n.Fp),oi(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...bh(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Kv(n){const e=fl(n);oi(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Mv,hexToBytes:Fv}=Iv,Mr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=Mr;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Mv(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=Mr,t=typeof n=="string"?Fv(n):n;if(!wn(t))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:o}=Mr._parseInt(t.subarray(2)),{d:s,l:a}=Mr._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(n){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,t=u=>{const c=u.toString(16);return c.length&1?`0${c}`:c},r=e(t(n.s)),i=e(t(n.r)),o=r.length/2,s=i.length/2,a=t(o),l=t(s);return`30${t(s+o+4)}02${l}${i}02${a}${r}`}},Dn=BigInt(0),Mt=BigInt(1);BigInt(2);const Yu=BigInt(3);BigInt(4);function jv(n){const e=Kv(n),{Fp:t}=e,r=e.toBytes||((g,S,C)=>{const B=S.toAffine();return Xr(Uint8Array.from([4]),t.toBytes(B.x),t.toBytes(B.y))}),i=e.fromBytes||(g=>{const S=g.subarray(1),C=t.fromBytes(S.subarray(0,t.BYTES)),B=t.fromBytes(S.subarray(t.BYTES,2*t.BYTES));return{x:C,y:B}});function o(g){const{a:S,b:C}=e,B=t.sqr(g),A=t.mul(B,g);return t.add(t.add(A,t.mul(g,S)),C)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(g){return typeof g=="bigint"&&Dn<g&&g<e.n}function a(g){if(!s(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(g){const{allowedPrivateKeyLengths:S,nByteLength:C,wrapPrivateKey:B,n:A}=e;if(S&&typeof g!="bigint"){if(wn(g)&&(g=Jr(g)),typeof g!="string"||!S.includes(g.length))throw new Error("Invalid key");g=g.padStart(C*2,"0")}let O;try{O=typeof g=="bigint"?g:Vr(Qe("private key",g,C))}catch{throw new Error(`private key must be ${C} bytes, hex or bigint, not ${typeof g}`)}return B&&(O=Me(O,A)),a(O),O}const u=new Map;function c(g){if(!(g instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(S,C,B){if(this.px=S,this.py=C,this.pz=B,S==null||!t.isValid(S))throw new Error("x required");if(C==null||!t.isValid(C))throw new Error("y required");if(B==null||!t.isValid(B))throw new Error("z required")}static fromAffine(S){const{x:C,y:B}=S||{};if(!S||!t.isValid(C)||!t.isValid(B))throw new Error("invalid affine point");if(S instanceof h)throw new Error("projective point not allowed");const A=O=>t.eql(O,t.ZERO);return A(C)&&A(B)?h.ZERO:new h(C,B,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(S){const C=t.invertBatch(S.map(B=>B.pz));return S.map((B,A)=>B.toAffine(C[A])).map(h.fromAffine)}static fromHex(S){const C=h.fromAffine(i(Qe("pointHex",S)));return C.assertValidity(),C}static fromPrivateKey(S){return h.BASE.multiply(l(S))}_setWindowSize(S){this._WINDOW_SIZE=S,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:S,y:C}=this.toAffine();if(!t.isValid(S)||!t.isValid(C))throw new Error("bad point: x or y not FE");const B=t.sqr(C),A=o(S);if(!t.eql(B,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:S}=this.toAffine();if(t.isOdd)return!t.isOdd(S);throw new Error("Field doesn't support isOdd")}equals(S){c(S);const{px:C,py:B,pz:A}=this,{px:O,py:I,pz:x}=S,D=t.eql(t.mul(C,x),t.mul(O,A)),H=t.eql(t.mul(B,x),t.mul(I,A));return D&&H}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:S,b:C}=e,B=t.mul(C,Yu),{px:A,py:O,pz:I}=this;let x=t.ZERO,D=t.ZERO,H=t.ZERO,z=t.mul(A,A),Q=t.mul(O,O),P=t.mul(I,I),G=t.mul(A,O);return G=t.add(G,G),H=t.mul(A,I),H=t.add(H,H),x=t.mul(S,H),D=t.mul(B,P),D=t.add(x,D),x=t.sub(Q,D),D=t.add(Q,D),D=t.mul(x,D),x=t.mul(G,x),H=t.mul(B,H),P=t.mul(S,P),G=t.sub(z,P),G=t.mul(S,G),G=t.add(G,H),H=t.add(z,z),z=t.add(H,z),z=t.add(z,P),z=t.mul(z,G),D=t.add(D,z),P=t.mul(O,I),P=t.add(P,P),z=t.mul(P,G),x=t.sub(x,z),H=t.mul(P,Q),H=t.add(H,H),H=t.add(H,H),new h(x,D,H)}add(S){c(S);const{px:C,py:B,pz:A}=this,{px:O,py:I,pz:x}=S;let D=t.ZERO,H=t.ZERO,z=t.ZERO;const Q=e.a,P=t.mul(e.b,Yu);let G=t.mul(C,O),ie=t.mul(B,I),ee=t.mul(A,x),oe=t.add(C,B),K=t.add(O,I);oe=t.mul(oe,K),K=t.add(G,ie),oe=t.sub(oe,K),K=t.add(C,A);let J=t.add(O,x);return K=t.mul(K,J),J=t.add(G,ee),K=t.sub(K,J),J=t.add(B,A),D=t.add(I,x),J=t.mul(J,D),D=t.add(ie,ee),J=t.sub(J,D),z=t.mul(Q,K),D=t.mul(P,ee),z=t.add(D,z),D=t.sub(ie,z),z=t.add(ie,z),H=t.mul(D,z),ie=t.add(G,G),ie=t.add(ie,G),ee=t.mul(Q,ee),K=t.mul(P,K),ie=t.add(ie,ee),ee=t.sub(G,ee),ee=t.mul(Q,ee),K=t.add(K,ee),G=t.mul(ie,K),H=t.add(H,G),G=t.mul(J,K),D=t.mul(oe,D),D=t.sub(D,G),G=t.mul(oe,ie),z=t.mul(J,z),z=t.add(z,G),new h(D,H,z)}subtract(S){return this.add(S.negate())}is0(){return this.equals(h.ZERO)}wNAF(S){return E.wNAFCached(this,u,S,C=>{const B=t.invertBatch(C.map(A=>A.pz));return C.map((A,O)=>A.toAffine(B[O])).map(h.fromAffine)})}multiplyUnsafe(S){const C=h.ZERO;if(S===Dn)return C;if(a(S),S===Mt)return this;const{endo:B}=e;if(!B)return E.unsafeLadder(this,S);let{k1neg:A,k1:O,k2neg:I,k2:x}=B.splitScalar(S),D=C,H=C,z=this;for(;O>Dn||x>Dn;)O&Mt&&(D=D.add(z)),x&Mt&&(H=H.add(z)),z=z.double(),O>>=Mt,x>>=Mt;return A&&(D=D.negate()),I&&(H=H.negate()),H=new h(t.mul(H.px,B.beta),H.py,H.pz),D.add(H)}multiply(S){a(S);let C=S,B,A;const{endo:O}=e;if(O){const{k1neg:I,k1:x,k2neg:D,k2:H}=O.splitScalar(C);let{p:z,f:Q}=this.wNAF(x),{p:P,f:G}=this.wNAF(H);z=E.constTimeNegate(I,z),P=E.constTimeNegate(D,P),P=new h(t.mul(P.px,O.beta),P.py,P.pz),B=z.add(P),A=Q.add(G)}else{const{p:I,f:x}=this.wNAF(C);B=I,A=x}return h.normalizeZ([B,A])[0]}multiplyAndAddUnsafe(S,C,B){const A=h.BASE,O=(x,D)=>D===Dn||D===Mt||!x.equals(A)?x.multiplyUnsafe(D):x.multiply(D),I=O(this,C).add(O(S,B));return I.is0()?void 0:I}toAffine(S){const{px:C,py:B,pz:A}=this,O=this.is0();S==null&&(S=O?t.ONE:t.inv(A));const I=t.mul(C,S),x=t.mul(B,S),D=t.mul(A,S);if(O)return{x:t.ZERO,y:t.ZERO};if(!t.eql(D,t.ONE))throw new Error("invZ was invalid");return{x:I,y:x}}isTorsionFree(){const{h:S,isTorsionFree:C}=e;if(S===Mt)return!0;if(C)return C(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:S,clearCofactor:C}=e;return S===Mt?this:C?C(h,this):this.multiplyUnsafe(e.h)}toRawBytes(S=!0){return this.assertValidity(),r(h,this,S)}toHex(S=!0){return Jr(this.toRawBytes(S))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const m=e.nBitLength,E=Eh(h,e.endo?Math.ceil(m/2):m);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:o,isWithinCurveOrder:s}}function Hv(n){const e=fl(n);return oi(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Vv(n){const e=Hv(n),{Fp:t,n:r}=e,i=t.BYTES+1,o=2*t.BYTES+1;function s(K){return Dn<K&&K<t.ORDER}function a(K){return Me(K,r)}function l(K){return pc(K,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:m}=jv({...e,toBytes(K,J,ne){const j=J.toAffine(),$=t.toBytes(j.x),N=Xr;return ne?N(Uint8Array.from([J.hasEvenY()?2:3]),$):N(Uint8Array.from([4]),$,t.toBytes(j.y))},fromBytes(K){const J=K.length,ne=K[0],j=K.subarray(1);if(J===i&&(ne===2||ne===3)){const $=Vr(j);if(!s($))throw new Error("Point is not on curve");const N=h($);let X=t.sqrt(N);const te=(X&Mt)===Mt;return(ne&1)===1!==te&&(X=t.neg(X)),{x:$,y:X}}else if(J===o&&ne===4){const $=t.fromBytes(j.subarray(0,t.BYTES)),N=t.fromBytes(j.subarray(t.BYTES,2*t.BYTES));return{x:$,y:N}}else throw new Error(`Point of length ${J} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),E=K=>Jr(bn(K,e.nByteLength));function g(K){const J=r>>Mt;return K>J}function S(K){return g(K)?a(-K):K}const C=(K,J,ne)=>Vr(K.slice(J,ne));class B{constructor(J,ne,j){this.r=J,this.s=ne,this.recovery=j,this.assertValidity()}static fromCompact(J){const ne=e.nByteLength;return J=Qe("compactSignature",J,ne*2),new B(C(J,0,ne),C(J,ne,2*ne))}static fromDER(J){const{r:ne,s:j}=Mr.toSig(Qe("DER",J));return new B(ne,j)}assertValidity(){if(!m(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!m(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(J){return new B(this.r,this.s,J)}recoverPublicKey(J){const{r:ne,s:j,recovery:$}=this,N=H(Qe("msgHash",J));if($==null||![0,1,2,3].includes($))throw new Error("recovery id invalid");const X=$===2||$===3?ne+e.n:ne;if(X>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const te=$&1?"03":"02",le=u.fromHex(te+E(X)),he=l(X),we=a(-N*he),ue=a(j*he),ae=u.BASE.multiplyAndAddUnsafe(le,we,ue);if(!ae)throw new Error("point at infinify");return ae.assertValidity(),ae}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new B(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Li(this.toDERHex())}toDERHex(){return Mr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Li(this.toCompactHex())}toCompactHex(){return E(this.r)+E(this.s)}}const A={isValidPrivateKey(K){try{return c(K),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const K=mh(e.n);return Dv(e.randomBytes(K),e.n)},precompute(K=8,J=u.BASE){return J._setWindowSize(K),J.multiply(BigInt(3)),J}};function O(K,J=!0){return u.fromPrivateKey(K).toRawBytes(J)}function I(K){const J=wn(K),ne=typeof K=="string",j=(J||ne)&&K.length;return J?j===i||j===o:ne?j===2*i||j===2*o:K instanceof u}function x(K,J,ne=!0){if(I(K))throw new Error("first arg must be private key");if(!I(J))throw new Error("second arg must be public key");return u.fromHex(J).multiply(c(K)).toRawBytes(ne)}const D=e.bits2int||function(K){const J=Vr(K),ne=K.length*8-e.nBitLength;return ne>0?J>>BigInt(ne):J},H=e.bits2int_modN||function(K){return a(D(K))},z=ul(e.nBitLength);function Q(K){if(typeof K!="bigint")throw new Error("bigint expected");if(!(Dn<=K&&K<z))throw new Error(`bigint expected < 2^${e.nBitLength}`);return bn(K,e.nByteLength)}function P(K,J,ne=G){if(["recovered","canonical"].some(Ee=>Ee in ne))throw new Error("sign() legacy options not supported");const{hash:j,randomBytes:$}=e;let{lowS:N,prehash:X,extraEntropy:te}=ne;N==null&&(N=!0),K=Qe("msgHash",K),X&&(K=Qe("prehashed msgHash",j(K)));const le=H(K),he=c(J),we=[Q(he),Q(le)];if(te!=null){const Ee=te===!0?$(t.BYTES):te;we.push(Qe("extraEntropy",Ee))}const ue=Xr(...we),ae=le;function ve(Ee){const Ne=D(Ee);if(!m(Ne))return;const ke=l(Ne),Ce=u.BASE.multiply(Ne).toAffine(),L=a(Ce.x);if(L===Dn)return;const U=a(ke*a(ae+L*he));if(U===Dn)return;let V=(Ce.x===L?0:2)|Number(Ce.y&Mt),y=U;return N&&g(U)&&(y=S(U),V^=1),new B(L,y,V)}return{seed:ue,k2sig:ve}}const G={lowS:e.lowS,prehash:!1},ie={lowS:e.lowS,prehash:!1};function ee(K,J,ne=G){const{seed:j,k2sig:$}=P(K,J,ne),N=e;return gh(N.hash.outputLen,N.nByteLength,N.hmac)(j,$)}u.BASE._setWindowSize(8);function oe(K,J,ne,j=ie){var Ce;const $=K;if(J=Qe("msgHash",J),ne=Qe("publicKey",ne),"strict"in j)throw new Error("options.strict was renamed to lowS");const{lowS:N,prehash:X}=j;let te,le;try{if(typeof $=="string"||wn($))try{te=B.fromDER($)}catch(L){if(!(L instanceof Mr.Err))throw L;te=B.fromCompact($)}else if(typeof $=="object"&&typeof $.r=="bigint"&&typeof $.s=="bigint"){const{r:L,s:U}=$;te=new B(L,U)}else throw new Error("PARSE");le=u.fromHex(ne)}catch(L){if(L.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(N&&te.hasHighS())return!1;X&&(J=e.hash(J));const{r:he,s:we}=te,ue=H(J),ae=l(we),ve=a(ue*ae),Ee=a(he*ae),Ne=(Ce=u.BASE.multiplyAndAddUnsafe(le,ve,Ee))==null?void 0:Ce.toAffine();return Ne?a(Ne.x)===he:!1}return{CURVE:e,getPublicKey:O,getSharedSecret:x,sign:ee,verify:oe,ProjectivePoint:u,Signature:B,utils:A}}class _h extends uh{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,av(e);const r=sl(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?e.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Bs(this),this.iHash.update(e),this}digestInto(e){Bs(this),sh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const xh=(n,e,t)=>new _h(n,e).update(t).digest();xh.create=(n,e)=>new _h(n,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Wv(n){return{hash:n,hmac:(e,...t)=>xh(n,e,lh(...t)),randomBytes:al}}function Sh(n,e){const t=r=>Vv({...n,...Wv(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ah=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ju=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),qv=BigInt(1),gc=BigInt(2),Xu=(n,e)=>(n+e/gc)/e;function zv(n){const e=Ah,t=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),l=BigInt(88),u=n*n*n%e,c=u*u*n%e,h=Ve(c,t,e)*c%e,m=Ve(h,t,e)*c%e,E=Ve(m,gc,e)*u%e,g=Ve(E,i,e)*E%e,S=Ve(g,o,e)*g%e,C=Ve(S,a,e)*S%e,B=Ve(C,l,e)*C%e,A=Ve(B,a,e)*S%e,O=Ve(A,t,e)*c%e,I=Ve(O,s,e)*g%e,x=Ve(I,r,e)*u%e,D=Ve(x,gc,e);if(!wc.eql(wc.sqr(D),n))throw new Error("Cannot find square root");return D}const wc=dl(Ah,void 0,void 0,{sqrt:zv}),Ot=Sh({a:BigInt(0),b:BigInt(7),Fp:wc,n:Ju,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=Ju,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-qv*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=t,s=BigInt("0x100000000000000000000000000000000"),a=Xu(o*n,e),l=Xu(-r*n,e);let u=Me(n-a*t-l*i,e),c=Me(-a*r-l*o,e);const h=u>s,m=c>s;if(h&&(u=e-u),m&&(c=e-c),u>s||c>s)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:h,k1:u,k2neg:m,k2:c}}}},Yr);BigInt(0);Ot.ProjectivePoint;function Gv(n){const e=r=>{if(r!==null&&typeof r=="object"&&!Array.isArray(r)){const i=Object.keys(r).sort(),o={};for(const s of i)o[s]=e(r[s]);return o}return r},t=e(n);return JSON.stringify(t)}var Yv=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Zu="urn:jwk:";function Ue({jwk:n}){return Yv(this,void 0,void 0,function*(){const e=n.kty;let t;if(e==="EC")t={crv:n.crv,kty:n.kty,x:n.x,y:n.y};else if(e==="oct")t={k:n.k,kty:n.kty};else if(e==="OKP")t={crv:n.crv,kty:n.kty,x:n.x};else if(e==="RSA")t={e:n.e,kty:n.kty,n:n.n};else throw new Error(`Unsupported key type: ${e}`);Md(t);const r=Gv(t),i=se.string(r).toUint8Array(),o=yield hh.digest({data:i});return se.uint8Array(o).toBase64Url()})}function Wr(n){return!(!n||typeof n!="object"||!("kty"in n&&"crv"in n&&"x"in n&&"d"in n)||n.kty!=="EC"||typeof n.d!="string"||typeof n.x!="string")}function hl(n){return!(!n||typeof n!="object"||!("kty"in n&&"crv"in n&&"x"in n)||"d"in n||n.kty!=="EC"||typeof n.x!="string")}function qr(n){return!(!n||typeof n!="object"||!("kty"in n&&"crv"in n&&"x"in n&&"d"in n)||n.kty!=="OKP"||typeof n.d!="string"||typeof n.x!="string")}function yl(n){return!(!n||typeof n!="object"||"d"in n||!("kty"in n&&"crv"in n&&"x"in n)||n.kty!=="OKP"||typeof n.x!="string")}function Jv(n){if(!n||typeof n!="object")return!1;switch(n.kty){case"EC":case"OKP":case"RSA":return"d"in n;case"oct":return"k"in n;default:return!1}}var dt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Xv=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class We{static adjustSignatureToLowS({signature:e}){return dt(this,void 0,void 0,function*(){const t=Ot.Signature.fromCompact(e);return t.hasHighS()?t.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return dt(this,void 0,void 0,function*(){const t=yield We.getCurvePoint({keyBytes:e}),r={kty:"EC",crv:"secp256k1",d:se.uint8Array(e).toBase64Url(),x:se.uint8Array(t.x).toBase64Url(),y:se.uint8Array(t.y).toBase64Url()};return r.kid=yield Ue({jwk:r}),r})}static bytesToPublicKey({publicKeyBytes:e}){return dt(this,void 0,void 0,function*(){const t=yield We.getCurvePoint({keyBytes:e}),r={kty:"EC",crv:"secp256k1",x:se.uint8Array(t.x).toBase64Url(),y:se.uint8Array(t.y).toBase64Url()};return r.kid=yield Ue({jwk:r}),r})}static compressPublicKey({publicKeyBytes:e}){return dt(this,void 0,void 0,function*(){return Ot.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return dt(this,void 0,void 0,function*(){const t=yield We.privateKeyToBytes({privateKey:e}),r=yield We.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"secp256k1",x:se.uint8Array(r.x).toBase64Url(),y:se.uint8Array(r.y).toBase64Url()};return i.kid=yield Ue({jwk:i}),i})}static convertDerToCompactSignature({derSignature:e}){return dt(this,void 0,void 0,function*(){return Ot.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return dt(this,void 0,void 0,function*(){return Ot.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return dt(this,void 0,void 0,function*(){const e=Ot.utils.randomPrivateKey(),t=yield We.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Ue({jwk:t}),t})}static getPublicKey({key:e}){var t;return dt(this,void 0,void 0,function*(){if(!(Wr(e)&&e.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let r=Xv(e,["d"]);return(t=r.kid)!==null&&t!==void 0||(r.kid=yield Ue({jwk:r})),r})}static privateKeyToBytes({privateKey:e}){return dt(this,void 0,void 0,function*(){if(!Wr(e))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return se.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return dt(this,void 0,void 0,function*(){if(!(hl(e)&&e.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const t=new Uint8Array([4]),r=se.base64Url(e.x).toUint8Array(),i=se.base64Url(e.y).toUint8Array();return new Uint8Array([...t,...r,...i])})}static sharedSecret({privateKeyA:e,publicKeyB:t}){return dt(this,void 0,void 0,function*(){if("x"in e&&"x"in t&&e.x===t.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const r=yield We.privateKeyToBytes({privateKey:e}),i=yield We.publicKeyToBytes({publicKey:t});return Ot.getSharedSecret(r,i,!0).slice(1)})}static sign({data:e,key:t}){return dt(this,void 0,void 0,function*(){const r=yield We.privateKeyToBytes({privateKey:t}),i=Yr(e);return Ot.sign(i,r).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return dt(this,void 0,void 0,function*(){return Ot.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return dt(this,void 0,void 0,function*(){try{Ot.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:t,data:r}){return dt(this,void 0,void 0,function*(){const i=yield We.publicKeyToBytes({publicKey:e}),o=Yr(r);return Ot.verify(t,o,i,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return dt(this,void 0,void 0,function*(){e.byteLength===32&&(e=Ot.getPublicKey(e));const t=Ot.ProjectivePoint.fromHex(e),r=bn(t.x,32),i=bn(t.y,32);return{x:r,y:i}})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Th=dl(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Zv=Th.create(BigInt("-3")),Qv=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),em=Sh({a:Zv,b:Qv,Fp:Th,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Yr),Nt=em;var ft=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},tm=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class ze{static adjustSignatureToLowS({signature:e}){return ft(this,void 0,void 0,function*(){const t=Nt.Signature.fromCompact(e);return t.hasHighS()?t.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return ft(this,void 0,void 0,function*(){const t=yield ze.getCurvePoint({keyBytes:e}),r={kty:"EC",crv:"P-256",d:se.uint8Array(e).toBase64Url(),x:se.uint8Array(t.x).toBase64Url(),y:se.uint8Array(t.y).toBase64Url()};return r.kid=yield Ue({jwk:r}),r})}static bytesToPublicKey({publicKeyBytes:e}){return ft(this,void 0,void 0,function*(){const t=yield ze.getCurvePoint({keyBytes:e}),r={kty:"EC",crv:"P-256",x:se.uint8Array(t.x).toBase64Url(),y:se.uint8Array(t.y).toBase64Url()};return r.kid=yield Ue({jwk:r}),r})}static compressPublicKey({publicKeyBytes:e}){return ft(this,void 0,void 0,function*(){return Nt.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return ft(this,void 0,void 0,function*(){const t=yield ze.privateKeyToBytes({privateKey:e}),r=yield ze.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"P-256",x:se.uint8Array(r.x).toBase64Url(),y:se.uint8Array(r.y).toBase64Url()};return i.kid=yield Ue({jwk:i}),i})}static convertDerToCompactSignature({derSignature:e}){return ft(this,void 0,void 0,function*(){return Nt.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return ft(this,void 0,void 0,function*(){return Nt.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return ft(this,void 0,void 0,function*(){const e=Nt.utils.randomPrivateKey(),t=yield ze.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Ue({jwk:t}),t})}static getPublicKey({key:e}){var t;return ft(this,void 0,void 0,function*(){if(!(Wr(e)&&e.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let r=tm(e,["d"]);return(t=r.kid)!==null&&t!==void 0||(r.kid=yield Ue({jwk:r})),r})}static privateKeyToBytes({privateKey:e}){return ft(this,void 0,void 0,function*(){if(!Wr(e))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return se.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return ft(this,void 0,void 0,function*(){if(!(hl(e)&&e.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const t=new Uint8Array([4]),r=se.base64Url(e.x).toUint8Array(),i=se.base64Url(e.y).toUint8Array();return new Uint8Array([...t,...r,...i])})}static sharedSecret({privateKeyA:e,publicKeyB:t}){return ft(this,void 0,void 0,function*(){if("x"in e&&"x"in t&&e.x===t.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const r=yield ze.privateKeyToBytes({privateKey:e}),i=yield ze.publicKeyToBytes({publicKey:t});return Nt.getSharedSecret(r,i,!0).slice(1)})}static sign({data:e,key:t}){return ft(this,void 0,void 0,function*(){const r=yield ze.privateKeyToBytes({privateKey:t}),i=Yr(e);return Nt.sign(i,r).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return ft(this,void 0,void 0,function*(){return Nt.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return ft(this,void 0,void 0,function*(){try{Nt.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:t,data:r}){return ft(this,void 0,void 0,function*(){const i=yield ze.publicKeyToBytes({publicKey:e}),o=Yr(r);return Nt.verify(t,o,i,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return ft(this,void 0,void 0,function*(){e.byteLength===32&&(e=Nt.getPublicKey(e));const t=Nt.ProjectivePoint.fromHex(e),r=bn(t.x,32),i=bn(t.y,32);return{x:r,y:i}})}}var ro=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Qu extends cl{computePublicKey({key:e}){return ro(this,void 0,void 0,function*(){if(!Wr(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const t=yield We.computePublicKey({key:e});return t.alg="ES256K",t}case"P-256":{const t=yield ze.computePublicKey({key:e});return t.alg="ES256",t}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return ro(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{const t=yield We.generateKey();return t.alg="ES256K",t}case"ES256":case"secp256r1":{const t=yield ze.generateKey();return t.alg="ES256",t}}})}getPublicKey({key:e}){return ro(this,void 0,void 0,function*(){if(!Wr(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const t=yield We.getPublicKey({key:e});return t.alg="ES256K",t}case"P-256":{const t=yield ze.getPublicKey({key:e});return t.alg="ES256",t}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:t}){return ro(this,void 0,void 0,function*(){if(!Wr(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield We.sign({key:e,data:t});case"P-256":return yield ze.sign({key:e,data:t});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:t,data:r}){return ro(this,void 0,void 0,function*(){if(!hl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield We.verify({key:e,signature:t,data:r});case"P-256":return yield ze.verify({key:e,signature:t,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}}const es=BigInt(2**32-1),bc=BigInt(32);function Ih(n,e=!1){return e?{h:Number(n&es),l:Number(n>>bc&es)}:{h:Number(n>>bc&es)|0,l:Number(n&es)|0}}function nm(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:o,l:s}=Ih(n[i],e);[t[i],r[i]]=[o,s]}return[t,r]}const rm=(n,e)=>BigInt(n>>>0)<<bc|BigInt(e>>>0),im=(n,e,t)=>n>>>t,om=(n,e,t)=>n<<32-t|e>>>t,sm=(n,e,t)=>n>>>t|e<<32-t,am=(n,e,t)=>n<<32-t|e>>>t,cm=(n,e,t)=>n<<64-t|e>>>t-32,lm=(n,e,t)=>n>>>t-32|e<<64-t,um=(n,e)=>e,dm=(n,e)=>n,fm=(n,e,t)=>n<<t|e>>>32-t,hm=(n,e,t)=>e<<t|n>>>32-t,ym=(n,e,t)=>e<<t-32|n>>>64-t,pm=(n,e,t)=>n<<t-32|e>>>64-t;function gm(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}const wm=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),bm=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,vm=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),mm=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,Em=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),_m=(n,e,t,r,i,o)=>e+t+r+i+o+(n/2**32|0)|0,Se={fromBig:Ih,split:nm,toBig:rm,shrSH:im,shrSL:om,rotrSH:sm,rotrSL:am,rotrBH:cm,rotrBL:lm,rotr32H:um,rotr32L:dm,rotlSH:fm,rotlSL:hm,rotlBH:ym,rotlBL:pm,add:gm,add3L:wm,add3H:bm,add4L:vm,add4H:mm,add5H:_m,add5L:Em},[xm,Sm]=Se.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),tr=new Uint32Array(80),nr=new Uint32Array(80);class Am extends fh{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:i,Ch:o,Cl:s,Dh:a,Dl:l,Eh:u,El:c,Fh:h,Fl:m,Gh:E,Gl:g,Hh:S,Hl:C}=this;return[e,t,r,i,o,s,a,l,u,c,h,m,E,g,S,C]}set(e,t,r,i,o,s,a,l,u,c,h,m,E,g,S,C){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=l|0,this.Eh=u|0,this.El=c|0,this.Fh=h|0,this.Fl=m|0,this.Gh=E|0,this.Gl=g|0,this.Hh=S|0,this.Hl=C|0}process(e,t){for(let O=0;O<16;O++,t+=4)tr[O]=e.getUint32(t),nr[O]=e.getUint32(t+=4);for(let O=16;O<80;O++){const I=tr[O-15]|0,x=nr[O-15]|0,D=Se.rotrSH(I,x,1)^Se.rotrSH(I,x,8)^Se.shrSH(I,x,7),H=Se.rotrSL(I,x,1)^Se.rotrSL(I,x,8)^Se.shrSL(I,x,7),z=tr[O-2]|0,Q=nr[O-2]|0,P=Se.rotrSH(z,Q,19)^Se.rotrBH(z,Q,61)^Se.shrSH(z,Q,6),G=Se.rotrSL(z,Q,19)^Se.rotrBL(z,Q,61)^Se.shrSL(z,Q,6),ie=Se.add4L(H,G,nr[O-7],nr[O-16]),ee=Se.add4H(ie,D,P,tr[O-7],tr[O-16]);tr[O]=ee|0,nr[O]=ie|0}let{Ah:r,Al:i,Bh:o,Bl:s,Ch:a,Cl:l,Dh:u,Dl:c,Eh:h,El:m,Fh:E,Fl:g,Gh:S,Gl:C,Hh:B,Hl:A}=this;for(let O=0;O<80;O++){const I=Se.rotrSH(h,m,14)^Se.rotrSH(h,m,18)^Se.rotrBH(h,m,41),x=Se.rotrSL(h,m,14)^Se.rotrSL(h,m,18)^Se.rotrBL(h,m,41),D=h&E^~h&S,H=m&g^~m&C,z=Se.add5L(A,x,H,Sm[O],nr[O]),Q=Se.add5H(z,B,I,D,xm[O],tr[O]),P=z|0,G=Se.rotrSH(r,i,28)^Se.rotrBH(r,i,34)^Se.rotrBH(r,i,39),ie=Se.rotrSL(r,i,28)^Se.rotrBL(r,i,34)^Se.rotrBL(r,i,39),ee=r&o^r&a^o&a,oe=i&s^i&l^s&l;B=S|0,A=C|0,S=E|0,C=g|0,E=h|0,g=m|0,{h,l:m}=Se.add(u|0,c|0,Q|0,P|0),u=a|0,c=l|0,a=o|0,l=s|0,o=r|0,s=i|0;const K=Se.add3L(P,ie,oe);r=Se.add3H(K,Q,G,ee),i=K|0}({h:r,l:i}=Se.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:o,l:s}=Se.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l}=Se.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:u,l:c}=Se.add(this.Dh|0,this.Dl|0,u|0,c|0),{h,l:m}=Se.add(this.Eh|0,this.El|0,h|0,m|0),{h:E,l:g}=Se.add(this.Fh|0,this.Fl|0,E|0,g|0),{h:S,l:C}=Se.add(this.Gh|0,this.Gl|0,S|0,C|0),{h:B,l:A}=Se.add(this.Hh|0,this.Hl|0,B|0,A|0),this.set(r,i,o,s,a,l,u,c,h,m,E,g,S,C,B,A)}roundClean(){tr.fill(0),nr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Rh=dh(()=>new Am);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Gt=BigInt(0),It=BigInt(1),ts=BigInt(2),Tm=BigInt(8),Im={zip215:!0};function Rm(n){const e=fl(n);return oi(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function pl(n){const e=Rm(n),{Fp:t,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:l}=e,u=ts<<BigInt(a*8)-It,c=t.create,h=e.uvRatio||((j,$)=>{try{return{isValid:!0,value:t.sqrt(j*t.inv($))}}catch{return{isValid:!1,value:Gt}}}),m=e.adjustScalarBytes||(j=>j),E=e.domain||((j,$,N)=>{if($.length||N)throw new Error("Contexts/pre-hash are not supported");return j}),g=j=>typeof j=="bigint"&&Gt<j,S=(j,$)=>g(j)&&g($)&&j<$,C=j=>j===Gt||S(j,u);function B(j,$){if(S(j,$))return j;throw new Error(`Expected valid scalar < ${$}, got ${typeof j} ${j}`)}function A(j){return j===Gt?j:B(j,r)}const O=new Map;function I(j){if(!(j instanceof x))throw new Error("ExtendedPoint expected")}class x{constructor($,N,X,te){if(this.ex=$,this.ey=N,this.ez=X,this.et=te,!C($))throw new Error("x required");if(!C(N))throw new Error("y required");if(!C(X))throw new Error("z required");if(!C(te))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine($){if($ instanceof x)throw new Error("extended point not allowed");const{x:N,y:X}=$||{};if(!C(N)||!C(X))throw new Error("invalid affine point");return new x(N,X,It,c(N*X))}static normalizeZ($){const N=t.invertBatch($.map(X=>X.ez));return $.map((X,te)=>X.toAffine(N[te])).map(x.fromAffine)}_setWindowSize($){this._WINDOW_SIZE=$,O.delete(this)}assertValidity(){const{a:$,d:N}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:X,ey:te,ez:le,et:he}=this,we=c(X*X),ue=c(te*te),ae=c(le*le),ve=c(ae*ae),Ee=c(we*$),Ne=c(ae*c(Ee+ue)),ke=c(ve+c(N*c(we*ue)));if(Ne!==ke)throw new Error("bad point: equation left != right (1)");const Ce=c(X*te),L=c(le*he);if(Ce!==L)throw new Error("bad point: equation left != right (2)")}equals($){I($);const{ex:N,ey:X,ez:te}=this,{ex:le,ey:he,ez:we}=$,ue=c(N*we),ae=c(le*te),ve=c(X*we),Ee=c(he*te);return ue===ae&&ve===Ee}is0(){return this.equals(x.ZERO)}negate(){return new x(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){const{a:$}=e,{ex:N,ey:X,ez:te}=this,le=c(N*N),he=c(X*X),we=c(ts*c(te*te)),ue=c($*le),ae=N+X,ve=c(c(ae*ae)-le-he),Ee=ue+he,Ne=Ee-we,ke=ue-he,Ce=c(ve*Ne),L=c(Ee*ke),U=c(ve*ke),V=c(Ne*Ee);return new x(Ce,L,V,U)}add($){I($);const{a:N,d:X}=e,{ex:te,ey:le,ez:he,et:we}=this,{ex:ue,ey:ae,ez:ve,et:Ee}=$;if(N===BigInt(-1)){const Y=c((le-te)*(ae+ue)),de=c((le+te)*(ae-ue)),Te=c(de-Y);if(Te===Gt)return this.double();const p=c(he*ts*Ee),v=c(we*ts*ve),q=v+p,Z=de+Y,re=v-p,De=c(q*Te),ut=c(Z*re),vr=c(q*re),wt=c(Te*Z);return new x(De,ut,wt,vr)}const Ne=c(te*ue),ke=c(le*ae),Ce=c(we*X*Ee),L=c(he*ve),U=c((te+le)*(ue+ae)-Ne-ke),V=L-Ce,y=L+Ce,d=c(ke-N*Ne),f=c(U*V),w=c(y*d),k=c(U*d),W=c(V*y);return new x(f,w,W,k)}subtract($){return this.add($.negate())}wNAF($){return z.wNAFCached(this,O,$,x.normalizeZ)}multiply($){const{p:N,f:X}=this.wNAF(B($,r));return x.normalizeZ([N,X])[0]}multiplyUnsafe($){let N=A($);return N===Gt?H:this.equals(H)||N===It?this:this.equals(D)?this.wNAF(N).p:z.unsafeLadder(this,N)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return z.unsafeLadder(this,r).is0()}toAffine($){const{ex:N,ey:X,ez:te}=this,le=this.is0();$==null&&($=le?Tm:t.inv(te));const he=c(N*$),we=c(X*$),ue=c(te*$);if(le)return{x:Gt,y:It};if(ue!==It)throw new Error("invZ was invalid");return{x:he,y:we}}clearCofactor(){const{h:$}=e;return $===It?this:this.multiplyUnsafe($)}static fromHex($,N=!1){const{d:X,a:te}=e,le=t.BYTES;$=Qe("pointHex",$,le);const he=$.slice(),we=$[le-1];he[le-1]=we&-129;const ue=dr(he);ue===Gt||(N?B(ue,u):B(ue,t.ORDER));const ae=c(ue*ue),ve=c(ae-It),Ee=c(X*ae-te);let{isValid:Ne,value:ke}=h(ve,Ee);if(!Ne)throw new Error("Point.fromHex: invalid y coordinate");const Ce=(ke&It)===It,L=(we&128)!==0;if(!N&&ke===Gt&&L)throw new Error("Point.fromHex: x=0 and x_0=1");return L!==Ce&&(ke=c(-ke)),x.fromAffine({x:ke,y:ue})}static fromPrivateKey($){return G($).point}toRawBytes(){const{x:$,y:N}=this.toAffine(),X=ki(N,t.BYTES);return X[X.length-1]|=$&It?128:0,X}toHex(){return Jr(this.toRawBytes())}}x.BASE=new x(e.Gx,e.Gy,It,c(e.Gx*e.Gy)),x.ZERO=new x(Gt,It,It,Gt);const{BASE:D,ZERO:H}=x,z=Eh(x,a*8);function Q(j){return Me(j,r)}function P(j){return Q(dr(j))}function G(j){const $=a;j=Qe("private key",j,$);const N=Qe("hashed private key",o(j),2*$),X=m(N.slice(0,$)),te=N.slice($,2*$),le=P(X),he=D.multiply(le),we=he.toRawBytes();return{head:X,prefix:te,scalar:le,point:he,pointBytes:we}}function ie(j){return G(j).pointBytes}function ee(j=new Uint8Array,...$){const N=Xr(...$);return P(o(E(N,Qe("context",j),!!i)))}function oe(j,$,N={}){j=Qe("message",j),i&&(j=i(j));const{prefix:X,scalar:te,pointBytes:le}=G($),he=ee(N.context,X,j),we=D.multiply(he).toRawBytes(),ue=ee(N.context,we,le,j),ae=Q(he+ue*te);A(ae);const ve=Xr(we,ki(ae,t.BYTES));return Qe("result",ve,a*2)}const K=Im;function J(j,$,N,X=K){const{context:te,zip215:le}=X,he=t.BYTES;j=Qe("signature",j,2*he),$=Qe("message",$),i&&($=i($));const we=dr(j.slice(he,2*he));let ue,ae,ve;try{ue=x.fromHex(N,le),ae=x.fromHex(j.slice(0,he),le),ve=D.multiplyUnsafe(we)}catch{return!1}if(!le&&ue.isSmallOrder())return!1;const Ee=ee(te,ae.toRawBytes(),ue.toRawBytes(),$);return ae.add(ue.multiplyUnsafe(Ee)).subtract(ve).clearCofactor().equals(x.ZERO)}return D._setWindowSize(8),{CURVE:e,getPublicKey:ie,sign:oe,verify:J,ExtendedPoint:x,utils:{getExtendedPublicKey:G,randomPrivateKey:()=>s(t.BYTES),precompute(j=8,$=x.BASE){return $._setWindowSize(j),$.multiply(BigInt(3)),$}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const io=BigInt(0),za=BigInt(1);function Om(n){return oi(n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...n})}function Bm(n){const e=Om(n),{P:t}=e,r=O=>Me(O,t),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(O=>O),l=e.powPminus2||(O=>wh(O,t-BigInt(2),t));function u(O,I,x){const D=r(O*(I-x));return I=r(I-D),x=r(x+D),[I,x]}function c(O){if(typeof O=="bigint"&&io<=O&&O<t)return O;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const h=(e.a-BigInt(2))/BigInt(4);function m(O,I){const x=c(O),D=c(I),H=x;let z=za,Q=io,P=x,G=za,ie=io,ee;for(let K=BigInt(i-1);K>=io;K--){const J=D>>K&za;ie^=J,ee=u(ie,z,P),z=ee[0],P=ee[1],ee=u(ie,Q,G),Q=ee[0],G=ee[1],ie=J;const ne=z+Q,j=r(ne*ne),$=z-Q,N=r($*$),X=j-N,te=P+G,le=P-G,he=r(le*ne),we=r(te*$),ue=he+we,ae=he-we;P=r(ue*ue),G=r(H*r(ae*ae)),z=r(j*N),Q=r(X*(j+r(h*X)))}ee=u(ie,z,P),z=ee[0],P=ee[1],ee=u(ie,Q,G),Q=ee[0],G=ee[1];const oe=l(Q);return r(z*oe)}function E(O){return ki(r(O),o)}function g(O){const I=Qe("u coordinate",O,o);return s===32&&(I[31]&=127),dr(I)}function S(O){const I=Qe("scalar",O),x=I.length;if(x!==o&&x!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${x}`);return dr(a(I))}function C(O,I){const x=g(I),D=S(O),H=m(x,D);if(H===io)throw new Error("Invalid private or public key received");return E(H)}const B=E(e.Gu);function A(O){return C(O,B)}return{scalarMult:C,scalarMultBase:A,getSharedSecret:(O,I)=>C(O,I),getPublicKey:O=>A(O),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:B}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ed=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Lm=BigInt(1),vc=BigInt(2),km=BigInt(5),td=BigInt(10),Cm=BigInt(20),Um=BigInt(40),nd=BigInt(80);function Oh(n){const e=mo,r=n*n%e*n%e,i=Ve(r,vc,e)*r%e,o=Ve(i,Lm,e)*n%e,s=Ve(o,km,e)*o%e,a=Ve(s,td,e)*s%e,l=Ve(a,Cm,e)*a%e,u=Ve(l,Um,e)*l%e,c=Ve(u,nd,e)*u%e,h=Ve(c,nd,e)*u%e,m=Ve(h,td,e)*s%e;return{pow_p_5_8:Ve(m,vc,e)*n%e,b2:r}}function Bh(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function $m(n,e){const t=mo,r=Me(e*e*e,t),i=Me(r*r*e,t),o=Oh(n*i).pow_p_5_8;let s=Me(n*r*o,t);const a=Me(e*s*s,t),l=s,u=Me(s*ed,t),c=a===n,h=a===Me(-n,t),m=a===Me(-n*ed,t);return c&&(s=l),(h||m)&&(s=u),Lv(s,t)&&(s=Me(-s,t)),{isValid:c||h,value:s}}const Ht=dl(mo,void 0,!0),Eo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ht,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Rh,randomBytes:al,adjustScalarBytes:Bh,uvRatio:$m},Ur=pl(Eo);function Lh(n,e,t){if(e.length>255)throw new Error("Context is too big");return lh(ch("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,n)}({...Eo});({...Eo});const lo=Bm({P:mo,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:n=>{const e=mo,{pow_p_5_8:t,b2:r}=Oh(n);return Me(Ve(t,BigInt(3),e)*r,e)},adjustScalarBytes:Bh,randomBytes:al});function Nm(n){const{y:e}=Ur.ExtendedPoint.fromHex(n),t=BigInt(1);return Ht.toBytes(Ht.create((t+e)*Ht.inv(t-e)))}function Dm(n){const e=Eo.hash(n.subarray(0,32));return Eo.adjustScalarBytes(e).subarray(0,32)}const Pm=(Ht.ORDER+BigInt(3))/BigInt(8);Ht.pow(vc,Pm);Ht.sqrt(Ht.neg(Ht.ONE));(Ht.ORDER-BigInt(5))/BigInt(8);BigInt(486662);Nv(Ht,Ht.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Dt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},Km=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Ge{static bytesToPrivateKey({privateKeyBytes:e}){return Dt(this,void 0,void 0,function*(){const t=Ur.getPublicKey(e),r={crv:"Ed25519",d:se.uint8Array(e).toBase64Url(),kty:"OKP",x:se.uint8Array(t).toBase64Url()};return r.kid=yield Ue({jwk:r}),r})}static bytesToPublicKey({publicKeyBytes:e}){return Dt(this,void 0,void 0,function*(){const t={kty:"OKP",crv:"Ed25519",x:se.uint8Array(e).toBase64Url()};return t.kid=yield Ue({jwk:t}),t})}static computePublicKey({key:e}){return Dt(this,void 0,void 0,function*(){const t=yield Ge.privateKeyToBytes({privateKey:e}),r=Ur.getPublicKey(t),i={kty:"OKP",crv:"Ed25519",x:se.uint8Array(r).toBase64Url()};return i.kid=yield Ue({jwk:i}),i})}static convertPrivateKeyToX25519({privateKey:e}){return Dt(this,void 0,void 0,function*(){const t=yield Ge.privateKeyToBytes({privateKey:e}),r=Dm(t),i=lo.getPublicKey(r),o={kty:"OKP",crv:"X25519",d:se.uint8Array(r).toBase64Url(),x:se.uint8Array(i).toBase64Url()};return o.kid=yield Ue({jwk:o}),o})}static convertPublicKeyToX25519({publicKey:e}){return Dt(this,void 0,void 0,function*(){const t=yield Ge.publicKeyToBytes({publicKey:e});if(!(yield Ge.validatePublicKey({publicKeyBytes:t})))throw new Error("Ed25519: Invalid public key.");const i=Nm(t),o={kty:"OKP",crv:"X25519",x:se.uint8Array(i).toBase64Url()};return o.kid=yield Ue({jwk:o}),o})}static generateKey(){return Dt(this,void 0,void 0,function*(){const e=Ur.utils.randomPrivateKey(),t=yield Ge.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Ue({jwk:t}),t})}static getPublicKey({key:e}){var t;return Dt(this,void 0,void 0,function*(){if(!(qr(e)&&e.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let r=Km(e,["d"]);return(t=r.kid)!==null&&t!==void 0||(r.kid=yield Ue({jwk:r})),r})}static privateKeyToBytes({privateKey:e}){return Dt(this,void 0,void 0,function*(){if(!qr(e))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return se.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Dt(this,void 0,void 0,function*(){if(!yl(e))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return se.base64Url(e.x).toUint8Array()})}static sign({key:e,data:t}){return Dt(this,void 0,void 0,function*(){const r=yield Ge.privateKeyToBytes({privateKey:e});return Ur.sign(t,r)})}static validatePublicKey({publicKeyBytes:e}){return Dt(this,void 0,void 0,function*(){try{Ur.ExtendedPoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:t,data:r}){return Dt(this,void 0,void 0,function*(){const i=yield Ge.publicKeyToBytes({publicKey:e});return Ur.verify(t,r,i)})}}var oo=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Mm extends cl{computePublicKey({key:e}){return oo(this,void 0,void 0,function*(){if(!qr(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const t=yield Ge.computePublicKey({key:e});return t.alg="EdDSA",t}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return oo(this,void 0,void 0,function*(){switch(e){case"Ed25519":{const t=yield Ge.generateKey();return t.alg="EdDSA",t}}})}getPublicKey({key:e}){return oo(this,void 0,void 0,function*(){if(!qr(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const t=yield Ge.getPublicKey({key:e});return t.alg="EdDSA",t}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:t}){return oo(this,void 0,void 0,function*(){if(!qr(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield Ge.sign({key:e,data:t});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:t,data:r}){return oo(this,void 0,void 0,function*(){if(!yl(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield Ge.verify({key:e,signature:t,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}}var Ln=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Ga={Ed25519:{implementation:Mm,names:["Ed25519"]},secp256k1:{implementation:Qu,names:["ES256K","secp256k1"]},secp256r1:{implementation:Qu,names:["ES256","secp256r1"]},"SHA-256":{implementation:wv,names:["SHA-256"]}};class Hn{constructor(e){var t;this._algorithmInstances=new Map,this._keyStore=(t=e==null?void 0:e.keyStore)!==null&&t!==void 0?t:new M0}digest({algorithm:e,data:t}){return Ln(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:t})})}exportKey({keyUri:e}){return Ln(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){return Ln(this,void 0,void 0,function*(){const r=yield this.getAlgorithm({algorithm:e}).generateKey({algorithm:e});if((r==null?void 0:r.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${Zu}${r.kid}`;return yield this._keyStore.set(i,r),i})}getKeyUri({key:e}){return Ln(this,void 0,void 0,function*(){const t=yield Ue({jwk:e});return`${Zu}${t}`})}getPublicKey({keyUri:e}){return Ln(this,void 0,void 0,function*(){const t=yield this.getPrivateKey({keyUri:e}),r=this.getAlgorithmName({key:t});return yield this.getAlgorithm({algorithm:r}).getPublicKey({key:t})})}importKey({key:e}){var t;return Ln(this,void 0,void 0,function*(){if(!Jv(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const r=structuredClone(e);(t=r.kid)!==null&&t!==void 0||(r.kid=yield Ue({jwk:r}));const i=yield this.getKeyUri({key:r});return yield this._keyStore.set(i,r),i})}sign({keyUri:e,data:t}){return Ln(this,void 0,void 0,function*(){const r=yield this.getPrivateKey({keyUri:e}),i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).sign({data:t,key:r})})}verify({key:e,signature:t,data:r}){return Ln(this,void 0,void 0,function*(){const i=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:i}).verify({key:e,signature:t,data:r})})}getAlgorithm({algorithm:e}){var t;const r=(t=Ga[e])===null||t===void 0?void 0:t.implementation;if(!r)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(r)||this._algorithmInstances.set(r,new r),this._algorithmInstances.get(r)}getAlgorithmName({key:e}){const t=e.alg,r=e.crv;for(const i in Ga){const o=Ga[i];if(t&&o.names.includes(t))return i;if(r&&o.names.includes(r))return i}throw new Error(`Unable to determine algorithm based on provided input: alg=${t}, crv=${r}`)}getPrivateKey({keyUri:e}){return Ln(this,void 0,void 0,function*(){const t=yield this._keyStore.get(e);if(!t)throw new Error(`Key not found: ${e}`);return t})}}function Fm(n){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(n.alg&&Object.values(e).includes(n.alg))return n.alg;if(n.crv&&Object.keys(e).includes(n.crv))return e[n.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${n.alg}, crv=${n.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const kh=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4));function Ch(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}const jm=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!jm)throw new Error("Non little-endian hardware is not supported");function gl(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function mc(n){if(typeof n=="string")n=gl(n);else if(Ch(n))n=n.slice();else throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function Hm(n,e){if(!Ch(n))throw new Error("Uint8Array expected");if(n.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function Vm(n){return n!=null&&typeof n=="object"&&(n instanceof Uint8Array||n.constructor.name==="Uint8Array")}function Wm(n,...e){if(!Vm(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function rd(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function qm(n,e){Wm(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var rr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},zm=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Fr{static bytesToPrivateKey({privateKeyBytes:e}){return rr(this,void 0,void 0,function*(){const t=lo.getPublicKey(e),r={kty:"OKP",crv:"X25519",d:se.uint8Array(e).toBase64Url(),x:se.uint8Array(t).toBase64Url()};return r.kid=yield Ue({jwk:r}),r})}static bytesToPublicKey({publicKeyBytes:e}){return rr(this,void 0,void 0,function*(){const t={kty:"OKP",crv:"X25519",x:se.uint8Array(e).toBase64Url()};return t.kid=yield Ue({jwk:t}),t})}static computePublicKey({key:e}){return rr(this,void 0,void 0,function*(){const t=yield Fr.privateKeyToBytes({privateKey:e}),r=lo.getPublicKey(t),i={kty:"OKP",crv:"X25519",x:se.uint8Array(r).toBase64Url()};return i.kid=yield Ue({jwk:i}),i})}static generateKey(){return rr(this,void 0,void 0,function*(){const e=lo.utils.randomPrivateKey(),t=yield Fr.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield Ue({jwk:t}),t})}static getPublicKey({key:e}){var t;return rr(this,void 0,void 0,function*(){if(!(qr(e)&&e.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let r=zm(e,["d"]);return(t=r.kid)!==null&&t!==void 0||(r.kid=yield Ue({jwk:r})),r})}static privateKeyToBytes({privateKey:e}){return rr(this,void 0,void 0,function*(){if(!qr(e))throw new Error("X25519: The provided key is not a valid OKP private key.");return se.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return rr(this,void 0,void 0,function*(){if(!yl(e))throw new Error("X25519: The provided key is not a valid OKP public key.");return se.base64Url(e.x).toUint8Array()})}static sharedSecret({privateKeyA:e,publicKeyB:t}){return rr(this,void 0,void 0,function*(){if("x"in e&&"x"in t&&e.x===t.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const r=yield Fr.privateKeyToBytes({privateKey:e}),i=yield Fr.publicKeyToBytes({publicKey:t});return lo.getSharedSecret(r,i)})}}const ht=(n,e)=>n[e++]&255|(n[e++]&255)<<8;class Gm{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=mc(e),Hm(e,32);const t=ht(e,0),r=ht(e,2),i=ht(e,4),o=ht(e,6),s=ht(e,8),a=ht(e,10),l=ht(e,12),u=ht(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|l<<5)&8065,this.r[8]=(l>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let c=0;c<8;c++)this.pad[c]=ht(e,16+2*c)}process(e,t,r=!1){const i=r?0:2048,{h:o,r:s}=this,a=s[0],l=s[1],u=s[2],c=s[3],h=s[4],m=s[5],E=s[6],g=s[7],S=s[8],C=s[9],B=ht(e,t+0),A=ht(e,t+2),O=ht(e,t+4),I=ht(e,t+6),x=ht(e,t+8),D=ht(e,t+10),H=ht(e,t+12),z=ht(e,t+14);let Q=o[0]+(B&8191),P=o[1]+((B>>>13|A<<3)&8191),G=o[2]+((A>>>10|O<<6)&8191),ie=o[3]+((O>>>7|I<<9)&8191),ee=o[4]+((I>>>4|x<<12)&8191),oe=o[5]+(x>>>1&8191),K=o[6]+((x>>>14|D<<2)&8191),J=o[7]+((D>>>11|H<<5)&8191),ne=o[8]+((H>>>8|z<<8)&8191),j=o[9]+(z>>>5|i),$=0,N=$+Q*a+P*(5*C)+G*(5*S)+ie*(5*g)+ee*(5*E);$=N>>>13,N&=8191,N+=oe*(5*m)+K*(5*h)+J*(5*c)+ne*(5*u)+j*(5*l),$+=N>>>13,N&=8191;let X=$+Q*l+P*a+G*(5*C)+ie*(5*S)+ee*(5*g);$=X>>>13,X&=8191,X+=oe*(5*E)+K*(5*m)+J*(5*h)+ne*(5*c)+j*(5*u),$+=X>>>13,X&=8191;let te=$+Q*u+P*l+G*a+ie*(5*C)+ee*(5*S);$=te>>>13,te&=8191,te+=oe*(5*g)+K*(5*E)+J*(5*m)+ne*(5*h)+j*(5*c),$+=te>>>13,te&=8191;let le=$+Q*c+P*u+G*l+ie*a+ee*(5*C);$=le>>>13,le&=8191,le+=oe*(5*S)+K*(5*g)+J*(5*E)+ne*(5*m)+j*(5*h),$+=le>>>13,le&=8191;let he=$+Q*h+P*c+G*u+ie*l+ee*a;$=he>>>13,he&=8191,he+=oe*(5*C)+K*(5*S)+J*(5*g)+ne*(5*E)+j*(5*m),$+=he>>>13,he&=8191;let we=$+Q*m+P*h+G*c+ie*u+ee*l;$=we>>>13,we&=8191,we+=oe*a+K*(5*C)+J*(5*S)+ne*(5*g)+j*(5*E),$+=we>>>13,we&=8191;let ue=$+Q*E+P*m+G*h+ie*c+ee*u;$=ue>>>13,ue&=8191,ue+=oe*l+K*a+J*(5*C)+ne*(5*S)+j*(5*g),$+=ue>>>13,ue&=8191;let ae=$+Q*g+P*E+G*m+ie*h+ee*c;$=ae>>>13,ae&=8191,ae+=oe*u+K*l+J*a+ne*(5*C)+j*(5*S),$+=ae>>>13,ae&=8191;let ve=$+Q*S+P*g+G*E+ie*m+ee*h;$=ve>>>13,ve&=8191,ve+=oe*c+K*u+J*l+ne*a+j*(5*C),$+=ve>>>13,ve&=8191;let Ee=$+Q*C+P*S+G*g+ie*E+ee*m;$=Ee>>>13,Ee&=8191,Ee+=oe*h+K*c+J*u+ne*l+j*a,$+=Ee>>>13,Ee&=8191,$=($<<2)+$|0,$=$+N|0,N=$&8191,$=$>>>13,X+=$,o[0]=N,o[1]=X,o[2]=te,o[3]=le,o[4]=he,o[5]=we,o[6]=ue,o[7]=ae,o[8]=ve,o[9]=Ee}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)r[a]&=o;o=~o;for(let a=0;a<10;a++)e[a]=e[a]&o|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+t[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+t[a]|0)+(s>>>16)|0,e[a]=s&65535}update(e){rd(this);const{buffer:t,blockLen:r}=this;e=mc(e);const i=e.length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s===r){for(;r<=i-o;o+=r)this.process(e,o);continue}t.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){rd(this),qm(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)e[o++]=r[s]>>>0,e[o++]=r[s]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}function Ym(n){const e=(r,i)=>n(i).update(mc(r)).digest(),t=n(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}Ym(n=>new Gm(n));const Jm=gl("expand 16-byte k"),Xm=gl("expand 32-byte k");kh(Jm);kh(Xm);function Xt(n){if(typeof n=="string"&&n.length!==0)return n.split("#").pop()}function Uh({didDocument:n}){var e,t;if(!n)throw new TypeError("Required parameter missing: 'didDocument'");const r=[];return r.push(...(t=(e=n.verificationMethod)===null||e===void 0?void 0:e.filter(Ec))!==null&&t!==void 0?t:[]),Object.keys(vo).forEach(i=>{var o,s;r.push(...(s=(o=n[i])===null||o===void 0?void 0:o.filter(Ec))!==null&&s!==void 0?s:[])}),r}function Zm({didDocument:n}){const t=Uh({didDocument:n}).map(r=>r.type);return[...new Set(t)]}function Qm({didDocument:n,methodId:e}){const t=[];return Object.keys(vo).forEach(r=>{if(Array.isArray(n[r])){const i=n[r],o=Xt(e);i.some(a=>{const l=Xt(a)===o,u=Ec(a)&&Xt(a.id)===o;return l||u})&&t.push(r)}}),t}function Ec(n){return!(!n||typeof n!="object"||n===null||!("id"in n&&"type"in n&&"controller"in n)||typeof n.id!="string"||typeof n.type!="string"||typeof n.controller!="string")}function $h({keyBytes:n,multicodecCode:e,multicodecName:t}){const r=rt.addPrefix({code:e,data:n,name:t}),i=se.uint8Array(r).toBase58Btc();return se.base58Btc(i).toMultibase()}function id({multibaseKeyId:n}){try{const e=se.multibase(n).toBase58Btc(),t=se.base58Btc(e).toUint8Array(),{code:r,data:i,name:o}=rt.removePrefix({prefixedData:t});return{keyBytes:i,multicodecCode:r,multicodecName:o}}catch{throw new pe(fe.InvalidDid,`Invalid multibase identifier: ${n}`)}}var so=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class vn{constructor({uri:e,document:t,metadata:r,keyManager:i}){this.uri=e,this.document=t,this.metadata=r,this.keyManager=i}export(){return so(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const t=[];for(let r of this.document.verificationMethod){if(!r.publicKeyJwk)throw new Error(`Verification method '${r.id}' does not contain a public key in JWK format`);const i=yield this.keyManager.getKeyUri({key:r.publicKeyJwk}),o=yield this.keyManager.exportKey({keyUri:i});t.push(Object.assign({},o))}e.privateKeys=t}return e})}getSigner(e){return so(this,void 0,void 0,function*(){var t;const r=(t=this.document.verificationMethod)===null||t===void 0?void 0:t.find(l=>{var u,c;return Xt(l.id)===((u=Xt(e==null?void 0:e.methodId))!==null&&u!==void 0?u:Xt((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(r&&r.publicKeyJwk))throw new pe(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");const i=yield this.keyManager.getKeyUri({key:r.publicKeyJwk}),o=yield this.keyManager.getPublicKey({keyUri:i}),s=this.keyManager;return{algorithm:Fm(o),keyId:r.id,sign(l){return so(this,arguments,void 0,function*({data:u}){return yield s.sign({data:u,keyUri:i})})},verify(l){return so(this,arguments,void 0,function*({data:u,signature:c}){return yield s.verify({data:u,key:o,signature:c})})}}})}static import(e){return so(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Hn}){var i;const o=Uh({didDocument:t.document});if(o.length===0)throw new pe(fe.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(i=t.privateKeys)!==null&&i!==void 0?i:[])yield r.importKey({key:a});for(let a of o){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const l=yield r.getKeyUri({key:a.publicKeyJwk});yield r.getPublicKey({keyUri:l})}return new vn({uri:t.uri,document:t.document,metadata:t.metadata,keyManager:r})})}}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const od="0123456789abcdef",Nh=[];for(let n=0;n<256;n++)Nh[n]=od[n>>4&15]+od[n&15];const eE=n=>{const e=n.length;let t="",r=0;for(;r<e;)t+=Nh[n[r++]];return t},tE=(n,e=0)=>{const t=n.length||0;if(!e){let s=t;for(;s--;)e+=n[s].length}const r=new Uint8Array(e);let i=e,o=t;for(;o--;)i-=n[o].length,r.set(n[o],i);return r};var sd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nE=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ns=0;ns<sd.length;ns++)nE[sd.charCodeAt(ns)]=ns;const rE=new TextDecoder,Dh=(n,e)=>rE.decode(n),iE=new TextEncoder,Vn=n=>iE.encode(n),ad=typeof window<"u"?window:self,cd=ad.crypto||ad.msCrypto||{};cd.subtle||cd.webkitSubtle;function Bo(n){const e=n<0?1:0;return n=Math.abs(Number(n||1)),Math.floor(Math.log10(n))+1+e}function Ph(n){return ArrayBuffer.isView(n)?"arraybufferview":Array.isArray(n)?"array":n instanceof Number?"number":n instanceof Boolean?"boolean":n instanceof Set?"set":n instanceof Map?"map":n instanceof String?"string":n instanceof ArrayBuffer?"arraybuffer":typeof n}function Le(n,e,t){const r=[];let i=null;return Le._encode(r,n),i=tE(r),Le.bytes=i.length,ArrayBuffer.isView(e)?(e.set(i,t),e):i}Le.bytes=-1;Le._floatConversionDetected=!1;Le._encode=function(n,e){if(e!=null)switch(Ph(e)){case"object":Le.dict(n,e);break;case"map":Le.dictMap(n,e);break;case"array":Le.list(n,e);break;case"set":Le.listSet(n,e);break;case"string":Le.string(n,e);break;case"number":Le.number(n,e);break;case"boolean":Le.number(n,e);break;case"arraybufferview":Le.buffer(n,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":Le.buffer(n,new Uint8Array(e));break}};const ea=new Uint8Array([101]),Kh=new Uint8Array([100]),Mh=new Uint8Array([108]);Le.buffer=function(n,e){n.push(Vn(e.length+":"),e)};Le.string=function(n,e){n.push(Vn(Vn(e).byteLength+":"+e))};Le.number=function(n,e){if(Number.isInteger(e))return n.push(Vn("i"+BigInt(e)+"e"));const t=2147483648,r=e/t<<0,i=e%t<<0,o=r*t+i;n.push(Vn("i"+o+"e")),o!==e&&!Le._floatConversionDetected&&(Le._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+e+'":','Bencoding only defines support for integers, value was converted to "'+o+'"'),console.trace())};Le.dict=function(n,e){n.push(Kh);let t=0,r;const i=Object.keys(e).sort(),o=i.length;for(;t<o;t++)r=i[t],e[r]!=null&&(Le.string(n,r),Le._encode(n,e[r]));n.push(ea)};Le.dictMap=function(n,e){n.push(Kh);const t=Array.from(e.keys()).sort();for(const r of t)e.get(r)!=null&&(ArrayBuffer.isView(r)?Le._encode(n,r):Le.string(n,String(r)),Le._encode(n,e.get(r)));n.push(ea)};Le.list=function(n,e){let t=0;const r=e.length;for(n.push(Mh);t<r;t++)e[t]!=null&&Le._encode(n,e[t]);n.push(ea)};Le.listSet=function(n,e){n.push(Mh);for(const t of e)t!=null&&Le._encode(n,t);n.push(ea)};const oE=105,sE=58,aE=100,cE=108,wl=101;function Fh(n,e,t){let r=0,i=1;for(let o=e;o<t;o++){const s=n[o];if(s<58&&s>=48){r=r*10+(s-48);continue}if(!(o===e&&s===43)){if(o===e&&s===45){i=-1;continue}if(s===46)break;throw new Error("not a number: buffer["+o+"] = "+s)}}return r*i}function me(n,e,t,r){return n==null||n.length===0?null:(typeof e!="number"&&r==null&&(r=e,e=void 0),typeof t!="number"&&r==null&&(r=t,t=void 0),me.position=0,me.encoding=r||null,me.data=ArrayBuffer.isView(n)?new Uint8Array(n.slice(e,t)):Vn(n),me.bytes=me.data.length,me.next())}me.bytes=0;me.position=0;me.data=null;me.encoding=null;me.next=function(){switch(me.data[me.position]){case aE:return me.dictionary();case cE:return me.list();case oE:return me.integer();default:return me.buffer()}};me.find=function(n){let e=me.position;const t=me.data.length,r=me.data;for(;e<t;){if(r[e]===n)return e;e++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(n)+'" [0x'+n.toString(16)+"]")};me.dictionary=function(){me.position++;const n={};for(;me.data[me.position]!==wl;){const e=me.buffer();let t=Dh(e);t.includes("�")&&(t=eE(e)),n[t]=me.next()}return me.position++,n};me.list=function(){me.position++;const n=[];for(;me.data[me.position]!==wl;)n.push(me.next());return me.position++,n};me.integer=function(){const n=me.find(wl),e=Fh(me.data,me.position+1,n);return me.position+=n+1-me.position,e};me.buffer=function(){let n=me.find(sE);const e=Fh(me.data,me.position,n),t=++n+e;return me.position=t,me.encoding?Dh(me.data.slice(n,t)):me.data.slice(n,t)};function lE(n){let e=2;for(const t of n)e+=Lo(t);return e}function uE(n){let e=2;for(const[t,r]of n){const i=Vn(t).byteLength;e+=Bo(i)+1+i,e+=Lo(r)}return e}function dE(n){let e=2;const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=Vn(t[r]).byteLength;e+=Bo(i)+1+i,e+=Lo(n[t[r]])}return e}function fE(n){const e=Vn(n).byteLength;return Bo(e)+1+e}function hE(n){const e=n.byteLength-n.byteOffset;return Bo(e)+1+e}function Lo(n){if(n==null)return 0;const t=Ph(n);switch(t){case"arraybufferview":return hE(n);case"string":return fE(n);case"array":case"set":return lE(n);case"number":return 1+Bo(Math.floor(n))+1;case"bigint":return 1+n.toString().length+1;case"object":return dE(n);case"map":return uE(n);default:throw new TypeError(`Unsupported value of type "${t}"`)}}const yE=Lo,ld={encode:Le,decode:me,byteLength:Lo,encodingLength:yE},pE=/^(\d{1,3}\.){3,3}\d{1,3}$/,ud=4,gE=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,rs=16,yn={name:"v4",size:ud,isFormat:n=>pE.test(n),encode(n,e,t){t=~~t,e=e||new Uint8Array(t+ud);const r=n.length;let i=0;for(let o=0;o<r;){const s=n.charCodeAt(o++);s===46?(e[t++]=i,i=0):i=i*10+(s-48)}return e[t]=i,e},decode(n,e){return e=~~e,`${n[e++]}.${n[e++]}.${n[e++]}.${n[e]}`}},fr={name:"v6",size:rs,isFormat:n=>n.length>0&&gE.test(n),encode(n,e,t){t=~~t;let r=t+rs,i=-1,o=0,s=0,a=!0,l=!1;e=e||new Uint8Array(t+rs);for(let u=0;u<n.length;u++){let c=n.charCodeAt(u);c===58?(a?i!==-1?(t<r&&(e[t]=0),t<r-1&&(e[t+1]=0),t+=2):t<r&&(i=t):(l===!0?(t<r&&(e[t]=s),t++):(t<r&&(e[t]=o>>8),t<r-1&&(e[t+1]=o&255),t+=2),o=0,s=0),a=!0,l=!1):c===46?(t<r&&(e[t]=s),t++,s=0,o=0,a=!1,l=!0):(a=!1,c>=97?c-=87:c>=65?c-=55:(c-=48,s=s*10+c),o=(o<<4)+c)}if(a===!1)l===!0?(t<r&&(e[t]=s),t++):(t<r&&(e[t]=o>>8),t<r-1&&(e[t+1]=o&255),t+=2);else if(i===0)t<r&&(e[t]=0),t<r-1&&(e[t+1]=0),t+=2;else if(i!==-1){t+=2;for(let u=Math.min(t-1,r-1);u>=i+2;u--)e[u]=e[u-2];e[i]=0,e[i+1]=0,i=t}if(i!==t&&i!==-1)for(t>r-2&&(t=r-2);r>i;)e[--r]=t<r&&t>i?e[--t]:0;else for(;t<r;)e[t++]=0;return e},decode(n,e){e=~~e;let t="";for(let r=0;r<rs;r+=2)r!==0&&(t+=":"),t+=(n[e+r]<<8|n[e+r+1]).toString(16);return t.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function jh(n){if(yn.isFormat(n))return yn.size;if(fr.isFormat(n))return fr.size;throw Error(`Invalid ip address: ${n}`)}function wE(n){return jh(n)===yn.size?1:2}function bE(n,e,t){t=~~t;const r=jh(n);return typeof e=="function"&&(e=e(t+r)),r===yn.size?yn.encode(n,e,t):fr.encode(n,e,t)}function vE(n,e,t){if(e=~~e,t=t||n.length-e,t===yn.size)return yn.decode(n,e,t);if(t===fr.size)return fr.decode(n,e,t);throw Error(`Invalid buffer size needs to be ${yn.size} for v4 or ${fr.size} for v6.`)}function ta(n){switch(n){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+n}function _o(n){switch(n.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return n.toUpperCase().startsWith("UNKNOWN_")?parseInt(n.slice(8)):0}function mE(n){switch(n){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+n}function EE(n){switch(n){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+n}function Hh(n){switch(n){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+n}function Vh(n){switch(n.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}function _E(n){switch(n){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return n<0?null:`OPTION_${n}`}function dd(n){if(typeof n=="number")return n;if(!n)return-1;switch(n.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const e=n.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}const bl=55296,xo=56320;function Wh(n){let e=0;const t=n.length;for(let r=0;r<t;r+=1){const i=n.charCodeAt(r);if(i<=127)e+=1;else if(i<=2047)e+=2;else if((i&63488)!==bl)e+=3;else{const o=r+1;o===t||i>=xo||(n.charCodeAt(o)&64512)!==xo?e+=3:(r=o,e+=4)}}return e}function So(n,e,t){const r=n.length;t==null&&(t=0),e===void 0&&(e=new Uint8Array(Wh(n)+t));let i=t;for(let o=0;o<r;o+=1){let s=n.charCodeAt(o);if(s<=127)e[i++]=s;else if(s<=2047)e[i++]=192|(s&1984)>>6,e[i++]=128|s&63;else if((s&63488)!==bl)e[i++]=224|(s&61440)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63;else{const a=o+1;if(a===r||s>=xo)e[i++]=239,e[i++]=191,e[i++]=189;else{const l=n.charCodeAt(a);(l&64512)!==xo?(e[i++]=239,e[i++]=191,e[i++]=189):(o=a,s=65536|(s&1023)<<10|l&1023,e[i++]=240|(s&1835008)>>18,e[i++]=128|(s&258048)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63)}}}return So.bytes=i-t,e}So.bytes=0;function ko(n,e,t){let r="";e==null&&(e=0),t==null&&(t=n.length);for(let i=e;i<t;){const o=n[i++];let s;if(o<=128)s=o;else if(o>191&&o<224)s=(o&31)<<6|n[i++]&63;else if(o>239&&o<365){s=((o&7)<<18|(n[i++]&63)<<12|(n[i++]&63)<<6|n[i++]&63)-65536;const a=bl|s>>10&1023;r+=String.fromCharCode(a),s=xo|s&1023}else s=(o&15)<<12|(n[i++]&63)<<6|n[i++]&63;r+=String.fromCharCode(s)}return ko.bytes=t-e,r}ko.bytes=0;const Zr=n=>n instanceof Uint8Array;function br(n){return typeof n=="string"?Wh(n):n.byteLength}function vl(n){return n instanceof Uint8Array?n:Array.isArray(n)?new Uint8Array(n):So(n)}function ml(n,e,t){if(typeof e!="string")throw new Error("unknown input type");return So(e,n,t),So.bytes}const uo={},qh=new Array(255);for(let n=0;n<=15;n+=1){const e=n.toString(16),t=e.toUpperCase();for(let r=0;r<=15;r+=1){const i=r.toString(16),o=i.toUpperCase(),s=n<<4|r,a=`${e}${i}`;qh[s]=a,uo[a]=s,uo[`${t}${i}`]=s,uo[`${e}${o}`]=s,uo[`${t}${o}`]=s}}function xE(n,e,t){let r="";for(let i=e;i<t;){const o=n[i++];r+=qh[o]}return r}function fd(n){return n.length>>>1}function SE(n,e,t,r){let i=0;for(;t<r;){const o=e.substr(i,2),s=uo[o];if(s===void 0)return;n[t++]=s,i+=2}return n}const AE=Math.pow(2,24),TE=Math.pow(2,16),IE=Math.pow(2,8),Pn=(n,e)=>n[e]*AE+n[e+1]*TE+n[e+2]*IE+n[e+3],Ae=(n,e)=>n[e]<<8|n[e+1],Kn=(n,e,t)=>(e=+e,n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e,t+4),be=(n,e,t)=>(n[t]=e>>8,n[t+1]=e&255,t+2);function Vt(n,e,t,r,i){return t<0&&(r-=t,t=0),r<0&&(r=0),i<0?new Uint8Array(0):t>=e.length||r>=i?0:RE(n,e,t,r,i)}function RE(n,e,t,r,i){i-r>e.length-t&&(i=r+e.length-t);let o=i-r;const s=n.length-r;return o>s&&(o=s),(r!==0||i<n.length)&&(n=new Uint8Array(n.buffer,n.byteOffset+r,o)),e.set(n,t),o}const OE=0,hd=32768,_c=32768,BE=~_c,zh=32768,LE=~zh;function Pe({bytes:n=0,encode:e,decode:t,encodingLength:r}){return e.bytes=n,t.bytes=n,{encode:e,decode:t,encodingLength:r||(()=>n)}}const ce=Pe({encode(n,e,t){e||(e=new Uint8Array(ce.encodingLength(n))),t||(t=0);const r=t,i=n.replace(/^\.|\.$/gm,"");if(i.length){const o=i.split(".");for(let s=0;s<o.length;s++){const a=ml(e,o[s],t+1);e[t]=a,t+=a+1}}return e[t++]=0,ce.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=[];let r=e,i=0,o=0,s=!1;for(;;){if(e>=n.length)throw new Error("Cannot decode name (buffer overflow)");const a=n[e++];if(o+=s?0:1,a===0)break;if(a&192)if((a&192)===192){if(e+1>n.length)throw new Error("Cannot decode name (buffer overflow)");const l=Ae(n,e-1)-49152;if(l>=r)throw new Error("Cannot decode name (bad pointer)");e=l,r=l,o+=s?0:1,s=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+a>n.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=a+1,i>254)throw new Error("Cannot decode name (name too long)");t.push(ko(n,e,e+a)),e+=a,o+=s?0:a}}return ce.decode.bytes=o,t.length===0?".":t.join(".")},encodingLength(n){return n==="."||n===".."?1:br(n.replace(/^\.|\.$/gm,""))+2}}),it=Pe({encode(n,e,t){e||(e=new Uint8Array(it.encodingLength(n))),t||(t=0);const r=ml(e,n,t+1);return e[t]=r,it.encode.bytes=r+1,e},decode(n,e){e||(e=0);const t=n[e],r=ko(n,e+1,e+1+t);return it.decode.bytes=t+1,r},encodingLength(n){return br(n)+1}}),bi=Pe({bytes:12,encode(n,e,t){e||(e=new Uint8Array(bi.encodingLength(n))),t||(t=0);const r=(n.flags||0)&32767,i=n.type==="response"?hd:OE;return be(e,n.id||0,t),be(e,r|i,t+2),be(e,n.questions.length,t+4),be(e,n.answers.length,t+6),be(e,n.authorities.length,t+8),be(e,n.additionals.length,t+10),e},decode(n,e){if(e||(e=0),n.length<12)throw new Error("Header must be 12 bytes");const t=Ae(n,e+2);return{id:Ae(n,e),type:t&hd?"response":"query",flags:t&32767,flag_qr:(t>>15&1)===1,opcode:EE(t>>11&15),flag_aa:(t>>10&1)===1,flag_tc:(t>>9&1)===1,flag_rd:(t>>8&1)===1,flag_ra:(t>>7&1)===1,flag_z:(t>>6&1)===1,flag_ad:(t>>5&1)===1,flag_cd:(t>>4&1)===1,rcode:mE(t&15),questions:new Array(Ae(n,e+4)),answers:new Array(Ae(n,e+6)),authorities:new Array(Ae(n,e+8)),additionals:new Array(Ae(n,e+10))}},encodingLength(){return 12}}),fs=Pe({encode(n,e,t){e||(e=new Uint8Array(fs.encodingLength(n))),t||(t=0);const r=n.length;return be(e,r,t),Vt(n,e,t+2,0,r),fs.encode.bytes=r+2,e},decode(n,e){e||(e=0);const t=Ae(n,e),r=n.slice(e+2,e+2+t);return fs.decode.bytes=t+2,r},encodingLength(n){return n.length+2}}),hs=Pe({encode(n,e,t){return e||(e=new Uint8Array(hs.encodingLength(n))),t||(t=0),ce.encode(n,e,t+2),be(e,ce.encode.bytes,t),hs.encode.bytes=ce.encode.bytes+2,e},decode(n,e){e||(e=0);const t=Ae(n,e),r=ce.decode(n,e+2);return hs.decode.bytes=t+2,r},encodingLength(n){return ce.encodingLength(n)+2}}),ys=Pe({encode(n,e,t){e||(e=new Uint8Array(ys.encodingLength(n))),t||(t=0);const r=t;return t+=2,ce.encode(n.mname,e,t),t+=ce.encode.bytes,ce.encode(n.rname,e,t),t+=ce.encode.bytes,Kn(e,n.serial||0,t),t+=4,Kn(e,n.refresh||0,t),t+=4,Kn(e,n.retry||0,t),t+=4,Kn(e,n.expire||0,t),t+=4,Kn(e,n.minimum||0,t),t+=4,be(e,t-r-2,r),ys.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.mname=ce.decode(n,e),e+=ce.decode.bytes,r.rname=ce.decode(n,e),e+=ce.decode.bytes,r.serial=Pn(n,e),e+=4,r.refresh=Pn(n,e),e+=4,r.retry=Pn(n,e),e+=4,r.expire=Pn(n,e),e+=4,r.minimum=Pn(n,e),e+=4,ys.decode.bytes=e-t,r},encodingLength(n){return 22+ce.encodingLength(n.mname)+ce.encodingLength(n.rname)}}),ps=Pe({encode(n,e,t){Array.isArray(n)||(n=[n]);for(let i=0;i<n.length;i++)if(typeof n[i]=="string"&&(n[i]=vl(n[i])),!Zr(n[i]))throw new Error("Must be a Buffer");e||(e=new Uint8Array(ps.encodingLength(n))),t||(t=0);const r=t;return t+=2,n.forEach(function(i){e[t++]=i.length,Vt(i,e,t,0,i.length),t+=i.length}),be(e,t-r-2,r),ps.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e;let r=Ae(n,e);e+=2;const i=[];for(;r>0;){const o=n[e++];if(--r,r<o)throw new Error("Buffer overflow");i.push(n.slice(e,e+o)),e+=o,r-=o}return ps.decode.bytes=e-t,i},encodingLength(n){Array.isArray(n)||(n=[n]);let e=2;return n.forEach(function(t){typeof t=="string"?e+=br(t)+1:e+=t.length+1}),e}}),gs=Pe({encode(n,e,t){e||(e=new Uint8Array(gs.encodingLength(n))),t||(t=0),typeof n=="string"&&(n=vl(n)),n||(n=new Uint8Array(0));const r=t;t+=2;const i=n.length;return Vt(n,e,t,0,i),t+=i,be(e,t-r-2,r),gs.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r=Ae(n,e);e+=2;const i=n.slice(e,e+r);return e+=r,gs.decode.bytes=e-t,i},encodingLength(n){return n?(Zr(n)?n.length:br(n))+2:2}}),ws=Pe({encode(n,e,t){e||(e=new Uint8Array(ws.encodingLength(n))),t||(t=0);const r=t;return t+=2,it.encode(n.cpu,e,t),t+=it.encode.bytes,it.encode(n.os,e,t),t+=it.encode.bytes,be(e,t-r-2,r),ws.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.cpu=it.decode(n,e),e+=it.decode.bytes,r.os=it.decode(n,e),e+=it.decode.bytes,ws.decode.bytes=e-t,r},encodingLength(n){return it.encodingLength(n.cpu)+it.encodingLength(n.os)+2}}),Ti=Pe({encode(n,e,t){return e||(e=new Uint8Array(Ti.encodingLength(n))),t||(t=0),ce.encode(n,e,t+2),be(e,ce.encode.bytes,t),Ti.encode.bytes=ce.encode.bytes+2,e},decode(n,e){e||(e=0);const t=ce.decode(n,e+2);return Ti.decode.bytes=ce.decode.bytes+2,t},encodingLength(n){return ce.encodingLength(n)+2}}),bs=Pe({encode(n,e,t){e||(e=new Uint8Array(bs.encodingLength(n))),t||(t=0),be(e,n.priority||0,t+2),be(e,n.weight||0,t+4),be(e,n.port||0,t+6),ce.encode(n.target,e,t+8);const r=ce.encode.bytes+6;return be(e,r,t),bs.encode.bytes=r+2,e},decode(n,e){e||(e=0);const t=Ae(n,e),r={};return r.priority=Ae(n,e+2),r.weight=Ae(n,e+4),r.port=Ae(n,e+6),r.target=ce.decode(n,e+8),bs.decode.bytes=t+2,r},encodingLength(n){return 8+ce.encodingLength(n.target)}}),sr=Pe({encode(n,e,t){const r=sr.encodingLength(n);return e||(e=new Uint8Array(sr.encodingLength(n))),t||(t=0),n.issuerCritical&&(n.flags=sr.ISSUER_CRITICAL),be(e,r-2,t),t+=2,e[t]=n.flags||0,t+=1,it.encode(n.tag,e,t),t+=it.encode.bytes,ml(e,n.value,t),t+=br(n.value),sr.encode.bytes=r,e},decode(n,e){e||(e=0);const t=Ae(n,e);e+=2;const r=e,i={};return i.flags=n[e],e+=1,i.tag=it.decode(n,e),e+=it.decode.bytes,i.value=ko(n,e,r+t),i.issuerCritical=!!(i.flags&sr.ISSUER_CRITICAL),sr.decode.bytes=t+2,i},encodingLength(n){return it.encodingLength(n.tag)+it.encodingLength(n.value)+2}});sr.ISSUER_CRITICAL=128;const vs=Pe({encode(n,e,t){e||(e=new Uint8Array(vs.encodingLength(n))),t||(t=0);const r=t;return t+=2,be(e,n.preference||0,t),t+=2,ce.encode(n.exchange,e,t),t+=ce.encode.bytes,be(e,t-r-2,r),vs.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.preference=Ae(n,e),e+=2,r.exchange=ce.decode(n,e),e+=ce.decode.bytes,vs.decode.bytes=e-t,r},encodingLength(n){return 4+ce.encodingLength(n.exchange)}}),Gh=Pe({encode(n,e,t){return e||(e=new Uint8Array(Gh.encodingLength(n))),t||(t=0),be(e,4,t),t+=2,yn.encode(n,e,t),e},decode(n,e){return e||(e=0),e+=2,yn.decode(n,e)},bytes:6}),ms=Pe({encode(n,e,t){return e||(e=new Uint8Array(ms.encodingLength(n))),t||(t=0),be(e,16,t),t+=2,fr.encode(n,e,t),ms.encode.bytes=18,e},decode(n,e){e||(e=0),e+=2;const t=fr.decode(n,e);return ms.decode.bytes=18,t},bytes:18}),kE=n=>new Uint8Array(n),$n=Pe({encode(n,e,t){e||(e=new Uint8Array($n.encodingLength(n))),t||(t=0);const r=t,i=dd(n.code);if(be(e,i,t),t+=2,n.data)be(e,n.data.length,t),t+=2,Vt(n.data,e,t),t+=n.data.length;else switch(i){case 8:{const o=n.sourcePrefixLength||0,s=n.family||wE(n.ip),a=bE(n.ip,kE),l=Math.ceil(o/8);be(e,l+4,t),t+=2,be(e,s,t),t+=2,e[t++]=o,e[t++]=n.scopePrefixLength||0,Vt(a,e,t,0,l),t+=l}break;case 11:n.timeout?(be(e,2,t),t+=2,be(e,n.timeout,t),t+=2):(be(e,0,t),t+=2);break;case 12:{const o=n.length||0;be(e,o,t),t+=2,e.fill(0,t,t+o),t+=o}break;case 14:{const o=n.tags.length*2;be(e,o,t),t+=2;for(const s of n.tags)be(e,s,t),t+=2}break;default:throw new Error(`Unknown roption code: ${n.code}`)}return $n.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t={};t.code=Ae(n,e),t.type=_E(t.code),e+=2;const r=Ae(n,e);switch(e+=2,t.data=n.slice(e,e+r),t.code){case 8:t.family=Ae(n,e),e+=2,t.sourcePrefixLength=n[e++],t.scopePrefixLength=n[e++];{const i=new Uint8Array(t.family===1?4:16);Vt(n,i,0,e,e+r-4),t.ip=vE(i)}break;case 11:r>0&&(t.timeout=Ae(n,e),e+=2);break;case 14:t.tags=[];for(let i=0;i<r;i+=2)t.tags.push(Ae(n,e)),e+=2}return $n.decode.bytes=r+4,t},encodingLength(n){if(n.data)return n.data.length+4;switch(dd(n.code)){case 8:{const t=n.sourcePrefixLength||0;return Math.ceil(t/8)+8}case 11:return typeof n.timeout=="number"?6:4;case 12:return n.length+4;case 14:return 4+n.tags.length*2}throw new Error(`Unknown roption code: ${n.code}`)}}),lr=Pe({encode(n,e,t){e||(e=new Uint8Array(lr.encodingLength(n))),t||(t=0);const r=t,i=mi(n,$n);return be(e,i,t),t=wo(n,$n,e,t+2),lr.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t=e,r=[];let i=Ae(n,e);e+=2;let o=0;for(;i>0;)r[o++]=$n.decode(n,e),e+=$n.decode.bytes,i-=$n.decode.bytes;return lr.decode.bytes=e-t,r},encodingLength(n){return 2+mi(n||[],$n)}}),ln=Pe({encode(n,e,t){e||(e=new Uint8Array(ln.encodingLength(n))),t||(t=0);const r=t,i=n.key;if(!Zr(i))throw new Error("Key must be a Buffer");return t+=2,be(e,n.flags,t),t+=2,e[t]=ln.PROTOCOL_DNSSEC,t+=1,e[t]=n.algorithm,t+=1,Vt(i,e,t,0,i.length),t+=i.length,ln.encode.bytes=t-r,be(e,ln.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);if(e+=2,r.flags=Ae(n,e),e+=2,n[e]!==ln.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,r.algorithm=n[e],e+=1,r.key=n.slice(e,t+i+2),e+=r.key.length,ln.decode.bytes=e-t,r},encodingLength(n){return 6+br(n.key)}});ln.PROTOCOL_DNSSEC=3;ln.ZONE_KEY=128;ln.SECURE_ENTRYPOINT=32768;const fo=Pe({encode(n,e,t){e||(e=new Uint8Array(fo.encodingLength(n))),t||(t=0);const r=t,i=n.signature;if(!Zr(i))throw new Error("Signature must be a Buffer");return t+=2,be(e,_o(n.typeCovered),t),t+=2,e[t]=n.algorithm,t+=1,e[t]=n.labels,t+=1,Kn(e,n.originalTTL,t),t+=4,Kn(e,n.expiration,t),t+=4,Kn(e,n.inception,t),t+=4,be(e,n.keyTag,t),t+=2,ce.encode(n.signersName,e,t),t+=ce.encode.bytes,Vt(i,e,t,0,i.length),t+=i.length,fo.encode.bytes=t-r,be(e,fo.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);return e+=2,r.typeCovered=ta(Ae(n,e)),e+=2,r.algorithm=n[e],e+=1,r.labels=n[e],e+=1,r.originalTTL=Pn(n,e),e+=4,r.expiration=Pn(n,e),e+=4,r.inception=Pn(n,e),e+=4,r.keyTag=Ae(n,e),e+=2,r.signersName=ce.decode(n,e),e+=ce.decode.bytes,r.signature=n.slice(e,t+i+2),e+=r.signature.length,fo.decode.bytes=e-t,r},encodingLength(n){return 20+ce.encodingLength(n.signersName)+br(n.signature)}}),ho=Pe({encode(n,e,t){e||(e=new Uint8Array(ho.encodingLength(n))),t||(t=0);const r=t;return t+=2,ce.encode(n.mbox||".",e,t),t+=ce.encode.bytes,ce.encode(n.txt||".",e,t),t+=ce.encode.bytes,ho.encode.bytes=t-r,be(e,ho.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={};return e+=2,r.mbox=ce.decode(n,e)||".",e+=ce.decode.bytes,r.txt=ce.decode(n,e)||".",e+=ce.decode.bytes,ho.decode.bytes=e-t,r},encodingLength(n){return 2+ce.encodingLength(n.mbox||".")+ce.encodingLength(n.txt||".")}}),kt=Pe({encode(n,e,t){e||(e=new Uint8Array(kt.encodingLength(n))),t||(t=0);const r=t,i=[];for(let o=0;o<n.length;o++){const s=_o(n[o]);i[s>>8]===void 0&&(i[s>>8]=[]),i[s>>8][s>>3&31]|=1<<7-(s&7)}for(let o=0;o<i.length;o++)if(i[o]!==void 0){const s=vl(i[o]);e[t]=o,t+=1,e[t]=s.length,t+=1,Vt(s,e,t,0,s.length),t+=s.length}return kt.encode.bytes=t-r,e},decode(n,e,t){e||(e=0);const r=e,i=[];for(;e-r<t;){const o=n[e];e+=1;const s=n[e];e+=1;for(let a=0;a<s;a++){const l=n[e+a];for(let u=0;u<8;u++)if(l&1<<7-u){const c=ta(o<<8|a<<3|u);i.push(c)}}e+=s}return kt.decode.bytes=e-r,i},encodingLength(n){const e=[];for(let r=0;r<n.length;r++){const i=_o(n[r]);e[i>>8]=Math.max(e[i>>8]||0,i&255)}let t=0;for(let r=0;r<e.length;r++)e[r]!==void 0&&(t+=2+Math.ceil((e[r]+1)/8));return t}}),yo=Pe({encode(n,e,t){e||(e=new Uint8Array(yo.encodingLength(n))),t||(t=0);const r=t;return t+=2,ce.encode(n.nextDomain,e,t),t+=ce.encode.bytes,kt.encode(n.rrtypes,e,t),t+=kt.encode.bytes,yo.encode.bytes=t-r,be(e,yo.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);return e+=2,r.nextDomain=ce.decode(n,e),e+=ce.decode.bytes,r.rrtypes=kt.decode(n,e,i-(e-t)),e+=kt.decode.bytes,yo.decode.bytes=e-t,r},encodingLength(n){return 2+ce.encodingLength(n.nextDomain)+kt.encodingLength(n.rrtypes)}}),po=Pe({encode(n,e,t){e||(e=new Uint8Array(po.encodingLength(n))),t||(t=0);const r=t,i=n.salt;if(!Zr(i))throw new Error("salt must be a Buffer");const o=n.nextDomain;if(!Zr(o))throw new Error("nextDomain must be a Buffer");return t+=2,e[t]=n.algorithm,t+=1,e[t]=n.flags,t+=1,be(e,n.iterations,t),t+=2,e[t]=i.length,t+=1,Vt(i,e,t,0,i.length),t+=i.length,e[t]=o.length,t+=1,Vt(o,e,t,0,o.length),t+=o.length,kt.encode(n.rrtypes,e,t),t+=kt.encode.bytes,po.encode.bytes=t-r,be(e,po.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);e+=2,r.algorithm=n[e],e+=1,r.flags=n[e],e+=1,r.iterations=Ae(n,e),e+=2;const o=n[e];e+=1,r.salt=n.slice(e,e+o),e+=o;const s=n[e];return e+=1,r.nextDomain=n.slice(e,e+s),e+=s,r.rrtypes=kt.decode(n,e,i-(e-t)),e+=kt.decode.bytes,po.decode.bytes=e-t,r},encodingLength(n){return 8+n.salt.length+n.nextDomain.length+kt.encodingLength(n.rrtypes)}}),go=Pe({encode(n,e,t){e||(e=new Uint8Array(go.encodingLength(n))),t||(t=0);const r=t,i=n.digest;if(!Zr(i))throw new Error("Digest must be a Buffer");return t+=2,be(e,n.keyTag,t),t+=2,e[t]=n.algorithm,t+=1,e[t]=n.digestType,t+=1,Vt(i,e,t,0,i.length),t+=i.length,go.encode.bytes=t-r,be(e,go.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={},i=Ae(n,e);return e+=2,r.keyTag=Ae(n,e),e+=2,r.algorithm=n[e],e+=1,r.digestType=n[e],e+=1,r.digest=n.slice(e,t+i+2),e+=r.digest.length,go.decode.bytes=e-t,r},encodingLength(n){return 6+br(n.digest)}}),vi=Pe({encode(n,e,t){e||(e=new Uint8Array(vi.encodingLength(n))),t||(t=0);const r=t;t+=2,e[t]=n.algorithm,t+=1,e[t]=n.hash,t+=1;const i=fd(n.fingerprint),o=xc(n.hash);if(i!==o)throw new Error(`Invalid length of fingerprint "${n.fingerprint}" for hashType=${n.hash}: ${i} != ${o}`);return SE(e,n.fingerprint,t,t+=i),vi.encode.bytes=t-r,be(e,vi.encode.bytes-2,r),e},decode(n,e){e||(e=0);const t=e,r={};e+=2,r.algorithm=n[e],e+=1,r.hash=n[e],e+=1;const i=xc(r.hash);return r.fingerprint=xE(n,e,e+i),e+=i,vi.decode.bytes=e-t,r},encodingLength(n){return 4+fd(n.fingerprint)}});function xc(n){if(n===1)return 20;if(n===2)return 32;throw new Error(`Invalid hashType=${n}, supported=1,2`)}vi.getFingerprintLengthForHashType=xc;function Ya(n){switch(n.toUpperCase()){case"A":return Gh;case"PTR":return Ti;case"CNAME":return Ti;case"DNAME":return Ti;case"TXT":return ps;case"NULL":return gs;case"AAAA":return ms;case"SRV":return bs;case"HINFO":return ws;case"CAA":return sr;case"NS":return hs;case"SOA":return ys;case"MX":return vs;case"OPT":return lr;case"DNSKEY":return ln;case"RRSIG":return fo;case"RP":return ho;case"NSEC":return yo;case"NSEC3":return po;case"SSHFP":return vi;case"DS":return go}return fs}const Kt=Pe({encode(n,e,t){e||(e=new Uint8Array(Kt.encodingLength(n))),t||(t=0);const r=t;if(ce.encode(n.name,e,t),t+=ce.encode.bytes,be(e,_o(n.type),t),n.type.toUpperCase()==="OPT"){if(n.name!==".")throw new Error("OPT name must be root.");be(e,n.udpPayloadSize||4096,t+2),e[t+4]=n.extendedRcode||0,e[t+5]=n.ednsVersion||0,be(e,n.flags||0,t+6),t+=8,lr.encode(n.options||[],e,t),t+=lr.encode.bytes}else{let i=Vh(n.class===void 0?"IN":n.class);n.flush&&(i|=_c),be(e,i,t+2),Kn(e,n.ttl||0,t+4),t+=8;const o=Ya(n.type);o.encode(n.data,e,t),t+=o.encode.bytes}return Kt.encode.bytes=t-r,e},decode(n,e){e||(e=0);const t={},r=e;if(t.name=ce.decode(n,e),e+=ce.decode.bytes,t.type=ta(Ae(n,e)),t.type==="OPT")t.udpPayloadSize=Ae(n,e+2),t.extendedRcode=n[e+4],t.ednsVersion=n[e+5],t.flags=Ae(n,e+6),t.flag_do=(t.flags>>15&1)===1,t.options=lr.decode(n,e+8),e+=8+lr.decode.bytes;else{const i=Ae(n,e+2);t.ttl=Pn(n,e+4),t.class=Hh(i&BE),t.flush=!!(i&_c);const o=Ya(t.type);t.data=o.decode(n,e+8),e+=8+o.decode.bytes}return Kt.decode.bytes=e-r,t},encodingLength(n){const e=n.data!==null&&n.data!==void 0?n.data:n.options;return ce.encodingLength(n.name)+8+Ya(n.type).encodingLength(e)}}),Ii=Pe({encode(n,e,t){e||(e=new Uint8Array(Ii.encodingLength(n))),t||(t=0);const r=t;return ce.encode(n.name,e,t),t+=ce.encode.bytes,be(e,_o(n.type),t),t+=2,be(e,Vh(n.class===void 0?"IN":n.class),t),t+=2,Ii.encode.bytes=t-r,n},decode(n,e){e||(e=0);const t=e,r={};return r.name=ce.decode(n,e),e+=ce.decode.bytes,r.type=ta(Ae(n,e)),e+=2,r.class=Hh(Ae(n,e)),e+=2,!!(r.class&zh)&&(r.class&=LE),Ii.decode.bytes=e-t,r},encodingLength(n){return ce.encodingLength(n.name)+4}}),CE=1024,Qr={encode:function(n,e,t){const r=!e;r&&(e=new Uint8Array($E(n))),t||(t=0);const i=t;return n.questions||(n.questions=[]),n.answers||(n.answers=[]),n.authorities||(n.authorities=[]),n.additionals||(n.additionals=[]),bi.encode(n,e,t),t+=bi.encode.bytes,t=wo(n.questions,Ii,e,t),t=wo(n.answers,Kt,e,t),t=wo(n.authorities,Kt,e,t),t=wo(n.additionals,Kt,e,t),Qr.encode.bytes=t-i,r&&Sc.bytes!==e.length?e.slice(0,Sc.bytes):e},decode:function(n,e){e||(e=0);const t=e,r=bi.decode(n,e);return e+=bi.decode.bytes,e=is(r.questions,Ii,n,e),e=is(r.answers,Kt,n,e),e=is(r.authorities,Kt,n,e),e=is(r.additionals,Kt,n,e),Qr.decode.bytes=e-t,r},encodingLength:function(n){return bi.encodingLength(n)+mi(n.questions||[],Ii)+mi(n.answers||[],Kt)+mi(n.authorities||[],Kt)+mi(n.additionals||[],Kt)}};Qr.encode.bytes=0;Qr.decode.bytes=0;const Sc=Qr.encode,UE=Qr.decode,$E=Qr.encodingLength;function mi(n,e){let t=0;for(let r=0;r<n.length;r++)t+=e.encodingLength(n[r]);return t}function wo(n,e,t,r){for(let i=0;i<n.length;i++)e.encode(n[i],t,r),r+=e.encode.bytes;return r}function is(n,e,t,r){for(let i=0;i<n.length;i++)n[i]=e.decode(t,r),r+=e.decode.bytes;return r}var yd=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Co{static getSigningMethod(e){return yd(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,t){return yd(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}}var ct=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},pd=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const gd="https://diddht.tbddev.org",NE=0,ir=7200,Es=";",bt=",";var Ac;(function(n){n[n.Discoverable=0]="Discoverable",n[n.Organization=1]="Organization",n[n.Government=2]="Government",n[n.Corporation=3]="Corporation",n[n.LocalBusiness=4]="LocalBusiness",n[n.SoftwarePackage=5]="SoftwarePackage",n[n.WebApp=6]="WebApp",n[n.FinancialInstitution=7]="FinancialInstitution"})(Ac||(Ac={}));var vt;(function(n){n[n.Ed25519=0]="Ed25519",n[n.secp256k1=1]="secp256k1",n[n.secp256r1=2]="secp256r1",n[n.X25519=3]="X25519"})(vt||(vt={}));var Tc;(function(n){n.authentication="auth",n.assertionMethod="asm",n.capabilityDelegation="del",n.capabilityInvocation="inv",n.keyAgreement="agm"})(Tc||(Tc={}));const Yh={Ed25519:vt.Ed25519,ES256K:vt.secp256k1,ES256:vt.secp256r1,"P-256":vt.secp256r1,secp256k1:vt.secp256k1,secp256r1:vt.secp256r1,X25519:vt.X25519},wd={[vt.Ed25519]:"Ed25519",[vt.secp256k1]:"ES256K",[vt.secp256r1]:"ES256",[vt.X25519]:"ECDH-ES+A256KW"};class ei extends Co{static create(){return ct(this,arguments,void 0,function*({keyManager:e=new Hn,options:t={}}={}){var r,i,o,s,a,l,u,c,h,m,E;if(!((r=t.verificationMethods)===null||r===void 0)&&r.some(x=>!(x.algorithm in Yh)))throw new Error("One or more verification method algorithms are not supported");const g=(i=t.verificationMethods)===null||i===void 0?void 0:i.filter(x=>"id"in x).map(x=>x.id);if(g&&g.length!==new Set(g).size)throw new Error("One or more verification method IDs are not unique");if(!((o=t.services)===null||o===void 0)&&o.some(x=>!x.id||!x.type||!x.serviceEndpoint))throw new Error("One or more services are missing required properties");const S=yield e.generateKey({algorithm:"Ed25519"}),C=yield e.getPublicKey({keyUri:S}),B=yield nt.identityKeyToIdentifier({identityKey:C}),A=Object.assign(Object.assign({id:B},t.alsoKnownAs&&{alsoKnownAs:t.alsoKnownAs}),t.controllers&&{controller:t.controllers}),O=[...(s=t.verificationMethods)!==null&&s!==void 0?s:[]];O!=null&&O.some(x=>{var D;return((D=x.id)===null||D===void 0?void 0:D.split("#").pop())==="0"})||O.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const x of O){const D=x.id&&x.id.split("#").pop()==="0"?S:yield e.generateKey({algorithm:x.algorithm}),H=yield e.getPublicKey({keyUri:D});let z=(l=(a=x.id)!==null&&a!==void 0?a:H.kid)!==null&&l!==void 0?l:yield Ue({jwk:H});z=`${B}#${Xt(z)}`,(u=A.verificationMethod)!==null&&u!==void 0||(A.verificationMethod=[]),A.verificationMethod.push({id:z,type:"JsonWebKey",controller:(c=x.controller)!==null&&c!==void 0?c:B,publicKeyJwk:H});for(const Q of(h=x.purposes)!==null&&h!==void 0?h:[])A[Q]||(A[Q]=[]),A[Q].push(z)}(m=t.services)===null||m===void 0||m.forEach(x=>{var D;(D=A.service)!==null&&D!==void 0||(A.service=[]),x.id=`${B}#${x.id.split("#").pop()}`,A.service.push(x)});const I=new vn({uri:B,document:A,metadata:Object.assign({published:!1},t.types&&{types:t.types}),keyManager:e});if(!((E=t.publish)!==null&&E!==void 0)||E){const x=yield ei.publish({did:I,gatewayUri:t.gatewayUri});I.metadata=x.didDocumentMetadata}return I})}static import(e){return ct(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Hn}){var i;const o=Be.parse(t.uri);if((o==null?void 0:o.method)!==ei.methodName)throw new pe(fe.MethodNotSupported,"Method not supported");const s=yield vn.import({portableDid:t,keyManager:r});if(!(!((i=s.document.verificationMethod)===null||i===void 0)&&i.some(a=>{var l;return((l=a.id)===null||l===void 0?void 0:l.split("#").pop())==="0"})))throw new pe(fe.InvalidDidDocument,"DID document must contain an Identity Key");return s})}static getSigningMethod(e){return ct(this,arguments,void 0,function*({didDocument:t,methodId:r="#0"}){var i;const o=Be.parse(t.id);if(o&&o.method!==this.methodName)throw new pe(fe.MethodNotSupported,`Method not supported: ${o.method}`);const s=(i=t.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var l,u;return Xt(a.id)===((l=Xt(r))!==null&&l!==void 0?l:Xt((u=t.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(s&&s.publicKeyJwk))throw new pe(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static publish(e){return ct(this,arguments,void 0,function*({did:t,gatewayUri:r=gd}){return yield Nn.put({did:t,gatewayUri:r})})}static resolve(e){return ct(this,arguments,void 0,function*(t,r={}){var i;const o=(i=r==null?void 0:r.gatewayUri)!==null&&i!==void 0?i:gd;try{yield nt.identifierToIdentityKey({didUri:t});const{didDocument:s,didDocumentMetadata:a}=yield Nn.get({didUri:t,gatewayUri:o});return Object.assign(Object.assign({},yt),{didDocument:s,didDocumentMetadata:a})}catch(s){if(!(s instanceof pe))throw new Error(s);return Object.assign(Object.assign({},yt),{didResolutionMetadata:Object.assign({error:s.code},s.message&&{errorMessage:s.message})})}})}}ei.methodName="dht";class Nn{static get(e){return ct(this,arguments,void 0,function*({didUri:t,gatewayUri:r}){const i=nt.identifierToIdentityKeyBytes({didUri:t}),o=yield Nn.pkarrGet({gatewayUri:r,publicKeyBytes:i}),s=yield nt.parseBep44GetMessage({bep44Message:o}),a=yield Nn.fromDnsPacket({didUri:t,dnsPacket:s});return a.didDocumentMetadata.versionId=o.seq.toString(),a})}static put(e){return ct(this,arguments,void 0,function*({did:t,gatewayUri:r}){const i=yield Nn.toDnsPacket({didDocument:t.document,didMetadata:t.metadata,authoritativeGatewayUris:[r]}),o=yield nt.createBep44PutMessage({dnsPacket:i,publicKeyBytes:nt.identifierToIdentityKeyBytes({didUri:t.uri}),signer:yield t.getSigner({methodId:"0"})}),s=yield Nn.pkarrPut({gatewayUri:r,bep44Message:o});return{didDocument:t.document,didDocumentMetadata:Object.assign(Object.assign({},t.metadata),{published:s,versionId:o.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ct(this,arguments,void 0,function*({gatewayUri:t,publicKeyBytes:r}){const i=se.uint8Array(r).toBase32Z(),o=new URL(i,t).href;let s;try{if(s=yield fetch(o,{method:"GET"}),!s.ok)throw new pe(fe.NotFound,`Pkarr record not found for: ${i}`)}catch(u){throw u instanceof pe?u:new pe(fe.InternalError,`Failed to fetch Pkarr record: ${u.message}`)}const a=yield s.arrayBuffer();if(!a)throw new pe(fe.NotFound,`Pkarr record not found for: ${i}`);if(a.byteLength<72)throw new pe(fe.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new pe(fe.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:r,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ct(this,arguments,void 0,function*({gatewayUri:t,bep44Message:r}){const i=se.uint8Array(r.k).toBase32Z(),o=new URL(i,t).href,s=new Uint8Array(r.v.length+72);s.set(r.sig,0),new DataView(s.buffer).setBigUint64(r.sig.length,BigInt(r.seq)),s.set(r.v,r.sig.length+8);let a;try{a=yield fetch(o,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:s})}catch(l){throw new pe(fe.InternalError,`Failed to put Pkarr record for identifier ${i}: ${l.message}`)}return a.ok})}static fromDnsPacket(e){return ct(this,arguments,void 0,function*({didUri:t,dnsPacket:r}){var i,o,s;const a={id:t},l={published:!0},u=new Map;for(const c of(i=r==null?void 0:r.answers)!==null&&i!==void 0?i:[]){if(c.type!=="TXT")continue;const h=c.name.split(".")[0].substring(1);switch(!0){case h.startsWith("aka"):{const m=nt.parseTxtDataToString(c.data);a.alsoKnownAs=m.split(bt);break}case h.startsWith("cnt"):{const m=nt.parseTxtDataToString(c.data);a.controller=m.includes(bt)?m.split(bt):m;break}case h.startsWith("k"):{const{id:m,t:E,k:g,c:S,a:C}=nt.parseTxtDataToObject(c.data),B=se.base64Url(g).toUint8Array(),A=vt[Number(E)];let O=yield nt.keyConverter(A).bytesToPublicKey({publicKeyBytes:B});O.alg=C||wd[Number(E)];const I=h==="k0"?"0":m!==void 0?m:yield Ue({jwk:O});(o=a.verificationMethod)!==null&&o!==void 0||(a.verificationMethod=[]);const x=`${t}#${I}`;a.verificationMethod.push({id:x,type:"JsonWebKey",controller:S??t,publicKeyJwk:O}),u.set(h,x);break}case h.startsWith("s"):{const m=nt.parseTxtDataToObject(c.data),{id:E,t:g,se:S}=m,C=pd(m,["id","t","se"]),B=S.includes(bt)?S.split(bt):[S],A=Object.fromEntries(Object.entries(C).map(([O,I])=>[O,I.includes(bt)?I.split(bt):I]));(s=a.service)!==null&&s!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},A),{id:`${t}#${E}`,type:g,serviceEndpoint:B}));break}case h.startsWith("typ"):{const{id:m}=nt.parseTxtDataToObject(c.data);l.types=m.split(bt).map(E=>Number(E));break}case h.startsWith("did"):{const m=A=>A.split(bt).map(O=>u.get(O)).filter(O=>typeof O=="string"),{auth:E,asm:g,del:S,inv:C,agm:B}=nt.parseTxtDataToObject(c.data);E&&(a.authentication=m(E)),g&&(a.assertionMethod=m(g)),S&&(a.capabilityDelegation=m(S)),C&&(a.capabilityInvocation=m(C)),B&&(a.keyAgreement=m(B));break}}}return{didDocument:a,didDocumentMetadata:l,didResolutionMetadata:{}}})}static toDnsPacket(e){return ct(this,arguments,void 0,function*({didDocument:t,didMetadata:r,authoritativeGatewayUris:i,previousDidProof:o}){var s,a,l,u,c;const h=[],m=[],E=new Map,g=[],S=[];if(o!==void 0){const{signature:A,previousDid:O}=o;yield nt.validatePreviousDidProof({newDid:t.id,previousDidProof:o}),h.push({type:"TXT",name:"_prv._did.",ttl:ir,data:`id=${O};s=${A}`})}if(t.alsoKnownAs&&h.push({type:"TXT",name:"_aka._did.",ttl:ir,data:t.alsoKnownAs.join(bt)}),t.controller){const A=Array.isArray(t.controller)?t.controller.join(bt):t.controller;h.push({type:"TXT",name:"_cnt._did.",ttl:ir,data:A})}for(const[A,O]of(a=(s=t.verificationMethod)===null||s===void 0?void 0:s.entries())!==null&&a!==void 0?a:[]){const I=`k${A}`;S.push(I);let x=O.id.split("#").pop();E.set(x,I);const D=O.publicKeyJwk;if(!(D!=null&&D.crv&&D.crv in Yh))throw new pe(fe.InvalidPublicKeyType,`Verification method '${O.id}' contains an unsupported key type: ${(l=D==null?void 0:D.crv)!==null&&l!==void 0?l:"undefined"}`);const H=vt[D.crv],z=yield nt.keyConverter(D.crv).publicKeyToBytes({publicKey:D}),Q=se.uint8Array(z).toBase64Url(),P=[`t=${H}`,`k=${Q}`];x!=="0"&&(yield Ue({jwk:D}))!==x&&P.unshift(`id=${x}`),D.alg!==wd[H]&&P.push(`a=${D.alg}`),O.controller!==t.id&&P.push(`c=${O.controller}`),h.push({type:"TXT",name:`_${I}._did.`,ttl:ir,data:P.join(Es)})}(u=t.service)===null||u===void 0||u.forEach((A,O)=>{const I=`s${O}`;g.push(I);let{id:x,type:D,serviceEndpoint:H}=A,z=pd(A,["id","type","serviceEndpoint"]);x=Xt(x),H=Array.isArray(H)?H.join(","):H;const P=Object.entries(Object.assign({id:x,t:D,se:H},z)).map(([ie,ee])=>`${ie}=${ee}`).join(Es),G=nt.chunkDataIfNeeded(P);h.push({type:"TXT",name:`_${I}._did.`,ttl:ir,data:G})});const C=[`v=${NE}`];if(S.length&&C.push(`vm=${S.join(bt)}`),Object.keys(vo).forEach(A=>{var O;const I=(O=t[A])===null||O===void 0?void 0:O.map(x=>E.get(x.split("#").pop()));if(I){const x=Tc[A];C.push(`${x}=${I.join(bt)}`)}}),g.length&&C.push(`svc=${g.join(bt)}`),!((c=r.types)===null||c===void 0)&&c.length){const O=r.types.map(I=>typeof I=="string"?Ac[I]:I);h.push({type:"TXT",name:"_typ._did.",ttl:ir,data:`id=${O.join(bt)}`})}h.push({type:"TXT",name:"_did."+Nn.getUniqueDidSuffix(t.id)+".",ttl:ir,data:C.join(Es)});for(const A of i||[])m.push({type:"NS",name:"_did."+Nn.getUniqueDidSuffix(t.id)+".",ttl:ir,data:A+"."});return{id:0,type:"response",flags:CE,answers:[...h,...m]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}}class nt{static createBep44PutMessage(e){return ct(this,arguments,void 0,function*({dnsPacket:t,publicKeyBytes:r,signer:i}){const o=Math.ceil(Date.now()/1e3),s=Sc(t),a=ld.encode({seq:o,v:s}).subarray(1,-1);if(a.length>1e3)throw new pe(fe.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const l=yield i.sign({data:a});return{k:r,seq:o,sig:l,v:s}})}static identifierToIdentityKey(e){return ct(this,arguments,void 0,function*({didUri:t}){let r=nt.identifierToIdentityKeyBytes({didUri:t});return yield Ge.bytesToPublicKey({publicKeyBytes:r})})}static identifierToIdentityKeyBytes({didUri:e}){const t=Be.parse(e);if(!t)throw new pe(fe.InvalidDid,`Invalid DID URI: ${e}`);if(t.method!==ei.methodName)throw new pe(fe.MethodNotSupported,`Method not supported: ${t.method}`);let r;try{r=se.base32Z(t.id).toUint8Array()}catch{throw new pe(fe.InvalidPublicKey,"Failed to decode method-specific identifier")}if(r.length!==32)throw new pe(fe.InvalidPublicKeyLength,`Invalid public key length: ${r.length}`);return r}static identityKeyToIdentifier(e){return ct(this,arguments,void 0,function*({identityKey:t}){const r=yield Ge.publicKeyToBytes({publicKey:t}),i=se.uint8Array(r).toBase32Z();return`did:${ei.methodName}:${i}`})}static keyConverter(e){const r={Ed25519:Ge,"P-256":{publicKeyToBytes:i=>ct(this,[i],void 0,function*({publicKey:o}){const s=yield ze.publicKeyToBytes({publicKey:o});return yield ze.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:ze.bytesToPublicKey,privateKeyToBytes:ze.privateKeyToBytes,bytesToPrivateKey:ze.bytesToPrivateKey},secp256k1:{publicKeyToBytes:i=>ct(this,[i],void 0,function*({publicKey:o}){const s=yield We.publicKeyToBytes({publicKey:o});return yield We.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:We.bytesToPublicKey,privateKeyToBytes:We.privateKeyToBytes,bytesToPrivateKey:We.bytesToPrivateKey},X25519:Fr}[e];if(!r)throw new pe(fe.InvalidPublicKeyType,`Unsupported curve: ${e}`);return r}static parseBep44GetMessage(e){return ct(this,arguments,void 0,function*({bep44Message:t}){const r=yield Ge.bytesToPublicKey({publicKeyBytes:t.k}),i=ld.encode({seq:t.seq,v:t.v}).subarray(1,-1);if(!(yield Ge.verify({key:r,signature:t.sig,data:i})))throw new pe(fe.InvalidSignature,"Invalid signature for DHT BEP44 message");return UE(t.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(Es).reduce((t,r)=>{const[i,o]=r.split("=");return t[i]=o,t},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return se.uint8Array(e).toString();if(Array.isArray(e))return e.map(t=>this.parseTxtDataToString(t)).join("");throw new pe(fe.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ct(this,arguments,void 0,function*({newDid:t,previousDidProof:r}){const i=yield nt.identifierToIdentityKey({didUri:r.previousDid}),o=nt.identifierToIdentityKeyBytes({didUri:t}),s=se.base64Url(r.signature).toUint8Array();if(!(yield Ge.verify({key:i,data:o,signature:s})))throw new pe(fe.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const t=[];for(let r=0;r<e.length;r+=255)t.push(e.slice(r,r+255));return t}}const Xe={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};class Ze extends Error{constructor(e,t){super(`${e}: ${t}`),this.code=e,Object.setPrototypeOf(this,new.target.prototype)}}const DE=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")};let PE=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}};class KE{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Jh(this,e)}}class ME{constructor(e){this.decoders=e}or(e){return Jh(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Jh=(n,e)=>new ME({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class FE{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new PE(e,t,r),this.decoder=new KE(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const jE=({name:n,prefix:e,encode:t,decode:r})=>new FE(n,e,t,r),HE=(n,e,t,r)=>{const i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=n.length;for(;n[o-1]==="=";)--o;const s=new Uint8Array(o*t/8|0);let a=0,l=0,u=0;for(let c=0;c<o;++c){const h=i[n[c]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<t|h,a+=t,a>=8&&(a-=8,s[u++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return s},VE=(n,e,t)=>{const r=e[e.length-1]==="=",i=(1<<t)-1;let o="",s=0,a=0;for(let l=0;l<n.length;++l)for(a=a<<8|n[l],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),r)for(;o.length*t&7;)o+="=";return o},na=({name:n,prefix:e,bitsPerChar:t,alphabet:r})=>jE({prefix:e,name:n,encode(i){return VE(i,r,t)},decode(i){return HE(i,r,t,n)}});na({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});na({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const bd=na({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});na({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});class pn{static encode(e){return bd.baseEncode(e)}static decodeAsBytes(e,t){if(!pn.isBase64UrlString(e))throw new Ze(Xe.EncodedStringIncorrectEncoding,`Given ${t} must be base64url string.`);return bd.baseDecode(e)}static decodeAsString(e,t){const r=pn.decodeAsBytes(e,t);return pn.bytesToString(r)}static isBase64UrlString(e){return/^[A-Za-z0-9_-]+$/.test(e)}static stringToBytes(e){return new TextEncoder().encode(e)}static bytesToString(e){return new TextDecoder().decode(e)}}var Ic={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(n,e){(function(t,r){r(e)})(Fy,function(t){function r(){for(var T=arguments.length,b=Array(T),R=0;R<T;R++)b[R]=arguments[R];if(b.length>1){b[0]=b[0].slice(0,-1);for(var F=b.length-1,M=1;M<F;++M)b[M]=b[M].slice(1,-1);return b[F]=b[F].slice(1),b.join("")}else return b[0]}function i(T){return"(?:"+T+")"}function o(T){return T===void 0?"undefined":T===null?"null":Object.prototype.toString.call(T).split(" ").pop().split("]").shift().toLowerCase()}function s(T){return T.toUpperCase()}function a(T){return T!=null?T instanceof Array?T:typeof T.length!="number"||T.split||T.setInterval||T.call?[T]:Array.prototype.slice.call(T):[]}function l(T,b){var R=T;if(b)for(var F in b)R[F]=b[F];return R}function u(T){var b="[A-Za-z]",R="[0-9]",F=r(R,"[A-Fa-f]"),M=i(i("%[EFef]"+F+"%"+F+F+"%"+F+F)+"|"+i("%[89A-Fa-f]"+F+"%"+F+F)+"|"+i("%"+F+F)),ye="[\\:\\/\\?\\#\\[\\]\\@]",ge="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Oe=r(ye,ge),Fe=T?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Ye=T?"[\\uE000-\\uF8FF]":"[]",Re=r(b,R,"[\\-\\.\\_\\~]",Fe);i(b+r(b,R,"[\\+\\-\\.]")+"*"),i(i(M+"|"+r(Re,ge,"[\\:]"))+"*");var Ke=i(i("25[0-5]")+"|"+i("2[0-4]"+R)+"|"+i("1"+R+R)+"|"+i("0?[1-9]"+R)+"|0?0?"+R),Je=i(Ke+"\\."+Ke+"\\."+Ke+"\\."+Ke),_e=i(F+"{1,4}"),je=i(i(_e+"\\:"+_e)+"|"+Je),tt=i(i(_e+"\\:")+"{6}"+je),He=i("\\:\\:"+i(_e+"\\:")+"{5}"+je),Gn=i(i(_e)+"?\\:\\:"+i(_e+"\\:")+"{4}"+je),Zt=i(i(i(_e+"\\:")+"{0,1}"+_e)+"?\\:\\:"+i(_e+"\\:")+"{3}"+je),Qt=i(i(i(_e+"\\:")+"{0,2}"+_e)+"?\\:\\:"+i(_e+"\\:")+"{2}"+je),ai=i(i(i(_e+"\\:")+"{0,3}"+_e)+"?\\:\\:"+_e+"\\:"+je),Er=i(i(i(_e+"\\:")+"{0,4}"+_e)+"?\\:\\:"+je),Ut=i(i(i(_e+"\\:")+"{0,5}"+_e)+"?\\:\\:"+_e),en=i(i(i(_e+"\\:")+"{0,6}"+_e)+"?\\:\\:"),_r=i([tt,He,Gn,Zt,Qt,ai,Er,Ut,en].join("|")),Sn=i(i(Re+"|"+M)+"+");i("[vV]"+F+"+\\."+r(Re,ge,"[\\:]")+"+"),i(i(M+"|"+r(Re,ge))+"*");var Fi=i(M+"|"+r(Re,ge,"[\\:\\@]"));return i(i(M+"|"+r(Re,ge,"[\\@]"))+"+"),i(i(Fi+"|"+r("[\\/\\?]",Ye))+"*"),{NOT_SCHEME:new RegExp(r("[^]",b,R,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(r("[^\\%\\:]",Re,ge),"g"),NOT_HOST:new RegExp(r("[^\\%\\[\\]\\:]",Re,ge),"g"),NOT_PATH:new RegExp(r("[^\\%\\/\\:\\@]",Re,ge),"g"),NOT_PATH_NOSCHEME:new RegExp(r("[^\\%\\/\\@]",Re,ge),"g"),NOT_QUERY:new RegExp(r("[^\\%]",Re,ge,"[\\:\\@\\/\\?]",Ye),"g"),NOT_FRAGMENT:new RegExp(r("[^\\%]",Re,ge,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(r("[^]",Re,ge),"g"),UNRESERVED:new RegExp(Re,"g"),OTHER_CHARS:new RegExp(r("[^\\%]",Re,Oe),"g"),PCT_ENCODED:new RegExp(M,"g"),IPV4ADDRESS:new RegExp("^("+Je+")$"),IPV6ADDRESS:new RegExp("^\\[?("+_r+")"+i(i("\\%25|\\%(?!"+F+"{2})")+"("+Sn+")")+"?\\]?$")}}var c=u(!1),h=u(!0),m=function(){function T(b,R){var F=[],M=!0,ye=!1,ge=void 0;try{for(var Oe=b[Symbol.iterator](),Fe;!(M=(Fe=Oe.next()).done)&&(F.push(Fe.value),!(R&&F.length===R));M=!0);}catch(Ye){ye=!0,ge=Ye}finally{try{!M&&Oe.return&&Oe.return()}finally{if(ye)throw ge}}return F}return function(b,R){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return T(b,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(T){if(Array.isArray(T)){for(var b=0,R=Array(T.length);b<T.length;b++)R[b]=T[b];return R}else return Array.from(T)},g=2147483647,S=36,C=1,B=26,A=38,O=700,I=72,x=128,D="-",H=/^xn--/,z=/[^\0-\x7E]/,Q=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},G=S-C,ie=Math.floor,ee=String.fromCharCode;function oe(T){throw new RangeError(P[T])}function K(T,b){for(var R=[],F=T.length;F--;)R[F]=b(T[F]);return R}function J(T,b){var R=T.split("@"),F="";R.length>1&&(F=R[0]+"@",T=R[1]),T=T.replace(Q,".");var M=T.split("."),ye=K(M,b).join(".");return F+ye}function ne(T){for(var b=[],R=0,F=T.length;R<F;){var M=T.charCodeAt(R++);if(M>=55296&&M<=56319&&R<F){var ye=T.charCodeAt(R++);(ye&64512)==56320?b.push(((M&1023)<<10)+(ye&1023)+65536):(b.push(M),R--)}else b.push(M)}return b}var j=function(b){return String.fromCodePoint.apply(String,E(b))},$=function(b){return b-48<10?b-22:b-65<26?b-65:b-97<26?b-97:S},N=function(b,R){return b+22+75*(b<26)-((R!=0)<<5)},X=function(b,R,F){var M=0;for(b=F?ie(b/O):b>>1,b+=ie(b/R);b>G*B>>1;M+=S)b=ie(b/G);return ie(M+(G+1)*b/(b+A))},te=function(b){var R=[],F=b.length,M=0,ye=x,ge=I,Oe=b.lastIndexOf(D);Oe<0&&(Oe=0);for(var Fe=0;Fe<Oe;++Fe)b.charCodeAt(Fe)>=128&&oe("not-basic"),R.push(b.charCodeAt(Fe));for(var Ye=Oe>0?Oe+1:0;Ye<F;){for(var Re=M,Ke=1,Je=S;;Je+=S){Ye>=F&&oe("invalid-input");var _e=$(b.charCodeAt(Ye++));(_e>=S||_e>ie((g-M)/Ke))&&oe("overflow"),M+=_e*Ke;var je=Je<=ge?C:Je>=ge+B?B:Je-ge;if(_e<je)break;var tt=S-je;Ke>ie(g/tt)&&oe("overflow"),Ke*=tt}var He=R.length+1;ge=X(M-Re,He,Re==0),ie(M/He)>g-ye&&oe("overflow"),ye+=ie(M/He),M%=He,R.splice(M++,0,ye)}return String.fromCodePoint.apply(String,R)},le=function(b){var R=[];b=ne(b);var F=b.length,M=x,ye=0,ge=I,Oe=!0,Fe=!1,Ye=void 0;try{for(var Re=b[Symbol.iterator](),Ke;!(Oe=(Ke=Re.next()).done);Oe=!0){var Je=Ke.value;Je<128&&R.push(ee(Je))}}catch(ji){Fe=!0,Ye=ji}finally{try{!Oe&&Re.return&&Re.return()}finally{if(Fe)throw Ye}}var _e=R.length,je=_e;for(_e&&R.push(D);je<F;){var tt=g,He=!0,Gn=!1,Zt=void 0;try{for(var Qt=b[Symbol.iterator](),ai;!(He=(ai=Qt.next()).done);He=!0){var Er=ai.value;Er>=M&&Er<tt&&(tt=Er)}}catch(ji){Gn=!0,Zt=ji}finally{try{!He&&Qt.return&&Qt.return()}finally{if(Gn)throw Zt}}var Ut=je+1;tt-M>ie((g-ye)/Ut)&&oe("overflow"),ye+=(tt-M)*Ut,M=tt;var en=!0,_r=!1,Sn=void 0;try{for(var Fi=b[Symbol.iterator](),Tl;!(en=(Tl=Fi.next()).done);en=!0){var Il=Tl.value;if(Il<M&&++ye>g&&oe("overflow"),Il==M){for(var Uo=ye,$o=S;;$o+=S){var No=$o<=ge?C:$o>=ge+B?B:$o-ge;if(Uo<No)break;var Rl=Uo-No,Ol=S-No;R.push(ee(N(No+Rl%Ol,0))),Uo=ie(Rl/Ol)}R.push(ee(N(Uo,0))),ge=X(ye,Ut,je==_e),ye=0,++je}}}catch(ji){_r=!0,Sn=ji}finally{try{!en&&Fi.return&&Fi.return()}finally{if(_r)throw Sn}}++ye,++M}return R.join("")},he=function(b){return J(b,function(R){return H.test(R)?te(R.slice(4).toLowerCase()):R})},we=function(b){return J(b,function(R){return z.test(R)?"xn--"+le(R):R})},ue={version:"2.1.0",ucs2:{decode:ne,encode:j},decode:te,encode:le,toASCII:we,toUnicode:he},ae={};function ve(T){var b=T.charCodeAt(0),R=void 0;return b<16?R="%0"+b.toString(16).toUpperCase():b<128?R="%"+b.toString(16).toUpperCase():b<2048?R="%"+(b>>6|192).toString(16).toUpperCase()+"%"+(b&63|128).toString(16).toUpperCase():R="%"+(b>>12|224).toString(16).toUpperCase()+"%"+(b>>6&63|128).toString(16).toUpperCase()+"%"+(b&63|128).toString(16).toUpperCase(),R}function Ee(T){for(var b="",R=0,F=T.length;R<F;){var M=parseInt(T.substr(R+1,2),16);if(M<128)b+=String.fromCharCode(M),R+=3;else if(M>=194&&M<224){if(F-R>=6){var ye=parseInt(T.substr(R+4,2),16);b+=String.fromCharCode((M&31)<<6|ye&63)}else b+=T.substr(R,6);R+=6}else if(M>=224){if(F-R>=9){var ge=parseInt(T.substr(R+4,2),16),Oe=parseInt(T.substr(R+7,2),16);b+=String.fromCharCode((M&15)<<12|(ge&63)<<6|Oe&63)}else b+=T.substr(R,9);R+=9}else b+=T.substr(R,3),R+=3}return b}function Ne(T,b){function R(F){var M=Ee(F);return M.match(b.UNRESERVED)?M:F}return T.scheme&&(T.scheme=String(T.scheme).replace(b.PCT_ENCODED,R).toLowerCase().replace(b.NOT_SCHEME,"")),T.userinfo!==void 0&&(T.userinfo=String(T.userinfo).replace(b.PCT_ENCODED,R).replace(b.NOT_USERINFO,ve).replace(b.PCT_ENCODED,s)),T.host!==void 0&&(T.host=String(T.host).replace(b.PCT_ENCODED,R).toLowerCase().replace(b.NOT_HOST,ve).replace(b.PCT_ENCODED,s)),T.path!==void 0&&(T.path=String(T.path).replace(b.PCT_ENCODED,R).replace(T.scheme?b.NOT_PATH:b.NOT_PATH_NOSCHEME,ve).replace(b.PCT_ENCODED,s)),T.query!==void 0&&(T.query=String(T.query).replace(b.PCT_ENCODED,R).replace(b.NOT_QUERY,ve).replace(b.PCT_ENCODED,s)),T.fragment!==void 0&&(T.fragment=String(T.fragment).replace(b.PCT_ENCODED,R).replace(b.NOT_FRAGMENT,ve).replace(b.PCT_ENCODED,s)),T}function ke(T){return T.replace(/^0*(.*)/,"$1")||"0"}function Ce(T,b){var R=T.match(b.IPV4ADDRESS)||[],F=m(R,2),M=F[1];return M?M.split(".").map(ke).join("."):T}function L(T,b){var R=T.match(b.IPV6ADDRESS)||[],F=m(R,3),M=F[1],ye=F[2];if(M){for(var ge=M.toLowerCase().split("::").reverse(),Oe=m(ge,2),Fe=Oe[0],Ye=Oe[1],Re=Ye?Ye.split(":").map(ke):[],Ke=Fe.split(":").map(ke),Je=b.IPV4ADDRESS.test(Ke[Ke.length-1]),_e=Je?7:8,je=Ke.length-_e,tt=Array(_e),He=0;He<_e;++He)tt[He]=Re[He]||Ke[je+He]||"";Je&&(tt[_e-1]=Ce(tt[_e-1],b));var Gn=tt.reduce(function(Ut,en,_r){if(!en||en==="0"){var Sn=Ut[Ut.length-1];Sn&&Sn.index+Sn.length===_r?Sn.length++:Ut.push({index:_r,length:1})}return Ut},[]),Zt=Gn.sort(function(Ut,en){return en.length-Ut.length})[0],Qt=void 0;if(Zt&&Zt.length>1){var ai=tt.slice(0,Zt.index),Er=tt.slice(Zt.index+Zt.length);Qt=ai.join(":")+"::"+Er.join(":")}else Qt=tt.join(":");return ye&&(Qt+="%"+ye),Qt}else return T}var U=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,V="".match(/(){0}/)[1]===void 0;function y(T){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R={},F=b.iri!==!1?h:c;b.reference==="suffix"&&(T=(b.scheme?b.scheme+":":"")+"//"+T);var M=T.match(U);if(M){V?(R.scheme=M[1],R.userinfo=M[3],R.host=M[4],R.port=parseInt(M[5],10),R.path=M[6]||"",R.query=M[7],R.fragment=M[8],isNaN(R.port)&&(R.port=M[5])):(R.scheme=M[1]||void 0,R.userinfo=T.indexOf("@")!==-1?M[3]:void 0,R.host=T.indexOf("//")!==-1?M[4]:void 0,R.port=parseInt(M[5],10),R.path=M[6]||"",R.query=T.indexOf("?")!==-1?M[7]:void 0,R.fragment=T.indexOf("#")!==-1?M[8]:void 0,isNaN(R.port)&&(R.port=T.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?M[4]:void 0)),R.host&&(R.host=L(Ce(R.host,F),F)),R.scheme===void 0&&R.userinfo===void 0&&R.host===void 0&&R.port===void 0&&!R.path&&R.query===void 0?R.reference="same-document":R.scheme===void 0?R.reference="relative":R.fragment===void 0?R.reference="absolute":R.reference="uri",b.reference&&b.reference!=="suffix"&&b.reference!==R.reference&&(R.error=R.error||"URI is not a "+b.reference+" reference.");var ye=ae[(b.scheme||R.scheme||"").toLowerCase()];if(!b.unicodeSupport&&(!ye||!ye.unicodeSupport)){if(R.host&&(b.domainHost||ye&&ye.domainHost))try{R.host=ue.toASCII(R.host.replace(F.PCT_ENCODED,Ee).toLowerCase())}catch(ge){R.error=R.error||"Host's domain name can not be converted to ASCII via punycode: "+ge}Ne(R,c)}else Ne(R,F);ye&&ye.parse&&ye.parse(R,b)}else R.error=R.error||"URI can not be parsed.";return R}function d(T,b){var R=b.iri!==!1?h:c,F=[];return T.userinfo!==void 0&&(F.push(T.userinfo),F.push("@")),T.host!==void 0&&F.push(L(Ce(String(T.host),R),R).replace(R.IPV6ADDRESS,function(M,ye,ge){return"["+ye+(ge?"%25"+ge:"")+"]"})),(typeof T.port=="number"||typeof T.port=="string")&&(F.push(":"),F.push(String(T.port))),F.length?F.join(""):void 0}var f=/^\.\.?\//,w=/^\/\.(\/|$)/,k=/^\/\.\.(\/|$)/,W=/^\/?(?:.|\n)*?(?=\/|$)/;function Y(T){for(var b=[];T.length;)if(T.match(f))T=T.replace(f,"");else if(T.match(w))T=T.replace(w,"/");else if(T.match(k))T=T.replace(k,"/"),b.pop();else if(T==="."||T==="..")T="";else{var R=T.match(W);if(R){var F=R[0];T=T.slice(F.length),b.push(F)}else throw new Error("Unexpected dot segment condition")}return b.join("")}function de(T){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=b.iri?h:c,F=[],M=ae[(b.scheme||T.scheme||"").toLowerCase()];if(M&&M.serialize&&M.serialize(T,b),T.host&&!R.IPV6ADDRESS.test(T.host)){if(b.domainHost||M&&M.domainHost)try{T.host=b.iri?ue.toUnicode(T.host):ue.toASCII(T.host.replace(R.PCT_ENCODED,Ee).toLowerCase())}catch(Oe){T.error=T.error||"Host's domain name can not be converted to "+(b.iri?"Unicode":"ASCII")+" via punycode: "+Oe}}Ne(T,R),b.reference!=="suffix"&&T.scheme&&(F.push(T.scheme),F.push(":"));var ye=d(T,b);if(ye!==void 0&&(b.reference!=="suffix"&&F.push("//"),F.push(ye),T.path&&T.path.charAt(0)!=="/"&&F.push("/")),T.path!==void 0){var ge=T.path;!b.absolutePath&&(!M||!M.absolutePath)&&(ge=Y(ge)),ye===void 0&&(ge=ge.replace(/^\/\//,"/%2F")),F.push(ge)}return T.query!==void 0&&(F.push("?"),F.push(T.query)),T.fragment!==void 0&&(F.push("#"),F.push(T.fragment)),F.join("")}function Te(T,b){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},F=arguments[3],M={};return F||(T=y(de(T,R),R),b=y(de(b,R),R)),R=R||{},!R.tolerant&&b.scheme?(M.scheme=b.scheme,M.userinfo=b.userinfo,M.host=b.host,M.port=b.port,M.path=Y(b.path||""),M.query=b.query):(b.userinfo!==void 0||b.host!==void 0||b.port!==void 0?(M.userinfo=b.userinfo,M.host=b.host,M.port=b.port,M.path=Y(b.path||""),M.query=b.query):(b.path?(b.path.charAt(0)==="/"?M.path=Y(b.path):((T.userinfo!==void 0||T.host!==void 0||T.port!==void 0)&&!T.path?M.path="/"+b.path:T.path?M.path=T.path.slice(0,T.path.lastIndexOf("/")+1)+b.path:M.path=b.path,M.path=Y(M.path)),M.query=b.query):(M.path=T.path,b.query!==void 0?M.query=b.query:M.query=T.query),M.userinfo=T.userinfo,M.host=T.host,M.port=T.port),M.scheme=T.scheme),M.fragment=b.fragment,M}function p(T,b,R){var F=l({scheme:"null"},R);return de(Te(y(T,F),y(b,F),F,!0),F)}function v(T,b){return typeof T=="string"?T=de(y(T,b),b):o(T)==="object"&&(T=y(de(T,b),b)),T}function q(T,b,R){return typeof T=="string"?T=de(y(T,R),R):o(T)==="object"&&(T=de(T,R)),typeof b=="string"?b=de(y(b,R),R):o(b)==="object"&&(b=de(b,R)),T===b}function Z(T,b){return T&&T.toString().replace(!b||!b.iri?c.ESCAPE:h.ESCAPE,ve)}function re(T,b){return T&&T.toString().replace(!b||!b.iri?c.PCT_ENCODED:h.PCT_ENCODED,Ee)}var De={scheme:"http",domainHost:!0,parse:function(b,R){return b.host||(b.error=b.error||"HTTP URIs must have a host."),b},serialize:function(b,R){var F=String(b.scheme).toLowerCase()==="https";return(b.port===(F?443:80)||b.port==="")&&(b.port=void 0),b.path||(b.path="/"),b}},ut={scheme:"https",domainHost:De.domainHost,parse:De.parse,serialize:De.serialize};function vr(T){return typeof T.secure=="boolean"?T.secure:String(T.scheme).toLowerCase()==="wss"}var wt={scheme:"ws",domainHost:!0,parse:function(b,R){var F=b;return F.secure=vr(F),F.resourceName=(F.path||"/")+(F.query?"?"+F.query:""),F.path=void 0,F.query=void 0,F},serialize:function(b,R){if((b.port===(vr(b)?443:80)||b.port==="")&&(b.port=void 0),typeof b.secure=="boolean"&&(b.scheme=b.secure?"wss":"ws",b.secure=void 0),b.resourceName){var F=b.resourceName.split("?"),M=m(F,2),ye=M[0],ge=M[1];b.path=ye&&ye!=="/"?ye:void 0,b.query=ge,b.resourceName=void 0}return b.fragment=void 0,b}},Ni={scheme:"wss",domainHost:wt.domainHost,parse:wt.parse,serialize:wt.serialize},ia={},Di="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",At="[0-9A-Fa-f]",Pi=i(i("%[EFef]"+At+"%"+At+At+"%"+At+At)+"|"+i("%[89A-Fa-f]"+At+"%"+At+At)+"|"+i("%"+At+At)),Ki="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Mi="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",mr=r(Mi,'[\\"\\\\]'),xn="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",zt=new RegExp(Di,"g"),si=new RegExp(Pi,"g"),iy=new RegExp(r("[^]",Ki,"[\\.]",'[\\"]',mr),"g"),_l=new RegExp(r("[^]",Di,xn),"g"),oy=_l;function oa(T){var b=Ee(T);return b.match(zt)?b:T}var xl={scheme:"mailto",parse:function(b,R){var F=b,M=F.to=F.path?F.path.split(","):[];if(F.path=void 0,F.query){for(var ye=!1,ge={},Oe=F.query.split("&"),Fe=0,Ye=Oe.length;Fe<Ye;++Fe){var Re=Oe[Fe].split("=");switch(Re[0]){case"to":for(var Ke=Re[1].split(","),Je=0,_e=Ke.length;Je<_e;++Je)M.push(Ke[Je]);break;case"subject":F.subject=re(Re[1],R);break;case"body":F.body=re(Re[1],R);break;default:ye=!0,ge[re(Re[0],R)]=re(Re[1],R);break}}ye&&(F.headers=ge)}F.query=void 0;for(var je=0,tt=M.length;je<tt;++je){var He=M[je].split("@");if(He[0]=re(He[0]),R.unicodeSupport)He[1]=re(He[1],R).toLowerCase();else try{He[1]=ue.toASCII(re(He[1],R).toLowerCase())}catch(Gn){F.error=F.error||"Email address's domain name can not be converted to ASCII via punycode: "+Gn}M[je]=He.join("@")}return F},serialize:function(b,R){var F=b,M=a(b.to);if(M){for(var ye=0,ge=M.length;ye<ge;++ye){var Oe=String(M[ye]),Fe=Oe.lastIndexOf("@"),Ye=Oe.slice(0,Fe).replace(si,oa).replace(si,s).replace(iy,ve),Re=Oe.slice(Fe+1);try{Re=R.iri?ue.toUnicode(Re):ue.toASCII(re(Re,R).toLowerCase())}catch(je){F.error=F.error||"Email address's domain name can not be converted to "+(R.iri?"Unicode":"ASCII")+" via punycode: "+je}M[ye]=Ye+"@"+Re}F.path=M.join(",")}var Ke=b.headers=b.headers||{};b.subject&&(Ke.subject=b.subject),b.body&&(Ke.body=b.body);var Je=[];for(var _e in Ke)Ke[_e]!==ia[_e]&&Je.push(_e.replace(si,oa).replace(si,s).replace(_l,ve)+"="+Ke[_e].replace(si,oa).replace(si,s).replace(oy,ve));return Je.length&&(F.query=Je.join("&")),F}},sy=/^([^\:]+)\:(.*)/,Sl={scheme:"urn",parse:function(b,R){var F=b.path&&b.path.match(sy),M=b;if(F){var ye=R.scheme||M.scheme||"urn",ge=F[1].toLowerCase(),Oe=F[2],Fe=ye+":"+(R.nid||ge),Ye=ae[Fe];M.nid=ge,M.nss=Oe,M.path=void 0,Ye&&(M=Ye.parse(M,R))}else M.error=M.error||"URN can not be parsed.";return M},serialize:function(b,R){var F=R.scheme||b.scheme||"urn",M=b.nid,ye=F+":"+(R.nid||M),ge=ae[ye];ge&&(b=ge.serialize(b,R));var Oe=b,Fe=b.nss;return Oe.path=(M||R.nid)+":"+Fe,Oe}},ay=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Al={scheme:"urn:uuid",parse:function(b,R){var F=b;return F.uuid=F.nss,F.nss=void 0,!R.tolerant&&(!F.uuid||!F.uuid.match(ay))&&(F.error=F.error||"UUID is not valid."),F},serialize:function(b,R){var F=b;return F.nss=(b.uuid||"").toLowerCase(),F}};ae[De.scheme]=De,ae[ut.scheme]=ut,ae[wt.scheme]=wt,ae[Ni.scheme]=Ni,ae[xl.scheme]=xl,ae[Sl.scheme]=Sl,ae[Al.scheme]=Al,t.SCHEMES=ae,t.pctEncChar=ve,t.pctDecChars=Ee,t.parse=y,t.removeDotSegments=Y,t.serialize=de,t.resolveComponents=Te,t.resolve=p,t.normalize=v,t.equal=q,t.escapeComponent=Z,t.unescapeComponent=re,Object.defineProperty(t,"__esModule",{value:!0})})})(Ic,Ic.exports);var WE=Ic.exports,Rc;(function(n){n.Public="public",n.Private="private"})(Rc||(Rc={}));const on=Rc;class Rt{static validateEs256kOperationKey(e,t){const r=new Set(["kty","crv","x","y"]);t===on.Private&&r.add("d");for(const i in e)if(!r.has(i))throw new Ze(Xe.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${i}'.`);if(e.crv!=="secp256k1")throw new Ze(Xe.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${e.crv}.'`);if(e.kty!=="EC")throw new Ze(Xe.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${e.kty}.'`);if(e.x.length!==43)throw new Ze(Xe.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(e.y.length!==43)throw new Ze(Xe.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(t===on.Private&&(e.d===void 0||e.d.length!==43))throw new Ze(Xe.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(e){if(e.length>50)throw new Ze(Xe.IdTooLong,`Key ID length ${e.length} exceed max allowed length of 50.`);if(!pn.isBase64UrlString(e))throw new Ze(Xe.IdNotUsingBase64UrlCharacterSet,`Key ID '${e}' is not a Base64URL string.`)}static validatePublicKeyPurposes(e){if(e===void 0)return;const t=new Set;for(const r of e){if(t.has(r))throw new Ze(Xe.PublicKeyPurposeDuplicated,`Public key purpose '${r}' already specified.`);t.add(r)}}}class Lt{}Lt.hashAlgorithmInMultihashCode=18;Lt.maxCanonicalizedDeltaSizeInBytes=1e3;var qE=function n(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?n(e.toJSON()):Array.isArray(e)?`[${e.reduce((i,o,s)=>`${i}${s===0?"":","}${n(o===void 0||typeof o=="symbol"?null:o)}`,"")}]`:`{${Object.keys(e).sort().reduce((r,i)=>{if(e[i]===void 0||typeof e[i]=="symbol")return r;const o=r.length===0?"":",";return`${r}${o}${n(i)}:${n(e[i])}`},"")}}`};const zE=jy(qE);class yr{static canonicalizeAsBytes(e){const t=yr.removeAllUndefinedProperties(e),r=zE(t);return pn.stringToBytes(r)}static removeAllUndefinedProperties(e){for(const t in e)typeof e[t]=="object"?yr.removeAllUndefinedProperties(e[t]):e[t]===void 0&&delete e[t];return e}}var GE=Xh,vd=128,YE=127,JE=~YE,XE=Math.pow(2,31);function Xh(n,e,t){e=e||[],t=t||0;for(var r=t;n>=XE;)e[t++]=n&255|vd,n/=128;for(;n&JE;)e[t++]=n&255|vd,n>>>=7;return e[t]=n|0,Xh.bytes=t-r+1,e}var ZE=Oc,QE=128,md=127;function Oc(n,r){var t=0,r=r||0,i=0,o=r,s,a=n.length;do{if(o>=a)throw Oc.bytes=0,new RangeError("Could not decode varint");s=n[o++],t+=i<28?(s&md)<<i:(s&md)*Math.pow(2,i),i+=7}while(s>=QE);return Oc.bytes=o-r,t}var e1=Math.pow(2,7),t1=Math.pow(2,14),n1=Math.pow(2,21),r1=Math.pow(2,28),i1=Math.pow(2,35),o1=Math.pow(2,42),s1=Math.pow(2,49),a1=Math.pow(2,56),c1=Math.pow(2,63),l1=function(n){return n<e1?1:n<t1?2:n<n1?3:n<r1?4:n<i1?5:n<o1?6:n<s1?7:n<a1?8:n<c1?9:10},u1={encode:GE,decode:ZE,encodingLength:l1},Ls=u1;const Ed=(n,e=0)=>[Ls.decode(n,e),Ls.decode.bytes],_d=(n,e,t=0)=>(Ls.encode(n,e,t),e),xd=n=>Ls.encodingLength(n),Sd=(n,e)=>{const t=e.byteLength,r=xd(n),i=r+xd(t),o=new Uint8Array(i+t);return _d(n,o,0),_d(t,o,r),o.set(e,i),new Zh(n,t,e,o)},d1=n=>{const e=DE(n),[t,r]=Ed(e),[i,o]=Ed(e.subarray(r)),s=e.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Zh(t,i,s,e)};class Zh{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const f1=({name:n,code:e,encode:t})=>new h1(n,e,t);class h1{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Sd(this.code,t):t.then(r=>Sd(this.code,r))}else throw Error("Unknown type, must be binary type")}}const y1=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),Ad=f1({name:"sha2-256",code:18,encode:y1("SHA-256")});var ao=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class st{static hash(e,t){return ao(this,void 0,void 0,function*(){let r;switch(t){case 18:r=(yield Ad.digest(e)).bytes;break;default:throw new Ze(Xe.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${t} is not supported.`)}return r})}static hashAsNonMultihashBytes(e,t){return ao(this,void 0,void 0,function*(){let r;switch(t){case 18:r=yield Ad.encode(e);break;default:throw new Ze(Xe.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${t} is not supported.`)}return r})}static canonicalizeThenHashThenEncode(e,t){return ao(this,void 0,void 0,function*(){const r=yr.canonicalizeAsBytes(e);return yield st.hashThenEncode(r,t)})}static canonicalizeThenDoubleHashThenEncode(e,t){return ao(this,void 0,void 0,function*(){const r=yr.canonicalizeAsBytes(e),i=yield st.hashAsNonMultihashBytes(r,t);return yield st.hashThenEncode(i,t)})}static hashThenEncode(e,t){return ao(this,void 0,void 0,function*(){const r=yield st.hash(e,t);return pn.encode(r)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(e,t){let r;const i=pn.decodeAsBytes(e,t);try{r=d1(i)}catch{throw new Ze(Xe.MultihashStringNotAMultihash,`Given ${t} string '${e}' is not a multihash after decoding.`)}const o=Lt.hashAlgorithmInMultihashCode;if(o!==r.code)throw new Ze(Xe.MultihashUnsupportedHashAlgorithm,`Given ${t} uses unsupported multihash algorithm with code ${r.code}, should use ${o} or change IonSdkConfig to desired hashing algorithm.`)}}var Bc;(function(n){n.Create="create",n.Update="update",n.Deactivate="deactivate",n.Recover="recover"})(Bc||(Bc={}));const os=Bc;var Lc;(function(n){n.Replace="replace",n.AddPublicKeys="add-public-keys",n.RemovePublicKeys="remove-public-keys",n.AddServices="add-services",n.RemoveServices="remove-services"})(Lc||(Lc={}));const gi=Lc;var ss=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class _t{static createCreateRequest(e){return ss(this,void 0,void 0,function*(){const t=e.recoveryKey,r=e.updateKey,i=e.document.publicKeys,o=e.document.services;Rt.validateEs256kOperationKey(t,on.Public),Rt.validateEs256kOperationKey(r,on.Public),_t.validateDidDocumentKeys(i),_t.validateServices(o);const s=Lt.hashAlgorithmInMultihashCode,a=[{action:gi.Replace,document:e.document}],l={updateCommitment:yield st.canonicalizeThenDoubleHashThenEncode(r,s),patches:a};_t.validateDeltaSize(l);const c={deltaHash:yield st.canonicalizeThenHashThenEncode(l,s),recoveryCommitment:yield st.canonicalizeThenDoubleHashThenEncode(t,s)};return{type:os.Create,suffixData:c,delta:l}})}static createDeactivateRequest(e){return ss(this,void 0,void 0,function*(){_t.validateDidSuffix(e.didSuffix),Rt.validateEs256kOperationKey(e.recoveryPublicKey,on.Public);const t=Lt.hashAlgorithmInMultihashCode,r=yield st.canonicalizeThenHashThenEncode(e.recoveryPublicKey,t),i={didSuffix:e.didSuffix,recoveryKey:e.recoveryPublicKey},o=yield e.signer.sign({alg:"ES256K"},i);return{type:os.Deactivate,didSuffix:e.didSuffix,revealValue:r,signedData:o}})}static createRecoverRequest(e){return ss(this,void 0,void 0,function*(){_t.validateDidSuffix(e.didSuffix),Rt.validateEs256kOperationKey(e.recoveryPublicKey,on.Public),Rt.validateEs256kOperationKey(e.nextRecoveryPublicKey,on.Public),Rt.validateEs256kOperationKey(e.nextUpdatePublicKey,on.Public),_t.validateDidDocumentKeys(e.document.publicKeys),_t.validateServices(e.document.services);const t=Lt.hashAlgorithmInMultihashCode,r=yield st.canonicalizeThenHashThenEncode(e.recoveryPublicKey,t),i=[{action:gi.Replace,document:e.document}],o=yield st.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,t),s={patches:i,updateCommitment:o},a=yield st.canonicalizeThenHashThenEncode(s,t),u={recoveryCommitment:yield st.canonicalizeThenDoubleHashThenEncode(e.nextRecoveryPublicKey,t),recoveryKey:e.recoveryPublicKey,deltaHash:a},c=yield e.signer.sign({alg:"ES256K"},u);return{type:os.Recover,didSuffix:e.didSuffix,revealValue:r,delta:s,signedData:c}})}static createUpdateRequest(e){return ss(this,void 0,void 0,function*(){if(_t.validateDidSuffix(e.didSuffix),Rt.validateEs256kOperationKey(e.updatePublicKey,on.Public),Rt.validateEs256kOperationKey(e.nextUpdatePublicKey,on.Public),_t.validateServices(e.servicesToAdd),_t.validateDidDocumentKeys(e.publicKeysToAdd),e.idsOfServicesToRemove!==void 0)for(const g of e.idsOfServicesToRemove)Rt.validateId(g);if(e.idsOfPublicKeysToRemove!==void 0)for(const g of e.idsOfPublicKeysToRemove)Rt.validateId(g);const t=[],r=e.servicesToAdd;if(r!==void 0&&r.length>0){const g={action:gi.AddServices,services:r};t.push(g)}const i=e.idsOfServicesToRemove;if(i!==void 0&&i.length>0){const g={action:gi.RemoveServices,ids:i};t.push(g)}const o=e.publicKeysToAdd;if(o!==void 0&&o.length>0){const g={action:gi.AddPublicKeys,publicKeys:o};t.push(g)}const s=e.idsOfPublicKeysToRemove;if(s!==void 0&&s.length>0){const g={action:gi.RemovePublicKeys,ids:s};t.push(g)}const a=Lt.hashAlgorithmInMultihashCode,l=yield st.canonicalizeThenHashThenEncode(e.updatePublicKey,a),u=yield st.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,a),c={patches:t,updateCommitment:u},h=yield st.canonicalizeThenHashThenEncode(c,a),m={updateKey:e.updatePublicKey,deltaHash:h},E=yield e.signer.sign({alg:"ES256K"},m);return{type:os.Update,didSuffix:e.didSuffix,revealValue:l,delta:c,signedData:E}})}static validateDidSuffix(e){st.validateEncodedHashComputedUsingSupportedHashAlgorithm(e,"didSuffix")}static validateDidDocumentKeys(e){if(e===void 0)return;const t=new Set;for(const r of e){if(Array.isArray(r.publicKeyJwk))throw new Ze(Xe.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(Rt.validateId(r.id),t.has(r.id))throw new Ze(Xe.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${r.id}' already exists.`);t.add(r.id),Rt.validatePublicKeyPurposes(r.purposes)}}static validateServices(e){if(e!==void 0&&e.length!==0){const t=new Set;for(const r of e){if(_t.validateService(r),t.has(r.id))throw new Ze(Xe.DidDocumentServiceIdDuplicated,"Service id has to be unique");t.add(r.id)}}}static validateService(e){Rt.validateId(e.id);const t=30;if(e.type.length>t){const r=`Service endpoint type length ${e.type.length} exceeds max allowed length of ${t}.`;throw new Ze(Xe.ServiceTypeTooLong,r)}if(Array.isArray(e.serviceEndpoint)){const r="Service endpoint value cannot be an array.";throw new Ze(Xe.ServiceEndpointCannotBeAnArray,r)}if(typeof e.serviceEndpoint=="string"&&WE.parse(e.serviceEndpoint).error!==void 0)throw new Ze(Xe.ServiceEndpointStringNotValidUri,`Service endpoint string '${e.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(e){const t=yr.canonicalizeAsBytes(e);if(t.length>Lt.maxCanonicalizedDeltaSizeInBytes){const r=`Delta of ${t.length} bytes exceeded limit of ${Lt.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new Ze(Xe.DeltaExceedsMaximumSize,r)}}}var Td=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class El{static createLongFormDid(e){return Td(this,void 0,void 0,function*(){const t=yield _t.createCreateRequest(e),r=yield El.computeDidUniqueSuffix(t.suffixData);let i;Lt.network===void 0||Lt.network==="mainnet"?i=`did:ion:${r}`:i=`did:ion:${Lt.network}:${r}`;const o={suffixData:t.suffixData,delta:t.delta},s=yr.canonicalizeAsBytes(o),a=pn.encode(s);return`${i}:${a}`})}static computeDidUniqueSuffix(e){return Td(this,void 0,void 0,function*(){const t=yr.canonicalizeAsBytes(e),r=yield st.hash(t,Lt.hashAlgorithmInMultihashCode);return pn.encode(r)})}}var Id;(function(n){n.Mainnet="mainnet",n.Testnet="test"})(Id||(Id={}));var Rd;(function(n){n.Authentication="authentication",n.AssertionMethod="assertionMethod",n.CapabilityInvocation="capabilityInvocation",n.CapabilityDelegation="capabilityDelegation",n.KeyAgreement="keyAgreement"})(Rd||(Rd={}));var ar=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},un;(function(n){n.Ed25519="Ed25519",n.secp256k1="secp256k1",n.secp256r1="secp256r1",n.X25519="X25519"})(un||(un={}));const p1={Ed25519:un.Ed25519,ES256K:un.secp256k1,ES256:un.secp256r1,"P-256":un.secp256r1,secp256k1:un.secp256k1,secp256r1:un.secp256r1},Od="https://ion.tbd.engineering";class Ei extends Co{static create(){return ar(this,arguments,void 0,function*({keyManager:e=new Hn,options:t={}}={}){var r,i,o,s,a,l,u;if(!((r=t.verificationMethods)===null||r===void 0)&&r.some(x=>!(x.algorithm in p1)))throw new Error("One or more verification method algorithms are not supported");const c=(i=t.verificationMethods)===null||i===void 0?void 0:i.filter(x=>"id"in x).map(x=>x.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((o=t.services)===null||o===void 0)&&o.some(x=>!x.id||!x.type||!x.serviceEndpoint))throw new Error("One or more services are missing required properties");const h={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},m=[];for(const x of(s=t.verificationMethods)!==null&&s!==void 0?s:[h]){const D=yield e.generateKey({algorithm:x.algorithm}),H=yield e.getPublicKey({keyUri:D});m.push({id:x.id,publicKeyJwk:H,purposes:(a=x.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const E=yield e.generateKey({algorithm:un.secp256k1}),g=yield e.getPublicKey({keyUri:E}),S=yield e.generateKey({algorithm:un.secp256k1}),C=yield e.getPublicKey({keyUri:S}),B=yield jt.computeLongFormDidUri({recoveryKey:g,updateKey:C,services:(l=t.services)!==null&&l!==void 0?l:[],verificationMethods:m}),{didDocument:A,didResolutionMetadata:O}=yield Ei.resolve(B,{gatewayUri:t.gatewayUri});if(A===null)throw new Error(`Unable to resolve DID during creation: ${O==null?void 0:O.error}`);const I=new vn({uri:B,document:A,metadata:{published:!1,canonicalId:B.split(":",3).join(":"),recoveryKey:g,updateKey:C},keyManager:e});if(!((u=t.publish)!==null&&u!==void 0)||u){const x=yield Ei.publish({did:I,gatewayUri:t.gatewayUri});I.metadata=x.didDocumentMetadata}return I})}static getSigningMethod(e){return ar(this,arguments,void 0,function*({didDocument:t,methodId:r}){var i;const o=Be.parse(t.id);if(o&&o.method!==this.methodName)throw new pe(fe.MethodNotSupported,`Method not supported: ${o.method}`);const s=(i=t.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var l;return a.id===(r??((l=t.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(s&&s.publicKeyJwk))throw new pe(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return ar(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Hn}){const i=Be.parse(t.uri);if((i==null?void 0:i.method)!==Ei.methodName)throw new pe(fe.MethodNotSupported,"Method not supported");return yield vn.import({portableDid:t,keyManager:r})})}static publish(e){return ar(this,arguments,void 0,function*({did:t,gatewayUri:r=Od}){var i,o,s;const a=(o=(i=t.document.verificationMethod)===null||i===void 0?void 0:i.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:Qm({didDocument:t.document,methodId:c.id})})))!==null&&o!==void 0?o:[],l=yield jt.createIonDocument({services:(s=t.document.service)!==null&&s!==void 0?s:[],verificationMethods:a}),u=yield jt.constructCreateRequest({ionDocument:l,recoveryKey:t.metadata.recoveryKey,updateKey:t.metadata.updateKey});try{const c=jt.appendPathToUrl({baseUrl:r,path:"/operations"}),h=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});return{didDocument:t.document,didDocumentMetadata:Object.assign(Object.assign({},t.metadata),{published:h.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:fe.InternalError,errorMessage:`Failed to publish DID document for: ${t.uri}`}}}})}static resolve(e){return ar(this,arguments,void 0,function*(t,r={}){var i,o;const s=Be.parse(t);if(!s)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"invalidDid"}});if(s.method!==Ei.methodName)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(i=r==null?void 0:r.gatewayUri)!==null&&i!==void 0?i:Od;try{const l=jt.appendPathToUrl({baseUrl:a,path:`/identifiers/${t}`}),u=yield fetch(l);if(!u.ok)throw new pe(fe.NotFound,`Unable to find DID document for: ${t}`);const{didDocument:c,didDocumentMetadata:h}=yield u.json();return Object.assign(Object.assign(Object.assign({},yt),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(o=h==null?void 0:h.method)===null||o===void 0?void 0:o.published},h)})}catch(l){if(!(l instanceof pe))throw new Error(l);return Object.assign(Object.assign({},yt),{didResolutionMetadata:Object.assign({error:l.code},l.message&&{errorMessage:l.message})})}})}}Ei.methodName="ion";class jt{static appendPathToUrl({baseUrl:e,path:t}){const r=new URL(e);return r.pathname=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",r.pathname+=t.startsWith("/")?t.substring(1):t,r.toString()}static computeLongFormDidUri(e){return ar(this,arguments,void 0,function*({recoveryKey:t,updateKey:r,services:i,verificationMethods:o}){const s=yield jt.createIonDocument({services:i,verificationMethods:o}),a=jt.normalizeJwk(t),l=jt.normalizeJwk(r);return yield El.createLongFormDid({document:s,recoveryKey:a,updateKey:l})})}static constructCreateRequest(e){return ar(this,arguments,void 0,function*({ionDocument:t,recoveryKey:r,updateKey:i}){return yield _t.createCreateRequest({document:t,recoveryKey:jt.normalizeJwk(r),updateKey:jt.normalizeJwk(i)})})}static createIonDocument(e){return ar(this,arguments,void 0,function*({services:t,verificationMethods:r}){var i,o;const s=[];for(const u of r){let c=(o=(i=u.id)!==null&&i!==void 0?i:u.publicKeyJwk.kid)!==null&&o!==void 0?o:yield Ue({jwk:u.publicKeyJwk});c=`${c.split("#").pop()}`;const h={id:c,publicKeyJwk:jt.normalizeJwk(u.publicKeyJwk),purposes:u.purposes,type:"JsonWebKey2020"};s.push(h)}const a=t.map(u=>Object.assign(Object.assign({},u),{id:`${u.id.split("#").pop()}`}));return{publicKeys:s,services:a}})}static normalizeJwk(e){const t=e.kty;let r;if(t==="EC")r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(t==="oct")r={k:e.k,kty:e.kty};else if(t==="OKP")r={crv:e.crv,kty:e.kty,x:e.x};else if(t==="RSA")r={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${t}`);return r}}var as=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class _i extends Co{static create(){return as(this,arguments,void 0,function*({keyManager:e=new Hn,options:t={}}={}){var r,i,o,s;if(t.algorithm&&t.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(t.verificationMethods&&t.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(s=(r=t.algorithm)!==null&&r!==void 0?r:(o=(i=t.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",l=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:l}),c=se.object(u).toBase64Url(),h=`did:${_i.methodName}:${c}`,E=(yield _i.resolve(h)).didDocument;return new vn({uri:h,document:E,metadata:{},keyManager:e})})}static getSigningMethod(e){return as(this,arguments,void 0,function*({didDocument:t}){var r;const i=Be.parse(t.id);if(i&&i.method!==this.methodName)throw new pe(fe.MethodNotSupported,`Method not supported: ${i.method}`);const[o]=(r=t.verificationMethod)!==null&&r!==void 0?r:[];if(!(o&&o.publicKeyJwk))throw new pe(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return as(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Hn}){const i=Be.parse(t.uri);if((i==null?void 0:i.method)!==_i.methodName)throw new pe(fe.MethodNotSupported,"Method not supported");const o=yield vn.import({portableDid:t,keyManager:r});if(o.document.verificationMethod.length!==1)throw new pe(fe.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,t){return as(this,void 0,void 0,function*(){const r=Be.parse(e);let i;try{i=se.base64Url(r.id).toObject()}catch{}if(!r||!i)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"invalidDid"}});if(r.method!==_i.methodName)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"methodNotSupported"}});const o={"@context":["https://www.w3.org/ns/did/v1"],id:r.uri},s=`${o.id}#0`;switch(o.verificationMethod=[{id:s,type:"JsonWebKey",controller:o.id,publicKeyJwk:i}],o.authentication=[s],o.assertionMethod=[s],o.capabilityInvocation=[s],o.capabilityDelegation=[s],o.keyAgreement=[s],i.use){case"sig":{delete o.keyAgreement;break}case"enc":{delete o.authentication,delete o.assertionMethod,delete o.capabilityInvocation,delete o.capabilityDelegation;break}}return Object.assign(Object.assign({},yt),{didDocument:o})})}}_i.methodName="jwk";var Jt=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})},kn;(function(n){n.Ed25519="Ed25519",n.secp256k1="secp256k1",n.secp256r1="secp256r1",n.X25519="X25519"})(kn||(kn={}));const Ja={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},g1={Ed25519:kn.Ed25519,ES256K:kn.secp256k1,ES256:kn.secp256r1,"P-256":kn.secp256r1,secp256k1:kn.secp256k1,secp256r1:kn.secp256r1,X25519:kn.X25519};class sn extends Co{static create(){return Jt(this,arguments,void 0,function*({keyManager:e=new Hn,options:t={}}={}){var r,i,o,s;if(t.algorithm&&t.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(t.verificationMethods&&t.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(s=(r=t.algorithm)!==null&&r!==void 0?r:(o=(i=t.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",l=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:l}),c=yield at.publicKeyToMultibaseId({publicKey:u}),h=`did:${sn.methodName}:${c}`,E=(yield sn.resolve(h,t)).didDocument;return new vn({uri:h,document:E,metadata:{},keyManager:e})})}static getSigningMethod(e){return Jt(this,arguments,void 0,function*({didDocument:t}){var r;const i=Be.parse(t.id);if(i&&i.method!==this.methodName)throw new pe(fe.MethodNotSupported,`Method not supported: ${i.method}`);const[o]=t.assertionMethod||[],s=(r=t.verificationMethod)===null||r===void 0?void 0:r.find(a=>a.id===o);if(!(s&&s.publicKeyJwk))throw new pe(fe.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return Jt(this,arguments,void 0,function*({portableDid:t,keyManager:r=new Hn}){const i=Be.parse(t.uri);if((i==null?void 0:i.method)!==sn.methodName)throw new pe(fe.MethodNotSupported,"Method not supported");const o=yield vn.import({portableDid:t,keyManager:r});if(o.document.verificationMethod.length!==1)throw new pe(fe.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,t){return Jt(this,void 0,void 0,function*(){try{const r=yield sn.createDocument({didUri:e,options:t});return Object.assign(Object.assign({},yt),{didDocument:r})}catch(r){if(!(r instanceof pe))throw new Error(r);return Object.assign(Object.assign({},yt),{didResolutionMetadata:Object.assign({error:r.code},r.message&&{errorMessage:r.message})})}})}static createDocument(e){return Jt(this,arguments,void 0,function*({didUri:t,options:r={}}){const{defaultContext:i="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:o=!1,enableExperimentalPublicKeyTypes:s=!1,publicKeyFormat:a="JsonWebKey2020"}=r,l={id:""},u=Be.parse(t);if(!u)throw new pe(fe.InvalidDid,`Invalid DID URI: ${t}`);const c=u.id;if(u.method!==sn.methodName)throw new pe(fe.MethodNotSupported,`Method not supported: ${u.method}`);if(!sn.validateIdentifier(u))throw new pe(fe.InvalidDid,`Invalid DID URI: ${t}`);const h=yield sn.createSignatureMethod({didUri:t,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:a}});if(l.id=u.uri,l.verificationMethod=[h],l.authentication=[h.id],l.assertionMethod=[h.id],l.capabilityInvocation=[h.id],l.capabilityDelegation=[h.id],o===!0){const g=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",S=yield this.createEncryptionMethod({didUri:t,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:g}});l.verificationMethod.push(S),l.keyAgreement=[S.id]}const m=[i];return Zm({didDocument:l}).forEach(g=>{const S=Ja[g];m.push(S)}),l["@context"]=m,l})}static createEncryptionMethod(e){return Jt(this,arguments,void 0,function*({didUri:t,multibaseValue:r,options:i}){const{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:l,multicodecCode:u}=yield sn.deriveEncryptionKey({multibaseValue:r}),c=l.byteLength,h=at.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(c!==h)throw new pe(fe.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${h}`);const m=$h({keyBytes:l,multicodecCode:u});a.id=`${t}#${m}`;try{new URL(a.id)}catch{throw new pe(fe.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in Ja))throw new pe(fe.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(s))throw new pe(fe.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=t,s==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=m),s==="JsonWebKey2020"){const{crv:g}=yield at.multicodecToJwk({code:u});a.publicKeyJwk=yield at.keyConverter(g).bytesToPublicKey({publicKeyBytes:l})}return a})}static createSignatureMethod(e){return Jt(this,arguments,void 0,function*({didUri:t,multibaseValue:r,options:i}){const{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:l,multicodecCode:u,multicodecName:c}=id({multibaseKeyId:r}),h=l.byteLength,m=at.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(h!==m)throw new pe(fe.InvalidPublicKeyLength,`Expected ${h} bytes. Actual: ${m}`);let E=!1;switch(c){case"secp256k1-pub":E=yield We.validatePublicKey({publicKeyBytes:l});break;case"ed25519-pub":E=yield Ge.validatePublicKey({publicKeyBytes:l});break;case"x25519-pub":E=!0;break}if(!E)throw new pe(fe.InvalidPublicKey,"Invalid public key detected.");a.id=`${t}#${r}`;try{new URL(a.id)}catch{throw new pe(fe.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in Ja))throw new pe(fe.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(s))throw new pe(fe.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=t,s==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=r),s==="JsonWebKey2020"){const{crv:S}=yield at.multicodecToJwk({code:u});a.publicKeyJwk=yield at.keyConverter(S).bytesToPublicKey({publicKeyBytes:l})}return a})}static deriveEncryptionKey(e){return Jt(this,arguments,void 0,function*({multibaseValue:t}){let r={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:i,multicodecCode:o}=id({multibaseKeyId:t});if(o===237){const s=yield at.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:i}),a=yield Ge.convertPublicKeyToX25519({publicKey:s});r={keyBytes:yield at.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return r})}static validateIdentifier(e){const{method:t,id:r}=e,[i]=e.uri.split(":",1);return i==="did"&&t==="key"&&Number("1")>0&&Xa(r)==="String"&&r.startsWith("z")}}sn.methodName="key";class at{static jwkToMulticodec(e){return Jt(this,arguments,void 0,function*({jwk:t}){const r=[];t.crv&&(r.push(t.crv),t.d?r.push("private"):r.push("public"));const i=r.join(":"),o=at.JWK_TO_MULTICODEC[i];if(o===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${i}'`);return{code:rt.getCodeFromName({name:o}),name:o}})}static keyCompressor(e){const r={"P-256":ze.compressPublicKey,secp256k1:We.compressPublicKey}[e];if(!r)throw new pe(fe.InvalidPublicKeyType,`Unsupported curve: ${e}`);return r}static keyConverter(e){const r={Ed25519:Ge,"P-256":ze,secp256k1:We,X25519:Fr}[e];if(!r)throw new pe(fe.InvalidPublicKeyType,`Unsupported curve: ${e}`);return r}static multicodecToJwk(e){return Jt(this,arguments,void 0,function*({code:t,name:r}){if(!(r?!t:t))throw new Error("Either 'name' or 'code' must be defined, but not both.");r=r===void 0?rt.getNameFromCode({code:t}):r;const i=r,o=at.MULTICODEC_TO_JWK[i];if(o===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},o)})}static publicKeyToMultibaseId(e){return Jt(this,arguments,void 0,function*({publicKey:t}){var r;if(!(t!=null&&t.crv&&t.crv in g1))throw new pe(fe.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(r=t==null?void 0:t.crv)!==null&&r!==void 0?r:"undefined"}`);let i=yield at.keyConverter(t.crv).publicKeyToBytes({publicKey:t});/^(secp256k1|P-256|P-384|P-521)$/.test(t.crv)&&(i=yield at.keyCompressor(t.crv)({publicKeyBytes:i}));const{name:o}=yield at.jwkToMulticodec({jwk:t});return $h({keyBytes:i,multicodecName:o})})}}at.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};at.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};at.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var w1=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class ra extends Co{static resolve(e,t){return w1(this,void 0,void 0,function*(){const r=Be.parse(e);if(!r)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"invalidDid"}});if(r.method!==ra.methodName)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"methodNotSupported"}});let i=`https://${r.id.replace(/:/g,"/")}`;i=decodeURIComponent(i);const o=r.id.includes(":")?`${i}/did.json`:`${i}/.well-known/did.json`;try{const s=yield fetch(o);if(!s.ok)throw new Error("HTTP error status code returned");const a=yield s.json();return Object.assign(Object.assign({},yt),{didDocument:a})}catch{return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:"notFound"}})}})}}ra.methodName="web";const b1={get:function(n){return null},set:function(n,e){return null},delete:function(n){return null},clear:function(){return null},close:function(){return null}};var Bd=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class v1{constructor({cache:e,didResolvers:t}){this.didResolvers=new Map,this.cache=e||b1;for(const r of t)this.didResolvers.set(r.methodName,r)}resolve(e,t){return Bd(this,void 0,void 0,function*(){const r=Be.parse(e);if(!r)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:fe.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});const i=this.didResolvers.get(r.method);if(!i)return Object.assign(Object.assign({},yt),{didResolutionMetadata:{error:fe.MethodNotSupported,errorMessage:`Method not supported: ${r.method}`}});const o=yield this.cache.get(r.uri);if(o)return o;{const s=yield i.resolve(r.uri,t);return s.didResolutionMetadata.error||(yield this.cache.set(r.uri,s)),s}})}dereference(e,t){return Bd(this,void 0,void 0,function*(){const r=Be.parse(e);if(!r)return{dereferencingMetadata:{error:fe.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:i,didResolutionMetadata:o,didDocumentMetadata:s}=yield this.resolve(r.uri);if(!i)return{dereferencingMetadata:{error:o.error},contentStream:null,contentMetadata:{}};if(!r.fragment||r.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:i,contentMetadata:s};const{service:a=[],verificationMethod:l=[]}=i,u=new Set([e,r.fragment,`#${r.fragment}`]);let c;for(let h of l)if(u.has(h.id)){c=h;break}for(let h of a)if(u.has(h.id)){c=h;break}return c?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:c,contentMetadata:o}:{dereferencingMetadata:{error:fe.NotFound},contentStream:null,contentMetadata:{}}})}}var pr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,[])).next())})};const Qh=new v1({didResolvers:[ei,ra]}),kc=/^https?:\/\/dweb\/([^/]+)\/?(.*)?$/,ey=/^http:/,ks=/\/$/;function m1(){try{return new Function("return import.meta")()}catch{return}}function ty(n){var e,t;return pr(this,void 0,void 0,function*(){const{didDocument:r}=yield Qh.resolve(n);let i=(t=(e=r==null?void 0:r.service)===null||e===void 0?void 0:e.find(o=>o.type==="DecentralizedWebNode"))===null||t===void 0?void 0:t.serviceEndpoint;return(Array.isArray(i)?i:[i]).filter(o=>o.startsWith("http"))})}function E1(n,e,t,r){return pr(this,void 0,void 0,function*(){const i=n.request.url.replace(ey,"https:").replace(ks,""),o=yield caches.open("drl"),s=yield o.match(i);if(s){if(!navigator.onLine)return s;const a=yield r==null?void 0:r.onCacheCheck(n,i);if(a){const l=s.headers.get("dwn-cache-time");if(l&&Date.now()<Number(l)+(Number(a.ttl)||0))return s}}try{if(t)return yield _1(n,e,i,t,o,r);{const a=yield Qh.resolve(e);return new Response(JSON.stringify(a),{status:200,headers:{"Content-Type":"application/json"}})}}catch(a){return a instanceof Response?a:(console.log(`Error in DID URL fetch: ${a}`),new Response("DID URL fetch error",{status:500}))}})}function _1(n,e,t,r,i,o){return pr(this,void 0,void 0,function*(){const s=yield ty(e);if(!(s!=null&&s.length))throw new Response("DWeb Node resolution failed: no valid endpoints found.",{status:530});for(const a of s)try{const l=`${a.replace(ks,"")}/${e}/${r}`,u=yield fetch(l,{headers:n.request.headers});return u.ok?((yield o==null?void 0:o.onCacheCheck(n,t))&&x1(t,l,u,i),u):(console.log(`DWN endpoint error: ${u.status}`),new Response("DWeb Node request failed",{status:u.status}))}catch(l){return console.log(`DWN endpoint error: ${l}`),new Response("DWeb Node request failed: "+l,{status:500})}})}function x1(n,e,t,r){return pr(this,void 0,void 0,function*(){const i=t.clone(),o=new Headers(i.headers);o.append("dwn-cache-time",Date.now().toString()),o.append("dwn-composed-url",e);const s=new Response(i.body,{headers:o});r.put(n,s)})}function S1(n={}){var e,t,r;return pr(this,void 0,void 0,function*(){const i=self;try{if(typeof ServiceWorkerGlobalScope<"u"&&i instanceof ServiceWorkerGlobalScope)i.skipWaiting(),i.addEventListener("activate",o=>{o.waitUntil(i.clients.claim())}),i.addEventListener("fetch",o=>{const s=o.request.url.match(kc);s&&o.respondWith(E1(o,s[1],s[2],n))});else if(!((e=globalThis==null?void 0:globalThis.navigator)===null||e===void 0)&&e.serviceWorker){if(!(yield navigator.serviceWorker.getRegistration("/"))){const s=n.path||(globalThis.document?(t=document==null?void 0:document.currentScript)===null||t===void 0?void 0:t.src:(r=m1())===null||r===void 0?void 0:r.url);s&&navigator.serviceWorker.register(s,{type:"module"}).catch(a=>{console.error("DWeb networking feature installation failed: ",a)})}}else throw new Error("DWeb networking features are not available for install in this environment")}catch(o){console.error("Error in installing networking features:",o)}})}const ny=`
  .drl-loading-overlay {
    position: fixed;
    inset: 0;
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    color: #fff;
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    z-index: 1000000;
  }

  .drl-loading-overlay > div {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .drl-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
  }

    .drl-loading-spinner div {
      position: relative;
      width: 2em;
      height: 2em;
      margin: 0.1em 0.25em 0 0;
    }
    .drl-loading-spinner div::after,
    .drl-loading-spinner div::before {
      content: '';  
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 0.1em solid #FFF;
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      animation: drl-loading-spinner 2s linear infinite;
    }
    .drl-loading-spinner div::after {
      animation-delay: 1s;
    }

  .drl-loading-overlay span {
    --text-opacity: 2;
    display: flex;
    align-items: center;
    margin: 2em auto 0;
    padding: 0.2em 0.75em 0.25em;
    text-align: center;
    border-radius: 5em;
    background: rgba(255 255 255 / 8%);
    opacity: 0.8;
    transition: opacity 0.3s ease;
    cursor: pointer;
  }

    .drl-loading-overlay span:focus {
      opacity: 1;
    }

    .drl-loading-overlay span:hover {
      opacity: 1;
    }

    .drl-loading-overlay span::before {
      content: "✕ ";
      margin: 0 0.4em 0 0;
      color: red;
      font-size: 65%;
      font-weight: bold;
    }

    .drl-loading-overlay span::after {
      content: "stop";
      display: block;
      font-size: 60%;
      line-height: 0;
      color: rgba(255 255 255 / 60%);
    }

    .drl-loading-overlay.new-tab-overlay span::after {
      content: "close";
    }
  
  @keyframes drl-loading-spinner {
    0% {
      transform: scale(0);
      opacity: 1;
    }
    100% {
      transform: scale(1);
      opacity: 0;
    }
  }
`,A1=`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loading DRL...</title>
  <style>
    html, body {
      background-color: #151518;
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    ${ny}
  </style>
</head>
<body>
  <div class="drl-loading-overlay new-tab-overlay">
    <div class="drl-loading-spinner">
      <div></div>
      Loading DRL
    </div>
    <span onclick="window.close()" tabindex="0"></span>
  </div>
</body>
</html>
`;let Ld=!1;function kd(){if(Ld)return;const n=document.createElement("style");n.innerHTML=`
    ${ny}

    .drl-loading-overlay {
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    :root[drl-link-loading] .drl-loading-overlay {
      opacity: 1;
      pointer-events: all;
    }
  `,document.head.append(n);let e=document.createElement("div");e.classList.add("drl-loading-overlay"),e.innerHTML=`
    <div class="drl-loading-spinner">
      <div></div>
      Loading DRL
    </div> 
    <span tabindex="0"></span>
  `,e.lastElementChild.addEventListener("click",ry),document.body.prepend(e),Ld=!0}function ry(){document.documentElement.removeAttribute("drl-link-loading"),_s=null}let _s,Cd=!1;function T1(){Cd||(document.addEventListener("click",n=>pr(this,void 0,void 0,function*(){let e=n.target.closest("a");if(e){let t=e.href;const r=t.match(kc);if(r){let i=r[1],o=r[2];const s=e.target==="_blank";n.preventDefault();try{let a;s?(a=window.open("","_blank"),a.document.write(A1)):(_s=o,setTimeout(()=>document.documentElement.setAttribute("drl-link-loading",""),50));const l=yield ty(i);if(!l.length)throw null;let u=`${l[0].replace(ks,"")}/${i}/${o}`;s?a.closed||(a.location.href=u):_s===o&&(window.location.href=u)}catch{throw _s===o&&ry(),new Error(`DID endpoint resolution failed for the DRL: ${t}`)}}}})),document.addEventListener("pointercancel",cs),document.addEventListener("pointerdown",n=>pr(this,void 0,void 0,function*(){var e;const t=n.composedPath()[0];if(n.pointerType==="mouse"&&n.button===2||n.pointerType==="touch"&&n.isPrimary){if(cs(),t&&(!((e=t==null?void 0:t.src)===null||e===void 0)&&e.match(kc))){Dr=t,t.__src__=t.src;const r=t.src.replace(ey,"https:").replace(ks,""),s=(yield(yield caches.open("drl")).match(r)).headers.get("dwn-composed-url");s&&(t.src=s),t.addEventListener("pointerup",cs,{once:!0})}}else t===Dr&&cs()})),Cd=!0)}let Dr;function cs(n){return pr(this,void 0,void 0,function*(){(n==null?void 0:n.type)==="pointerup"&&(yield new Promise(e=>requestAnimationFrame(e))),Dr&&(Dr.src=Dr.__src__,delete Dr.__src__,Dr=null)})}function I1(n={}){n.serviceWorker!==!1&&S1(n),typeof window<"u"&&typeof window.document<"u"&&(n.injectStyles!==!1&&(document.readyState!=="loading"?kd():document.addEventListener("DOMContentLoaded",kd,{once:!0})),n.links!==!1&&T1())}Py([{"revision":"f1df8823f20c29dd3bd680f372e8b4de","url":"apple-touch-icon-180x180.png"},{"revision":null,"url":"assets/index-6Ez4sj9Y.js"},{"revision":null,"url":"assets/index-BWJGTY1s.js"},{"revision":null,"url":"assets/index-BXz_JrYs.css"},{"revision":null,"url":"assets/qr-scanner-worker.min-D85Z9gVD.js"},{"revision":null,"url":"assets/workbox-window.prod.es5-D5gOYdM7.js"},{"revision":"9f1a33ffb093e789304161d3cb3e51e2","url":"favicon.ico"},{"revision":"6411431768cb871d912910e9c3cd78fa","url":"favicon.svg"},{"revision":"34f8fa801ed21d55b7f0bc9c791179ac","url":"index.html"},{"revision":"15d489e32431ab8a7b548550348d813f","url":"maskable-icon-512x512.png"},{"revision":"c02670b01ea4a49badd565573e41488c","url":"pwa-192x192.png"},{"revision":"80bf7ae738d35ce3b42fcde965b06e0a","url":"pwa-512x512.png"},{"revision":"eb4a7d7159a72ba8ab38713f6423c262","url":"pwa-64x64.png"},{"revision":"70b2e7dddd569ade4466a253ab7b40a9","url":"manifest.webmanifest"}]);$y();let R1;$d(new My(Ny("index.html"),{allowlist:R1}));self.skipWaiting();Ky();I1({onCacheCheck(n,e){return{ttl:6e4*5}}});
